!function(e){function t(t){for(var a,o,r=t[0],l=t[1],d=t[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(c&&c(t);p.length;)p.shift()();return i.push.apply(i,d||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},s={3:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var c=l;i.push([890,0]),n()}([,,,,,function(e,t,n){"use strict";(function(e){var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this;Object.defineProperty(t,"__esModule",{value:!0});var i=n(148),o=n(438),r=n(149),l=n(85),d=n(10),c=n(14),u=n(653),p=n(1053),h=n(657),g=n(167),f=n(658),m=n(1120),v=n(43),b=n(20),C=n(87),y=n(8),_={};t.getViewportDimensions=function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},t.windowOpen=function(e,t){return window.isIOSApp?0!==e.indexOf("http")?window.open(e):void window.webkit.messageHandlers.openUrlInSafari.postMessage(e):window.open(e,t)},t.userSessionChannel=function(){return _.userSessionChannel},t.initUserSessionChannel=function(){_.userSessionChannel=t.ably().channels.get("user_session_listen@"+sCH.userM.get("UserId"))},t.ably=function(){return _.ably},t.initAbly=function(){_.ably=new Ably.Realtime(b.default.ablyKey)},t.percent=function(e,t,n){return n=n||"%",t=isNaN(t)?0:t,isNaN(e)?"":Math.round(e*Math.pow(10,t+2))/Math.pow(10,t)+n},t.roundWithPrecision=function(e,t){var n=Math.pow(10,t),a=e*n;return Math.round(a)/n},t.getGradeAverageThresholds=function(e){return{possible:e.shortAnswer.denominator,basic:e.shortAnswer.numerators.basic,proficient:e.shortAnswer.numerators.proficient}},t.gradeColor=function(e,n,a){var s=n/a,i=t.getGradeAverageThresholds(e),o=i.possible,r=i.basic;return s>=i.proficient/o?"green":s>=r/o?"yellow":s>=0?"red":""},t.sortComparator=function(e){return function(t,n){return null==t?1:null==n?-1:t===n?0:"string"==typeof t&&"string"==typeof n?e?C(n.toLowerCase(),t.toLowerCase()):C(t.toLowerCase(),n.toLowerCase()):e?t<n?1:-1:t<n?-1:1}},t.classNames=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var a=[],s=0;s<t.length;s++){var i=t[s];if(i){var o=typeof i;if("string"===o||"number"===o)a.push(i);else if(Array.isArray(i))a.push(e.apply(null,i));else if("object"===o)for(var r in i)i.hasOwnProperty(r)&&i[r]&&a.push(r)}}return a.join(" ")},t.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},t.when=function(e,n,a){var s=void 0!==n[e]?n[e]:n.default;return t.isFunction(s)?a?s.bind(a)():s():s},t.getAppSection=function(){return location.hash.split("/")[1].toLowerCase()},t.truncate=function(e,t){if(e){if(e.length<=t)return e;var n=(e=e.substr(0,t)).lastIndexOf(" ");return-1===n?e+"...":e.slice(0,n)+"..."}},t.lookupCountToFontSize=function(e,t){return e>17?32:e>1?e-1+16:16},t.toOrdinal=function(e){var t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"},t.shouldSnapToWordHighlight=function(e){if(sCH.readerConfig.isPDF)return!1;if("studentir"===sCH.readerConfig.type)return!0;if(5===("student"===sCH.userM.get("Role")?sCH.classesC.find({ClassId:sCH.learnEntityMetaM.get("ClassId")}).get("SubjectId"):sCH.userM.get("SubjectId"))){var t=/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g;if(t.test(e))return!1;if((t=/[\u4E00-\u9FCC\u3400-\u4DB5\uFA0E\uFA0F\uFA11\uFA13\uFA14\uFA1F\uFA21\uFA23\uFA24\uFA27-\uFA29]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]/g).test(e))return!1;if((t=/[\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF]/g).test(e))return!1}return!0},t.getTableParser=function(e){return"minutes"===e?{id:"minutes",is:function(e){return!1},format:function(e,t,n,a){return parseInt($(n).data("minutes"))},type:"numeric"}:"rating"===e?{id:"rating",is:function(e){return!1},format:function(e,t,n,a){return $(n).data("rating")},type:"numeric"}:"count"===e?{id:"count",is:function(e){return!1},format:function(e,t,n,a){return $(n).data("count")},type:"numeric"}:"struggling"===e?{id:"struggling",is:function(e){return!1},format:function(e,t,n,a){return $(n).find("input").is(":checked")},type:"numeric"}:"name"===e?{id:"name",is:function(e){return!1},format:function(e,t,n,a){return $(n).data("name")},type:"text"}:{}},t.plural=function(e,t,n){return 1===e?t.replace("%count",e):n.replace("%count",e)},t.sanitize=function(e,t,n){return null===e?null:void 0===e?e:f(e,{allowedTags:t=t||["b","i","u","em","strong","a","p","br","sub","sup"],allowedAttributes:n=n||{a:["href","target"]}})},t.sanitizePlaintext=function(e){return $("<textarea/>").html(e).text()},t.getImageSize=function(e,t){var n=$(e)[0],a=setInterval((function(){var e=n.naturalWidth,i=n.naturalHeight;e&&i&&(clearInterval(a),t.apply(s,[e,i]))}),30)},t.updateGoogleDocEquationImageCSS=function(e,t,n,a){var s=e.attr("src");s=t?s.replace("chco=000000","chco=ffffff").replace("FFFFFF00","ffffff00"):s.replace("chco=ffffff","chco=000000").replace("ffffff00","FFFFFF00"),e.data("height")?e.attr("src",s.replace(/chs=[0-9]+/,"chs="+(e.data("height")+a))):(e.data("height",n),e.attr("src",s+"&chs="+(n+a)))},t.isGoogleSection=function(){return sCH.learnEntityMetaM.get("IsGoogleDoc")||"googledoc"===sCH.learnEntitySectionsMetaC.getModelBySectionId(sCH.readerConfig.currentSectionId).get("Type")},t.overrideGoogleDocCSSWithTextSettings=function(){if(t.isGoogleSection()){var e=sCH.readerConfig.TextSettings,n=document.implementation.createHTMLDocument(""),a=document.createElement("style");a.textContent=sCH.readerConfig.googleDocCSS,n.body.appendChild(a);var s=a.sheet,i={helveticaet:"HelveticaNeueETW02-55Rg",dyslexic:"opendyslexic-web"},o={fontSmall:2,fontMedium:4,fontLarge:6},r={less:1.6,more:1.95,most:2.25};$('.textSection img[src^="http://www.google.com/chart"]').each((function(){var n=this;t.getImageSize(n,(function(a,s){var i="themeBlack"===e.theme;t.updateGoogleDocEquationImageCSS($(n),i,s,o[e.fontSize||"fontSmall"])}))})),y.each(s.cssRules,(function(t){if(t.style.color){var n=t.style.color.substring(4,t.style.color.length-1).replace(/ /g,"").split(",");n=y.uniq(n).sort(),parseInt(n[0],0)<100&&(1===n.length||n[n.length-1]-n[0]<20)&&"themeBlack"===e.theme&&(t.style.color="rgba(236, 239, 241, 0.9)")}"rgb(255, 255, 255)"===t.style.backgroundColor&&(t.style.backgroundColor=""),t.style.fontFamily&&i[e.font]&&(t.style.fontFamily=i[e.font]),t.style.lineHeight&&(t.style.lineHeight=r[e.spacing]),t.style.fontSize&&(t.style.fontSize=parseInt(t.style.fontSize)+o[e.fontSize||"fontSmall"]+"pt")}));var l=y.reduce(s.cssRules,(function(e,t){return e+t.cssText}),"");0===$("#customGoogleStyles").length?$(".textSection").append('<style id="customGoogleStyles" type="text/css">'+l+"</style>"):$("#customGoogleStyles").text(l)}},t.getUserOrClassType=function(e){return e?"native"===e.get("Source")?"native":"nonnative":sCH.userM.get("Accounts").edmodo||sCH.userM.get("Accounts").clever?"nonnative":"native"},t.destroyMediumEditor=function(e){e&&($.isArray(e)?y.each(e,(function(e){e.destroy()})):e.destroy())},t.getMediumEditorCustomOptions=function(e,t){var n=e?$(e).attr("placeholder"):null;return{placeholder:!(!t&&!n)&&{text:t||n},toolbar:{allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","subscript","superscript"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,align:"center",sticky:!1,updateOnEmptySelection:!1}}},t.initMediumEditor=function(e,n){var s=t.getMediumEditorCustomOptions(e,n);return new h(e,a({},s))},t.wrapOldTextAreaContentInPTags=function(e){return e?"<p>"===e.substr(0,3)&&"</p>"===e.substr(-4)?e.replace(/<p><\/p>/g,""):("<p>"+e.replace(/\n/g,"</p><p>")+"</p>").replace(/<p><\/p>/g,""):e},t.getClassUrl=function(e,t){return l.roleForUrl()+"/classes/"+e+"/"+t},t.getReaderExitUrl=function(){var e=sCH.userM.isPLAssignment(),n=t.when(sCH.readerConfig.type,{authoring:"/catalog",tour:"/catalog",grading:"/classes/"+sCH.learnEntityMetaM.get("ClassId")+"/assess",student:e?"/professionallearning":"/classes/"+sCH.learnEntityMetaM.get("ClassId")+"/assignments",studentir:"/bookshelf",studentresearch:"/classes/"+sCH.learnEntityMetaM.get("ClassId")+("student"===sCH.userM.get("Role")?"/research":"/assess")});return l.roleForUrl()+n},t.getReaderBaseUrl=function(){var e=sCH.readerConfig,n="";if(t.userIsStudent())n=t.when(e.type,{student:"#student/reader/"+e.assignmentId,studentir:"#student/reader/ir/"+e.studentLayerId,studentresearch:"#student/reader/research/"+e.studentLayerId});else{var a=e.isReadOnly?"/preview":"";n=t.when(e.type,{tour:"#teacher/reader/tour/"+e.assignmentId,student:"#teacher/reader/learning/"+e.assignmentId,authoring:"#teacher/reader/authoring"+a+"/"+e.layerId,grading:"#teacher/reader/grading/"+e.assignmentId,studentresearch:"#teacher/reader/research/preview/"+e.studentLayerId})}return n},t.isUserInReader=function(){return window.location.href.indexOf("reader")>-1&&sCH.readerConfig},t.getStandardById=function(e){var t=e&&sCH.readerConfig&&sCH.readerConfig.standards?y.find(sCH.readerConfig.standards,{StandardId:e}):null;return t||{StandardCode:"N/A",ShortText:"Unknown standard",Description:"Unknown standard."}},t.getStandardByIdForAuthoringPreview=function(e){var t,n=sCH.userM.getPrimarySchool(),a=sCH.readerConfig.layers.find((function(e){return e.LayerId===sCH.readerConfig.layerId})),s=!!a&&"CatalogLayer"===a.LayerType;if(e){var i=sCH.readerConfig.standards.some((function(e){return e.State&&"ALL"!==e.State}));s&&i?(t=y.find(sCH.readerConfig.standards,{MappedStandardId:e}))||(t=y.find(sCH.readerConfig.standards,(function(t){var a=!t.State||y.includes(["ALL",n.State],t.State)||t.AddOnStates&&y.includes(t.AddOnStates,n.State);return t.StandardId===e&&a}))):t=y.find(sCH.readerConfig.standards,{StandardId:e})}return t||{StandardCode:"N/A",ShortText:"No standard",Description:"No standard."}},t.getStandardByCode=function(e,t){var n=y.find(t,{StandardCode:e});return n||{StandardCode:"N/A",ShortText:"No standard",Description:"No standard."}},t.getStandardLevel=function(e){return null==e?e:parseInt(e.substr(e.lastIndexOf(".")+1))},t.print=function(e,t){var n,a,i='<div class="printHeaderText">'+e+"</div>",o=$(".layout"),r=o.hasClass("teacherData")||o.hasClass("studentData")||o.hasClass("teacherClasses");if(t=t||"",$("body").addClass("pme "+t).prepend(i),v.firefox&&s.isUserInReader()&&$("body").addClass("firefoxPrint"),r){(a=document.createElement("style")).type="text/css";var l=a.sheet;l?l.cssText="@page { size: landscape; }":a.appendChild(document.createTextNode("@page { size: landscape; }")),(n=document.head||document.getElementsByTagName("head")[0]).appendChild(a)}window.print(),r&&n.removeChild(a),$("body").removeClass("pme "+t+" firefoxPrint"),$(".printHeaderText").remove()},t.intercom=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];window.Intercom&&(window.Intercom.apply(window,e),"trackEvent"===e[0]&&t.autopilotTrack(e[1],e[2]))},t.autopilotTrack=function(e,t){"student"===sCH.userM.get("Role")||sCH.userM.get("DemoAccount")||d.TrackEventAutopilot({event:e,properties:t})},t.initHelpPopover=function(e){e.find('[data-role="help"][data-toggle="popover"]').popover({template:'\n      <div class="popover help" role="tooltip">\n        <div class="arrow"></div>\n        <h3 class="popover-title"></h3>\n        <div class="popover-content"></div>\n      </div>'})},t.initTooltips=function(e,n,a){if(a=a||"",n=y.extend({placement:"bottom"},n),!t.onDevice())try{e.find("[title]:not(.finishdate)"+a).each((function(){var e=$(this),t=e.data("tooltip-class")||"";n.template='\n          <div class="tooltip '+t+'" role="tooltip">\n            <div class="tooltip-arrow"></div>\n            <div class="tooltip-inner"></div>\n          </div>',n.placement=e.data("placement")||n.placement,e.tooltip(n),"body"===e.data("container")&&e.on("click",(function(){e.tooltip("hide")})),e.attr("aria-label")||e.attr("aria-label",e.attr("data-original-title"))}))}catch(e){}},t.bootstrap={alert:function(e){var t=new m.default(e);return $(".alertContainer").html(t.render().el),t}},t.showErrorPopup=function(e){0===$(".notificationPopup").length&&new Backbone.BootstrapModal({title:"Uh oh!",content:e||alcfg.errorTexts.connection.error.blocking,okText:"Refresh",cssClass:"notificationPopup",allowCancel:!0,cancelText:!1}).open((function(){window.location.reload(!0)}))},t.rubberBandFix=function(){t.onDevice()&&setTimeout((function(){window.scrollTo(0,0)}),100)},t.generateNoteColorCategoryMap=function(e){var t={};if("student"===sCH.userM.get("Role")&&"studentresearch"===sCH.readerConfig.type)y.each(alcfg.tags.note.noteResearchColorsArray,(function(n){var a=y.find(e,{Color:n}),s=a?a.Category:"";t[n]={category:s,isDeleted:a&&a.IsDeleted,isCustom:!0}}));else{var n=sCH.learnEntityMetaM.get("SkillBucketId"),a=[];"student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type?a=alcfg.tags.note.noteCustomColorsArray:alcfg.tags.note.noteCustomColorsArray.forEach((function(e){sCH.teacherNotesC.find((function(t){return e===t.get("Color")}))&&a.push(e)}));var s=y.map(alcfg.tags.note.noteDefaultColorCategoryMap[n],"color").concat(a);y.each(s,(function(a){var s=y.find(alcfg.tags.note.noteDefaultColorCategoryMap[n],{color:a}),i=y.find(e,{Color:a}),o=i?i.Category:s?s.category:null;t[a]={category:o,isDeleted:!(!i||!i.IsDeleted),isCustom:!s}}))}return t},t.onDevice=function(){var e=v.mac&&navigator.maxTouchPoints>1;return v.mobile||v.tablet&&navigator.userAgent.indexOf("Tablet PC 2.0")<0||v.ios||e},t.ehtmlToHtml=function(e,t){t=atob(t);var n=atob(e),a=p.AES.decrypt({ciphertext:p.enc.Latin1.parse(n)},p.enc.Utf8.parse(t.split("|")[1]),{iv:p.enc.Utf8.parse(t.split("|")[2])});return p.enc.Utf8.stringify(a)},t.eStringToString=function(e){if(!sCH.learnEntityMetaM.get("IsEncrypted")||!e)return e;for(var t={j:"A",Z:"a",v:"B",w:"b",q:"C",Q:"c",p:"d",X:"D",b:"e",F:"E",s:"f",z:"F",o:"G",E:"g",h:"H",G:"h",H:"i",I:"I",u:"J",P:"j",f:"K",k:"k",r:"L",A:"l",l:"M",y:"m",M:"N",N:"n",e:"O",U:"o",c:"p",Y:"P",L:"Q",V:"q",d:"R",K:"r",i:"S",T:"s",O:"T",R:"t",m:"U",W:"u",D:"v",J:"V",n:"w",S:"W",a:"x",x:"X",t:"Y",C:"y",g:"Z",B:"z"},n="",a=0;a<e.length;a++)e[a]in t?n+=t[e[a]]:n+=e[a];return n},t.getStyleTagContentLength=function(e){return t.getTagContentLengthByName(e,"style")},t.getTagContentLengthByName=function(e,t){e instanceof $||(e=$("<div/>").html(e));var n=e.find(t);return n.length>0?y.reduce(n,(function(e,t){return"customGoogleStyles"!==$(t).attr("id")?e+$(t).html().length:e}),0):0},t.bindTouchMove=function(e,n){t.onDevice()&&(e.prop("scrollHeight")>e.outerHeight()?(n.data("touchMoveScrollTop",$(document).scrollTop()),$(".reader").css("overflow","hidden"),$(".reader").css("height","100%"),n.bind("touchmove",!1)):$(document).bind("touchmove",!1))},t.unbindTouchMove=function(e){t.onDevice()&&($(document).unbind("touchmove"),e.unbind("touchmove"),void 0!==e.data("touchMoveScrollTop")&&window.scrollTo(0,e.data("touchMoveScrollTop")))},t.viewportSkipToElement=function(e,n){var a=e.offset().top+Math.floor(e.height()/2)-51-($(window).height()-51)/2;n?t.scrollElement().scrollTop(a):t.scrollElement().animate({scrollTop:a},1e3)},t.scrollElement=function(){return $("html, .reader.fixedView .scroll .left .textview:visible")},t.getNoteTagModel=function(e){var t=sCH.teacherNotesC.findWhere({TagId:e}),n=sCH.studentNotesC.findWhere({TagId:e}),a=sCH.allStudentTagsC.findWhere({TagId:e});return t||(n||a)},t.userIsStudent=function(){return"student"===sCH.userM.get("Role")},t.resizeImages=function(e,t){sCH.userM.isV2ContentUser()?y.each(e,(function(e){var n=$(e),a=parseInt(n.attr("width")||String(n.width()));a>50&&a<t/2&&n.closest("figure").css({width:a}).addClass("alignRight")})):y.each(e,(function(e){var n=$(e),a=parseInt(n.attr("height")||n.height()+""),s=parseInt(n.attr("width")||n.width()+""),i=a/s;s>t&&(n.height(Math.round(i*t)).width(t),parseInt(n.parent().css("width").replace("px","").replace("pt",""))>t&&n.parent().css("width",""))}))},t.isValidEmail=function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},t.isNumber=function(e){var t=(e=e||window.event).which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))},t.checkRequiredFields=function(e,t){for(var n=0,a=0;a<e.length;a++)if(e[a].length>0&&e[a].is(":visible")){var s=t?""===$.trim(e[a].text()):""===$.trim(e[a].val()),i=e[a];s?(i.addClass("flash"),n++):i.removeClass("flash")}return n},t.checkRequiredInputFields=function(e){var t=0;return e.find("input").map((function(e,n){""===$.trim($(n).val())&&($(n).addClass("flash"),t++)})),t},t.checkRequiredEmailField=function(e){var n=t.isValidEmail(e.val());return n?e.removeClass("flash"):e.addClass("flash"),n},t.setCookie=function(e,t,n){document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;";var a=new Date;a.setDate(a.getDate()+n);var s=""+(e+"="+encodeURIComponent(t)+"; ")+(n?"expires="+a.toUTCString()+"; ":"")+("local"===b.default.env?"":"domain="+b.default.cookieDomain+"; ")+"path=/";document.cookie=s},t.getCookie=function(e){var t=document.cookie,n=t.indexOf(" "+e+"=");if(-1===n&&(n=t.indexOf(e+"=")),-1===n)t=null;else{n=t.indexOf("=",n)+1;var a=t.indexOf(";",n);-1===a&&(a=t.length),t=decodeURIComponent(t.substring(n,a))}return t},t.getRandomInteger=function(){var e=new Date;return parseInt(e.getUTCFullYear().toString()+e.getUTCHours().toString()+e.getUTCMinutes().toString()+e.getUTCSeconds().toString()+e.getUTCMilliseconds().toString())},t.scrollbarWidth=function(){var e=$("<div style='width:100px;height:100px;overflow:scroll;position:absolute;top:-9999px;'></div>")[0];document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},t.adjustHeaderSpacing=function(){try{var e=document.getElementById("headerWrapper");if(e){var n=e.offsetHeight;document.getElementById("content").style.paddingTop=n+"px",document.querySelector(".folderContainer")&&t.adjustFolderContainerHeight()}}catch(e){console.error(e)}},t.adjustFolderContainerHeight=function(){try{var e=document.getElementById("headerWrapper");if(e){var t=e.offsetHeight+1;document.querySelector(".folderContainer").style.height="calc(100vh - "+t+"px)"}}catch(e){console.error(e)}},t.adjustVirtualizedTableHeight=function(){try{var e=document.querySelector(".vtable-wrapper");if(e){var t=window.innerHeight-e.getBoundingClientRect().top-25;if(e.getBoundingClientRect().top<0||t>window.innerHeight)return;e.style.height=t+"px"}}catch(e){console.error(e)}},t.handleAppClick=function(e){Backbone.notificationHelper&&Backbone.notificationHelper.view&&!$(".notifications").has(e).length&&Backbone.notificationHelper.hide(),sCH.readerConfig&&sCH.readerConfig.moveQuestionMode&&0===e.closest(".textSectionContainer").length&&Backbone.pubEv.trigger("moveQuestionHereCancelled"),sCH.readerConfig&&sCH.readerConfig.activeFullNote&&!sCH.readerConfig.activeAddNote&&0===e.closest(".noteTagContainer, .notesTag, .flagTagContainer, .popupNoteMenu").length&&0===sCH.readerConfig.activeFullNote.$el.find(".noteReplyText").text().trim().length&&sCH.readerConfig.activeFullNote.hide(),$('[data-role="help"][data-toggle="popover"]').each((function(){!$(this).is(e)&&0===$(this).has(e).length&&0===$(".popover").has(e).length&&$(".popover").length>0&&$(this).popover("hide")}))},t.clearSearchHighlights=function(){var e=$(".inTextSearchResult:not(.notereference)").parent()[0];$(".inTextSearchResult:not(.notereference)").contents().unwrap(),i.safeNormalize(e),$(".inTextSearchResult:not(.notereference)").remove()},t.clearWrapOnElement=function(e){$("."+e).each((function(){var e=$(this).parent()[0];$(this).contents().unwrap(),i.safeNormalize(e),$(this).remove()}))},t.getHostName=function(e,t){return e.indexOf("version.json")>=0||e.indexOf("https://layers.blob.core.windows.net")>=0||e.indexOf("https://images-staging.activelylearn.com")>=0||e.indexOf("https://images.activelylearn.com")>=0||e.indexOf("https://texts-staging.activelylearn.com")>=0||e.indexOf("https://texts.activelylearn.com")>=0?"":t?b.default.mathIframeApi:b.default.api},t.newVersion=function(e){if(null!==e&&"object"==typeof e&&void 0!==e.Version){var t=(window.version+"").split("."),n=(e.Version+"").split(".");return(t[0]!==n[0]||t[1]!==n[1])&&(window.clearTimeout(_.updateTimer),Backbone.pubEv.trigger("loadingShowHide",!1),new Backbone.BootstrapModal({title:"We've updated our app!",content:"<p>We have to reload this page so you get our latest changes!</p>",cssClass:"modal-al-reload",allowCancel:!1,cancelText:!1}).open((function(){try{window.localStorage.clear()}catch(e){}window.location.reload(!0)})),!0)}return!1},t.generateUUID=function(){return sCH.userM.get("UserId")+"-"+(new Date).getTime()},t.appendRequestIdAndVersionToUrl=function(e){var n=e&&e.indexOf("?")>=0?"&":"?";return""+e+n+"requestId="+t.generateUUID()+"&version="+window.version},t.ajax=function(e,n,a,s){var i=this,o=t.getHostName(e.url,e.isMathAPI);!e.data||e.data instanceof FormData||(e.data=y.omitBy(e.data,y.isUndefined)),e.apiEndpoint=e.url,e.retry=0,e.timestamp=new Date,e.retryLimit="local"===b.default.env?0:e.hasOwnProperty("retryLimit")?e.retryLimit:3,e.timeout=e.hasOwnProperty("timeout")?e.timeout:12e3,e.showLoading=!e.hasOwnProperty("showLoading")||e.showLoading,e.vital=!!e.hasOwnProperty("vital")&&e.vital,e.url=o+e.url,"POST"===e.type&&sCH.userM.get("csrfToken")&&(e.data=e.data||{},e.data.csrfToken=sCH.userM.get("csrfToken")),""!==o&&(e.dataType="json",e.xhrFields={withCredentials:!0}),e.showLoading&&(void 0!==_.showLoadingTimer&&window.clearTimeout(_.showLoadingTimer),_.showLoadingTimer=window.setTimeout((function(){Backbone.pubEv.trigger("loadingShowHide",!0,e.timeout)}),1500)),e.beforeSend=function(e,n){if(n.dontAbort||(e.showLoadingTimer=_.showLoadingTimer,$.xhrPool=$.xhrPool||{},$.xhrPool[window.location.hash]=$.xhrPool[window.location.hash]||[],$.xhrPool[window.location.hash].push(e)),n.customHeaders){var a=y.keys(n.customHeaders);y.each(a,(function(t,a){e.setRequestHeader(t,n.customHeaders[t])}))}""!==o&&(this.url=t.appendRequestIdAndVersionToUrl(this.url))},e.complete=function(e){if($.xhrPool){var t=$.xhrPool[window.location.hash]?$.xhrPool[window.location.hash].indexOf(e):-1;t>-1&&$.xhrPool[window.location.hash].splice(t,1)}},e.success=function(n){n&&!n.Success&&"unauthorized"===n.Message&&t.bootstrap.alert({alert:"danger",message:"Not authorized to perform this operation."}),e.onSuccess&&"function"==typeof e.onSuccess&&e.onSuccess.call(i,n),t.hideLoadingSpinner(e.showLoading)},e.error=function(n,a,s){if("abort"!==a)if(401===n.status)e.hasOwnProperty("onUnauthenticatedError")?e.onUnauthenticatedError.call(i,n,a):l.handleUnauthenticatedAccess(e);else if(403===n.status)t.hideLoadingSpinner(e.showLoading),e.hasOwnProperty("onUnauthorizedError")?e.onUnauthorizedError.call(i,n,a):t.bootstrap.alert({alert:"danger",message:i.getErrorTextFromResponse(n),autoClose:!1});else if(400===n.status)t.hideLoadingSpinner(e.showLoading),e.hasOwnProperty("onBadRequestError")?e.onBadRequestError.call(i,n,a):t.bootstrap.alert({alert:"danger",message:i.getErrorTextFromResponse(n),autoClose:!1});else if("timeout"!==a&&0!==n.status){if(t.hideLoadingSpinner(e.showLoading),e.hasOwnProperty("onError"))return void e.onError.call(i,n,a,e.silentError?"":"displayed");e.silentError||(e.vital?(t.showErrorPopup(),rg4js("send",{error:new Error("ajax error - non timeout1"),customData:{textStatus:a,resp:n,obj:e}})):t.bootstrap.alert({alert:"danger",message:alcfg.errorTexts.connection.error.nonblocking,autoClose:!1}))}else e.retry++,r.check((function(s){if(e.retry>e.retryLimit&&!s){var o=0===e.url.indexOf("https://texts.activelylearn.com/"),l="/version.json"===e.url,d=n&&n.statusText&&"InvalidAccessError: A parameter or an operation is not supported by the underlying object"===n.statusText;"error"===a&&(l||o||d)||e.url.includes(alcfg.node.events.nsf_event)||rg4js("send",{error:new Error("ajax error - non timeout2"),customData:{textStatus:a,resp:n,obj:e}}),t.hideLoadingSpinner(e.showLoading),e.hasOwnProperty("onError")&&(e.onError.call(i,n,a,e.silentError?"":"displayed"),e.silentError||(e.vital?(t.showErrorPopup(),rg4js("send",{error:new Error("ajax error - non timeout3"),customData:{textStatus:a,resp:n,obj:e}})):t.bootstrap.alert({alert:"danger",message:alcfg.errorTexts.connection.error.nonblocking,autoClose:!1})))}else s?(window.location.href.indexOf("student/reader")>0?e.url.indexOf("add")>-1&&(e.rndId=t.getRandomInteger()):window.location.href.indexOf("reader/grading")>0?t.bootstrap.alert({alert:"danger",message:alcfg.alertsText.teacherOfflineMessage,autoClose:!1}):t.bootstrap.alert({alert:"danger",message:alcfg.errorTexts.connection.error.offline,autoClose:!1}),e.hasOwnProperty("onError")&&e.onError.call(e,n,"offline"),window.location.href.indexOf("student/reader")>0&&r.saveRequestToLocalStorage(e),r.startReconnectCheck(),i.hideLoadingSpinner(e.showLoading)):(e.hasOwnProperty("onError")&&e.hasOwnProperty("showRetryingError")&&e.onError.call(i,n,"retrying"),$.ajax(e))}))},$.ajax(e)},t.ajaxUploadFiles=function(e,n,a,s){t.ajax({type:"POST",url:e,data:n,showLoading:!0,silentError:!0,vital:!0,dontAbort:!0,cache:!1,contentType:!1,processData:!1,showRetryingError:!0,timeout:3e4,customHeaders:{"X-CSRFToken":sCH.userM.get("csrfToken")},onSuccess:a,onError:s})},t.hideLoadingSpinner=function(e){e&&(Backbone.pubEv.trigger("loadingShowHide",!1),window.clearTimeout(_.showLoadingTimer))},t.parseDateString=function(e){return new Date(e.trim().replace(" ","T")).getTime()},t.startUpdateTimer=function(){!function e(){d.GetAppVersion((function(e){if(!t.newVersion({Version:e}))try{o.sendSavedReadingTime()}catch(e){}})),_.updateTimer=window.setTimeout(e,18e4)}()},t.charCountHtml=function(e){return jQuery("<p>"+e+"</p>").text().length},t.trackCurrentPosition=function(e,t){try{var n=sCH.readerConfig.isAssessment?"assessment:":"",a=parseInt(sCH.readerConfig.scrollTopPx),s=null===a||isNaN(a)?0:a;if("authoring"===sCH.readerConfig.type){var i={textSectionId:sCH.readerConfig.currentSectionId,layerId:sCH.readerConfig.layerId,scrollTopPx:s,userId:sCH.userM.get("UserId")};Backbone.tracking.trackGAEvent(n+"authoring:"+e,i),Backbone.tracking.saveReaderState("authoring",e,i)}else if(["student","studentir","studentresearch"].indexOf(sCH.readerConfig.type)>-1){var r="student"===sCH.readerConfig.type?sCH.readerConfig.assignmentId:void 0,d="studentir"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type?sCH.readerConfig.studentLayerId:void 0,c=sCH.userM.get("UserId"),u={textSectionId:sCH.readerConfig.currentSectionId,assignmentId:r,studentLayerId:d,scrollTopPx:s,elapsedTime:t,userId:c};"start"!==e&&!isNaN(t)&&t>0&&Backbone.tracking.saveReaderState("reading",e,u,(function(e){e.error&&(o.saveUnsentReadingTimeRequestToStorage(u),"unauthenticated"===e.error&&l.destroyAppInitDataAndRedirect({source:"readingtime save",forwardURL:window.location.hash.substr(1),forwardURLExtra:"&furlUserId="+sCH.userM.get("UserId")}))}))}else if("grading"===sCH.readerConfig.type){i={textSectionId:sCH.readerConfig.currentSectionId,assignmentId:sCH.readerConfig.assignmentId,scrollTopPx:s,userId:sCH.userM.get("UserId")};Backbone.tracking.trackGAEvent(n+"grading:"+e,i),Backbone.tracking.saveReaderState("grading",e,i)}}catch(e){}},t.capitalizeString=function(e){return(e||"").toLocaleLowerCase().replace(/(?:^|\s)\S/g,(function(e){return e.toUpperCase()}))},t.camelToPascal=function(e){return e?e[0].toUpperCase()+e.slice(1):e},t.linkify=function(e){if(!e)return e;return e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,(function(e){return'<a href="'+e+'" target="_blank" class="linkified">'+e+"</a>"}))},t.isDoNotShowChecked=function(e){return e.$el.find("#chkDontShow").is(":checked")},t.updateDoNotShowPopupSetting=function(e){var t=y.filter(sCH.userM.get("Settings"),{SettingKey:"popupsToNotShow"});if(t.length>0)t[0].Settings+=","+e;else{var n={SettingKey:"popupsToNotShow",Settings:e,UserId:2};sCH.userM.get("Settings").push(n)}d.UpdatePopupSettings(e)},t.substringAtWord=function(e,t){return e.length<t?e:(e=e.substring(0,t)).substring(0,e.lastIndexOf(" "))+"..."},t.storeZoomStateToLocalStorage=function(e){if(g.supported){var t=sCH.readerConfig.assignmentId||sCH.readerConfig.layerId;e?g.db.localSettings.put({Key:"zoomlevel:assignmentId:"+t,Value:e}):g.db.localSettings.delete("zoomlevel:assignmentId:"+t)}},t.getZoomState=function(e){try{if(!g.supported)return void e(null);var t=sCH.readerConfig.assignmentId||sCH.readerConfig.layerId;g.db.localSettings.get("zoomlevel:assignmentId:"+t,(function(t){e(t?t.Value:null)}))}catch(t){e(null)}},t.getTextNodes=function(e,t){var n;n=function(e){return sCH.readerConfig.isPDF?NodeFilter.FILTER_ACCEPT:e.parentNode.className.indexOf("teacherQuestion")>-1||e.parentNode.className.indexOf("ignoreForTextSelection")>-1||"pnum"===e.parentNode.className?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT};for(var a,s=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,n,!1);a=i.nextNode();)(3===a.nodeType||t&&-1!==["IMG","FIGURE","IFRAME"].indexOf(a.tagName))&&s.push({node:a,isValidWhiteSpace:a.nodeValue&&(" "===a.nodeValue||""!==a.nodeValue.trim())});return s},t.getAssignmentIdFromUrl=function(e){if(b.default.isMath){var n=e.split("?")[1];return(n?t.parseQueryString(n):{}).assignmentId}var a=t.parseUrl(e).hash.split("/");return parseInt(a[2])},t.parseUrl=function(e){var n=document.createElement("a");return n.href=t.isValidALUrl(e)?e:window.location.origin,n},t.parseQueryString=function(e){var t={};return e&&y.each(y.map(decodeURI(e).split(/&/g),(function(e,t){var n=e.split("="),a={};if(n.length>=1){var s=void 0;2===n.length&&(s=n[1]),a[n[0]]=s}return a})),(function(e){y.extend(t,e)})),t},t.generateAvatarHtml=function(e,n){var a='<span class="avatar initial_a">aa</span>';if(e)if(e.length>2)a='<img class="image avatar" src="'+t.sanitize(e)+'" '+n+" />";else{var s=e.charAt(0).toLowerCase();s.match(/[a-z]/i)||(s="a"),a='<span class="avatar initial_'+s+'" '+n+">"+e+"</span>"}return a},t.gradeNameMap=function(e,n){var a=-1,s={},i={};if(!(a=e?(i=sCH.classesC.getMostCommonGradingLabeloption()).gradeLabelsOption:n&&n.gradebook?parseInt(n.gradebook.gradeLabelsOption):-1)||-1===a)return alcfg.grades.list;for(var o in s=a===parseInt(alcfg.grades.customGradeScaleOption)?e?JSON.parse(i.gradeLabelsMap):JSON.parse(n.gradebook.gradeLabels):alcfg.grades.nameSets[a])s[o]=t.sanitize(s[o]);var r=[];return y.each(alcfg.grades.list,(function(e){r.push({id:e.id,label:t.sanitize(s[e.id])})})),r},t.randomizeArray=function(e,t){if(!e||!e.length)return[];var n,a,s=e.length,i=t%s,o=0;if(i>0)for(;o<s&&i<s;o++)n=e[o],a=e[i],e[o]=a,e[i]=n,i++;return e},t.getFormattedTime=function(e,t){var n=t?"m":" min",a=t?"m":" mins",s=t?"h ":" hr ",i=t?"h ":" hrs ",o="0"+a;if(e)if(e<60)o="1"+n;else{var r=Math.floor(e/3600),l=Math.floor(e%3600/60);o=(r?r+(1===r?s:i):"")+l+(1===l?n:a)}return o},t.getSystemLocale=function(){var e=window.navigator;return e.languages&&e.languages.length>0?e.languages[0]:e.userLanguage||e.language||"en-US"},t.convertSecondsToClockFormat=function(e){var t=Math.floor(e/3600);e%=3600;var n=Math.floor(e/60),a=e%60;return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)+":"+(a<10?"0"+a:a)},t.convertSecondsToDecimalHours=function(e){return(e/60/60).toFixed(4)},t.handleVocabClick=function(e){e.stopPropagation();var t=$(e.currentTarget).hasClass("label")?$(e.currentTarget):$(e.currentTarget).find(".label"),n=t.data("word"),a=parseInt(t.data("startindex")),s=parseInt(t.data("endindex")),i=parseInt(t.data("textsectionid"));a>=0&&s>=0?($('.wordContainer[data-toggle="dropdown"]').parent().removeClass("open"),Backbone.pubEv.trigger("skipToTag",{sectionId:i,searchContext:n,searchOffset:{startIndex:a,endIndex:s}})):($(".searchDropdown .btnStartSearch").click(),$(".bs-searchbox input").val(n).keyup())},t.getAssignmentLockState=function(e){if(!e.lockStartDate&&!e.unlockStartDate)return{noLockSet:!0};var t=e.lockStartDate&&e.lockEndDate&&moment.utc(e.lockEndDate).isBefore(e.currentUtc)||e.unlockStartDate&&!e.unlockEndDate&&moment.utc(e.unlockStartDate).isBefore(e.currentUtc),n=!1;if(!t&&(e.lockStartDate||e.unlockStartDate)){var a=e.lockStartDate&&moment.utc(e.lockStartDate).isBefore(e.currentUtc)&&(!e.lockEndDate||moment.utc(e.lockEndDate).isAfter(e.currentUtc)),s=e.unlockStartDate&&(moment.utc(e.unlockStartDate).isAfter(e.currentUtc)||e.unlockEndDate&&moment.utc(e.unlockEndDate).isBefore(e.currentUtc));n=a||s}return{isLockExpired:t,isLocked:n,lockStartDate:e.lockStartDate?moment.utc(e.lockStartDate):null,lockEndDate:e.lockEndDate?moment.utc(e.lockEndDate):null,unlockStartDate:e.unlockStartDate?moment.utc(e.unlockStartDate):null,unlockEndDate:e.unlockEndDate?moment.utc(e.unlockEndDate):null}},t.viewMoreOfFacet=function(e,t){t.helper.clearRefinements(),t.helper.setQuery("");var n=$(e.currentTarget).data();y.each(n.facets,(function(e,n){y.map(t.FACET_CONFIG,"name").indexOf(n)>=0&&(e.constructor===Array?y.each(e,(function(e,a){t.helper.toggleRefinement(n,e)})):t.helper.toggleRefinement(n,e))}));var a=n.sort||"";t.setProxyOptions(a),t.helper.setIndex(t.INDEX_NAME+a),$(".sortDropdownLibrary ul a").removeClass("selected").filter('[data-sort="'+a+'"]').addClass("selected"),t.helper.search(),$(".sortDropdownLibrary").show()},t.alertBackendError=function(e){t.bootstrap.alert({message:e||alcfg.alertsText.requestFailed,alert:"danger"})},t.getUTCDateString=function(e){return null!==e?"Z"===e.slice(-1)?e:e+"Z":null},t.alertLongUrl=function(e,n){return n=n||2048,!(e&&e.length>n)||(t.bootstrap.alert({alert:"danger",message:"URL cannot be longer than "+n+" characters."}),!1)},t.alertLongContenteditableText=function(e){return e>alcfg.CONTENTEDITABLE_CHARACTER_LIMIT&&(t.bootstrap.alert({alert:"danger",message:"Text cannot be longer than "+alcfg.CONTENTEDITABLE_CHARACTER_LIMIT+" characters."}),!0)},t.attachSchoolDistrictId=function(e){var t=sCH.userM.getPrimarySchool();t.DistrictId?e.districtId=t.DistrictId:e.schoolId=t.SchoolId},t.attachSchoolIdOrDistrictIdByRole=function(e,t){var n=sCH.userM.getPrimarySchool();"dadmin"===sCH.userM.get("Role")&&n.DistrictId?e.districtId=n.DistrictId:e.schoolId=sCH.userM.get("SchoolInfo").length>1&&t?parseInt(t.$el.find(".ddlSchools").val()):n.SchoolId},t.getSchoolNameById=function(e){var t=sCH.userM.get("SchoolInfo").find((function(t){return t.SchoolId===e}));return t?t.Name:""},t.getSchoolNameByDistrictId=function(e){var t=sCH.userM.get("SchoolInfo").find((function(t){return t.DistrictId===e}));return t?t.Name:""},t.htmlToText=function(e,n){var a="",s=!1;try{s=" "===e.nodeValue||""!==$.trim(e.nodeValue)}catch(e){s=!1}if(3===e.nodeType&&"\n"!==e.nodeValue&&s){var i=n?" ":"";a+=e.nodeValue.replace(/(\r\n|\n|\r)/gm,i)}else if(n&&y.includes(alcfg.blockLevelElementsAndBreak,e.nodeName.toLowerCase())&&" "!==a.slice(-1)&&(a+=" "),void 0!==e.childNodes)for(var o=0,r=e.childNodes.length;o<r;++o)a+=t.htmlToText(e.childNodes[o],n);return a},t.calculateWordAndCharacterCountFromHtml=function(e){var n=t.htmlToText($("<div>").html(e)[0],!0).trim(),a=n.length;return{wordCount:a?n.match(/[^\s]+/g).length:0,characterCount:a}},t.utcDateToUnixTimestampInMs=function(e){return parseInt(moment.utc(e).format("x"))},t.getTextFromContenteditableElement=function(e){return e.text().trim()?e.html():null},t.getTextFromInputElement=function(e){var t=e.val();return(t?t.trim():"")||null},t.getStudentDisplayName=function(e,n){return(n?t.sanitize(n)+", ":"")+t.sanitize(e)},t.getTimeInSeconds=function(e,t){var n=parseInt(e)||0,a=parseInt(t)||0;return e||t?60*n*60+60*a:null},t.isValidReadingTime=function(e,t){var n=parseInt(t),a=/^\d+$/;return e&&!e.match(a)||t&&!t.match(a)?{isValid:!1,message:"Enter valid numerical values for number of hours and minutes read."}:n>59?{isValid:!1,message:"Minutes field cannot take value greater than 59!"}:{isValid:!0,message:null}},t.removeWhiteoutText=function(e){var t="";return y.each($(e),(function(n){var a=$(n);t+=a.parent().hasClass("whiteout")||a.parent(e).length>0?"":(t.length>0&&" "!==t.slice(-1)&&" "!==a.text().charAt(0)?" ":"")+a.text()})),t},t.getSignupEmailContent=function(e){var t="I have been using Actively Learn. It is a great resource for teachers. My students are now thinking, active readers thanks to Actively Learn! Just click on the link below to signup:\r\n\r\n"+(e||"https://www.activelylearn.com");return{emailBody:t,emailLink:"mailto:?subject="+encodeURI("Invitation to signup for Actively Learn!")+"&body="+encodeURI(t)}},t.getErrorTextFromResponse=function(e){return(e.responseJSON&&"object"==typeof e.responseJSON?e.responseJSON.message:e.responseJSON)||alcfg.errorTexts.connection.error[403===e.status?"notAuthorized":"nonblocking"]},t.addMediumZIndex=function(e){$(".modal").hasClass("in")&&e.addClass("mediumZIndex")},t.replaceQuoteInCSVData=function(e){return isNaN(e)?'"'+e.replace(new RegExp('"',"g"),'\\"')+'"':e},t.openReaderUrl=function(e){e&&(sCH.lastAccessedPreReaderUrl=window.location.hash,window.location.href="#"===e.charAt(0)?e:"#"+e)},t.getRightAlignmentToPlaceNextToRightPanel=function(){return $(".reader.fixedView").length>0?$(".lrContainer > .right").outerWidth()+5:0},t.isClassTeacherOnPersonalOrHigherPlan=function(e){var t=sCH.classesC.find({ClassId:e});return t&&(t.get("IsOnPrimePlan")||t.get("IsOnTeacherPersonalPlan"))},t.isClassOnPrimePlan=function(e){var t=sCH.classesC.find({ClassId:e});return t&&t.get("IsOnPrimePlan")},t.getUserLayerTitle=function(e){return S(e,"My instruction")},t.getLibraryLayerTitle=function(e){return S(e,"Library instruction")};var S=function(e,t){return t+(e.length>0?" ("+s.sanitize(e.join(", "))+")":"")};t.updateNoteReplyCount=function(e,t){t>0?(e.find(".replyCount .num").text(t),e.find(".replyCount").removeClass("displayNone")):e.find(".replyCount").addClass("displayNone")},t.promptUnSavedNoteReply=function(){var e=!1;return $(".noteTagContainer.active").length>0&&$(".noteTagContainer.active #noteReply [contenteditable]").text().trim().length>0&&(e=!confirm(alcfg.alertsText.unsavedNoteReply)),e},t.redirectUserByHash=function(e){e=s.sanitize(e),t.isValidHash(e)?window.location.hash="#"===e.charAt(0)?e:"#"+e:rg4js("send",{error:new Error("redirectUserByHash"),customData:{hash:e}})},t.redirectUserByUrl=function(e){if(0===(e=s.sanitize(e)).indexOf("/")){var n=window.location.origin+e;t.isValidALUrl(n)?window.location.href=n:rg4js("send",{error:new Error("redirectUserByUrl.invalidALUrl"),customData:{href:e}})}else window.location.href=e},t.isValidALUrl=function(e){var t=u.parse(e),n=u.parse(window.location.origin);return t&&n&&t.hostname===n.hostname},t.isValidHash=function(e){return!!e},t.getGradelevelSubjectString=function(){var e="Unknown",t="Unknown",n=c.UserGradeLevels.find((function(e){return e.value===sCH.userM.get("GradeLevelId")})),a=c.UserSubjects.find((function(e){return e.value===sCH.userM.get("SubjectId")}));return n&&(e=n.label),a&&(t=a.label),e+": "+t},t.showAnonymousPreviewInaccessiblePopup=function(e){var n=e.inReader,a=new Backbone.BootstrapModal({content:"To access this text, please log in or sign up.",cancelText:"Close",okText:"Log in"}).on("ok",(function(){var e=window.location.hash.substr(1),n="/account.html?furl="+encodeURIComponent(e);t.redirectUserByUrl(n)})).on("cancel",(function(){if(n){var e=sCH.lastAccessedPreReaderUrl||t.getReaderExitUrl();t.redirectUserByHash(e)}else a.close()})).open()},t.realignScrollForPinnedQuestion=function(e,t){var n=Math.abs(this.scrollElement().scrollTop());if(n>0){var a=$(".textSectionContainer .textSection").height();void 0!==t&&null!=t&&$('.questionTagViewMode[data-tagid="'+t+'"]').length>0&&$('.questionTagViewMode[data-tagid="'+t+'"]').offset().top<0&&this.scrollElement().scrollTop(n+(a-e))}},t.updatePinnedQuestionWidth=function(){var e=document.querySelector(".teacherQuestion.pinned");e&&(e.style.width=t.getWidthOfPinnedQuestion())},t.getWidthOfPinnedQuestion=function(){return window.getComputedStyle(document.querySelector(".textSection")).width},t.updateTagsForSEO=function(e){var t=e.pageTitle,n=t?t+" - Actively Learn":"Actively Learn",a=e.pageDescription||"Engage your students in reading with Actively Learn, the digital reading platform where scaffolding, peer learning, and assessment come together inside a text, exactly when students need help and motivation.";document.title=n,document.querySelector('meta[property="og:title"]').setAttribute("content",n),document.querySelector('meta[name="description"]').setAttribute("content",a),document.querySelector('meta[property="og:description"]').setAttribute("content",a)},t.manuallySelectEl=function(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)},t.checkIfTextNodeExistsAfter=function(e){for(var t=$(e),n=!1;!n&&!t.hasClass("textSection");){for(var a=t.next();!n&&a.length>0;)""!==a.text()?n=!0:a=a.next();t=t.parent()}return n},t.htmlDecode=function(e){var t=document.createElement("textarea");return t.innerHTML=s.sanitize(e),t.value},t.shouldShowJoyride=function(e){return!sCH.userM.get("IsMasquerading")&&!sCH.userM.isAnonUser()&&sCH.userM.showPopup(e)&&!v.mobile&&!v.msie},t.getSubjectNameFromId=function(e){var t=y.find(c.UserSubjects,{value:e});return t?t.label:"N/A"},t.shouldCollapseSearchForSmallScreen=function(){var e=s.onDevice(),t=e&&90!==Math.abs(window.orientation),n=document.querySelector(".header").clientWidth;return e&&t&&v.mobile||!e&&n<1120},t.disableFocusNClick=function(e){$(e).addClass("disabled"),$(e).attr("tabindex","-1")},t.enableFocusNClick=function(e){$(e).removeClass("disabled"),$(e).attr("tabindex","0")},t.toggleFocusNClick=function(e,t){$(e).toggleClass("disabled",t),$(e).attr("tabindex",t?"-1":"0")},t.getProductName=function(){return b.default.productName},t.renderBackboneTemplateAsync=function(n,a){return new e((function(e){return setTimeout((function(){$(n).html(a),t.adjustHeaderSpacing(),e()}),0)}))}}).call(this,n(21))},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneDeep=n(393),t.concat=n(404),t.debounce=n(308),t.defaults=n(184),t.difference=n(310),t.each=n(314),t.every=n(410),t.extend=n(415),t.fill=n(417),t.filter=n(189),t.find=n(127),t.findIndex=n(255),t.flatten=n(256),t.forEach=n(126),t.forIn=n(418),t.groupBy=n(419),t.includes=n(317),t.indexOf=n(190),t.intersection=n(258),t.intersectionBy=n(218),t.invert=n(218),t.isArray=n(36),t.isEmpty=n(84),t.isEqual=n(112),t.isFunction=n(123),t.isNaN=n(259),t.isNil=n(421),t.isUndefined=n(260),t.join=n(422),t.keys=n(80),t.map=n(100),t.max=n(423),t.maxBy=n(424),t.merge=n(219),t.min=n(425),t.minBy=n(426),t.omit=n(128),t.omitBy=n(427),t.orderBy=n(220),t.pick=n(191),t.pickBy=n(261),t.range=n(319),t.reduce=n(147),t.reject=n(428),t.remove=n(429),t.result=n(430),t.shuffle=n(431),t.sortBy=n(432),t.sum=n(433),t.sumBy=n(320),t.template=n(434),t.throttle=n(435),t.uniq=n(436),t.uniqBy=n(322),t.without=n(262)},,function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(5),i=n(167),o=n(43),r=n(8),l=n(20),d=n(14);t.UpdateSchoolBookCreditSubjectMaps=function(e,t){s.ajax({type:"POST",url:alcfg.node.manageusers.update_allowed_subject_school_book_credit,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)}})},t.addMissingTeacherInfo=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.add_missing_teacher_info,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)}})},t.logTourAction=function(e,t){s.ajax({type:"POST",url:alcfg.node.events.tour_action,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t&&t(e)}})},t.SwitchRole=function(e,t){s.ajax({type:"POST",url:alcfg.node.account["switch_role_to_"+e.switchTo],showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.GetMasqueradeUser=function(e,t){s.ajax({type:"GET",url:alcfg.node.account.getMasqueradeUser,data:{userName:e},vital:!1,onSuccess:function(e){t(e)}})},t.StopMasquerading=function(e){s.ajax({type:"POST",url:alcfg.node.account.stopMasquerading,showLoading:!0,vital:!0,onSuccess:function(t){e(t)}})},t.Masquerade=function(e,t){s.ajax({type:"POST",url:alcfg.node.account.masquerade,data:{userName:e},showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.GetPaidTextSectionUrl=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.get_paid_textsection_url,data:{textSectionId:e},showLoading:!1,vital:!0,onSuccess:function(e){t(e)},onUnauthorizedError:function(e){403===e.status?t(!1):s.bootstrap.alert({alert:"danger",message:s.getErrorTextFromResponse(e),autoClose:!1})}})},t.GetClassesForStudentModeTeacher=function(e){s.ajax({type:"GET",url:alcfg.node.class.get_for_student_mode_teacher,showLoading:!0,vital:!0,onSuccess:function(t){e(t)}})},t.GetEdmodoGroups=function(e){s.ajax({type:"GET",url:alcfg.node.class.get_edmodo_groups,showLoading:!0,vital:!0,onSuccess:function(t){e(t)}})},t.SignOut=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.signout,data:{deviceId:s.getCookie("deviceId"),currentUrl:t?null:window.location.hash.substr(1)},showLoading:!1,vital:!1,onSuccess:function(t){e(a({Success:!0},t))},onError:function(t,n){e({Success:!1,Message:n||"onError"}),"offline"!==n&&rg4js("send",{error:t,tags:["SignOut.OnError"]})},onUnauthorizedError:function(){e({Success:!0})}})},t.DeleteUser=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.delete,data:e,showLoading:!1,vital:!1,onSuccess:function(){t(!0)},onError:function(e){t(!1,s.getErrorTextFromResponse(e))}})},t.ChangeAvatarUrl=function(e,t){s.ajax({type:"POST",url:alcfg.node.profile.change_avatar,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.SetInitialsAsAvatar=function(e){s.ajax({type:"POST",url:alcfg.node.profile.set_initials_as_avatar,showLoading:!1,vital:!1,onSuccess:function(t){e(t)}})},t.GetStandardSets=function(e){s.ajax({type:"GET",url:alcfg.node.standards.get_standardsets,showLoading:!0,onSuccess:function(t){e(t)}})},t.GetStandards=function(e,t){s.ajax({type:"GET",url:alcfg.node.standards.get_standards,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.AddStandardSet=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.add_standardset,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.EditStandardSet=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.edit_standardset,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.DeleteStandardSet=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.delete_standardset,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.PublishStandardSet=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.publish_standardset,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.AddNewStandard=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.add_newstandard,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.EditStandard=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.edit_standard,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.DeleteStandard=function(e,t){s.ajax({type:"POST",url:alcfg.node.standards.delete_standard,data:e,showLoading:!0,onSuccess:function(e){t(e)}})},t.GetDataForGradebookAssignment=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_gradebook.get_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetDataForGradebookStandards=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_gradebook.get_standards_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudents=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_students,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataOverview=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_overview_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataStandards=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_standards_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetDataForStudentGradebook=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_gradebook.get_data_for_student,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataAssignments=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_assignments,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataWriting=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_writing,data:e,showLoading:!0,timeout:3e4,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataResearch=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_research,data:e,showLoading:!0,timeout:3e4,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataIR=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_studentdata.get_independentreading,data:e,showLoading:!0,timeout:3e4,vital:!1,onSuccess:function(e){t(e)}})},t.GetReadingLogData=function(e){s.ajax({type:"GET",showLoading:!0,timeout:3e4,vital:!1,url:alcfg.node.independent_reading.readinglog,onSuccess:function(t){e(t)}})},t.GetAssignees=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_assignment.assignees,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.SaveAssignees=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_assignment.update_assignees,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetClassProficiency=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_proficiency.get_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetClassVocabularyLookups=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_vocabulary.get_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetCleverSections=function(e){s.ajax({type:"GET",url:alcfg.node.class.get_clever_sections,showLoading:!0,vital:!0,timeout:3e4,onSuccess:function(t){e(t)}})},t.GetLTISourceCoursesAndSections=function(e,t){s.ajax({type:"GET",data:e,url:alcfg.node.class.get_ltisource_coursesandsections,showLoading:!0,vital:!0,timeout:3e4,onSuccess:function(e){t(e)}})},t.GetStudentGrades=function(e){s.ajax({type:"GET",url:alcfg.node.data.grade,showLoading:!0,vital:!0,timeout:3e4,onSuccess:function(t){e(t)}})},t.GetStudentWritingData=function(e,t){s.ajax({type:"GET",url:alcfg.node.data.writing,data:e,showLoading:!0,timeout:3e4,vital:!1,onSuccess:function(e){e&&t(e)}})},t.GetStudentGradebookActivityData=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_activity.get_data,data:e,showLoading:!0,timeout:3e4,vital:!1,onSuccess:function(e){e&&t(e)}})},t.GetAssignmentAndStudentsByClass=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_gradebook.get_assignments_students,data:e,showLoading:!0,timeout:3e4,vital:!1,onSuccess:function(e){e&&t(e)}})},t.RequestText=function(e,t){s.ajax({type:"POST",url:alcfg.node.catalog.request_text,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.AddOnlineText=function(e,t,n,a){var i;i="research"===n?alcfg.node.class_research[a?"add_google_doc":"add_online_text"]:"ir"===n?alcfg.node.independent_reading.add_online_text:alcfg.node.workspace[a?"add_google_doc":"add_online_text"],s.ajax({type:"POST",url:i,data:e,showLoading:!0,vital:!1,timeout:48e3,retryLimit:0,onSuccess:function(){t({Success:!0})},onError:function(e){t(e)}})},t.AddGooglePdf=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.add_google_pdf,data:e,showLoading:!0,vital:!1,timeout:48e3,retryLimit:0,onSuccess:function(){t({Success:!0})},onError:function(e){t(e)}})},t.ImportVideo=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.import_video,data:e,showLoading:!0,vital:!1,timeout:48e3,retryLimit:0,onSuccess:function(e){t(e)}})},t.GetSubjectsAndTopics=function(e){s.ajax({type:"GET",url:alcfg.node.catalog.get_catalog_subjects_topics,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(t){sCH.userM.shouldHidePaidTexts()&&(t=t.filter((function(e){return-1===d.TopicsHiddenForCovidPrimeUsers.indexOf(e.TopicId)}))),e(t)}})},t.GetCatalogTopicData=function(e,t){s.ajax({type:"GET",url:alcfg.node.catalog.get_catalog_topic_data,data:e,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(e){sCH.userM.shouldHidePaidTexts()&&e.Buckets.forEach((function(e){e.Texts=e.Texts.filter((function(e){return null===e.RentalPrices||-1!==d.CovidPaidTextsToBeMadeFree.indexOf(e.LearnEntityId)}))})),t(e)}})},t.GetCatalogTopicDataForUnitsPage=function(e,t){s.ajax({type:"GET",url:alcfg.node.catalog.get_catalog_topic_data_forunitspage,data:e,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(e){t(e)}})},t.GetMyImports=function(e){s.ajax({type:"GET",url:alcfg.node.catalog.get_catalog_myimports,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(t){e(t)}})},t.GetCatalogSearchResults=function(e,t){s.attachSchoolDistrictId(e),s.ajax({type:"GET",url:alcfg.node.catalog.get_catalog_search_results,data:e,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(e){sCH.userM.shouldHidePaidTexts()&&(e.TextResults=e.TextResults.filter((function(e){return null===e.RentalPrices||-1!==d.CovidPaidTextsToBeMadeFree.indexOf(e.LearnEntityId)}))),t(e)},onError:function(){t(!1)}})},t.UserIRData=function(e,t){s.ajax({type:"GET",url:alcfg.node.independent_reading.homepage_texts,data:e,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(e){t(e)}})},t.GetUserDistrict=function(e){s.ajax({type:"GET",url:alcfg.node.user.get_district,showLoading:!0,vital:!1,retryLimit:0,onSuccess:function(t){e(t)}})},t.DeleteBookshelfItems=function(e,t){s.ajax({type:"POST",url:alcfg.node.independent_reading.delete,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.ClearLayer=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.clear_layer,data:{layerId:e},showLoading:!0,vital:!1,onSuccess:function(e){t&&t(e)}})},t.DeleteLayer=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.delete_layer,data:{layerId:e},showLoading:!0,vital:!1,onSuccess:function(e){t&&t(e)}})},t.DeleteResearch=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_research.delete,data:e,showLoading:!0,vital:!1,onSuccess:function(){t()}})},t.ShareLayers=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.share,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.AddLayerToLibrary=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.add_layer_to_library,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.RemoveLayerFromLibrary=function(e,t){s.ajax({type:"POST",url:alcfg.node.library.remove_layer,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.RemoveLayerFromFolder=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.remove_layer_from_folder,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.DeleteSectionQuestions=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.delete_questions_bysection,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)},onError:function(){t(!1)}})},t.GetSpeechmark=function(e,t,n){s.ajax({type:"GET",url:alcfg.node.reader.ttsspeechmark,data:e,showLoading:!1,vital:!1,onSuccess:function(n){return t(n,e.partIndex)},onError:n})},t.GetDefinition=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.define,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)},onError:function(e,t){"offline"===t&&s.bootstrap.alert({message:"We cannot connect to the Merriam Webster dictionary!",alert:"danger"})}})},t.Translate=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.translate,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)},onError:function(e,n){429===e.status?t(e):s.bootstrap.alert({message:"We cannot currently connect to Google Translate. Please try again later.",alert:"danger"})}})},t.MoveStudentsHere=function(e){s.ajax({type:"POST",url:alcfg.node.reader_grading.move_students_here,data:e,showLoading:!1,vital:!1,onSuccess:function(){}})},t.RemoveStudent=function(e,t,n){s.ajax({type:"POST",url:alcfg.node.class_roster.remove_student,data:{studentUserId:e,classId:t},showLoading:!1,vital:!1,onSuccess:function(e){n(e)},onError:function(){n(!1)}})},t.ResetStudentPassword=function(e,t,n){s.ajax({type:"POST",url:alcfg.node.class_roster.reset_student_password,data:{studentUserId:e},showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)},onError:function(e){n&&n(e)}})},t.UpdateStudentName=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_roster.update_student_name,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.GetAssignedClasses=function(e,t){s.ajax({type:"GET",url:alcfg.node.workspace.classes_assigned_to,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.AddToWorkspace=function(e,t){s.ajax({type:"POST",url:alcfg.node.catalog.add_to_workspace,data:e,timeout:6e4,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.GetStudentCount=function(e,t){s.ajax({type:"GET",url:alcfg.node.workspace.get_student_count,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentAccess=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_assignment.get_student_assignment_access,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.CastResponseVote=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_student.cast_response_vote,data:e,showLoading:!1,vital:!1,onSuccess:function(){t()}})},t.GetLearnEntityOrderHistory=function(e,t){s.ajax({type:"GET",url:alcfg.node.payment.learnentity_order_history,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.UpdateCreditCard=function(e,t){s.ajax({type:"POST",url:alcfg.node.payment.update_card_details,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)},onError:function(){t(!1)}})},t.GradeUnanswered=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.bulk_grade_unanswered,data:e,showLoading:!1,vital:!0,timeout:3e4,onSuccess:function(){t(!0)},onError:function(){t(!1)}})},t.RestoreGradedResponsesAwaitingRevision=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.restore_graded_responses_awaiting_revision,data:e,showLoading:!1,vital:!0,onSuccess:function(){t()}})},t.AddQuiz=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.add_quiz,showLoading:!0,vital:!1,data:e,onSuccess:function(){t()}})},t.SwapQuestion=function(e,t,n){s.ajax({type:"POST",url:alcfg.node.reader_authoring.swap_question,data:{questionTagId:e,moveDirection:t,layerId:sCH.readerConfig.layerId},showLoading:!1,vital:!1,onSuccess:function(e){n(e)}})},t.UpdateLayerLabels=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.update_layer_labels,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.UpdateStudentLayerLabels=function(e,t,n,a){s.ajax({type:"POST",url:alcfg.node.class_research.edit_labels,data:{studentLayerIds:e,labels:t,isDelete:n},showLoading:!1,vital:!1,onSuccess:function(e){a(e)}})},t.EditResearchMetadata=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_research.edit_metadata,data:e,showLoading:!1,vital:!1,onSuccess:function(){t()}})},t.EditTextMetadata=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.edit_metadata,data:e,showLoading:!1,vital:!1,onSuccess:function(){t()}})},t.SaveForLater=function(e,t){s.ajax({type:"POST",url:alcfg.node.catalog.save_for_later,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetSavedForLater=function(e){var t={};s.attachSchoolDistrictId(t),s.ajax({type:"POST",data:t,url:alcfg.node.catalog.get_saved_for_later,showLoading:!0,vital:!1,onSuccess:function(t){e(t)}})},t.DuplicateLayer=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.duplicate,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.UpdateReaderSettings=function(e){this.UpdateStandaloneSetting({settingKey:"theme",settings:JSON.stringify(e)})},t.UpdatePopupSettings=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.update_popup_settings,data:{setting:e},showLoading:!1,vital:!1,onSuccess:function(){t&&t()}})},t.UpdateAssignmentGradeWeights=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.update_grade_weights,data:e,showLoading:!1,vital:!1,onSuccess:function(){t()}})},t.UpdateStandaloneSetting=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.update_standalone_settings,data:e,showLoading:!1,vital:!1,onSuccess:function(){t&&t(!0)}})},t.UpdatePinnedLabels=function(e,t){this.UpdateStandaloneSetting({settingKey:"pinnedLabels",settings:e},t)},t.UpdateAssignmentFilter=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.update_assignment_filter,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)}})},t.UpdateClassActivityColumnsToShow=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_activity.update_columns_to_show,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)}})},t.DownloadRestOfSections=function(e){var t=s.utcDateToUnixTimestampInMs(sCH.learnEntityMetaM.get("UpdateDate")),n=e,a=n.map((function(e){return e.TextSectionId}));i.supported?i.db.textSections.where("TextSectionId").anyOf(a).and((function(e){return e.cacheCreateDate>t})).keys((function(e){var t=n.filter((function(t){return-1===e.indexOf(t.TextSectionId)}));0===t.length&&$(".btnStartSearch").show(),function e(t,n){if(t>=n.length)return;n.slice(t,t+c).forEach((function(a,l){var d=l===c-1;if(a.BlobUrl){var u={type:"GET",cache:!0,url:a.BlobUrl,contentType:"text/plain",dataType:"html",showLoading:!1,vital:!1,silentError:!0,onSuccess:function(o){i.supported&&i.storeTextSection(r.extend(a,{Content:o,SanitizedContent:s.sanitize(o,alcfg.allowedTagsTextSection)})),d&&e(t+=c,n)},onError:function(){var a=n.slice(t);d&&s.ajax({type:"POST",url:alcfg.node.reader.getsignedurlsforfreetext,data:{textSectionIds:a.map((function(e){return e.TextSectionId}))},showLoading:!1,onSuccess:function(t){a.forEach((function(e){var n=t.find((function(t){return t.TextSectionId===e.TextSectionId})).BlobUrl;e.BlobUrl=n})),e(0,a)}})}};o.msie&&o.version<=9&&(u.crossDomain=!0),s.ajax(u)}else;}))}(0,t)})):$(".btnStartSearch").show()};var c=5;t.FetchReaderData=function(e,t,n){e.readerType=sCH.readerConfig.type,e.isPreview=!0===sCH.readerConfig.isReadOnly,s.ajax({type:"GET",url:alcfg.node["reader_"+e.readerType].load_reader,data:e,showLoading:!1,vital:!0,timeout:6e4,onSuccess:function(e){t(e)},onUnauthorizedError:function(e){n(e.responseJSON?e.responseJSON.data||e.responseJSON:{})}})},t.GetTeacherCommentSuggestions=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader_grading.get_teacher_comments,data:e,showLoading:!1,vital:!1,timeout:6e4,onSuccess:function(e){t(e)}})},t.GetCoteachData=function(e,t){s.ajax({type:"GET",url:alcfg.node.class.get_coteachdata,data:e,showLoading:!1,vital:!0,timeout:6e4,onSuccess:function(e){e&&t(e)}})},t.RemoveCoteacher=function(e,t){s.ajax({type:"POST",url:alcfg.node.class.remove_coteacher,data:e,showLoading:!1,vital:!1,onSuccess:function(){t&&t()}})},t.AddCoteachers=function(e,t){s.ajax({type:"POST",url:alcfg.node.class.add_coteachers,data:e,showLoading:!1,vital:!1,onSuccess:function(){t([])},onUnauthorizedError:function(e){e.responseJSON&&e.responseJSON.invalidCoteacherUserIds&&t(e.responseJSON.invalidCoteacherUserIds)}})},t.UpdateGradeLevel=function(e,t){s.ajax({type:"POST",url:alcfg.node.class.update_gradelevel,data:e,showLoading:!1,vital:!1,onSuccess:function(){t()}})},t.GetLayerAuthors=function(e,t){s.ajax({type:"GET",url:alcfg.node.workspace.get_layer_coauthors,data:e,showLoading:!1,vital:!0,timeout:6e4,onSuccess:function(e){t(e)}})},t.GetFolderCoauthors=function(e,t){s.ajax({type:"GET",url:alcfg.node.workspace.get_folder_coauthors,data:e,showLoading:!0,vital:!0,timeout:6e4,onSuccess:function(e){t(e)}})},t.AddLayerAuthors=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.add_layer_coauthors,data:e,showLoading:!1,vital:!1,onSuccess:function(){t([])},onUnauthorizedError:function(e){e.responseJSON&&e.responseJSON.invalidCoauthorUserIds&&t(e.responseJSON.invalidCoauthorUserIds)}})},t.AddFolderCoauthors=function(e,t,n){s.ajax({type:"POST",url:alcfg.node.workspace.add_folder_coauthors,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)},onBadRequestError:function(e){e.responseJSON&&e.responseJSON.invalidCoauthorUserIds&&n(e.responseJSON.invalidCoauthorUserIds)}})},t.RemoveCoauthor=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace["remove_"+(sCH.userM.get("UserId")===e.coauthorUserId?"selfas_":"")+"layer_coauthor"],data:e,showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)}})},t.RemoveFolderCoauthor=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace["remove_"+(sCH.userM.get("UserId")===e.userId?"self_asfoldercoauthor":"folder_coauthor")],data:e,showLoading:!1,vital:!1,onSuccess:function(e){t&&t(e)}})},t.GetSectionTags=function(e,t){var n={textSectionId:e.textSectionId,readerType:e.type,tagTypesToFetch:e.tagTypesToFetch,isStudentStruggling:e.isStudentStruggling,isPreview:e.isPreview};e.assignmentId?n.assignmentId=e.assignmentId:e.studentLayerId&&(n.studentLayerId=e.studentLayerId),e.layerId&&(n.layerId=e.layerId),s.ajax({type:"GET",url:alcfg.node.reader.get_tags,data:n,showLoading:!1,vital:!0,timeout:6e4,onSuccess:function(e){e&&t(e)}})},t.GetNotesSummaryViewTags=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.summary_view_notes,data:{assignmentId:e.assignmentId,layerId:e.layerId,studentLayerId:e.studentLayerId,omitTextSectionIds:e.omitTextSectionIds.join(","),readerType:e.type,isPreview:e.isPreview},showLoading:!0,vital:!0,timeout:6e4,onSuccess:function(e){e&&t(e)}})},t.GetNoteRepliesForStudent=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader_grading.get_note_replies_student,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.GetQuestionSummaryViewTags=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.get_reader_summary_questions,data:{omitTextSectionIds:e.omitTextSectionIds.join(","),layerId:e.layerId,assignmentId:e.assignmentId,studentLayerId:e.studentLayerId,readerType:e.type,isPreview:e.isPreview},showLoading:!0,vital:!0,timeout:6e4,onSuccess:function(e){e&&t(e)}})},t.IRLinkBroken=function(e,t){s.ajax({type:"POST",url:alcfg.node.independent_reading.link_broken,data:e,showLoading:!1,onSuccess:function(e){e&&t(e)}})},t.SaveManualLogData=function(e,t){s.ajax({type:"POST",url:alcfg.node.independent_reading.save_manual_log_data,data:e,showLoading:!1,vital:!0,timeout:6e4,onSuccess:function(e){e&&t(e)}})},t.GetTeachersData=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_teachers_data,data:e,vital:!0,timeout:18e4,onSuccess:function(e){t(e)}})},t.GetTeacherActivityTimelineData=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_teacher_activity_timeline_data,data:e,vital:!0,timeout:18e4,onSuccess:function(e){t(e)}})},t.MasqueradeTeacherActivityTimelineData=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.masquerade_teacher_activity_timeline_data,data:e,vital:!0,timeout:12e4,onSuccess:function(e){t(e)}})},t.GetSchoolData=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_school_proficiency_by_grade,data:e,showLoading:!0,vital:!0,timeout:3e4,onSuccess:function(e){t(e)}})},t.GetDistrictProficiencyData=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_district_proficiency,data:e,showLoading:!0,vital:!0,timeout:12e4,onSuccess:function(e){t(e)}})},t.ClaimPrimeCode=function(e,t){s.ajax({type:"POST",url:alcfg.node.payment.claim_prime_code,data:e,showLoading:!1,vital:!0,onSuccess:function(e){t(e)}})},t.SubmitFeedbackForLayer=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.submit_layer_feedback,data:e,showLoading:!0,vital:!1,onSuccess:function(){t()}})},t.SubmitAssignmentForReview=function(e){s.ajax({type:"POST",url:alcfg.node.professional_learning.review_assignment,data:e,vital:!1,onSuccess:function(){}})},t.AddLayerTextSectionDirections=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.add_layer_textsection_directions,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)}})},t.DeleteLayerTextSectionDirections=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.delete_layer_textsection_directions,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)}})},t.LockAssignment=function(e,t){s.ajax({type:"POST",url:l.default.isMath?alcfg.mathApis.lock:alcfg.node.class_assignment.lock,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e.Success)},onError:function(){t(!1)}})},t.UnlockAssignment=function(e,t){s.ajax({type:"POST",url:l.default.isMath?alcfg.mathApis.unlock:alcfg.node.class_assignment.unlock,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e.Success)},onError:function(){t(!1)}})},t.ClearLockForAssignment=function(e,t){s.ajax({type:"POST",url:l.default.isMath?alcfg.mathApis.clearlock:alcfg.node.class_assignment.clearlock,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.MarkStruggling=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_roster.mark_struggling,data:e,vital:!1,onSuccess:function(){t(!0)}})},t.SyncWithGoogleCourse=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_roster.sync_withgooglecourse,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){t(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},t.SyncGradebookWithGoogleCourse=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.sync_gradebookwithgooglecourse,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){t(e),Backbone.pubEv.trigger("loadingShowHide",!1)},onError:function(){t(),Backbone.pubEv.trigger("loadingShowHide",!1)}})},t.SyncGradebookWithLTICourse=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.sync_gradebook_with_lti,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){t(e),Backbone.pubEv.trigger("loadingShowHide",!1)},onError:function(e){t({responseText:e.responseText,status:e.status,statusText:e.statusText})}})},t.SyncGradebookWithCanvas=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.sync_gradebook_with_canvas,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){t(e),Backbone.pubEv.trigger("loadingShowHide",!1)},onError:function(e){t(e)}})},t.SyncGradebookWithSchoology=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.sync_gradebook_with_schoology,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){t(e),Backbone.pubEv.trigger("loadingShowHide",!1)},onError:function(e){t(e)}})},t.reviseRequestedResponses=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.revise_requested_responses,data:e,showLoading:!0,vital:!1,onSuccess:function(){t()}})},t.CancelTeacherPersonal=function(e,t){s.ajax({type:"POST",url:alcfg.node.payment.cancel_teacher_personal,data:e,showLoading:!0,vital:!0,onSuccess:function(){t(!0)},onError:function(e){t(!1,s.getErrorTextFromResponse(e))}})},t.GetMembershipDetails=function(e){s.ajax({type:"GET",url:alcfg.node.profile.get_membership_details,showLoading:!0,vital:!0,onSuccess:function(t){e(t)},onError:function(e){e&&e.responseJSON&&e.responseJSON.message?s.bootstrap.alert({message:e.responseJSON.message,alert:"danger"}):s.showErrorPopup()}})},t.ToggleLayerAsQuiz=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.toggle_as_quiz,data:e,showLoading:!0,vital:!0,onSuccess:function(){t(!0)}})},t.ToggleRandomizeQuestionOrder=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.toggle_randomize_question_order,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.ChangeUserName=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.change_username,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(null,e)},onError:function(e){t(s.getErrorTextFromResponse(e))}})},t.ChangeSchool=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.change_school,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.AddReadingLog=function(e,t){s.ajax({type:"POST",url:alcfg.node.independent_reading.add_readinglog,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.RemoveStudents=function(e,t,n){s.ajax({type:"POST",url:alcfg.node.class_roster["remove_"+e.source+"_student"],data:e,showLoading:!0,vital:!0,onSuccess:function(e){t&&t(e)},onError:function(e){n&&n(e)},onUnauthorizedError:function(e){n&&n(e)}})},t.MoveResearch=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_research.move_to_class,data:e,showLoading:!0,vital:!0,onSuccess:function(){t(!0)},onError:function(e){t(!1,s.getErrorTextFromResponse(e))}})},t.GetClassPeers=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_research.get_peers,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.AddResearchCoauthors=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_research.add_coauthors,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.MarkReadNotification=function(e){s.ajax({type:"POST",url:alcfg.node.reader.mark_notifications_read,data:e,onSuccess:function(){}})},t.MarkAllReadNotifications=function(){s.ajax({type:"POST",data:{assignmentId:sCH.readerConfig.assignmentId},url:alcfg.node.reader.mark_all_notifications_read,onSuccess:function(){}})},t.DeleteNotification=function(e){s.ajax({type:"POST",url:alcfg.node.reader.delete_notification,data:e,onSuccess:function(){}})},t.GetTeacherAssignments=function(e,t){s.ajax({type:"GET",url:alcfg.node.teacher_report.teacher_assignments,data:e,onSuccess:function(e){t&&t(e)}})},t.GetCoachingReportOverview=function(e,t){s.ajax({type:"GET",url:alcfg.node.coaching_report.get_overview_data,data:e,timeout:12e4,onSuccess:function(e){t&&t(e)}})},t.GetPLOverviewData=function(e,t){s.ajax({type:"GET",url:alcfg.node.coaching_report.get_pl_overview_data,data:e,onSuccess:function(e){t&&t(e)}})},t.GetTeacherQuestions=function(e,t){var n=window.location.hash.indexOf("professionallearning")>-1?"professional_learning":"teacher_report";s.ajax({type:"GET",url:alcfg.node[n].teacher_questions,timeout:6e4,data:e,onSuccess:function(e){t&&t(e)}})},t.GetGradingFeedback=function(e,t){var n=window.location.hash.indexOf("professionallearning")>-1?"professional_learning":"teacher_report";s.ajax({type:"GET",url:alcfg.node[n].teacher_grading_feedback,data:e,onSuccess:function(e){t&&t(e)}})},t.GetStudentActivityAdminReport=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_student_activity_data,data:e,showLoading:!0,vital:!0,timeout:3e4,onSuccess:function(e){t(e)}})},t.EmailStudentActivityAdminReport=function(e,t){s.ajax({type:"POST",url:alcfg.node.school_report.email_school_student_activity,data:e,onSuccess:function(e){t(!0)},onError:function(){t(!1)}})},t.MarkQuestionDoNotGrade=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.toggle_question_donotgrade,data:e,onSuccess:function(e){t&&t(e)}})},t.AllowRevision=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.allow_revision,data:e,onSuccess:function(e){t&&t(e)}})},t.EmailCsvReport=function(e,t){s.ajax({type:"POST",url:alcfg.node.school_report.email_csv_report,data:e,onSuccess:function(){t&&t(!0)},onError:function(){t&&t(!1)}})},t.GetUserPermissionsData=function(e,t){s.ajax({type:"GET",url:alcfg.node.manageusers.get_user_permissions,data:e,onSuccess:function(e){t&&t(e)}})},t.GetAccountsData=function(e,t){s.ajax({type:"GET",url:alcfg.node.manageusers.getaccounts,data:e,onSuccess:function(e){t&&t(e)}})},t.GetSchoolBookCreditsData=function(e,t){s.ajax({type:"GET",url:alcfg.node.manageusers.getschoolbookcreditsdata,data:e,onSuccess:function(e){t&&t(e)},onError:function(){t&&t({Success:!1})}})},t.UpdateUserSchoolMaps=function(e,t){s.ajax({type:"POST",url:alcfg.node.manageusers.update_userschoolmaps,data:e,onSuccess:function(e){t&&t(e)}})},t.ToggleUserPermission=function(e,t){s.ajax({type:"POST",url:alcfg.node.manageusers.toggle_permission,data:e,onSuccess:function(e){t&&t(e)}})},t.DeleteTeacherAccount=function(e,t){s.ajax({type:"POST",url:alcfg.node.manageusers.delete_teacheraccount,data:e,onSuccess:function(e){t&&t(e)}})},t.GetCitations=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_research.get_citations,data:e,onSuccess:function(e){t&&t(e)}})},t.UpdateNoteCategory=function(e,t,n){s.ajax({type:"POST",url:t,data:e,onSuccess:function(e){n&&n(e)}})},t.DeleteNoteCategory=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.delete_note_category,data:e,onSuccess:function(e){t&&t(e)}})},t.EditHyperlink=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.edit_hyperlink,data:e,onSuccess:function(e){t(e)}})},t.DeleteMarker=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.delete_marker,data:e,onSuccess:function(e){t(e)},onError:function(e,n){t(!1,n,this)}})},t.AddMarker=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.add_marker,data:e,onSuccess:function(e){t(e)},onError:function(e,n){t(!1,n,this)}})},t.StudentClassMaps=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_roster.student_class_list,data:e,onSuccess:function(e){t&&t(e)}})},t.SwitchClass=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_roster.switch_student_class,data:e,onSuccess:function(e){t&&t(e)},onError:function(){t&&t({Success:!1})}})},t.GetBookCreditsData=function(e){s.ajax({type:"GET",url:alcfg.node.payment.get_book_credits_data,onSuccess:function(t){e&&e(t)}})},t.GetDeletedStudentsList=function(e,t){s.ajax({type:"GET",data:{classId:e},url:alcfg.node.class_roster.deleted_student_list,onSuccess:function(e){t&&t(e)}})},t.UndeleteStudents=function(e,t){s.ajax({type:"POST",data:e,url:alcfg.node.class_roster.reenroll_students,onSuccess:function(e){t&&t(e)}})},t.MergeTexts=function(e,t){var n=parseInt($(".folder.selected").data("folderid"));n>0&&!isNaN(n)&&(e.folderId=n),s.ajax({type:"POST",data:e,url:alcfg.node.workspace.merge_texts,onSuccess:function(e){t&&t(e)}})},t.GetLibraryData=function(e,t){s.ajax({type:"GET",data:e,url:alcfg.node.library.list,onSuccess:function(e){t&&t(e)}})},t.GetSectionsWithStudentData=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader_authoring.get_sections_with_student_data,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.HideLayerSections=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.hide_sections,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)},onError:function(){t(!1)}})},t.Passed10Percent=function(e){s.ajax({type:"POST",data:e,url:alcfg.node.payment.passed10percent,onSuccess:function(){}})},t.UpdateNoteCategoryDefaults=function(e,t){this.UpdateStandaloneSetting({settings:e,settingKey:"defaultNoteCategories"},t)},t.OEmbed=function(e,t){sCH.readerConfig.oEmbedCache||(sCH.readerConfig.oEmbedCache=[]);var n=r.find(sCH.readerConfig.oEmbedCache,{url:e.url});if(n)return t(n.response);sCH.readerConfig&&(e.layerId=sCH.readerConfig.layerId),s.ajax({type:"GET",data:e,url:alcfg.node.reader.oembed,cache:!0,showLoading:!1,silentError:!0,onSuccess:function(a){!n&&sCH.readerConfig.oEmbedCache&&sCH.readerConfig.oEmbedCache.push({url:e.url,response:a}),t(a)},onError:function(e){t({errorMessage:e.responseText})}})},t.ArchiveAssignment=function(e,t){s.ajax({type:"POST",data:e,url:l.default.isMath?alcfg.mathApis.archive:alcfg.node.class_assignment.archive,onSuccess:function(e){t&&t(e)}})},t.UnarchiveAssignment=function(e,t){s.ajax({type:"POST",data:e,url:l.default.isMath?alcfg.mathApis.unarchive:alcfg.node.class_assignment.unarchive,onSuccess:function(e){t&&t(e)}})},t.GetArchivedAssignments=function(e,t){s.ajax({type:"GET",data:e,url:l.default.isMath?alcfg.mathApis.get_archived_list:alcfg.node.class_assignment.archived_list,onSuccess:function(e){t&&t(e)}})},t.GetProfessionalLearningData=function(e){s.ajax({type:"GET",url:alcfg.node.professional_learning.data,onSuccess:function(t){e&&e(t)}})},t.GetProfessionalLearningCompletionReport=function(e){s.ajax({type:"GET",url:alcfg.node.professional_learning.get_completion_report,data:{schoolId:sCH.selectedSchoolId},onSuccess:function(t){e&&e(t)}})},t.UpdateProfessionalLearningCompletion=function(e){s.ajax({type:"POST",url:alcfg.node.professional_learning.update_completion,data:e,onSuccess:function(){}})},t.MergeStudentAccounts=function(e,t){s.ajax({type:"POST",data:e,url:alcfg.node.class_roster.merge_student_accounts,onSuccess:function(e){t&&t(e)},onError:function(){t&&t(!1)}})},t.GetWorkspaceFolders=function(e,t){e?s.ajax({type:"GET",url:alcfg.node.workspace.get_folders,showLoading:!0,onSuccess:function(e){t&&t(e)}}):t()},t.GetLayersInFolder=function(e,t){s.ajax({type:"GET",data:e,url:alcfg.node.workspace.get_layers_in_folder,showLoading:!0,onSuccess:function(e){t&&t(e)}})},t.AddFolder=function(e,t,n){e&&s.attachSchoolDistrictId(t),s.ajax({type:"POST",url:e?alcfg.node.library.add_folder:alcfg.node.workspace.add_folder,data:t,onSuccess:function(e){n&&n(e)}})},t.EditFolderName=function(e,t,n){e&&s.attachSchoolDistrictId(t),s.ajax({type:"POST",url:e?alcfg.node.library.edit_folder:alcfg.node.workspace.edit_folder,data:t,onSuccess:function(e){n&&n(e)}})},t.MoveFolder=function(e,t,n){e&&s.attachSchoolDistrictId(t),s.ajax({type:"POST",url:e?alcfg.node.library.move_folder:alcfg.node.workspace.move_folder,data:t,onSuccess:function(e){n&&n(e)}})},t.DeleteFolder=function(e,t,n){e&&s.attachSchoolDistrictId(t),s.ajax({type:"POST",url:e?alcfg.node.library.delete_folder:alcfg.node.workspace.delete_folder,data:t,onSuccess:function(e){n&&n(e)}})},t.MoveLayerToFolder=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.move_layer,data:e,onSuccess:function(e){t&&t(e)}})},t.GetAppVersion=function(e){s.ajax({type:"GET",url:alcfg.api.both.version,data:{},showLoading:!1,vital:!1,onSuccess:function(t){e(t)}})},t.GetAssignmentSplitData=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_gradebook.assignment_split_data,data:e,onSuccess:function(e){t(e)}})},t.SplitAssignment=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.split_assignment,data:e,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.UnsplitAssignment=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_gradebook.unsplit_assignment,data:e,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.CreateLayerTextSectionExcerpt=function(e,t){s.ajax({type:"POST",url:alcfg.node.workspace.create_layer_textsection_excerpt,data:e,onSuccess:function(e){t(e)}})},t.GetIRCatalogSettings=function(e){s.ajax({type:"GET",url:alcfg.node.independent_reading.get_catalog_settings,onSuccess:function(t){e(t)}})},t.UpdateIRCatalogSettings=function(e,t){s.ajax({type:"POST",url:alcfg.node.independent_reading.update_catalog_settings,data:e,onSuccess:function(e){t(e)}})},t.MoveNote=function(e){s.ajax({type:"POST",url:alcfg.node.internal.move_note,data:e,onSuccess:{},onError:function(){alert("error")}})},t.AddGradingTagToResponse=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.add_tag_question_response,data:e,onSuccess:function(e){t(e)}})},t.RemoveGradingTagFromResponse=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_grading.remove_tag_question_response,data:e,onSuccess:function(e){t(e)}})},t.GetResponsesWithGradingTags=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader_grading.get_responses_with_grading_tags,data:e,onSuccess:function(e){t(e)}})},t.AllocateLicenseToTeacher=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.allocate_license,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},t.MarkProductUpdateMessageSeen=function(e,t){s.ajax({type:"POST",url:alcfg.node.user.mark_product_update_message_seen,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.ToggleClassHiddenState=function(e,t){s.ajax({type:"POST",url:alcfg.node.class.toggle_class_hidden_state,data:e,showLoading:!1,vital:!1,onSuccess:function(){t&&t()}})},t.GetSchoolProficiencyByContentType=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_school_proficiency_by_contentType,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.GetSchoolProficiencyByGradeLevel=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.get_school_proficiency_by_gradeLevel,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)}})},t.SaveTeachingIdeas=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.save_teaching_ideas,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t&&t(e)},onError:function(){t&&t(!1)}})},t.DeleteTeachingIdeas=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.delete_teaching_ideas,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t&&t(e)}})},t.GetLayerShareData=function(e,t){s.ajax({type:"GET",url:alcfg.node.workspace.get_layer_share_data,data:e,onSuccess:function(e){t(e)}})},t.UpdateFirstLastName=function(e,t){s.ajax({type:"POST",url:alcfg.node.profile.update_first_last_name,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetMultipleAttributionInfo=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.get_multiple_attribution_info,data:e,onSuccess:function(e){t(e)}})},t.UnassignLayerFromClass=function(e,t){s.ajax({type:"POST",url:l.default.isMath?alcfg.mathApis.unassign:alcfg.node.class_assignment.unassign,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)}})},t.SaveTextSectionSummary=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.save_textsection_summary,data:e,showLoading:!0,vital:!1,onSuccess:function(){t()}})},t.GetTextSectionSummary=function(e,t){s.ajax({type:"GET",url:alcfg.node.reader.get_textsection_summary,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.DeleteTextSectionSummary=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.delete_textsection_summary,data:e,showLoading:!0,vital:!1,onSuccess:function(){t()}})},t.GetGenres=function(e){if(sCH.IRGenres)return e(sCH.IRGenres);s.ajax({type:"GET",url:alcfg.node.independent_reading.get_genres,showLoading:!1,vital:!0,onSuccess:function(t){sCH.IRGenres=t,e(t)}})},t.GetGoogleClasses=function(e,t){s.ajax({type:"GET",url:alcfg.node.class.get_google_classes,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.EditTextSection=function(e,t){s.ajax({type:"POST",url:alcfg.node.reader_authoring.fix_text_errors,data:e,showLoading:!0,vital:!1,onSuccess:function(){t()}})},t.UpdateSmallGroup=function(e,t){s.ajax({type:"POST",data:e,url:alcfg.node.class["update_"+(e.assignmentId?"assignment":"class")+"_small_group"],onSuccess:function(e){t(e)}})},t.DisableSmallGroup=function(e,t){s.ajax({type:"POST",data:e,url:alcfg.node.class["disable_"+(e.assignmentId?"assignment":"class")+"_small_group"],onSuccess:function(e){t(e)}})},t.GetSmallGroup=function(e,t){s.ajax({type:"GET",data:e,showLoading:!0,url:alcfg.node.class["get_"+(e.assignmentId?"assignment":"class")+"_small_group"],onSuccess:function(e){t(e)}})},t.GetStudentsFromAllClasses=function(e){s.ajax({type:"GET",showLoading:!0,url:alcfg.node.class.get_students_from_allclasses,onSuccess:function(t){e(t)}})},t.GetSourcesWithAPIAccess=function(e){var t=sCH.userM.get("APIAccess");t?e(t):s.ajax({type:"GET",showLoading:!0,url:alcfg.node.user.get_source_with_api_access,onSuccess:function(t){sCH.userM.set("APIAccess",t),e(t)}})},t.ProcessMediaURLNotFoundInReader=function(e){s.ajax({type:"POST",data:e,showLoading:!1,vital:!1,silentError:!0,url:alcfg.node.reader.process_media_url_notfound,onSuccess:function(){}})},t.MasqueradeSchoolReport=function(e,t){s.ajax({type:"GET",url:alcfg.node.school_report.masquerade_school_report,data:e,vital:!0,timeout:18e4,onSuccess:function(e){t(e)}})},t.PurchaseText=function(e,t){s.ajax({type:"POST",url:alcfg.node.catalog.purchase,data:e,timeout:24e3,showLoading:!0,vital:!0,onSuccess:function(e){t(e)},onError:function(){s.bootstrap.alert({alert:"danger",message:alcfg.alertsText.paymentError})}})},t.RequestRental=function(e,t){s.ajax({type:"POST",url:alcfg.node.catalog.rental_request_to_admin,data:e,timeout:24e3,showLoading:!0,vital:!0,onSuccess:function(e){t(e)},onError:function(){s.bootstrap.alert({alert:"danger",message:alcfg.alertsText.requestFailed})}})},t.SyncAssignmentsWithCanvas=function(e,t){s.ajax({type:"POST",url:alcfg.node.class_assignment.sync_assignments_with_canvas,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.GetStudentDataMastery=function(e,t){s.ajax({type:"GET",url:alcfg.mathApis.get_student_mastery_data,data:e,showLoading:!0,vital:!1,isMathAPI:!0,onSuccess:function(e){t(e)}})},t.GetStudentDataIntervention=function(e,t){s.ajax({type:"GET",url:alcfg.mathApis.get_student_intervention_data,data:e,showLoading:!0,vital:!1,isMathAPI:!0,onSuccess:function(e){t(e)}})},t.GetClassDataMastery=function(e,t){s.ajax({type:"GET",url:alcfg.mathApis.get_class_mastery_data,data:e,isMathAPI:!0,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetClassDataInterventionByStudent=function(e,t){s.ajax({type:"GET",url:alcfg.mathApis.get_class_intervention_data_by_student,data:e,isMathAPI:!0,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetClassDataInterventionByAssignment=function(e,t){s.ajax({type:"GET",url:alcfg.mathApis.get_class_intervention_data_by_assignment,data:e,isMathAPI:!0,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetAssignmentsWithInterventions=function(e,t){s.ajax({type:"GET",url:alcfg.mathApis.get_assignments_with_interventions,data:e,showLoading:!0,vital:!1,isMathAPI:!0,onSuccess:function(e){t(e)}})},t.AssignIntervention=function(e,t){s.ajax({type:"POST",url:alcfg.mathApis.assign_intervention,data:e,isMathAPI:!0,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.AddToStudentLibrary=function(e,t){s.ajax({type:"POST",url:alcfg.node.library.add_to_student_library,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.RemoveFromStudentLibrary=function(e,t){s.ajax({type:"POST",url:alcfg.node.library.remove_from_student_library,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.GetSyncedAssignments=function(e,t){s.ajax({type:"GET",url:alcfg.node.class_gradebook.get_synced_assignments,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)}})},t.TrackEventAutopilot=function(e){s.ajax({type:"POST",url:alcfg.node.events.track_event_autopilot,data:e,showLoading:!1,vital:!1,onSuccess:function(e){}})},t.DisableCovidPrimeExpiryAlertForSession=function(){s.ajax({type:"POST",url:alcfg.node.user.disable_covid_prime_expiry_alert_for_session,onSuccess:function(e){}})},t.GetImportCountFromSourceForMonth=function(e,t){s.ajax({type:"GET",url:alcfg.node.workspace.get_import_count_for_url,data:e,showLoading:!1,vital:!1,onSuccess:function(e){t(e)}})},t.GetIsCopyrightWarningConfirmed=function(e){s.ajax({type:"GET",url:alcfg.node.workspace.get_confirmed_copyright_warning,showLoading:!1,vital:!1,onSuccess:function(t){e(t)}})}},,,,function(e,t,n){"use strict";var a,s,i,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.CATALOG=1]="CATALOG",e[e.WORKSPACE=2]="WORKSPACE",e[e.LIBRARY=3]="LIBRARY",e[e.ASSIGNMENTS=4]="ASSIGNMENTS",e[e.INSTRUCTION_REPORT=5]="INSTRUCTION_REPORT",e[e.RESEARCH=6]="RESEARCH",e[e.BOOKSHELF=7]="BOOKSHELF",e[e.IRCATALOG=8]="IRCATALOG"}(t.Page||(t.Page={})),function(e){e[e.ZERO=0]="ZERO",e[e.INCOMPLETE=1]="INCOMPLETE",e[e.BASIC=2]="BASIC",e[e.PROFICIENT=3]="PROFICIENT",e[e.ADVANCED=4]="ADVANCED"}(t.Grades||(t.Grades={})),function(e){e.NO_ACCOUNT="no account",e.WRONG_PASSWORD="wrong password",e.STUDENT_ACCOUNT_EXISTS="student account exists",e.TEACHER_ACCOUNT_EXISTS="teacher account exists",e.NATIVE_ACCOUNT_EXISTS="native account exists",e.GOOGLE_ACCOUNT_EXISTS="google account exists",e.OFFICE365_ACCOUNT_EXISTS="office365 account exists",e.CANVAS_ACCOUNT_EXISTS="canvas account exists",e.BRIGHTSPACE_ACCOUNT_EXISTS="brightspace account exists",e.SCHOOLOGY_ACCOUNT_EXISTS="schoology account exists",e.ONEROSTER_ACCOUNT_EXISTS="oneroster account exists",e.EDMODO_ACCOUNT_EXISTS="edmodo account exists",e.CLEVER_ACCOUNT_EXISTS="clever account exists",e.CLEVER_REQUIRED="clever required",e.INVALID_DOMAIN="invalid domain",e.STEP2="step2",e.INVALID_TOKEN="invalid token",e.TOKEN_EXPIRED="token expired",e.INVALID_CLASS_CODE="invalid class code",e.INVALID_CLASS_CODE_GOOGLE="invalid class code google",e.HAS_GOOGLE_COURSE_JOINS="has google course joins",e.GOOGLE_SIGNOUT_SHARED_DEVICE="google shared device signout reminder",e.UNKNOWN="unknown error",e.MAX_INCORRECT_PASSWORD_REACHED="max incorrect password reached",e.EMAIL_DOMAIN_DISALLOWED="email domain disallowed"}(a=t.AuthError||(t.AuthError={})),function(e){e.NATIVE="native",e.GOOGLE="google",e.CANVAS="canvas",e.BRIGHTSPACE="brightspace",e.SCHOOLOGY="schoology",e.LTI="lti",e.EDMODO="edmodo",e.CLEVER="clever",e.OFFICE365="office365",e.ONEROSTER="oneroster",e.ACHIEVE3K="achieve3k"}(s=t.UserAccountSource||(t.UserAccountSource={})),function(e){e.NATIVE="a username and password",e.GOOGLE="Google",e.CANVAS="Canvas",e.BRIGHTSPACE="Brightspace",e.SCHOOLOGY="Schoology",e.EDMODO="Edmodo",e.CLEVER="Clever",e.OFFICE365="Office",e.ONEROSTER="school portal",e.ACHIEVE3K="Achieve3000"}(i=t.UserAccountService||(t.UserAccountService={})),t.UserAccountSourceAccountExistsErrorMap=[{source:s.NATIVE,service:i.NATIVE,error:a.NATIVE_ACCOUNT_EXISTS},{source:s.GOOGLE,service:i.GOOGLE,error:a.GOOGLE_ACCOUNT_EXISTS},{source:s.CLEVER,service:i.CLEVER,error:a.CLEVER_ACCOUNT_EXISTS},{source:s.EDMODO,service:i.EDMODO,error:a.EDMODO_ACCOUNT_EXISTS},{source:s.CANVAS,service:i.CANVAS,error:a.CANVAS_ACCOUNT_EXISTS},{source:s.BRIGHTSPACE,service:i.BRIGHTSPACE,error:a.BRIGHTSPACE_ACCOUNT_EXISTS},{source:s.SCHOOLOGY,service:i.SCHOOLOGY,error:a.SCHOOLOGY_ACCOUNT_EXISTS},{source:s.ONEROSTER,service:i.ONEROSTER,error:a.ONEROSTER_ACCOUNT_EXISTS},{source:s.OFFICE365,service:i.OFFICE365,error:a.OFFICE365_ACCOUNT_EXISTS}],function(e){e.TEACHER="teacher",e.INSTRUCTIONAL_COACH="instructional coach",e.DEPARTMENT_HEAD="department head",e.SCHOOL_ADMINISTRATOR="school administrator",e.DISTRICT_ADMINISTRATOR="district administrator"}(o=t.EducatorType||(t.EducatorType={})),function(e){e[e.CATALOG_TILE=0]="CATALOG_TILE",e[e.PREVIEW_READER=1]="PREVIEW_READER",e[e.TEACHER_READER=2]="TEACHER_READER",e[e.NEED_MORE_WHILE_ASSIGNING=3]="NEED_MORE_WHILE_ASSIGNING",e[e.MANAGE_LICENSES=4]="MANAGE_LICENSES",e[e.WORKSPACE_TILE=5]="WORKSPACE_TILE"}(t.LearnEntityPurchaseSource||(t.LearnEntityPurchaseSource={})),t.UserGradeLevels=[{value:1,label:"Grade 2 - 3"},{value:2,label:"Grade 4 - 5"},{value:3,label:"Grade 6 - 8"},{value:4,label:"Grade 9 - 12"},{value:5,label:"Higher Education"}],t.GradeLevels=[{value:2,label:"2nd Grade"},{value:3,label:"3rd Grade"},{value:4,label:"4th Grade"},{value:5,label:"5th Grade"},{value:6,label:"6th Grade"},{value:7,label:"7th Grade"},{value:8,label:"8th Grade"},{value:9,label:"9th Grade"},{value:10,label:"10th Grade"},{value:11,label:"11th Grade"},{value:12,label:"12th Grade"},{value:13,label:"Adult Learners"}],t.GradeToGradeLevelMap={"2nd grade":"Grades 2-3","3rd grade":"Grades 2-3","4th grade":"Grades 4-5","5th grade":"Grades 4-5","6th grade":"Grades 6-8","7th grade":"Grades 6-8","8th grade":"Grades 6-8","9th grade":"Grades 9-12","10th grade":"Grades 9-12","11th grade":"Grades 9-12","12th grade":"Grades 9-12","13th grade":"Adult Learners"},t.UserSubjects=[{value:1,label:"ELA"},{value:2,label:"Social Studies"},{value:3,label:"Science"},{value:4,label:"Math"},{value:5,label:"World Languages"},{value:7,label:"Special Education"},{value:6,label:"Other"}],t.SubjectSlugSubjectMap={ela:"ELA",science:"Science","social-studies":"Social Studies"},t.UserSignupTitles=[{value:"Mr.",label:"Mr."},{value:"Mrs.",label:"Mrs."},{value:"Ms.",label:"Ms."},{value:"Mx.",label:"Mx."},{value:"Dr.",label:"Dr."}],t.TeacherEducatorTypes=[{value:o.TEACHER,label:"Teacher"},{value:o.INSTRUCTIONAL_COACH,label:"Instructional coach"},{value:o.DEPARTMENT_HEAD,label:"Department head"},{value:o.SCHOOL_ADMINISTRATOR,label:"School administrator"},{value:o.DISTRICT_ADMINISTRATOR,label:"District administrator"}],t.UserOrigin=[{value:"colleague",label:"A colleague"},{value:"conference",label:"Conference"},{value:"google",label:"Google search"},{value:"facebook or instagram",label:"Facebook or Instagram"},{value:"other",label:"Other"}],t.topicBucketsToSortByRecency=["News","High-Interest"],t.emailRegex=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,t.professionalLearningHelpText={heading:"Learn the key practices to Activate, Support, and Reveal student thinking while reading!\n  Select instructional practices that you wish to improve. For each practice:",bulletPoints:["Learn by reading an overview lesson.","Try by working on a scaffolded activity. Your colleagues will be able to see your responses.","Implement in Actively Learn by watching the video and integrating the practice into your instruction.","Demonstrate by completing a micro-credential certified by Digital Promise."]},function(e){e.NATIVE="native",e.GOOGLE="google",e.LTI="lti",e.EDMODO="edmodo",e.CLEVER="clever",e.CANVAS="canvas",e.BRIGHTSPACE="brightspace",e.SCHOOLOGY="schoology",e.ONEROSTER="oneroster",e.ACHIEVE3K="achieve3k"}(t.ClassSource||(t.ClassSource={})),t.blockedCatalogSearchTerms=["the","and"],t.contentTypes=[{value:1,label:"Literature"},{value:2,label:"Informational"},{value:3,label:"Science"},{value:5,label:"Other"}],t.CovidIRStatus=1,t.CovidPaidTextsToBeMadeFree=[219804,220449,220496,220503,220793,220824,220828,221790,221805,222999,223002,223313,223317,223320,224509,224522,224538,224970,224979,224994,227417,227452,211875,227544,227589,227630,230208,230224,230235,230247,230258,230265,232722,232729,232755,232780,232783,232785,232786,244470,244484,244556,244561,244744,248257,248384,248426,248435,248440,248441,249975,249976,249982,249983,253864,253929,253938,254487,254488,254489,257160,257167,257176,257275,257278,257281,258168,258178,261413,241006],t.TopicsHiddenForCovidPrimeUsers=[928],t.covidPrimeExpiryEmailBody="Hello!\r\n\r\nIve been using Actively Learn to foster engagement and equity for my students during remote learningand its a lifesaving resource! Actively Learn is an online curriculum platform for ELA, science, and social studies. My students love it and its bringing remote learning closer to the classroom experience. Heres a video overview to explain the benefits: https://activelylearn.wistia.com/medias/0guj7u557z.\r\n\r\nTemporary access to Actively Learn premium expires July 31st, but it is a much-needed tool for me and my colleagues as we head into next school year. Id be happy to share more about Actively Learn with you, or you can reach out to the Actively Learn team at info@activelylearn.com for pricing and a demo.",t.teacherActivityBarChartLabel="# of Teachers",function(e){e.USAGE="usage",e.PRACTICES="practices"}(t.TeacherActivityChartTabs||(t.TeacherActivityChartTabs={})),function(e){e.STUDENTS_LOGGED_IN="studentsLoggedIn",e.TEACHERS_LOGGED_IN="teachersLoggedIn"}(t.TimeSeriesChartTabNames||(t.TimeSeriesChartTabNames={})),t.teacherPracticesThresholds={feedback:{redThreshold:5,greenThreshold:10},annotation:{redThreshold:5,greenThreshold:10},discussion:{redThreshold:5,greenThreshold:10},questioning:{redThreshold:5,greenThreshold:10},extraHelp:{redThreshold:1,greenThreshold:1},accessibility:{redThreshold:5,greenThreshold:10},vocabulary:{redThreshold:5,greenThreshold:10},metaCognition:{redThreshold:5,greenThreshold:10},writing:{redThreshold:5,greenThreshold:10}},t.practicesChartColors=["#D32F2F","#B3B3B3","#388E3C"]},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=n(439),i=n(440),o=n(441),r=n(442),l=n(443),d=n(444);a=window.location.href.indexOf("https://read")>=0?o.default:window.location.href.indexOf("https://math.")>=0?r.default:window.location.href.indexOf("https://altestal")>=0?l.default:window.location.href.indexOf("https://math-staging.")>=0?d.default:window.location.href.indexOf("http://localhost:5002")>=0?i.default:s.default,t.default=a},,function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(11);t.mountReactComponent=function(e,n,r){return void 0===r&&(r={}),a(void 0,void 0,void 0,(function(){return s(this,(function(a){switch(a.label){case 0:return[4,t.unmountReactComponent(n)];case 1:return a.sent(),[4,o.render(i.createElement(e,r),n)];case 2:return a.sent(),n.classList.add("reactComponentMountedFromBackbone"),[2]}}))}))},t.unmountReactComponent=function(e){if(e){try{o.unmountComponentAtNode(e)}catch(e){}e.classList.remove("reactComponentMountedFromBackbone")}},t.unmountAllChildReactComponentsUnderParent=function(e){var n=e.find(".reactComponentMountedFromBackbone");if(e.hasClass("reactComponentMountedFromBackbone")&&n.push(e[0]),n.length>0)for(var a=0;a<n.length;a++)t.unmountReactComponent(n[a])}}).call(this,n(21))},,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(38),l=n(101),d=n(102),c=n(103),u=n(116),p=n(13).withStyles,h=n(150),g=n(5),f=n(34),m=n(334),v=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={chkDoNotShowAgain:!1,disableOkButton:!1,okText:n.props.okText,open:!0},n.handleClose=function(){n.state.chkDoNotShowAgain&&n.props.popupSettingKey&&g.updateDoNotShowPopupSetting(n.props.popupSettingKey),n.props.cancelCallback?n.props.cancelCallback(n):n.hideModalWithTransition()},n.handleOk=function(e){e.stopPropagation(),n.props.okCallback?(n.disableOkButton(n.props.disabledOkText),n.props.okCallback(n)):n.hideModalWithTransition()},n.hideModalWithTransition=function(){n.setState({open:!1}),setTimeout((function(){return t.hideModals()}),150)},n.onEntered=function(){n.props.onOpenCallback&&n.props.onOpenCallback(n)},n.disableOkButton=function(e){n.setState({disableOkButton:!0,okText:e||n.props.okText})},n.enableOkButton=function(e){n.setState({disableOkButton:!1,okText:e||n.props.okText})},n.handleDoNotShowAgain=function(){n.setState({chkDoNotShowAgain:!n.state.chkDoNotShowAgain})},n.handleValidationErrors=function(e){var t=document.getElementById(e[0].props.id);"hidden"===t.getAttribute("type")?t=t.parentElement.querySelector("[role='button']"):"INPUT"!==t.tagName&&(t=t.querySelector("input")),t&&t.focus()},n}return s(n,e),n.prototype.componentDidMount=function(){if(this.props.customValidations)for(var e=0,t=this.props.customValidations;e<t.length;e++){var n=t[e];f.ValidatorForm.addValidationRule(n.name,n.func)}},n.prototype.render=function(){var e=this.props.classes;return o.createElement(l.default,{role:"dialog","aria-modal":"true","aria-labelledby":"dialog-title",open:this.state.open,onEntered:this.onEntered,onClose:this.handleClose,disableBackdropClick:!this.props.allowCancel,TransitionComponent:C,maxWidth:this.props.maxWidth,classes:{root:e.root,paper:e.paper+" "+this.props.cssClass,container:e.dialogContainer},className:"modal"},this.props.title&&o.createElement(u.default,{id:"dialog-title",className:e.header},this.props.title),o.createElement(f.ValidatorForm,{className:e.form+" modal-content "+(this.props.shouldOverflow?"":e.overflowHidden),onSubmit:this.handleOk,onError:this.handleValidationErrors,margin:"dense"},this.props.children&&o.createElement(c.default,{className:e.dialogContent+" modal-body "+(this.props.shouldOverflow?e.overflowVisible:"")},this.props.children,o.createElement(b,{shouldShowDoNotShowAgainContainer:this.props.shouldShowDoNotShowAgainContainer,chkDoNotShowAgain:this.state.chkDoNotShowAgain,handleDoNotShowAgain:this.handleDoNotShowAgain})),o.createElement(d.default,null,o.createElement("div",{className:e.optionButtons},this.props.optionButtons&&this.props.optionButtons.map((function(e,t){return o.createElement(r.default,{color:"primary",role:"button",onClick:e.callback,className:["btn","btn-primary","optionButton"].join(" "),key:t},e.text)}))),o.createElement(r.default,{role:"button",onClick:this.handleClose,className:["btn","btn-primary","cancelButton"].join(" "),color:"primary"},this.props.cancelText),this.state.okText&&o.createElement(r.default,{role:"button",className:["btn","btn-primary","okButton"].join(" "),color:"primary",type:"submit",disabled:this.state.disableOkButton},this.state.okText))))},n.defaultProps={cssClass:"",allowCancel:!0,cancelText:"Cancel",shouldShowDoNotShowAgainContainer:!1,okText:"Ok"},n}(o.Component),b=function(e){var t=e.shouldShowDoNotShowAgainContainer,n=e.handleDoNotShowAgain,a=e.chkDoNotShowAgain;return t&&o.createElement("div",{role:"checkbox",className:"dontShow"},o.createElement(h.default,{checked:a,onChange:n,inputProps:{id:"chkDontShow","aria-label":"checkbox","aria-labelledby":"dontShowInfo"}}),o.createElement("span",{id:"dontShowInfo"},"Do not show this message again"))},C=o.forwardRef((function(e,t){return o.createElement(m.default,i({direction:"down",timeout:150,ref:t},e))}));t.default=p((function(){return{root:{display:"block"},paper:{fontFamily:"AvenirNextLTW02-Regular",fontSize:16,minWidth:Math.min(.9*window.innerWidth,600),overflowY:"unset",maxHeight:"calc(100% - 30px)",margin:30,"&.MuiDialog-paperWidthMd":{maxWidth:730},"& select":{fontFamily:"AvenirNextLTW02-Regular",color:"unset !important",fontSize:"inherit",padding:0},"& input":{boxSizing:"unset",width:"100% !important"},'& .MuiButtonBase-root input[type="checkbox"]':{opacity:"0"},"& label":{width:"auto !important"},"& #chkDontShow":{width:"100% !important"},"& .dontShow":{fontFamily:"AvenirNextLTW02-Medium",color:"#000",marginLeft:-15,marginTop:10,fontSize:14},"& .MuiDialogContent-root:first-child":{paddingTop:0}},dialogContent:{padding:"0 24px 8px 24px !important",margin:"0 !important",overflowY:"auto","& p":{color:"rgba(0,0,0,0.87)",fontFamily:"AvenirNextLTW02-Medium",fontSize:16},"& .MuiFormControl-root":{margin:"0.5em 0"},"&:hover":{"&::-webkit-scrollbar-thumb":{visibility:"visible"}},"&::-webkit-scrollbar":{width:7,height:7},"&::-webkit-scrollbar-thumb":{background:"rgba(0,0,0, 0.3)",borderRadius:10,visibility:"hidden"}},dialogContainer:{height:"auto",maxHeight:"100%",alignItems:"unset"},form:{display:"flex",flexDirection:"column",border:"none"},overflowHidden:{overflow:"hidden"},overflowVisible:{overflow:"visible"},optionButtons:{flexGrow:1},header:{padding:"15px 24px 0 24px","& h2":{fontFamily:"Avenir Next LT W02 Demi",fontSize:22}}}}))(v),t.showModal=function(e){return Backbone.pubEv.trigger("showModal",e)},t.hideModals=function(e){return void 0===e&&(e=1),Backbone.pubEv.trigger("hideModals",e)},t.showModalFromBackbone=function(e,t){return Backbone.pubEv.trigger("showModal",o.createElement(e,i({},t)))}},,,,,,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(463),d=l.SelectValidator,c=l.TextValidator,u=l.ValidatorForm,p=n(267);t.ValidatorForm=u,t.TextValidator=function(e){var t=e.validators,n=void 0===t?{}:t,a=e.required,s=void 0!==a&&a,l=e.label,d=e.id,u=e.name,p=e.margin,h=void 0===p?"dense":p,f=o(e,["validators","required","label","id","name","margin"]),m=g(n,s,l),v=m.rules,b=m.errorMessages;return r.createElement(c,i({},f,{id:d,name:u||d,label:l,validators:v,errorMessages:b,margin:h}))};var h=function(e){function t(t){var n=e.call(this,t)||this;return n.selectRef=r.createRef(),n}return s(t,e),t.prototype.componentDidMount=function(){var e=this.selectRef.current.querySelector('[role="button"]');e&&e.setAttribute("aria-label",f(this.props.label))},t.prototype.componentDidUpdate=function(){var e=this.selectRef.current.querySelector('[role="button"]'),t=this.selectRef.current.querySelector('input[type="hidden"]');e&&t&&t.value&&e.setAttribute("aria-label",f(this.props.label))},t.prototype.render=function(){var e=this.props,t=e.validators,n=e.required,a=e.label,s=e.id,l=e.name,c=e.margin,u=void 0===c?"dense":c,p=o(e,["validators","required","label","id","name","margin"]),h=g(t,n,a,!0),f=h.rules,m=h.errorMessages;return r.createElement("div",{ref:this.selectRef},r.createElement(d,i({},p,{id:s,name:l||s,label:a,validators:f,errorMessages:m,margin:u})))},t}(r.Component);t.SelectValidator=h;var g=function(e,t,n,a){if(!0===t){var s=a?"Please "+f(n):"Please enter the "+n.toLowerCase();e=i({required:s},e)}else"string"==typeof t&&(e=i({required:t},e));var o=!e||0===Object.keys(e).length,r=function(e){return void 0!==p[e]||-1!==e.indexOf("matchRegexp")};return{rules:o?[]:Object.keys(e).filter(r),errorMessages:o?[]:Object.keys(e).filter(r).map((function(t){return e[t]}))}};function f(e){return-1===(e=e.toLowerCase()).indexOf("select")?"select a "+e:e}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(634),s=n(635),i=n(8);t.getQueryParams=function(e){var t=e.params,n=void 0===t?[]:t,a=e.strip,o=void 0===a?null:a,r=s(window.location.href,!0);return i.reduce(r.query,(function(e,t,a){return(0===n.length||n.indexOf(a)>-1)&&(e[a]=o?t.replace(o,""):t),e}),{})},t.getHashQueryParams=function(){var e={},n=location.hash.split("?");return n.length>1&&(e=t.getParamsFromQueryString(n.pop())),e},t.getParamsFromQueryString=function(e){var t={};return e&&e.split("&").forEach((function(e){if(""!==e){var n=e.split("=");t[n[0]]=n[1]&&decodeURIComponent(n[1].replace(/\+/g," "))}})),t},t.postRedirect=function(e,t){void 0===t&&(t={});var n=window.sCH,a=document.createElement("form");a.setAttribute("method","post"),a.setAttribute("action",e);var s=function(e,t){var n=document.createElement("input");return n.setAttribute("type","hidden"),n.setAttribute("name",e),n.setAttribute("value",t),n};if(n&&n.userM&&n.userM.get("csrfToken")){var i=s("csrfToken",n.userM.get("csrfToken"));a.appendChild(i)}for(var o in t)if(t.hasOwnProperty(o))if(null===t[o]||"object"!=typeof t[o]){var r=s(o,t[o]);a.appendChild(r)}else for(var l in t[o])if(t[o].hasOwnProperty(l)){r=s(o+"["+l+"]",t[o][l]);a.appendChild(r)}document.body.appendChild(a),a.submit()},t.addToNavigationHistory=function(e){window.history.pushState&&e!==window.location.hash&&window.history.pushState(null,null,e)},t.replaceBrowserNavigationHistory=function(e){window.history.replaceState&&window.history.replaceState(null,null,e)},t.updateHashQueryStringParam=function(e,n,a){var s=t.getHashQueryParams();if(s[e]!==n){null===n?delete s[e]:s[e]=n;var i=o(window.location.hash.split("?")[0],t.generateUrlQueryStringFromParams(s));a?t.replaceBrowserNavigationHistory(i):t.addToNavigationHistory(i)}};var o=function(e,t){var n="/"===e.slice(-1);return 0===t.length?n?e.slice(0,-1):e:e+(n?"?":"/?")+t};t.getSlug=function(e){return a(e,{lower:!0})},t.generateUrlQueryStringFromParams=function(e){var t=[];return $.each(e,(function(e,n){t.push(e+"="+encodeURIComponent(n))})),t.join("&")},t.getPathNameWithoutHash=function(e){return e&&e.includes("#")?e.split("#")[1]:e},t.replaceQueryStringParam=function(e){var n=o(window.location.hash.split("?")[0],t.generateUrlQueryStringFromParams(e));t.addToNavigationHistory(n)}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(85),o=n(149),r=n(37),l={create:"POST",update:"POST",patch:"POST",delete:"POST",read:"GET"};t.default=function(e,t,n){var d=l[e],c={type:d,dataType:"json",xhrFields:{withCredentials:!0}},u=this;a.defaults(n||(n={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var p=n.url?n.url:a.result(t,"url");n.url?n.url=s.getHostName(p)+p:c.url=s.getHostName(p)+p;var h=n.attrs||t.toJSON(n);if("POST"==d&&sCH.userM&&(h.csrfToken=sCH.userM.get("csrfToken"),n.data&&(n.data.csrfToken=h.csrfToken)),c.data=JSON.stringify(h),c.data&&(c.data=r.generateUrlQueryStringFromParams(JSON.parse(c.data))),n.data&&(n.obj=n.data,n.data=r.generateUrlQueryStringFromParams(n.data)),"GET"===c.type||n.emulateJSON||(c.processData=!1),n.mainSuccess)n.success=function(e,a,s){n.mainSuccess(e,t),t.trigger("sync",t,e,n),"GET"===c.type&&t.trigger("fill",t,e,n),u.showingLoading&&(Backbone.pubEv.trigger("loadingShowHide",!1),u.showingLoading=!1),window.clearTimeout(u.timer)};else{var g=n.success;n.success=function(e,a,s){g&&g(e,a,s),t.trigger("sync",t,e,n),"GET"===c.type&&t.trigger("fill",t,e,n),u.showingLoading&&(Backbone.pubEv.trigger("loadingShowHide",!1),u.showingLoading=!1),window.clearTimeout(u.timer)}}var f=n.mainError;n.error=function(e,r,l){401!==e.status?(o.check((function(i){if(i)window.location.href.indexOf("student/reader")>0?(c.url.indexOf("add")>-1&&(n.rndId=s.getRandomInteger()),f&&f(t,"offline",n),o.saveRequestToLocalStorage(a.extend(c,n))):window.location.href.indexOf("reader/grading")>0?s.bootstrap.alert({alert:"danger",message:alcfg.alertsText.teacherOfflineMessage,autoClose:!1}):s.bootstrap.alert({alert:"danger",message:alcfg.errorTexts.connection.error.offline,autoClose:!1}),o.startReconnectCheck();else{var r=e.responseJSON?e.responseJSON.Message:"No responseJSON";f&&f(t,r,n),e&&e.statusText&&-1===["abort","Forbidden"].indexOf(e.statusText)&&rg4js("send",{error:new Error("mySync mainError online"),customData:{msg:r,xhr:e,url:n?n.url:void 0,params:n?n.data:void 0}})}})),t.trigger("error",t,e,n),u.showingLoading&&(Backbone.pubEv.trigger("loadingShowHide",!1),u.showingLoading=!1),window.clearTimeout(u.timer)):i.handleUnauthenticatedAccess()},n.complete=function(e){if($.xhrPool){var t=$.xhrPool[window.location.hash]?$.xhrPool[window.location.hash].indexOf(e):-1;t>-1&&$.xhrPool[window.location.hash].splice(t,1)}},$(".overlayWrap").is(":visible")||this.timer||(this.timer=window.setTimeout((function(){Backbone.pubEv.trigger("loadingShowHide",!0),u.showingLoading=!0,window.clearTimeout(u.timer)}),n.timerTimeout?n.timerTimeout:1500)),n.url?n.url=s.appendRequestIdAndVersionToUrl(n.url):c.url&&(c.url=s.appendRequestIdAndVersionToUrl(c.url));var m=Backbone.ajax(a.extend(c,n));return $.xhrPool=$.xhrPool||{},$.xhrPool[window.location.hash]=$.xhrPool[window.location.hash]||[],$.xhrPool[window.location.hash].push(m),t.trigger("request",t,m,n),m}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(22),i=n(645);t.openPurchasePlanModal=function(e,t){e.okText="Done",e.cssClass="modal-lg",e.cancelText=!1,e.content=$("<div>"+(e.content||"")+'<div class="premiumContainer" />'+(e.afterContent||"")+"</div>");var n=e.content.find(".premiumContainer")[0];s.mountReactComponent(i.default,n);var a=new Backbone.BootstrapModal(e).open((function(){e.triggerBackboneEventOnCancel&&Backbone.pubEv.trigger(e.triggerBackboneEventOnCancel)}));this.openHelpArticleEvent(a,e.title)},t.openHelpArticleEvent=function(e,t){alcfg.buyTeacherPopupHelpArticleLinks[t]?e.on("openHelpArticle",(function(){a.windowOpen(alcfg.buyTeacherPopupHelpArticleLinks[t],"_blank")})):e.$el.find(".btnHelpArticle").hide()},t.showBuyTeacherPopup=function(e){var t=e.title,n=e.content,s=void 0===n?"This feature is only available on our Prime plan. You can upgrade now to access this feature.":n,i=e.afterContent,o=void 0===i?"":i,r=e.triggerBackboneEventOnOkAndCancel,l=void 0===r?null:r;s=s||"This feature is only available on our Prime plan. You can upgrade now to access this feature.",this.openPurchasePlanModal({title:t+' <span class="icon-premium-lock" />',content:s,afterContent:o,triggerBackboneEventOnCancel:l},!0),a.intercom("trackEvent","paywall-"+t.replace(" ",""))},t.showBYOCLimitReachedPopup=function(e){this.openPurchasePlanModal({title:e,content:"You have reached the limit of 3 imported texts for this calendar month. You can wait until next month to add more or upgrade to a Prime plan for unlimited imports."},!0),a.intercom("trackEvent","paywall-3Imports")},t.showReviseAnswerPopup=function(){var e=new Backbone.BootstrapModal({title:"Revise Answer",content:"Students can ask their teacher to let them revise their answer.",optionButtons:[{class:"pull-left btnHelpArticle",text:"Details",event:"openHelpArticle"}],cancelText:!1,okText:"Close"}).open((function(){}));this.openHelpArticleEvent(e,"Revise Answer")},t.hidePrimeFeatureText=function(e){var t=$(e).html();$(e).html('<div class="previewPrimeFeatureText">'+t+'</div><div class="blurContainer"><div class="blurredText">'+t+"</div></div>")}},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(14),o=n(10);t.getLevelFromGrade=function(e){return e<=2?"basic":e>=3?"proficient":"average"},t.getStandardFilterBy=function(e){return e.ShortTitle?e.ShortTitle:e.Title?e.Title.replace("Common Core - ",""):null},t.createStandardsObject=function(e,t,n){return{grade:e.Grade,date:e.AnswerDate,groupBy:t,filterBy:this.getStandardFilterBy(s.getStandardByCode(t,n)),isCurrentTeacherAssignment:e.IsCurrentTeacherAssignment}},t.prepareData=function(e,t){var n=this,i=[],o=[],r=[],l=[],d=e.StudentVocabularyData,c=[],u=[],p=[];return a.each(e.QuestionData,(function(e){var s=2===e.SubType?"mc":"sa",d=e.AssignmentId.toString(),p=n.getMonthYear(e.AnswerDate);if(null!==e.Grade){i.push({grade:e.Grade,date:e.AnswerDate,groupBy:e.Dok,isCurrentTeacherAssignment:e.IsCurrentTeacherAssignment}),e.IsNoResponse||(o.push(n.createStandardsObject(e,e.StandardCode,t)),e.SecondStandardCode&&o.push(n.createStandardsObject(e,e.SecondStandardCode,t)));var h={grade:e.Grade,date:e.AnswerDate,filterBy:[],groupBy:e.SkillBucketId,isCurrentTeacherAssignment:e.IsCurrentTeacherAssignment};r.push(h);var g=a.find(l,{gradeLevel:e.LearnEntityGradeLevel,date:e.AnswerDate});if(g?(g[s]?(g[s].gradeSum+=e.Grade,g[s].gradeCount++):g[s]={gradeSum:e.Grade,gradeCount:1},g.assignmentArray[d]||(g.assignmentArray[d]=!0)):((g={gradeLevel:e.LearnEntityGradeLevel,assignmentArray:{},date:e.AnswerDate})[s]={gradeSum:e.Grade,gradeCount:1},g.assignmentArray[d]=!0,l.push(g)),e.IsCurrentTeacherAssignment&&(g.currentTeacher||(g.currentTeacher={}),g.isCurrentTeacherAssignment=!0,g.currentTeacher[s]?(g.currentTeacher[s].gradeSum+=e.Grade,g.currentTeacher[s].gradeCount++):g.currentTeacher[s]={gradeSum:e.Grade,gradeCount:1}),"N/A"!==p){var f=a.find(c,{month:p.month,year:p.year}),m=alcfg.grades.list[e.Grade].id;f||(f={month:p.month,year:p.year,zero:0,incomplete:0,basic:0,proficient:0,advanced:0,currentTeacher:{zero:0,incomplete:0,basic:0,proficient:0,advanced:0}},c.push(f)),f[m]=f[m]?f[m]+1:1,e.IsCurrentTeacherAssignment&&(f.currentTeacher[m]=f.currentTeacher[m]+1)}}if(!e.IsNoResponse){var v=n.getFormattedDate(e.AnswerDate),b=a.find(u,(function(e){return+v==+e.date}));if(b){b.answers++,b.wordCount+=e.WordCount;var C=a.find(b.prevCharCountAsgnArr,(function(t){return t.assignmentId===e.AssignmentId}));if(C?e.PreviousCharacterCount>C.count&&(C.count=e.PreviousCharacterCount):b.prevCharCountAsgnArr.push({assignmentId:e.AssignmentId,count:e.PreviousCharacterCount}),e.IsCurrentTeacherAssignment){b.currentTeacher?(b.currentTeacher.answers=b.currentTeacher.answers+1,b.currentTeacher.wordCount=b.currentTeacher.wordCount+e.WordCount):b.currentTeacher={answers:1,wordCount:e.WordCount,prevCharCountAsgnArr:[]};var y=a.find(b.currentTeacher.prevCharCountAsgnArr,(function(t){return t.assignmentId===e.AssignmentId}));y?e.PreviousCharacterCount>y.count&&(y.count=e.PreviousCharacterCount):b.currentTeacher.prevCharCountAsgnArr.push({assignmentId:e.AssignmentId,count:e.PreviousCharacterCount})}}else{var _={date:v,answers:1,wordCount:e.WordCount,prevCharCountAsgnArr:[{assignmentId:e.AssignmentId,count:e.PreviousCharacterCount}]};e.IsCurrentTeacherAssignment&&(_.currentTeacher={answers:1,wordCount:e.WordCount,prevCharCountAsgnArr:[{assignmentId:e.AssignmentId,count:e.PreviousCharacterCount}]}),u.push(_)}}})),a.each(e.NotesData,(function(e){var t=n.getFormattedDate(e.CreateDate),s=a.find(u,(function(e){return+t==+e.date}));s||(s={date:t,notes:0,notesWordCount:0},u.push(s)),s.notes=s.notes+1||1,s.notesWordCount=s.notesWordCount+e.WordCount||e.WordCount,e.IsCurrentTeacherAssignment&&(s.currentTeacher?(s.currentTeacher.notes=s.currentTeacher.notes+1||1,s.currentTeacher.notesWordCount=s.currentTeacher.notesWordCount+e.WordCount||e.WordCount):s.currentTeacher={notes:1,notesWordCount:e.WordCount})})),a.each(e.ReadingTimeData,(function(e){var t=n.getFormattedDate(e.CreateDate),s=a.find(u,(function(e){return+t==+e.date}));s||(s={date:t,readingTime:0},u.push(s)),s.readingTime=s.readingTime+e.ReadingTime||e.ReadingTime,e.IsCurrentTeacherAssignment&&(s.currentTeacher?s.currentTeacher.readingTime=s.currentTeacher.readingTime+e.ReadingTime||e.ReadingTime:s.currentTeacher={readingTime:e.ReadingTime})})),a.each(e.StudentVocabularyData,(function(e){var t=n.getFormattedDate(e.MaxCreateDate),s=a.find(u,(function(e){return+t==+e.date}));s||(s={date:t,lookupCount:0},u.push(s)),s.lookupCount=s.lookupCount+1||1,e.IsCurrentTeacherAssignment&&(s.currentTeacher?s.currentTeacher.lookupCount=s.currentTeacher.lokupCount+1||1:s.currentTeacher={lookupCount:1})})),a.each(o,(function(e){if(!a.find(p,{id:e.groupBy})){var n=s.getStandardByCode(e.groupBy,t);p.push({id:e.groupBy,text:n.ShortText,filterBy:e.filterBy})}})),l.sort((function(e,t){return-1===e.gradeLevel&&-1===t.gradeLevel?0:-1===e.gradeLevel?1:-1===t.gradeLevel?-1:e.gradeLevel-t.gradeLevel})),{studentDokData:i,studentStandardsData:o,studentCategoryData:r,studentReadingGradeLevelData:l,studentVocabularyData:d,studentPerformanceData:c,studentReadingLogData:e.ReadingLogData,studentTimeEffortData:u,studentResearchData:e.StudentResearchData,ccStdMap:p}},t.prepareAdminClassData=function(e){var t=[],n=this;return a.each(e,(function(e){var s=n.getMonthYear(e.AnswerDate);if("N/A"!==s){var i=e.Grade>=2?"advanced":"basic",o=a.filter(t,{month:s.month,year:s.year});0===o.length?(o={month:s.month,year:s.year,advanced:0,basic:0},t.push(o)):o=o[0],o[i]=o[i]?o[i]+1:1}})),this.sortAndFillPerformanceData(t)},t.sortAndFillPerformanceData=function(e,t){var n=0,s=[];if(e.length>0){e.sort((function(e,t){return 100*(e.year-t.year)+e.month-t.month}));var i=e[0].month,o=e[0].year,r=moment().add(1,"months").date(0);do{var l=a.find(e,{month:i,year:o});l?(t&&((l=$.extend({},l)).zero=l.currentTeacher.zero,l.incomplete=l.currentTeacher.incomplete,l.basic=l.currentTeacher.basic,l.proficient=l.currentTeacher.proficient,l.advanced=l.currentTeacher.advanced),l.label=moment().month(l.month).year(l.year).date(0).format("MMM YYYY"),s.push(l),n=Math.max(l.zero+l.incomplete+l.basic,l.proficient+l.advanced,n)):s.push({label:moment().month(i).year(o).date(0).format("MMM YYYY"),zero:0,incomplete:0,basic:0,proficient:0,advanced:0}),++i>11&&(i=0,o++)}while(r.isAfter(moment().month(i).year(o).subtract(1,"months").date(0)));n=n%2?n+1:n}return{studentPerformanceData:s,maxResponsesInMonth:n}},t.getMonthYear=function(e){var t=moment(e);return{month:t.month()+1,year:t.year()}},t.getFormattedDate=function(e){return moment.utc(e)},t.initDateRangePicker=function(e,t,n,a,s){void 0===s&&(s=[]);var i,r=this,l=moment().month("Aug").startOf("month").startOf("day"),d=moment().subtract(6,"days").startOf("day"),c=moment().subtract(29,"days").startOf("day"),u=moment().year()-(moment().month()<6?2:1),p=moment().year(u).month("Aug").startOf("month").startOf("day"),h=moment().year(u+1).month("Jun").endOf("month").endOf("day"),g=moment().endOf("day"),f=t.isSame(g);l>moment()&&l.subtract(1,"year");var m={"Last 7 Days":[d,g],"Last 30 Days":[c,g],"Current School Year":[l,g],"Last School Year":[p,h]},v=0===s.length?m:s.reduce((function(e,t){return e[t]=m[t],e}),{});$(".reportrange").daterangepicker({startDate:e,endDate:t,minDate:"01/01/2012",maxDate:g,ranges:v},(function(e,t,s){t="Custom Range"===s?t.endOf("day"):t;var i=(f=t.isSame(g))?"Today":moment(t).format("MMM D, YYYY");$(".reportrange span").html(s+": "+moment(e).format("MMM D, YYYY")+" - "+i),"Current School Year"!==s?$(".reportrange").addClass("selected"):$(".reportrange").removeClass("selected"),a&&o.UpdateStandaloneSetting(r.getUpdatedDefaultDateRangeSetting({reportType:a,dateRange:{start:e,end:t}}),(function(){})),n(e,t,s)})),i=l.isSame(e)&&f?"Current School Year":e.isSame(d)&&f?"Last 7 Days":e.isSame(c)&&f?"Last 30 Days":e.isSame(p)&&t.isSame(h)?"Last School Year":"Custom Range";var b=f?"Today":moment(t).format("MMM D, YYYY");$(".reportrange span").html(i+": "+moment(e).format("MMM D, YYYY")+" - "+b),"Current School Year"!==i?$(".reportrange").addClass("selected"):$(".reportrange").removeClass("selected")},t.getSchoolYearRangeOrDefault=function(e){var t,n,s=a.find(sCH.userM.get("Settings"),{SettingKey:"defaultDateRange"});if(s&&JSON.parse(s.Settings)[e]){var i=JSON.parse(s.Settings)[e];t=moment(i.start),n=moment(i.end)}else{var o=moment().month("Aug").startOf("month").startOf("day");o>moment()&&o.subtract(1,"year"),t=o,n=moment().endOf("day")}return{start:t,end:n}},t.roundTotalStudentReadingTime=function(e){if(!e)return 0;var t=Math.round(e/360)/10;return t>100?Math.round(t).toLocaleString():t},t.getUpdatedDefaultDateRangeSetting=function(e){var t=a.find(sCH.userM.get("Settings"),{SettingKey:"defaultDateRange"});return t?(t.Settings=JSON.parse(t.Settings),t.Settings[e.reportType]=e.dateRange,t.Settings=JSON.stringify(t.Settings)):((t={SettingKey:"defaultDateRange",Settings:{},UserId:sCH.userM.get("UserId")}).Settings[e.reportType]=e.dateRange,t.Settings=JSON.stringify(t.Settings),sCH.userM.get("Settings").push(t)),{settingKey:"defaultDateRange",settings:t.Settings}},t.prepareStudentActivityData=function(e){var t=[],n=this;return a.each(e.Students,(function(i){var o={};t.push({userId:i.UserId,name:s.sanitize(i.LastName)+", "+s.sanitize(i.FirstName),data:o});var r=a.filter(e.ResponseData,{UserId:i.UserId});if(r.length>0){var l=[];a.each(r,(function(e){var t=n.getFormattedDate(e.CreateDate),a=l.slice(-1)[0]&&l.slice(-1)[0].date===t?l.slice(-1)[0]:void 0;a?(e.IsNoResponse?a.noRespAnswers++:(e.IsReset&&a.answers++,a.wordCount+=e.WordCount),a.pointsSum+=e.PointsEarned?e.PointsEarned:0,a.pointsMax+=e.PointsPossible?e.PointsPossible:0):e.IsNoResponse?l.push({date:t,answers:0,noRespAnswers:1,pointsSum:e.PointsEarned?e.PointsEarned:0,pointsMax:e.PointsPossible?e.PointsPossible:0,wordCount:0}):l.push({date:t,answers:e.IsReset?0:1,noRespAnswers:0,pointsSum:e.PointsEarned?e.PointsEarned:0,pointsMax:e.PointsPossible?e.PointsPossible:0,wordCount:e.WordCount})})),o.responseData=l}o.revisionData=e.RevisionData.find((function(e){return e.UserId===i.UserId}));var d=a.filter(e.ReadingData,{UserId:i.UserId});if(d.length>0){var c=[];a.each(d,(function(e){var t=n.getFormattedDate(e.CreateDate),a=c.slice(-1)[0]&&c.slice(-1)[0].date===t?c.slice(-1)[0]:null;a?a.time+=e.ReadingTime:c.push({date:t,time:e.ReadingTime})})),o.readingTimeData=c}var u=a.filter(e.VocabLookupsData,{UserId:i.UserId});if(u.length>0){var p=[];a.each(u,(function(e){var t=n.getFormattedDate(e.CreateDate),a=p.slice(-1)[0]&&p.slice(-1)[0].date===t?p.slice(-1)[0]:void 0;a?a.lookupCount++:p.push({date:t,lookupCount:1})})),o.vocabLookupsData=p}o.translationData=a.filter(e.TranslationLookupsData,{UserId:i.UserId}),o.ttsData=a.filter(e.TextToSpeechCallData,{UserId:i.UserId});var h=a.filter(e.PeerResponsesLookup,{UserId:i.UserId});if(h.length>0){var g=[];a.each(h,(function(e){var t=n.getFormattedDate(e.CreateDate),a=g.slice(-1)[0]&&g.slice(-1)[0].date===t?g.slice(-1)[0]:void 0;a?a.lookupCount++:g.push({date:t,lookupCount:1})})),o.peerResponseLookupsData=g}var f=a.filter(e.NotesData,{UserId:i.UserId});if(f.length>0){var m=[];a.each(f,(function(e){var t=n.getFormattedDate(e.CreateDate),a=m.slice(-1)[0]&&m.slice(-1)[0].date===t?m.slice(-1)[0]:void 0;a?(a.count++,a.publicCount+=e.IsPublic?1:0,a.wordCount+=e.WordCount):m.push({date:t,count:1,publicCount:e.IsPublic?1:0,wordCount:e.WordCount})})),o.notesData=m}o.irData=a.find(e.IndependentReadingData,{UserId:i.UserId}),o.researchData=a.filter(e.ResearchData,{UserId:i.UserId})})),t},t.getGradeClassificationByAverage=function(e){return-1===e?"na":e>.8?"proficient":e<.4?"basic":"average"},t.getStandardsBySkill=function(e,t){null==e&&(e=2);var n=[];return a.each(t,(function(t){null===t.SkillBucketId&&2===e?n.push(t):t.SkillBucketId===e&&n.push(t)})),n},t.getWordLookupsByPosition=function(e){var t=[],n=sCH.learnEntitySectionsMetaC.length,i=a.groupBy(e,"Word");return a.map(i,(function(e,i){var o={word:i,lookupCount:0,uniquePositionLookups:[]};a.each(e,(function(e){var t=$.extend({},e),i=a.find(o.uniquePositionLookups,{StartIndex:e.StartIndex,TextSectionId:e.TextSectionId});if(o.lookupCount+=t.LookupCountForPosition,t.dropdownDisplayString="Search: "+s.sanitize(e.Word),i)i.LookupCountForPosition+=o.lookupCountForPosition;else{var r=sCH.learnEntitySectionsMetaC.find({TextSectionId:e.TextSectionId}),l=null!==t.StartIndex?Math.floor(t.StartIndex/r.get("CharacterCount")*100)+"%":null,d=n>1&&r.get("Title");null===t.StartIndex||t.IsUserEntered||(t.dropdownDisplayString=(d?r.get("Title")+", at location: ":"At location: ")+l),o.uniquePositionLookups.push(t)}})),o.uniquePositionLookups=a.sortBy(a.sortBy(o.uniquePositionLookups,"StartIndex"),"TextSectionId"),t.push(o)})),t},t.getStudentGradeLevels=function(){var e=Math.max.apply(Math,sCH.classesC.toJSON().map((function(e){return e.GradeLevel})));return i.GradeLevels.filter((function(t){return t.value<=e})).map((function(e){return e.label.toLowerCase()}))}},,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),l=n(0),d=n(0),c=n(552),u=n(553),p=n(5),h=n(8),g=400,f=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.adjustTableHeightDebounced=r.debounce((function(e){p.adjustVirtualizedTableHeight()}),g),a.getFirstSortableColumnIndex=function(){return a.props.header.cells.findIndex((function(e){return!e.notSortable}))},a._rowHeight=a._rowHeight.bind(a),a._columnWidth=a._columnWidth.bind(a),a._cellRenderer=a._cellRenderer.bind(a);var s=i(i({},t),{scrollToColumn:0,scrollToRow:0,columnCount:t.header.cells.length,rowCount:t.body.length});return a.state=s,a}return s(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this;this.setState(i(i({},e),{sortDescending:this.state.sortDescending}),(function(){t._sortBodyRows({sortByColumnIndex:t.state.sortByColumnIndex,sortDescending:t.state.sortDescending})}))},t.prototype.componentDidMount=function(){var e=this.props.sortByColumnIndex||this.getFirstSortableColumnIndex();-1!==e&&this._sortBodyRows({sortByColumnIndex:e,sortDescending:this.props.sortDescending}),p.adjustVirtualizedTableHeight(),window.addEventListener("resize",this.adjustTableHeightDebounced)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.adjustTableHeightDebounced)},t.prototype.render=function(){var e=this,t=(this.props.customClassNames||[]).concat(["vtable-wrapper"]);return l.createElement("div",{className:t.join(" "),style:{height:this.props.height||null}},this.state.before,l.createElement("div",{className:"vtable"+(this.state.scrollingRight?" scrolling":""),style:{flex:"1 1 auto"}},l.createElement(c.AutoSizer,{onResize:function(){return e.mainGrid.recomputeGridSize()}},(function(t){var n=t.height,a=t.width;return l.createElement(u.MultiGrid,i({},e.state,{height:n,width:a,cellRenderer:e._cellRenderer,columnCount:e.props.header.cells.length,columnWidth:function(t){var n=t.index;return e._columnWidth(n,a)},rowCount:e.props.body.length+1,rowHeight:e._rowHeight,style:{},enableFixedColumnScroll:e.props.enableFixedColumnScroll,enableFixedRowScroll:e.props.enableFixedRowScroll,styleBottomLeftGrid:{},styleBottomRightGrid:{},styleTopLeftGrid:{},styleTopRightGrid:{},classNameTopRightGrid:e.props.enableFixedRowScroll?"fixedRowHorizontalScrolling "+(e.props.fixedRowCount>1?"rowScroll":""):"",classNameBottomRightGrid:e.props.enableFixedRowScroll?"bodyRow":"",ref:function(t){e.mainGrid=t},onScroll:function(t){t.scrollLeft>0&&!e.state.scrollingRight?e.setState({scrollingRight:!0}):0===t.scrollLeft&&e.state.scrollingRight&&e.setState({scrollingRight:!1})},onRowClick:function(t){e.props.onRowClick&&e.props.onRowClick(t)}}))}))),this.state.after)},t.prototype._rowHeight=function(e){var t=e.index;return 0===t?this.state.header.height:this.state.body[t-1].height},t.prototype._columnWidth=function(e,t){var n=this.getTableWidth(),a=this.state.header.cells.filter((function(e){return e.width>0})).length,s=Math.floor(Math.max(t-n-10,0)/a),i=this.state.header.cells[e].maxWidth,o=Math.min(i,this.state.header.cells[e].width)||this.state.header.cells[e].width,r=this.getColumnsWithMaxWidth();return r&&(s+=Math.floor(s*r/(a-r))),t<=768&&0===s?0===e?Math.min(t/2,o):o:o+(o>0&&!i?s:0)},t.prototype.getTableWidth=function(){return this.state.header.cells.reduce((function(e,t){var n=t.width,a=t.maxWidth;return e+(Math.min(a||n,n)||0)}),0)},t.prototype.getColumnsWithMaxWidth=function(){return this.state.header.cells.filter((function(e){return e.maxWidth})).length},t.prototype._sortBodyRows=function(e){var t=this,n=e.sortByColumnIndex,a=e.sortDescending,s=this.props.fixedRowCount-1,i=h.cloneDeep(this.state.body),r=i.slice(0,s),l=n>=0?i.slice(s).sort(this._sortHandler(n,a)):i.slice(s),d=o(r,l);this.setState({sortByColumnIndex:n,sortDescending:a,body:d},(function(){return t.mainGrid.recomputeGridSize()}))},t.prototype._sortHandler=function(e,t){return function(n,a){return p.sortComparator(t)(n.cells[e].sortValue,a.cells[e].sortValue)}},t.prototype._isColumnSortable=function(e){return!this.state.header.cells[e].notSortable},t.prototype._isColumnSorted=function(e){return this._isColumnSortable(e)&&e===this.state.sortByColumnIndex},t.prototype._isHeader=function(e){return 0===e},t.prototype._getDefaultCSSClasses=function(e,t){return{cell:!0,header:this._isHeader(t),highlight:!this._isHeader(t)&&t===this.state.hoveredRowIndex,sortable:this._isHeader(t)&&this._isColumnSortable(e),sorting:this._isHeader(t)&&this._isColumnSorted(e)&&!this.state.sortDescending,"sorting-desc":this._isHeader(t)&&this._isColumnSorted(e)&&this.state.sortDescending,"fixed-row":t<this.props.fixedRowCount,"fixed-column":e<this.props.fixedColumnCount,"odd-row":t%2!=0,"even-row":t%2==0}},t.prototype._getCustomCSSClasses=function(e,t){return this._isHeader(t)?this.state.header.cells[e].classes||{}:this.state.body[t-1].cells[e].classes||{}},t.prototype._getValidCSSClasses=function(e,t,n){var a=this,s=[];return r.each(e,(function(e,i){var o=p.isFunction(e),r=o?null:e;(o?(o?e:null)(n,t,a.props,a.state):r)&&s.push(i)})),s},t.prototype._getCellCSSClasses=function(e,t){var n=this._getDefaultCSSClasses(e,t),a=this._getCustomCSSClasses(e,t),s=i(i({},n),a);return this._getValidCSSClasses(s,e,t).join(" ")},t.prototype._cellRenderer=function(e){var t=this,n=e.columnIndex,a=e.key,s=e.rowIndex,o=e.style,r=e.parent,d={className:this._getCellCSSClasses(n,s),key:a,style:o,onMouseOver:function(){t.setState({hoveredRowIndex:s})},onClick:function(){r.props.onRowClick(s)}};this._isHeader(s)&&this._isColumnSortable(n)&&(d.onClick=function(){t._sortBodyRows({sortByColumnIndex:n,sortDescending:t.state.sortByColumnIndex===n?!t.state.sortDescending:t.state.sortDescending})});var c=this._isHeader(s)?this.state.header.cells[n].content:this.state.body[s-1].cells[n].content;return l.createElement("div",i({},d),l.createElement("div",{className:"outer"},l.createElement("div",{className:"inner"},c)))},t}(d.Component);t.VTable=f},,,,,function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(484),r=n(13),l=n(8),d={popper:{padding:0,margin:0,background:"transparent",'&[x-placement*="top"] > .MuiTooltip-tooltip':{marginBottom:5,flexDirection:"column-reverse",paddingBottom:0},'&[x-placement*="bottom"] > .MuiTooltip-tooltip':{marginTop:5,flexDirection:"column",paddingTop:0},'&[x-placement*="left"] > .MuiTooltip-tooltip':{marginRight:5,flexDirection:"row-reverse",paddingRight:5},'&[x-placement*="right"] > .MuiTooltip-tooltip':{marginLeft:5,flexDirection:"row",paddingLeft:5},'&[x-placement*="bottom"] > .MuiTooltip-tooltip::before':{top:-10,borderBottomColor:"black"},'&[x-placement*="top"] > .MuiTooltip-tooltip::before':{top:10,borderTopColor:"black"},'&[x-placement*="left"] > .MuiTooltip-tooltip::before':{left:15,borderLeftColor:"black"},'&[x-placement*="right"] > .MuiTooltip-tooltip::before':{left:-15,borderRightColor:"black"}},tooltip:{margin:0,borderRadius:0,fontFamily:"Avenir Next LT W02 Demi",fontSize:12,whiteSpace:"normal",background:"black",color:"white",padding:"10px 15px",boxSizing:"border-box",display:"flex",alignItems:"center",textAlign:"center","&::before":{content:'""',position:"relative",boxSizing:"border-box",border:"5px solid transparent",width:0,height:0}}},c=r.makeStyles(d),u=r.makeStyles(l.merge({},d,{tooltip:{color:"black",background:"white"},popper:{'&[x-placement*="bottom"] > .MuiTooltip-tooltip::before':{borderBottomColor:"white"},'&[x-placement*="top"] > .MuiTooltip-tooltip::before':{borderTopColor:"white"},'&[x-placement*="left"] > .MuiTooltip-tooltip::before':{borderLeftColor:"white"},'&[x-placement*="right"] > .MuiTooltip-tooltip::before':{borderRightColor:"white"}}}));t.default=function(e){var t=e.title,n=void 0===t?"":t,r=e.children,l=e.tooltipPlacement,d=void 0===l?"bottom":l,p=e.tooltipColor,h=void 0===p?"black":p,g=e.isTooltipOpen,f=void 0===g||g,m=s(e,["title","children","tooltipPlacement","tooltipColor","isTooltipOpen"]),v="black"===h?c():u(),b=i.useState(!1),C=b[0],y=b[1];return i.createElement(o.default,a({classes:v,title:n,placement:d,open:C&&f,onClose:function(){y(!1)},onOpen:function(){y(!0)}},m),r)}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(8),i=n(645);t.default=Backbone.View.extend({className:"trialSplash",template:n(1209),events:{},initialize:function(e){e.screenshotUrl&&(e.screenshotUrl="string"==typeof e.screenshotUrl?[e.screenshotUrl]:e.screenshotUrl),this.options=s.extend({text:"This Insight Report is available on our Prime plan.",premiumBannerCaption:e.primeUnlimitedOnly?"This feature is available on the Prime Unlimited plan.":"This feature is available on our Prime plan.",screenshotUrl:null,buyLink:"https://www.activelylearn.com/plans",plan:"Prime",buttonOnNewLine:!1,showPremiumContainer:!0,showSampleBanner:!1},e)},render:function(){if(this.$el.html(this.template(this.options)),this.options.showPremiumContainer){var e=this.$el.find(".premiumContainer")[0];a.mountReactComponent(i.default,e,{caption:this.options.premiumBannerCaption})}return this}})},,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(11),l=function(e){function t(t){var n=e.call(this,t)||this;return n.view=null,n}return s(t,e),t.prototype.render=function(){return!!this.props.className&&o.createElement("div",{className:this.props.className})},t.prototype.renderView=function(){!!this.props.className?(this.view=new this.props.view(i({el:r.findDOMNode(this)},this.props.options||{})),this.props.shouldNotCallRender||this.view.render(i({},this.props.options||{}))):(this.view=new this.props.view(i({},this.props.options||{})),this.props.shouldNotCallRender||this.view.render(i({},this.props.options||{})))},t.prototype.cleanupView=function(){var e=this.view;e&&e.close(!1)},t.prototype.componentDidMount=function(){this.renderView()},t.prototype.componentDidUpdate=function(){this.cleanupView(),this.renderView()},t.prototype.componentWillUnmount=function(){this.cleanupView()},t}(o.Component);t.default=l},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(65);t.default=function(e){var t=e.buttonClass,n=void 0===t?"":t,r=e.buttonId,l=void 0===r?"":r,d=e.buttonTitle,c=void 0===d?"":d,u=e.children,p=e.onClick,h=void 0===p?function(e){}:p,g=e.tooltipPlacement,f=void 0===g?"bottom":g,m=e.tooltipColor,v=void 0===m?"black":m,b=e.shouldCloseTooltipOnClick,C=void 0===b||b,y=s(e,["buttonClass","buttonId","buttonTitle","children","onClick","tooltipPlacement","tooltipColor","shouldCloseTooltipOnClick"]),_=i.useState(!0),S=_[0],w=_[1];return i.createElement(o.default,{title:c,tooltipPlacement:f,tooltipColor:v,isTooltipOpen:S},i.createElement("button",a({className:n,id:l,onClick:function(e){h(e),C&&w(!1)},onMouseOver:function(){return w(!0)}},y),u))}},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(37),i=n(5),o=n(10),r=n(1007),l=n(20),d=n(323),c=n(149),u=n(446);t.initAppAndCheckAuthentication=function(e,t){sCH.userM=new r.default,sCH.userM.on("error",(function(e){rg4js("send",{error:e})}));var n=this;sCH.userM.on("sync",(function(e,a){a?sCH.userM.isAnonUser()?(sCH.userM.set("csrfToken",a.Token),t()):(i.ably()||"undefined"==typeof Ably||i.initAbly(),!i.userSessionChannel()&&i.ably()&&(i.initUserSessionChannel(),i.userSessionChannel().subscribe("sign_out",(function(e){e.data.deviceId===i.getCookie("deviceId")&&setTimeout((function(){window.location.reload(!0)}),1e3)})),i.userSessionChannel().subscribe("destroy_last_session",(function(e){e.data.deviceId===i.getCookie("deviceId")&&setTimeout((function(){window.location.reload(!0)}),3e3)})),i.userSessionChannel().subscribe("account_deleted",(function(e){n.signOut("deleteAccount")})),i.userSessionChannel().subscribe("switch_role",(function(e){window.location.hash.indexOf("switchrole")<0&&(Backbone.router.navigate(s.getPathNameWithoutHash(e.data.redirectUrl),{trigger:!1}),window.location.reload(!0))})),i.userSessionChannel().subscribe("student_marked_struggling",(function(e){sCH.readerConfig&&e.data.assignmentIds.indexOf(parseInt(sCH.readerConfig.assignmentId))>-1&&d.assignmentUpdatedReloadPopup()})),i.userSessionChannel().subscribe("class_details_updated",(function(e){d.classDetailsUpdated(e.data)}))),sCH.initClasses((function(){a.Token&&(sCH.userM.set3rdPartyInfo(),n.initializeAutoLogoutTimer(),d.initializeGeneralUpdates(),sCH.userM.set("csrfToken",a.Token),t()),u.remove("userIdSignedOutWhenOffline")}),"student"===sCH.userM.get("Role"))):rg4js("setUser",{identifier:null,isAnonymous:!0})})),e?(sCH.userM.set(e),sCH.userM.trigger("sync",sCH.userM,e)):sCH.userM.fill()},t.anonAndRoleChecks=function(e){var t=l.default.isMath?[]:["teacherReaderPreview","teacherReaderAuthoring","teacherCatalog","teacherCatalogWithQueryParams"];if(sCH.userM.isAnonUser()&&!a.includes(t,e))return this.destroyAppInitDataAndRedirect({source:"anonuser router",forwardURL:window.location.hash.substr(1)}),!1;var n=window.location.hash.split("/")[0],s="student"===sCH.userM.get("Role")&&"#student"!==n,o="student"!==sCH.userM.get("Role")&&"#student"===n;if(o&&"studentReader"===e){var r=sCH.userM.isOnFreePlan()?"grading":"data",d=window.location.hash.replace("student/reader","teacher/reader/grading").replace("notes",r);return i.redirectUserByHash(d),!1}if(o&&"studentCatalog"===e){var c=window.location.hash.split("/").slice(1).join("/");i.redirectUserByHash("teacher/"+c)}else{if(o&&"mathReader"===e){d=window.location.hash.replace("student","teacher");return i.redirectUserByHash(d),!1}if(o||s)return Backbone.router.navigate(sCH.userM.get("Url").split("#")[1],{trigger:!1}),window.location.reload(!0),!1;if("student"===sCH.userM.get("Role")&&"studentClasses"===e&&0===sCH.classesC.length&&!l.default.isMath)return i.redirectUserByHash("#student/catalog"),!1}return!0},t.destroyAppInitDataAndRedirect=function(e){var t=e.source,n=e.customRedirectURL,a=e.forwardURL,s=e.forwardURLExtra;try{i.ably()&&i.ably().channels.get("user_session_listen@"+sCH.userM.get("UserId")).unsubscribe(),Backbone.pubEv.trigger("reader_destroy"),i.setCookie("lastActiveAt",null,-1),c.clearOnlineCheckTimer(),i.intercom("shutdown"),window.rg4js&&rg4js("setUser",{identifier:null,isAnonymous:!0}),window.FS&&window.FS.clearUserCookie(),Backbone.tracking.trackGAEvent("user",t);var o=n||"/account.html";a&&!a.includes("/reader/tour")&&(o=0===a.indexOf("/account.html")?a:"/account.html?furl="+encodeURIComponent(a)+(s||"")),i.redirectUserByUrl(o)}catch(e){console.log("signout",e)}},t.handleUnauthenticatedAccess=function(e){var n=window.location.hash.substr(1);e&&e.url.indexOf("signout")>=0?(i.setCookie("lastActiveAt",null,-1),i.redirectUserByUrl("/account.html")):n&&0!==n.indexOf("account")&&sCH.userM?t.destroyAppInitDataAndRedirect({source:"cookie expired",forwardURL:n,forwardURLExtra:"&furlUserId="+sCH.userM.get("UserId")}):i.redirectUserByUrl("/account.html")},t.initializeAutoLogoutTimer=function(){var e=this;$(document).on(alcfg.activeEvents,(function(t){if(window.ActivelyRead.sessionTimer&&window.clearTimeout(window.ActivelyRead.sessionTimer),""!==window.location.hash&&0!==window.location.pathname.indexOf("/account")){window.ActivelyRead.sessionTimer=window.setTimeout((function(){Date.now()-parseInt(i.getCookie("lastActiveAt"))>l.default.maxInactiveTime&&e.startSignOut("in session timer")}),l.default.maxInactiveTime);var n=(new Date).getTime();i.getCookie("lastActiveAt")||i.setCookie("lastActiveAt",n),n-parseInt(i.getCookie("lastActiveAt"))>l.default.maxInactiveTime?e.startSignOut("comparing timestamps"):i.setCookie("lastActiveAt",n)}else $(document).off(alcfg.activeEvents)}))},t.startSignOut=function(e){if($(document).off(alcfg.activeEvents),window.location.href.indexOf("student/reader")>0){var t=window.location.hash.substr(1);$(".btnExitReader").click();var n=this;window.setTimeout((function(){n.signOut(e,t,"&furlUserId="+sCH.userM.get("UserId"))}),1500)}else this.signOut(e,window.location.hash.substr(1))},t.signOut=function(e,n,a){var s=this;o.SignOut((function(o){if(o.Success)if(window.isIOSApp){var r=s.getOAuthSignoutUrl();if(r){var d="&oauthSignoutUrl="+encodeURIComponent(r);a=(a||"")+d,n=n||window.location.hash.substr(1)}t.destroyAppInitDataAndRedirect({source:e,forwardURL:n,forwardURLExtra:a})}else{"student"===sCH.userM.get("Role")&&"google"===sCH.userM.get("LoginSource")&&i.setCookie(l.default.preAuthKey,JSON.stringify({error:"google shared device signout reminder"}),1),t.destroyAppInitDataAndRedirect({source:e,customRedirectURL:o.customRedirectURL,forwardURL:n,forwardURLExtra:a})}else"offline"===o.Message?u.set("userIdSignedOutWhenOffline",sCH.userM.get("UserId")):alert("There was an error signing out. Please try again later.\n\n"+o.Message)}))},t.getOAuthSignoutUrl=function(){var e=sCH.userM.get("Accounts");return e.google?"https://accounts.google.com/logout":e.office365?"https://www.office.com/estslogout":e.edmodo?"https://www.edmodo.com/index/logout":e.clever?"https://clever.com/logout":void 0},t.roleForUrl=function(e){var t="student"===sCH.userM.get("Role")?"student":"teacher";return e&&e.excludeHash?t:"#"+t}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(10),i=n(264);t.embedMediaPreview=function(e){var t=e.container,n=e.mediaUrl,a=e.shouldUpdateMargin,i=e.tagTypeAndId,o=e.isCreatedByCurrentUser;s.OEmbed({url:n,source:i},(function(e){if(e.errorMessage)-1!==n.indexOf("drive.google.com")?t.html('<a href="'+n+'" target="_blank">\n            <img class="linkThumbnail" src="https://drive.google.com/favicon.ico" onerror="this.style.display=\'none\';" />\n            See more on Google\n          </a>'):o&&(t.addClass("mediaLoadingError embedMediaFullContainer"),t.html(alcfg.errorTexts.mediaNotFound));else{var s=null;["video","photo"].indexOf(e.type)>=0?(s='<img onerror="this.className=\'loadingError\'" class="imgPreview" src="'+(e.thumbnail_url||e.url)+'" />',"video"===e.type&&(s+='<img class="videoPlayButton" src="/img/VideoPlay.png" />')):s="rich"===e.type?'<a class="embedMediaPreviewRich">\n            <img class="linkThumbnail" src="'+e.provider_url+'/favicon.ico" onerror="this.style.display=\'none\';" />\n            Click to see more from '+e.provider_name+"\n          </a>":'<a href="'+e.url+'" target="_blank">\n            <img class="linkThumbnail" src="'+e.provider_url+'/favicon.ico" onerror="this.style.display=\'none\';" />\n            Read more on '+e.provider_name+"\n          </a>",t.removeClass("mediaLoadingError"),t.html(s),Backbone.pubEv.trigger("refreshNotesPanelHeight"),a&&Backbone.pubEv.trigger("updateMargin",{media:!0})}}))},t.embedMediaFull=function(e){var t=e.container,n=e.mediaUrl,a=e.tagTypeAndId;s.OEmbed({url:n,source:a},(function(e){if(e.errorMessage)-1!==n.indexOf("drive.google.com")?t.html('<a href="'+n+'" target="_blank" class="embedMediaFullLink">\n            <img class="linkThumbnail" src="https://drive.google.com/favicon.ico" onerror="this.style.display=\'none\';" />\n            See more on Google\n          </a>'):(t.addClass("mediaLoadingError"),t.html(alcfg.errorTexts.mediaNotFound));else if(e.url&&e.url.indexOf("docs.google.com")>=0&&e.url.indexOf("forms")>=0)t.html('<a href="'+e.url+'" target="_blank">\n        <img class="linkThumbnail" src="'+e.provider_url+'/favicon.ico" onerror="this.style.display=\'none\';" />\n        Read more on '+e.provider_name+"\n      </a>");else{var a=null;a="photo"===e.type?'<img onerror="this.className=\'loadingError\'" src="'+e.url+'" />':["video","rich"].indexOf(e.type)>=0?e.html:'<a href="'+e.url+'" target="_blank" class="embedMediaFullLink">\n            <img class="linkThumbnail" src="'+e.provider_url+'/favicon.ico" onerror="this.style.display=\'none\';" />\n            Read more on '+e.provider_name+"\n          </a>",t.removeClass("mediaLoadingError"),t.html(a),Backbone.pubEv.trigger("updateMargin",{media:!0})}}))},t.openMediaInPopup=function(e,t){s.OEmbed({url:e},(function(e){e.errorMessage?new Backbone.BootstrapModal({content:"<p>"+e.errorMessage+"</p>",cancelText:!1,okText:"Close",cssClass:"modal-lg modal-al-instructional-video",title:"Viewing media"}).open():("photo"===e.type&&(e.html='<img onerror="this.className=\'loadingError\'" src="'+e.url+'" class="embedMediaPhoto" />'),e.mediaAttribution=t,new Backbone.BootstrapModal({content:new i.default({data:e}),cancelText:!1,okText:"Close",optionButtons:"photo"===e.type?[{text:"Open in a new tab",event:"openInNewTab"}]:[],cssClass:"modal-lg modal-al-instructional-video",title:"Viewing media"}).open())}))},t.processMediaURLNotFoundInReader=function(e){s.ProcessMediaURLNotFoundInReader(a({layerId:sCH.readerConfig.layerId},e))}},,function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=n(5),r=n(8),l=n(37),d=n(691),c=n(14),u=["Curriculum Units"];t.topicNamesToNotFilterByGradeLevel=["Text Pairings","Primary Sources"],t.topicNamesToNotFilterByLexile=["Text Pairings","Primary Sources","Videos","PhET Simulations"],t.topicNamesToNotFilterByStandards=["Text Pairings","Primary Sources"],t.filterTopics=function(e,n,a,s){n.length>0&&Object.keys(e).forEach((function(a){e[a]=e[a].filter((function(e){return u.indexOf(e.GroupName)>-1||t.topicNamesToNotFilterByGradeLevel.indexOf(e.TopicName)>-1||r.intersection(e.GradeLevels,n).length>0}))}));a.length>0&&Object.keys(e).forEach((function(n){e[n]=e[n].filter((function(e){return u.indexOf(e.GroupName)>-1||t.topicNamesToNotFilterByLexile.indexOf(e.TopicName)>-1||e.Lexiles.filter((function(e){return e>=a[0]&&e<=a[1]})).length>0}))}));s.length>0&&Object.keys(e).forEach((function(n){e[n]=e[n].filter((function(e){return u.indexOf(e.GroupName)>-1||t.topicNamesToNotFilterByStandards.indexOf(e.TopicName)>-1||r.intersection(e.StandardIds,s).length>0}))}));return e},t.filterTopicTexts=function(e,n,a,s,i){return e=e||[],-1===t.topicNamesToNotFilterByGradeLevel.indexOf(n)&&a.length>0&&(e=e.filter((function(e){return r.intersection(e.GradeLevels,a).length>0||0===e.GradeLevels.length}))),-1===t.topicNamesToNotFilterByLexile.indexOf(n)&&s.length>0&&(e=e.filter((function(e){return e.Lexile&&e.Lexile>=s[0]&&e.Lexile<=s[1]}))),-1===t.topicNamesToNotFilterByStandards.indexOf(n)&&i.length>0&&(e=e.filter((function(e){return r.intersection(e.StandardIds,i).length>0}))),e},t.hasSearchText=function(){return($(".siteSectionSearch input").val()||"").length>0},t.getPageAndPageParamsByTopicSlug=function(e,n){var a=l.getHashQueryParams(),s={};return e?"library"===e?(s.page="library",s.selectedFolderId=parseInt(n)||-2):"my-folders"===e?(s.page="myfolders",s.query=a.query,isNaN(n)?(s.selectedFolderId=-1,s.selectedFolderFilter=n):s.selectedFolderId=parseInt(n)):"my-imports"===e?s.page="myimports":0===e.indexOf("units-")?(s.page="units",s.topicSlug=e):(s.page="topic",s.topicSlug=e):(s.query=a.query,s.page="homepage",s.query||t.areFiltersBeingUsed()||!a.subject?s.subjectSlug=sCH.catalogSubjectSlug:(s.subjectSlug=a.subject,sCH.catalogSubjectSlug=a.subject,l.replaceQueryStringParam({}))),s},t.getFilterHash=function(){return sCH.catalogSelectedGradeLevels.concat(sCH.catalogSelectedLexiles).concat(sCH.catalogSelectedStandardIds).reduce((function(e,t){return e+t}),0)},t.areFiltersBeingUsed=function(){return 0!==t.getFilterHash()},t.filterTopicsByQueryAndFilters=function(e){var n=e.topics||[];if(e.query){var a=t.getFilteredSubjectsAndTopicsByAllowedSubjectSlugs(sCH.catalogSubjectsAndTopics);n=new d(a,{tokenize:!0,matchAllTokens:!0,threshold:.3,location:0,distance:32,maxPatternLength:32,minMatchCharLength:4,keys:["TopicName","KeywordsForSearch"]}).search(e.query)}return sCH.catalogSelectedGradeLevels.length>0&&(n=n.filter((function(e){return r.intersection(e.GradeLevels,sCH.catalogSelectedGradeLevels).length>0}))),sCH.catalogSelectedLexiles.length>0&&(n=n.filter((function(e){return r.intersection(e.Lexiles,sCH.catalogSelectedLexiles).length>0}))),sCH.catalogSelectedStandardIds.length>0&&(n=n.filter((function(e){return r.intersection(e.StandardIds,sCH.catalogSelectedStandardIds).length>0}))),n},t.search=function(e){var n=e.query,i=e.directlyFromUrl,o=void 0!==i&&i,d=e.fromPaging,c=void 0!==d&&d,u=e.pageNumber,p=e.subjectSlugs,h=e.subjectSlugsToExclude;return a(void 0,void 0,void 0,(function(){var e,a,i;return s(this,(function(s){switch(s.label){case 0:return e=[],n||t.areFiltersBeingUsed()?(c||(u=0),n?(o||l.updateHashQueryStringParam("query",n,!0),c||(e=r.map(t.filterTopicsByQueryAndFilters({query:n}),"TopicId"))):l.updateHashQueryStringParam("query",null,!0),[4,t.getCatalogSearchResults({query:n||void 0,pageNumber:u,topicIdResults:e,subjectSlugs:p,subjectSlugsToExclude:h})]):[3,2];case 1:if(a=s.sent())return a.TopicResults.length>0&&(i=[],e.forEach((function(e){var t=a.TopicResults.find((function(t){return t.TopicId===e}));t&&i.push(t)})),a.TopicResults=i),[2,a];s.label=2;case 2:return[2]}}))}))},t.getCatalogSearchResults=function(t){var n=t.query,a=t.topicIdResults,s=t.pageNumber,o=t.subjectSlugs,r=t.subjectSlugsToExclude;return new e((function(e,t){i.GetCatalogSearchResults({query:n||void 0,topicIdResults:a,gradeLevels:sCH.catalogSelectedGradeLevels,lexiles:sCH.catalogSelectedLexiles,standardIds:sCH.catalogSelectedStandardIds,subjectSlugs:o,subjectSlugsToExclude:r,pageNumber:s},(function(t){e(t)}))}))},t.getWorkspaceFoldersAndLayers=function(t){var n=t.selectedFolderId,a=t.selectedFolderFilter,s=t.isInitialLoad;return new e((function(e,t){"savedforlater"===a?i.GetSavedForLater((function(t){i.GetWorkspaceFolders(s,(function(n){e({layers:t,folders:n})}))})):i.GetLayersInFolder({folderId:n,filter:a},(function(t){i.GetWorkspaceFolders(s,(function(n){e({layers:t,folders:n})}))}))}))},t.getSubjectsAndTopics=function(){return new e((function(e){sCH.catalogSubjectsAndTopics?e():i.GetSubjectsAndTopics((function(t){sCH.catalogSubjectsAndTopics=t,e()}))}))},t.getCatalogTopicData=function(t,n){return new e((function(e){i.GetCatalogTopicData({topicSlug:t,subjectSlug:n},(function(t){e(t)}))}))},t.getLibraryData=function(){return new e((function(e){if(sCH.userM.isOnPrimePlan()){var t={};o.attachSchoolDistrictId(t),i.GetLibraryData(t,(function(t){e(t)}))}else e({})}))},t.getCatalogTopicDataForUnitsPage=function(t){return new e((function(e){i.GetCatalogTopicDataForUnitsPage({topicSlug:t},(function(t){e(t)}))}))},t.getMyImportsData=function(){return new e((function(e){sCH.userM.isAnonUser()?e({numOfBYOCInMonth:0}):i.GetMyImports((function(t){e(t)}))}))},t.initCatalogView=function(){if(sCH.catalogSelectedGradeLevels=[],sCH.catalogSelectedLexiles=[],sCH.catalogSelectedStandardIds=[],!sCH.catalogSubjectSlug){var e=sCH.userM.get("AllowedSubjectSlugs");if(1===e.length)sCH.catalogSubjectSlug=e[0];else{var n=sCH.userM.get("SubjectId");sCH.catalogSubjectSlug=t.getCatalogSubjectSlugBySubjectId(n)}}var a=l.getHashQueryParams();if(a.gl){var s=a.gl;sCH.catalogSelectedGradeLevels=s.split(",").map(Number)}if(a.l){var i=a.l;sCH.catalogSelectedLexiles=r.uniq(sCH.catalogSelectedLexiles.concat(i.split(",").map(Number)))}if(a.std){var o=a.std;sCH.catalogSelectedStandardIds=r.uniq(sCH.catalogSelectedStandardIds.concat(o.split(",").map(Number)))}},t.getCatalogSubjectSlugBySubjectId=function(e){if(e&&e<=3){var t=c.UserSubjects.find((function(t){return t.value===e})).label;return l.getSlug(t)}return"ela"},t.updateFilterInQueryParams=function(){l.updateHashQueryStringParam("gl",sCH.catalogSelectedGradeLevels.length?sCH.catalogSelectedGradeLevels:null,!0),l.updateHashQueryStringParam("l",sCH.catalogSelectedLexiles.length?sCH.catalogSelectedLexiles:null,!0),l.updateHashQueryStringParam("std",sCH.catalogSelectedStandardIds.length?sCH.catalogSelectedStandardIds:null,!0)},t.getFilteredSubjectsAndTopicsByAllowedSubjectSlugs=function(e){var t=sCH.userM.get("AllowedSubjectSlugs").map((function(e){return c.SubjectSlugSubjectMap[e]}));return e.filter((function(e){return-1!==t.indexOf(e.SubjectName)}))}}).call(this,n(21))},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){};n(839)(a.prototype),t.event=new a,function(e){e.DIALOG_OPEN="dialog_addschool_open",e.DIALOG_CLOSE="dialog_addschool_close"}(t.events||(t.events={}))},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});var s=n(8),i=n(5),o=n(10),r=n(448),l=n(263),d=n(447),c=n(644),u=0,p=0;t.isTourRunning=!1,t.cachedNoteReplies=[];var h=[{title:"question answered",html:"<h2><span>STEP 1</span>Read up to Question 1 and answer it</h2>            <h3>Students can see how their peers responded after submitting their own answer</h3>",showStepCompleted:!0},{title:"student reading aid1",html:"<h2><span>STEP 2</span>Highlight a word in the text and click on Hear it, Define, or Translate</h2>            <h3>Students can define words, translate sentences, and hear text spoken aloud</h3>",showStepCompleted:!0},{title:"student reading aid2",html:"<h2><span>STEP 3</span>Highlight a word and try another student reading aid</h2>            <h3>Students can define words, translate sentences, and hear text spoken aloud</h3>",showStepCompleted:!0},{title:"added note",html:"<h2><span>STEP 4</span>Highlight a phrase and take a note</h2>            <h3>Students can annotate to mark key passages, focus their thinking, and dialog with their peers</h3>",showStepCompleted:!0}];t.getTourTag=function(e,t){var n="TagId",a=i.when(e,{note:function(){return new l.default(t)},question:function(){return new d.default(t)},marker:function(){return new r.default(t)},response:function(){return new c.default(t)}});return"response"===e&&(n="NoteTagResponseId"),p=--p,a.set(n,p),a},t.introPopup=function(){var e=this;new Backbone.BootstrapModal({content:"<p>Experience Actively Learn by reading one of our popular texts as a student.      We think this is the best way to inspire ideas about how you can use it in your classroom.</p>",cssClass:"modal-al-getting-started-tour",title:"Welcome to Actively Learn!",okText:"Enter student reading experience!",cancelText:!1,allowCancel:!1}).open((function(){setTimeout((function(){$("body").addClass("tourEnabled").append('<div id="tourBanner"></div>'),e.renderSkipTourButton(),e.renderCurrentStep(),o.logTourAction({userId:sCH.userM.get("UserId"),tourVersion:3,action:"started"},(function(t){e.tourActionId=t.tourActionId,e.startedAt=new Date,e.isTourRunning=!0}))}),250)}),(function(){e.endTourPopup({skipped:!0})}))},t.advance=function(){var e=h[u];if((u+=1)===h.length)this.endTourPopup({skipped:!1});else if(e.showStepCompleted){$("#tourBanner").html("<div class='stepComplete'><span class='icon-checkmark-circled'></span></div>");var t=this;window.setTimeout((function(){t.renderCurrentStep(),t.trackInIntercom()}),1500)}},t.renderCurrentStep=function(){var e=h[u],t=$("#tourBanner");if(t.html(e.html),e.addContinueButton){var n=this,a=$('<div id="btnAdvanceTour">Continue</div>').on("click",(function(){n.advance()}));t.prepend(a)}};var g=function(e,t){f(),m("<p>"+(t?"Okie dokie!":"Nice job!")+" Now let's take you back to your last view.</p>",(function(){i.windowOpen(e,"_self")}))},f=function(){a.isTourRunning=!1,$("body").removeClass("tourEnabled"),$("#tourBanner").remove()},m=function(e,t){new Backbone.BootstrapModal({content:e,cssClass:"modal-al-tour-finished",cancelText:!1,allowCancel:!1,okText:"Let's go!"}).open(t)};t.endTourPopup=function(e){var t=e.skipped?"skipped":"completed";o.logTourAction({userId:sCH.userM.get("UserId"),tourVersion:3,action:t,startTourActionId:this.tourActionId,lastStep:u,totalTime:Math.floor((Date.now()-this.startedAt)/1e3)});var n=i.getCookie("postTourFurl");if(n)g(n,e.skipped);else{var a=e.skipped?"Okie dokie!":"Nice job!",s=sCH.lastAccessedPreReaderUrl?"<p>"+a+" Now back to the teacher view.</p>":"<p>"+a+" Now let's show you how to find interesting and engaging content for your students.</p>";if(!sCH.lastAccessedPreReaderUrl&&e.skipped&&window.location.hash.indexOf("tour")>0)m(s,(function(){return i.windowOpen("#teacher/catalog","_blank")}));else{f(),u=0,this.cachedNoteReplies=[];new Backbone.BootstrapModal({content:s,cssClass:"modal-al-tour-finished",cancelText:!1,allowCancel:!1,okText:"Let's go!"}).open((function(){if(sCH.lastAccessedPreReaderUrl)window.location.hash=sCH.lastAccessedPreReaderUrl,sCH.lastAccessedPreReaderUrl=null;else{var t=i.getCookie("postTourFurl");t?g(t,e.skipped):window.location.hash="#teacher/catalog"}}))}}},t.renderSkipTourButton=function(){if(!$(".skipTour").length){var e=this,t=$('<div class="skipTour"><a data-placement="top">leave tour</a></div>').on("click",(function(){new Backbone.BootstrapModal({title:"Are you SURE you want to leave the tour?",content:"<p>This tour is the best way to understand the student reading experience in Actively Learn. It gives you insight into how students answer questions, take notes, and use accessibility features in our platform.</p>            <p>We think you'll find it was 4 minutes well spent.</p>",cancelText:"No, back to the tour",okText:"Yes"}).open((function(){e.endTourPopup({skipped:!0})}))}));$("body").append(t),i.initTooltips($(".skipTour"))}},t.confirmRouteChange=function(e){confirm("Are you REALLY sure you want to leave the tour?")?this.endTourPopup({skipped:!0,hash:sCH.lastAccessedPreReaderUrl}):window.location.hash=e},t.isActionCurrentStep=function(e){return s.map(h,"title").indexOf(e)===u},t.blinkScrollToElements=function(){return[".teacherQuestion:eq(0)"]},t.blinkStepNumber=function(){var e=this.blinkScrollToElements()[u];if(e){var t=($(window).height()-51)/2,n=$(e).position().top-t;i.scrollElement().stop().animate({scrollTop:n},500,"swing",(function(){$(e).addClass("blinkBorder")}))}$("#tourBanner").addClass("blink"),setTimeout((function(){$("#tourBanner").removeClass("blink"),e&&$(e).removeClass("blinkBorder")}),2500)},t.trackInIntercom=function(){i.intercom("trackEvent","tour-CurrentStep",{currentStep:u}),i.intercom("update",{email:sCH.userM.get("UserName"),"Tour-CurrentStep":u})}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1291),i=n(743),o=n(346);t.default=function(e){var t=e.tiles.map((function(t,n){return t.IsTopicTile?a.createElement(i.default,{key:t.TopicId,data:t}):e.areTilesDraggable?a.createElement(s.default,{key:t.LearnEntityId+"_"+n+"_"+t.FolderId,data:t,page:e.page,classObj:e.classObj||{}}):a.createElement(o.default,{key:t.LearnEntityId+"_"+n,data:t,page:e.page,classObj:e.classObj||{}})}));return a.createElement("section",{className:"tiles tilesGridView"},t)}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s,i,o,r=n(487),l=n(85),d=n(792),c=n(5),u=n(37),p=n(20);!function(e){e.Assigned="assigned",e.Recommended="recommended"}(s=t.InterventionStatus||(t.InterventionStatus={})),t.init=function(){document.querySelector("link[rel*='icon']").href=p.default.mathIframeOrigin+"/favicon.ico",window.addEventListener("message",(function(e){if(e.origin==p.default.mathIframeOrigin)if("CHECK_FIRST_CLASS"===e.data.event)r.default.showCreateFirstClassPopup((function(){window.mathIFrame.postMessage(e.data,e.origin)}));else if("UPDATE_HASH"===e.data.event){var n="#"+("student"===sCH.userM.get("Role")?"student":"teacher")+e.data.path;e.data.redirect?window.location.hash=n:u.replaceBrowserNavigationHistory(n)}else"UPDATE_PAGE_TITLE"===e.data.event?window.document.title=e.data.title:"ASSIGN_SUCCESS"===e.data.event?r.default.showAssignLayerSuccessPopup(e.data):"API_ERROR"===e.data.event?c.bootstrap.alert({alert:"danger",message:403===e.data.statusCode?alcfg.errorTexts.connection.error.notAuthorized:e.data.message||alcfg.alertsText.requestFailed,autoClose:!1}):"READER_ACCESS_ERROR"===e.data.event?d.handleReaderAccessError(e.data):"EXIT_READER"===e.data.event?t.redirectOnReaderExit(e.data):"AUTOLOGOUT"===e.data.event&&l.startSignOut("math iframe")}))},t.redirectOnReaderExit=function(e){var t="preview"===e.readerType?"/catalog":"/classes/"+e.classId+("student"===sCH.userM.get("Role")?"/assignments":"/assess");window.location.hash=l.roleForUrl()+t},function(e){e[e.NEED_SUPPORT=60]="NEED_SUPPORT",e[e.STRUGGLING=80]="STRUGGLING",e[e.APPROACHING=90]="APPROACHING",e[e.MASTERED=100]="MASTERED"}(i=t.MasteryCeiling||(t.MasteryCeiling={})),function(e){e.NEED_SUPPORT="Need Support",e.STRUGGLING="Struggling",e.APPROACHING="Approaching Mastery",e.MASTERED="Mastery"}(t.MasteryLabel||(t.MasteryLabel={})),function(e){e.NEED_SUPPORT="#D81D1D",e.STRUGGLING="#EABDBB",e.APPROACHING="#E78E89",e.MASTERED="#1BD98D"}(o=t.MasteryColor||(t.MasteryColor={})),t.getMasteryColor=function(e){return isNaN(e)?null:e<i.NEED_SUPPORT?o.NEED_SUPPORT:e<i.STRUGGLING?o.STRUGGLING:e<i.APPROACHING?o.APPROACHING:e<=i.MASTERED?o.MASTERED:void 0},t.getStudentPercentInEachMasteryRange=function(e){for(var n={noData:0,needSupport:0,struggling:0,approaching:0,mastered:0},a=0,s=e;a<s.length;a++){var o=s[a],r=o.mastery,l=o.numProblemsCompleted;if(!isNaN(r)){var d=t.percent(r,1);null===d||l<=2?n.noData+=1:d<i.NEED_SUPPORT?n.needSupport+=1:d<i.STRUGGLING?n.struggling+=1:d<i.APPROACHING?n.approaching+=1:d<=i.MASTERED&&(n.mastered+=1)}}var c=h(n);for(var u in n)n[u]=t.percent(n[u],c);return[n.noData,n.needSupport,n.struggling,n.approaching,n.mastered]},t.percent=function(e,t){return 0===t||isNaN(e)||null===e?null:Math.round(e/t*100)};var h=function(e){var t=0;for(var n in e)t+=e[n];return t};t.updateInterventionStatus=function(e,t){for(var n=0,a=e;n<a.length;n++)for(var i=0,o=a[n].interventions;i<o.length;i++){var r=o[i];-1!==t.indexOf(r.interventionId)&&(r.status=s.Assigned)}return e},t.studentDataMasteryStudentDropdownStyles={container:function(e){return a(a({},e),{letterSpacing:-.5,fontSize:34,fontFamily:"AvenirNextLTW02-Medium"})},control:function(e){return a(a({},e),{width:350,cursor:"pointer",border:0,boxShadow:"initial"})},input:function(e){return a(a({},e),{height:41})},menu:function(e){return a(a({},e),{zIndex:3,minWidth:300,marginTop:15,fontSize:24})},indicatorsContainer:function(e){return a(a({},e),{height:50,"& svg":{height:40,width:40}})},indicatorSeparator:function(){return{display:"none"}}},t.classDataInterventionAssignmentDropdownStyles={container:function(e){return a(a({},e),{letterSpacing:-.5,fontSize:16,fontFamily:"AvenirNextLTW02-Medium"})},control:function(e){return a(a({},e),{width:350,cursor:"pointer",boxShadow:"initial"})},input:function(e){return a(a({},e),{height:23})},menu:function(e){return a(a({},e),{zIndex:3,minWidth:300,fontSize:14})},indicatorsContainer:function(e){return a(a({},e),{height:32,"& svg":{height:20,width:20}})},indicatorSeparator:function(){return{display:"none"}}}},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(43);t.embed=function(e,t,n){if(e.collapse(!1),e.pasteHTML)e.pasteHTML(t);else{document.createElement("div").innerHTML=t;for(var a=document.createDocumentFragment(),s=void 0;s=t.firstChild;)a.appendChild(s);e.insertNode(a);var i=$("#tag"+n)[0];if(i)for(;(s=i.nextSibling)&&s&&s.className&&s.className.indexOf("teacherQuestion")>-1;)s.parentNode.removeChild(i),s.parentNode.insertBefore(i,s.nextSibling)}},t.restoreSelection=function(e,t,n,a){var s,i=[],o=0,r=rangy.createRange(),l=!1;r.collapseToPoint(e,0);for(var d=0;d<a.length;d++){var c=a[d].node;if(3===c.nodeType&&"\n"!==c.nodeValue&&a[d].isValidWhiteSpace){var u=o+c.length;if(!l&&t>=o&&t<u&&(s=c,r.setStart(c,t-o),l=!0),l&&n>=o&&n<=u){if(s!==c){r.setEndAfter(s),i.push(r);var p=rangy.createRange();p.setStart(c,0),p.setEnd(c,n-o),i.push(p)}else r.setEnd(c,n-o),i.push(r);break}s!==c&&s&&(r.setEndAfter(s),i.push(r),(r=rangy.createRange()).setStart(c,0),s=c),o=u}else if(l&&-1!==["IMG","FIGURE","IFRAME"].indexOf(c.tagName)){var h=rangy.createRange();h.mediaNode=c,i.push(h)}}return i},t.saveSelection=function(e,t){var n={},i=rangy.getSelection(),o=0,r=0,l=0,d=!1,c=0===i.rangeCount?null:i.getRangeAt(0),u="";if(null!==c){try{u=c.text()}catch(e){u=c.toString()}try{var p=$(c.startContainer.parentNode).closest("div[contenteditable]").length>0,h=t.isTouchDevice&&u.indexOf(" ")>=0||"mouse"===sCH.readerConfig.textSelectionType||s.ios||s.android&&!s.chrome||!t.isTouchDevice;if(a.shouldSnapToWordHighlight(u)&&0!=u.length&&!p&&h){t.isTouchDevice&&(document.onselectionchange=null);var g=/^\s+/.exec(u);g&&c.moveStart("character",g[0].length),(g=/\s+$/.exec(u))&&c.moveEnd("character",-g[0].length),i.setSingleRange(c),i.expand("word",{wordOptions:{wordRegex:/[^/\u2013|\u2014|\-|\s]+/gi}}),c=i.getRangeAt(0),i.setSingleRange(c),t.isTouchDevice&&window.setTimeout((function(){t.initSelection()}),0)}if("student"===sCH.readerConfig.type||"grading"===sCH.readerConfig.type){var f=$(c.commonAncestorContainer).closest([".nameAndNote .text",".questionTagText",".responseContainer .text",".questionChoices .txtChoice",".teacherComment",".definitions",".translation",".textSummary",".modelResponse"].join(",")),m=f.length>0,v=$(c.commonAncestorContainer).closest([".definitions",".translation"].join(",")).length>0;if(m)return{start:0,end:i.text().length,range:i._ranges.length>0?i.getRangeAt(0):null,text:i._ranges.length>0?i.text().replace(/[\r\n]/g," "):null,isSelectionInPopup:m,isSelectionInFixedMenu:v,validNotInTextSelection:f}}}catch(e){}}if(i.rangeCount)if(c.endOffset===c.startOffset&&c.endContainer.textContent===c.startContainer.textContent)r=c.startOffset,l=c.endOffset;else try{!function e(t){var a=!1,s=!1,i=!1;try{s=$(t).closest(".pnum").length>0,a=$(t).closest(".teacherQuestion, .btnAddQuestion, .endSectionQuestions, .ignoreForTextSelection").length>0,i=" "===t.nodeValue||""!==$.trim(t.nodeValue)}catch(e){a=!1,i=!1}if(3===t.nodeType&&"\n"!==t.nodeValue&&i&&!a){if(d||(t==c.startContainer||sCH.readerConfig.isPDF&&t==c.endContainer)&&(r=o+c.startOffset,d=!0),d&&t==c.endContainer)throw l=o+c.endOffset,n;s||(o+=t.length)}else for(var u=0,p=t.childNodes.length;u<p;++u)e(t.childNodes[u])}(e)}catch(e){if(e!=n)throw e}$(".pnum span").text(" ");var b=i._ranges.length>0?i.getRangeAt(0).toString():null;return $(".pnum span").each((function(e){var t=$(this);t.text(t.data("count"))})),{start:r,end:l,range:i._ranges.length>0?i.getRangeAt(0):null,text:b}},t.safeNormalize=function(e){void 0!==e&&function e(t){try{for(var n=0;n<t.childNodes.length;n++)3!=t.childNodes[n].nodeType?e(t.childNodes[n]):null!=t.childNodes[n].nextSibling&&3==t.childNodes[n].nextSibling.nodeType&&(t.childNodes[n].nodeValue=t.childNodes[n].nodeValue+t.childNodes[n].nextSibling.nodeValue,t.removeChild(t.childNodes[n].nextSibling),n--)}catch(e){}}(e)}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(8),i=n(5),o=n(85),r=n(446),l=n(37);t.checkingConnection=!1,t.isProcessingAjaxRequests=!1;var d=".connection, .reader, .modal-al-responses-list .voting";t.check=function(e){$.get("/version.json",(function(){e(!1);var t=r.get("userIdSignedOutWhenOffline");t&&sCH.userM.get("UserId")===t&&(o.signOut(),r.remove("userIdSignedOutWhenOffline"))})).fail((function(){window.location.href.indexOf("student/reader")>0&&$(d).addClass("offline"),e(!0)}))},t.startReconnectCheck=function(e){var t=this;this.checkingConnection&&!e||this.check((function(e){e?(t.checkingConnection=!0,t.onlineCheckTimer=window.setTimeout((function(){t.startReconnectCheck(!0)}),5e3)):(t.checkingConnection=!1,$(d).removeClass("offline").addClass("online"),sCH.userM&&t.sendAndClearRequestsFromLocalStorage(),i.isUserInReader()?sCH.learnEntityMetaM&&sCH.learnEntityMetaM.get("LearnEntityId")?window.location.href.indexOf("student/reader")>0&&Backbone.pubEv.trigger("rerenderOfflineMCResponse"):i.showErrorPopup(alcfg.errorTexts.connection.error.onlineAfterRequestFailedInOffilneMode):$(".alertContainer .alert").remove())}))},t.getQueryVariable=function(e){return e.modelAdded?e.modelAdded.modelIdAttribute?e.modelAdded.modelIdAttribute:e.modelAdded.get&&e.modelAdded.get(e.modelIdAttribute)?e.modelAdded.get(e.modelIdAttribute):null:null},t.addToOfflineKeys=function(e){var t=r.get("offlineKeys")||[];t.push(e),r.set("offlineKeys",t)},t.saveRequestToLocalStorage=function(e){e.onSuccess=null,e.onError=null,e.mainSuccess=null,e.error=null,e.collection=null,e.savedTimestamp=(new Date).getTime();var t=this.getQueryVariable(e);t||(t=e.rndId?e.rndId:i.getRandomInteger()),e.schoolId=s.map(sCH.userM.get("SchoolInfo"),"SchoolId")[0];var n="offline"+t;try{if(this.updateAjaxObjectByKey(e,"UserId"),["edit","markdraft","resetanswer","requestresetanswer"].some((function(t){return e.url.includes(t)}))){if(o=r.get(n)){if(-1!==e.url.indexOf("editnote"))o.url=-1!==o.url.indexOf("editnote")?e.url:e.url.replace("/edit","/add"),o.data=e.data;else for(var a in e.data)o.data[a]=e.data[a];return void r.set(n,o)}r.set(n,e),this.addToOfflineKeys(n)}else if(e.url.indexOf("delete")>-1){var o;if((o=r.get(n))&&o.url.indexOf("add")>0)return void r.remove(n);r.set(n,e),this.addToOfflineKeys(n)}else e.url.indexOf("add")>-1?(r.set(n,e),this.addToOfflineKeys(n)):e.url.indexOf("nsfevent")>-1&&(r.set(n,e),this.addToOfflineKeys(n))}catch(e){}},t.sendAndClearRequestsFromLocalStorage=function(){var e=this,t=function(){var n=r.get("offlineKeys");if(!n||n&&0==n.length)return e.isProcessingAjaxRequests=!1,$(d).removeClass("online"),void $(".connection").attr("data-content","");var a=n[0];if(a){$(".connection").attr("data-content"," and syncing...");var s=r.get(a);if(s){var i=(new Date).getTime()-s.savedTimestamp;e.updateAjaxObjectByKey(s,"ShouldIgnoreAuthorization"),e.updateAjaxObjectByKey(s,"CSRFToken"),s.url.indexOf("nsfevent")>-1&&(s.data.offlineInterval=i),s.key=a.replace("offline",""),s.success=function(e){if(e){var s=e.Data?e.Data.TagId?e.Data.TagId:e.Data.NoteTagResponseId?e.Data.NoteTagResponseId:e.Data.MarkerTagId?e.Data.MarkerTagId:e.Data.NoteTagId:e.QuestionTagResponseId?e.QuestionTagResponseId:e.markerTagId;if(s&&($("*[data-tagid='"+this.key+"']").data("tagid",s),$("*[data-tagid='"+this.key+"']").attr("data-tagid",s),$("*[data-tagresponseid='"+this.key+"']").attr("tagresponseid",s),$("*[data-tagresponseid='"+this.key+"']").attr("data-tagresponseid",s)),this.modelAdded){if(this.collectionName&&sCH[this.collectionName]){var i={};i[this.modelIdAttribute]=parseInt(this.key);var o=sCH[this.collectionName].findWhere(i);o&&(o.set(this.modelIdAttribute,s),e.associatedNoteTagId&&o.set("AssociatedNoteTagId",e.associatedNoteTagId),e.Grade&&o.set("Grade",e.Grade),e.correctQuestionChoiceIds&&e.correctQuestionChoiceIds.length>0&&sCH.teacherQuestionsC.find({TagId:e.QuestionTagId}).updateCorrectQuestionChoices(e.correctQuestionChoiceIds))}this.modelAdded[this.modelIdAttribute]=s}}r.remove(a),n.shift(),r.set("offlineKeys",n),t()},s.error=function(){r.remove(a),n.shift(),r.set("offlineKeys",n),t()},c(s),$.ajax(s),s.schoolId&&Backbone.tracking&&Backbone.tracking.trackGAEvent("offlineRequests:replay",{schoolId:s.schoolId,queryData:s.data,url:s.url})}else n.shift(),r.set("offlineKeys",n),t()}else n.shift(),r.set("offlineKeys",n),t()};r.localStorageSupported()&&!e.isProcessingAjaxRequests&&(e.isProcessingAjaxRequests=!0,t())};var c=function(e){var t,n=e.modelAdded;if(n&&n[e.modelIdAttribute]&&sCH[e.collectionName]){var s=sCH[e.collectionName].findWhere(((t={})[e.modelIdAttribute]=n[e.modelIdAttribute],t)),i=parseInt(e.data.assignmentId);s||n.UserId!==sCH.userM.get("UserId")||i!==parseInt(sCH.readerConfig.assignmentId)||sCH[e.collectionName].add(a(a({},n),{CreatedByCurrentUser:!0}))}};t.clearOnlineCheckTimer=function(){this.onlineCheckTimer&&(clearTimeout(this.onlineCheckTimer),this.onlineCheckTimer=null),this.isProcessingAjaxRequests=!1},t.updateAjaxObjectByKey=function(e,t){var n="string"==typeof e.data,a=n?l.getParamsFromQueryString(e.data):e.data;"CSRFToken"===t?a.csrfToken=sCH.userM.get("csrfToken"):"UserId"===t?(a.UserId=sCH.userM.get("UserId"),a.userId=sCH.userM.get("UserId")):"ShouldIgnoreAuthorization"===t&&sCH.userM.get("UserId")!==parseInt(a.UserId)&&(a.ShouldIgnoreAuthorization=!0,a.isOfflineReplayRequest=!0),e.data=n?l.generateUrlQueryStringFromParams(a):a},t.handleOfflineError=function(){var e=this;this.check((function(t){i.bootstrap.alert({alert:"danger",message:t?alcfg.alertsText.studentOfflineMessage:alcfg.alertsText.requestFailed}),t&&e.startReconnectCheck()}))}},,,,function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(230),r=n(13),l=r.makeStyles({paper:{maxWidth:400,minWidth:100,maxHeight:400,fontSize:14,fontFamily:"AvenirNextLTW02-Medium",lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"center",padding:"9px 14px","&::before":{content:'""',position:"fixed",border:"10px solid transparent",width:0,height:0,filter:"drop-shadow(0 -2px 1px rgba(50,50,50,0.1))"}}}),d=r.makeStyles({root:{'&[data-placement="bottom"] .MuiPaper-root':{marginTop:5,flexDirection:"column","&::before":{content:"",borderBottomColor:"white",marginTop:-28,filter:"drop-shadow(0 -2px 1px rgba(50,50,50,0.1))"}},'&[data-placement="top"] .MuiPaper-root':{marginBottom:5,flexDirection:"column-reverse","&::before":{content:"",borderTopColor:"white",marginTop:28,filter:"drop-shadow(0 2px 1px rgba(50,50,50,0.1))"}},'&[data-placement="left"] .MuiPaper-root':{marginRight:5,flexDirection:"row-reverse","&::before":{borderLeftColor:"white",marginLeft:33,filter:"drop-shadow(2px 0 1px rgba(50,50,50,0.1))"}},'&[data-placement*="right"] .MuiPaper-root':{marginLeft:5,flexDirection:"row","&::before":{borderRightColor:"white",marginLeft:-33,filter:"drop-shadow(-2px 0 1px rgba(50,50,50,0.1))"}}}}),c={bottom:{anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},top:{anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"}},left:{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"right"}},right:{anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"}}};t.default=function(e){var t=e.buttonContent,n=void 0===t?"":t,r=e.buttonClass,u=void 0===r?"":r,p=e.children,h=e.id,g=void 0===h?"":h,f=e.placement,m=void 0===f?"bottom":f,v=s(e,["buttonContent","buttonClass","children","id","placement"]),b=i.useState(null),C=b[0],y=b[1],_=l(),S=d();return i.createElement(i.Fragment,null,i.createElement("button",a({className:u,onClick:function(e){y(e.currentTarget)},"aria-describedby":g},v,{"data-toggle":"popover"}),n),i.createElement(o.default,{id:g,classes:_,open:!!C,anchorEl:C,onClose:function(){y(null)},anchorOrigin:c[m].anchorOrigin,transformOrigin:c[m].transformOrigin,"data-placement":m,className:S.root,transitionDuration:0},i.createElement("div",{className:"content"},p)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(20),i=n(8);t.init=function(e,t,n){window.googleHelper=this,this.oauthToken=null,this.scopes=e,this.callback=t,this.gcourses=[],this.gstudents=[],this.gcoursework=[],this.gstudentsubmissions=[],this.useImmediate=!1!==n&&!!sCH.userM.get("Accounts").google,gapi.load("auth",{callback:window.googleHelper.onAuthApiLoad})},t.onAuthApiLoad=function(){var e=sCH.userM.get("Accounts").google;gapi.auth.authorize({client_id:s.default.googleApiClientId,scope:window.googleHelper.scopes,immediate:window.googleHelper.useImmediate,authuser:-1,user_id:e?e.ExternalUserId:null},window.googleHelper.checkAuthResult)},t.checkAuthResult=function(e){e&&!e.error&&(window.googleHelper.oauthToken=e.access_token,window.googleHelper.callback&&(window.googleHelper.callback(),delete window.googleHelper.callback))},t.handleAuthResult=function(e){e&&!e.error?(window.googleHelper.oauthToken=e.access_token,window.googleHelper.callback&&(window.googleHelper.callback(),delete window.googleHelper.callback)):window.googleHelper.authFail(e)},t.authFail=function(e){e.error?("idpiframe_initialization_failed"===e.error?a.bootstrap.alert({message:"Due to the latest updates from Chrome, you need to enable 3rd party cookies for Actively Learn.<br/>In a new tab, go to           <b>chrome://settings/content/cookies</b>, unblock 3rd party cookies and then refresh this page.",alert:"danger",autoClose:!1}):e.error.message&&"@ClassroomApiDisabled The user is not permitted to access the Classroom API."===e.error.message?a.bootstrap.alert({message:'Your admin must enable the ability for teachers to authorize apps to access their Google Classroom data. Visit           <a href="https://support.google.com/edu/classroom/answer/6250906">this page</a> for more information.',alert:"danger"}):"popup_blocked_by_browser"===e.error?a.bootstrap.alert({message:"Looks like our popup to get Google Classroom data got blocked! Please refresh and try again.",alert:"danger"}):"immediate_failed"===e.error?a.bootstrap.alert({message:"Request could not be auto-approved. Please refresh and try again.",alert:"danger"}):a.bootstrap.alert({message:"This account is not connected to Google Classroom.",alert:"danger"}),rg4js("send",{error:new Error("Google Classroom: "+e.error),customData:{authResult:e}})):rg4js("send",{error:new Error("Google Classroom: unknown error"),customData:{authResult:e}})},t.fail=function(e){var t=e&&404===e.code?"This class does not exist in your Google Classroom.":"There was an error connecting to Google Classroom.";a.bootstrap.alert({message:t,alert:"danger"}),rg4js("send",{error:e,tags:["Google Classroom NonAuth"]})},t.getCourseName=function(e,t){window.googleHelper.oauthToken?gapi.client.request({root:"https://classroom.googleapis.com",path:"v1/courses/"+e,params:{fields:"name,section"}}).execute((function(e){if(e.error)403===e.error.code?window.googleHelper.authFail(e):window.googleHelper.fail(e.error);else{var n=e.section?" - "+e.section:"";t(e.name+n,window.googleHelper.oauthToken)}})):this.authFail({error:"getCourseName"})},t.getCourses=function(e,t){var n=this;this.getCoursesHelper(e,(function(e,a){e?(n.gcourses=n.gcourses.concat(e),a?n.getCourses(a,t):t(n.gcourses,window.googleHelper.oauthToken)):t(n.gcourses,window.googleHelper.oauthToken)}))},t.getCoursesHelper=function(e,t){if(window.googleHelper.oauthToken){var n={pageSize:30,teacherId:"me",courseStates:["ACTIVE"]};e&&(n.pageToken=e),gapi.client.request({root:"https://classroom.googleapis.com",path:"v1/courses",params:n}).execute((function(e){e.error?403===e.error.code?window.googleHelper.authFail(e):window.googleHelper.fail(e.error):t(e.courses,e.nextPageToken)}))}else this.authFail({error:"getCoursesHelper"})},t.createCourseWork=function(e){if(window.googleHelper.oauthToken){Backbone.pubEv.trigger("loadingShowHide",!0),a.bootstrap.alert({message:"Posting your assignments as Drafts in Google Classroom...hang on one second!"});i.each(e,(function(e){"google"===e.source&&null!==e.externalClassId&&i.each(e.links,(function(t){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"https://classroom.googleapis.com/v1/courses/"+e.externalClassId+"/courseWork?alt=json&key="+alcfg.googleApiDeveloperKey,data:JSON.stringify({title:t.assignmentName,materials:[{link:{url:t.url}}],workType:"ASSIGNMENT",state:"DRAFT",maxPoints:100}),beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+window.googleHelper.oauthToken)},success:function(e){Backbone.pubEv.trigger("loadingShowHide",!1)},error:function(e){rg4js("send",{error:new Error("Google createCourseWork"),customData:a.getErrorTextFromResponse(e)}),Backbone.pubEv.trigger("loadingShowHide",!1)}})}))}))}else this.authFail({error:"createCourseWork"})},t.getCourseWork=function(e,t,n,a){void 0===a&&(a=!0);var s=this;this.getCourseWorkHelper(e,t,(function(t,a){t?(s.gcoursework=s.gcoursework.concat(t),a?s.getCourseWork(e,a,n):n(s.gcoursework,window.googleHelper.oauthToken)):n(s.gcoursework,window.googleHelper.oauthToken)}),a)},t.getCourseWorkHelper=function(e,t,n,a){if(window.googleHelper.oauthToken){var s={pageSize:30,courseWorkStates:a?"PUBLISHED":["PUBLISHED","DRAFT"]};t&&(s.pageToken=t),gapi.client.request({root:"https://classroom.googleapis.com",path:"v1/courses/"+e+"/courseWork",params:s}).execute((function(e){e.error?403===e.error.code?window.googleHelper.authFail(e):window.googleHelper.fail(e.error):n(e.courseWork,e.nextPageToken)}))}else this.authFail({error:"getCourseWorkHelper"})},t.getStudentSubmissions=function(e,t,n,a){var s=this;this.getStudentSubmissionsHelper(e,t,n,(function(n,i){n?(s.gstudentsubmissions=s.gstudentsubmissions.concat(n),i?s.getStudentSubmissions(e,t,i,a):a(s.gstudentsubmissions,window.googleHelper.oauthToken)):a(s.gstudentsubmissions,window.googleHelper.oauthToken)}))},t.getStudentSubmissionsHelper=function(e,t,n,a){if(window.googleHelper.oauthToken){var s={pageSize:30,fields:"nextPageToken,studentSubmissions(courseWorkId,userId,id)"};n&&(s.pageToken=n),gapi.client.request({root:"https://classroom.googleapis.com",path:"v1/courses/"+e+"/courseWork/"+t+"/studentSubmissions",params:s}).execute((function(e){e.error?403===e.error.code?window.googleHelper.authFail(e):window.googleHelper.fail(e.error):a(e.studentSubmissions,e.nextPageToken)}))}else this.authFail({error:"getStudentSubmissionsHelper"})}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(72);t.default=function(e){var t=e.dropdownClass,n=void 0===t?"":t,r=e.buttonClass,l=void 0===r?"":r,d=e.buttonId,c=void 0===d?"":d,u=e.buttonTitle,p=void 0===u?"":u,h=e.children,g=e.buttonChild,f=void 0===g?null:g,m=e.menuCustomClass,v=void 0===m?"":m,b=e.onClick,C=void 0===b?function(e){}:b,y=e.customProps,_=s(e,["dropdownClass","buttonClass","buttonId","buttonTitle","children","buttonChild","menuCustomClass","onClick","customProps"]);return i.createElement("div",a({className:"dropdown "+n},y),i.createElement(o.default,a({buttonClass:l,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",buttonTitle:p,buttonId:c,onClick:C},_),f),i.createElement("ul",{className:"dropdown-menu "+v,"aria-labelledby":c},h))},t.DropdownItem=function(e){var t=e.className,n=void 0===t?"":t,o=e.onClick,r=void 0===o?function(e){}:o,l=e.text,d=e.href,c=void 0===d?"javascript:void(0)":d,u=s(e,["className","onClick","text","href"]);return i.createElement("li",null,i.createElement("a",a({className:n,href:c,onClick:r},u),l))}},,,,,function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(108),c=n(38),u=n(101),p=n(102),h=n(103),g=n(530),f=n(116),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.cancel=function(){return o(a,void 0,void 0,(function(){return r(this,(function(e){return this.state.cancelAction&&this.state.cancelAction(),this.setState({open:!1}),[2]}))}))},a.ok=function(){return o(a,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return this.state.okAction?[4,this.state.okAction()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.setState({open:!1}),[2]}}))}))},a.state={id:"",open:!1,title:"",content:"",okText:"Ok",okAction:void 0,cancelText:"Cancel",cancelAction:void 0},d.event.on(d.events.DIALOG_OPEN,(function(e){a.props.id===e.id&&a.setState(i(i({},e),{open:!0}))})),d.event.on(d.events.DIALOG_CLOSE,(function(e){a.props.id===e&&a.setState({open:!1})})),a}return s(t,e),t.prototype.render=function(){return l.createElement("div",null,l.createElement(u.default,{open:this.state.open,onClose:this.cancel},this.state.title&&l.createElement(f.default,null,this.state.title),l.createElement(h.default,null,"string"==typeof this.state.content?l.createElement(g.default,null,this.state.content):this.state.content),l.createElement(p.default,null,this.state.cancelText&&l.createElement(c.default,{onClick:this.cancel,className:"btn btn-primary",color:"primary"},this.state.cancelText),l.createElement(c.default,{onClick:this.ok,className:"btn btn-primary",color:"primary"},this.state.okText))))},t}(l.Component);t.default=m}).call(this,n(21))},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1006);t.init=function(){var e=this,n=new a.default("ActivelyLearnLocalDB",{autoOpen:!1});t.defineSchemas(n),t.defineHooks(n),n.open().then((function(t){e.supported=!0,e.db=t})).catch((function(t){e.supported=!1}))},t.defineSchemas=function(e){e.version(1).stores({textSections:"TextSectionId, LearnEntityId, cacheLastAccessedDate",localSettings:"Key, cacheLastAccessedDate"})},t.defineHooks=function(e){e.tables.forEach((function(t){e[t.name].hook("creating",(function(e,t,n){"object"==typeof t&&(t.cacheCreateDate=moment.utc().valueOf())})),e[t.name].hook("reading",(function(n){return"object"==typeof n&&setTimeout((function(){var a=t.schema.primKey.keyPath;e[t.name].update(n[a],{cacheLastAccessedDate:moment.utc().valueOf()})})),n}))}))},t.storeTextSection=function(e){t.db.textSections.put(e).catch((function(n){"QuotaExceededError"===n.name&&t.db.textSections.filter((function(t){return t.LearnEntityId!==e.LearnEntityId})).toArray().then((function(n){if(n&&n.length){var a=n.map((function(e){return e.TextSectionId}));t.db.textSections.bulkDelete(a)}t.db.textSections.get(e.TextSectionId,(function(n){n||t.db.textSections.put(e)}))}))}))}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(169),r=new RegExp("^(?:(?:https?|ftp)://)?(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");t.checkUrl=function(e){return r.test(e)},t.isPDFURL=function(e){return".pdf"!=e.trim().substr(-4)||(i.bootstrap.alert({message:'The URL you entered is for a PDF. First download it to your computer and then go to "Add Content > Upload PDF".',alert:"danger",autoClose:"longer"}),!1)},t.isAtlanticURL=function(e){return e.indexOf("http://www.theatlantic.com/features")>=0&&i.bootstrap.alert({message:"Note: The Atlantic 'feature' articles currently have issues with missing words at the beginning of some paragraphs.",alert:"danger",autoClose:!1}),!0},t.isDogoNewsURL=function(e){return!(e.indexOf("dogonews.com")>=0&&597681!==sCH.userM.get("UserId"))||(i.bootstrap.alert({message:"Unfortunately, DogoNews only allows their content to be accessed on their site. If you have any questions, please email us at help@activelylearn.com.",alert:"danger",autoClose:!1}),!1)},t.handleYouTubeUrl=function(e,t,n){return a(void 0,void 0,void 0,(function(){var a,r,l,d;return s(this,(function(s){switch(s.label){case 0:return a="https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,status&id="+e+"&key="+alcfg.googleApiDeveloperKey,[4,o.get(a)];case 1:return r=s.sent(),(l=r.data).items.length>0&&(l.items[0].status.embeddable?(d={publisher:l.items[0].snippet.channelTitle,coverArtUrl:l.items[0].snippet.thumbnails.medium.url,durationInSeconds:moment.duration(l.items[0].contentDetails.duration).asSeconds()},t({validVideoUrl:"https://www.youtube.com/watch?v="+e,videoTitle:l.items[0].snippet.title,videoMetadata:d})):(i.bootstrap.alert({message:"This video is not embeddable!",alert:"danger"}),n())),[2]}}))}))},t.handleGoogleDriveVideoUrl=function(e,t,n){return a(void 0,void 0,void 0,(function(){var a,r,l,d,c;return s(this,(function(s){switch(s.label){case 0:a="https://www.googleapis.com/drive/v3/files/"+e+"?fields=id,name,owners,webContentLink,thumbnailLink,videoMediaMetadata&key="+alcfg.googleApiDeveloperKey,r=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,o.get(a)];case 2:return l=s.sent(),r=l.data,[3,4];case 3:return s.sent(),[3,4];case 4:return r&&r.videoMediaMetadata?(d={publisher:r.owners[0].displayName,coverArtUrl:r.thumbnailLink,durationInSeconds:moment.duration(parseInt(r.videoMediaMetadata.durationMillis)).asSeconds()},t({validVideoUrl:"https://drive.google.com/uc?export=download&id="+e,videoTitle:r.name,videoMetadata:d})):(c=r?"Google is unable to process this video. Please try another video.":"This video is not embeddable! Please check the sharing permissions on the video.",i.bootstrap.alert({message:c,alert:"danger"}),n()),[2]}}))}))},t.parseYouTubeUrl=function(e){var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/);return t?t[2]:null},t.parseGoogleDriveVideoUrl=function(e){if(e.indexOf("https://drive.google.com/file/d/")>=0&&e.indexOf("/view")>=0)return e.match(/[-\w]{25,}/)[0]}}).call(this,n(21))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(1036),i=n(1037),o=n(1038),r=n(1039),l=n(1040),d=n(43);t.trigger=function(e){var t=e.type,n=e.callback;if(!(sCH.readerConfig&&sCH.readerConfig.isPDF||d.mobile||sCH.userM.isALDemoUser()))if("completion"===t){var a=["mountain","swimming"];a[s=Math.floor(6*Math.random())]?(sCH.readerConfig&&(sCH.readerConfig.completionAnimationAlreadyShown=!0),c({type:a[s],callback:n})):n&&n()}else{var s;1===(s=Math.floor(4*Math.random()))&&c({type:t})}};var c=function(e){var t,n=e.type,d=e.callback;"jetpack"===n?t=s.default:"dance"===n?t=i.default:"treasureChest"===n?t=o.default:"mountain"===n?t=r.default:"swimming"===n&&(t=l.default),$(".reader").append('<div id="animationContainer"></div>');var c=$("#animationContainer");a.mountReactComponent(t,c[0],{onComplete:function(){a.unmountReactComponent(c[0]),c.remove(),d&&d()}})};t.getNoteEncouragingMessage=function(){var e=["#GNAT Greatest Note of All Time","This note is lit!"];return(e=e.concat(u))[Math.floor(Math.random()*e.length)]},t.getRandomEncouragingMessage=function(){var e=Math.floor(Math.random()*u.length);return u[e]},t.getCompletedMessage=function(){var e=["Good job completing this assignment!","Way to reach a deeper level!"];return e[Math.floor(Math.random()*e.length)]};var u=["Nice note!","Bravo!","Great thinking!","Cool beans :)","Don't stop now","GOAT","This is Gucci"]},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(1041);t.renderManageExtraHelpStudentsPopup=function(){if(!sCH.userM.isOnFreePlan()&&!sCH.userM.isAnonUser()){$("body").append('<div id="manageExtraHelpStudentsPopup"></div>');var e=sCH.classesC.toJSON(),t=sCH.learnEntityMetaM?sCH.learnEntityMetaM.get("ClassId"):e.length>0?e.ClassId:void 0;a.mountReactComponent(s.default,$("#manageExtraHelpStudentsPopup")[0],{teacherClasses:e,selectedClassId:t,onPopupClose:function(){a.unmountReactComponent($("#manageExtraHelpStudentsPopup")[0]),$("#manageExtraHelpStudentsPopup").remove()}})}}},,,,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(11),l=n(5),d=n(8),c=n(22),u=n(495),p=n(1433),h=n(1447),g=n(1448),f=n(10),m=n(1453),v=function(e){function t(t){var n=e.call(this,t)||this;return n.updateSubheader=function(e){if(Backbone.pubEv.trigger("setSubSectionTitle",e.topicName),Backbone.pubEv.trigger("setSubSectionObj",e),"Homepage"===e.topicName||"My Workspace"===e.topicName){var t=sCH.userM.get("AllowedSubjectSlugs").length>1;l.shouldShowJoyride("HowToUseCatalogV2")?n.showJoyride({showCatalogIntroSteps:!0,canChangeSubjects:t}):l.shouldShowJoyride("HowToChangeSubject")&&n.showJoyride({showCatalogIntroSteps:!1,canChangeSubjects:t})}},n.hideCovidPrimeExpiryAlert=function(){f.DisableCovidPrimeExpiryAlertForSession(),sCH.userM.set("shouldShowCovidPrimeExpiryMessage",!1),n.setState({shouldShowCovidPrimeAlert:!1})},n.state={shouldShowCovidPrimeAlert:sCH.userM.isUserCovidPrime()},n}return s(t,e),t.prototype.componentDidMount=function(){this.updateSubheader(this.props)},t.prototype.componentWillUnmount=function(){c.unmountReactComponent($("#joyride")[0])},t.prototype.componentDidUpdate=function(e){d.isEqual(e,this.props)||this.updateSubheader(this.props),l.adjustHeaderSpacing()},t.prototype.showJoyride=function(e){var t=e.showCatalogIntroSteps,n=void 0!==t&&t,a=e.canChangeSubjects,s=void 0!==a&&a,i=[];n&&(i=[{target:"#catalogNav",content:"Browse interactive assignments.",placement:"bottom",disableBeacon:!0},{target:".siteSectionSearch",content:"Search for specific texts or videos by title, author or topic.",placement:"bottom",disableBeacon:!0},{target:"#my-imports",content:"Import internet articles, Google Docs, videos or PDFs and turn them into interactive assignments.",placement:"bottom",disableBeacon:!0}],l.updateDoNotShowPopupSetting("HowToUseCatalogV2")),s&&(i.push({target:"#select-subjectFilter",content:"Access the Catalog for other subjects.",placement:"bottom",disableBeacon:!0}),l.updateDoNotShowPopupSetting("HowToChangeSubject")),i.length>0&&c.mountReactComponent(u.default,$("#joyride")[0],{steps:i})},t.prototype.render=function(){var e,t=this.props;t&&("Homepage"===t.topicName||"My Workspace"===t.topicName?e=o.createElement(p.default,i({},t)):t.topicName&&("My Imports"===t.topicName?sCH.userM.isAnonUser()||(e=o.createElement(g.default,i({},t))):"Library"!==t.topicName&&(e=o.createElement(h.default,i({},t)))));var n=document.getElementById("theSubheader");return n?r.createPortal(o.createElement(o.Fragment,null,e,this.state.shouldShowCovidPrimeAlert&&o.createElement(m.default,{hideCovidPrimeExpiryAlert:this.hideCovidPrimeExpiryAlert})),n):null},t}(o.Component);t.default=v},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=n(1336),i=function(e,t){this.on=function(e,t){a&&a.on(e,t)},a&&a.destroy(),a=new s(e,t||{})};t.default=i},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(0),l=n(1338),d=n(5),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onDrop=n.onDrop.bind(n),n.submit=n.submit.bind(n),n.state={files:[]},sCH.reactUploader=n,n}return s(t,e),t.prototype.componentWillUnmount=function(){sCH.reactUploader=null},t.prototype.onDrop=function(e,t){var n=this.getErrorMessage(e,t);n?d.bootstrap.alert({alert:"danger",message:n}):(this.props.containerModal&&this.props.containerModal.enableOk(),this.setState({files:this.state.files.concat(e)}))},t.prototype.getErrorMessage=function(e,t){var n=this.props.maxFileSize||1e7,a=o.find(e,(function(e){return e.size>n})),s=!this.props.enableMultiple&&this.state.files.length>0,i=t&&t.length;if(a){var r=n/1e6;return this.props.fileSizeErrorMessage||"Wow, that's a pretty big file! Please try uploading a file that's less than "+r+"MB instead."}return s?this.props.enableMultipleErrorMessage||"Only one file allowed.":i?this.props.fileTypeErrorMessage||"This file type is not allowed.":null},t.prototype.getNumPagesInPdf=function(e){if("application/pdf"===this.state.files[0].type){var t=new FileReader;t.onload=function(){var t=new Uint8Array(this.result);window.pdfjsLib.getDocument(t).then((function(t){var n=t.numPages;t.destroy(),e(n)}))},t.readAsArrayBuffer(this.state.files[0])}else e(0)},t.prototype.isFileUploaded=function(e){e(this.state.files.length)},t.prototype.submit=function(e,t){var n=this;if(this.state.files.length>0){for(var a=new FormData,s=i(i({},this.props.submitData),t||{}),o=0,r=Object.keys(s);o<r.length;o++){var l=r[o];s[l]&&a.append(l,s[l])}this.state.files.forEach((function(e,t){a.append("file_"+t.toString(),e,e.name)})),d.ajaxUploadFiles(this.props.uploadUrl,a,(function(t){e(t),n.props.successMessage&&d.bootstrap.alert({message:n.props.successMessage,autoClose:!1})}),(function(t,n){e(t),d.bootstrap.alert({message:"Error submitting files"+("retrying"===n?". Retrying!":"!"),alert:"danger"})}))}else{var c=new Error("noFiles");e(c)}},t.prototype.removeFile=function(e){var t=o.reject(this.state.files,(function(t){return t.name===e}));this.setState({files:t}),0===t.length&&this.props.containerModal&&this.props.containerModal.disableOk()},t.prototype.render=function(){var e=this;return r.createElement("section",null,r.createElement(l,{onDrop:this.onDrop,className:"dropzone",activeClassName:"active",disablePreview:this.props.disablePreview,multiple:this.props.enableMultiple,accept:this.props.fileType},r.createElement("p",null,this.props.fileDropPlaceholder)),r.createElement("ul",null,this.state.files.map((function(t,n){return r.createElement("li",{key:n},t.name,r.createElement("a",{className:"icon-cancel btnRemoveAddedFile displayNone",onClick:function(){return e.removeFile(t.name)}}))}))))},t}(r.Component);t.default=c},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(203),o=Math.min(.6*window.innerWidth,300);t.default=function(e){var t=e.suggestions,n=e.value,l=e.onChange,d=e.inputLabel,c=void 0===d?"":d,u=e.inputId,p=e.defaultValue,h=void 0===p?null:p,g=e.hasCustomComponent,f=void 0!==g&&g,m=e.isSearchable,v=void 0===m||m,b=e.placeholder,C=void 0===b?"":b,y=e.customSelectStyles,_=void 0===y?{}:y,S={input:function(e){return a(a({},e),{height:25,"& input":{font:"inherit",marginBottom:-5}})},option:function(e,t){return a(a({},e),{backgroundColor:t.isFocused?"#f5f5f5":"white",color:t.isSelected?"#03a9f4":"black",padding:"0px 20px",height:"auto",lineHeight:2.5,cursor:"pointer"})},indicatorsContainer:function(e){return a(a({},e),{cursor:"pointer",height:35})},control:function(e,t){return a(a({},e),{color:t.isFocused?"#777":"black",padding:0,display:"flex",maxHeight:25,marginRight:10,width:o,cursor:"pointer",borderColor:t.isFocused?"#03a9f4":"rgba(0,0,0,0.2)","&:hover":{borderColor:"#03a9f4"}})},singleValue:function(e){return a(a({},e),{color:"inherit"})},menu:function(e){return a(a({},e),{zIndex:3,width:"auto",minWidth:o,marginTop:1})},menuList:function(e){return a(a({},e),{maxHeight:400})},container:function(){return{fontSize:16,fontWeight:400}},noOptionsMessage:function(){return{padding:"0 10px"}}};return s.createElement(i.default,{styles:a(a({},S),_),inputId:u,TextFieldProps:{label:c,InputLabelProps:{htmlFor:{inputId:u},shrink:!0}},components:f?{Option:r}:{},options:t,value:n,className:"react-select",onChange:l,defaultValue:h||t[0],isSearchable:v,placeholder:C,noOptionsMessage:function(e){var t=e.inputValue;return"No results matched "+(t.trim().length>0?'for "'+t+'"':"")}})};var r=function(e){return s.createElement("div",a({style:{backgroundColor:e.isFocused?"#f5f5f5":"white",color:e.isSelected?"#03a9f4":"black",padding:"0px 20px",height:"auto",lineHeight:2.5,cursor:"pointer"},ref:e.innerRef},e.innerProps),e.data.component)};t.MultiSelectFilter=function(e){var t=e.suggestions,n=e.children,o=e.onChange,r=e.values,l=void 0===r?[]:r,d=e.menuPosition,c=void 0===d?"right":d,u=e.isDisabled,p=void 0!==u&&u,h=e.showSearch,g=void 0===h||h,f=e.className,m=void 0===f?"":f,v=e.formatOptionLabel,b=void 0===v?null:v,C={container:function(e){return a(a({},e),{overflow:"visible",fontSize:16,fontWeight:400,pointerEvents:p?"none":"all"})},menu:function(e){var t;return a(a({},e),((t={zIndex:3,width:300,marginTop:g?65:10})["center"===c?"right":"left"]=0,t.borderRadius="0 0 5px 5px",t))},control:function(e,t){var n;return{"& > div:first-of-type":(n={position:"absolute",width:300},n["center"===c?"right":"left"]=0,n.padding=10,n.height=55,n.top=40,n.zIndex=3,n.display=t.menuIsOpen&&g?"inline-block":"none",n.backgroundColor=t.menuIsOpen?"white":"transparent",n.borderRadius="5px 5px 0 0",n.border=t.menuIsOpen?"1px solid #ccc":"none",n.borderWidth="1px 1px 0px 1px",n)}},input:function(e){return a(a({},e),{padding:5,height:30,lineHeight:1,border:"1px solid #ccc"})},option:function(e,t){return a(a({},e),{backgroundColor:t.isFocused?"#f5f5f5":"white",color:t.isSelected?"#03a9f4":"black",padding:"10px 20px",lineHeight:1.2,cursor:"pointer",display:"flex",justifyContent:"space-between",fontFamily:"AvenirNextLTW02-Medium","&::after":{display:t.isSelected?"block":"none",position:"relative",content:'""',color:"red"}})},multiValue:function(){return{display:"none"}},indicatorSeparator:function(){return{display:"none"}},indicatorsContainer:function(e){return a(a({},e),{height:30,"& > div":{height:30,display:"flex",alignItems:"center",padding:0}})}},y=s.useState(l),_=y[0],S=y[1];s.useEffect((function(){(!l||l.length>0)&&S(l)}),[l]);var w=s.createRef();return s.createElement("div",{ref:w,className:m},s.createElement(i.default,{value:_,isMulti:!0,options:t,styles:C,hideSelectedOptions:!1,blurInputOnSelect:!1,closeMenuOnSelect:!1,isClearable:!1,formatOptionLabel:b,placeholder:"",onChange:function(e){S(e),o(e||[])},noOptionsMessage:function(e){var t=e.inputValue;return"No results "+(t.trim().length>0?'matched for "'+t+'"':"")},components:{DropdownIndicator:function(e){return s.createElement(i.components.DropdownIndicator,a({},e),n)}},onMenuOpen:function(){setTimeout((function(){var e=w.current&&w.current.querySelector('input[type="text"]');e&&e.focus()}),100)}}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(44);t.default=Backbone.Model.extend({sync:s.default,idAttribute:"TagId",defaults:function(){return{TagId:null,TextSectionId:null,UserId:null,Type:"",StartIndex:null,EndIndex:null,Text:"",HTML:"",MediaAttribution:"",IsDeleted:null,CreateDate:null,UpdateDate:null,AssignmentId:null,Active:!1,Visible:!0,Color:"",Category:"",Username:null,ImageUrl:"",IsPublic:!1,CreatedByCurrentUser:!1,StudentLayerId:null,ReplyCount:0,HighlightedText:null,IsAssociatedNote:!1}},fixUsernameField:function(){return a.sanitize(this.get("Username",!0))},fixTextField:function(){return a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Text",!0)))},fixHTMLField:function(){return a.sanitize(this.get("HTML",!0))},isHighlightOnly:function(){var e=this.fixHTMLField()||"",t=$(this.fixTextField()).text()||"";return!e.trim()&&!t.trim()},saveData:function(e,t){if(e.noteTagId=this.get("TagId"),"tour"!==sCH.readerConfig.type&&this.hasNoteChanged(e)){var n=alcfg.node["reader_"+sCH.readerConfig.type].edit_note,s=this,i=function(n,a){s.set({Text:e.text,HTML:e.html,MediaAttribution:e.mediaAttribution,Color:e.color,Category:e.category,IsExtraHelp:e.isExtraHelp,UpdateDate:n.updateDate,WordCount:e.wordCount,IsPublic:e.isPublic}),a&&(n.modelAdded=s.at(0),n.modelIdAttribute="TagId"),t.success&&t.success()};a.ajax({type:"POST",url:n,data:e,onSuccess:function(e){i(e)},onError:function(e,t){"offline"===t&&i(e,!0)}})}},hasNoteChanged:function(e){return e.isPublic!==this.get("IsPublic")||e.text!==this.get("Text")||e.html!==this.get("HTML")||e.color!==this.get("Color")||e.catagory!==this.get("Category")||e.isExtraHelp!==this.get("IsExtraHelp")||e.mediaAttribution!==this.get("MediaAttribution")},deleteData:function(){this.id=this.get("TagId");var e=sCH.readerConfig.type;this.url=alcfg.node["reader_"+e].delete_note;var t={data:{noteTagId:this.get("TagId")},mainError:function(e,t,n){"offline"===t&&(n.modelAdded=e,n.modelIdAttribute="TagId")}};switch(sCH.readerConfig.type){case"student":t.data.assignmentId=sCH.readerConfig.assignmentId;break;case"authoring":t.data.layerId=sCH.readerConfig.layerId;break;case"grading":t.data.assignmentId=sCH.readerConfig.assignmentId;break;case"studentresearch":case"studentir":t.data.studentLayerId=sCH.readerConfig.studentLayerId}"tour"===sCH.readerConfig.type?(this.stopListening(),this.trigger("destroy",this,this.collection,t)):this.destroy(t)},checkUserId:function(e){return this.get("UserId")===e}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({template:n(1008),initialize:function(e){this.on("initialized",this.initialized),this.on("openInNewTab",(function(e){a.windowOpen(this.data.url,"_blank"),e.close()})),this.videoId=e.videoId||null,this.scope=e.scope||{},this.configId=e.configId||null,this.introText=e.introText||null,this.data=e.data||null,this.autoPlay=e.autoPlay||!1,this.videoUrlData=e.videoUrlData},initialized:function(e){this.modal=e},render:function(){var e=this;if(this.$el.html(this.template({videoId:this.videoId,introText:this.introText,data:this.data,autoPlay:this.autoPlay,videoUrlData:this.videoUrlData})),this.data){if("video"===this.data.type&&this.data.html.indexOf("youtu")>=0){var t=$(this.data.html).attr("src"),n=t.indexOf("?")>0?"&":"?";this.data.html=this.data.html.replace(t,t+n+"autoplay=1")}if(this.$el.find(".embedMediaFullContainer").html(this.data.html),"video"===this.data.type){this.modal.$el.find(".modal-dialog").css({width:"70%"});var a=this.$el.find(".embedMediaFullContainer iframe"),i=parseInt(a.attr("width"))/parseInt(a.attr("height"));window.setTimeout((function(){a.css({height:e.$el.find(".embedMediaFullContainer").width()/i})}),500)}else{var o=this.data.width>$(window).width()?"95%":this.data.width<295?"295px":this.data.width;this.modal.$el.find(".modal-dialog").css("width",o)}}if(this.videoId){var r=this.configId,l=this.scope;window._wq=window._wq||[],window._wq.push({id:this.videoId,onReady:function(e){e.bind("end",(function(e){r&&l.renderComplete&&(s.UpdateProfessionalLearningCompletion({configId:r,type:"Video"}),l.renderComplete(r,"Video",1))}))}})}return this}})},,function(e,t,n){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});var s=n(8),i=n(5),o=n(333),r=n(682),l=n(683),d=n(684),c=n(1124),u=n(685),p=n(1126),h=n(686),g=n(687),f=n(1129),m=n(1130),v=n(1131),b=n(462),C=n(1134),y=n(1136),_=n(87);t.userM=null,t.catalogC=null,t.classesC=null,t.studentBookshelfC=null,t.researchC=null,t.allStudentsC=null,t.schoolsC=null,t.selectedSchoolId=null,t.teachersC=null,t.readerConfig=null,t.learnEntityMetaM=null,t.learnEntitySectionsMetaC=null,t.learnEntitySectionsC=null,t.teacherQuestionsC=null,t.teacherNotesC=null,t.teacherMarkersC=null,t.questionTagResponsesC=null,t.studentNotesC=null,t.studentFlagsC=null,t.allStudentTagsC=null,t.questionsNumC=null,t.readerSettingsM=null,t.studentsC=null,t.teacherAssignmentData=null,t.questionResponseCounts=null,t.resetRequests=null,t.replyDataByStudent=null,t.assignmentUsers=null,t.clear=function(){this.userM=null,this.catalogC=null,this.classesC=null,this.studentBookshelfC=null,this.researchC=null,this.allStudentsC=null,this.schoolsC=null,this.selectedSchoolId=null,this.teachersC=null},t.clearCollection=function(e){a[e]=null},t.initStudents=function(){a.studentsC=new b.default},t.initClasses=function(e,t){this.classesC?e():(this.classesC=new o.default,this.classesC.fill(t,e))},t.initResearch=function(e,t){this.researchC?t():(this.researchC=new r.default,this.researchC.on("sync",(function(){t()})),this.researchC.fill({classId:e}))},t.initStudentBookshelf=function(e){this.studentBookshelfC?e():(this.studentBookshelfC=new l.default,this.studentBookshelfC.on("sync",(function(){e()})),this.studentBookshelfC.fill())},t.initDistrictSchools=function(e){this.schoolsC?e():(this.schoolsC=new C.default,this.schoolsC.on("sync",e),this.schoolsC.fill({districtId:this.userM.getPrimarySchool().DistrictId}))},t.initTeachersInstruction=function(e){this.teachersC?e():(this.teachersC=new y.default,this.teachersC.on("sync",e),this.teachersC.fillWithColleagues(!1,!1,!0))},t.initReader=function(){this.learnEntityMetaM=new d.default,this.learnEntitySectionsMetaC=new u.default,this.learnEntitySectionsC=new p.default,this.readerSettingsM=new c.default,this.questionsNumC=new v.default,this.teacherNotesC=new f.default,this.teacherQuestionsC=new h.default,this.teacherMarkersC=new m.default,this.questionTagResponsesC=new g.default,this.studentNotesC=new f.default,this.studentFlagsC=new m.default,this.allStudentTagsC=new f.default,this.readerConfig={},this.studentsC=new b.default},t.loadReaderData=function(e,t){var n=this;for(var a in this.learnEntityMetaM.initWithData(e.LearnEntityMetaM),this.learnEntitySectionsMetaC.initWithData(e.LearnEntitySectionsMetaC),this.readerSettingsM.initWithData(e.ReaderSettingsM),this.questionsNumC.initWithData(e.QuestionsNumC),this.readerConfig.feedbackEnabled=e.FeedbackEnabled,this.readerConfig.directions=e.Directions,this.readerConfig.isStudentStruggling=e.IsStudentStruggling,this.readerConfig.standards=e.Standards?e.Standards.sort((function(e,t){return _(e.StandardCode,t.StandardCode)})):null,this.readerConfig.textSummaries={},this.readerConfig.teachingIdeas={},e.TextSectionMetadata)e.TextSectionMetadata.hasOwnProperty(a)&&(e.TextSectionMetadata[a].summaryText&&(this.readerConfig.textSummaries[a]=e.TextSectionMetadata[a].summaryText),["authoring","grading"].indexOf(this.readerConfig.type)>-1&&e.TextSectionMetadata[a].teachingIdeas&&(this.readerConfig.teachingIdeas[a]=JSON.parse(e.TextSectionMetadata[a].teachingIdeas)));this.readerConfig.isAssessment=this.learnEntityMetaM.get("IsAssessment"),e.TagConfig.Configs?this.readerConfig.tagConfig=e.TagConfig.Configs:this.readerConfig.tagConfig=[],"grading"===this.readerConfig.type?(this.readerConfig.TeacherCommentSuggestions=[],this.readerConfig.ungradedResponseIds={},this.readerConfig.ungradedResponseIdsByUser={},this.readerConfig.isSmallGroupsEnabled=e.isSmallGroupsEnabled,null!==e.UngradedResponseIds&&s.each(e.UngradedResponseIds,(function(e){n.readerConfig.ungradedResponseIds[e.QuestionTagId]?n.readerConfig.ungradedResponseIds[e.QuestionTagId].push(e.QuestionTagResponseId):n.readerConfig.ungradedResponseIds[e.QuestionTagId]=[e.QuestionTagResponseId],n.readerConfig.ungradedResponseIdsByUser[e.UserId]?n.readerConfig.ungradedResponseIdsByUser[e.UserId].push(e.QuestionTagResponseId):n.readerConfig.ungradedResponseIdsByUser[e.UserId]=[e.QuestionTagResponseId]}))):"authoring"===this.readerConfig.type?(this.readerConfig.layerCoauthorNameMap=e.LayerCoauthorNameMap,this.readerConfig.layers=e.Layers,this.readerConfig.textLicenseState=e.TextLicenseState,this.readerConfig.isInLibrary=e.IsInLibrary,this.readerConfig.libraryLayerDownloadCount=e.LibraryLayerDownloadCount):"student"===this.readerConfig.type&&(this.readerConfig.keyVocabWords=e.keyVocabWords,this.readerConfig.isSmallGroupsEnabled=e.isSmallGroupsEnabled,this.readerConfig.smallGroupName=e.smallGroupName,this.studentsC.initWithData(e.students),Backbone.pubEv.trigger("configureAssignmentLock",{assignmentInit:!0})),s.includes(["authoring","grading"],this.readerConfig.type)&&(this.readerConfig.keyVocabularyWords=e.keyVocabularyWords),s.includes(["studentir","studentresearch"],this.readerConfig.type)?this.readerConfig.StudentLayerCoauthors=e.StudentLayerCoauthors:s.includes(["student","grading"],this.readerConfig.type)&&(this.readerConfig.ClassTeachers=e.ClassTeachers),t&&t()},t.getTextSectionIdToOpen=function(){var e=a.readerSettingsM.get("LastReadTextSectionId");return"authoring"===a.readerConfig.type&&-1===e?a.learnEntityMetaM.get("DefaultTextSectionIdToOpen")||-1:e},t.loadReaderTags=function(e,t,n){var a=-1!==n.indexOf("question"),o=-1!==n.indexOf("note"),r=e.teacherNotes,l=e.teacherMarkers,d=e.teacherQuestions;if(o&&this.teacherNotesC.initWithData(r,t),a){var c=this.readerConfig.isAssessment&&"student"===this.readerConfig.type&&this.learnEntityMetaM.get("RandomizeQuestionOrder");c&&(d=i.randomizeArray(d,window.ActivelyRead.currentUserId+parseInt(sCH.readerConfig.assignmentId)),this.questionsNumC.updateQuestionNumbersAfterRandomization(d)),this.teacherQuestionsC.initWithData(d,t,c),this.teacherMarkersC.initWithData(l)}if("authoring"!==this.readerConfig.type){if(a&&"studentresearch"!==this.readerConfig.type&&this.questionTagResponsesC.initWithData(e.questionTagResponses),o){var u=e.studentNotes,p=e.studentMarkers;this.studentNotesC.initWithData(u),this.studentFlagsC.initWithData(p)}s.includes(["student","studentir","studentresearch"],this.readerConfig.type)&&o&&this.allStudentTagsC.initWithData(e.otherStudentSharedNotes)}},t.loadNotesSummaryViewData=function(e){this.teacherNotesC.initWithData(e.teacherNotes,e.textSectionIds),"grading"===this.readerConfig.type?this.studentNotesC.initWithData(e.studentNotes):"student"!==this.readerConfig.type&&"studentresearch"!==this.readerConfig.type||(this.studentNotesC.initWithData(e.studentNotes),this.allStudentTagsC.initWithData(e.otherStudentSharedNotes))},t.initReplyDataForStudent=function(){return this.replyDataByStudent||(this.replyDataByStudent={}),this.replyDataByStudent},t.loadQuestionsSummaryViewData=function(e){var t=s.filter(e.TeacherTagsC,(function(e){return"question"===e.Type})),n=s.filter(e.TeacherTagsC,(function(e){return"marker"===e.Type}));this.teacherQuestionsC.initWithData(t,e.TextSectionIds),this.teacherMarkersC.initWithData(n),"authoring"!==this.readerConfig.type&&e.TeacherTagResponsesC&&this.questionTagResponsesC.initWithData(e.TeacherTagResponsesC)},t.initAssignmentData=function(e){this.teacherAssignmentData=e},t.updateUngradedList=function(e){if(!this.readerConfig.isAssessment){var t=!1;if(!e.alreadyGraded){if("add"===e.action)this.readerConfig.ungradedResponseIds[e.questionTagId]=this.readerConfig.ungradedResponseIds[e.questionTagId]||[],this.readerConfig.ungradedResponseIdsByUser[e.userId]=this.readerConfig.ungradedResponseIdsByUser[e.userId]||[],-1===$.inArray(e.questionTagResponseId,this.readerConfig.ungradedResponseIds[e.questionTagId])&&(this.readerConfig.ungradedResponseIds[e.questionTagId].push(e.questionTagResponseId),t=!0),-1===$.inArray(e.questionTagResponseId,this.readerConfig.ungradedResponseIdsByUser[e.userId])&&this.readerConfig.ungradedResponseIdsByUser[e.userId].push(e.questionTagResponseId);else{var n;if(this.readerConfig.ungradedResponseIds[e.questionTagId])-1!==(n=$.inArray(e.questionTagResponseId,this.readerConfig.ungradedResponseIds[e.questionTagId]))&&(this.readerConfig.ungradedResponseIds[e.questionTagId].splice(n,1),t=!0);if(this.readerConfig.ungradedResponseIdsByUser[e.userId])-1!==(n=$.inArray(e.questionTagResponseId,this.readerConfig.ungradedResponseIdsByUser[e.userId]))&&this.readerConfig.ungradedResponseIdsByUser[e.userId].splice(n,1)}t&&Backbone.pubEv.trigger("updateGradePanelCount")}e.updateTotals?this.updateGradingResponseTotals(e):t&&Backbone.pubEv.trigger("updateGradePanelDropdownCount",{questionTagId:e.questionTagId,userId:e.userId})}},t.updateGradingResponseTotals=function(e){var t=!1;if(this.questionResponseCounts)if("add"===e.action)this.questionResponseCounts[e.questionTagId]=this.questionResponseCounts[e.questionTagId]||[],this.questionResponseCountsByUser[e.userId]=this.questionResponseCountsByUser[e.userId]||[],-1===$.inArray(e.questionTagResponseId,this.questionResponseCounts[e.questionTagId])&&(this.questionResponseCounts[e.questionTagId].push(e.questionTagResponseId),t=!0),-1===$.inArray(e.questionTagResponseId,this.questionResponseCountsByUser[e.userId])&&this.questionResponseCountsByUser[e.userId].push(e.questionTagResponseId);else{var n;if(this.questionResponseCounts[e.questionTagId])-1!==(n=$.inArray(e.questionTagResponseId,this.questionResponseCounts[e.questionTagId]))&&(this.questionResponseCounts[e.questionTagId].splice(n,1),t=!0);if(this.questionResponseCountsByUser[e.userId])-1!==(n=$.inArray(e.questionTagResponseId,this.questionResponseCountsByUser[e.userId]))&&this.questionResponseCountsByUser[e.userId].splice(n,1)}t&&Backbone.pubEv.trigger("updateGradePanelDropdownCount",{questionTagId:e.questionTagId,userId:e.userId})},t.updateResetRequestList=function(e){if("remove"===e.action){if(a=s.find(this.resetRequests,{UserId:e.userId})){var t=a.ResetRequests.split(","),n=t.indexOf(e.questionTagResponseId.toString());-1!==n&&(t.splice(n,1),t.length>0?a.ResetRequests=t.join(","):this.resetRequests.splice(this.resetRequests.indexOf(a),1))}}else if("add"===e.action){var a;(a=s.find(this.resetRequests,{UserId:e.userId}))?-1===$.inArray(e.questionTagResponseId,a.ResetRequests.split(", "))&&(a.ResetRequests+=","+e.questionTagResponseId):this.resetRequests.push({UserId:e.userId,ResetRequests:e.questionTagResponseId+""})}},t.resetReader=function(){this.learnEntityMetaM=null,this.learnEntitySectionsMetaC=null,this.learnEntitySectionsC=null,this.teacherQuestionsC=null,this.teacherNotesC=null,this.teacherMarkersC=null,this.questionTagResponsesC=null,this.studentNotesC=null,this.studentFlagsC=null,this.allStudentTagsC=null,this.questionsNumC=null,this.readerSettingsM=null,this.studentsC=null,this.readerConfig=null,this.studentBookshelfC=null,this.researchC=null,this.teacherAssignmentData=null,this.questionResponseCounts=null,this.resetRequests=null,this.replyDataByStudent=null,this.assignmentUsers=null},t.readerSectionAlreadyLoaded=function(e){return this.learnEntitySectionsC.filter({TextSectionId:e}).length>0},t.readerTagsForSectionLoaded=function(e,t){return"question"===t?this.teacherQuestionsC.isSectionLoaded(e):this.teacherNotesC.isSectionLoaded(e)},t.getAssignmentUsers=function(){if(!this.assignmentUsers){this.assignmentUsers={teachersAndStudents:[],studentPeers:[],coTeachers:[]};var e=function(e,t){return s.filter(e||[],(function(e){return e.UserId!==sCH.userM.get("UserId")})).map((function(e){var n=e.FirstName+(e.LastName?" "+e.LastName:"");return{key:n,firstName:e.FirstName,value:n,imageUrl:e.ImageUrl,userId:e.UserId,isStruggling:e.IsStruggling,role:t}}))};s.includes(["studentir","studentresearch"],this.readerConfig.type)?this.assignmentUsers.studentPeers=e(this.readerConfig.StudentLayerCoauthors,"student"):s.includes(["student","grading"],this.readerConfig.type)&&(this.assignmentUsers.coTeachers=e(this.readerConfig.ClassTeachers,"teacher"),this.assignmentUsers.studentPeers=e(this.studentsC.toJSON(),"student"),this.assignmentUsers.teachersAndStudents=this.assignmentUsers.studentPeers.concat(this.assignmentUsers.coTeachers))}return this.assignmentUsers},t.getSmallGroupPeersName=function(){var e=t.getAssignmentUsers();return e.studentPeers&&e.studentPeers.length>0?e.studentPeers.map((function(e){return e.firstName})).join(", "):"Me"}},,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(13).withStyles,r=function(e){function t(t,n){var a=e.call(this,t)||this;return a.handleClick=function(e){a.props.parentComponentReference?a.props.pageChangeCallback.call(a.props.parentComponentReference,{pageNumber:e}):a.props.pageChangeCallback({pageNumber:e})},a}return s(t,e),t.prototype.render=function(){var e=this,t=this.props.classes,n=Math.ceil(this.props.totalItems/(this.props.itemsPerPage||30)),a=l({currentPage:this.props.currentPage,numOfPages:n});return i.createElement("div",{className:t.paginationContainer},i.createElement("ul",{className:"pagination"},this.props.currentPage?i.createElement("li",null,i.createElement("a",{className:t.page,onClick:function(){return e.handleClick(e.props.currentPage-1)}},"<")):i.createElement("li",{className:t.disabled},i.createElement("span",null,"<")),a.map((function(n,a){return n.disabled?i.createElement("li",{className:t.disabled,key:a},i.createElement("a",null,n.number)):i.createElement("li",{className:n.current?"active":"",key:a},i.createElement("a",{className:t.page,onClick:function(){return e.handleClick(n.number-1)}},n.number))})),this.props.currentPage+1<n?i.createElement("li",null,i.createElement("a",{className:t.page,onClick:function(){return e.handleClick(e.props.currentPage+1)}},">")):i.createElement("li",{className:t.disabled},i.createElement("span",null,">"))),this.props.showTotalRecordsCount&&d(this.props))},t}(i.Component),l=function(e){var t=e.currentPage,n=e.numOfPages,a=[];t>5&&(a.push({current:!1,number:1}),a.push({current:!1,number:"...",disabled:!0}));for(var s=t-5;s<t+5;++s)s<0||s>=n||a.push({current:t===s,number:s+1});return t+5<n&&(t+6<n&&a.push({current:!1,number:"...",disabled:!0}),a.push({current:!1,number:n})),a},d=function(e){var t=(e.itemsPerPage||30)*e.currentPage,n=t+e.currentPageItemsCount,a=e.totalItems>1e3?" 1000s":e.totalItems.toLocaleString()+" results";return i.createElement("div",{className:e.classes.totalRecordsCount},"Showing ",t+1," - ",n," of ",a)};t.default=o((function(){return{paginationContainer:{textAlign:"left"},page:{color:"#03A9F4","&.active":{backgroundColor:"#03A9F4",borderColor:"#03A9F4",color:"#ffffff"}},disabled:{pointerEvents:"none","& span":{color:"#CDCDCD !important"}},totalRecordsCount:{display:"inline-block",paddingLeft:"10px",verticalAlign:"top",marginTop:"20px",paddingTop:"10px",fontFamily:"Avenir Next LT W02 Demi",fontSize:"13px",opacity:.38}}}))(r)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(14),i=n(1329),o=n(22),r=n(10),l=n(20),d=n(14);t.default=Backbone.View.extend({events:{"click .btnViewHeadCount":"viewHeadCount","keypress .txtQuantity":"validateNumber","keypress .cc-number":"validateNumber","keypress .cc-month":"validateNumber","keypress .cc-year":"validateNumber","keypress .cc-cvc":"validateNumber","blur .txtQuantity":"updateTotal","click .regular-radio":"licenseSelected"},template:n(1330),initialize:function(e){this.on("shown",this.shown),this.obj=e},shown:function(e){var t=this;this.modal=e,this.obj.textM.Territories?sCH.userM.getCountryCode((function(n){-1===t.obj.textM.Territories.indexOf(n)?(t.$el.html("<p>The publisher of this rental text has not made it available in "+n+".</p>"),e.disableOk("OK")):t.postInitialize()})):this.postInitialize()},showRequestTypeForm:function(){sCH.userM.isSchoolUsingContentCredits()||this.isTextToBeMadeFreeDuringCovid||o.mountReactComponent(i.default,this.$el.find(".requestForm")[0],{okBtn:this.modal.$el.find(".btn.ok")})},postInitialize:function(){Stripe.setPublishableKey(l.default.stripeKey),this.parent=this.obj.parent,this.textM=this.obj.textM,this.source=this.obj.source,this.isRedirectToAssignAfterBuying=this.obj.isRedirectToAssignAfterBuying,this.paidLearnEntity=this.textM.RentalPrices,this.paidLayer=!1,this.minQuantity="HarperCollins"!==this.textM.Publisher||sCH.userM.isSchoolUsingContentCredits()?1:5,this.obj.source===s.LearnEntityPurchaseSource.TEACHER_READER&&(this.quantity=1,this.minQuantity=1),this.doesTeacherHaveCoTeachers=!!sCH.classesC.toJSON().find((function(e){return e.Teachers.length>1}));var e=this;this.on("ok",this.handleSubmit),this.on("cancel",(function(){e.source===s.LearnEntityPurchaseSource.TEACHER_READER&&(window.location.hash=a.getReaderExitUrl()),Backbone.tracking.trackGAEvent("teacher","purchase:cancel"),Backbone.pubEv.off("purchasedText")})),r.GetBookCreditsData((function(t){t&&(e.availableBookCreditsInCents=t.available>0?t.available:null,e.fillEl())})),Backbone.tracking.trackGAEvent("teacher","purchase:start")},fillEl:function(){var e=[s.LearnEntityPurchaseSource.CATALOG_TILE,s.LearnEntityPurchaseSource.PREVIEW_READER].indexOf(this.source)>-1;this.isTextToBeMadeFreeDuringCovid=d.CovidPaidTextsToBeMadeFree.indexOf(this.textM.LearnEntityId)>-1,this.$el.html(this.template({text:this.textM,postPurchase:!e,paidLearnEntity:this.paidLearnEntity,paidLayer:this.paidLayer,teacherOnlyRenewal:this.source===s.LearnEntityPurchaseSource.TEACHER_READER,minQuantity:this.minQuantity,isTextToBeMadeFreeDuringCovid:this.isTextToBeMadeFreeDuringCovid,doesTeacherHaveCoTeachers:this.doesTeacherHaveCoTeachers})),this.showRequestTypeForm(),this.$el.find(".btnViewHeadCount").popover(),this.updateTotal(),alcfg.weThePeopleLevel2PaidLessonLeIds.indexOf(this.textM.LearnEntityId)>-1?window.setTimeout((function(){return $(".modal-al-payment-form .modal-title").text("We the People, Level 2")}),250):alcfg.weThePeopleLevel3PaidLessonLeIds.indexOf(this.textM.LearnEntityId)>-1&&window.setTimeout((function(){return $(".modal-al-payment-form .modal-title").text("We the People, Level 3")}),250)},licenseSelected:function(){this.updateTotal()},viewHeadCount:function(){if(this.headCountHtml)this.$el.find(".btnViewHeadCount").siblings(".popover").find(".popover-content").html(this.headCountHtml);else{var e=this;r.GetStudentCount({learnEntityId:this.textM.LearnEntityId},(function(t){var n="";if(t)if(n="<div class='info'>You currently have "+t.numTotalLicenses+" \n          active licenses to grant access with</div>",t.classStudentLicenseCount.length){for(var a in n+="<table><tr><th>Class Name</th><th># Students</th><th># Needs Access</th></tr>",t.classStudentLicenseCount)n+="<tr><td>"+t.classStudentLicenseCount[a].ClassName+"</td>                <td>"+t.classStudentLicenseCount[a].TotalCount+"</td>                <td>"+t.classStudentLicenseCount[a].NumOfStudentsNeedingLicense+"</td></tr>";n+="</table>"}else n="<div>You don't have any students yet!</div>";else n="<div>An unexpected error occurred!</div>";e.$el.find(".btnViewHeadCount").siblings(".popover").find(".popover-content").html(n),e.headCountHtml=n}))}},validateNumber:function(e){return a.isNumber(e)},updateTotal:function(e){var t=0,n=this.isTextToBeMadeFreeDuringCovid?90:this.source===s.LearnEntityPurchaseSource.TEACHER_READER?1:parseInt(this.$el.find(".txtQuantity").val());if(this.quantity=isNaN(n)?0:n,this.paidLearnEntity&&this.paidLayer);else if(this.paidLearnEntity){t=parseInt(this.$el.find(".price.label").data("price"));var a="",i=this.quantity;[s.LearnEntityPurchaseSource.CATALOG_TILE,s.LearnEntityPurchaseSource.PREVIEW_READER].indexOf(this.source)>-1&&(this.quantity++,this.quantity<this.minQuantity&&this.showMinQuantityMessage(),a='<div class="info">$'+(t/100).toFixed(2)+" (your license)</div>");var o=t*this.quantity,r="";this.availableBookCreditsInCents&&this.availableBookCreditsInCents>0&&(this.creditsUsedInCents=this.availableBookCreditsInCents>o?o:this.availableBookCreditsInCents,r='<div class="info green">-'+(this.creditsUsedInCents/100).toFixed(2)+" \n        (book credits, "+((this.availableBookCreditsInCents-this.creditsUsedInCents)/100).toFixed(2)+" \n        remaining)</div>",o-=this.creditsUsedInCents),this.totalToCharge=o/100;var l=this.source===s.LearnEntityPurchaseSource.TEACHER_READER?"your license":"student licenses";a+='<div class="info">$'+(t*i/100).toFixed(2)+" \n      ("+l+")</div> "+r+" Total: $"+this.totalToCharge.toFixed(2),this.$el.find("#creditCardForm").toggleClass("disabled",0===this.totalToCharge),this.$el.find(".total").html(a)}else this.paidLayer&&(t=parseInt(this.$el.find(".price").data("price")),this.$el.find(".total").text("Total: $"+(t/100).toFixed(2)))},showMinQuantityMessage:function(){"HarperCollins"===this.textM.Publisher?a.bootstrap.alert({message:"HarperCollins requires a minimum of "+this.minQuantity+" licenses to be purchased under their K-12 Pay Per use model.",alert:"danger"}):a.bootstrap.alert({message:"A minimum of "+this.minQuantity+" licenses must be purchased!",alert:"danger"})},handleSubmit:function(e){sCH.userM.isSchoolUsingContentCredits()||"purchase"===e.$el.find("#requestTypeForm").data("reqtype")||this.isTextToBeMadeFreeDuringCovid?this.submitPayment(e):this.submitRentalRequest(e)},submitPayment:function(e){e.preventClose();var t=this,n=this.validatePaymentForm(),i=$(".price.label").data("term")||$(".regular-radio:checked").data("term"),o=this.$el.find("#chkAllowCoTeacherToUseLicense").is(":checked"),l=function(n){var l={token:n?n.id:null,cardtype:n?n.card.type:null,lastfour:n?n.card.last4:null,term:i,learnentityid:t.textM.LearnEntityId,layerid:t.textM.LayerId,teacheronly:t.source===s.LearnEntityPurchaseSource.TEACHER_READER,creditsUsed:null!=t.creditsUsedInCents&&t.creditsUsedInCents>0,isAllowedCoTeacherToUseLicense:o};sCH.userM.isSchoolUsingContentCredits()||(l.quantity=t.quantity),r.PurchaseText(l,(function(n){if(n){e.close();try{t.textM.Publisher===alcfg.weThePeoplePublisher&&a.intercom("trackEvent","purchased-WTP-Text"),Backbone.tracking.trackGAEvent("teacher","purchase:complete")}catch(e){}var i=void 0;t.source===s.LearnEntityPurchaseSource.CATALOG_TILE?i=function(){Backbone.pubEv.trigger("purchasedText",n.layerId)}:t.source===s.LearnEntityPurchaseSource.PREVIEW_READER?i=function(){var e=window.location.hash.replace("preview/"+sCH.readerConfig.layerId,n.layerId);t.isRedirectToAssignAfterBuying&&(e+="/?isRedirectToAssignAfterBuying=true"),a.redirectUserByHash(e)}:t.source===s.LearnEntityPurchaseSource.TEACHER_READER?i=function(){window.location.reload()}:t.source===s.LearnEntityPurchaseSource.NEED_MORE_WHILE_ASSIGNING||t.source===s.LearnEntityPurchaseSource.WORKSPACE_TILE||t.source===s.LearnEntityPurchaseSource.MANAGE_LICENSES&&(i=function(){t.parent.licensesUpdated(t.quantity)}),sCH.userM.isSchoolUsingContentCredits()||t.isTextToBeMadeFreeDuringCovid?i():new Backbone.BootstrapModal({title:"Thank you!",content:alcfg.alertsText.learnEntityPaymentSuccess,cancelText:!1,allowCancel:!1}).open(i)}else e.enableOk(),a.bootstrap.alert({alert:"danger",message:n,autoClose:!1})}))};if(n)if(e.disableOk("Pay Now"),sCH.userM.isSchoolUsingContentCredits()||this.isTextToBeMadeFreeDuringCovid||0===this.totalToCharge)l();else{var d=$("#payment-form");Stripe.createToken(d,(function(t,n){n.error?(d.find(".payment-errors").text(n.error.message),e.enableOk()):l(n)}))}return!1},submitRentalRequest:function(e){e.preventClose();var t=this;if(this.validateRequestForm()){var n=$(".price.label").data("term")||$(".regular-radio:checked").data("term"),s=this.$el.find("#adminName").val(),i=this.$el.find("#adminEmail").val();e.disableOk("Request Invoice"),function(){var o={adminName:s,adminEmail:i,term:n,learnentityid:t.textM.LearnEntityId,layerid:t.textM.LayerId,quantity:t.quantity};r.RequestRental(o,(function(n){n?(e.close(),new Backbone.BootstrapModal({title:"Rental request sent",content:"Your request for the text '"+t.textM.Title+"' for "+t.quantity+" licenses has been successfully sent to "+i+".",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"OK"}).open((function(){}))):(e.enableOk(),a.bootstrap.alert({alert:"danger",message:alcfg.alertsText.requestFailed,autoClose:!1}))}))}()}return!1},validatePaymentForm:function(){var e=this.$el.find(".payment-errors"),t=[s.LearnEntityPurchaseSource.CATALOG_TILE,s.LearnEntityPurchaseSource.PREVIEW_READER].indexOf(this.source)>-1;if(0===this.quantity)return e.text("Please enter a quantity."),this.$el.find(".txtQuantity").addClass("flash"),!1;if(t&&this.quantity<this.minQuantity)return this.showMinQuantityMessage(),!1;if(this.$el.find(".txtQuantity").removeClass("flash"),!sCH.userM.isSchoolUsingContentCredits()&&!this.isTextToBeMadeFreeDuringCovid&&this.totalToCharge>0){var n=Stripe.card.validateCardNumber(this.$el.find(".cc-number").val()),a=Stripe.card.validateExpiry(this.$el.find(".cc-month").val(),this.$el.find(".cc-year").val()),i=Stripe.card.validateCVC(this.$el.find(".cc-cvc").val()),o=[];if(n?a?i||o.push("Your cvc number is invalid."):o.push("Your expiration date is invalid."):o.push("Your credit card number is invalid."),o.length>0)return e.html(o.join("<br/>")),!1}return!0},validateRequestForm:function(){var e=!0,t=this.$el.find(".payment-errors"),n=[s.LearnEntityPurchaseSource.CATALOG_TILE,s.LearnEntityPurchaseSource.PREVIEW_READER].indexOf(this.source)>-1,i=this.modal.$el.find("#adminName"),o=this.modal.$el.find("#adminEmail");if(0===this.quantity)t.text("Please enter a quantity."),e=!1;else if(n&&this.quantity<this.minQuantity)this.showMinQuantityMessage(),e=!1;else if(!sCH.userM.isSchoolUsingContentCredits()&&this.totalToCharge>0){var r=!(a.checkRequiredFields([i])>0),l=a.checkRequiredEmailField(o),d=[];if(r||d.push("Please enter a valid admin name"),l||d.push("Please enter a valid admin email"),d.length>0)return t.html(d.join("<br/>")),!1}return e}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(34),i=n(39),o=n(14);t.default=function(e){var t=e.contentType,n=e.onChange;return a.createElement(s.SelectValidator,{id:"contentType",label:"Content type",onChange:n,value:t||"",required:!0,fullWidth:!0},o.contentTypes.map((function(e){return a.createElement(i.default,{key:e.value,value:e.value},e.label)})))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(152),d=n(34),c=n(348),u=n(558),p=n(203),h=n(13).withStyles,g=n(87),f={input:function(e){return i(i({},e),{height:30,"& input":{fontFamily:"Avenir Next LT W02 Demi"}})},indicatorsContainer:function(){return{display:"none"}},placeholder:function(e){return i(i({},e),{fontFamily:"AvenirNextLTW02-Medium"})},option:function(e,t){return i(i({},e),{backgroundColor:t.isFocused?"#f5f5f5":"white"})},menu:function(e){return i(i({},e),{top:30,zIndex:2})}},m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suggestions=t.props.suggestions.sort((function(e,t){return g(e.label.toLowerCase().trim(),t.label.toLowerCase().trim())})),t.handleChange=function(e){t.props.onChange(e||[])},t}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.placeholder,n=void 0===t?"":t,a=e.allowFreeTagging,s=e.defaultValues,i=void 0===s?[]:s,o={MultiValue:v,Control:C},l={label:{placeholder:n},InputLabelProps:{htmlFor:"react-select-multiple",shrink:!0}};return a?r.createElement(u.default,{classes:this.props.classes,styles:f,inputId:"react-select-multiple",TextFieldProps:l,components:o,defaultValue:i,placeholder:n,options:this.suggestions,onChange:this.handleChange,openMenuOnClick:!1,isMulti:!0,autoFocus:!0,noOptionsMessage:function(e){var t=e.inputValue;return"No results "+(t.trim().length>0?'matched for "'+t+'"':"")}}):r.createElement(p.default,{styles:f,classes:this.props.classes,TextFieldProps:l,components:o,defaultValue:i,placeholder:n,options:this.suggestions,onChange:this.handleChange,validators:this.props.validators,isMulti:!0,autoFocus:!0,noOptionsMessage:function(e){var t=e.inputValue;return"No results "+(t.trim().length>0?'matched for "'+t+'"':"")}})},t}(r.Component);function v(e){return r.createElement(c.default,{tabIndex:-1,label:e.children,onDelete:e.removeProps.onClick})}function b(e){var t=e.inputRef,n=o(e,["inputRef"]);return r.createElement("div",i({ref:t},n))}function C(e){var t=e.children,n=e.innerProps,a=e.innerRef,s=e.selectProps;return s.validators?r.createElement(d.TextValidator,{fullWidth:!0,name:"react-select-multiple",id:"react-select-multiple",validators:s.validators,label:"",InputProps:{inputComponent:b,inputProps:i({className:s.classes.input,ref:a,children:t},n)}}):r.createElement(l.default,{fullWidth:!0,name:"react-select-multiple",id:"react-select-multiple",InputProps:{inputComponent:b,inputProps:i({className:s.classes.input,ref:a,children:t},n)}})}t.default=h((function(e){return{input:{padding:0,height:"auto","& > div":{padding:0}}}}))(m)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(18),s=n(0),i=(0,n(13).withStyles)((function(e){return{small:{fontSize:16},big:{fontSize:24},divider:{fontSize:20,fontWeight:"bold",margin:"20px 0px 0px",overflow:"hidden",textAlign:"center",color:"#000","&:before":{content:'""',verticalAlign:"top",display:"inline-block",width:"6%",height:".65em",borderBottom:"1px solid #000",margin:"0 2% 0 -55%"},"&:after":{content:'""',verticalAlign:"top",display:"inline-block",width:"6%",height:".65em",borderBottom:"1px solid #000",margin:"0 -55% 0 2%"}}}}));t.default=i((function(e){var t,n=e.classes,i=e.text,o=e.big,r=e.small;return s.createElement("div",{className:a((t={},t[n.divider]=!0,t[n.big]=o,t[n.small]=r,t))},i)}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(13),i=n(8),o=n(5),r=n(347),l=n(65);t.TabList=function(e){return a.createElement("div",{className:"mathDataTabs",role:"tablist"},e.tabsArray.map((function(t){return a.createElement("button",{role:"tab",key:t.id,onClick:function(){return e.onTabChange(t.id)},className:"btn-box toggler btnSwitchReportType "+(e.selectedTab.id===t.id?"selected":"")},t.displayName)})))},t.Card=function(e){var t=e.title,n=e.data,s=d();return a.createElement("div",{className:s.scorecard},a.createElement("div",{className:s.scorecardCaption},t),a.createElement("div",{className:s.scorecardNum},n))},t.StudentDataScoreCards=function(e){var n=e.problemData,s=e.hintsAndVideoData,r=e.stepData,l=e.masteryData,c=d(),u=i.sumBy(n,"numProblemAttempted"),p=i.sumBy(n,"numProblemsCorrectOnFirstAttempt"),h=i.sumBy(r,"numProblemsCompletedWithStepResponses"),g=i.sumBy(s,"numVideoWatched"),f=i.sumBy(s,"numHintsViewed"),m=o.getFormattedTime(i.sumBy(n,"timeSpentInSeconds")+i.sumBy(r,"timeSpentInSeconds"),!1),v=l.filter((function(e){return e.masteryAtCompletions[e.masteryAtCompletions.length-1]>=.9})).length;return a.createElement("div",{className:c.scorecardsContainer},a.createElement(t.Card,{title:"PROBLEMS ATTEMPTED",data:u}),a.createElement(t.Card,{title:"CORRECTLY SOLVED",data:p}),a.createElement(t.Card,{title:"STEP-BY-STEP",data:h}),a.createElement(t.Card,{title:"VIDEOS WATCHED",data:g}),a.createElement(t.Card,{title:"HINTS VIEWED",data:f}),a.createElement(t.Card,{title:"TOTAL TIME SPENT",data:m}),a.createElement(t.Card,{title:"MASTERED STANDARDS",data:v+" of "+l.length}))},t.AssignmentLock=function(e){var t=r.getLockedTooltip(e.LockStartDate,e.LockEndDate,e.UnlockStartDate,e.UnlockEndDate),n=t.isLocked,s=t.tooltip;return s?a.createElement(l.default,{title:a.createElement("span",{dangerouslySetInnerHTML:{__html:s}})},a.createElement("span",{className:"icon-lock "+(n?"isLocked":"")})):null};var d=s.makeStyles({scorecardsContainer:{display:"flex",justifyContent:"flex-start",marginBottom:10,marginTop:30},scorecard:{minWidth:100,border:"solid 1px #e8e8e8",borderLeft:0,borderBottom:0,padding:"15px 15px 10px 10px",textAlign:"right","&:last-child":{borderRight:0}},scorecardCaption:{fontFamily:"Avenir Next LT W02 Demi",color:"#A1A1A1",fontSize:12,textTransform:"uppercase",letterSpacing:"1.7px",paddingLeft:4,paddingRight:3},scorecardNum:{fontFamily:"Avenir Next LT W02 Bold",fontSize:20,marginTop:20}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(263),o=n(447),r=n(438),l=n(324);t.initializeGeneralUpdates=function(){var e=this;if(a.ably())if("student"!==sCH.userM.get("Role")){if(e.unbindGeneralUpdates(),sCH.teacherWorkspaceChannel=a.ably().channels.get("extension_byoc_listen@"+sCH.userM.get("UserId")),sCH.teacherWorkspaceChannel.subscribe("byoc_item_updated",(function(){"my-imports"===Backbone.history.fragment.split("/").pop()&&Backbone.pubEv.trigger("textImported")})),sCH.classesC&&sCH.classesC.length){sCH.classesC.each((function(t){var n=t.get("ClassId");new RegExp("classes/"+n+"/assess");sCH.teacherClassChannel[n]=a.ably().channels.get("teacherclass_listen@"+n),sCH.teacherClassChannel[n].subscribe("assignment_deleted",(function(e){Backbone.notificationHelper.deleteClassNotificationByAssignment(t,e.data)})),sCH.teacherClassChannel[n].subscribe("student_notification_removed",(function(e){Backbone.notificationHelper.updateClassNotificationCountsByAssignment(t,e.data,!1)})),sCH.teacherClassChannel[n].subscribe("student_notification_restored",(function(e){Backbone.notificationHelper.updateClassNotificationCountsByAssignment(t,e.data,!0)})),sCH.teacherClassChannel[n].subscribe("idufwithnote_added",(function(e){Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"Comprehension",!0,e.data)})),sCH.teacherClassChannel[n].subscribe("idufwithnote_removed",(function(e){Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"Comprehension",!1,e.data),Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"FlagResponse",!1,{assignmentId:e.data.assignmentId,tagId:e.data.associatedNoteTagId})})),sCH.teacherClassChannel[n].subscribe("flagwithnote_replied",(function(n){Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"Comprehension",!1,n.data),Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"FlagResponse",!1,{assignmentId:n.data.assignmentId,tagId:n.data.associatedNoteTagId}),sCH.readerConfig&&"grading"==sCH.readerConfig.type&&sCH.readerConfig.assignmentId==n.data.assignmentId&&(e.notificationDelete({deleteByParamName:"TagId",paramId:n.data.associatedNoteTagId}),e.notificationDelete({deleteByParamName:"TagId",paramId:n.data.tagId}))})),sCH.teacherClassChannel[n].subscribe("idufwithstudentresponse",(function(n){Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"FlagResponse",n.data.addNotification,n.data),sCH.readerConfig&&"grading"==sCH.readerConfig.type&&sCH.readerConfig.assignmentId==n.data.assignmentId&&!n.data.addNotification&&e.notificationDelete({deleteByParamName:"TagResponseId",paramId:n.data.tagId})})),sCH.teacherClassChannel[n].subscribe("revision_requested",(function(e){Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"QuestionResponseResetRequest",!0,e.data)})),sCH.teacherClassChannel[n].subscribe("revision_allowed",(function(e){Backbone.notificationHelper.updateClassNotificationCountsByActivity(t,"QuestionResponseResetRequest",!1,e.data)})),sCH.teacherClassChannel[n].subscribe("student_class_joined",(function(t){e.studentJoinedClassListener(t.data)}))}))}}else e.unbindGeneralUpdates()},t.subscribeStudentToClassUpdates=function(e){var t=this;a.ably()&&("student"===sCH.userM.get("Role")&&this.unbindGeneralUpdates(),sCH.studentClassChannel[e]=a.ably().channels.get("studentclass_listen@"+e),sCH.studentClassChannel[e].subscribe("assignment_updated",(function(e){t.assignmentUpdatedForStudent(e.data)})),sCH.studentClassChannel[e].subscribe("settings_updated",(function(e){a.isUserInReader()&&sCH.learnEntityMetaM.get("ClassId")===e.data.classId&&t.assignmentUpdatedReloadPopup()})))},t.unbindGeneralUpdates=function(){a.ably()&&("student"!==sCH.userM.get("Role")?(a.ably().channels.get("extension_byoc_listen@"+sCH.userM.get("UserId")).unsubscribe(),s.each(sCH.teacherClassChannel||{},(function(e,t){isNaN(t)||e.unsubscribe()})),sCH.teacherClassChannel={}):(s.each(sCH.studentClassChannel||{},(function(e,t){isNaN(t)||e.unsubscribe()})),sCH.studentClassChannel={}))},t.initializeReaderUpdates=function(){var e=this;if(a.ably())if("authoring"===sCH.readerConfig.type)sCH.readerConfig.authoringChannel=a.ably().channels.get("authoring_listen@"+sCH.readerConfig.layerId),sCH.readerConfig.authoringChannel.subscribe("directions_updated",(function(t){t.data.userId!==sCH.userM.get("UserId")&&e.updateDirections(t.data)})),sCH.readerConfig.authoringChannel.subscribe("directions_deleted",(function(t){t.data.userId!==sCH.userM.get("UserId")&&e.deleteDirections(t.data)})),sCH.readerConfig.authoringChannel.subscribe("question_added",(function(e){e.data.question.UserId!=sCH.userM.get("UserId")&&(sCH.questionsNumC.addModel(e.data.question),e.data.question.Type="question",e.data.question.TagId=e.data.question.QuestionTagId,delete e.data.question.QuestionTagId,sCH.teacherQuestionsC.add(e.data.question),Backbone.pubEv.trigger("rerenderTags"))})),sCH.readerConfig.authoringChannel.subscribe("question_updated",(function(t){t.data.userId!=sCH.userM.get("UserId")&&(t.data.positionChanged?e.assignmentUpdatedReloadPopup():(sCH.questionsNumC.add(t.data.question,{merge:!0}),t.data.question.Type="question",t.data.question.TagId=t.data.question.QuestionTagId,delete t.data.question.QuestionTagId,sCH.teacherQuestionsC.add(t.data.question,{merge:!0}),Backbone.pubEv.trigger("rerenderTags")))})),sCH.readerConfig.authoringChannel.subscribe("question_deleted",(function(e){if(e.data.userId!=sCH.userM.get("UserId")){sCH.questionsNumC.deleteModel(e.data.question.QuestionTagId),e.data.question.Type="question",e.data.question.TagId=e.data.question.QuestionTagId,delete e.data.question.QuestionTagId;var t=new o.default(e.data.question);sCH.teacherQuestionsC.remove(t),Backbone.pubEv.trigger("rerenderTags")}})),sCH.readerConfig.authoringChannel.subscribe("marker_added",(function(e){e.data.tag.UserId!=sCH.userM.get("UserId")&&(e.data.tag.Type="marker",e.data.tag.TagId=e.data.tag.MarkerTagId,delete e.data.tag.MarkerTagId,sCH.teacherMarkersC.add(e.data.tag),Backbone.pubEv.trigger("rerenderTags"))})),sCH.readerConfig.authoringChannel.subscribe("marker_updated",(function(e){e.data.userId!=sCH.userM.get("UserId")&&(e.data.tag.Type="marker",e.data.tag.TagId=e.data.tag.MarkerTagId,delete e.data.tag.MarkerTagId,sCH.teacherMarkersC.add(e.data.tag,{merge:!0}),Backbone.pubEv.trigger("rerenderTags"))})),sCH.readerConfig.authoringChannel.subscribe("marker_deleted",(function(e){if(e.data.userId!=sCH.userM.get("UserId")){var t=sCH.teacherMarkersC.find({TagId:e.data.tag.MarkerTagId});t&&(sCH.teacherMarkersC.remove(t),Backbone.pubEv.trigger("rerenderTags"))}})),sCH.readerConfig.authoringChannel.subscribe("note_added",(function(e){e.data.note.UserId!=sCH.userM.get("UserId")&&(sCH.teacherNotesC.add(e.data.note),Backbone.pubEv.trigger("rerenderTags"))})),sCH.readerConfig.authoringChannel.subscribe("note_updated",(function(e){e.data.userId!=sCH.userM.get("UserId")&&(sCH.teacherNotesC.add(e.data.note,{merge:!0}),Backbone.pubEv.trigger("rerenderTags"))})),sCH.readerConfig.authoringChannel.subscribe("note_deleted",(function(e){if(e.data.userId!==sCH.userM.get("UserId")){var t=sCH.teacherNotesC.findWhere({TagId:e.data.noteTagId});sCH.teacherNotesC.remove(t),Backbone.pubEv.trigger("rerenderTags")}})),sCH.readerConfig.authoringChannel.subscribe("question_answered",(function(t){e.questionAnsweredListener(t.data)})),sCH.readerConfig.authoringChannel.subscribe("note_category_updated",(function(t){e.noteCategoryUpdated(t.data)})),sCH.readerConfig.authoringChannel.subscribe("assignment_updated",(function(t){t.updatedByUserId!==sCH.userM.get("UserId")&&e.assignmentUpdatedReloadPopup()})),sCH.readerConfig.authoringChannel.subscribe("removed_as_coauthor",(function(t){t.data.userIdRemoved===sCH.userM.get("UserId")&&e.removedAsCoAuthorInReader()})),sCH.readerConfig.authoringChannel.subscribe("text_updated",(function(t){e.textUpdatedListener(t.data)}));else if("grading"===sCH.readerConfig.type||"student"===sCH.readerConfig.type){if(sCH.readerConfig.assignmentChannel=a.ably().channels.get("assignment_listen@"+sCH.readerConfig.assignmentId),sCH.readerConfig.assignmentChannel.subscribe("notification_add@"+sCH.userM.get("UserId"),(function(t){e.notificationAdd(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("notification_update@"+sCH.userM.get("UserId"),(function(t){e.notificationUpdate(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("notification_deleted",(function(t){e.notificationDelete(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("text_updated",(function(t){e.textUpdatedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_do_not_grade",(function(t){e.questionMarkedDoNotGrade(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("note_added",(function(t){e.noteAddedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("note_deleted",(function(t){e.noteDeletedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("note_updated",(function(t){e.noteEditedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("note_reply_updated",(function(t){e.noteReplyUpdatedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_answered",(function(t){e.questionAnsweredListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_graded",(function(t){e.questionGradedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_graded_unanswered",(function(t){e.questionGradedUnansweredListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_graded_bulk",(function(t){e.questionGradedBulkListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_response_updated",(function(t){e.questionResponseEditedListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_ungraded",(function(t){e.responseUngradedListener(t.data)})),"grading"===sCH.readerConfig.type)sCH.readerConfig.assignmentGradingChannel=a.ably().channels.get("assignment_listen_grading@"+sCH.readerConfig.assignmentId),sCH.readerConfig.assignmentGradingChannel.subscribe("readingtime_updated",(function(t){e.readingTimeUpdateListener(t.data)})),sCH.readerConfig.assignmentGradingChannel.subscribe("tts_call",(function(t){e.ttsCall(t.data)})),sCH.readerConfig.assignmentGradingChannel.subscribe("translate_call",(function(t){e.translateCall(t.data)})),sCH.readerConfig.assignmentGradingChannel.subscribe("vocab_lookup",(function(t){e.vocabLookup(t.data)})),sCH.readerConfig.assignmentGradingChannel.subscribe("question_mcq_answered",(function(t){e.questionAnsweredListener(t.data)}));else if("student"===sCH.readerConfig.type){sCH.readerConfig.assignmentChannel.subscribe("assignment_updated",(function(t){t.data||e.assignmentUpdatedReloadPopup()})),sCH.readerConfig.assignmentChannel.subscribe("assignment_lock_updated",(function(t){e.assignmentLockUpdated(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("move_student_here",(function(t){e.redirectStudentsListener(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("directions_updated",(function(t){e.updateDirections(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("directions_deleted",(function(t){e.deleteDirections(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("revision_allowed",(function(t){e.resetRequestedResponses()})),sCH.readerConfig.assignmentChannel.subscribe("graded_revision_restored",(function(t){e.restoreGradedResponsesAwaitingRevision()})),sCH.readerConfig.assignmentChannel.subscribe("question_response_liked",(function(t){e.questionResponseLiked(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("marker_added",(function(t){e.teacherMarkerTagChanged(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("marker_deleted",(function(t){e.teacherMarkerTagChanged(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("marker_updated",(function(t){e.teacherMarkerTagChanged(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("note_category_updated",(function(t){e.noteCategoryUpdated(t.data)})),sCH.readerConfig.assignmentChannel.subscribe("question_updated",(function(t){e.questionModified(t.data)}));var t=sCH.learnEntityMetaM.get("ClassId");sCH.studentClassChannel&&!sCH.studentClassChannel[t]&&this.subscribeStudentToClassUpdates(t)}}else"studentresearch"===sCH.readerConfig.type&&(sCH.readerConfig.researchChannel=a.ably().channels.get("research_listen@"+sCH.readerConfig.studentLayerId),sCH.readerConfig.researchChannel.subscribe("note_added",(function(t){e.noteAddedListener(t.data)})),sCH.readerConfig.researchChannel.subscribe("note_deleted",(function(t){e.noteDeletedListener(t.data)})),sCH.readerConfig.researchChannel.subscribe("note_updated",(function(t){e.noteEditedListener(t.data)})),sCH.readerConfig.researchChannel.subscribe("note_reply_updated",(function(t){e.noteReplyUpdatedListener(t.data)})),sCH.readerConfig.researchChannel.subscribe("note_category_updated",(function(t){e.noteCategoryUpdated(t.data)})))},t.unbindReaderUpdates=function(){a.ably()&&(sCH.readerConfig.assignmentChannel?(sCH.readerConfig.assignmentChannel.unsubscribe(),sCH.readerConfig.assignmentChannel.unsubscribe(),sCH.readerConfig.assignmentGradingChannel&&sCH.readerConfig.assignmentGradingChannel.unsubscribe()):sCH.readerConfig.authoringChannel?sCH.readerConfig.authoringChannel.unsubscribe():sCH.readerConfig.researchChannel&&sCH.readerConfig.researchChannel.unsubscribe())},t.assignmentUpdatedForStudent=function(e){if(sCH.classesC&&sCH.classesC.length>0){var t=sCH.classesC.find({ClassId:e.classId});if("add"===e.action)s.each(e.assignments,(function(e){s.find(t.get("Assignments"),{AssignmentId:e.AssignmentId})||t.get("Assignments").unshift(e)}));else if("delete"===e.action){var n=s.filter(t.get("Assignments"),(function(t){return-1===$.inArray(t.AssignmentId,e.assignmentIds)}));t.set("Assignments",n)}else if("assigneeUpdated"===e.action){var a=[];s.each(e.newAssigneeList,(function(e){a.push({UserId:e})}));for(var i=0,o=e.assignmentIds;i<o.length;i++){var r=o[i];(l=s.find(t.get("Assignments"),{AssignmentId:r}))&&(l.Assignees=a),sCH.readerConfig&&parseInt(sCH.readerConfig.assignmentId)===r&&this.assignmentAssignedListener(a)}}else if("lockUpdated"===e.action){var l=s.find(t.get("Assignments"),{AssignmentId:e.assignmentId}),d=-1===(e.uncheckedStudentIds?e.uncheckedStudentIds.split(",").map((function(e){return parseInt(e)})):[]).indexOf(sCH.userM.get("UserId"));l&&(l.LockStartDate=d?e.lockStartDate:null,l.LockEndDate=d?e.lockEndDate:null,l.UnlockEndDate=d?e.unLockEndDate:null,l.UnlockStartDate=d?e.unlockStartDate:null)}Backbone.pubEv.trigger("refreshStudentClassAssignments",e.classId)}},t.classDetailsUpdated=function(e){var t=sCH.classesC.find({ClassId:e.ClassId});t&&(e.IsDeleted?(sCH.classesC.getModelByClassId(e.ClassId).destroy(),sCH.classesC.length&&window.location.hash.includes("student/classes/"+e.ClassId)?a.redirectUserByHash(a.getClassUrl(sCH.classesC.first().get("ClassId"),"assignments")):new Backbone.BootstrapModal({title:a.getProductName()+" needs to reload",content:"Your teacher has updated the classes. Your page will now reload.",cssClass:"modal-al-reload",allowCancel:!1,cancelText:!1}).open((function(){window.location.reload(!0)}))):t.set(e))},t.rerenderNotesHelper=function(e){void 0===e&&(e=null),sCH.readerConfig.activeFullNote||sCH.readerConfig.activeAddNote||Backbone.pubEv.trigger("rerenderNotes",!0)},t.notificationAdd=function(e){e.notification.SenderUserFullName=e.SenderUserFullName,e.notification.SenderUserImageUrl=e.SenderUserImageUrl,Backbone.notificationHelper.notifications.push(e.notification),Backbone.notificationHelper.updateNotificationButton()},t.notificationDelete=function(e){s.find(Backbone.notificationHelper.notifications,(function(t,n){if(!(t[e.deleteByParamName]!==e.paramId||e.activity&&e.activity!==t.Activity||e.triggeredEvent&&e.triggeredEvent===t.Activity))return Backbone.notificationHelper.notifications.splice(n,1),!0})),Backbone.notificationHelper.updateNotificationButton()},t.notificationUpdate=function(e){s.find(Backbone.notificationHelper.notifications,(function(t,n){if(t.NotificationId===e.notification.NotificationId)return t.AdditionalInfo=e.notification.AdditionalInfo,t.IsClicked=e.notification.IsClicked,!0})),Backbone.notificationHelper.updateNotificationButton()},t.studentJoinedClassListener=function(e){sCH.readerConfig&&sCH.readerConfig.assignmentId&&sCH.studentsC&&-1!==e.assignmentIds.indexOf(parseInt(sCH.readerConfig.assignmentId))&&!sCH.studentsC.findWhere({UserId:e.studentInfo.UserId})&&(sCH.studentsC.add(e.studentInfo),Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"studentJoined"}),Backbone.pubEv.trigger("gradingPanelNeedsRefresh"))},t.noteAddedListener=function(e){var n;if(sCH.userM.isPLAssignment()){var a=s.map(sCH.userM.get("SchoolInfo"),"SchoolId");if(!(s.intersection(a,e.schoolIds).length>0))return}if("student"!==sCH.readerConfig.type||c(e.note.UserId)){if(e.markerAssociatedNote&&e.note.UserId===window.ActivelyRead.currentUserId||e.note.UserId!=window.ActivelyRead.currentUserId&&("student"!==sCH.readerConfig.type||e.note.IsPublic||!e.note.AssignmentId)&&sCH.readerTagsForSectionLoaded(e.note.TextSectionId,"note"))if(e.note.AssignmentId||e.note.StudentLayerId)n=new i.default(e.note),"grading"===sCH.readerConfig.type?sCH.studentNotesC.add(n):e.note.IsPublic?sCH.allStudentTagsC.add(n):e.markerAssociatedNote&&(n.set("CreatedByCurrentUser",!0),sCH.studentNotesC.add(n)),e.note.TextSectionId===sCH.readerConfig.currentSectionId&&(-1===parseInt(sCH.readerConfig.selectedStudentUserId)&&e.note.IsPublic||parseInt(sCH.readerConfig.selectedStudentUserId)===e.note.UserId)&&t.rerenderNotesHelper();else{if("student"===sCH.readerConfig.type&&e.note.IsExtraHelp&&!sCH.readerConfig.isStudentStruggling)return;if(o=s.find(sCH.learnEntityMetaM.get("Teachers"),{UserName:e.note.Username}))e.note.Username=o.UserName,e.note.ImageUrl=o.ImageUrl;else{var o=s.find(sCH.learnEntityMetaM.get("Teachers"),{IsClassOwner:1});e.note.Username=o.UserId==sCH.userM.get("UserId")?"Me":o.UserName,e.note.ImageUrl=o.ImageUrl}n=new i.default(e.note),sCH.teacherNotesC.add(n),e.note.TextSectionId===sCH.readerConfig.currentSectionId&&t.rerenderNotesHelper()}"grading"===sCH.readerConfig.type&&(Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"noteAdded",textSectionId:e.note.TextSectionId}),Backbone.pubEv.trigger("rerenderStudentNoteCounts"))}},t.noteDeletedListener=function(e){if((e.deletedByUserId!=window.ActivelyRead.currentUserId||e.isMarkerTagDeleted)&&sCH.readerTagsForSectionLoaded(e.textSectionId,"note"))if(e.assignmentId||e.studentLayerId){if(sCH.readerConfig.activeFullNote&&sCH.readerConfig.activeFullNote.model.get("TagId")===e.noteTagId&&sCH.readerConfig.activeFullNote.hide(),"student"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type)if(e.isMarkerTagDeleted){var n=sCH.studentNotesC.find({TagId:e.noteTagId});sCH.studentNotesC.remove(n)}else{(n=sCH.allStudentTagsC.find({TagId:e.noteTagId}))?sCH.allStudentTagsC.remove(n):(n=sCH.studentNotesC.find({TagId:e.noteTagId}),sCH.studentNotesC.remove(n))}else if(n=sCH.studentNotesC.find({TagId:e.noteTagId})){if(n.get("IsAssociatedNote")){var a=sCH.studentFlagsC.find({AssociatedNoteTagId:n.get("TagId")});if(a){a.set("AssociatedNoteTagId",null);var s=$('.flagTag[data-tagid="'+a.get("TagId")+'"]'),i=$(".flagTagContainer[data-top='"+(s.position().top+9)+"']");""===i.find(".count").html()?i.removeClass("withComment hasReply"):(i.find('.dropdown-menu li[data-tagid="'+n.get("TagId")+'"]').removeClass("gotoFlagNote"),0===i.find("li.gotoFlagNote").length&&i.removeClass("withComment hasReply"))}}sCH.studentNotesC.remove(n)}e.textSectionId!==sCH.readerConfig.currentSectionId||-1!==parseInt(sCH.readerConfig.selectedStudentUserId)&&parseInt(sCH.readerConfig.selectedStudentUserId)!==e.userId||t.rerenderNotesHelper()}else{n=sCH.teacherNotesC.findWhere({TagId:e.noteTagId});sCH.teacherNotesC.remove(n),e.textSectionId===sCH.readerConfig.currentSectionId&&t.rerenderNotesHelper()}"grading"===sCH.readerConfig.type&&(Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"noteDeleted",textSectionId:e.textSectionId}),Backbone.pubEv.trigger("rerenderStudentNoteCounts"))},t.noteEditedListener=function(e){if(e.note.UserId!=window.ActivelyRead.currentUserId&&sCH.readerTagsForSectionLoaded(e.note.TextSectionId,"note"))if(e.note.AssignmentId||e.note.StudentLayerId){var n="student"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type?sCH.allStudentTagsC:sCH.studentNotesC,a=n.filter({TagId:e.note.TagId})[0];if(e.note.IsAssociatedNote&&a)a.set({Text:e.note.Text,HTML:e.note.HTML?e.note.HTML:"",Color:e.note.Color,Category:e.note.Category,IsPublic:e.note.IsPublic,UpdateDate:e.note.UpdateDate});else if(e.note.IsPublic&&!a){var s=new i.default(e.note);n.add(s)}else if(!e.note.IsPublic&&a&&"grading"!==sCH.readerConfig.type)n.remove(a);else if(a){var o="grading"===sCH.readerConfig.type&&a.get("IsPublic")!==e.note.IsPublic;a.set({Text:e.note.Text,HTML:e.note.HTML?e.note.HTML:"",Color:e.note.Color,Category:e.note.Category,IsPublic:e.note.IsPublic,UpdateDate:e.note.UpdateDate}),o&&Backbone.pubEv.trigger("rerenderStudentNoteCounts")}e.note.TextSectionId!==sCH.readerConfig.currentSectionId||-1!==parseInt(sCH.readerConfig.selectedStudentUserId)&&parseInt(sCH.readerConfig.selectedStudentUserId)!==e.note.UserId||t.rerenderNotesHelper()}else{if((a=sCH.teacherNotesC.filter({TagId:e.note.TagId})).length)e.note.IsExtraHelp&&!sCH.readerConfig.isStudentStruggling?(sCH.teacherNotesC.remove(a),t.rerenderNotesHelper()):(a[0].set({Text:e.note.Text,HTML:e.note.HTML?e.note.HTML:"",Color:e.note.Color,Category:e.note.Category}),e.note.TextSectionId===sCH.readerConfig.currentSectionId&&Backbone.pubEv.trigger("updateMargin"));else{s=new i.default(e.note);sCH.teacherNotesC.add(s),t.rerenderNotesHelper()}}},t.noteReplyUpdatedListener=function(e){if(("student"!==sCH.readerConfig.type||c(e.ReplyUserId))&&sCH.readerTagsForSectionLoaded(e.TextSectionId,"note")){var t=sCH.allStudentTagsC.find({TagId:e.NoteTagId})||sCH.studentNotesC.find({TagId:e.NoteTagId})||sCH.teacherNotesC.find({TagId:e.NoteTagId});if(t)if(t.get("IsAssociatedNote")){var n=sCH.studentFlagsC.filter({AssociatedNoteTagId:t.get("TagId")});if(n.length>0){var a=$('.flagTagContainer[data-tagid="'+n[0].get("TagId")+'"]');a.addClass("withComment").removeClass("hasReply"),sCH.userM.get("UserId")===e.ReplyUserId&&a.addClass("hasReply")}}else{var i="add"==e.Action?1:-1,o=t.get("ReplyCount"),r=t.get("ReplyUserIds");if(t.set("ReplyCount",(o||0)+i),sCH.initReplyDataForStudent(),"add"===e.Action)r=(r?r+",":"")+e.ReplyUserId,e.ReplyUserId in sCH.replyDataByStudent&&sCH.replyDataByStudent[e.ReplyUserId].push({Id:e.NoteTagId,Title:e.Text});else if("delete"===e.Action&&r){var l=r.split(","),d=$.inArray(e.ReplyUserId.toString(),l);if(d>-1&&l.splice(d,1),r=l.join(","),e.ReplyUserId in sCH.replyDataByStudent){var u=s.reject(sCH.replyDataByStudent[e.ReplyUserId],(function(t){return t.Id===e.NoteTagId&&t.Title===e.DeletedReplyText}));sCH.replyDataByStudent[e.ReplyUserId]=u}}t.set("ReplyUserIds",r),"grading"===sCH.readerConfig.type&&(Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"noteReplied",textSectionId:e.TextSectionId}),Backbone.pubEv.trigger("rerenderStudentNoteCounts"))}}},t.assignmentUpdatedReloadPopup=function(e){var t=!1,n=$(".popupNoteMenu.addNote").is(":visible"),a=e||("student"===sCH.readerConfig.type?"Your teacher has updated this assignment. Your page will now reload.":"This assignment has been updated by a co-author. Your page will now reload.");$('.questionTagAnswer:not(:hidden) [contenteditable][placeholder="Click to answer"]').each((function(){""!==$.trim($(this).val())&&($(this).closest(".questionTagAnswer").find(".btnSaveDraft").click(),a="Your teacher has updated this assignment. The response you are working on will be saved automatically. Your page will now reload.")})),$(".popupNoteMenu.fullNote .noteReplyText[contenteditable]").each((function(){""!==$.trim($(this).val())&&(t=!0)})),r.trackReaderClose(),n||t?Backbone.pubEv.once("queuedPopupNoteEvents",(function(){new Backbone.BootstrapModal({title:"Actively Learn needs to reload",content:a,cssClass:"modal-al-reload",allowCancel:!1,cancelText:!1}).open((function(){window.location.reload(!0)}))})):new Backbone.BootstrapModal({title:"Actively Learn needs to reload",content:a,cssClass:"modal-al-reload",allowCancel:!1,cancelText:!1}).open((function(){window.location.reload(!0)}))},t.textUpdatedListener=function(e){sCH.userM.get("UserId")!==e.userId&&t.assignmentUpdatedReloadPopup("This assignment has been updated. Your page will now reload.")},t.assignmentAssignedListener=function(e){e.includes(sCH.userM.get("UserId"))||new Backbone.BootstrapModal({title:"You do not have access to this assignment.",content:"We will take you back to your classes.",cssClass:"modal-al-reload",allowCancel:!1,cancelText:!1}).open((function(){window.location.hash=sCH.lastAccessedPreReaderUrl||a.getReaderExitUrl(),sCH.lastAccessedPreReaderUrl=null}))},t.questionAnsweredListener=function(e){if(e.response.UserId!=window.ActivelyRead.currentUserId&&sCH.readerTagsForSectionLoaded(e.response.TextSectionId,"question"))if("authoring"===sCH.readerConfig.type){var t=sCH.teacherQuestionsC.find({TagId:e.response.QuestionTagId});t&&t.set("ReplyCount",(t.get("ReplyCount")?t.get("ReplyCount"):0)+1)}else{if(sCH.userM.isPLAssignment()){var n=s.map(sCH.userM.get("SchoolInfo"),"SchoolId");if(!(s.intersection(n,e.schoolIds).length>0))return}if("student"===sCH.readerConfig.type&&!c(e.response.UserId))return;sCH.questionTagResponsesC.add({CreatedByCurrentUser:!1,QuestionTagResponseId:e.response.QuestionTagResponseId,QuestionTagId:e.response.QuestionTagId,Text:e.response.Text,ImageUrl:e.response.ImageUrl,IsDeleted:e.response.IsDeleted,FirstName:e.response.FirstName,LastName:e.response.LastName,UserId:e.response.UserId,CreateDate:e.response.CreateDate,Grade:e.response.Grade,TeacherComment:e.response.TeacherComment,GradeDate:e.response.GradeDate,IsReset:!1})}if("grading"===sCH.readerConfig.type&&3!==e.response.QuestionSubType){var a=sCH.questionsNumC.find({QuestionTagId:e.response.QuestionTagId});if(a&&a.get("IsDoNotGrade"))return;Backbone.pubEv.trigger("updateRefreshState",{questionTagId:e.response.QuestionTagId,userId:e.response.UserId}),sCH.readerConfig.isAssessment||(sCH.updateUngradedList({questionTagId:e.response.QuestionTagId,questionTagResponseId:e.response.QuestionTagResponseId,userId:e.response.UserId,action:"add",updateTotals:!0,alreadyGraded:null!==e.response.Grade&&void 0!==e.response.Grade}),Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"questionAnswered",textSectionId:e.response.TextSectionId}))}},t.realignScrollForQuestionIfNeeded=function(e,t){if(Math.abs(a.scrollElement().scrollTop())>0){var n=$('.questionTagViewMode[data-tagid="'+t+'"]').closest(".teacherQuestion");if(void 0!==t&&null!=t&&n.length>0&&n.offset().top<0){var s=e.pageScrollTop+(n.height()-e.questionBoxHeight);a.scrollElement().scrollTop(s)}}};var d=function(e){return{pageScrollTop:Math.abs(a.scrollElement().scrollTop()),questionBoxHeight:$(".questionTagViewMode[data-tagid="+e+"]").closest(".teacherQuestion").height()}};t.questionGradedListener=function(e){if(sCH.readerTagsForSectionLoaded(e.textSectionId,"question")){var t=d(e.questionTagId),n=sCH.questionTagResponsesC.find({QuestionTagId:e.questionTagId,UserId:e.userId});if(n){var s=e.teacherComment&&a.sanitize(n.get("TeacherComment"))!==a.sanitize(e.teacherComment);n.set({Grade:e.grade,GradeDate:e.gradeDate,TeacherComment:e.teacherComment,Text:e.text,TeacherImageUrl:void 0!==e.imageUrl?e.imageUrl:null,TeacherName:void 0!==e.teacherName?e.teacherName:null,IsDraft:!1}),this.realignScrollForQuestionIfNeeded(t,n.get("QuestionTagId")),"grading"!==sCH.readerConfig.type||e.teacherUserId===window.ActivelyRead.currentUserId||sCH.readerConfig.isAssessment||(sCH.updateUngradedList({questionTagId:n.get("QuestionTagId"),questionTagResponseId:n.get("QuestionTagResponseId"),userId:n.get("UserId"),action:null===e.grade?"add":"remove"}),$('ul.grades[data-id="'+n.get("QuestionTagResponseId")+'"] li').removeClass("selected"),$('ul.grades[data-id="'+n.get("QuestionTagResponseId")+'"] li[data-grade="'+e.grade+'"]').addClass("selected"),$('[contenteditable][data-id="'+n.get("QuestionTagResponseId")+'"]').removeClass("medium-editor-placeholder").html(e.teacherComment)),"student"===sCH.readerConfig.type&&e.userId===window.ActivelyRead.currentUserId&&s&&sCH.readerConfig.Settings.Notifications&&a.bootstrap.alert({message:"Your teacher has left you a comment. See your notifications."})}}if(e.userId===window.ActivelyRead.currentUserId){var i=sCH.questionsNumC.filter({QuestionTagId:e.questionTagId})[0];i.set("IsGated",!1),i.set("AnsweredByCurrentUser",!0)}},t.questionGradedUnansweredListener=function(e){if("student"===sCH.readerConfig.type&&sCH.readerTagsForSectionLoaded(e.TextSectionId,"question")||"grading"===sCH.readerConfig.type){var t=d(e.QuestionTagId),n=sCH.questionTagResponsesC.find({QuestionTagResponseId:e.QuestionTagResponseId,UserId:e.UserId});n?n.set({Grade:e.Grade,GradeDate:e.GradeDate,TeacherComment:e.TeacherComment,TeacherImageUrl:e.TeacherImageUrl,IsDraft:e.IsDraft,IsDeleted:e.IsDeleted,IsReset:e.IsReset,Text:e.Text}):sCH.questionTagResponsesC.add({CreatedByCurrentUser:e.UserId===window.ActivelyRead.currentUserId,QuestionTagResponseId:e.QuestionTagResponseId,QuestionTagId:e.QuestionTagId,Text:e.Text,IsDeleted:e.IsDeleted,FirstName:e.FirstName,LastName:e.LastName,UserId:e.UserId,ImageUrl:e.ImageUrl,CreateDate:e.CreateDate,Grade:e.Grade,TeacherComment:e.TeacherComment,GradeDate:e.GradeDate,TeacherImageUrl:e.TeacherImageUrl,TeacherName:e.TeacherName,IsReset:e.IsReset,IsDraft:e.IsDraft},{at:0}),"student"===sCH.readerConfig.type?this.realignScrollForQuestionIfNeeded(t,e.QuestionTagId):(sCH.updateGradingResponseTotals({questionTagId:e.QuestionTagId,questionTagResponseId:e.QuestionTagResponseId,userId:e.UserId,action:"add"}),Backbone.pubEv.trigger("gradingUpdateNoResponseId",{questionTagId:e.QuestionTagId,questionTagResponseId:e.QuestionTagResponseId,userId:e.UserId}))}if("student"===sCH.readerConfig.type){var a=sCH.questionsNumC.filter({QuestionTagId:e.QuestionTagId})[0];a.set("IsGated",!0===e.IsDraft),a.set("AnsweredByCurrentUser",!e.IsReset)}},t.questionGradedBulkListener=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if("student"===sCH.readerConfig.type&&sCH.readerTagsForSectionLoaded(a.TextSectionId,"question")||"grading"===sCH.readerConfig.type){var s=d(a.QuestionTagId),i=sCH.questionTagResponsesC.find({QuestionTagResponseId:a.QuestionTagResponseId,UserId:a.UserId});i?i.set({Grade:a.Grade,GradeDate:a.GradeDate,TeacherComment:a.TeacherComment,TeacherImageUrl:a.TeacherImageUrl,IsDraft:a.IsDraft,IsDeleted:a.IsDeleted,IsReset:a.IsReset,Text:a.Text}):sCH.questionTagResponsesC.add({CreatedByCurrentUser:a.UserId===window.ActivelyRead.currentUserId,QuestionTagResponseId:a.QuestionTagResponseId,QuestionTagId:a.QuestionTagId,Text:a.Text,IsDeleted:a.IsDeleted,FirstName:a.FirstName,LastName:a.LastName,UserId:a.UserId,ImageUrl:a.ImageUrl,CreateDate:a.CreateDate,Grade:a.Grade,TeacherComment:a.TeacherComment,GradeDate:a.GradeDate,TeacherImageUrl:a.TeacherImageUrl,TeacherName:a.TeacherName,IsReset:a.IsReset,IsDraft:a.IsDraft},{at:0}),"student"===sCH.readerConfig.type?this.realignScrollForQuestionIfNeeded(s,a.QuestionTagId):(sCH.updateGradingResponseTotals({questionTagId:a.QuestionTagId,questionTagResponseId:a.QuestionTagResponseId,userId:a.UserId,action:"add"}),Backbone.pubEv.trigger("gradingUpdateNoResponseId",{questionTagId:a.QuestionTagId,questionTagResponseId:a.QuestionTagResponseId,userId:a.UserId}))}if("student"===sCH.readerConfig.type){var o=sCH.questionsNumC.filter({QuestionTagId:a.QuestionTagId})[0];o.set("IsGated",!0===a.IsDraft),o.set("AnsweredByCurrentUser",!a.IsReset)}}},t.responseUngradedListener=function(e){if(e.userId===window.ActivelyRead.currentUserId||"grading"===sCH.readerConfig.type){var t=sCH.questionTagResponsesC.filter({QuestionTagId:e.questionTagId,UserId:e.userId});t.length>0&&("No response"===t[0].get("Text",!0)?t[0].destroy():t[0].set({Grade:null,GradeDate:null}))}},t.questionResponseEditedListener=function(e){if(sCH.readerTagsForSectionLoaded(e.TextSectionId,"question")){var t=sCH.questionTagResponsesC.find({QuestionTagResponseId:e.QuestionTagResponseId}),n=d(t.get("QuestionTagId"));t&&(e.IsDraft&&t.get("UserId")!==window.ActivelyRead.currentUserId?t.destroy():e.IsReset?t.get("UserId")===window.ActivelyRead.currentUserId?(t.set("IsReset",e.IsReset),this.realignScrollForQuestionIfNeeded(n,t.get("QuestionTagId")),!e.IsStudentReset&&sCH.readerConfig.Settings.Notifications&&a.bootstrap.alert({message:"Your teacher wants you to revise a response. See your notifications."})):t.destroy():"grading"===sCH.readerConfig.type&&t.set("IsStudentRequestReset",e.IsStudentRequestReset),"grading"!==sCH.readerConfig.type||e.IsReset&&e.TeacherUserId===window.ActivelyRead.currentUserId&&!e.IsStudentReset||Backbone.pubEv.trigger("updateRefreshState",{questionTagId:t.get("QuestionTagId"),userId:t.get("UserId")}))}"grading"!==sCH.readerConfig.type||sCH.readerConfig.isAssessment||(e.IsStudentRequestReset?sCH.updateResetRequestList({userId:e.UserId,questionTagResponseId:e.QuestionTagResponseId,action:"add"}):sCH.updateUngradedList({questionTagId:e.QuestionTagId,questionTagResponseId:e.QuestionTagResponseId,userId:e.UserId,action:"remove",updateTotals:!0}),Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"questionAnswerDeleted",textSectionId:e.TextSectionId}))},t.resetRequestedResponses=function(){var e=sCH.questionTagResponsesC.filter({IsStudentRequestReset:!0});s.each(e,(function(e){e.get("UserId")===window.ActivelyRead.currentUserId?(e.set("IsReset",!0),e.set("IsStudentRequestReset",!1),sCH.readerConfig.Settings.Notifications&&a.bootstrap.alert({message:"You can now revise some answers. See your notifications."})):e.destroy()}))},t.restoreGradedResponsesAwaitingRevision=function(){var e=sCH.questionTagResponsesC.filter((function(e){return!0===e.get("IsReset")&&null!==e.get("Grade")&&e.get("UserId")===window.ActivelyRead.currentUserId}));s.each(e,(function(e){e.set("IsReset",!1),e.set("IsStudentRequestReset",!1)}))},t.unResetResponse=function(e){if(e.UserId===window.ActivelyRead.currentUserId&&sCH.readerTagsForSectionLoaded(e.TextSectionId,"question")){var t=sCH.questionTagResponsesC.find({QuestionTagResponseId:e.QuestionTagResponseId});t&&t.set({IsReset:!1,IsStudentRequestReset:!1})}},t.questionResponseLiked=function(e){if(e.ResponseUserId===window.ActivelyRead.currentUserId){var t=sCH.questionTagResponsesC.find({QuestionTagResponseId:e.QuestionTagResponseId});if(t){var n=t.get("VoteData");n?(n.UpVotes++,sCH.questionTagResponsesC.trigger("change",t)):(n={UpVotes:1},t.set({VoteData:n}))}}},t.teacherMarkerTagChanged=function(e){if(sCH.readerTagsForSectionLoaded(e.tag.TextSectionId,"question"))if(e.tag.TextSectionId===sCH.readerConfig.currentSectionId)this.assignmentUpdatedReloadPopup();else switch(e.action){case"edit":(t=sCH.teacherMarkersC.find({TagId:e.tag.MarkerTagId}))&&sCH.teacherMarkersC.remove(t),e.tag.Type="marker",e.tag.TagId=e.tag.MarkerTagId,delete e.tag.MarkerTagId,sCH.teacherMarkersC.add(e.tag);break;case"add":e.tag.Type="marker",e.tag.TagId=e.tag.MarkerTagId,delete e.tag.MarkerTagId,sCH.teacherMarkersC.add(e.tag);break;case"delete":var t;(t=sCH.teacherMarkersC.find({TagId:e.tag.MarkerTagId}))&&sCH.teacherMarkersC.remove(t)}},t.assignmentLockUpdated=function(e){var t=moment.utc(e.currentDate),n=e.uncheckedStudentIds.split(",");if(-1===$.inArray(window.ActivelyRead.currentUserId.toString(),n)){if(0===moment.utc(sCH.learnEntityMetaM.get("LockStartDate")).diff(e.lockStartDate)&&0===moment.utc(sCH.learnEntityMetaM.get("LockEndDate")).diff(e.lockEndDate)&&0===moment.utc(sCH.learnEntityMetaM.get("UnlockStartDate")).diff(e.unlockStartDate)&&0===moment.utc(sCH.learnEntityMetaM.get("UnlockEndDate")).diff(e.unlockEndDate))return;sCH.learnEntityMetaM.set("CurrentDate",t),sCH.learnEntityMetaM.set("LockStartDate",e.lockStartDate),sCH.learnEntityMetaM.set("LockEndDate",e.lockEndDate),sCH.learnEntityMetaM.set("UnlockStartDate",e.unlockStartDate),sCH.learnEntityMetaM.set("UnlockEndDate",e.unlockEndDate);var a=s.find(sCH.classesC.find({ClassId:sCH.learnEntityMetaM.get("ClassId")}).get("Assignments"),{AssignmentId:parseInt(sCH.readerConfig.assignmentId)});a&&(a.LockStartDate=e.lockStartDate,a.LockEndDate=e.lockEndDate,a.UnlockStartDate=e.unlockStartDate,a.UnlockEndDate=e.unlockEndDate)}else sCH.learnEntityMetaM.set("LockStartDate",null),sCH.learnEntityMetaM.set("LockEndDate",null),sCH.learnEntityMetaM.set("UnlockStartDate",null),sCH.learnEntityMetaM.set("UnlockEndDate",null);Backbone.pubEv.trigger("configureAssignmentLock")},t.readingTimeUpdateListener=function(e){Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"readingTimeUpdated",textSectionId:e.textSectionId})},t.redirectStudentsListener=function(e){var t=e.textSectionId,n={startIndex:e.startIndex,endIndex:e.endIndex},a=n.endIndex-n.startIndex;new Backbone.BootstrapModal({title:"Teacher redirect",content:'Your teacher is moving your class to a different part of the text!      <p class="info">Note: If you are in the middle of writing a note or answering a question, it will be saved.</p>',allowCancel:!1,cancelText:!1}).open((function(){Backbone.pubEv.trigger("draftUnsavedResponses");var e=$(".popupNoteMenu.addNote");e.length>0&&(""===e.find("[contenteditable]").text().trim()&&""===e.find(".txtMedia").val().trim()?(e.find("[contenteditable]").html(""),e.find(".txtMedia").val(""),e.find(".btnClose").click()):e.find(".btnSaveNote").click());Backbone.pubEv.trigger("skipToTag",{sectionId:t,searchOffset:n,searchContext:{length:a<3?3:a,ignoreGating:!0}})}))},t.questionMarkedDoNotGrade=function(e){if(sCH.questionsNumC.find({QuestionTagId:e.questionTagId}).set("IsDoNotGrade",e.isDoNotGrade),sCH.readerConfig.currentSectionId===e.textSectionId){var t=$('.textSectionContainer .questionTagViewMode[data-tagid="'+e.questionTagId+'"]').closest(".teacherQuestion");if(e.isDoNotGrade)if("student"===sCH.readerConfig.type){var n=sCH.questionTagResponsesC.find({QuestionTagId:e.questionTagId,UserId:sCH.userM.get("UserId")});n&&n.get("Grade")?n.set("Grade",null):t.addClass("doNotGrade")}else t.addClass("doNotGrade");else t.removeClass("doNotGrade")}"grading"===sCH.readerConfig.type&&Backbone.pubEv.trigger("updateRefreshState",{questionTagId:e.questionTagId,userId:-1,forceRefresh:!0})},t.noteCategoryUpdated=function(e){if(!e.isStudentCustomCategory||e.assignmentId&&e.assignmentId===parseInt(sCH.readerConfig.assignmentId)&&e.userId===sCH.userM.get("UserId")){var t=s.find(sCH.readerConfig.tagConfig,{Color:e.color});t?(t.Category=e.category||t.Category,t.IsDeleted=e.isDeleted):sCH.readerConfig.tagConfig.push({Color:e.color,Category:e.category,IsDeleted:e.isDeleted})}var n={Color:e.color};e.isStudentCustomCategory&&(n.UserId=e.userId);var a=sCH.teacherNotesC.filter(n).concat(sCH.studentNotesC.filter(n)).concat(sCH.allStudentTagsC.filter(n));if(a.length>0){s.each(a,(function(t){e.isDeleted?(t.set("Category",null),t.set("Color",null)):t.set("Category",e.category)}));var i=sCH.readerConfig.activeAddNote,o=i?i.obj:null,r=void 0,d=void 0,c=void 0,u=void 0;i&&(d=$(".addNote .noteText").html(),c=$(".addNote #chkExtraHelpNote").prop("checked"),u=this.$el.find(".txtMedia").val(),i.hide(),o.edit&&(r=o.model.get("TagId"),Backbone.pubEv.trigger("popupAddTagHide"),Backbone.pubEv.trigger("queuedPopupNoteEvents"))),Backbone.pubEv.trigger("rerenderNotes",!0),i&&(o.edit?($('.notesTag[data-tagid="'+r+'"]').click(),$(".noteDropdown .btnEdit").click(),e.color&&$('.categoriesDropdown li a[data-color="'+e.color+'"]').click()):(new l.default(o).render(),$('.notesTag[data-tagid="0"]').addClass("inTextSearchResult notereference"),e.color&&$('.categoriesDropdown li a[data-color="'+e.color+'"]').click()),$(".addNote .noteText").html(d),$(".addNote #chkExtraHelpNote").prop("checked",c),d&&$(".addNote .shareNoteContainer").removeClass("disabled"),u&&($(".addNote .btnToggleMedia").click(),$(".addNote .txtMedia").val(u)))}},t.removedAsCoAuthorInReader=function(){new Backbone.BootstrapModal({title:"You do not have access to this assignment.",content:"We'll take you back to the Catalog.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"OK"}).open((function(){window.location.hash="#teacher/catalog"}))},t.deleteDirections=function(e){sCH.readerConfig.directions&&(s.remove(sCH.readerConfig.directions,{TextSectionId:e.TextSectionId}),Backbone.pubEv.trigger("updateDirections"))},t.updateDirections=function(e){sCH.readerConfig.directions=sCH.readerConfig.directions||[];var t=s.find(sCH.readerConfig.directions,{TextSectionId:e.TextSectionId});t?t.DirectionsJson=e.DirectionsJson:sCH.readerConfig.directions.push(e),Backbone.pubEv.trigger("updateDirections")},t.questionModified=function(e){if(e.question.TextSectionId===sCH.readerConfig.currentSectionId)this.assignmentUpdatedReloadPopup();else switch(e.action){case"add":e.question.IsGated=sCH.readerConfig.Settings.QuestionGates,sCH.questionsNumC.addModel({QuestionTagId:e.question.QuestionTagId,TextSectionId:e.question.TextSectionId,StartIndex:e.question.StartIndex,EndIndex:e.question.EndIndex,QuestionNum:e.question.QuestionNum}),sCH.readerTagsForSectionLoaded(e.question.TextSectionId,"question")&&(e.question.Type="question",e.question.TagId=e.question.QuestionTagId,delete e.question.QuestionTagId,sCH.teacherQuestionsC.add(e.question));break;case"delete":(t=sCH.teacherQuestionsC.find({TagId:e.question.QuestionTagId}))&&(sCH.teacherQuestionsC.remove(t),sCH.questionsNumC.deleteModel(e.question.QuestionTagId));break;case"edit":if(e.positionChanged)this.assignmentUpdatedReloadPopup();else if(sCH.readerTagsForSectionLoaded(e.question.TextSectionId,"question")){var t;(t=sCH.teacherQuestionsC.find({TagId:e.question.QuestionTagId}))&&(delete e.question.QuestionTagId,t.set(e.question))}break;case"swap":this.assignmentUpdatedReloadPopup()}},t.ttsCall=function(e){Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"ttsCall",textSectionId:e.textSectionId})},t.translateCall=function(e){Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"translateCall",textSectionId:e.textSectionId})},t.vocabLookup=function(e){Backbone.pubEv.trigger("dataPanelNeedsRefresh",{event:"vocabLookup",textSectionId:e.textSectionId})};var c=function(e){return!sCH.readerConfig.isSmallGroupsEnabled||(t=sCH.getAssignmentUsers(),t&&t.teachersAndStudents.length>0?t.teachersAndStudents.map((function(e){return e.userId})).concat(sCH.userM.get("UserId")):[sCH.userM.get("UserId")]).includes(e);var t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(86),o=n(10),r=n(168),l=n(129),d=n(263),c=n(48),u=n(1033),p=n(649),h=n(170),g=n(192);t.default=Backbone.View.extend({template:n(1048),obj:{},events:{"focus [contenteditable]":"clearFlash",'click .categoriesDropdown li a:not(".btnManageDefaultCategory")':"categorySelected","click .categoriesDropdown li a input":"customCategoryClicked","keyup .categoriesDropdown li a input":"customCategoryChanged","click .categoriesDropdown .editCategory":"editCategory","click .categoriesDropdown .saveEdit":"saveCategoryEdit","click .categoriesDropdown .enableCategory":"enableCategory","click .categoriesDropdown .deleteCategory":"deleteCategory","click .categoriesDropdown .btnManageDefaultCategory":"manageDefaultCategory","click .btnSaveNote":"saveNote","click .btnClose":"closePopup","click .btnToggleMedia":"toggleMedia","click .btnBlockAddMedia":"showBuyPrimePopup","paste .txtMedia":"embedMedia","blur .txtMedia":"embedMedia","click .imgPreview":"enlarge","click .embedMediaPreviewRich":"enlarge","click .videoPlayButton":"enlarge","click .chkExtraHelpNote":"howToUseExtraHelp","click .extraHelpIcon":"manageExtraHelpStudents"},initialize:function(e){this.embedInTextView=0===$(".scroll .lrContainer > div.right").width()||!$(".reader").hasClass("notesPanelOpen"),this.obj=e,this.isFlagComment=this.obj.model&&this.obj.model.get("IsAssociatedNote")||"marker"===this.obj.type,e.edit||this.embedInTextView||this.initNewNote(),sCH.readerConfig.activeAddNote=this},initNewNote:function(){sCH.readerConfig.activeFullNote&&sCH.readerConfig.activeFullNote.hide(),Backbone.pubEv.on("loadSection",this.hide,this),this.newNote=new d.default({Type:"note",TextSectionId:sCH.readerConfig.currentSectionId,StartIndex:this.obj.sel.start,EndIndex:this.obj.sel.end,UserId:sCH.userM.get("UserId"),Text:" ",TagId:0,LayerId:"authoring"===sCH.readerConfig.type?sCH.readerConfig.layerId:null}),("authoring"===sCH.readerConfig.type?sCH.teacherNotesC:sCH.studentNotesC).add(this.newNote),"tour"===sCH.readerConfig.type?Backbone.pubEv.trigger("rerenderNotes"):Backbone.pubEv.trigger("renderNewTempNote",this.newNote)},render:function(){this.$el.addClass("popupNoteMenu addNote").html(this.template({hasHtml:!!this.obj.edit&&!!this.obj.model.get("HTML"),studentReader:"student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type,studentResearch:"student"==sCH.userM.get("Role")&&"studentresearch"==sCH.readerConfig.type,readerConfig:sCH.readerConfig,noteColorCategoryMap:s.generateNoteColorCategoryMap(sCH.readerConfig.tagConfig),editMode:this.obj.edit,userM:sCH.userM,placeholder:this.isFlagComment?"Provide more details for your teacher":"student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type?"Enter a note (optional)":"Enter a note",isContentTeamUser:alcfg.contentTeamUserIds.includes(sCH.userM.get("UserId"))})),this.show();try{if(!this.embedInTextView)(e=this).$el.css({maxHeight:e.getNewMaxHeight()}),$(window).bind("resize",a.throttle((function(){e.$el.css({maxHeight:e.getNewMaxHeight()})}),100)),this.$el.find("[contenteditable]").on("changeHeight",(function(){e.updateNotesPanelHeight()})),this.updateNotesPanelHeight()}catch(e){}var e=this;return this.$el.find(".categoriesDropdown").on("shown.bs.dropdown",(function(){e.$el.addClass("categoryDropdownOpen"),e.updateNotesPanelHeight()})).on("hide.bs.dropdown",(function(){if($(".modal-al-delete-category:visible").length>0)return!1;e.cancelEditCategory()})).on("hidden.bs.dropdown",(function(){e.$el.removeClass("categoryDropdownOpen"),e.resetCustomCategoryMode(),e.resetNotePanelHeight()})),this},updateNotesPanelHeight:function(){Backbone.pubEv.trigger("refreshNotesPanelHeight")},resetNotePanelHeight:function(){this.preChangeNotesViewHeight&&$(".notesview").height(this.preChangeNotesViewHeight)},getNewMaxHeight:function(){var e=$(window).height()-51;return"tour"===sCH.readerConfig.type&&(e-=120),e},show:function(){var e=this;this.embedInTextView?($(".popUpsWrapper").append(this.$el),this.popUp=!0):this.obj.edit?this.obj.scope.tagContainer.addClass("active").prepend(this.$el):$('.noteTagContainer[data-tagid="0"]').addClass("active").prepend(this.$el),setTimeout((function(){return Backbone.pubEv.trigger("updateMargin")}),200),this.embedInTextView?(this.$el.addClass("bottom"),$(".readerpanel.next").addClass("bottomPopupOpened"),sCH.readerConfig.isPDF||this.$el.css({left:$(".scroll .textSectionContainer").offset().left})):(this.$el.removeClass("bottom"),this.$el.css({marginRight:s.scrollbarWidth()})),this.obj.edit&&(this.$el.attr("data-tagid",this.obj.model.get("TagId")),this.$el.find(".noteText").html(this.obj.model.get("Text",!0)),this.$el.find(".txtMedia").val(this.obj.model.get("HTML")),this.$el.find(".mediaAttribution").val(this.obj.model.get("MediaAttribution")),this.obj.model.get("HTML")&&(this.toggleMedia(),this.embedMedia({})),this.obj.model.get("Category")&&(this.$el.find(".btnSelectCategory").html(this.obj.model.get("Category")+'<span class="caret"></span>'),this.$el.addClass(this.obj.model.get("Color")),this.$el.find('.categoriesDropdown li a[data-color="'+this.obj.model.get("Color")+'"]').addClass("selected")),this.$el.find(".chkShareNote").prop("checked",this.obj.model.get("IsPublic")),this.$el.find(".chkExtraHelpNote").prop("checked",this.obj.model.get("IsExtraHelp"))),this.$el.find(".noteText").text().trim()||(this.$el.find(".chkShareNote, .chkExtraHelpNote").attr("disabled",!0),this.$el.find(".shareNoteContainer").addClass("disabled")),this.$el.find(".noteText").on("blur keyup paste input",(function(){""!=e.$el.find(".noteText").text().trim()?(e.$el.find(".shareNoteContainer").removeClass("disabled"),e.$el.find(".chkShareNote").attr("disabled",!1),e.$el.find(".chkExtraHelpNote").attr("disabled",!sCH.userM.isOnPrimePlan())):(e.$el.find(".shareNoteContainer").addClass("disabled"),e.$el.find(".chkShareNote, .chkExtraHelpNote").attr("disabled",!0))})),s.destroyMediumEditor(this.medium);var t=this.$el.find("[contenteditable]"),n=sCH.getAssignmentUsers(),i=a.includes(["studentir","studentresearch"],sCH.readerConfig.type)?n.studentPeers:n.coTeachers;this.tagger=p.initTagging(t,i),this.medium=s.initMediumEditor(t),s.onDevice()||setTimeout((function(){"0px"!==e.$el.parent().css("top")&&e.$el.find("[contenteditable]").focus()}),500),this.isFlagComment&&(this.$el.addClass("flagComment").prepend("<h1>&ldquo;I don't understand&rdquo;</h1>"),this.$el.find(".btnSaveNote").text("Flag"),this.$el.find(".categoriesDropdown, .shareNoteContainer, .btnToggleMedia").addClass("displayNone"),this.$el.addClass("flagComment")),s.initTooltips(this.$el)},hide:function(){this.close()},clearFlash:function(){this.$el.find("[contenteditable]").removeClass("flash")},editCategory:function(e){var t=$(e.currentTarget).closest("a");return this.toggleCustomCategoryMode(t,"edit"),!1},cancelEditCategory:function(){var e=this.$el.find(".saveEdit:visible").closest("a");return this.toggleCustomCategoryMode(e,"view"),e.find("input.txtCategoryEdit").val(e.find("span.text").text().trim()),"deleted"===e.data("state")&&e.addClass("deleted"),!1},saveCategoryEdit:function(e){var t=$(e.currentTarget).closest("a"),n=t.find("input.txtCategoryEdit").val().trim(),a=t.data("color"),i=this;if(t.find("span.text").text().trim()===n&&"deleted"!==t.data("state"))return this.toggleCustomCategoryMode(t,"view"),!1;if(""===n)return s.bootstrap.alert({message:"Please enter a category!",alert:"danger"}),!1;var r,l={color:a,category:n};return"studentresearch"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type?(l.studentLayerId=sCH.readerConfig.studentLayerId,r=alcfg.node.reader_studentresearch.update_note_category):"student"===sCH.readerConfig.type?(l.assignmentId=sCH.readerConfig.assignmentId,r=alcfg.node.reader_student.update_note_category):(l.layerId=sCH.readerConfig.layerId,r=alcfg.node.reader_authoring.update_note_category),o.UpdateNoteCategory(l,r,(function(e){e?(i.toggleCustomCategoryMode(t,"view"),t.find("span.text").text(t.find("input.txtCategoryEdit").val()),t.removeData("state").click(),s.bootstrap.alert({message:"Updated category!"})):s.bootstrap.alert({message:"There was a problem. Please try again.",alert:"danger"})})),!1},deleteCategory:function(e){var t=$(e.currentTarget).closest("a"),n=t.find("span.text").text().trim(),a=t.data("color"),i=this,r=function(){o.DeleteNoteCategory({categoryColor:a,categoryText:n,layerId:sCH.readerConfig.layerId},(function(e){e&&(i.cancelEditCategory(t,"view"),t.addClass("deleted"),t.data("state","deleted"),i.$el.hasClass(a)&&i.$el.find(".categoriesDropdown .dropdown-menu li:eq(0) a").click(),s.bootstrap.alert({message:"Category deleted."}))}))};if(sCH.userM.showPopup("DeleteNoteCategory"))var l=new Backbone.BootstrapModal({content:"Categories you remove will not be available for your students to choose. You can always restore it later.",okText:"Delete",cssClass:"modal-al-delete-category",title:"Delete category?",doNotShowAgain:!0}).open((function(){s.isDoNotShowChecked(l)&&s.updateDoNotShowPopupSetting("DeleteNoteCategory"),r()}));else r();return!1},enableCategory:function(e){var t=$(e.currentTarget).closest("a");return t.removeClass("deleted"),this.toggleCustomCategoryMode(t,"edit"),!1},resetCustomCategoryMode:function(){this.$el.find("li.custom").each((function(){var e=$(this).find(".view"),t=$(this).find(".edit");t.children("input").val().trim()&&"none"!=t.css("display")&&(t.hide(),e.children(".text").text(t.children("input").val()),e.show())}))},toggleCustomCategoryMode:function(e,t){"edit"===t?(e.find("span.text, .editCategory").hide(),e.find("input.txtCategoryEdit, .deleteCategory, .saveEdit").show(),e.find("input.txtCategoryEdit").focus(),this.$el.find(".editCategory, .enableCategory").addClass("displayNone")):(e.find("span.text, .editCategory").show(),e.find("input.txtCategoryEdit, .deleteCategory, .saveEdit").hide(),this.$el.find(".editCategory, .enableCategory").removeClass("displayNone"))},customCategoryClicked:function(e){e.stopPropagation(),this.customCategoryChanged(e)},customCategoryChanged:function(e){var t=$(e.currentTarget),n=t.val(),a=t.closest("a");0!==n.length&&(13!==e.keyCode?a.hasClass("custom")&&(this.$el.find(".categoriesDropdown li a.selected").removeClass("selected"),a.addClass("selected"),this.$el.find(".btnSelectCategory").html(n+'<span class="caret"></span>'),this.$el.closest(".noteTagContainer").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(a.attr("class")),$(".notesTag.active").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(a.attr("class")),$(".notereference").closest(".notesTag").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(a.attr("class"))):this.saveCategoryEdit(e))},categorySelected:function(e){var t=$(e.currentTarget),n=t.text().trim();if(t.hasClass("deleted"))return!1;0!==n.length&&(this.$el.find(".categoriesDropdown li a.selected").removeClass("selected"),t.addClass("selected"),this.$el.find(".btnSelectCategory").html(n+'<span class="caret"></span>'),this.$el.closest(".noteTagContainer").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(t.closest("a").data("color")),this.$el.removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(t.closest("a").data("color")),$(".notesTag.active").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(t.attr("class")),$(".notereference").closest(".notesTag").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(t.attr("class")))},saveNote:function(){var e=this.$el.find("[contenteditable]"),t=e.text().length>0?e.html():"",n="Select category"==this.$el.find(".btnSelectCategory").text()?void 0:this.$el.find(".btnSelectCategory").text().trim(),i=this.$el.find(".categoriesDropdown li a.selected"),o={},r=this,d=p.getTaggedUserList(e);if("marker"===this.obj.type)return o.StartIndex=this.obj.sel.start,o.EndIndex=this.obj.sel.end,o.Type="marker",o.SubType=1,o.IsPublic=!0,o.Text=""===e.text().trim()?"I do not understand":t,o.HighlightedText=this.obj.sel.text.length>2048?this.obj.sel.text.substring(0,2045)+"...":this.obj.sel.text,this.obj.scope.addNewTag(o),Backbone.pubEv.trigger("popupAddNoteHide"),void s.bootstrap.alert({message:"Your teacher has been notified that you need help with this passage!"});if(e.text().trim()||"tour"===sCH.readerConfig.type||"student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type){if(e.removeClass("flash"),i.length>0&&(o.color=i.data("color"),o.category=n,i.children("input").length>0)){var c=a.filter(sCH.readerConfig.tagConfig,{Color:o.Color});c.length?c[0].Category!==o.category&&(c[0].Category=o.category,Backbone.pubEv.trigger("noteCustomCategoryUpdate",{color:o.color,category:o.category,userId:window.ActivelyRead.currentUserId})):sCH.readerConfig.tagConfig.push({Color:o.color,Category:o.category})}t&&(o.text=t),this.$el.find(".txtMedia").val()&&this.$el.find(".btnToggleMedia").hasClass("active")&&(o.html=this.$el.find(".txtMedia").val(),o.mediaAttribution=this.$el.find(".mediaAttribution").val()||void 0),o.type="note","authoring"===sCH.readerConfig.type&&(o.layerId=sCH.readerConfig.layerId),"student"===sCH.readerConfig.type&&(o.assignmentId=parseInt(sCH.readerConfig.assignmentId)),["studentresearch","studentir"].indexOf(sCH.readerConfig.type)>-1&&(o.studentLayerId=parseInt(sCH.readerConfig.studentLayerId)),o.isPublic="studentresearch"===sCH.readerConfig.type||!this.$el.find(".shareNoteContainer").hasClass("disabled")&&this.$el.find(".chkShareNote").is(":checked"),o.isExtraHelp=!this.$el.find(".shareNoteContainer").hasClass("disabled")&&this.$el.find(".chkExtraHelpNote").is(":checked"),o.taggedUserIds=d.join(",");var u=s.calculateWordAndCharacterCountFromHtml(t);if(o.wordCount=u.wordCount,!s.alertLongContenteditableText(u.characterCount)&&s.alertLongUrl(o.html)){if(this.$el.find(".btnSaveNote").text("Saving..."),this.obj.edit)if(s.userIsStudent()){if(this.obj.model.get("IsAssociatedNote")&&!e.text().trim())return s.bootstrap.alert({message:"Please enter some text. If you wish to delete the comment, press Delete.",alert:"warning"}),this.$el.find(".btnSaveNote").text("Flag"),void e.focus().addClass("flash");this.obj.model.saveData(o,{success:function(){Backbone.pubEv.trigger("rerenderNotes"),s.bootstrap.alert({message:r.isFlagComment?"Flag updated!":"Note updated!"})}})}else this.obj.model.saveData(o,{success:function(){s.intercom("trackEvent","editedlayer-updatedn",{layerId:sCH.learnEntityMetaM.get("LayerId"),layerName:sCH.learnEntityMetaM.get("Title")}),sCH.readerSettingsM.get("IsAssigned")&&"student"!==sCH.readerConfig.type&&s.bootstrap.alert({message:alcfg.alertsText.changesSaved})}});else{var g="";g=sCH.readerConfig.isPDF?this.obj.sel.text:s.removeWhiteoutText(".inTextSearchResult.notereference"),o.startIndex=this.obj.sel.start,o.endIndex=this.obj.sel.end,o.highlightedText=g.length>2048?g.substring(0,2045)+"...":g,o.highlightedText.length>0?(this.obj.scope.addNote(o),s.intercom("trackEvent","editedlayer-addedn",{layerId:sCH.learnEntityMetaM.get("LayerId"),layerName:sCH.learnEntityMetaM.get("Title")}),"authoring"===sCH.readerConfig.type&&sCH.learnEntityMetaM.set("NoteTagCount",sCH.learnEntityMetaM.get("NoteTagCount")+1),"student"===sCH.readerConfig.type&&h.trigger({type:"jetpack"})):s.bootstrap.alert({message:alcfg.alertsText.requestFailed,alert:"danger"})}if(this.close(),Backbone.pubEv.trigger("queuedPopupNoteEvents"),"tour"===sCH.readerConfig.type){if(!l.isActionCurrentStep("added note"))return void l.blinkStepNumber();l.advance()}}}else e.addClass("flash")},embedMedia:function(e){var t="paste"===e.type?e.originalEvent.clipboardData.getData("text"):this.$el.find(".txtMedia").val().trim();s.alertLongUrl(t)&&(r.checkUrl(t)?i.embedMediaPreview({container:this.$el.find(".noteHtml"),mediaUrl:t,shouldUpdateMargin:!1,isCreatedByCurrentUser:!0}):this.$el.find(".noteHtml").empty())},toggleMedia:function(){this.$el.find(".txtMedia");var e=this.$el.find(".btnToggleMedia");this.$el.find(".noteMediaContainer").toggleClass("displayNone"),this.$el.find(".noteMediaContainer").is(":visible")?e.addClass("active"):e.removeClass("active"),this.updateNotesPanelHeight()},showBuyPrimePopup:function(){c.showBuyTeacherPopup({title:"Adding media",content:alcfg.confirmsText.freeTAddMedia})},enlarge:function(){i.openMediaInPopup(this.obj.model.get("HTML"),this.obj.model.get("MediaAttribution"))},checkTextEntered:function(){var e=this.$el.find(".noteText[contenteditable]:not(:hidden)"),t=e.length>0?e.text().trim():null;if(t&&(t=t.replace(/"/g,"&quot;"),(!this.obj.model||t!==this.obj.model.get("Text"))&&!this.skipUnsavedNoteCheck&&!confirm(alcfg.alertsText.unsavedNote)))return!0},closePopup:function(){if(this.checkTextEntered())return!1;this.obj.edit&&(this.$el.closest(".noteTagContainer").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.obj.model.get("Color")),$(".notesTag.active").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.obj.model.get("Color"))),this.close(),$(".readerpanel.next.bottomPopupOpened").removeClass("bottomPopupOpened"),Backbone.pubEv.trigger("popupAddTagHide"),Backbone.pubEv.trigger("queuedPopupNoteEvents")},howToUseExtraHelp:function(e){if($(e.currentTarget).is(":checked")&&sCH.userM.showPopup("HowToUseExtraHelp"))new Backbone.BootstrapModal({title:"How to use Extra Help",content:'<p>To show these notes ONLY to students who need extra help, check "Extra Help" in your roster.</p><img class="animGif" src="/img/HowToExtraHelp_Reader.gif" />',cssClass:"modal-al-how-to-use-extra-help",allowCancel:!1,cancelText:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){s.updateDoNotShowPopupSetting("HowToUseExtraHelp")}))},manageDefaultCategory:function(){sCH.userM.isOnFreePlan()?c.showBuyTeacherPopup({title:"Setting Default Note Categories"}):new Backbone.BootstrapModal({title:"Set default note categories",content:new u.default,cssClass:"modal-al-modal-al-default-note-categories",allowCancel:!0,okText:"Update"}).open()},manageExtraHelpStudents:function(e){g.renderManageExtraHelpStudentsPopup(),e.stopPropagation(),e.preventDefault()},destroy:function(){(this.obj.edit&&this.obj.model.isHighlightOnly()&&this.$el.closest(".noteTagContainer").addClass("displayNone"),sCH.readerConfig.activeAddNote=null,this.obj.edit)||this.newNote&&(("authoring"===sCH.readerConfig.type?sCH.teacherNotesC:sCH.studentNotesC).remove(this.newNote),$(".inTextSearchResult").removeClass("notereference"),$('.notesTag[data-tagid="0"]').addClass("inTextSearchResult"),s.clearSearchHighlights(),this.$el.closest(".noteTagContainer").remove(),"tour"===sCH.readerConfig.type?Backbone.pubEv.trigger("updateMargin"):(Backbone.pubEv.trigger("removeNewTempNote",this.newNote),Backbone.pubEv.trigger("updateMargin")));this.obj.edit&&sCH.readerConfig.activeFullNote&&(sCH.readerConfig.activeFullNote.hide(),sCH.readerConfig.activeFullNote=null),Backbone.pubEv.off("loadSection",this.hide,this),s.destroyMediumEditor(this.medium),p.destroyTagging(this.tagger,this.$el.find("[contenteditable]")),this.$el.remove()}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={talkBubble:{fontFamily:"AvenirNextLTW02-Medium",position:"relative",border:"solid 3px #000",borderRadius:20,fontSize:18,padding:10,background:"#FFF",marginBottom:20,"&:before":{content:'""',position:"absolute",width:0,height:0,left:60,bottom:-25,border:"12px solid",borderColor:"#000 #000 transparent transparent"},"&:after":{content:'""',position:"absolute",width:0,height:0,left:58,bottom:-20,border:"12px solid",borderColor:"#FFF #FFF transparent transparent"}}}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1121),i=n(43),o=n(8),r=n(44);t.default=Backbone.Collection.extend({model:s.default,sync:r.default,comparator:function(e){return(e.get("Name")||"").toLowerCase()},fill:function(e,t){var n=this,s=e?alcfg.node.class.list_student:alcfg.node.class.list_teacher;this.fetch({url:s,data:null,mainSuccess:function(a){n.set(a.classes),e||(sCH.userM.set("HasArchivedClasses",!!a.hasArchivedClasses),sCH.userM.set("ArchivedClasses",a.archivedClasses)),t&&t()},mainError:function(e,t){sCH.clearCollection("classesC"),window.ActivelyRead.account&&window.ActivelyRead.account.chromeDebug&&(rg4js("send",{error:new Error("Google account-fetch Classes"),customData:{model:e,msg:t,details:window.ActivelyRead.account.chromeDebug}}),window.ActivelyRead.account.chromeDebug={}),i.chrome&&a.bootstrap.alert({message:'Trouble signing in? This is likely due to a recent Chrome update.<br/>                  To fix this, you will have to <a href="'+alcfg.helpArticleLink.alcookies+'">clear your cookies</a>.<br/><br/><img src="/img/ClearCookies.gif" />',alert:"danger",autoClose:!1})}})},fillArchived:function(){var e=this,t=alcfg.node.class.archived_list;this.fetch({url:t,mainSuccess:function(t){e.set(t)}})},addClass:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add,data:e,showLoading:!0,vital:!0,onSuccess:function(a){var s={Name:e.name,GradeLevel:e.gradeLevel,SchoolId:e.schoolId,ClassId:a.ClassId,Code:a.Code,Assignments:[],Teachers:[{ClassId:a.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],Source:"native",TeacherUserId:sCH.userM.get("UserId")};n.add(s,{at:0}),t(s.ClassId)}})},duplicateClass:function(e,t){var n=this,s={Name:e.name,GradeLevel:e.gradeLevel};a.ajax({type:"POST",url:alcfg.node.class.duplicate,data:e,showLoading:!0,vital:!0,onSuccess:function(e){s.ClassId=e.ClassId,s.Code=e.Code,s.Assignments=e.Assignments,s.Teachers=e.Teachers,s.Source="native",s.TeacherUserId=sCH.userM.get("UserId"),n.add(s),t(s.ClassId)}})},addGoogleCourses:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_googlecourses,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(a){o.each(a,(function(t,s){var i=o.filter(e.courses,{ExternalClassId:parseInt(t.ExternalClassId)})[0];i.ClassId=t.ClassId,i.Assignments=[],i.ExternalClassId=t.ExternalClassId,i.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:t.TeacherUserId===sCH.userM.get("UserId")}],i.Source="google",i.TeacherUserId=t.TeacherUserId,n.add(i,{at:0,silent:parseInt(s)<a.length-1})})),t(a),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addCleverSections:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_clever_sections,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){e.forEach((function(t,a){t.Assignments=[],t.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],n.add(t,{at:0,silent:a<e.length-1})})),t(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addCanvasSections:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_canvassections,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){e.forEach((function(t,a){t.Assignments=[],t.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],t.Source="canvas",t.TeacherUserId=sCH.userM.get("UserId"),n.add(t,{at:0,silent:a<e.length-1})})),t(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addSchoologySections:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_schoologysections,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){e.forEach((function(t,a){t.Assignments=[],t.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],t.Source="schoology",t.TeacherUserId=sCH.userM.get("UserId"),n.add(t,{at:0,silent:a<e.length-1})})),t(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addBrightspaceSections:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_brightspacesections,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){e.forEach((function(t,a){t.Assignments=[],t.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],t.Source="brightspace",t.TeacherUserId=sCH.userM.get("UserId"),n.add(t,{at:0,silent:a<e.length-1})})),t(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addExternalSections:function(e,t,n){var s=this;a.ajax({type:"POST",url:alcfg.node.class["add_"+t+"sections"],data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){e.forEach((function(n,a){n.Assignments=[],n.Teachers=[{ClassId:n.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],n.Source=t,n.TeacherUserId=sCH.userM.get("UserId"),s.add(n,{at:0,silent:a<e.length-1})})),n(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addOneRosterSections:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_onerostersections,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(e){e.forEach((function(t,a){t.Assignments=[],t.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],t.Source="oneroster",t.TeacherUserId=sCH.userM.get("UserId"),n.add(t,{at:0,silent:a<e.length-1})})),t(e),Backbone.pubEv.trigger("loadingShowHide",!1)}})},addEdmodoGroups:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.add_edmodo_groups,data:e,showLoading:!1,vital:!0,timeout:12e4,onSuccess:function(a){o.each(a,(function(t,s){var i=o.find(e.groups,{ExternalClassId:parseInt(t.ExternalClassId)});i.ClassId=t.ClassId,i.Assignments=[],i.Teachers=[{ClassId:t.ClassId,UserId:sCH.userM.get("UserId"),Title:sCH.userM.get("Title"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),IsOwner:!0}],i.Source="edmodo",i.TeacherUserId=sCH.userM.get("UserId"),n.add(i,{at:0,silent:parseInt(s,10)<a.length-1})})),t(a),Backbone.pubEv.trigger("loadingShowHide",!1)}})},updateClass:function(e){a.ajax({type:"POST",url:alcfg.node.class.edit,data:e,showLoading:!0,vital:!1,onSuccess:function(){}})},deleteClass:function(e,t){a.ajax({type:"POST",url:alcfg.node.class.delete,data:{classId:e},showLoading:!1,vital:!0,onSuccess:function(e){t(e)}})},archiveClass:function(e,t){a.ajax({type:"POST",url:alcfg.node.class.archive,data:{classId:e},showLoading:!1,vital:!0,onSuccess:function(n){var a=sCH.userM.get("ArchivedClasses");a.push(e),sCH.userM.set("ArchivedClasses",a),t(n)}})},unArchiveClasses:function(e,t){a.ajax({type:"POST",url:alcfg.node.class.unarchive,data:{classIds:e},showLoading:!1,vital:!0,onSuccess:function(n){var a=o.difference(sCH.userM.get("ArchivedClasses"),e);sCH.userM.set("ArchivedClasses",a),t(n)}})},joinClass:function(e,t){var n=this;this.filter({Code:e.classCode.toUpperCase()}).length>0?t({Success:!1,Message:"You've already joined this class!"}):a.ajax({type:"POST",url:alcfg.node.class.join,data:e,showLoading:!0,vital:!0,onSuccess:function(e){e&&n.add(e,{at:0}),t(e)},onError:function(e){t({Success:!1,Message:a.getErrorTextFromResponse(e)})},onUnauthorizedError:function(e){t({Success:!1,Message:a.getErrorTextFromResponse(e)})}})},joinMyClass:function(e,t){var n=this;a.ajax({type:"POST",url:alcfg.node.class.join_my_class,data:e,showLoading:!0,vital:!0,onSuccess:function(e){e&&n.add(e,{at:0}),t(e)},onError:function(){t({Success:!1})}})},leaveClass:function(e,t){a.ajax({type:"POST",url:alcfg.node.class.leave,data:{classId:e},showLoading:!1,vital:!0,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},getModelByClassId:function(e){return this.filter({ClassId:e})[0]},getMostCommonGradingLabeloption:function(){var e={},t=[];this.each((function(n){var a=JSON.parse(n.get("Settings")||null),s=a&&a.gradebook&&a.gradebook.gradeLabelsOption?a.gradebook.gradeLabelsOption:"-1";s===alcfg.grades.customGradeScaleOption&&t.push(a.gradebook.gradeLabels),e[s]=++e[s]||1}));var n=o.max(e)===o.min(e)&&Object.keys(e).length>1?-1:o.invert(e)[o.max(e)];if((n=parseInt(n))===parseInt(alcfg.grades.customGradeScaleOption)){var a={};return o.each(t,(function(e){a[e]=++a[e]||1})),{gradeLabelsOption:n,gradeLabelsMap:o.invert(a)[o.max(a)]}}return{gradeLabelsOption:n,gradeLabelsMap:{}}},addAssignments:function(e,t,n){a.ajax({type:"POST",url:alcfg.node.workspace.assign_layers,data:e,showLoading:!0,vital:!0,onSuccess:function(e){t(e)},onError:function(){n()}})}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(34),i=n(14),o=n(39);t.default=function(e){var t=e.title,n=e.handleChange;return a.createElement(s.SelectValidator,{name:"title",label:"Title",value:t||"",onChange:n("title"),id:"title",fullWidth:!0,required:!0},i.UserSignupTitles.map((function(e){var t=e.value,n=e.label;return a.createElement(o.default,{key:"title-"+t,value:t},n)})))}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(34),l=n(39),d=n(14);t.default=function(e){var t=e.isHigherEd,n=void 0!==t&&t,i=e.showGradeLevelAsRange,r=void 0!==i&&i,l=e.showHigherEdOption,u=void 0===l||l,p=e.gradeLevelId,h=void 0===p?"":p,g=e.onChange,f=e.shouldValidate,m=void 0===f||f,v=e.id,b=void 0===v?"grade-levels":v,C=s(e,["isHigherEd","showGradeLevelAsRange","showHigherEdOption","gradeLevelId","onChange","shouldValidate","id"]);return n?null:r?o.createElement(c,a({gradeLevels:d.UserGradeLevels,onChange:g,value:h,showHigherEdOption:u,shouldValidate:m,id:b},C)):o.createElement(c,a({gradeLevels:d.GradeLevels,onChange:g,value:h,showHigherEdOption:u,shouldValidate:m,id:b},C))};var c=function(e){var t=e.gradeLevels,n=e.onChange,d=e.value,c=e.showHigherEdOption,u=e.shouldValidate,p=e.id,h=s(e,["gradeLevels","onChange","value","showHigherEdOption","shouldValidate","id"]),g=i(t);return c||g.pop(),o.createElement(r.SelectValidator,a({id:p,label:"Grade level",onChange:n,fullWidth:!0,value:d||"",required:u},h),g.map((function(e){return o.createElement(l.default,{key:e.value,value:e.value},e.label)})))}},,,,,,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(487),o=n(737),r=n(274),l=n(738),d=n(0),c=n(85),u=n(14),p=n(5),h=n(48),g=n(10),f=n(8),m=n(347),v=n(490),b=n(39),C=n(38),y=n(18),_=n(111),S=n(739),w=n(65),T=n(24),I=n(1339),x=n(1340),k=n(741),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=t.props.data,t.tileUpdated=function(e){t.setState(e)},t}return s(t,e),t.prototype.componentDidUpdate=function(e){f.isEqual(this.props.data,e.data)||this.setState(this.props.data)},t.prototype.render=function(){var e,t=J(this.state,this.props.page,this.props.classObj),n=!1!==t.IsReadable||window.isIOSApp?null:"_blank",a=t.Color||"indigo",s=t.IsQuiz||1===t.Type,i=[u.Page.CATALOG,u.Page.WORKSPACE,u.Page.LIBRARY].indexOf(this.props.page)>-1,o=p.classNames(((e={tile:!0})[a]=!t.CoverArt,e.locked=t.IsLocked,e.sharedbydisabled=t.SharedByDisabled,e.isQuiz=s,e.alQuiz=1===t.Type,e.placeholder=t.IsPlaceholder,e.longTitle=t.sanitizedTitle.length>68,e.hasMetadataOverlay=!!t.EssentialQuestion&&!t.IsHeroTile,e.hasAssignees=t.Assignees&&t.Assignees.length>0,e.canvasSynced=t.IsSyncedWithCanvas,e)),r=p.classNames({eq:!0,long:t.EssentialQuestion&&t.EssentialQuestion.length>100}),l=null!==t.Publisher&&void 0!==t.Publisher?t.Publisher.split(" ")[0]:"",c=t.Topics?f.uniqBy(t.Topics,"TopicName"):[];return d.createElement("div",{className:t.IsHeroTile?"heroTile":""},d.createElement("a",{className:o,"data-id":t.Id,"data-learnentityid":t.LearnEntityId,"data-layerid":t.LayerId,href:i?"javascript:void(0)":t.Link||"javascript:void(0)",target:n,role:"link","aria-label":t.sanitizedTitle,onClick:function(){return N(t,i)}},!!t.EssentialQuestion&&!t.IsHeroTile&&d.createElement("div",{className:"metadata"},d.createElement("div",{className:"eqTitle"},"Essential Question"),d.createElement("div",{className:r},t.EssentialQuestion),d.createElement("div",{className:"topics"},c.length>0&&d.createElement(d.Fragment,null,d.createElement("div",{className:"topicsTitle"},"Topics"),d.createElement("ul",null,c.map((function(e,t){return d.createElement("li",{key:e.TopicId+"_"+t},e.TopicName)})))))),t.NotificationCount>0&&d.createElement(A,{tile:t}),d.createElement("div",{className:"wrapper"},!t.IsHeroTile&&d.createElement(V,{tile:t,page:this.props.page}),!t.CoverArtContainsTitle&&this.props.page!==u.Page.CATALOG&&d.createElement(q,{tile:t}),!t.IsHeroTile&&d.createElement(z,{tile:t}),-1===[u.Page.CATALOG,u.Page.WORKSPACE,u.Page.LIBRARY].indexOf(this.props.page)&&d.createElement("div",{className:"checkbox"},d.createElement("input",{id:t.LearnEntityId,type:"checkbox",className:"chkSelectTile regular-checkbox"}),d.createElement("label",{htmlFor:t.LearnEntityId})),!(t.IsQuiz||1===t.Type)&&d.createElement(W,{imgClass:l,tile:t}),d.createElement(Q,{tile:t,onTileUpdated:this.tileUpdated,eqClasses:r})),!t.IsHeroTile&&this.props.page===u.Page.CATALOG&&d.createElement(M,{tile:t,onTileUpdated:this.tileUpdated}),[u.Page.WORKSPACE,u.Page.LIBRARY].indexOf(this.props.page)>-1&&d.createElement(H,{tile:t,page:this.props.page,onTileUpdated:this.tileUpdated}),this.props.page===u.Page.ASSIGNMENTS&&d.createElement(R,{tile:t})),t.ViewingBookshelf&&d.createElement("div",{className:"btn-box btnReview"},sCH.classesC.length>0?"Review and share":"Review"))},t}(d.Component),N=function(e,t){if(e.IsPlaceholder)!function(e){g.RequestText({title:e,author:"Someone"},(function(e){e?p.bootstrap.alert({message:"Thank you for your request. Our Content team will notify you if and when we are able to add this text to the Catalog!",autoClose:!1}):p.bootstrap.alert({message:"Unable to process your text request. If this problem persists, please contact Actively Learn."})}))}(e.Title);else if(t){if(e.IsAnonymousPreviewInaccessible&&sCH.userM.isAnonUser())return void p.showAnonymousPreviewInaccessiblePopup({inReader:!1});e.SharedByDisabled?h.showBuyTeacherPopup({title:"Sharing limit reached",content:"You have reached the limit of receiving 3 shared assigments from your peers.           To access this assignment and all other shared ones, your school must upgrade to a Prime plan."}):!1===e.IsReadable?window.open(e.Link):e.RentalPrices&&e.Territories?sCH.userM.getCountryCode((function(t){-1===e.Territories.indexOf(t)?new Backbone.BootstrapModal({title:"No access",content:"<p>The publisher of this rental text has not made it available in "+t+".</p>",cancelText:!1}).open():p.openReaderUrl(e.Link)})):p.openReaderUrl(e.Link)}},A=function(e){var t=e.tile;return d.createElement(w.default,{title:d.createElement("span",{dangerouslySetInnerHTML:{__html:t.NotificationTooltip}})},d.createElement("div",{className:"notificationCount"},t.NotificationCount))},M=function(e){var t=e.tile,n=Y(t.GradeLevels||[]);if(t.IsPlaceholder)return null;var a=null,s=null;if(t.RentalPrices&&-1===u.CovidPaidTextsToBeMadeFree.indexOf(t.LearnEntityId)){var i=JSON.parse(t.RentalPrices),o=Object.keys(i)[0],r=i[o];a="$"+(r/100).toFixed(2)+" / license for "+o,s='Unlimited: <span class="strikethrough">$'+(r/100).toFixed(2)+"</span>$0.00 / license for "+o}var l=t.Layers.find((function(e){return e.LayerId===t.LayerId})),c=l.QuestionTagCount,p=l.NoteTagCount,h=l.HasExtraHelp;return d.createElement("footer",null,d.createElement("div",{className:"left"},d.createElement(P,{tile:t}),n&&d.createElement(w.default,{title:"Grade Levels"},d.createElement("span",{className:"gradelevels"},n)),t.Lexile&&d.createElement(w.default,{title:"Lexile Level"},d.createElement("span",{className:"lexile"},t.Lexile,"L")),d.createElement(G,{questionTagCount:c,noteTagCount:p,hasExtraHelp:h}),d.createElement(F,{isInStudentLibrary:t.IsInStudentLibrary}),a&&(sCH.userM.isOnPrimeUnlimited()?d.createElement(w.default,{title:d.createElement("span",{dangerouslySetInnerHTML:{__html:s}})},d.createElement("span",{className:"unlimited","data-container":"body"},"U")):d.createElement(w.default,{title:d.createElement("span",{dangerouslySetInnerHTML:{__html:a}})},d.createElement("span",{className:"icon-paid","data-container":"body"})))),"Teaching Guide"!==t.sanitizedTitle&&d.createElement("div",{className:"right"},d.createElement($,{tile:t}),d.createElement(j,{tile:t,onTileUpdated:e.onTileUpdated})))},H=function(e){var t=e.tile,n=Y(t.GradeLevels||[]),a=t.Layers.find((function(e){return e.LayerId===t.LayerId})),s=a.QuestionTagCount,i=a.NoteTagCount,o=a.HasExtraHelp;return d.createElement("footer",null,d.createElement("div",{className:"left"},d.createElement(O,{tile:t,page:e.page,onTileUpdated:e.onTileUpdated}),d.createElement(P,{tile:t}),n&&d.createElement(w.default,{title:"Grade Levels"},d.createElement("span",{className:"gradelevels"},n)),t.Lexile&&d.createElement(w.default,{title:"Lexile Level"},d.createElement("span",{className:"lexile"},t.Lexile,"L")),d.createElement(G,{questionTagCount:s,noteTagCount:i,hasExtraHelp:o}),d.createElement(F,{isInStudentLibrary:t.IsInStudentLibrary})),d.createElement("div",{className:"right"},d.createElement($,{tile:t}),d.createElement(j,{tile:t,onTileUpdated:e.onTileUpdated})))},R=function(e){var t=e.tile;return d.createElement("footer",{className:t.PageCount?"hasCenterColumn":""},d.createElement(L,{tile:t}),d.createElement(D,{tile:t}),d.createElement("div",{className:"left"}),d.createElement("div",{className:"right"},t.LockStateTooltip&&d.createElement(w.default,{title:d.createElement("span",null,d.createElement("span",{dangerouslySetInnerHTML:{__html:t.LockStateTooltip}}),d.createElement("br",null),"Assigned on ",t.AssignedDateDisplay)},d.createElement("span",{className:"icon-lock "+(t.IsLocked?"isLocked":"")})),!t.LockStateTooltip&&t.AssignedDateDisplay&&d.createElement(w.default,{title:d.createElement("span",null,"Assigned on ",d.createElement("br",null),t.AssignedDateDisplay)},d.createElement("span",{className:"icon assignedDate"})),1===t.IsSyncedWithCanvas&&d.createElement(w.default,{title:"This assignment is synced with your canvas account"},d.createElement("span",{className:"icon-canvas-logo no-hover"}))),d.createElement("div",{className:"center"}))},P=function(e){return e.tile.PageCount>0?"Videos"===e.tile.TextType?d.createElement(w.default,{title:"Video Length"},d.createElement("span",{className:"pagecount"},m.formatSecondsToTime(parseInt(e.tile.PageCount)))):d.createElement(w.default,{title:"# of Pages"},d.createElement("span",{className:"pagecount"},p.plural(Math.ceil(e.tile.PageCount),"%count pg","%count pgs"))):null},D=function(e){var t=e.tile;if("student"!==sCH.userM.get("Role")&&t.Assignees&&t.Assignees.length){var n=t.Assignees.map((function(e){return p.sanitize(e.FirstName)+" "+p.sanitize(e.LastName).substr(0,1)}));return d.createElement(w.default,{title:"Assigned to "+n.join(", ")},d.createElement("div",{className:"assignees"},n.length,d.createElement("span",{className:"icon-person"})))}return null},L=function(e){var t=e.tile;return void 0===t.NumTotalUngradedResponses?null:d.createElement("div",{className:"responses"},d.createElement(w.default,{title:d.createElement("span",null,"# of Ungraded Responses",d.createElement("br",null),d.createElement("span",null,"refresh to update"))},d.createElement("span",{className:"count"},t.NumTotalUngradedResponses?t.NumTotalUngradedResponses+" Ungraded":"",t.NumNewUngradedResponses?" ("+t.NumNewUngradedResponses+" New)":"")))},O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={anchorEl:null},t.openMenu=function(e){e.stopPropagation(),t.setState({anchorEl:e.currentTarget})},t.closeMenu=function(e){e.stopPropagation(),t.setState({anchorEl:null})},t.edit=function(e){t.closeMenu(e);var n="Videos"===t.props.tile.TextType?"video":"text";T.showModal(d.createElement(o.default,{title:1===t.props.tile.Type?"Edit quiz details":"Edit "+n+" details and cover image",text:t.props.tile,callback:t.props.onTileUpdated,okText:"Save"}))},t.merge=function(e){t.setState({anchorEl:null}),Backbone.pubEv.trigger("layerSelectedToMerge",e)},t.remove=function(e){t.closeMenu(e),t.props.page===u.Page.LIBRARY?new Backbone.BootstrapModal({title:"Remove from "+sCH.userM.getLibraryString()+"?",content:"",okText:"Delete"}).open((function(){var e={layerId:t.props.tile.LayerId};p.attachSchoolDistrictId(e),g.RemoveLayerFromLibrary(e,(function(){Backbone.pubEv.trigger("libraryTextRemoved",e)}))})):g.RemoveLayerFromFolder({layerId:t.props.tile.LayerId,folderId:t.props.tile.FolderId},(function(){Backbone.pubEv.trigger("myFoldersTextRemoved",{layerId:t.props.tile.LayerId})}))},t.delete=function(e){var n=t;t.setState({anchorEl:null});var a=e.CoauthorFirstAdded;T.showModal(d.createElement(l.default,{selectedLayer:e,coauthorFirstAdded:a,okCallback:function(){g.DeleteLayer(e.LayerId,(function(t){t&&(1===n.props.tile.Layers.filter((function(e){return"UserLayer"===e.LayerType})).length?(Backbone.pubEv.trigger("myFoldersTextRemoved",{layerId:e.LayerId}),Backbone.pubEv.trigger("myImportsTextRemoved",{layerId:e.LayerId})):(n.props.tile.Layers=n.props.tile.Layers.filter((function(t){return t.LayerId!==e.LayerId})),n.props.onTileUpdated(n.props.tile)),T.hideModals())}))}}))},t.buyRentalLicenses=function(e){t.closeMenu(e);var n={LearnEntityId:t.props.tile.LearnEntityId,LayerId:t.props.tile.LayerId,IsUserLayer:"UserLayer"===t.props.tile.LayerType,Title:t.props.tile.sanitizedTitle,RentalPrices:t.props.tile.RentalPrices,Publisher:t.props.tile.Publisher,IsTextToSpeechDisabled:t.props.tile.IsTextToSpeechDisabled,IsLearnEntityPurchased:"UserLayer"===t.props.tile.LayerType,Territories:t.props.tile.Territories};new Backbone.BootstrapModal({title:t.props.tile.sanitizedTitle,content:new r.default({textM:n,source:u.LearnEntityPurchaseSource.WORKSPACE_TILE}),okText:sCH.userM.isSchoolUsingContentCredits()?"Ok":"Rent",cssClass:"modal-lg modal-al-payment-form",allowCancel:!1}).open()},t.shareLayer=function(e){t.closeMenu(e),T.showModal(d.createElement(S.default,{title:"Send a copy of the assignments to colleagues",okText:"Send",layerId:t.props.tile.LayerId}))},t.addToStudentLibrary=function(e){t.closeMenu(e),T.showModal(d.createElement(I.default,{learnEntityId:t.props.tile.LearnEntityId,okCallback:function(){t.props.tile.IsInStudentLibrary=!0,t.props.onTileUpdated(t.props.tile)}}))},t.removeFromStudentLibrary=function(e){t.closeMenu(e),T.showModal(d.createElement(x.default,{learnEntityId:t.props.tile.LearnEntityId,okCallback:function(){t.props.tile.IsInStudentLibrary=!1,t.props.onTileUpdated(t.props.tile)}}))},t.addToLibrary=function(e){t.closeMenu(e),T.showModal(d.createElement(k.default,{title:"Add to "+sCH.userM.getLibraryString()+"?",layerId:t.props.tile.LayerId,layers:t.props.tile.Layers,successCallback:function(){t.props.tile.Layers.forEach((function(e){e.LayerId===t.props.tile.LayerId&&(e.IsInLibrary=1)}))},okText:"Add",withCopyRightReminder:!0}))},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.props.tile.Layers.filter((function(e){return"UserLayer"===e.LayerType})),n=this.props.page===u.Page.WORKSPACE&&t.length>0,a=this.props.tile.UserId===sCH.userM.get("UserId"),s=this.props.tile.CanMergeCatalogText||t.filter((function(e){return e.CanMerge})).length>0,i=this.props.page===u.Page.LIBRARY?sCH.userM.hasManageLibraryPermissions()&&s:s,o=this.props.page===u.Page.LIBRARY?sCH.userM.hasManageLibraryPermissions():this.props.tile.FolderId>0,r=this.props.page===u.Page.LIBRARY?"Remove from "+sCH.userM.getLibraryString():"Remove from folder",l=this.props.page===u.Page.LIBRARY&&sCH.userM.hasManageLibraryPermissions()&&!this.props.tile.IsInStudentLibrary,c=this.props.page===u.Page.LIBRARY&&sCH.userM.hasManageLibraryPermissions()&&this.props.tile.IsInStudentLibrary,p=this.props.tile.Layers.find((function(t){return t.LayerId===e.props.tile.LayerId})),h="UserLayer"===this.props.tile.LayerType&&p.UserId===sCH.userM.get("UserId"),g=n&&h,f=n&&!p.IsInLibrary&&sCH.userM.hasManageLibraryPermissions(),m=n&&this.props.tile.RentalPrices&&!sCH.userM.isSchoolUsingContentCredits();if(!(a||i||o||g||m||n))return null;var y=this.state.anchorEl,_={fontFamily:"AvenirNextLTW02-Medium"},S="Videos"===this.props.tile.TextType?"video":"text";return d.createElement("div",{onClick:function(e){return e.stopPropagation()}},d.createElement(C.default,{"aria-owns":y?"tile-menu":null,"aria-haspopup":"true",onClick:this.openMenu,style:{padding:" 6px 6px 0px 6px",margin:"-6px 0px 0px -10px",minWidth:10}},d.createElement("span",{className:"icon-moreactions"})),d.createElement(v.default,{id:"tile-menu",anchorEl:y,open:Boolean(y),onClose:this.closeMenu},a&&d.createElement(b.default,{onClick:this.edit,style:_},"Edit "+S+" details"),i&&d.createElement(B,{onSelect:this.merge,tile:this.props.tile,userLayers:t}),l&&d.createElement(b.default,{onClick:this.addToStudentLibrary,style:_},"Add to Student Library"),c&&d.createElement(b.default,{onClick:this.removeFromStudentLibrary,style:_},"Remove from Student Library"),o&&d.createElement(b.default,{onClick:this.remove,style:_},r),g&&d.createElement(U,{onSelect:this.delete,tile:this.props.tile,userLayers:t}),m&&d.createElement(b.default,{onClick:this.buyRentalLicenses,style:_},"Buy rental licenses"),n&&d.createElement(b.default,{onClick:this.shareLayer,style:_},"Share a copy"),f&&d.createElement(b.default,{onClick:this.addToLibrary,style:_},"Add to "+sCH.userM.getLibraryString())))},t}(d.Component),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={anchorEl:null},t.handleClick=function(e){e.stopPropagation(),t.props.userLayers.length>1?t.setState({anchorEl:e.currentTarget}):t.props.onSelect({Layer:t.props.userLayers[0],Title:t.props.tile.sanitizedTitle})},t.layerSelected=function(e,n){t.handleClose(e),t.props.onSelect(n)},t.handleClose=function(e){e.stopPropagation(),t.setState({anchorEl:null})},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.state.anchorEl;return d.createElement("div",null,d.createElement(b.default,{style:{fontFamily:"AvenirNextLTW02-Medium"},"aria-owns":t?"fade-menu":null,"aria-haspopup":"true",onClick:this.handleClick},"Merge assignment"),d.createElement(v.default,{id:"fade-menu",anchorEl:t,getContentAnchorEl:null,open:Boolean(t),onClose:this.handleClose,anchorOrigin:{vertical:"bottom",horizontal:"right"}},this.props.userLayers.map((function(t,n){if(e.props.tile.CanMergeCatalogText||t.CanMerge){var a=p.getUserLayerTitle(t.Labels),s={Layer:t,Title:e.props.tile.sanitizedTitle+" ("+a+")"};return d.createElement(b.default,{key:n,onClick:function(t){return e.layerSelected(t,s)}},a)}}))))},t}(d.Component),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={anchorEl:null},t.handleClick=function(e){e.stopPropagation(),t.props.userLayers.length>1?t.setState({anchorEl:e.currentTarget}):t.props.onSelect(t.props.userLayers[0])},t.layerSelected=function(e,n){t.handleClose(e),t.props.onSelect(n)},t.handleClose=function(e){e.stopPropagation(),t.setState({anchorEl:null})},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.state.anchorEl;return d.createElement("div",null,d.createElement(b.default,{style:{fontFamily:"AvenirNextLTW02-Medium"},"aria-owns":t?"fade-menu":null,"aria-haspopup":"true",onClick:this.handleClick},"Delete"),d.createElement(v.default,{id:"fade-menu",anchorEl:t,getContentAnchorEl:null,open:Boolean(t),onClose:this.handleClose,anchorOrigin:{vertical:"bottom",horizontal:"right"}},this.props.userLayers.map((function(t,n){var a=p.getUserLayerTitle(t.Labels);return d.createElement(b.default,{key:n,onClick:function(n){return e.layerSelected(n,t)}},a)}))))},t}(d.Component),$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={savedForLater:t.props.tile.SavedForLater},t.toggleSaveForLater=function(e){e.stopPropagation();var n=t.state.savedForLater?"unsave":"save",a=t;g.SaveForLater({learnEntityId:t.props.tile.LearnEntityId,action:n},(function(){a.setState({savedForLater:!a.state.savedForLater}),"unsave"===n&&Backbone.pubEv.trigger("unsavedForLater",{learnEntityId:a.props.tile.LearnEntityId})}))},t}return s(t,e),t.prototype.render=function(){var e,t=this.state.savedForLater?"icon-star-filled":"icon-star-outline",n=p.classNames(((e={btnSaveForLater:!0})[t]=!0,e));return!sCH.userM.isAnonUser()&&d.createElement("button",{className:n,onClick:this.toggleSaveForLater,"aria-label":"Save For Later"})},t}(d.Component),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isDisabled:!1},t.assign=function(e){if(e){if(e.stopPropagation(),t.state.isDisabled)return;var n=t;t.setState({isDisabled:!0},(function(){window.setTimeout((function(){n.setState({isDisabled:!1})}),1e3)}))}var a=t.props.tile,s={LearnEntityId:a.LearnEntityId,LayerId:a.LayerId,IsUserLayer:"UserLayer"===a.LayerType,NewLayerSource:"UserLayer"!==a.LayerType?0===window.location.hash.indexOf("#teacher/catalog/library")?"AddFromSchoolLibrary":"AddFromCatalog":void 0,Title:a.sanitizedTitle,RentalPrices:a.RentalPrices,Publisher:a.Publisher,IsTextToSpeechDisabled:a.IsTextToSpeechDisabled,IsLearnEntityPurchased:"UserLayer"===a.LayerType,Territories:a.Territories};!a.RentalPrices||s.IsLearnEntityPurchased?(i.default.showCreateFirstClassPopup((function(){i.default.showAssignLayerPopup(s)})),Backbone.pubEv.once("createdUserLayer",(function(e){a.LayerId=e.layerId,a.LayerType="UserLayer",a.Layers.unshift({IsQuiz:0,LayerId:e.layerId,LayerType:"UserLayer",LearnEntityId:a.LearnEntityId,NoteTagCount:a.NoteTagCount,QuestionTagCount:a.QuestionTagCount,IsAssigned:e.isAssigned,Labels:[]}),t.props.onTileUpdated(a)})),Backbone.pubEv.on("layerUnassignedFromAllClasses",(function(){a.Layers[0].IsAssigned=0,t.props.onTileUpdated(a)}))):(new Backbone.BootstrapModal({title:s.Title,content:new r.default({textM:s,source:u.LearnEntityPurchaseSource.CATALOG_TILE}),okText:sCH.userM.isSchoolUsingContentCredits()?"Ok":"Rent",cssClass:"modal-lg modal-al-payment-form",allowCancel:!1}).open(),Backbone.pubEv.once("purchasedText",(function(e){a.LayerId=e,a.LayerType="UserLayer",a.Layers.unshift({IsQuiz:0,LayerId:e,LayerType:"UserLayer",LearnEntityId:a.LearnEntityId,NoteTagCount:a.NoteTagCount,QuestionTagCount:a.QuestionTagCount,Labels:[]}),t.props.onTileUpdated(a),t.assign(null)})))},t}return s(t,e),t.prototype.render=function(){var e,t=this.props.tile,n=y(((e={})["icon-plus"]=!0,e.btnAssignToClasses=!0,e.disabled=this.state.isDisabled,e));return!sCH.userM.isAnonUser()&&(!window.isIOSApp||null===t.RentalPrices)&&d.createElement(w.default,{title:"Assign to classes"},d.createElement("button",{className:n,onClick:this.assign}))},t}(d.Component),F=function(e){return e.isInStudentLibrary?d.createElement(w.default,{title:d.createElement("span",{dangerouslySetInnerHTML:{__html:"Added to Student Library"}})},d.createElement("span",{"data-container":"body",className:"icon-student no-hover"})):null},G=function(e){var t=e.questionTagCount,n=e.noteTagCount,a=e.hasExtraHelp,s=[];return t>0&&s.push(t+" questions"),n>0&&s.push(n+" notes"),a>0&&s.push("<br/> includes Extra Help scaffolding"),s.length>0&&d.createElement(w.default,{title:d.createElement("span",{dangerouslySetInnerHTML:{__html:s.join(", ")}})},d.createElement("span",{"data-container":"body",className:a?"icon-extra-help-layer no-hover":"icon-layer no-hover"}))},q=function(e){var t=e.tile,n="watermark subject-19 unit-206";return t.IsQuiz||1===t.Type?d.createElement("div",{className:"watermark quiz"},"Quiz"):(t.GenreId&&(n="watermark genre-"+t.GenreId),d.createElement("div",{className:n}))},V=function(e){var t=e.tile,n=e.page,a=t.LayerLabels;return n!==u.Page.WORKSPACE&&n!==u.Page.LIBRARY||(a=[],t.Layers.forEach((function(e){e.Labels&&e.Labels.length>0&&a.push(e.Labels.join("<br>"))}))),a&&a.length>0?d.createElement("div",{className:"label"},a.map((function(e,t){return d.createElement("span",{key:e,dangerouslySetInnerHTML:{__html:p.sanitize(e)}})}))):null},z=function(e){var t=e.tile,n=t.Layers?re(t.Layers):{},a=null;return n.IsAssigned?a={cssClass:"banner assigned",text:"Assigned"}:n.CoauthorList?a={cssClass:"banner coauthored",title:"Co-authoring this assignment with "+n.CoauthorList,text:"Co-authoring"}:n.SharedBy?a={cssClass:"banner sharedBy",title:p.sanitize(n.SharedBy)+" shared this with you",text:"From "+p.sanitize(n.SharedBy)}:t.InBookshelf?a={cssClass:"banner added",text:"Added"}:t.FinishDate?a={cssClass:"banner finished",title:"You finished reading this",text:"Finished"}:t.IsRecommended?a={cssClass:"banner recommendedBy",title:p.sanitize(t.RecommendedBy)+" shared this with you",text:"From "+p.sanitize(t.RecommendedBy)}:void 0!==t.NumOfResponses&&t.QuestionTagCount-t.NumOfResponses>0?a={cssClass:"banner unanswered",title:"Number of questions unanswered",text:t.QuestionTagCount-t.NumOfResponses+" Unanswered"}:void 0!==t.ResearchCoauthorCount&&t.ResearchCoauthorCount>0&&(a={cssClass:"banner researchcoauthorcount",title:"Co-researching this text with "+p.plural(t.ResearchCoauthorCount,"%count peer.","%count peers."),text:"Co-researching"}),a?d.createElement(w.default,{title:a.title},d.createElement("div",{className:a.cssClass},a.text)):null},Q=function(e){var t=e.tile,n=t.ShowAuthorOnTile?t.Author:t.UserId===sCH.userM.get("UserId")?t.Publisher:void 0;return d.createElement("div",{className:"overlay"},d.createElement("div",{className:"titleDesc"},d.createElement("div",{className:"title",dangerouslySetInnerHTML:{__html:t.sanitizedTitle}}),!!n&&d.createElement("div",{className:"author",dangerouslySetInnerHTML:{__html:p.sanitize(n)}}),t.IsHeroTile&&t.Description&&d.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:t.Description}}),t.IsHeroTile&&!!t.EssentialQuestion&&d.createElement("div",{className:"metadata"},d.createElement("div",{className:"eqTitle"},"Essential Question"),d.createElement("div",{className:e.eqClasses},t.EssentialQuestion))),t.IsPlaceholder&&d.createElement("div",{className:"placeholder"},d.createElement("span",{className:"helperText"},"Not yet available - click to request")),e.tile.IsHeroTile&&d.createElement(M,{tile:e.tile,onTileUpdated:e.onTileUpdated}))},W=function(e){function t(t){var n=e.call(this,t)||this;return n.hideImage=n.hideImage.bind(n),n.state={display:!0},n}return s(t,e),t.prototype.hideImage=function(){this.setState({display:!1})},t.prototype.render=function(){var e=this;if(this.state.display&&this.props.tile.CoverArt){var t=p.sanitize(this.props.tile.CoverArt);return this.props.tile.CoverArtContainsTitle?d.createElement("div",{className:"coverArtWrapper containsTitle",style:{backgroundImage:"url("+t+")"}},d.createElement("div",{className:"transparentBackground"}),d.createElement("img",{src:t,onError:function(){return e.hideImage()},alt:this.props.tile.sanitizedTitle}),"Videos"===this.props.tile.TextType&&d.createElement("div",{className:"videoTile icon-play"})):d.createElement("div",{className:"coverArtWrapper",style:{backgroundImage:this.props.tile.IsHeroTile?"linear-gradient(to top, #000, rgba(0, 0, 0, 0.05), transparent 100px), url("+t+") ":"url("+t+") ",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}},this.props.tile.TileLabel&&d.createElement("div",{className:"tileLabel"},this.props.tile.TileLabel.toUpperCase()),this.props.tile.IsHeroTile&&d.createElement(z,{tile:this.props.tile}),this.props.tile.Category&&d.createElement("div",{className:"category"},this.props.tile.Category),!this.props.tile.IsHeroTile&&"Videos"===this.props.tile.TextType&&d.createElement("div",{className:"videoTile icon-play"}))}return null},t}(d.Component),Y=function(e){switch(e.length){case 0:return null;case 1:return p.toOrdinal(e[0]);default:return Math.min.apply(Math,e)+"-"+p.toOrdinal(Math.max.apply(Math,e))}},K=function(e){e.Color=alcfg.tileColors[e.LearnEntityId%alcfg.tileColors.length]},J=function(e,t,n){if([u.Page.WORKSPACE,u.Page.CATALOG,u.Page.LIBRARY].indexOf(t)>-1){var a=t===u.Page.LIBRARY?oe(e.Layers):re(e.Layers);e.LayerId=a.LayerId,e.LayerType=a.LayerType,"UserLayer"===a.LayerType?(e.SharedByDisabled=a.SharedByDisabled,t=u.Page.WORKSPACE):["CatalogLayer","DefaultLayer"].indexOf(a.LayerType)>-1&&(t=u.Page.CATALOG)}switch(e.sanitizedTitle=e.Title,t){case u.Page.CATALOG:return Z(e);case u.Page.IRCATALOG:return se(e);case u.Page.WORKSPACE:return X(e);case u.Page.LIBRARY:return ee(e);case u.Page.ASSIGNMENTS:return te(e,n);case u.Page.INSTRUCTION_REPORT:return ie(e);case u.Page.RESEARCH:return ne(e);case u.Page.BOOKSHELF:return ae(e);default:return e}},Z=function(e){return e.Author=e.ShowAuthorOnTile?p.truncate(e.Author,40):null,e.sanitizedTitle=p.sanitize(p.truncate(e.Title,105)),e.EssentialQuestion=e.EssentialQuestion?p.truncate(e.EssentialQuestion,145):null,e.IsPlaceholder||e.Link||(e.Link=1===e.Type||"Videos"===e.TextType?"#teacher/reader/authoring/preview/"+e.LayerId:"#teacher/reader/authoring/preview/"+e.LayerId+"/notes"),K(e),e},X=function(e){var t=e.UserId===sCH.userM.get("UserId")&&e.Author,n=e.ShowAuthorOnTile||t;return e.Author=n?p.truncate(e.Author,40):null,e.sanitizedTitle=n?p.sanitize(p.truncate(e.Title,80)):p.sanitize(p.truncate(e.Title,105)),e.Link=1===e.Type||"Videos"===e.TextType?"#teacher/reader/authoring/"+e.LayerId:"#teacher/reader/authoring/"+e.LayerId+"/notes",K(e),e},ee=function(e){return e.Author=0===e.Type?p.truncate(e.Author,40):null,e.sanitizedTitle=p.sanitize(p.truncate(e.Title,105)),e.Link=1===e.Type||"Videos"===e.TextType?"#teacher/reader/authoring/preview/"+e.LayerId:"#teacher/reader/authoring/preview/"+e.LayerId+"/notes",K(e),e},te=function(e,t){e.Id=e.AssignmentId,e.Author=0===e.Type?p.truncate(e.Author,20):null,e.sanitizedTitle=p.sanitize(p.truncate(e.Title,78));var n="student"===sCH.userM.get("Role")?e.AssignmentId+(0===e.Type&&"Videos"!==e.TextType?"/notes":""):"grading/"+e.AssignmentId+(1===e.Type||sCH.userM.isOnFreePlan()?"/grading":"/data");if((e.Link=c.roleForUrl()+"/reader/"+n,K(e),"student"!==sCH.userM.get("Role"))&&m.isNotificationsEnabled(t.Settings,e.Settings)){var a=t.NotificationsByAssignment||{},s=m.getNotificationsTooltip(a,e.AssignmentId),i=s.count,o=s.tooltip;e.NotificationCount=i,e.NotificationTooltip=o}var r=m.getLockedTooltip(e.LockStartDate,e.LockEndDate,e.UnlockStartDate,e.UnlockEndDate),l=r.isLocked,d=r.tooltip;return e.IsLocked=l,e.LockStateTooltip=d,e.AssignedDateDisplay=e.CreateDate?_(_.utc(e.CreateDate).local().toDate()).format("MM/DD/YY"):"",e},ne=function(e){return e.Id=e.StudentLayerId,e.Author=p.truncate(e.Author,20),e.sanitizedTitle=p.sanitize(p.truncate(e.Title,78)),e.Link="#student/reader/research/"+e.StudentLayerId+"/notes",e.ResearchCoauthorCount=e.CoauthorIds.length,K(e),e},ae=function(e){return e.Id=e.StudentLayerId,e.Author=p.truncate(e.Author,20),e.sanitizedTitle=p.sanitize(p.truncate(e.Title,78)),e.Link=e.IsReadable?"#student/reader/ir/"+e.StudentLayerId+"/notes":decodeURIComponent(e.ContentUrl),e.RecommendedBy=(e.RecommendedByTitle||p.sanitize(e.RecommendedByFirstName))+" "+p.sanitize(e.RecommendedByLastName),e.ViewingBookshelf=!0,K(e),e},se=function(e){return e.Id=e.LearnEntityId,e.Author=0===e.Type?p.truncate(e.Author,20):null,e.sanitizedTitle=p.sanitize(p.truncate(e.Title,78)),K(e),e},ie=function(e){return e.Id=e.LayerId,e.Author=0===e.Type?p.truncate(e.Author,20):null,e.Link="#teacher/reader/authoring/preview/"+e.LayerId+"/notes/?showAuthoringActions=false",e.IsReadable=!1,K(e),e},oe=function(e){var t=e.filter((function(e){return e.IsInLibrary}));return re(t)},re=function(e){var t={UserLayer:0,CatalogLayer:1,DefaultLayer:2},n=f.orderBy(e,"UpdateDate","desc").sort((function(e,n){return t[e.LayerType]-t[n.LayerType]}));return n[0].SharedByDisabled?n.filter((function(e){return!e.SharedByDisabled}))[0]||n[0]:n[0]||{}};t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(111),o=n(87);t.sortTiles=function(e,t){return"recency"===e?t=t.sort((function(e,t){var n=i(e.UpdateDate);return i(t.UpdateDate)-n})):"title"===e?t=t.sort((function(e,t){return o(e.Title.replace("A ","").replace("An ","").replace("The ","").toLowerCase(),t.Title.replace("A ","").replace("An ","").replace("The ","").toLowerCase())})):"author"===e?t=t.sort((function(e,t){if(e.Author===t.Author){var n=i(e.UpdateDate);return i(t.UpdateDate)-n}try{var a=e.Author.trim().split(" "),s=t.Author.trim().split(" ");return a[a.length-1].trim().localeCompare(s[s.length-1].trim())}catch(n){return(e.Author||"").localeCompare(t.Author)}})):"label"===e&&(t=t.sort((function(e,t){var n=0===e.LayerLabels.length?"zzzz":e.LayerLabels[0].replace("A ","").replace("An ","").replace("The ","").toLowerCase(),a=0===t.LayerLabels.length?"zzzz":t.LayerLabels[0].replace("A ","").replace("An ","").replace("The ","").toLowerCase();return o(n,a)}))),t},t.searchTiles=function(e,t){return s.filter(t,(function(t){var n=(t.Title||"").trim().toLowerCase(),a=(t.Author||"").trim().toLowerCase(),s=(t.Publisher||"").trim().toLowerCase();return n.indexOf(e)>=0||a.indexOf(e)>=0||s.indexOf(e)>=0}))},t.isNotificationsEnabled=function(e,t){var n,a=!0;e&&(a=!(n=JSON.parse(e)).reading||n.reading.Notifications);t&&(a=!(n=JSON.parse(t)).reading||n.reading.Notifications);return a},t.getNotificationsTooltip=function(e,t){var n=0,a="";if(e[t]){var s=e[t],i=s.QuestionResponseResetRequest?s.QuestionResponseResetRequest.split(",").length:0,o=s.Comprehension?s.Comprehension.split(",").length:0,r=s.FlagResponse?s.FlagResponse.split(",").length:0;(n=i+o+r)>0&&(i&&(a+="<div class='noBreak'>Revision requests: <span class='count'>"+i+"</span></div>"),o&&(a+="<div class='noBreak'>Don't understand flags: <span class='count'>"+o+"</span></div>"),r&&(a+="<div class='noBreak'>Don't understand flag's replies: <span class='count'>"+r+"</span></div>"))}return{count:n,tooltip:a}},t.getLockedTooltip=function(e,t,n,s){var o=a.getAssignmentLockState({lockStartDate:e,lockEndDate:t,unlockStartDate:n,unlockEndDate:s,currentUtc:i.utc()}),r=!1,l="";return o.isLockExpired||!e&&!n||(r=o.isLocked,l=e?"Lock start: "+i(i.utc(e).toDate()).format("MM/DD/YY h:mm a")+(t?"<br>Lock end: "+i(i.utc(t).toDate()).format("MM/DD/YY h:mm a"):""):"Unlock start: "+i(i.utc(n).toDate()).format("MM/DD/YY h:mm a")+(s?"<br>Unlock end: "+i(i.utc(s).toDate()).format("MM/DD/YY h:mm a"):"")),{isLocked:r,tooltip:l}},t.formatSecondsToTime=function(e){if(e){var t=new Date(1e3*e),n=t.getUTCHours(),a=t.getUTCMinutes(),s=r(t.getUTCSeconds());return n?n+":"+r(a)+":"+s:a+":"+s}return"00:00"};var r=function(e){return("0"+e).slice(-2)}},,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24),i=n(10),o=n(5),r=n(336),l=n(34),d=n(168),c=n(276),u=n(1449),p=n(496),h=n(742),g=n(1450),f=n(10),m="This information also sets the standards for the assignment.",v=2;t.default=function(t){var n=a.useState(t.title),r=n[0],c=n[1],g=a.useState(""),y=g[0],_=g[1],S=a.useState(window.addGoogleDoc?window.addGoogleDoc.title:""),w=S[0],T=S[1],I=a.useState(""),x=I[0],k=I[1],E=a.useState(""),N=E[0],A=E[1],M=a.useState(window.addGoogleDoc?t.infoText:""),H=M[0],R=M[1],P=a.useState(null),D=P[0],L=P[1],O=a.useState(""),B=O[0],U=O[1],j=a.useState(""),F=j[0],G=j[1],q=a.useState(window.addGoogleDoc),V=q[0],z=q[1],Q=a.useState(!1),W=Q[0],Y=Q[1],K=a.useState(!1),J=K[0],Z=K[1],X=t.mode,ee=t.numOfBYOCInMonth,te="ir"===X?!(D&&V):!V,ne=a.useRef(null),ae="research"!==X&&"ir"!==X&&sCH.userM.isOnFreePlan()&&(!V||!!window.addGoogleDoc);return a.useEffect((function(){"ir"===X&&i.GetGenres((function(e){return L(e)}))}),[]),a.useEffect((function(){te||window.addGoogleDoc||W||ne.current.enableOkButton("Done")}),[te]),a.useEffect((function(){W&&(J?ne.current.enableOkButton("Done"):ne.current.disableOkButton("Done"))}),[J,W]),a.createElement(s.default,{title:r,cssClass:t.cssClass,okText:t.okText,okCallback:V?function(){var e,n,a="student"===sCH.userM.get("Role")?t.classId:-1,r=parseInt($(".folder.selected").data("folderid"))||void 0;window.addGoogleDoc&&(e=window.addGoogleDoc.oauthToken,n=window.addGoogleDoc.docId);var l={url:y,googleDocId:n,title:w,author:x,skillBucketId:F,googleToken:e,classId:a,genreId:B,gradeLevelId:N,folderId:r};W&&(l.copyrightReminderChecked=J),i.AddOnlineText(l,(function(e){window.addGoogleDoc?(o.intercom("trackEvent","workspace-add-googledoc"),o.intercom("trackEvent","workspace-add-byoc"),delete window.addGoogleDoc):(o.intercom("trackEvent","workspace-add-onlinearticle"),o.intercom("trackEvent","workspace-add-byoc")),e.Success?(o.bootstrap.alert({message:"An article has been added"+("ir"===self.mode||"research"===self.mode?"!":" to your Imports!")}),Backbone.pubEv.trigger("textImported")):o.bootstrap.alert({message:"Unable to add article. "+(404===e.status?"Please check the URL.":"")+"\n                If this problem persists, please contact us at help@activelylearn.com",alert:"danger"}),clearTimeout(d),s.hideModals()}),X,window.addGoogleDoc);var d=window.setTimeout((function(){Backbone.pubEv.trigger("loadingShowHide",!1),o.bootstrap.alert({message:alcfg.alertsText.addFromOnlineTimeout,alert:"danger"}),s.hideModals()}),1e4)}:function(t){var n=y.trim();-1===y.indexOf("http://")&&-1===y.indexOf("https://")&&_(n="http://"+n);var a=new e((function(e){"student"===sCH.userM.get("Role")?e(0):f.GetImportCountFromSourceForMonth({userId:sCH.userM.get("UserId"),url:n},(function(t){return e(t)}))})),s=new e((function(e){$.embedly.extract(n,{key:alcfg.embedlyKey}).progress((function(t){return e(t)}))}));e.all([a,s]).then((function(e){var n=e,a=n[0],s=n[1];if(404===s.error_code)return o.bootstrap.alert({message:"404 - not found. Check the URL entered.",alert:"danger"}),void t.enableOkButton("Next");var i=s&&s.authors?o.capitalizeString(s.authors.length?s.authors[0].name:s.provider_name):"",r=s&&s.title?s.title:"";a===v&&Y(!0),c("Update information for tile"),R(m),k(i),T(r),z(!0)}))},disabledOkText:V?"Adding Text...":"Processing Text...",customValidations:[{name:"checkUrl",func:d.checkUrl},{name:"isPDFURL",func:d.isPDFURL},{name:"isAtlanticURL",func:d.isAtlanticURL},{name:"isDogoNewsURL",func:d.isDogoNewsURL}],cancelCallback:function(){window.addGoogleDoc&&delete window.addGoogleDoc,s.hideModals()},cancelText:"Cancel",allowCancel:!1,ref:ne},"research"!==X&&"ir"!==X&&H&&a.createElement("p",{className:"description"},H),!window.addGoogleDoc&&a.createElement(l.TextValidator,{id:"txtUrl",label:"URL",disabled:V,value:y,onChange:function(e){return _(e.target.value)},autoFocus:!V,validators:{checkUrl:"Not a valid Url",isPDFURL:"",isAtlanticURL:"",isDogoNewsURL:""},fullWidth:!0,required:!0}),te?a.createElement(b,{mode:X,showPopularResources:function(){s.showModal(a.createElement(u.default,null))}}):a.createElement(C,{textTitle:w,setTextTitle:T,txtAuthor:x,setTxtAuthor:k,mode:X,gradeLevel:N,setGradeLevel:A,genre:B,genres:D,setGenre:U,contentType:F,setContentType:G}),a.createElement(p.default,{numOfBYOCInMonth:ee,isVisible:ae}),W&&a.createElement(h.default,{checked:J,setChecked:Z}))};var b=function(e){var t=e.mode,n=e.showPopularResources;return"research"!==t&&"ir"!==t&&a.createElement(a.Fragment,null,a.createElement("p",null,"Try our",a.createElement("a",{className:"infoLink btnBrowserExtensionLink",href:"https://chrome.google.com/webstore/detail/actively-learn/nlbkibinmokcmlplcghbhhnkiemefmcm",target:"_blank",rel:"noopener"},"browser extension")," to make it faster to import articles."),a.createElement("p",null,"For resource ideas, see",a.createElement("a",{className:"btnPopularResources infoLink",href:"javascript:void(0)",onClick:n},"what's popular"),"."))},C=function(e){var t=e.textTitle,n=e.setTextTitle,s=e.txtAuthor,i=e.setTxtAuthor,o=e.mode,d=e.gradeLevel,u=e.setGradeLevel,p=e.genre,h=e.genres,f=e.setGenre,m=e.contentType,v=e.setContentType;return a.createElement("div",{className:"articleDetails"},a.createElement(l.TextValidator,{id:"txtTitle",label:"Title",value:t,onChange:function(e){return n(e.target.value)},required:!0,autoFocus:!0,fullWidth:!0}),a.createElement(l.TextValidator,{id:"txtAuthor",label:"Author",value:s,onChange:function(e){return i(e.target.value)},required:"Please enter the author name",fullWidth:!0}),a.createElement("div",{className:"unitSelectorContainer"},"ir"===o&&a.createElement(a.Fragment,null,a.createElement(r.default,{gradeLevelId:d,onChange:function(e){return u(e.target.value)},showGradeLevelAsRange:!0,isHigherEd:sCH.userM.get("IsHigherEd")}),a.createElement(g.default,{genre:p,genres:h,setGenre:f})),"research"!==o&&"ir"!==o&&a.createElement(c.default,{contentType:m,onChange:function(e){return v(e.target.value)}})))}}).call(this,n(21))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),l=n(0),d=n(5),c=n(346),u=n(1455),p=n(14),h=n(760),g=n(743),f=function(e){function t(t,n){var a=e.call(this,t)||this;return a.configureTabbingAndOpacityForCarousel=function(){var e=a.containerRef.current.querySelectorAll(".slick-slide.slick-active");if(e&&e.length>0){var t=void 0;for(t=0;t<e.length-1;t++)e[t].style.opacity=1,e[t].style["pointer-events"]="auto",a.setTabIndex(e[t],"a","0"),a.setTabIndex(e[t],"button","0");var n=e[t];n.style.opacity=.5,n.style["pointer-events"]="none";var s=a.containerRef.current.querySelectorAll(".slick-slide[aria-hidden='true']");s=(s=Array.prototype.slice.call(s)).concat(n);for(var i=0;i<s.length;i++)a.setTabIndex(s[i],"a","-1"),a.setTabIndex(s[i],"button","-1")}},a.setTilesPerRow=function(){if(a.containerRef.current&&document.querySelector(".slick-list")){var e=a.getTilesPerRow(),t=e[0],n=e[1];a.setState({tilesPerRow:t,maxTiles:n}),a.setTabIndex(a.containerRef.current,".slick-dots button","-1"),a.setTabIndex(a.containerRef.current,".slick-list","0")}},a.getTilesPerRow=function(){var e=document.querySelector(".slick-list").clientWidth,t=3;if(e<=480)t=1;else{var n=a.containerRef.current.querySelector(".slick-slide").offsetWidth,s=n-a.containerRef.current.querySelector(".tile,.topictile").offsetWidth;t=Math.floor((e-80+s)/n)}return[t,10*t-1]},a.state={tilesPerRow:3,maxTiles:40,shouldShowCarousel:a.props.shouldShowCarousel},a.containerRef=l.createRef(),a.setTilesPerRow=r.debounce(a.setTilesPerRow,100),a}return s(t,e),t.prototype.componentWillMount=function(){this.state.shouldShowCarousel&&(Backbone.pubEv.on("mainMenuToggled",this.setTilesPerRow),window.addEventListener("resize",this.setTilesPerRow))},t.prototype.componentWillUnmount=function(){this.state.shouldShowCarousel&&(window.removeEventListener("resize",this.setTilesPerRow),Backbone.pubEv.off("mainMenuToggled",this.setTilesPerRow))},t.prototype.componentDidMount=function(){this.state.shouldShowCarousel?this.setTilesPerRow():(this.setState({tilesPerRow:3}),document.querySelector(".scroll").scrollTop=0)},t.prototype.componentDidUpdate=function(e){var t=this;this.props.shouldShowCarousel!==e.shouldShowCarousel&&this.setState({shouldShowCarousel:this.props.shouldShowCarousel},(function(){t.state.shouldShowCarousel&&t.setTilesPerRow()})),this.props.tiles!==e.tiles&&this.sliderRef&&this.sliderRef.slickGoTo(0,!0),setTimeout((function(){t.containerRef.current&&t.configureTabbingAndOpacityForCarousel()}),50)},t.prototype.setTabIndex=function(e,t,n){for(var a=e.querySelectorAll(t),s=0;s<a.length;s++)a[s].setAttribute("tabindex",n)},t.prototype.render=function(){var e=this,t=this.props,n=t.bucketTitle,a=t.viewMoreLinkObj,s=t.isTopicTileBucket,f=!1;a&&(f=a.topicUrl||a.topicBucketSlug&&this.props.tiles.length>this.state.maxTiles);var v=this.state.shouldShowCarousel?this.props.tiles.slice(0,this.state.maxTiles):this.props.tiles;p.topicBucketsToSortByRecency.indexOf(n)>-1&&(v=r.orderBy(v,"CreateDate","desc"));var b=d.classNames({tiles:!0,tilesGridView:!this.state.shouldShowCarousel,tilesCarouselView:this.state.shouldShowCarousel,viewMore:v.length>this.state.tilesPerRow}),C=v.map((function(t,n){return s?l.createElement(g.default,{data:t,key:t.TopicId}):l.createElement(c.default,{data:t,key:t.LearnEntityId+"_"+n,page:e.props.page})})),y={dots:!0,infinite:!1,speed:500,slidesToShow:this.state.tilesPerRow+1,slidesToScroll:this.state.tilesPerRow<=0?1:this.state.tilesPerRow,variableWidth:!0,lazyLoad:!0,beforeChange:function(t,n){for(var a=n+e.state.tilesPerRow,s=e.containerRef.current.querySelectorAll(".slick-slide"),i=0;i<s.length;i++)s[i].style.opacity=1;a<=v.length&&(e.containerRef.current.querySelector('.slick-slide[data-index="'+a+'"]').style.opacity=.5),e.containerRef.current.querySelector(".slick-list").focus(),setTimeout((function(){e.containerRef.current&&e.configureTabbingAndOpacityForCarousel()}),500)}};return C.length>0&&l.createElement("div",{className:"bucketContainer",ref:this.containerRef},l.createElement("div",{className:"featured"},l.createElement(m,{title:n,linkObj:a})),l.createElement("div",{className:b},this.state.shouldShowCarousel?l.createElement(h.default,i({},y,{ref:function(t){return e.sliderRef=t}}),o(C,f?[l.createElement(u.default,{key:"viewMoreTile",tiles:v,linkObj:a,category:n,isTopicTileBucket:s}),l.createElement("div",{key:"emptyDiv"})]:[l.createElement("div",{key:"emptyDiv"})])):C))},t}(l.Component),m=function(e){var t=e.title,n=e.linkObj,a=function(){n&&(n.topicBucketSlug?Backbone.pubEv.trigger("topicBucketChanged",n.topicBucketSlug):window.location.hash=n.topicUrl)};return n?t?l.createElement("a",{href:"javascript:void(0)",onClick:function(){return a()},className:"viewMoreLink"},t):l.createElement("a",{href:"javascript:void(0)",onClick:function(){return a()},className:"viewMoreLink"},"Bucket"):t?l.createElement("div",null,t):l.createElement("div",null,"Bucket")};t.default=f},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCssClassNames=function(e){var t=e.iconClass,n=e.comingSoonProperty,a=e.isCompleted,s=e.isFree,i=e.isMicrocredential,o=[t],r=-1===parseInt(n,10);return s?o.push("free"):r?o.push("comingsoon"):a&&(o.push("completed"),i&&o.push("disabled")),{classNames:o.join(" "),comingSoonText:r?"Coming soon!":null}}},,,,function(e,t){e.exports=pdfjsLib},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(85),o=n(446);t.initialize=function(){this.readingTime=0,this.isVideo="video"===sCH.learnEntitySectionsMetaC.getModelBySectionId(sCH.readerConfig.currentSectionId).get("Type"),this.recordInterval=10,this.activeInterval=90,this.sendInterval=180,this.sleepInterval=5e3,this.sleepLastUpdated=(new Date).getTime(),this.idle=!1,this.didSomething=!1;var e=this;this.sleeper=window.setInterval((function(){var t=(new Date).getTime(),n=t-e.sleepLastUpdated;n>2*e.sleepInterval&&Backbone.tracking.logNSFEvent({event:"slept",details:Math.floor(n/1e3)}),e.sleepLastUpdated=t}),e.sleepInterval),$(".reader").on(alcfg.activeEvents,(function(t){e.didSomething=!0,e.idle&&(e.idle=!1,Backbone.tracking.logNSFEvent({event:"idle stop"}))})),this.startReadingTimer()},t.startReadingTimer=function(){var e=this;this.stopReadingTimer(),"visible"===document.visibilityState&&(this.recordReadingTimeInterval=window.setInterval((function(){e.readingTime+=e.recordInterval,e.readingTime%e.activeInterval==0&&(e.didSomething||e.isVideo&&sCH.readerConfig.didVideoPlayInInterval?(sCH.readerConfig&&e.readingTime>=e.sendInterval&&e.sendReadingTimeToServer(!1),e.didSomething=!1,e.isVideo&&Backbone.pubEv.trigger("setDidVideoPlayInInterval")):(e.readingTime-=e.activeInterval,e.idle||(e.idle=!0,Backbone.tracking.logNSFEvent({event:"idle start"}))))}),1e3*this.recordInterval))},t.stopReadingTimer=function(){window.clearInterval(this.recordReadingTimeInterval)},t.sendReadingTimeToServer=function(e){sCH.readerConfig.currentSectionId<0||(this.readingTime||(this.readingTime=0),e?s.trackCurrentPosition("end",this.readingTime):this.readingTime>0&&s.trackCurrentPosition("update",this.readingTime),this.readingTime=0)},t.trackReaderClose=function(){this.stopReadingTimer(),sCH.userM&&(this.sendReadingTimeToServer(!0),sCH.userM.get("IntercomTrial")&&s.intercom("trackEvent","reader-exit",{assignmentId:sCH.readerConfig.assignmentId,studentLayerId:sCH.readerConfig.studentLayerId}),Backbone.tracking.logNSFEvent({event:"reader exit",assignmentId:sCH.readerConfig.assignmentId})),window.clearInterval(this.sleeper)},t.saveUnsentReadingTimeRequestToStorage=function(e){var t=o.get("studentReadingTimes")||[],n=e.assignmentId?a.find(t,{textSectionId:e.textSectionId,userId:e.userId,assignmentId:e.assignmentId}):a.find(t,{textSectionId:e.textSectionId,userId:e.userId,studentLayerId:e.studentLayerId});n?(n.elapsedTime+=e.elapsedTime,n.scrollTopPx=e.scrollTopPx):t.push(e),o.set("studentReadingTimes",t)},t.sendSavedReadingTime=function(){var e=o.get("studentReadingTimes");o.remove("studentReadingTimes");var t=this;e&&a.each(e,(function(e){!isNaN(e.elapsedTime)&&e.elapsedTime>0&&Backbone.tracking.saveReaderState("reading","update",e,(function(n){n.error&&(t.saveUnsentReadingTimeRequestToStorage(e),"unauthenticated"===n.error&&i.destroyAppInitDataAndRedirect({source:"readingtime save",forwardURL:window.location.hash.substr(1),forwardURLExtra:"&furlUserId="+sCH.userM.get("UserId")}))}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={env:"local",productName:"Actively Learn",productUrl:"https://www.activelylearn.com",algolia:{appId:"AM9Z6IF37B",apiKey:"c9b0f7f873d4a476a6a73f14eb723660",indexes:{schools:"al_schools_staging"}},api:"http://localhost:3000",preAuthKey:".PREAUTHLOCAL",cookieDomain:"localhost",googleApiClientId:"22729927582-ma9saksnr4jhusk1ggcp8hqa26om5ja8.apps.googleusercontent.com",ablyKey:"BQlvog.mPiSSw:TkJywEghkyNc9i_8",intercomKey:"azic0ore",stripeKey:"pk_test_hGcCTxnNucfD8epy7K4uXcNJ",maxInactiveTime:36e5}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={env:"local",productName:"Achieve3000 Math",productUrl:"https://www.achieve3000.com",algolia:{appId:"AM9Z6IF37B",apiKey:"c9b0f7f873d4a476a6a73f14eb723660",indexes:{schools:"al_schools_staging"}},api:"http://localhost:5003",preAuthKey:".PREAUTHLOCAL",cookieDomain:"localhost",ablyKey:"BQlvog.mPiSSw:TkJywEghkyNc9i_8",intercomKey:"azic0ore",maxInactiveTime:36e5,isMath:!0,mathIframeApi:"http://localhost:5000",mathIframeOrigin:"http://localhost:5001"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={env:"production",productName:"Actively Learn",productUrl:"https://www.activelylearn.com",algolia:{appId:"AM9Z6IF37B",apiKey:"c9b0f7f873d4a476a6a73f14eb723660",indexes:{schools:"al_schools_prod"}},api:"https://api.activelylearn.com",preAuthKey:".PREAUTHPROD",cookieDomain:".activelylearn.com",googleApiClientId:"22729927582-ktc3s04os90r4s1l2jq1ldovqu3flc8r.apps.googleusercontent.com",ablyKey:"vcumYA.6RvYZw:176k8vKenjCBmkpU",intercomKey:"s74jy24n",stripeKey:"pk_live_jyiywcXcAJJhKEvWvpA3HnxY",maxInactiveTime:18e5}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={env:"production",productName:"Achieve3000 Math",productUrl:"https://www.achieve3000.com",algolia:{appId:"AM9Z6IF37B",apiKey:"c9b0f7f873d4a476a6a73f14eb723660",indexes:{schools:"al_schools_prod"}},api:"https://al-api.achieve3000.com",preAuthKey:".PREAUTHPROD",cookieDomain:".achieve3000.com",ablyKey:"vcumYA.6RvYZw:176k8vKenjCBmkpU",intercomKey:"f4ae1jqb",maxInactiveTime:18e5,isMath:!0,mathIframeApi:"https://math-api-prod.achieve3000.com",mathIframeOrigin:"https://math-app.achieve3000.com"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={env:"staging",productName:"Actively Learn",productUrl:"https://www.activelylearn.com",algolia:{appId:"AM9Z6IF37B",apiKey:"c9b0f7f873d4a476a6a73f14eb723660",indexes:{schools:"al_schools_staging"}},api:"https://api-test.activelylearn.com",preAuthKey:".PREAUTHSTAGING",cookieDomain:".activelylearn.com",googleApiClientId:"22729927582-ktc3s04os90r4s1l2jq1ldovqu3flc8r.apps.googleusercontent.com",ablyKey:"BQlvog.mPiSSw:TkJywEghkyNc9i_8",intercomKey:"azic0ore",stripeKey:"pk_test_hGcCTxnNucfD8epy7K4uXcNJ",maxInactiveTime:36e5}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={env:"staging",productName:"Achieve3000 Math",productUrl:"https://www.achieve3000.com",algolia:{appId:"AM9Z6IF37B",apiKey:"c9b0f7f873d4a476a6a73f14eb723660",indexes:{schools:"al_schools_staging"}},api:"https://al-api-staging.achieve3000.com",preAuthKey:".PREAUTHSTAGING",cookieDomain:".achieve3000.com",ablyKey:"BQlvog.mPiSSw:TkJywEghkyNc9i_8",intercomKey:"azic0ore",maxInactiveTime:36e5,isMath:!0,mathIframeApi:"https://math-api-staging.achieve3000.com",mathIframeOrigin:"https://math-app-staging.achieve3000.com"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectFullStory=function(){var e,t,n,a,s,i,o,r;window._fs_namespace||(window._fs_debug=!1,window._fs_host="www.fullstory.com",window._fs_org="1BKRZ",window._fs_namespace="FS",window._fs_script="edge.fullstory.com/s/fs.js",e=window,t=document,n=window._fs_namespace,a="script",s="user",n in e&&e.console&&e.console.log?e.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].'):((o=e[n]=function(e,t){o.q?o.q.push([e,t]):o._api(e,t)}).q=[],(i=t.createElement(a)).async=1,i.src="https://"+window._fs_host+"/s/fs.js",(r=t.getElementsByTagName(a)[0]).parentNode.insertBefore(i,r),o.identify=function(e,t){o(s,{uid:e}),t&&o(s,t)},o.setUserVars=function(e){o(s,e)},o.identifyAccount=function(e,t){i="account",(t=t||{}).acctId=e,o(i,t)},o.clearUserCookie=function(e,n){for(e=t.domain;t.cookie="fs_uid=;domain="+e+";path=/;expires="+new Date(0),!((n=e.indexOf("."))<0);)e=e.slice(n+1)}))}},function(e,t,n){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0}),t.get=function(e){try{if(a.localStorageSupported()){var t=window.localStorage.getItem(e);if(t&&(!isNaN(t)||0===t.indexOf("[")||0===t.indexOf("{")))return JSON.parse(t)}return null}catch(t){return rg4js("send",{error:new Error("localStorageHelper-get"),customData:{error:t,name:e,value:window.localStorage.getItem(e)}}),null}},t.set=function(e,t,n){var s;if(a.localStorageSupported()&&(null!=e&&null!=t)){"object"==typeof t?(t.hasOwnProperty("Date")||(t.Date=(new Date).getTime()),s=JSON.stringify(t)):s=t;try{window.localStorage.setItem(e,s)}catch(t){a.resetStorageSpace(),window.localStorage.setItem(e,s)}n&&a.addToStorageLog(e)}},t.remove=function(e){a.localStorageSupported()&&window.localStorage.removeItem(e)},t.hasItem=function(e,t){if(!a.localStorageSupported())return!1;try{var n=window.localStorage.getItem(e);return null!==n&&(void 0===t||(!(t>=Math.ceil(JSON.parse(n).Date/1e3))||(window.localStorage.removeItem(e),!1)))}catch(e){return!1}},t.getStorageLog=function(){if(a.localStorageSupported()){var e=window.localStorage.getItem("StorageLog");return e||(e=JSON.stringify([]),window.localStorage.setItem("StorageLog",e)),JSON.parse(e)}return[]},t.addToStorageLog=function(e){if(a.localStorageSupported()){var t=a.getStorageLog();t.push(e),window.localStorage.setItem("StorageLog",JSON.stringify(t))}},t.resetStorageSpace=function(){if(a.localStorageSupported())for(var e=a.getStorageLog(),t=0;t<e.length;t++)a.remove(e[t])},t.localStorageSupported=function(){try{return window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),!0}catch(e){return!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(44);t.default=Backbone.Model.extend({sync:i.default,idAttribute:"TagId",defaults:function(){return{TagId:null,TextSectionId:null,UserId:null,Type:"",StartIndex:null,EndIndex:null,Text:"",HTML:"",StandardId:null,SecondStandardId:null,StandardCode:"",Dok:null,IsDeleted:null,CreateDate:null,UpdateDate:null,LayerId:null,Username:null,ImageUrl:"",IsReset:null,IsStudentReset:null,IsStudentRequestReset:null,SubType:null,RandomizeChoices:!1,ModelResponse:null,NumCorrectChoices:null}},fixUsernameField:function(){return a.sanitize(this.get("Username",!0))},fixHTMLField:function(){return a.sanitize(this.get("HTML",!0))},fixExtraHelpTextField:function(){return a.sanitize(this.get("ExtraHelpText",!0))},fixTextField:function(){return"link"===this.get("Type")?this.get("Text",!0):a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Text",!0)))},fixQuestionChoicesField:function(){var e=this.get("QuestionChoices",!0);return e?s.map(e,(function(e){return e.Text=a.sanitize(a.wrapOldTextAreaContentInPTags(e.Text)),e})):e},saveData:function(e,t){var n=this;if(this.set(e,{silent:!0}),this.hasChanged("Text")||this.hasChanged("ExtraHelpText")||this.hasChanged("HTML")||this.hasChanged("StandardId")||this.hasChanged("SecondStandardId")||this.hasChanged("Dok")||this.hasChanged("QuestionChoices")||this.hasChanged("Weight")||this.hasChanged("EndIndex")||this.hasChanged("StartIndex")||this.hasChanged("RandomizeChoices")||this.hasChanged("ModelResponse")||this.hasChanged("AllowMediaResponse")){var s=this.toJSON();a.ajax({type:"POST",url:alcfg.node.reader_authoring.edit_question,data:this.convertQuestionToLowerCaseKeys(s,t),showLoading:!1,vital:!1,onSuccess:function(e){if(e){if(n.trigger("change",n),sCH.readerSettingsM.get("IsAssigned")&&a.bootstrap.alert({message:alcfg.alertsText.changesSaved}),n.hasChanged("EndIndex")||n.hasChanged("StartIndex"))sCH.questionsNumC.findWhere({QuestionTagId:n.get("TagId")}).set({EndIndex:n.get("EndIndex"),StartIndex:n.get("StartIndex")});e.renumberedQuestionTagIds&&(sCH.questionsNumC.updateQuestionNumbers(e.renumberedQuestionTagIds),t.needToUpdateEndIndex&&sCH.teacherQuestionsC.updateQuestionEndIndex(e.renumberedQuestionTagIds))}else a.bootstrap.alert({message:alcfg.alertsText.requestFailed,alert:"danger"})}})}},convertQuestionToLowerCaseKeys:function(e,t){var n=s.map(e.QuestionChoices,(function(t){return{text:t.Text,isCorrect:t.IsCorrect,choiceNum:t.ChoiceNum,questionTagId:e.TagId}}));return{tag:s.omitBy({questionTagId:e.TagId,textSectionId:e.TextSectionId,userId:sCH.userM.get("UserId"),startIndex:e.StartIndex,endIndex:e.EndIndex,text:e.Text,html:e.HTML,subType:e.SubType,hasChoices:Boolean(e.HasChoices),dok:e.Dok,extraHelpText:e.ExtraHelpText,modelResponse:e.ModelResponse,standardId:e.StandardId,weight:e.Weight,secondStandardId:e.SecondStandardId,randomizeChoices:Boolean(e.RandomizeChoices),allowMediaResponse:Boolean(e.AllowMediaResponse)},s.isNil),questionChoices:n,layerId:sCH.readerConfig.layerId,questionResponsesActionToTake:t?t.questionResponsesActionToTake:null,shouldRenumberQuestions:!!t&&t.shouldRenumberQuestions,reorder:sCH.readerConfig.isAssessment}},deleteData:function(){this.id=this.get("TagId"),this.url=alcfg.node.reader_authoring.delete_question,this.destroy({data:{questionTagId:this.get("TagId"),isAssessment:sCH.readerConfig.isAssessment||!1,layerId:sCH.readerConfig.layerId},success:function(e,t){sCH.readerSettingsM.get("IsAssigned")&&a.bootstrap.alert({message:alcfg.alertsText.changesSaved})}})},checkUserId:function(e){return this.get("UserId")===e},updateCorrectQuestionChoices:function(e){if(2===this.get("SubType")&&e){var t=this.get("QuestionChoices");e.forEach((function(e){t.find((function(t){return t.QuestionChoiceId===e})).IsCorrect=!0})),this.set("QuestionChoices",t),this.trigger("change",this)}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(10),i=n(5);t.default=Backbone.Model.extend({sync:a.default,idAttribute:"TagId",defaults:function(){return{TagId:null,TextSectionId:null,UserId:null,Type:"marker",SubType:null,StartIndex:null,EndIndex:null,Text:"",HTML:"",IsDeleted:null,CreateDate:null,UpdateDate:null,AssignmentId:null,Username:null,ImageUrl:"",CreatedByCurrentUser:!1,HighlightedText:null,Visible:!0,AssociatedNoteTagId:null}},fixTextField:function(){return this.get("Text",!0)},saveData:function(e,t){var n=this;if(this.set(e,{silent:!0}),this.hasChanged("Text")&&"tour"!==sCH.readerConfig.type){var a={markerTagId:n.get("TagId"),layerId:n.get("LayerId"),text:e.Text};s.EditHyperlink(a,(function(t){t&&(n.set("Text",e.Text),n.set("UpdateDate",new Date))}))}},deleteData:function(){var e=this,t={data:{tagId:this.get("TagId"),tagType:"marker",assignmentId:this.get("AssignmentId")}};if("tour"===sCH.readerConfig.type)this.stopListening(),this.trigger("destroy",this,this.collection,t);else{var n={markerTagId:t.data.tagId,assignmentId:sCH.readerConfig.assignmentId,layerId:sCH.readerConfig.layerId,readerType:sCH.readerConfig.type};s.DeleteMarker(n,(function(n,a,s){n?e.trigger("destroy",e,e.collection,t):"offline"===a?e.trigger("destroy",e,e.collection,t):i.showErrorPopup()}))}},checkUserId:function(e){return this.get("UserId")===e}})},,,,,,,function(e,t){},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(1133);t.default=Backbone.Collection.extend({model:s.default,sync:a.default,fill_class:function(e){var t=this;this.fetch({url:alcfg.node.class_roster.student_list,data:e,mainSuccess:function(e){t.set(e)}})},initWithData:function(e){this.set(e)},fill_assignment:function(e){var t=this;this.fetch({url:alcfg.node.reader_grading.get_students,data:{assignmentId:e},mainSuccess:function(e){t.set(e)}})},fill_peers:function(e){var t=this;this.fetch({url:alcfg.node.independent_reading.school_peers,data:e,mainSuccess:function(n){e.queryForStudents&&t.set(n.Peers),window.ActivelyRead.existingRating=n.ExistingRating,window.ActivelyRead.existingReadingTime=n.ExistingReadingTime,window.ActivelyRead.isReadable=n.IsReadable}})}})},,,function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(34),r=n(14),l=n(39);t.default=function(e){var t=e.subjectId,n=e.handleChange,d=s(e,["subjectId","handleChange"]);return i.createElement(o.SelectValidator,a({name:"subjectId",label:"Your primary subject",value:t||"",onChange:n("subjectId"),id:"primary-subject",fullWidth:!0,required:"Please select your primary subject"},d),r.UserSubjects.map((function(e){var t=e.value,n=e.label;return i.createElement(l.default,{key:t,value:t},n)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(34),i=n(14),o=n(39);t.default=function(e){var t=e.educatorType,n=e.handleChange;return a.createElement(s.SelectValidator,{name:"educatorType",label:"Your role",fullWidth:!0,value:t||"",onChange:n("educatorType"),id:"educator-type",required:"Please select your role"},i.TeacherEducatorTypes.map((function(e){var t=e.value,n=e.label;return a.createElement(o.default,{key:t,value:t},n)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(34),i=n(14),o=n(39);t.default=function(e){var t=e.origin,n=e.originOtherText,r=e.handleChange;return a.createElement(a.Fragment,null,a.createElement(s.SelectValidator,{name:"origin",label:"How'd you hear about us?",value:t||"",onChange:r("origin"),required:"This field is required",id:"origin",fullWidth:!0},i.UserOrigin.map((function(e){var t=e.value,n=e.label;return a.createElement(o.default,{key:"title-"+t,value:t},n)}))),"other"===t&&a.createElement(s.TextValidator,{name:"originOtherText",label:"Please specify",required:"This field is required",value:n||"",onChange:r("originOtherText"),id:"origin-other",fullWidth:!0}))}},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(14);function s(e,t,n){return e.reduce((function(e,s){var i=a.teacherPracticesThresholds[t],o=s[n];return o<i.redThreshold?e[0]+=1:o>=i.greenThreshold?e[2]+=1:e[1]+=1,e}),[0,0,0])}function i(e){return e.forEach((function(e){var t=e.AssignmentsCreatedAsCoTeacher+e.AssignmentsCreated;e.writing=t>0?e.TotalWords/t:0})),s(e,"writing","writing")}t.getPracticesChartData=function(e){return[{displayName:"Feedback",label:"Teacher comments",data:s(e,"feedback","NumTeacherComment"),barColors:a.practicesChartColors},{displayName:"Annotation",label:"Student notes",data:s(e,"annotation","NumStudentNotes"),barColors:a.practicesChartColors},{displayName:"Discussion",label:"Discussion threads",data:s(e,"discussion","NumStudentSharedNotes"),barColors:a.practicesChartColors},{displayName:"Questioning",label:"DOK 2-4 questions",data:s(e,"questioning","NumQuestionAdded"),barColors:a.practicesChartColors},{displayName:"Extra Help",label:"Assignments w/ Extra Help",data:s(e,"extraHelp","NumAssignmentWithEH"),barColors:a.practicesChartColors},{displayName:"Vocabulary",label:"Word lookups",data:s(e,"vocabulary","NumStudentsLookupCount"),barColors:a.practicesChartColors},{displayName:"Metacognition",label:"Student revision",data:s(e,"metaCognition","NumRevisions"),barColors:a.practicesChartColors},{displayName:"Writing",label:"Avg. word per assignment",data:i(e),barColors:a.practicesChartColors}]},t.getStudentPerformancePieChartData=function(e){return e.reduce((function(e,t){return t.basic&&(e[0]+=t.basic),t.average&&(e[1]+=t.average),t.proficient&&(e[2]+=t.proficient),e}),[0,0,0])},t.getTotalNumberOfTeachersBySchool=function(e){return e.reduce((function(e,t){return e[t.SchoolName]?e[t.SchoolName]+=1:e[t.SchoolName]=1,e}),{})}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(1328),o=n(736),r=n(24),l=n(20),d=n(154),c=n(232);t.default={assignCompleteTemplate:n(1337),showCreateFirstClassPopup:function(e){sCH.classesC.length>0?e():sCH.userM.isNonALDemoUser()?new Backbone.BootstrapModal({title:"Cannot create a new class!",content:"In this demo account, you cannot create a new class to assign this text to.",cancelText:null,okText:"Close"}).open((function(){Backbone.pubEv.trigger("cancelSelectMode")})):r.showModalFromBackbone(o.default,{callback:e,title:"Let's create your first class!"})},showAssignLayerPopup:function(e){new Backbone.BootstrapModal({title:"Assign to classes",content:new i.default({selectedLayer:e,assignHelper:this}),allowCancel:!1,cancelText:"Cancel",okText:"Assign",cssClass:"modal-lg assignLesson",triggerBackboneEventOnCancel:"cancelSelectMode"})},showAssignLayerSuccessPopup:function(e){var t=[],n=a.uniq(a.map(e.assignmentsAdded,"ClassId")),i=!1;a.each(n,(function(n){var s=[],o=a.filter(e.assignmentsAdded,{ClassId:n});a.each(o,(function(e){var t=window.location.origin+(l.default.isMath?"/#student/mathreader?assignmentId="+e.AssignmentId:"/#student/reader/"+e.AssignmentId+(1===e.Type?"":"/notes"));s.push({assignmentName:e.Title,url:t})}));var r=sCH.classesC.findWhere({ClassId:n});t.push({className:r.get("Name"),source:r.get("Source"),externalClassId:r.get("ExternalClassId"),links:s}),"google"!==r.get("Source")||i||(i=!0)}));var o=new Backbone.BootstrapModal({title:"Assigned to classes",content:this.assignCompleteTemplate({data:t}),okText:"Close",cancelText:!1,allowCancel:!1,cssClass:"modal-lg modal-al-assigned-to-classes"}).open((function(){if(e.shouldNavigate){var t=window.location.hash.replace("preview/"+sCH.readerConfig.layerId,e.assignmentsAdded[0].LayerId)+"/?isRedirectAfterAssign=true";s.redirectUserByHash(t)}}));o.$el.on("shown.bs.modal",(function(e){new c.default(".btnCopyLink").on("success",(function(){s.bootstrap.alert({message:"The assignment's link has been copied to your clipboard. "+alcfg.alertsText.copyClipboardPasteInstruction})})),gapi.sharetoclassroom&&gapi.sharetoclassroom.go(".gShare"),i&&(window.googleHelper.oauthToken?d.createCourseWork(t):(window.googleHelper.callback=function(){d.createCourseWork(t)},gapi.auth.authorize({client_id:l.default.googleApiClientId,scope:window.googleHelper.scopes,immediate:!1,authuser:-1,user_id:sCH.userM.get("Accounts").google.ExternalUserId},window.googleHelper.handleAuthResult))),s.initTooltips(o.$el)}))}}},,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(0),r=n(748),l=n(96),d=n(39),c=n(5),u=n(65),p=Array.isArray,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={currentFilter:-1},t.filterData=function(e,t,n){var a=Date.now(),s=[],o=-1!==n?e.filter((function(e){return p(e.filterBy)?e.filterBy.filter((function(e){return e===n})).length>0:e.filterBy===n})):e;return(-1!==n?t.filter((function(e){return e.filterBy==n})):t).forEach((function(e){var n=o.filter((function(t){return p(t.groupBy)?-1!=t.groupBy.indexOf(e.id):t.groupBy===e.id}));if(n.length){var r={zero:0,incomplete:0,basic:0,proficient:0,advanced:0,id:e.id};n.forEach((function(e){switch(e.grade){case 0:r.zero++;break;case 1:r.incomplete++;break;case 2:r.basic++;break;case 3:r.proficient++;break;case 4:r.advanced++}})),r.title=i.find(t,(function(t){return t.id==e.id})).text,isNaN(e.id)&&(r.title=e.id+" - "+r.title),r.total=n.length,r.percentProficient=100*(r.proficient+r.advanced)/r.total;var l=c.parseDateString(n.reduce((function(e,t){return e<t.date?e:t.date}),a));if(r.showTrend=Math.floor((a-l)/864e5)>30,r.showTrend){var d=n.filter((function(e){var t=c.parseDateString(e.date);return Math.floor((a-t)/864e5)>30})),u=100*d.filter((function(e){return e.grade>=3})).length/d.length;r.trend=Math.round(r.percentProficient-u)}s.push(r)}})),o=s.length?s.sort((function(e,t){return t.percentProficient-e.percentProficient})):s},t.handleStandardsFilterSelect=function(e){if(!$(e.currentTarget).hasClass("selected")){var n=$(e.currentTarget).data("filtervalue")||e.target.value;t.setState({currentFilter:"All"===n?-1:n})}},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.data,a=t.titleHash,s=t.filters,i=t.filterStyle,p=t.noDataText,h=this.props.classId?JSON.parse(sCH.classesC.find({ClassId:this.props.classId}).get("Settings")):null,g=h?c.gradeNameMap(!1,h):alcfg.grades.list,f=this.filterData(n,a,this.state.currentFilter);return o.createElement(o.Fragment,null,s&&!i&&f.length>0&&o.createElement("div",{role:"tablist","aria-label":"Report Tabs",className:"pageTabsContainer"},s.map((function(t){return o.createElement("a",{href:"javascript:void(0)",role:"tab",className:"btn-box toggler btnSwitchReportType "+(t.value==e.state.currentFilter?"selected":""),"data-filtervalue":t.value,key:t.value,onClick:e.handleStandardsFilterSelect},t.text)}))),s&&"selector"===i&&f.length>0&&o.createElement("div",{id:"portfolioFilters"},s.length?o.createElement(l.default,{className:"ddlSkillBuckets",onChange:this.handleStandardsFilterSelect,value:this.state.currentFilter},s.map((function(e){return o.createElement(d.default,{value:e.value,key:e.text},e.text)}))):null),f.length?o.createElement(o.Fragment,null,o.createElement("div",{className:"key"},o.createElement("div",{className:"advanced"},o.createElement("span",{className:"circle"}),g[4].label),o.createElement("div",{className:"proficient"},o.createElement("span",{className:"circle"}),g[3].label),o.createElement("div",{className:"basic"},o.createElement("span",{className:"circle"}),g[2].label),o.createElement("div",{className:"incomplete"},o.createElement("span",{className:"circle"}),g[1].label),o.createElement("div",{className:"zero"},o.createElement("span",{className:"circle"}),g[0].label)),o.createElement("div",{className:"percentageBarGraph"},f.map((function(e){return o.createElement("div",{key:e.id,className:"dataRow"},o.createElement("div",{className:"rowTitle"},o.createElement("div",{className:"itemTitle"},e.title),o.createElement("div",{className:"itemCount"},e.total," ",1==e.total?"grade":"grades")),o.createElement(r.default,{toolTipText:"% of answers graded "+g[3].label+" or "+g[4].label,advancedRatio:e.advanced/e.total,proficientRatio:e.proficient/e.total,basicRatio:e.basic/e.total,incompleteRatio:e.incomplete/e.total,zeroRatio:e.zero/e.total}),o.createElement(u.default,{title:e.showTrend&&0!=e.trend?"30 days ago, it was at "+(Math.round(e.percentProficient)-e.trend)+"%":""},o.createElement("div",{className:"trend"},e.showTrend&&0!=e.trend?o.createElement(o.Fragment,null,o.createElement("span",{className:e.trend>0?"trend-arrow icon-arrowup":"trend-arrow icon-arrowdown"}),Math.abs(e.trend),"%"):null)))})))):o.createElement("div",{className:"ctaInfo"}," ",p," "))},t}(o.Component);t.default=h},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(24),r=n(5),l=n(277),d=n(72),c=n(740),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isSelected=function(){return 0!==t.props.selectedUserIds.length||(r.bootstrap.alert({message:t.props.noSelectionMsg,alert:"danger"}),!1)},t}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.modalTitle,n=e.okText,a=e.disabledOkText,s=e.okCallback,u=e.users,p=e.header,h=e.signupEmailContent,g=void 0===h?null:h,f=e.currentAuthors,m=e.removeCoauthor,v=e.hasPermissionToRemoveCoAuthor,b=e.isOwner,C=void 0===b?function(){return!1}:b,y=e.noUserText,_=e.currentAuthorsText,S=void 0===_?"Current co-authors":_,w=e.setSelectedUserIds,T=e.optionButtons,I=void 0===T?[]:T,x=e.allowCancel,k=e.cssClass,E=e.cancelCallback;return i.createElement(o.default,{title:t,okText:n,disabledOkText:a,okCallback:s,cssClass:k,allowCancel:x,maxWidth:"lg",shouldOverflow:!0,optionButtons:I,cancelCallback:E,customValidations:[{name:"isSelected",func:this.isSelected}]},i.createElement("p",null,p),0===u.length?i.createElement("div",{className:"empty"},y):i.createElement(l.default,{placeholder:"Start typing a colleague's name...",suggestions:u.map((function(e){return{value:e.UserId,label:e.FirstName+" "+e.LastName}})),onChange:function(e){w(e.map((function(e){return e.value})))},validators:{isSelected:""}}),g&&i.createElement(c.default,{signupEmailContent:g,description:"Don't see your colleagues?"}),i.createElement("h1",{className:"light"},S,":"),i.createElement("ul",{className:"checklist"},f.map((function(e){return i.createElement("li",{key:e.UserId},i.createElement("div",{className:"userIcon",dangerouslySetInnerHTML:{__html:r.generateAvatarHtml(e.ImageUrl)}}),i.createElement("div",{className:"title light"},r.sanitize(e.FullName)," ",C(e)&&"(owner)"),v(e)&&i.createElement(d.default,{type:"button",buttonClass:"icon-trash btnRemoveCoauthor","data-userid":e.UserId,buttonTitle:"Remove Co-author",onClick:m}))}))))},t}(i.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(48),o=n(1406);t.default=Backbone.View.extend({events:{"click .chkViewPeerResponses":"toggleAnonymousCheckbox","click .chkQuestionGates":"toggleMinimizeQuestionsCheckbox","click #chkAllowGradingTagging":"toggleAllowGradingTaggingCheckbox","keyup table .denominator input":"updateDenominator","change table .denominator input":"updateDenominator","change .assignmentSettings":"toggleAssignmentSettings","change .gradeLabels":"renderGradeLabels","click .gradeLabels .icon-pencil":"editCustomGradeLabels"},template:n(1408),gltemplate:n(752),initialize:function(e){this.on("ok",this.updateSettings),this.on("initialized",this.modalInitialized),this.isHigherEd=sCH.userM.get("IsHigherEd"),this.classM=e.classM,this.assignment=e.assignment,this.subMenu=e.submenu,this.assignmentMode=!!this.assignment,this.triggeredFromReader=!0===e.triggeredFromReader,this.isQuiz=this.assignmentMode&&(1===e.assignment.Type||e.assignment.IsQuiz)},modalInitialized:function(e){this.modal=e},toggleAssignmentSettings:function(e){this.assignmentSettingsSelected="yes"===this.$el.find(".assignmentSettings:checked").val(),this.$el.find(".readingsetting .subsection").toggleClass("custom",this.assignmentSettingsSelected),this.assignmentSettingsSelected||this.initializeReadingSettings({restoreClassSettings:!0}),this.disableSettingsForQuiz()},disableSettingsForQuiz:function(){if(this.assignmentSettingsSelected&&this.isQuiz){this.$el.find(".readingsetting .subsection .label:not(.enableForQuiz)").addClass("disabled").find("input:checkbox").prop("checked",!1),this.$el.find(".viewPeerResponseSelectContainer").hide();var e=JSON.parse(this.assignment.Settings),t=e&&e.reading&&e.reading.AllowStudentsMCAnswer;this.$el.find("#chkAllowStudentsMCAnswer").prop("checked",t)}},updateDenominator:function(e){$(e.target).parents("tbody").find(".denominator:not(:first)").text($(e.target).val())},render:function(){var e=this.gltemplate({info:{isHigherEd:this.isHigherEd,grouped:!1}});return this.$el.html(this.template({c:this.classM.toJSON(),assignmentMode:this.assignmentMode,gradelevels:e,classType:s.getUserOrClassType(this.classM),isQuiz:this.isQuiz,isTeacherOwner:this.classM.get("TeacherUserId")===sCH.userM.get("UserId"),triggeredFromReader:this.triggeredFromReader})),this.$el.find("div.section").hide(),this.$el.find(".section."+this.subMenu+"setting").show(),this.initializeSettings(),this.assignmentMode&&this.toggleAssignmentSettings(),this.$el.find("select").selectpicker(),s.initTooltips(this.$el),this},initializeSettings:function(){switch(this.subMenu){case"name":this.initializeNameSettings();break;case"reading":this.initializeReadingSettings();break;case"gradebook":this.initializeGradebookSettings()}},initializeNameSettings:function(){this.$el.find(".txtName").val(s.htmlDecode(this.classM.get("Name"))),this.$el.find(".ddlGradeLevels").val(this.classM.get("GradeLevel")),this.$el.find(".ddlSchools").length>0&&this.$el.find(".ddlSchools").val(this.classM.get("SchoolId"))},initializeReadingSettings:function(e){var t=JSON.parse(this.classM.get("Settings"))||{};if(this.assignmentMode){var n=JSON.parse(this.assignment.Settings),s=!n||!n.reading||e&&e.restoreClassSettings?0:Object.keys(n.reading).length;s>1?(this.$el.find('.assignmentSettings[value="yes"]').prop("checked",!0),t=n):e&&e.restoreClassSettings&&(this.$el.find('.assignmentSettings[value="no"]').prop("checked",!0),1===s&&n.reading.AllowStudentsMCAnswer&&this.$el.find("#chkAllowStudentsMCAnswer").prop("checked",t.reading.AllowStudentsMCAnswer))}t.reading=a.merge({},alcfg.defaultReadingSettings,t.reading),this.$el.find("#chkNotifications").prop("checked",t.reading.Notifications),this.$el.find("#chkQuestionGates").prop("checked",t.reading.QuestionGates),this.$el.find("#chkMinimizeQuestions").prop("checked",t.reading.MinimizeQuestions),this.$el.find("#chkViewPeerResponses").prop("checked","none"!==t.reading.ViewPeerResponses),this.$el.find("#chkNamedPeerResponses").prop("checked",t.reading.NamedPeerResponses),this.$el.find("#chkAllowLikingPeerResponses").prop("checked",t.reading.AllowLikingPeerResponses),this.$el.find("#chkAllowStudentsMCAnswer").prop("checked",t.reading.AllowStudentsMCAnswer),this.$el.find("#chkDisAllowAnswerEditing").prop("checked",t.reading.DisAllowAnswerEditing),this.$el.find("#chkAllowStudentSharedNotes").prop("checked",t.reading.AllowStudentSharedNotes),this.$el.find("#chkAllowTranslation").prop("checked",t.reading.AllowTranslation),this.$el.find("#chkAllowDictionary").prop("checked",t.reading.AllowDictionary),this.$el.find("#chkAllowTextToSpeech").prop("checked",t.reading.AllowTextToSpeech),"none"===t.reading.ViewPeerResponses?this.$el.find(".lblNamedPeerResponses, .lblLikePeerResponses, .viewPeerResponseSelectContainer").hide():this.$el.find(".ddlCCViewPeerResponses").val(t.reading.ViewPeerResponses),t.reading.QuestionGates&&this.$el.find(".lblMinimizeQuestions").addClass("disabled")},initializeGradebookSettings:function(){var e=this,t=JSON.parse(this.classM.get("Settings"));e.grades=a.extend({},alcfg.grades.defaults),null===t||null===t.gradebook||a.isEmpty(t.gradebook)||a.extend(e.grades,t.gradebook),e.grades.shortAnswer.numerators.zero=e.grades.shortAnswer.numerators.zero||"0";var n=this.$el.find(".gradeLabels");if(e.grades.gradeLabels){var s=[];a.each(JSON.parse(e.grades.gradeLabels),(function(e,t){s.push(e)}));var i="<option value='5' data-content=\""+s.join("&nbsp;&middot;&nbsp;")+"<span class='glyphicon glyphicon-ok icon-pencil'></span>\"></option>";$(i).insertBefore(n.find('option[value="custom"]')),n.find('option[value="custom"]').remove(),n.selectpicker("refresh")}n.val(e.grades.gradeLabelsOption).selectpicker("refresh"),this.$el.find(".shortAnswer, .multipleChoice").each((function(){var t=$(this).data("question");$(this).find("tbody .denominator input").val(e.grades[t].denominator),$(this).find("tbody tr").each((function(){$(this).find(".numerator input").val(e.grades[t].numerators[$(this).data("grade")])})),$(this).find(".denominator input").each((function(){$(this).parents("tbody").find(".denominator:not(:first)").text($(this).val())}))})),this.renderGradeLabels(),this.$el.find("#chkAllowGradingTagging").prop("checked",e.grades&&e.grades.AllowGradingTagging)},toggleAnonymousCheckbox:function(e){$(e.currentTarget).is(":checked")?(this.$el.find(".lblNamedPeerResponses, .lblLikePeerResponses").show(),this.$el.find(".viewPeerResponseSelectContainer").show().find("select").val("all").selectpicker("refresh"),this.$el.find("#chkNamedPeerResponses, #chkAllowLikingPeerResponses").prop("checked",!0)):(this.$el.find(".lblNamedPeerResponses, .lblLikePeerResponses, .viewPeerResponseSelectContainer").hide(),this.$el.find("#chkNamedPeerResponses, #chkAllowLikingPeerResponses").prop("checked",!1))},toggleMinimizeQuestionsCheckbox:function(e){$(e.currentTarget).is(":checked")?this.$el.find(".lblMinimizeQuestions").addClass("disabled"):this.$el.find(".lblMinimizeQuestions").removeClass("disabled"),this.$el.find("#chkMinimizeQuestions").prop("checked",!1)},toggleAllowGradingTaggingCheckbox:function(e){if(sCH.userM.isOnFreePlan())return i.showBuyTeacherPopup({title:"Tagging responses"}),!1},renderShortAnswerGradeLabels:function(e){var t=this,n=e!=alcfg.grades.customGradeScaleOption&&"custom"!=e||!t.grades.gradeLabels?alcfg.grades.nameSets[e]:JSON.parse(t.grades.gradeLabels);return a.each(n,(function(e,n){t.$el.find('table.shortAnswer tr[data-grade="'+n+'"] .label').text(e)})),n},renderGradeLabels:function(){var e=this.$el.find(".gradeLabels").val(),t=this.renderShortAnswerGradeLabels(e);"custom"==e&&this.openCustomGradingLabelPopup(this.grades.gradeLabelsOption,t)},openCustomGradingLabelPopup:function(e,t){sCH.userM.isOnFreePlan()?i.showBuyTeacherPopup({title:"Custom grading labels",content:"Add your school or district's custom grading labels."}):(this.$el.find(".gradeLabels").val(e).selectpicker("refresh"),this.renderShortAnswerGradeLabels(e),new Backbone.BootstrapModal({title:"Custom grading labels",content:new o.default({gradeLabels:t,parentPopup:this}),cancelText:"Cancel",cssClass:"modal-inline-labelinput smallLabel"}).open())},editCustomGradeLabels:function(e){e.preventDefault(),e.stopPropagation(),this.openCustomGradingLabelPopup(5,JSON.parse(this.grades.gradeLabels))},updateGradeLabels:function(e){var t=this,n=[];a.each(e,(function(e,a){n.push(e),t.$el.find('table.shortAnswer tr[data-grade="'+a+'"] .label').text(e)}));var s=this.$el.find("select.gradeLabels"),i=n.join("&nbsp;&middot;&nbsp;")+'<span class="glyphicon glyphicon-ok icon-pencil"></span>';s.find('option[value="5"]').length?s.find('option[value="5"]').data("content",i).attr("data-content",i):$('<option value="5" data-content="'+i+'"</option>').insertBefore(s.find('option[value="custom"]')),s.find('option[value="custom"]').remove(),s.val("5").selectpicker("refresh"),t.grades.gradeLabels=JSON.stringify(e)},updateSettings:function(e){var t=this,n=!1,a={};if("name"===this.subMenu){var i=this.$el.find(".txtName"),o=this.$el.find(".ddlGradeLevels"),r=this.$el.find(".ddlSchools"),l=s.checkRequiredFields([i,o,r]),d={ClassId:this.classM.get("ClassId"),Name:i.val(),GradeLevel:this.isHigherEd?"":o.val()};return r.length>0&&(d.SchoolId=parseInt(r.val())),l>0&&"native"===s.getUserOrClassType(this.classM)?void e.preventClose():(this.classM.set(d),void((this.classM.hasChanged("Name")||this.classM.hasChanged("SchoolId")||this.classM.hasChanged("GradeLevel"))&&(sCH.classesC.updateClass({classId:d.ClassId,name:d.Name,gradeLevel:d.GradeLevel,schoolId:d.SchoolId}),Backbone.pubEv.trigger("setSiteSection",this.classM.get("Name")),s.bootstrap.alert({message:"Settings updated!"}),e.close())))}if("reading"===this.subMenu)a={},this.assignmentMode&&!this.assignmentSettingsSelected?a=null:this.$el.find(".readingsetting .subsection input[type='checkbox']").each((function(e,n){var s=$(n).attr("id").replace("chk","");a[s]="ViewPeerResponses"===s?$(n).is(":checked")?t.$el.find(".ddlCCViewPeerResponses").val():"none":$(n).is(":checked")})),n=this.$el.find("#chkCopyReadingSettingsAllClasses").is(":checked");else if("gradebook"===this.subMenu){var c=[];if(this.$el.find(".shortAnswer input, .multipleChoice input").each((function(){(isNaN($(this).val())||""===$(this).val())&&(c.push($(this)),$(this).val(""))})),c.length>0)return s.checkRequiredFields(c),void e.preventClose();var u=this.$el.find(".gradeLabels").val();if(a={gradeLabelsOption:u,gradeLabels:t.grades.gradeLabels},this.$el.find(".shortAnswer, .multipleChoice").each((function(){var e=$(this).data("question");a[e]={denominator:parseFloat($(this).find("tbody .denominator input").val()),numerators:{}},$(this).find("tbody tr").each((function(){var t=$(this).find(".numerator input").val();a[e].numerators[$(this).data("grade")]=parseFloat(t)}))})),!t.isGradePointsValid(a))return void e.preventClose();a.AllowGradingTagging=$("#chkAllowGradingTagging").is(":checked"),n=this.$el.find("#chkCopyGradebookSettingsAllClasses").is(":checked")}e.preventClose(),e.disableOk("Saving..."),this.assignmentMode?this.updateAssignmentSettings(e,a,n):this.triggeredFromReader?this.settingsUpdateConfirmation(e,a,n):this.updateClassSettings(e,a,n)},isGradePointsValid:function(e,t){var n=e.shortAnswer,a=e.multipleChoice;return n.denominator>=n.numerators.advanced&&n.numerators.advanced>=n.numerators.proficient&&n.numerators.proficient>=n.numerators.basic&&n.numerators.basic>=n.numerators.incomplete&&n.numerators.incomplete>=n.numerators.zero?!!(a.denominator>=a.numerators.correct&&a.numerators.correct>a.numerators.incorrect)||(s.bootstrap.alert({alert:"danger",message:"Points for multiple choice responses is not valid."}),!1):(s.bootstrap.alert({alert:"danger",message:"Points for short answer responses is not valid."}),!1)},updateClassSettings:function(e,t,n){var i=this;this.classM.editSettings({classId:this.classM.get("ClassId"),newSubSettings:JSON.stringify(t),subMenu:this.subMenu,updateAllClasses:n},(function(t){if(t){i.classM.set("Settings",JSON.stringify(t));var o=sCH.userM.get("UserId");i.triggeredFromReader&&Backbone.pubEv.trigger("gradingSettingsUpdated",t),n&&a.each(sCH.classesC.models,(function(e){if(e.get("TeacherUserId")===o){var n=JSON.parse(e.get("Settings"));null===n?e.set("Settings",JSON.stringify(t)):(n[i.subMenu]=t[i.subMenu],e.set("Settings",JSON.stringify(n)))}})),s.intercom("trackEvent","updated-classSettings"),Backbone.pubEv.trigger("setSiteSection",i.classM.get("Name")),Backbone.pubEv.trigger("RerenderClassAssignmentTiles"),Backbone.pubEv.trigger("rerenderClassData",i.classM.get("ClassId")),s.bootstrap.alert({message:"Settings updated!"})}else s.bootstrap.alert({message:"There was an error updating your settings. Please try again later.",alert:"danger"});e.close()}))},updateAssignmentSettings:function(e,t,n){var i=this;this.classM.editAssignmentSettings({classId:this.classM.get("ClassId"),assignmentId:this.assignment.AssignmentId,newSubSettings:JSON.stringify(t),subMenu:this.subMenu,updateAllClasses:n},(function(t){t?(i.assignment.Settings=JSON.stringify(t),n&&a.each(sCH.classesC.models,(function(e){a.each(a.filter(e.get("Assignments"),{LayerId:i.assignment.AssignmentId,IsDeleted:0}),(function(e){var n=JSON.parse(e.Settings);null===n?e.Settings=JSON.stringify(t):(n[i.subMenu]=t[i.subMenu],e.Settings=JSON.stringify(n))}))})),Backbone.pubEv.trigger("RerenderClassAssignmentTiles"),sCH.classesC.fill(),s.intercom("trackEvent","updated-assignmentSettings"),s.bootstrap.alert({message:"Settings updated!"})):s.bootstrap.alert({message:"There was an error updating your settings. Please try again later.",alert:"danger"}),e.close(),i.assignmentMode&&Backbone.pubEv.trigger("cancelSelectMode")}))},settingsUpdateConfirmation:function(e,t,n){var a=this;new Backbone.BootstrapModal({title:"Edit grading settings?",content:"This will affect all assignments in the class.",cssClass:"modal-al-edit-grading-settings",okText:"Ok"}).open((function(){a.updateClassSettings(e,t,n)})).on("cancel",(function(){e.enableOk("Save")}))}})},,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(1430),l=n(22),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={steps:t.props.steps,run:!0},t.callback=function(e){var n=e.type,a=e.index,s=e.lifecycle;if("tour:end"===n&&(t.props.onComplete&&t.props.onComplete(),l.unmountReactComponent($("#joyride")[0])),"init"===s){var i=t.props.steps[a].target;".textSection p"===i&&o.viewportSkipToElement($(i),!0)}},t}return s(t,e),t.prototype.componentWillMount=function(){},t.prototype.componentWillUnmount=function(){},t.prototype.render=function(){var e=this.state,t=e.steps,n=e.run;return i.createElement(r.default,{continuous:!0,showProgress:!0,showSkipButton:!0,disableOverlay:this.props.disableOverlay||!1,locale:{back:"",skip:"",last:"Done"},styles:{options:{primaryColor:"#FFF"}},steps:t,run:n,callback:this.callback})},t}(i.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){var t=e.numOfBYOCInMonth;return e.isVisible&&a.createElement("p",{className:"info"},a.createElement("span",null,"Note: You have ",3-t," remaining imports this month. This limit will reset on ",moment().endOf("month").format("MMM Do"),". For unlimited imports, check out our ",a.createElement("a",{className:"infoLink",href:"https://www.activelylearn.com/plans"},"Prime plan"),"."))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24),i=n(34),o=n(276),r=n(496),l=n(233),d=n(10),c=n(5);t.default=function(e){var t="student"===sCH.userM.get("Role"),n=sCH.userM.isOnFreePlan(),u=e.numOfBYOCInMonth,p=e.source,h=e.classId,g="googleDoc"===p,f=a.useState(""),m=f[0],v=f[1],b=a.useState(""),C=b[0],y=b[1],_=a.useState(""),S=_[0],w=_[1],T=a.useState(g),I=T[0],x=T[1],k=a.useRef(null);function E(){t?(c.bootstrap.alert({message:"A PDF has been added to your Research!"}),Backbone.pubEv.trigger("textImported")):(c.bootstrap.alert({message:"A PDF has been added to your Imports!"}),Backbone.pubEv.trigger("textImported"),c.intercom("trackEvent","workspace-add-pdf"),c.intercom("trackEvent","workspace-add-byoc")),s.hideModals()}function N(){k.current&&k.current.disableOkButton()}return a.useEffect((function(){g||N()}),[]),a.createElement(s.default,{title:I?e.title:"Select a PDF from your local drive",okText:I?e.okText:"Next",disabledOkText:I&&"Uploading...",okCallback:I?function(){var e=parseInt($(".folder.selected").data("folderid")),n={title:m,author:C,skillBucketId:S,classId:t?h:void 0,folderId:e>0&&!isNaN(e)?e:void 0};g?(n.downloadUrl=window.addGoogleDoc.downloadUrl,n.oauthToken=window.addGoogleDoc.oauthToken,d.AddGooglePdf(n,(function(e){e.success?E():(c.bootstrap.alert({message:"Error uploading PDF!",alert:"danger"}),s.hideModals())}))):sCH.reactUploader.getNumPagesInPdf((function(e){n.numPages=e,sCH.reactUploader.submit((function(){E()}),n)}))}:function(e){x(!0),e.enableOkButton("Done")},ref:k},I&&a.createElement(a.Fragment,null,!t&&a.createElement("p",{className:"description"},"This information also sets the standards for the assignment."),a.createElement(i.TextValidator,{name:"txtTitle",id:"txtTitle",label:"Title",value:m,fullWidth:!0,onChange:function(e){return v(e.target.value)},autoFocus:!0,required:!0}),a.createElement(i.TextValidator,{name:"txtAuthor",id:"txtAuthor",label:"Author",value:C,fullWidth:!0,onChange:function(e){return y(e.target.value)},required:"Please enter the author name"}),!t&&a.createElement("div",{className:"unitSelectorContainer"},a.createElement(o.default,{contentType:S,onChange:function(e){return w(e.target.value)}})),a.createElement("div",{className:"info"},"Note: this may take a few minutes depending on the size of your PDF."),a.createElement(r.default,{numOfBYOCInMonth:u,isVisible:!t&&n})),a.createElement("div",{style:{display:I?"none":"block"}},a.createElement("p",null,"If <10 pages, try ",a.createElement("a",{className:"infoLink",href:alcfg.helpArticleLink.convertPdf},"making it a Google Doc"),t?"":" to add questions anywhere in the text","."),a.createElement(l.default,{uploadUrl:alcfg.node.workspace.upload_pdf,enableMultipleErrorMessage:"You can upload only one PDF.",fileType:"application/pdf",fileDropPlaceholder:"Try dropping a PDF here, or click to select a PDF to upload.",successMessage:"PDF saved!",maxFileSize:6e7,submitData:{},enableMultiple:!1,containerModal:{enableOk:function(){k.current&&k.current.enableOkButton()},disableOk:N},disablePreview:!0})))}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8);t.getAncestorFolders=function(e,t){for(var n=[],s=a.find(e,{FolderId:t});s;)n.push(s),s=a.find(e,{FolderId:s.FolderParentId});return n},t.getFolderCoauthoringTooltipText=function(e){var n;e&&e.length>1&&(n="Co-authoring with "+t.getFolderCoauthorsName(e));return n},t.getFolderCoauthorsName=function(e){var t=a.filter(e,(function(e){return e.UserId!==sCH.userM.get("UserId")}));return a.map(t,"FullName").join(", ")}},,,,,function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(5);t.customizedWeightsExist=function(e){return e&&e.filter((function(e){return 1!==e.GradeWeight})).length>0},t.getAssignmentWeight=function(e,t){return(i.find(e,{AssignmentId:t})||{}).GradeWeight||1},t.getPrecision=function(e){var t=e.multipleChoice,n=e.shortAnswer,a=function(e){return parseFloat(e)!==parseInt(e,10)},s=i.filter(t.numerators,a).length,o=i.filter(n.numerators,a).length;return s>0||o>0?1:0},t.getAssignmentWeightsRow=function(e){if(!t.customizedWeightsExist(e))return null;var n=e.map((function(e){return{content:1!==e.GradeWeight?e.GradeWeight+"x":null,classes:{center:!0}}}));return{height:40,cells:s([{content:"Weight"},{content:""}],n)}},t.getStudentTotalPoints=function(e,n,a,s){n.map((function(e){return e.AssignmentId}));var i=a.filter((function(t){return t.UserId===e.UserId}));return{pointsEarned:o.roundWithPrecision(i.reduce((function(e,a){return e+t.getAssignmentWeight(n,a.AssignmentId)*(a.PointsEarned||0)}),0),s),pointsPossible:o.roundWithPrecision(i.reduce((function(e,a){return e+t.getAssignmentWeight(n,a.AssignmentId)*(a.PointsPossible||0)}),0),s)}},t.getStudentTotals=function(e,n,s,i){var o=t.getPrecision(e);return n.map((function(e){return a({userId:e.UserId},t.getStudentTotalPoints(e,s,i,o))}))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(13),r=n(5),l=n(133),d=n(5),c=n(10),u=o.makeStyles({assignButton:{},masteryBar:{backgroundColor:"#E8E8E8",borderRadius:30,width:"calc(100% - 50px)",display:"inline-block",marginRight:10,marginTop:10,"& span":{display:"block",height:10,borderRadius:30}}}),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={interventionIdsToAssign:[]},t.interventionSelected=function(e){var n=t.state.interventionIdsToAssign,a=-1!==n.indexOf(e);t.setState({interventionIdsToAssign:a?n.filter((function(t){return t!==e})):n.concat(e)})},t.onAssign=function(e){e.stopPropagation(),c.AssignIntervention({interventionIds:t.state.interventionIdsToAssign},(function(){t.props.onAssignSuccess&&t.props.onAssignSuccess(t.state.interventionIdsToAssign),t.setState({interventionIdsToAssign:[]}),d.bootstrap.alert({message:"Success!"})}))},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.interventions,a=t.byAssignment;return i.createElement(i.Fragment,null,n.map((function(t){return i.createElement("div",{key:t.interventionId,className:"interventionContainer"},t.status===l.InterventionStatus.Recommended&&i.createElement("label",{className:"checkboxLabel"},i.createElement("input",{type:"checkbox",name:"checkbox",onClick:function(){return e.interventionSelected(t.interventionId)}}),i.createElement("span",{className:"checkmark"})),i.createElement("div",{className:"nameContainer"},a?i.createElement("span",null,t.lastName,", ",t.firstName):i.createElement("span",null,t.code," - ",r.truncate(t.name,100)),t.status===l.InterventionStatus.Assigned&&i.createElement("div",null,"(",r.plural(t.numProblemsCompleted,"%count problem","%count problems")," completed)"),i.createElement(h,{mastery:t.mastery})))})),n.length>0&&n[0].status===l.InterventionStatus.Recommended&&i.createElement("button",{className:"btnAssignIntervention",onClick:this.onAssign,disabled:0===this.state.interventionIdsToAssign.length},"Assign interventions"))},t}(i.Component);t.default=p;var h=function(e){var t=e.mastery,n=u(),a=l.percent(t,1)||0,s=l.getMasteryColor(a);return i.createElement(i.Fragment,null,i.createElement("div",{className:n.masteryBar},i.createElement("span",{style:{backgroundColor:s,width:a+"%"}})),a,"%")}},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(1764);t.default=Backbone.View.extend({initialize:function(e){Backbone.pubEv.on("tags_destroy",this.destroy,this),Backbone.pubEv.on("wrapQuestionsAtSameLocation",this.wrapQuestionsAtSameLocation,this),this.models=e.models?e.models:[],this.tagListMode=e.tagListMode,this.tagViews=[]},render:function(e,t){var n=this,s=$(".reader .scroll .view.notesview")[0];window.questionNodes=[],a.each(this.models,(function(t){var a=t.get("TextSectionId");a&&a!==sCH.readerConfig.currentSectionId||n.tagViews.push(new i.default({model:t,element:e,notesView:s,tagListMode:n.tagListMode}))})),this.finishQuestionRendering();try{rangy.getSelection().removeAllRanges()}catch(e){}return this.tagListMode||t||Backbone.pubEv.trigger("updateMargin"),e},addModelsAndRender:function(e,t){var n=this,s=$(".reader .scroll .view.notesview")[0];if(window.questionNodes=[],a.each(e.models,(function(t){n.models.push(t),n.tagViews.push(new i.default({model:t,element:e.element,notesView:s,tagListMode:n.tagListMode}))})),this.finishQuestionRendering(!this.tagListMode),!t)try{rangy.getSelection().removeAllRanges()}catch(e){}this.tagListMode||Backbone.pubEv.trigger("updateMargin")},addNewTempNoteAndRender:function(e){this.models.push(e.model),this.tagViews.push(new i.default({model:e.model,element:e.element,notesView:$(".reader .scroll .view.notesview")[0],tagListMode:this.tagListMode}))},removeNewTempNote:function(){this.models=this.models.filter((function(e){return 0!==e.get("TagId")})),this.tagViews=this.tagViews.filter((function(e){return 0!==e.model.get("TagId")}))},finishQuestionRendering:function(e){if(window.questionNodes.length){e&&1===window.questionNodes.length&&this.moveIdenticalEndIndexQuestionToEnd(window.questionNodes[0].questionTagId,window.questionNodes[0].endIndex);for(var t=0;t<window.questionNodes.length;t++)$("#tag"+window.questionNodes[t].questionTagId).replaceWith(window.questionNodes[t].html),s.onDevice()&&window.questionNodes[t].html.before("<br />");delete window.questionNodes,this.wrapQuestionsAtSameLocation(),$(".teacherQuestion .ddlCCStandardIds").selectpicker()}},wrapQuestionsAtSameLocation:function(){if("authoring"===sCH.readerConfig.type&&!sCH.readerConfig.isAssessment){var e=this.$el.find(".textSection .teacherQuestion");if(sCH.readerConfig.isReadOnly)e.find(".questionTagButtons").addClass("displayNone");else{$(".sameLocationQuestionsContainer:not(.endSectionQuestions)").replaceWith((function(e){return this.childNodes}));var t=a.filter(sCH.teacherQuestionsC.models,(function(e){return-1!==e.get("StartIndex")})),n=a.groupBy(t,(function(e){return e.get("EndIndex")}));a.each(n,(function(e,t){if(e&&e.length>1&&parseInt(t)>-1){var n="";a.each(e,(function(e,t){n+=(t>0?", ":"")+'.textSectionContainer .questionTagViewMode[data-tagid="'+e.get("TagId")+'"]'})),$(n).closest(".teacherQuestion").wrapAll('<div class="sameLocationQuestionsContainer"></div>')}}))}}},moveIdenticalEndIndexQuestionToEnd:function(e,t){var n=a.filter(sCH.teacherQuestionsC.models,(function(e){return e.get("EndIndex")===t&&null!==e.get("TagId")}));if(n&&n.length){var s=a.maxBy(n,(function(e){return e.get("QuestionNum")})).get("TagId");$("#tag"+e).insertAfter('.textSectionContainer .questionTagViewMode[data-tagid="'+s+'"]'),$(".reader .scroll .textview").scrollTop($("#tag"+e).offset().top)}},destroySingle:function(e){if(this.tagViews&&this.tagViews.length)for(var t=0;t<this.tagViews.length;t++)try{if(this.tagViews[t].model.get(e.tagAttr)===e.tagId){this.tagViews[t].currView&&this.tagViews[t].currView.destroy({doNotUpdateMargin:!0}),this.tagViews.splice(t,1);break}}catch(e){}},destroy:function(){a.each(this.tagViews,(function(e){try{e.currView&&e.currView.destroy({doNotUpdateMargin:!0})}catch(e){}})),Backbone.pubEv.off("wrapQuestionsAtSameLocation"),this.tagViews=[]}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(86),o=n(10),r=n(168),l=n(48),d=n(192),c=n(43);t.default=Backbone.View.extend({qTemplate:n(519),eTemplate:n(1765),events:{"click .btnEdit":"edit","click .label .regular-radio":"selectType","click .ddlCCStandardIds":"bringToFront","change .ddlCCStandardIds":"standardSelected","click .btnPin":"togglePinQuestion","click .btnDone":"validatePreSave","click .btnAddExtraHelp":"toggleExtraHelp","click .btnAddModelResponse":"toggleModelResponse","click .btnAddDok":"toggleDok","click .btnAddSecondStandard":"includeSecondStandard","click .btnRemoveSecondStandard":"removeSecondStandard","click .ddlWeights a":"changeWeight","click .ddlAllowMediaResponse a":"changeAllowMediaResponses","click .btnMoveQuestion":"moveQuestionSelected","click .btnDelete":"del","click .btnCancel":"cancel","click .questionTagEditMode .checkBoxMe":"selectAnswer","click .btnAddChoice":"addChoice","click .btnDeleteChoice:not(.disabled)":"deleteChoice","click .btnQuestionOrderUp":"questionOrderUp","click .btnQuestionOrderDown":"questionOrderDown","change .randomizeQuestionContainer input":"showBuyTeacherPopup","paste .txtMedia":"embedMedia","blur .txtMedia":"embedMedia","click .btnToggleMedia":"toggleAddMediaContainer","click .btnBlockAddMedia":"showBuyPrimePopup","click .questionStemsOptions li a":"addQuestionTextFromStem","click .extraHelpIcon":"manageExtraHelpStudents"},initialize:function(e){this.tagListMode=e.tagListMode,this.model.on("remove",this.deleteQuestion,this),this.isPreReadingQuestion=-1===this.model.get("StartIndex")&&-1===this.model.get("EndIndex"),Backbone.pubEv.once("editNewQuestion",this.editNew,this),Backbone.pubEv.on("questionNumUpdated",this.questionNumUpdate,this),Backbone.pubEv.on("moveQuestionHere",this.moveQuestionHere,this),Backbone.pubEv.on("moveQuestionHereCancelled",this.moveQuestionHereCancelled,this)},render:function(){this.fillEl();var e=this;return this.$el.find(".ddlCCStandardIds").on("hidden.bs.select",(function(t){e.$el.removeClass("bringToFront")})),this.model.get("TagId")||this.$el.find(".questionTagText .questionTextContainer[contenteditable]").on("keyup",(function(t){e.toggleQuestionStemsButton(t)})),this.$el},togglePinQuestion:function(e){var t=$(e.currentTarget).closest(".teacherQuestion"),n=!t.hasClass("pinned");if($(".teacherQuestion.pinned").length>0&&($(".teacherQuestion.pinned").css("width","initial").removeClass("pinned").find(".icon-pinfilled").attr("data-original-title","Pin question").removeClass("icon-pinfilled"),s.realignScrollForPinnedQuestion(this.prevHeight,t.find(".questionTagViewMode").data("tagid")),this.prevHeight=null),n){var a=t.outerHeight(!0)-parseInt(t.find(".arrow").css("borderRightWidth"));this.prevHeight=$(".textSectionContainer .textSection").height()-a;var i=c.safari||s.onDevice()?"pinned unfix":"pinned";t.addClass(i).find(".icon-pin").attr("data-original-title","Unpin question").addClass("icon-pinfilled")}return s.updatePinnedQuestionWidth(),!1},edit:function(e){if(!sCH.readerConfig.isReadOnly){if(this.selectType(),this.$el.find(".questionTagViewMode").hide().end().find(".questionTagEditMode").show(),this.model.get("StandardId"))this.renderStandardSet(this.$el.find(".firstStandardContainer select.ddlCCStandardIds"),s.getStandardById(this.model.get("StandardId")).Title,this.model.get("StandardId")),this.model.get("SecondStandardId")&&this.addSecondStandard(s.getStandardById(this.model.get("SecondStandardId")).Title,this.model.get("SecondStandardId"));else if(sCH.readerConfig.currentStandardSetTitleForText)this.renderStandardSet(this.$el.find(".firstStandardContainer select.ddlCCStandardIds"));else{var t=sCH.learnEntityMetaM.get("SkillBucketId"),n=a.filter(sCH.readerConfig.standards,{SkillBucketId:t});n.length>0?sCH.readerConfig.currentStandardSetTitleForText=n[0].Title:sCH.readerConfig.standards.length>0&&(sCH.readerConfig.currentStandardSetTitleForText=sCH.readerConfig.standards[0].Title),this.renderStandardSet(this.$el.find(".firstStandardContainer select.ddlCCStandardIds"))}try{this.$el.find("[contenteditable]")[0].focus()}catch(t){rg4js("send",{error:e,customData:{QuestionTagId:this.$el.find(".questionTagViewMode").data("tagid"),Html:this.$el.html()}})}this.$el.find(".ddlCCStandardIds").selectpicker({dropupAuto:!1,size:5}),this.$el.find(".ddlDok").selectpicker(),this.tagListMode?e&&($(".sectionSummaryContainer").length>0?$(".sectionSummaryContainer .teacherQuestion").addClass("disabled"):($(".btnAddAssessmentQuestion").addClass("displayNone"),$(".teacherQuestion").addClass("disabled")),$(e.currentTarget).closest(".teacherQuestion").removeClass("disabled")):(Backbone.pubEv.trigger("updateMargin"),$(".sameLocationQuestionsContainer .questionTagOrder .btn-box").addClass("disabled")),sCH.userM.isOnPrimePlan()||this.$el.find(".extraHelpContainer, .modelResponseContainer").addClass("displayNone"),s.destroyMediumEditor(this.medium),this.medium=[],this.medium.push(s.initMediumEditor(this.$el.find(".questionTagText [contenteditable]:eq(0)"))),this.medium.push(s.initMediumEditor(this.$el.find(".questionTagText [contenteditable]:eq(1)"))),this.medium.push(s.initMediumEditor(this.$el.find(".modelResponseContainer [contenteditable]"))),this.medium.push(s.initMediumEditor(this.$el.find(".questionTagEditMode .txtChoice")));var i=!sCH.userM.isOnFreePlan()&&(e?this.model.get("RandomizeChoices"):!(!sCH.readerConfig.isAssessment&&!sCH.learnEntityMetaM.get("IsQuiz"))||sCH.readerConfig.shouldRandomizeChoicesBeChecked);return this.$el.find(".randomizeQuestionContainer input").prop("checked",i),!1}},editNew:function(){this.model.get("Active")&&this.edit()},showBuyTeacherPopup:function(e){sCH.userM.isOnFreePlan()&&this.$el.find(".randomizeQuestionContainer input").is(":checked")&&(l.showBuyTeacherPopup({title:"Randomize order of choices"}),this.$el.find(".randomizeQuestionContainer input").prop("checked",!1),sCH.readerConfig.shouldRandomizeChoicesBeChecked=!1)},validatePreSave:function(e){var t=this.$el.find(".questionTagEditMode"),n=this.$el.find(".label .regular-radio:checked").data("subtype")>0?this.$el.find(".label .regular-radio:checked").data("subtype"):1,i={LayerId:sCH.readerConfig.layerId,Text:t.find(".questionTagText [contenteditable]:eq(0)").html(),ExtraHelpText:t.find(".questionTagText [contenteditable]:eq(1)").text().length>0?t.find(".questionTagText [contenteditable]:eq(1)").html():"",ModelResponse:t.find(".modelResponseContainer [contenteditable]").text().length>0?t.find(".modelResponseContainer [contenteditable]").html():"",HTML:t.find(".txtMedia").val(),StandardId:parseInt(t.find(".firstStandardContainer .ddlCCStandardIds option:selected").val())||void 0,SecondStandardId:parseInt(t.find(".secondStandardContainer .ddlCCStandardIds option:selected").val())||void 0,Dok:parseInt(t.find(".ddlDok option:selected").val())||void 0,SubType:n,Weight:3===n?void 0:t.find(".ddlWeights a.selected").data("weight"),RandomizeChoices:2===n&&this.$el.find(".randomizeQuestionContainer input").is(":checked"),AllowMediaResponse:1!==n?void 0:"yes"===t.find(".ddlAllowMediaResponse a.selected").data("allowmediaresponse")},o=!1,r=!1,l=!1,d=1===n&&i.AllowMediaResponse!==this.model.get("AllowMediaResponse"),c=this;if(this.model.get("Active")||this.model.get("TagId")){if(i.Text.length>4e3)s.bootstrap.alert({message:"The question text you entered is too long.",alert:"warning"});else if(i.ExtraHelpText.length>2048)s.bootstrap.alert({message:"The question extra help text you entered is too long.",alert:"warning"});else if(s.alertLongUrl(i.HTML)){if(0!==$("<div>"+i.Text+"</div>").text().length){if(!i.StandardId&&i.SecondStandardId&&(i.StandardId=i.SecondStandardId,i.SecondStandardId=void 0),2===n||3===n){var u;i.QuestionChoices=[],i.HasChoices=!0;var p=0;if(this.$el.find(".questionTagEditMode .choice").each((function(e,t){var a=$(t).find(".txtChoice").html().trim(),s=$(t).find(".txtChoice").text().trim();a.length>2048?u="The text you entered in one of the choices is too long.":s.length>0&&i.QuestionChoices.push({Text:a,IsCorrect:2===n&&$(t).find(".checkBoxMe .selected").length>0,ChoiceNum:++p})})),u)return void s.bootstrap.alert({message:u,alert:"warning"});if(2===n&&0===a.filter(i.QuestionChoices,{IsCorrect:!0}).length)return void s.bootstrap.alert({message:"You need to mark at least one choice as an answer!",alert:"warning"});if(sCH.readerConfig.shouldRandomizeChoicesBeChecked=i.RandomizeChoices,i.QuestionChoices.length<2)return void s.bootstrap.alert({message:"You need at least 2 choices.",alert:"warning"});if(2===n&&this.model.get("ReplyCount")&&!this.quesTypeChanged){var h=this.model.get("QuestionChoices")||[];l=h.length!==i.QuestionChoices.length,a.each(i.QuestionChoices,(function(e,t){t<h.length?(h[t].Text.replace(/&nbsp;/g,"@").replace(/\s/g,"@")!==e.Text.replace(/&nbsp;/g,"@").replace(/\s/g,"@")&&(o=!0),h[t].IsCorrect!==e.IsCorrect&&(r=!0)):e.IsCorrect&&(r=!0)}))}}else i.QuestionChoices=void 0,i.HasChoices=!1;if(this.model.get("ReplyCount")&&(this.model.get("Text").replace(/&nbsp;/g,"@").replace(/\s/g,"@")!==i.Text.replace(/"/g,"&quot;").replace(/&nbsp;/g,"@").replace(/\s/g,"@")||r||o||l||this.quesTypeChanged||d)){var g=!r&&!c.quesTypeChanged&&!d,f=i.HasChoices||c.quesTypeChanged?"":'<div class="info" style="margin-top:20px;">Note: If you reset responses students will see their current responses as a "draft".</div>',m=new Backbone.BootstrapModal({title:"Students have already answered this question",content:(g?alcfg.confirmsText.editAnsweredQuestionKeepResponses:alcfg.confirmsText.editAnsweredQuestion)+f,cssClass:"modal-al-question-already-answered modal-lg",allowCancel:!0,cancelText:"Cancel",okText:"Reset Responses",optionButtons:g?[{text:"Keep Responses",event:"noSelected"}]:[]}).open();m.on("cancel",(function(){c.model.previous("SubType")&&c.model.get("SubType")!==c.model.previous("SubType")&&c.model.set("SubType",c.model.previous("SubType")),c.fillEl(),m.close(),c.tagListMode&&$(".teacherQuestion").removeClass("disabled")})),m.on("ok",(function(){i.ReplyCount=0,c.saveQuestion("reset",i)})),m.on("noSelected",(function(){c.saveQuestion(r?"regrade":"",i),m.close()}))}else if(3!==n&&!i.StandardId&&sCH.userM.showPopup("AuthoringCCStandard"))var v=new Backbone.BootstrapModal({title:"Add a standard to your question?",content:"<p>Doing so will provide you with a grading rubric and allow you to measure your students performance against standards.</p>",cssClass:"modal-al-confirm-no-cc-standard",cancelText:"No",okText:"Add Standard",doNotShowAgain:!0}).open((function(){s.isDoNotShowChecked(v)&&s.updateDoNotShowPopupSetting("AuthoringCCStandard"),c.$el.find(".firstStandardContainer .bootstrap-select.ddlCCStandardIds").addClass("flash")}),(function(){s.isDoNotShowChecked(v)&&s.updateDoNotShowPopupSetting("AuthoringCCStandard"),c.saveQuestion(null,i)}));else this.saveQuestion(null,i);return this.quesTypeChanged=!1,!1}s.bootstrap.alert({message:"Please enter some question text.",alert:"warning"})}}else s.bootstrap.alert({message:"It doesn't look like your question saved the first time! Can you please refresh the page and try again?",alert:"danger"})},saveQuestion:function(e,t){var n=this;if(this.model.get("Active")){this.model.set(t),t=this.model.toJSON(),this.$el.find(".questionTagViewMode").show().end().find(".questionTagEditMode").hide(),s.destroyMediumEditor(this.medium);var a=this.model.convertQuestionToLowerCaseKeys(t);this.model.collection.createNewTag(a,!1,this.model),this.model.set({Active:!1}),this.model.once("change:TagId",(function(){sCH.questionsNumC.addModel({QuestionTagId:n.model.get("TagId"),TextSectionId:n.model.get("TextSectionId"),StartIndex:n.model.get("StartIndex"),EndIndex:n.model.get("EndIndex"),QuestionNum:n.model.get("QuestionNum"),StandardId:n.model.get("StandardId"),SecondStandardId:n.model.get("SecondStandardId"),Type:n.model.get("SubType")}),n.fillEl(),s.intercom("trackEvent","editedlayer-addedq",{layerId:sCH.learnEntityMetaM.get("LayerId"),layerName:sCH.learnEntityMetaM.get("Title")}),sCH.readerConfig.isAssessment?Backbone.pubEv.trigger("saveQuizQuestionComplete",n.model):sCH.readerConfig.isMedia?Backbone.pubEv.trigger("saveMediaQuestionComplete",n.model):Backbone.pubEv.trigger("wrapQuestionsAtSameLocation",!1)}))}else this.$el.find(".questionTagViewMode").show().end().find(".questionTagEditMode").hide(),s.destroyMediumEditor(this.medium),this.model.get("StandardId")===t.StandardId&&this.model.get("SecondStandardId")==t.SecondStandardId||sCH.questionsNumC.updateModelStandards(this.model.get("TagId"),t.StandardId,t.SecondStandardId),this.model.saveData(t,{questionResponsesActionToTake:e}),this.fillEl(),s.intercom("trackEvent","editedlayer-updatedq",{layerId:sCH.learnEntityMetaM.get("LayerId"),layerName:sCH.learnEntityMetaM.get("Title")}),sCH.readerConfig.isAssessment?Backbone.pubEv.trigger("handleAssessmentArrows",!1):Backbone.pubEv.trigger("wrapQuestionsAtSameLocation",!1);this.tagListMode?($(".btnAddAssessmentQuestion").removeClass("displayNone"),$(".teacherQuestion").removeClass("disabled")):(null!=t.HTML&&""!=t.HTML||window.setTimeout((function(){Backbone.pubEv.trigger("updateMargin")}),100),this.enableQuestionsReordering())},deleteQuestion:function(){this.destroy(),this.tagListMode||(Backbone.pubEv.trigger("updateMargin"),this.enableQuestionsReordering()),this.isPreReadingQuestion&&$(".btnAddPreReadingQuestion").show()},enableQuestionsReordering:function(){$(".sameLocationQuestionsContainer .questionTagOrder .btn-box").removeClass("disabled")},cancel:function(e){if(sCH.readerConfig.isAssessment&&($(".btnAddAssessmentQuestion").removeClass("displayNone"),$(".teacherQuestion").removeClass("disabled"),this.model.get("TagId")||$(e.currentTarget).closest(".teacherQuestion").after('<div class="btn-box large btnAddAssessmentQuestion" data-questionorder="'+this.model.get("StartIndex")+'">Add Question</div>')),!this.model.get("TagId"))return sCH.teacherQuestionsC.remove(this.model),this.deleteQuestion(),void(sCH.readerConfig.isMedia&&Backbone.pubEv.trigger("addingQuestionCancelled"));this.$el.find(".questionTagViewMode").show().end().find(".questionTagEditMode").hide(),s.destroyMediumEditor(this.medium),this.fillEl(),sCH.readerConfig.isAssessment&&Backbone.pubEv.trigger("handleAssessmentArrows"),this.tagListMode||(null!=this.model.get("HTML")&&""!=this.model.get("HTML")||window.setTimeout((function(){Backbone.pubEv.trigger("updateMargin")}),100),this.enableQuestionsReordering())},del:function(e){var t=this.model.get("TagId"),n=""!==this.$el.find(".questionTagText [contenteditable]:eq(0)").text().trim();if(t||n){if(void 0!==e){var a=this;new Backbone.BootstrapModal({title:t?alcfg.confirmsText.questionDelete:"Delete new question?",content:"",cssClass:"modal-al-delete-question",okText:"Delete",cancelText:"Cancel"}).open((function(){s(a)}))}else null===t&&this.deleteQuestion();return!1}function s(e){null!==t?(e.model.deleteData(sCH.readerConfig.isAssessment),sCH.questionsNumC.deleteModel(t),Backbone.pubEv.trigger("questionDeleted",{questionTagId:t})):(sCH.readerConfig.isAssessment||sCH.readerConfig.isMedia)&&Backbone.pubEv.trigger("questionDeleted",{questionTagId:t}),null===t&&e.deleteQuestion()}s(this)},toggleExtraHelp:function(){if(sCH.userM.isOnFreeOrPersonalPlan())l.showBuyTeacherPopup({title:"Extra help for struggling students",content:alcfg.confirmsText.freeTExtraHelpQuestions});else{var e=this,t=function(){var t=e.$el.find(".extraHelpContainer");t.hasClass("displayNone")?(t.removeClass("displayNone"),e.$el.find(".btnAddExtraHelp").text("Remove extra help")):(t.addClass("displayNone"),e.$el.find(".btnAddExtraHelp").text("Add extra help"),e.model.set("ExtraHelpText",null),e.$el.find(".questionTagText [contenteditable]:eq(1)").empty())};if(sCH.userM.showPopup("HowToUseExtraHelp"))new Backbone.BootstrapModal({title:"How to use Extra Help",content:'<p>To show these extra help hints ONLY to students who need extra help, check "Extra Help" in your roster.                        </p><img class="animGif" src="/img/HowToExtraHelp_Reader.gif" />',cssClass:"modal-al-how-to-use-extra-help",allowCancel:!1,cancelText:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){t(),s.updateDoNotShowPopupSetting("HowToUseExtraHelp")}));else t()}},toggleModelResponse:function(){if(sCH.userM.isOnFreePlan())l.showBuyTeacherPopup({title:1===this.model.get("SubType")?"Model response":"Explanation"});else{var e=this.$el.find(".modelResponseContainer"),t=1===this.$el.find(".label .regular-radio:checked").data("subtype")?"model response":"explanation";e.hasClass("displayNone")?(e.removeClass("displayNone"),this.$el.find(".btnAddModelResponse span.caption").text("Remove "+t)):(e.addClass("displayNone"),this.$el.find(".btnAddModelResponse span.caption").text("Add "+t),this.$el.find(".modelResponseContainer [contenteditable]").empty())}},toggleDok:function(e){this.$el.find(".dokContainer").hasClass("displayNone")||!e?(this.$el.find(".btnAddDok").text("Remove DoK"),this.$el.find(".dokContainer").removeClass("displayNone"),window.ActivelyRead.showDok=!0):(this.$el.find(".ddlDok").selectpicker("val",""),this.$el.find(".btnAddDok").text("Add DoK"),this.$el.find(".dokContainer").addClass("displayNone"),window.ActivelyRead.showDok=!1)},toggleAddMediaContainer:function(){var e=this.$el.find(".questionTagEditMode"),t=e.find(".btnToggleMedia");e.find(".questionTagEditMediaContainer").toggleClass("displayNone"),t.toggleClass("removeMedia"),t.hasClass("removeMedia")?(e.find(".txtMedia").val(this.model.get("HTML")),t.text("Remove media")):(e.find(".txtMedia").val(""),t.text("Add media"))},showBuyPrimePopup:function(){l.showBuyTeacherPopup({title:"Adding media",content:alcfg.confirmsText.freeTAddMedia})},checkMedia:function(){if(this.model.get("HTML")){this.$el.find(".btnToggleMedia").text("Remove media").addClass("removeMedia"),this.$el.find(".questionTagEditMediaContainer").removeClass("displayNone"),this.$el.find(".questionTagHtml").removeClass("displayNone");var e="questionTagId:"+this.model.get("TagId");i.embedMediaFull({container:this.$el.find(".questionTagHtml"),mediaUrl:this.model.get("HTML"),tagTypeAndId:e})}else this.$el.find(".questionTagEditMediaContainer").addClass("displayNone"),this.$el.find(".questionTagHtml").addClass("displayNone"),this.$el.find(".btnToggleMedia").removeClass("removeMedia")},changeWeight:function(e){this.$el.find(".ddlWeights a").removeClass("selected"),$(e.currentTarget).addClass("selected")},changeAllowMediaResponses:function(e){this.$el.find(".ddlAllowMediaResponse a").removeClass("selected"),$(e.currentTarget).addClass("selected")},moveQuestionSelected:function(e){sCH.readerConfig.moveQuestionMode&&Backbone.pubEv.trigger("moveQuestionHereCancelled"),s.bootstrap.alert({message:"Highlight text to select the new location for the question.",alert:"warning",autoClose:!1,closable:!1}),sCH.readerConfig.moveQuestionMode=this.model.get("TagId"),this.$el.addClass("currentSelectionOutline")},addQuestionTextFromStem:function(e){var t=parseInt($(e.target).data("stemid")),n=a.find(alcfg.tags.question.stems,{id:t}),i=a.find(alcfg.tags.question.dok,{id:t}),o=$(e.target).closest(".questionTagEditMode"),r=o.find(".questionTagText > [contenteditable]");r.html(n.text),s.initMediumEditor(r),o.find("select.ddlDok").selectpicker("val",i.id),this.toggleDok(),o.find(".questionStemsDropdown").hide(),r.focus(),rangy.getSelection().collapse(r.get(0),1)},toggleQuestionStemsButton:function(e){var t=$(e.target).eq(0).text();this.$el.find(".questionStemsDropdown").toggle(0===t.length)},moveQuestionHere:function(e){if(sCH.readerConfig.moveQuestionMode===this.model.get("TagId")){var t=this.model.get("EndIndex"),n=$(".textview.view").height();delete sCH.readerConfig.moveQuestionMode,this.destroy(),Backbone.pubEv.trigger("questionDeleted",{questionTagId:this.model.get("TagId")});var a,i=this.model.toJSON(),o=sCH.questionsNumC.find({QuestionNum:this.model.get("QuestionNum")-1,TextSectionId:this.model.get("TextSectionId")}),r=sCH.questionsNumC.find({QuestionNum:this.model.get("QuestionNum")+1,TextSectionId:this.model.get("TextSectionId")}),l=-1===i.StartIndex&&-1!==i.EndIndex;if(a=l||o&&e.sel.end<o.get("EndIndex")||r&&e.sel.end>=r.get("EndIndex")&&-1!==r.get("StartIndex"),i.StartIndex=e.sel.start,i.EndIndex=e.sel.end,this.model.saveData(i,{shouldRenumberQuestions:a,needToUpdateEndIndex:l}),Backbone.pubEv.trigger("finishAddTag",this.model),Backbone.pubEv.trigger("wrapQuestionsAtSameLocation",!1),this.moveIdenticalEndIndexQuestionToEnd(this.model.get("TagId"),this.model.get("EndIndex")),this.enableQuestionsReordering(),t<this.model.get("EndIndex")){var d=n-$(".textview.view").height()+$('.questionTagViewMode[data-tagid="'+this.model.get("TagId")+'"]').parent().height();s.scrollElement().scrollTop(s.scrollElement().scrollTop()-d)}s.bootstrap.alert().close()}},moveIdenticalEndIndexQuestionToEnd:function(e,t){var n=a.filter(sCH.teacherQuestionsC.toJSON(),(function(e){return e.EndIndex===t}));if(n&&n.length){var s=$('.question[data-tagid="'+e+'"]').closest(".teacherQuestion"),i=$(s).closest(".sameLocationQuestionsContainer");s.insertAfter(i.children(".teacherQuestion").last()),$(".reader .scroll .textview").scrollTop(s.offset().top)}},moveQuestionHereCancelled:function(){sCH.readerConfig.moveQuestionMode===this.model.get("TagId")&&(s.bootstrap.alert().close(),delete sCH.readerConfig.moveQuestionMode,this.$el.removeClass("currentSelectionOutline"),this.enableQuestionsReordering())},fillEl:function(){var e={StandardSetDeleted:!1,StandardDeleted:!1,IsPublished:!0};sCH.userM.isOnPrimePlan()||(e.IsDefault=!0),this.standardSetsObj={titles:a.uniq(a.map(a.filter(sCH.readerConfig.standards,e),"Title")),currentTitle:this.model.get("StandardId")?s.getStandardById(this.model.get("StandardId")).Title:sCH.readerConfig.currentStandardSetTitleForText};var t={Text:this.model.get("Text"),ExtraHelpText:this.model.get("ExtraHelpText"),ModelResponse:this.model.get("ModelResponse"),HTML:this.model.get("HTML"),SubType:this.model.get("SubType"),StandardId:this.model.get("StandardId"),SecondStandardId:this.model.get("SecondStandardId"),Dok:this.model.get("Dok"),studentsList:alcfg.tags.question.students,qNum:sCH.questionsNumC.getQNumById(this.model.get("TagId")),QuestionTagId:this.model.get("TagId"),UpVotes:this.model.get("UpVotes"),DownVotes:this.model.get("DownVotes"),readerType:sCH.readerConfig.type,EndIndex:this.model.get("EndIndex"),tagListMode:this.tagListMode,Weight:this.model.get("Weight"),standardSetsObj:this.standardSetsObj,showDok:null!==this.model.get("Dok")||window.ActivelyRead.showDok,AllowMediaResponse:!0===this.model.get("AllowMediaResponse")};this.quesTypeChanged=!1,this.$el.html(this.qTemplate(t)+this.eTemplate(t)).addClass("teacherQuestion"),t.QuestionTagId&&sCH.readerConfig.isAssessment&&!sCH.learnEntityMetaM.get("RandomizeQuestionOrder")&&this.$el.find(".questionTagOrder").removeClass("displayNone"),this.checkMedia(),this.model.get("HasChoices")&&(this.$el.find(".questionChoices").removeClass("displayNone"),this.addChoiceHtml()),2===this.model.get("SubType")?this.$el.find(".randomizeQuestionContainer").show():this.$el.find(".randomizeQuestionContainer").hide(),this.$el.hasClass("pinned")&&this.$el.find(".icon-pin").addClass("icon-pinfilled"),this.isPreReadingQuestion&&($(".btnAddPreReadingQuestion").hide(),this.$el.find(".btnMoveQuestion").hide()),s.initTooltips(this.$el,{},":not(.standardSetName)"),sCH.userM.isOnPrimePlan()||(l.hidePrimeFeatureText(this.$el.find(".extraHelpText")),l.hidePrimeFeatureText(this.$el.find(".modelResponse"))),c.mobile&&this.$el.find(".dropdown-submenu").on("click",(function(e){$(e.target).hasClass("moreOptionSubmenu")&&e.stopPropagation()}))},changeStandardSet:function(e,t){sCH.readerConfig.currentStandardSetTitleForText=t,e.data("standardset",t),this.renderStandardSet(e,t)},includeSecondStandard:function(e){var t=this,n=$(e.currentTarget),i='<select data-width="100%" data-live-search="true">';a.each(this.standardSetsObj.titles,(function(e){var t=s.sanitize(e.replace(/'/g,"&#39;"));i+='<option val="'+t+'">'+t+"</option>"})),i+="</select>";var o=new Backbone.BootstrapModal({title:"Select second standard set",content:i,cssClass:"modal-al-question-select-standardset",allowCancel:!0,cancelText:"Cancel",okText:"Add Standard Set"}).open((function(){o.preventClose();var e=o.$el.find("select").val();e!==n.data("standardset")&&t.addSecondStandard(e),o.close()}));o.$el.on("shown.bs.modal",(function(e){o.$el.find("select").selectpicker({liveSearchPlaceholder:"Start typing to search..."})})),n.val(n.data("previous")).selectpicker("refresh")},removeSecondStandard:function(e){this.$el.find(".secondStandardContainer").addClass("displayNone"),this.$el.find(".btnRemoveSecondStandard").addClass("displayNone"),this.$el.find(".btnAddSecondStandard").removeClass("displayNone"),this.$el.find(".secondStandardContainer select.ddlCCStandardIds").val(null)},addSecondStandard:function(e,t){this.renderStandardSet(this.$el.find(".secondStandardContainer select.ddlCCStandardIds"),e,t),this.$el.find(".secondStandardContainer").removeClass("displayNone"),this.$el.find(".btnAddSecondStandard").addClass("displayNone"),this.$el.find(".btnRemoveSecondStandard").removeClass("displayNone")},renderStandardSet:function(e,t,n){var i=t||sCH.readerConfig.currentStandardSetTitleForText,o="<option value=''>Select a standard</option>",r=a.filter(sCH.readerConfig.standards,{Title:i,StandardSetDeleted:!1,StandardDeleted:!1,IsPublished:!0});a.each(r,(function(e,t){o+="<option "+(n&&e.StandardId===n?"selected":"")+" value='"+e.StandardId+"'>"+e.StandardCode+" - "+e.ShortText+"</option>"})),o+='<option value="changeset" data-content="<span class=\'btn-box callout\'>Change standard set</span>">Change standard set</option>',e.html(o).attr("data-standardset",i).selectpicker("refresh"),n?e.nextAll(".questionCCStandardDescription").eq(0).html(s.getStandardById(n).Description):e.nextAll(".questionCCStandardDescription").eq(0).html(""),this.model.get("Active")&&this.$el.find(".btnMoveQuestion").hide()},bringToFront:function(){this.$el.find(".ddlCCStandardIds").hasClass("open")||this.$el.addClass("bringToFront")},standardSelected:function(e){var t=$(e.currentTarget),n=t.find("option:selected").val();if(""===n)t.nextAll(".questionCCStandardDescription").html("");else if("changeset"===n){var i=this,o='<select data-width="100%" data-live-search="true">';a.each(this.standardSetsObj.titles,(function(e){var n=s.sanitize(e.replace(/'/g,"&#39;"));o+='<option val="'+n+'" '+(t.data("standardset")===e?"selected":"")+">"+n+"</option>"})),o+="</select>";var r=new Backbone.BootstrapModal({title:"Select standard set",content:o,cssClass:"modal-al-question-select-standardset",allowCancel:!0,cancelText:"Cancel",okText:"Update"}).open((function(){r.preventClose();var e=r.$el.find("select").val();e!==t.data("standardset")&&i.changeStandardSet(t,e),r.close()}));r.$el.on("shown.bs.modal",(function(e){r.$el.find("select").selectpicker({liveSearchPlaceholder:"Start typing to search..."})})),t.val(t.data("previous")).selectpicker("refresh")}else{var l=s.getStandardById(parseInt(n)).Description;t.nextAll(".questionCCStandardDescription").html(l)}"changeset"!==n&&t.removeClass("flash").data("previous",n)},selectType:function(e){e&&(this.quesTypeChanged=!0,this.model.set("SubType",$(e.currentTarget).data("subtype")),e.stopPropagation()),this.$el.find(".ccDetail").show(),this.$el.find(".questionChoices").removeClass("poll"),this.$el.find(".btnAddModelResponse, .modelResponseContainer").show(),this.$el.find(".btnChangeWeight, .btnAddDok, .btnAddSecondStandard, .btnRemoveSecondStandard, .addDropdown .divider").css("display","block"),2===this.model.get("SubType")?(this.addChoiceHtml(),this.$el.find(".questionChoices").show(),this.$el.find(".randomizeQuestionContainer").show(),this.$el.find(".btnAddModelResponse, .modelResponseContainer").show()):3===this.model.get("SubType")?(this.addChoiceHtml(),this.$el.find(".questionChoices").addClass("poll").show(),this.$el.find(".randomizeQuestionContainer").hide(),this.$el.find(".ccDetail").hide(),this.$el.find(".btnAddModelResponse, .modelResponseContainer").hide(),this.$el.find(".btnChangeWeight, .btnAddDok, .btnAddSecondStandard, .btnRemoveSecondStandard, .addDropdown .divider").hide()):(this.$el.find(".questionChoices").hide(),this.$el.find(".randomizeQuestionContainer").hide()),this.toggleModelResponseType()},toggleModelResponseType:function(){var e=this.model.get("SubType"),t=1!==e&&e?"model response":"explanation",n=1!==e&&e?"explanation":"model response";this.$el.find(".modelResponseContainer .heading").text(n),this.$el.find(".modelResponseContainer [contenteditable]").data("placeholder","Enter "+n).attr("placeholder","Enter "+n).attr("data-placeholder","Enter "+n),this.$el.find(".btnAddModelResponse span.caption").text(this.$el.find(".btnAddModelResponse span.caption").text().replace(t,n))},addChoiceHtml:function(){this.$el.find(".choices").empty();var e=this,t="",n=this.model.get("QuestionChoices"),i=0;if(n&&n.length>0)a.each(n,(function(n,a){t+=e.renderChoice(n),i+=n.IsCorrect?1:0})),i>1&&this.$el.find("#divMultiSelectInfo").removeClass("displayNone");else for(var o=0;o<2;o++)t+=e.renderChoice(o);this.$el.find(".choices").html(t),this.renderHiddenChoiceIcon(),this.$el.find(".questionTagEditMode .txtChoice").prop("contenteditable",!0),this.medium&&this.medium.push(s.initMediumEditor(this.$el.find(".questionTagEditMode .txtChoice")))},addChoice:function(e){return this.$el.find(".questionChoices .choices").append(this.renderChoice(1)),this.medium.push(s.initMediumEditor(this.$el.find(".questionChoices .choices .choice:last-child [contenteditable]"))),this.$el.find(".questionChoices .choice:last-child").find(".txtChoice").focus(),this.renderHiddenChoiceIcon(),!1},deleteChoice:function(e){if(2!==this.$el.find(".choice").length){var t=$(e.currentTarget);return t.hasClass("disabled")||t.parent().parent().remove(),this.renderHiddenChoiceIcon(),!1}s.bootstrap.alert({message:"You need at least 2 choices.",alert:"warning"})},renderChoice:function(e){var t=!sCH.userM.isAnonUser()&&(isNaN(e)?e.IsCorrect:0===e),n=isNaN(e)?e.Text:"";this.model.get("SubType");return'<div class="choice"><div class="left mid"><div class="checkBoxMe">'+(t?'<div class="selected"></div>':"")+'</div></div><div class="middle"><div class="txtChoice"'+(isNaN(e)?"":'contenteditable="true"')+' placeholder="Enter choice text">'+n+'</div></div><div class="right"><div class="icon-trash btnDeleteChoice '+(t?"disabled":"")+'"></div><span class="icon-person extraHelpIcon" title="This choice will not appear to students designated as needing Extra Help."></span></div></div>'},renderHiddenChoiceIcon:function(){if(this.$el.find(".choice .icon-person").remove(),sCH.userM.isOnPrimePlan()&&2===this.model.get("SubType")){var e=this.$el.find(".questionTagEditMode .choices .choice");if(e.length>1){var t='<span class="icon-person extraHelpIcon" title="This choice will not appear to students designated as needing Extra Help."></span>',n=e.find(".checkBoxMe:not(:has(.selected))");if(n.length>1){var a=$(n[0]).closest(".choice");a.find(".right").append(t);var i=e.index(a);$(this.$el.find(".questionTagViewMode .choices .choice")[i]).find(".right").append(t),s.initTooltips(this.$el)}}}},selectAnswer:function(e){var t=$(e.currentTarget);return t.find(".selected").length>0?t.find(".selected").remove():t.html("<div class='selected'></div>"),t.parent().parent().find(".btnDeleteChoice").toggleClass("disabled"),this.$el.find(".questionTagEditMode .questionChoices .checkBoxMe .selected").length>1?this.$el.find("#divMultiSelectInfo").removeClass("displayNone"):this.$el.find("#divMultiSelectInfo").addClass("displayNone"),this.renderHiddenChoiceIcon(),!1},questionOrderUp:function(e){e.stopPropagation();var t=this.model.get("TagId"),n=$(".textview").find(".questionTagOrder .btn-box");n.addClass("disabled"),t&&o.SwapQuestion(t,"up",(function(e){e&&(Backbone.pubEv.trigger("swapQuestionComplete",{questionTagId:t,moveDirection:"up"}),n.removeClass("disabled"))}))},questionOrderDown:function(e){e.stopPropagation();var t=this.model.get("TagId"),n=$(".textview").find(".questionTagOrder .btn-box");n.addClass("disabled"),t&&o.SwapQuestion(t,"down",(function(e){e&&(Backbone.pubEv.trigger("swapQuestionComplete",{questionTagId:t,moveDirection:"down"}),n.removeClass("disabled"))}))},questionNumUpdate:function(e){if(this.model.get("TagId")===e){var t=sCH.questionsNumC.getQNumById(this.model.get("TagId"));this.$el.find(".questionTagTitle .qNum").text("question "+t),this.model.set("QuestionNum",t)}},embedMedia:function(e){var t="paste"===e.type?e.originalEvent.clipboardData.getData("text"):this.$el.find(".txtMedia").val();s.alertLongUrl(t)&&(r.checkUrl(t)?i.embedMediaFull({container:this.$el.find(".questionTagMediaContainer"),mediaUrl:t}):this.$el.find(".questionTagMediaContainer").empty())},manageExtraHelpStudents:function(){d.renderManageExtraHelpStudentsPopup()},destroy:function(){this.tagListMode&&this.$el.next(".btnViewInReader").remove(),Backbone.pubEv.off("questionNumUpdated",this.questionNumUpdate,this),Backbone.pubEv.off("moveQuestionHere",this.moveQuestionHere,this),Backbone.pubEv.off("moveQuestionHereCancelled",this.moveQuestionHereCancelled,this),s.destroyMediumEditor(this.medium),this.remove(),this.undelegateEvents(),this.model.off(null,null,this)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="arrow"></div>\r\n<div class="questionTagViewMode question '+(null==(__t=1!==SubType?"multichoice":"")?"":__t)+'" data-tagid="'+(null==(__t=QuestionTagId)?"":__t)+'" data-endindex="'+(null==(__t=EndIndex)?"":__t)+'">\r\n    ',"authoring"!==readerType||sCH.readerConfig.isReadOnly||(__p+='\r\n        <div class="dropdown questionDropdown pull-right">\r\n            <a class="icon-moreactions btnQuestionDropdown"\r\n                title=""\r\n                role="button"\r\n                data-toggle="dropdown"\r\n                aria-haspopup="true"\r\n                aria-expanded="false"></a>\r\n            <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="btnQuestionDropdown">\r\n                <li><a class="btnEdit">Edit</a></li>\r\n                <li><a class="btnDelete">Delete</a></li>\r\n            </ul>\r\n        </div>\r\n    '),__p+="\r\n    ","grading"===readerType||sCH.readerConfig.isPDF||tagListMode||(__p+='\r\n        <div class="icon-pin btnPin clickable" title="Pin question" data-placement="left"></div>\r\n    '),__p+="\r\n    ","authoring"!==readerType||sCH.readerConfig.isReadOnly||(__p+='\r\n        <div class="questionTagOrder questionTagButtons displayNone" data-questiontagid="'+(null==(__t=QuestionTagId)?"":__t)+'">\r\n            <span class="pull-right" title="Reorder questions">\r\n                <span class="btn-box pull-right inverse icon-arrowdown btnQuestionOrderDown"></span>\r\n                <span class="btn-box pull-right inverse icon-arrowup btnQuestionOrderUp"></span>\r\n            </span>\r\n        </div>\r\n    '),__p+='\r\n    <div class="questionTagTitle">\r\n        <span class="heading inverse qNum">question '+(null==(__t=qNum)?"":__t),print(3===SubType?" (poll)":""),__p+="</span>\r\n        ",3!==SubType){__p+="\r\n            ",Dok&&(__p+='\r\n                <span class="heading inverse qDok" title="'+(null==(__t=_.find(alcfg.tags.question.dok,{id:Dok}).text)?"":__t)+'" data-placement="bottom">\r\n                    DOK '+(null==(__t=Dok)?"":__t)+"\r\n                </span>\r\n            "),__p+="\r\n\r\n            ";var ssObj=sCH.readerConfig.isReadOnly?cH.getStandardByIdForAuthoringPreview(StandardId):cH.getStandardById(StandardId);if(ssObj&&"N/A"!==ssObj.StandardCode){if(__p+='\r\n                <span class="heading inverse showRubric '+(null==(__t="student"===readerType?"clickable":"")?"":__t)+'" data-standardid="'+(null==(__t=StandardId)?"":__t)+'">Standard '+(null==(__t=cH.sanitize(ssObj.StandardCode))?"":__t)+"</span>\r\n                ",SecondStandardId){var secondStandardObj=sCH.readerConfig.isReadOnly?cH.getStandardByIdForAuthoringPreview(SecondStandardId):cH.getStandardById(SecondStandardId);__p+='\r\n                    <span class="heading inverse showRubric '+(null==(__t="student"===readerType?"clickable":"")?"":__t)+'" data-standardid="'+(null==(__t=SecondStandardId)?"":__t)+'">'+(null==(__t=cH.sanitize(secondStandardObj.StandardCode))?"":__t)+"</span>\r\n                "}__p+="\r\n            "}else"student"!==readerType&&(__p+='\r\n                <span class="heading inverse noStandard">no standard</span>\r\n            ');__p+="\r\n        "}__p+="\r\n        ",Weight&&Weight>1&&(__p+='\r\n            <span class="heading inverse questionWeight" title="This question will be worth '+(null==(__t=Weight)?"":__t)+'x number of points">'+(null==(__t=Weight)?"":__t)+"x</span>\r\n        "),__p+='\r\n    </div>\r\n    <div class="questionTagText">\r\n        '+(null==(__t=cH.sanitize(Text))?"":__t)+'\r\n        <div class="extraHelpContainer ',print(ExtraHelpText&&ExtraHelpText.length>0?"":"displayNone"),__p+='">\r\n            <span class="heading inverse">\r\n                Extra Help\r\n            </span>\r\n            ',"student"!==readerType&&sCH.userM.isOnPrimePlan()&&(__p+='\r\n                <span class="icon-person extraHelpIcon" title=\''+(null==(__t=alcfg.infoText.generic.extraHelp)?"":__t)+"' data-container='body' data-placement='bottom'></span>\r\n            "),__p+="\r\n            ","authoring"!==readerType||sCH.userM.isOnPrimePlan()||(__p+='\r\n                <span class="icon-premium-lock" data-placement="top" title=\''+(null==(__t=alcfg.freeTeacherTooltipText.question)?"":__t)+"'></span>\r\n            "),__p+='\r\n            <div class="extraHelpText">'+(null==(__t=cH.sanitize(ExtraHelpText))?"":__t)+'</div>\r\n        </div>\r\n    </div>\r\n    <div class="questionTagHtml embedMediaFullContainer"></div>\r\n    <div class="questionChoices displayNone"><div class="choices"></div></div>\r\n    <div class="modelResponseContainer ',print(ModelResponse&&ModelResponse.length>0&&3!==SubType?"":"displayNone"),__p+='">\r\n        <span class="heading inverse">\r\n            '+(null==(__t=1===SubType?"Model Response":"Explanation")?"":__t)+"\r\n        </span>\r\n        ","authoring"!==readerType||sCH.userM.isOnPrimePlan()||(__p+='\r\n            <span class="icon-premium-lock" data-placement="top" title=\''+(null==(__t=alcfg.freeTeacherTooltipText.modelResponse)?"":__t)+"'></span>\r\n        "),__p+='\r\n        <div class="modelResponse">'+(null==(__t=cH.sanitize(ModelResponse))?"":__t)+"</div>\r\n    </div>\r\n</div>"}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(86),r=n(1767),l=n(168),d=n(823),c=n(48),u=n(233),p=n(129),h=n(170),g=n(43);t.default=Backbone.View.extend({qTemplate:n(519),gTemplate:n(822),rTemplate:n(1770),aTemplate:n(1771),previousResponseListTemplate:n(1772),element:{},questionObj:{},answerH:null,events:{"click .btnSubmit":"submitAnswer","click .questionTagGrading:not(.noPeerResponse)":"showResponsesList","click .showRubric":"showRubric","click .btnSaveDraft":"saveDraft","click .btnUndoAnswer":"undoAnswer","click .btnResetAnswer":"resetAnswer","click .btnRequestResetAnswer":"requestResetAnswer","keyup [contenteditable]:not(.ansUpdated)":"answerChanged","click .textareaContainer":"enableContentEditable","touchstart .choice .left":"selectAnswer",'change .choice:not(.disabled) .accessibilityEnabledCheckbox input[type="checkbox"]':"selectAnswer","click .choice:not(.disabled) .middle, .choice:not(.disabled) .left":"selectAnswer","click .btnSubmit, .btnSaveDraft, [contenteditable]":"lockedWarning","click .btnPin":"togglePinQuestion","focus [contenteditable]":"startWriting","blur [contenteditable]":"stopWriting","click .btnViewAnswerHistory":"viewAnswerHistory","click .btnAddURL":"showAddMediaFromUrlTextbox","click .btnAddFromComputer":"openUploadFilePopup","paste .txtMediaUrl":"embedMedia","blur .txtMediaUrl":"embedMedia","click .btnRemoveMedia":"removeAddedMedia","click .btnToggleMinimization":"toggleQuestionMinimization"},initialize:function(e){this.element=e.element,this.tagListMode=e.tagListMode,this.questionNumObj=sCH.questionsNumC.find({QuestionTagId:this.model.get("TagId")}),sCH.questionTagResponsesC.on("add",this.responseSubmitted,this),sCH.questionTagResponsesC.on("remove",this.responseDeleted,this),sCH.questionTagResponsesC.on("change",this.responseGraded,this),sCH.teacherQuestionsC.on("change",this.updatedQuestionCorrectChoices,this),Backbone.pubEv.on("questionNumUpdated",this.questionNumUpdate,this),this.tagListMode||Backbone.pubEv.on("getGateTag",this.getGateTag,this),this.model.get("HasChoices")&&(this.questionChoices=2===this.model.get("SubType")&&this.model.get("RandomizeChoices")?s.randomizeArray(this.model.get("QuestionChoices"),window.ActivelyRead.currentUserId+this.model.get("TagId")):this.model.get("QuestionChoices")),Backbone.pubEv.on("draftUnsavedResponses",this.draftUnsavedResponse,this)},startWriting:function(){Backbone.tracking.logNSFEvent({event:"answer - start writing",details:this.questionNumObj.get("QuestionNum"),details2:this.$el.find("[contenteditable]").text().length,tagType:"question - "+this.questionNumObj.get("SubType"),tagId:this.questionNumObj.get("QuestionTagId")})},stopWriting:function(e){var t=$(e.currentTarget);if(Backbone.tracking.logNSFEvent({event:"answer - stop writing",details:this.questionNumObj.get("QuestionNum"),details2:t.text().length,tagType:"question - "+this.questionNumObj.get("SubType"),tagId:this.questionNumObj.get("QuestionTagId")}),""===t.text().trim()){var n='.teacherQuestion.cloned .questionTagViewMode[data-tagid="'+this.questionNumObj.get("QuestionTagId")+'"]';0===$(n).length&&(s.destroyMediumEditor(this.medium),t.attr("contenteditable","true").html(""),delete this.medium)}},lockedWarning:function(){sCH.readerConfig.assignmentLocked&&s.bootstrap.alert({message:"This assignment is locked. No changes may be made.",alert:"danger"})},render:function(){return this.fillEl(),this.isMinimizeSettingOn()&&this.toggleQuestionMinimization(null,"on"),this.$el},updatedQuestionCorrectChoices:function(e){e.get("TagId")===this.model.get("TagId")&&this.answeredByCurrentUser&&this.fillEl()},togglePinQuestion:function(e){var t=$(e.currentTarget).parent().parent(),n=t.hasClass("pinned"),a=t.parent().hasClass("endSectionQuestions"),i=$(".teacherQuestion.cloned");if(i.length>0){if(this.$el.css("visibility","visible"),1===this.model.get("SubType")){var o=i.find("[contenteditable]").html();this.$el.find("[contenteditable]").html(o)}else{var r=this.$el.find(".questionChoices .choice");this.$el.find('.choice .accessibilityEnabledCheckbox input[type="checkbox"]').prop("checked",!1),i.find(".choice").each((function(e,t){$(t).find('.accessibilityEnabledCheckbox input[type="checkbox"]:checked').length>0&&$(r[e]).find('.accessibilityEnabledCheckbox input[type="checkbox"]').prop("checked",!0)}))}$(".teacherQuestion").css("visibility","visible"),i.remove()}if($(".teacherQuestion.pinned").length>0&&($(".teacherQuestion.pinned").css("width","initial").removeClass("pinned").find(".icon-pinfilled").attr("data-original-title","Pin question").removeClass("icon-pinfilled"),s.realignScrollForPinnedQuestion(this.prevHeight,t.find(".questionTagViewMode").data("tagid")),this.prevHeight=null),n)s.initTooltips(this.$el.find(".btnPin").parent());else if(this.questionNumObj.get("IsGated")||a){t.find(".btnPin").next().removeClass("fade").tooltip("destroy");var l=t.clone(!0,!0).addClass("cloned pinned");t.css("visibility","hidden"),l.find(".icon-pin").attr("data-original-title","Unpin question").addClass("icon-pinfilled"),l.find(".btnSubmit, .btnSaveDraft").on("click",(function(e){s.bootstrap.alert({message:"Unpin question before submitting response.",alert:"warning"}),e.stopPropagation()})),s.initMediumEditor(l.find("[contenteditable]")),s.initTooltips(l.find(".btnPin").parent()),a?l.insertAfter($(".textSection")):l.insertAfter(t)}else{var d=t.outerHeight(!0)-parseInt(t.find(".arrow").css("borderRightWidth"));this.prevHeight=$(".textSectionContainer .textSection").height()-d;var c=g.safari||s.onDevice()?"pinned unfix":"pinned";t.addClass(c).find(".icon-pin").attr("data-original-title","Unpin question").addClass("icon-pinfilled")}return s.updatePinnedQuestionWidth(),!1},draftUnsavedResponse:function(){this.$el.find("[contenteditable]").hasClass("ansUpdated")&&""!==this.$el.find("[contenteditable]").text().trim()&&this.saveDraft()},getGateTag:function(e){e.QuestionTagId===this.model.get("TagId")&&e.callback(this.$el)},enableContentEditable:function(e){var t=this.$el.find("[contenteditable]");this.medium||(this.medium=s.initMediumEditor(t)),s.onDevice()&&"false"==t.attr("contenteditable")&&!sCH.readerConfig.assignmentLocked&&(t.attr("contenteditable","true"),t.focus())},showResponsesList:function(e){if(!$(e.target).parent().hasClass("questionTagHtml")){if(3===this.model.get("SubType")&&this.answeredByCurrentUser)this.toggleClassResults();else if((1===this.model.get("SubType")&&"none"!==sCH.readerConfig.Settings.ViewPeerResponses||2===this.model.get("SubType")&&sCH.readerConfig.Settings.AllowStudentsMCAnswer)&&this.answeredByCurrentUser){if(1===this.model.get("SubType")&&!sCH.readerConfig.isAssessment)this.questionObj.Responses=sCH.questionTagResponsesC.getResponseModelsByTagId(this.model.get("TagId")),this.questionObj.QuestionTagId=this.model.get("TagId"),new Backbone.BootstrapModal({title:"Viewing responses for Question "+this.model.get("QuestionNum"),content:new r.default(this.questionObj),cssClass:"modal-al-responses-list",cancelText:!1,allowCancel:!0,okText:"Close"}).open().on("shown",(function(){$(".connection.offline").length&&$(".questionTagResponses .voting").addClass("offline")}));var t={assignmentId:sCH.readerConfig.assignmentId,questionTagId:this.model.get("TagId"),userId:sCH.userM.get("UserId")};Backbone.tracking.trackGAEvent("viewotherresponses",t),Backbone.tracking.logReaderEvent("viewotherresponses",t)}return!1}},selectAnswer:function(e){var t=$(e.currentTarget).closest(".choice").find('.accessibilityEnabledCheckbox input[type="checkbox"]');if(!sCH.readerConfig.assignmentLocked&&!t.hasClass("disabled"))return this.model.get("NumCorrectChoices")>1?t.is(":checked")?t.prop("checked",!1):t.prop("checked",!0):($(e.currentTarget).closest(".questionChoices").find('.accessibilityEnabledCheckbox input[type="checkbox"]').not("#"+t.attr("id")).prop("checked",!1),t.prop("checked",!0)),e.type,!1},submitAnswer:function(e){if(!sCH.readerConfig.assignmentLocked){var t={QuestionTagId:this.model.get("TagId"),AssignmentId:sCH.readerConfig.assignmentId,IsDraft:!1,SawExtraHelp:!!this.model.get("ExtraHelpText"),StudentLayerId:sCH.readerConfig.studentLayerId},n=this;if(this.model.get("HasChoices")){var a=this.questionChoices,i=[];if(this.$el.find(".choice").each((function(e,t){$(t).find('.accessibilityEnabledCheckbox input[type="checkbox"]').is(":checked")&&a[e]&&i.push(a[e].QuestionChoiceId)})),0===i.length)return void s.bootstrap.alert({message:"Please select a choice.",alert:"warning"});t.Text=i.sort((function(e,t){return e-t})).join(",")}else{var o=s.getTextFromContenteditableElement(this.$el.find("[contenteditable]")),r=s.getTextFromInputElement(this.$el.find('input[name="txtMediaUrl"]'));if(this.isInvalidAnswer(o,r))return void s.bootstrap.alert({message:"Please enter some answer text or add valid media as your response.",alert:"warning"});t.Text=o||void 0,t.MediaUrl=r||void 0;var l=s.calculateWordAndCharacterCountFromHtml(o);if(t.WordCount=l.wordCount,s.alertLongContenteditableText(l.characterCount))return}return"tour"===sCH.readerConfig.type&&(p.isActionCurrentStep("question answered")?p.advance():p.blinkStepNumber()),this.$el.find(".btnSubmit").text("Submitting...").addClass("disabled").prop("disabled",!0),this.model.get("HasChoices")||this.$el.find(".btnSaveDraft").addClass("displayNone"),sCH.questionTagResponsesC.addAnswer(t,(function(e){e?n.responseSubmitted(e):1===n.model.get("SubType")&&n.$el.find("[contenteditable]").removeClass("ansUpdated")})),this.$el.hasClass("pinned")&&this.$el.find(".btnPin").click(),Backbone.tracking.trackGAEvent("response","submit"),Backbone.tracking.trackGAEvent("response:submit",{assignmentId:sCH.readerConfig.assignmentId,tagId:this.model.get("TagId")}),Backbone.tracking.logNSFEvent({event:"answer - submit",details:this.questionNumObj.get("QuestionNum"),details2:this.$el.find("[contenteditable]").text().length,tagType:"question - "+this.questionNumObj.get("SubType"),tagId:this.questionNumObj.get("QuestionTagId")}),sCH.userM.get("IntercomTrial")&&sCH.teacherQuestionsC.last().get("TagId")==this.model.get("TagId")&&s.intercom("trackEvent","reader-answered-last-question",{assignmentId:sCH.readerConfig.assignmentId,tagId:this.model.get("TagId")}),!1}},saveDraft:function(e){if(!sCH.readerConfig.assignmentLocked){var t=s.getTextFromContenteditableElement(this.$el.find("[contenteditable]")),n=s.getTextFromInputElement(this.$el.find('input[name="txtMediaUrl"]')),a={QuestionTagId:this.model.get("TagId"),AssignmentId:sCH.readerConfig.assignmentId,StudentLayerId:sCH.readerConfig.studentLayerId,Text:t||void 0,MediaUrl:n||void 0,IsDraft:!0,SawExtraHelp:!!this.model.get("ExtraHelpText")},i=this;if(this.isInvalidAnswer(t,n))s.bootstrap.alert({message:"Please enter some answer text or add valid media as your response.",alert:"danger"});else{var o=s.calculateWordAndCharacterCountFromHtml(a.Text);if(a.WordCount=o.wordCount,!s.alertLongContenteditableText(o.characterCount))return this.$el.find(".btnSaveDraft").text("Saving...").addClass("disabled").prop("disabled",!0),this.$el.find(".btnSubmit").addClass("displayNone"),sCH.questionTagResponsesC.addAnswer(a,(function(e){i.responseSubmitted(e)})),e&&s.bootstrap.alert({message:"Draft saved!"}),Backbone.tracking.trackGAEvent("response","draft"),Backbone.tracking.trackGAEvent("response:draft",{assignmentId:sCH.readerConfig.assignmentId,tagId:this.model.get("TagId")}),Backbone.tracking.logNSFEvent({event:"answer - save draft",details:this.questionNumObj.get("QuestionNum"),details2:this.$el.find("[contenteditable]").text().length,tagType:"question - "+this.questionNumObj.get("SubType"),tagId:this.questionNumObj.get("QuestionTagId")}),!1}}},isInvalidAnswer:function(e,t){return e?!!t&&this.$el.find(".studentResponseMediaContainer").hasClass("mediaLoadingError"):!this.model.get("AllowMediaResponse")||!t||this.$el.find(".studentResponseMediaContainer").hasClass("mediaLoadingError")},undoAnswer:function(e){var t=this,n=sCH.questionTagResponsesC.getCurrentUserResponseByQuestionTagId(this.model.get("TagId"));return this.undoTimer&&window.clearTimeout(this.undoTimer),sCH.questionTagResponsesC.undoAnswer(n,(function(e){t.responseSubmitted(e),Backbone.pubEv.trigger("gatedQuestionAnswerUndo",{undoAnswerQuestionTagId:t.model.get("TagId")})})),Backbone.tracking.logNSFEvent({event:"answer - undo",details:this.questionNumObj.get("QuestionNum"),tagType:"question - "+this.questionNumObj.get("SubType"),tagId:this.questionNumObj.get("QuestionTagId")}),!1},resetAnswer:function(e){var t=this,n=sCH.questionTagResponsesC.getCurrentUserResponseByQuestionTagId(this.model.get("TagId"));return sCH.questionTagResponsesC.resetAnswer(n,(function(e){t.questionNumObj.set({AnsweredByCurrentUser:!1}),t.fillEl()})),Backbone.tracking.logNSFEvent({event:"answer - reset",details:this.questionNumObj.get("QuestionNum"),tagType:"question - "+this.questionNumObj.get("SubType"),tagId:this.questionNumObj.get("QuestionTagId")}),!1},requestResetAnswer:function(e){if(!$(e.currentTarget).hasClass("disabled")){var t=this,n=function(e){var n=sCH.questionTagResponsesC.getCurrentUserResponseByQuestionTagId(t.model.get("TagId"));e&&s.updateDoNotShowPopupSetting("StudentRequestResetAnswer"),sCH.questionTagResponsesC.requestResetAnswer(n,(function(e){e.set("IsStudentRequestReset",!0),t.fillEl()})),Backbone.tracking.logNSFEvent({event:"answer - reset request",details:t.questionNumObj.get("QuestionNum"),tagType:"question - "+t.questionNumObj.get("SubType"),tagId:t.questionNumObj.get("QuestionTagId")}),"student"===sCH.readerConfig.type&&"student"!==sCH.userM.get("Role")||s.bootstrap.alert({message:"Your teacher has been notified! Please check back soon."})};if(sCH.userM.showPopup("StudentRequestResetAnswer")){if("student"===sCH.readerConfig.type&&"student"!==sCH.userM.get("Role"))return void c.showReviseAnswerPopup();var a=new Backbone.BootstrapModal({content:"Your teacher will be notified that you want to revise your response. Continue?",cssClass:"modal-al-confirm-reset-request",allowCancel:!0,doNotShowAgain:!0,okText:"Got it!"}).open((function(){n(a)}))}else n(!1);return!1}},responseSubmitted:function(e){var t=this;if(e.get("QuestionTagId")===this.model.get("TagId"))if(window.ActivelyRead.currentUserId!==e.get("UserId"))this.answeredByCurrentUser&&this.fillEl();else{var n=!e.get("IsDraft"),s=!this.model.get("HasChoices"),i=this.questionNumObj.get("IsGated")&&n;if(this.questionNumObj.set({IsGated:!n}),this.questionNumObj.set({AnsweredByCurrentUser:n}),this.fillEl(),n){if(i&&Backbone.pubEv.trigger("gatedQuestionAnswered",{answeredQuestionTagId:this.model.get("TagId")}),s&&null===e.get("Grade")&&"tour"!==sCH.readerConfig.type)if(this.$el.find(".btnUndoAnswer").removeClass("displayNone"),this.$el.find(".btnResetAnswer, .btnRequestResetAnswer").addClass("displayNone"),!($(".connection.offline").length>0)){var o=a.uniq(sCH.questionTagResponsesC.toJSON().filter((function(e){return!e.IsDraft&&e.CreatedByCurrentUser})).map((function(e){return e.QuestionTagId})));sCH.questionsNumC.length!==o.length||sCH.readerConfig.completionAnimationAlreadyShown?this.startUndoTimer():h.trigger({type:"completion",callback:function(){return t.startUndoTimer()}})}this.tagListMode||Backbone.pubEv.trigger("updateMargin"),sCH.readerConfig.isMedia&&Backbone.pubEv.trigger("mediaResponseSubmitted")}}},startUndoTimer:function(){var e=this;this.undoTimer=window.setTimeout((function(){e.$el.find(".btnUndoAnswer").addClass("displayNone"),"studentir"!==sCH.readerConfig.type&&(sCH.readerConfig.Settings.DisAllowAnswerEditing?e.$el.find(".btnRequestResetAnswer").removeClass("displayNone"):e.$el.find(".btnResetAnswer").removeClass("displayNone"))}),5e3),$.timeouts&&$.timeouts.push(this.undoTimer)},responseDeleted:function(e){e.get("QuestionTagId")===this.model.get("TagId")&&(window.ActivelyRead.currentUserId===e.get("UserId")&&(this.questionNumObj.set({IsGated:!0}),this.questionNumObj.set({AnsweredByCurrentUser:!1})),this.answeredByCurrentUser&&(this.fillEl(),this.tagListMode||Backbone.pubEv.trigger("updateMargin")))},responseGraded:function(e){var t=!1;e.get("QuestionTagId")!==this.model.get("TagId")||e.get("IsDraft")||(window.ActivelyRead.currentUserId===e.get("UserId")?((null!==e.get("Grade")||e.changed.hasOwnProperty("IsReset"))&&(this.questionNumObj.set({IsGated:!1}),this.questionNumObj.set({AnsweredByCurrentUser:!e.changed.hasOwnProperty("IsReset")})),e.changed.hasOwnProperty("IsReset")&&this.model.get("HasChoices")&&e.set("TeacherComment",null),this.undoTimer&&window.clearTimeout(this.undoTimer),t=!0):this.answeredByCurrentUser&&(t=!0),t&&(this.fillEl(),this.tagListMode||Backbone.pubEv.trigger("updateMargin")))},setGradeForUngradedMCResponses:function(e){if(e&&e.Answer){var t=e.Answer.Text.split(",").map((function(e){return parseInt(e)})).sort(),n=this.questionChoices.filter((function(e){return e.IsCorrect&&!e.IsDeleted})).map((function(e){return e.QuestionChoiceId})).sort(),s=a.isEqual(t,n);e.Grading.Grade=s?4:0}},fillEl:function(){var e=this.$el.hasClass("minimized"),t=this.$el.find(".questionTagHtml").height(),n=this,a=sCH.questionTagResponsesC.getResponseByTagId(this.model.get("TagId")),i={Text:this.model.get("Text"),ExtraHelpText:sCH.readerConfig.isStudentStruggling?this.model.get("ExtraHelpText"):null,HTML:this.model.get("HTML"),SubType:this.model.get("SubType"),StandardId:this.model.get("StandardId"),SecondStandardId:this.model.get("SecondStandardId"),Dok:this.model.get("Dok"),studentsList:alcfg.tags.question.students,qNum:this.questionNumObj.get("QuestionNum"),Choices:this.questionChoices,QuestionTagId:this.model.get("TagId"),readerType:sCH.readerConfig.type,AnswerText:a?a.Answer.Text:null,MediaUrl:a?a.Answer.MediaUrl:null,IsDraft:a&&a.Answer.IsDraft,IsReset:a&&a.Answer.IsReset,onDevice:s.onDevice(),EndIndex:this.model.get("EndIndex"),tagListMode:this.tagListMode,Weight:this.model.get("Weight"),IsMediaResponseAllowed:this.model.get("AllowMediaResponse"),ModelResponse:null,hasMultipleChoicesCorrect:this.model.get("NumCorrectChoices")>1},r=sCH.questionTagResponsesC.getAnsweredDataByQuestionTagId(this.model.get("TagId")),l=3===i.SubType?sCH.questionTagResponsesC.getChoicePercentageByTagId(this.model.get("TagId"),i.Choices):i.Choices;r.readerType=sCH.readerConfig.type,r.SubType=i.SubType;var d=s.isClassTeacherOnPersonalOrHigherPlan(sCH.learnEntityMetaM.get("ClassId"));i.ModelResponse=d&&a&&a.Grading&&null!==a.Grading.Grade&&(1===this.model.get("SubType")||sCH.readerConfig.Settings.AllowStudentsMCAnswer)?this.model.get("ModelResponse"):null;var c=("student"!==sCH.readerConfig.type||sCH.readerConfig.Settings.AllowStudentsMCAnswer)&&0===$(".connection.offline").length;if(this.answeredByCurrentUser=!this.questionNumObj.get("IsGated")&&a&&!a.Answer.IsReset&&!a.Answer.IsDraft,!this.questionNumObj.get("IsDoNotGrade")&&"tour"!==sCH.readerConfig.type||2!==this.model.get("SubType")||this.setGradeForUngradedMCResponses(a),this.questionObj={Text:this.model.get("Text")},this.$el.html("").addClass("student").attr({"data-subType":i.SubType,"data-editable":!(a&&!a.Answer.IsDraft&&!a.Answer.IsReset)}),this.$el.append(this.qTemplate(i),this.aTemplate(i),this.rTemplate({SubType:i.SubType,choices:l,response:a,grades:sCH.readerConfig.gradeNameMap,standardId:this.model.get("StandardId"),isAssessment:sCH.readerConfig.isAssessment||sCH.learnEntityMetaM.get("IsQuiz"),showAnswer:c,isStudentIR:"studentir"===sCH.readerConfig.type})).addClass("teacherQuestion"),!sCH.readerConfig.isAssessment&&this.answeredByCurrentUser&&1===i.SubType&&"none"!==sCH.readerConfig.Settings.ViewPeerResponses&&"studentir"!==sCH.readerConfig.type&&this.$el.append(this.gTemplate(r)),this.answeredByCurrentUser||(this.$el.find(".questionTagAnswer").removeClass("displayNone"),!this.tagListMode||sCH.readerConfig.isAssessment||sCH.readerConfig.isMedia||(1===this.model.get("SubType")?this.$el.find(".questionTagAnswer").addClass("displayNone"):(this.$el.find('.choice .accessibilityEnabledCheckbox input[type="checkbox"]').addClass("disabled"),this.$el.find(".questionTagAnswer .questionChoices .heading, .questionTagAnswer .btnSubmit").addClass("displayNone")))),this.model.get("HTML")){this.$el.find(".questionTagHtml").css({height:t});var u="questionTagId:"+this.model.get("TagId");o.embedMediaFull({container:this.$el.find(".questionTagHtml"),mediaUrl:this.model.get("HTML"),tagTypeAndId:u})}else this.$el.find(".questionTagHtml").addClass("displayNone");1===this.model.get("SubType")&&(a&&!a.Answer.IsReset&&"studentir"!==sCH.readerConfig.type&&(sCH.readerConfig.Settings.DisAllowAnswerEditing||null!==a.Grading.Grade?(this.$el.find(".btnRequestResetAnswer").removeClass("displayNone"),a.Answer.IsStudentRequestReset&&this.$el.find(".btnRequestResetAnswer").addClass("disabled").text("Request sent")):this.$el.find(".btnResetAnswer").removeClass("displayNone")),i.MediaUrl&&i.IsMediaResponseAllowed&&this.loadMediaPreview(i.MediaUrl)),this.$el.find(".questionTagViewMode .questionChoices").remove(),sCH.readerConfig.assignmentLocked&&(this.$el.find("a, input").attr("readonly","readonly").attr("disabled","disabled").addClass("disabled"),this.$el.find("[contenteditable]").attr("contenteditable","false")),2===this.model.get("SubType")&&0===$(".connection.offline").length&&Backbone.pubEv.once("rerenderOfflineMCResponse",(function(){n.render()}),this),this.questionNumObj.get("IsDoNotGrade")&&this.$el.addClass("doNotGrade"),this.previousResponses=sCH.questionTagResponsesC.getAllResponsesForCurrentUser(this.model.get("TagId")),this.previousResponses.length>=(this.answeredByCurrentUser?2:1)?this.$el.find(".btnViewAnswerHistory").removeClass("displayNone"):this.$el.find(".btnViewAnswerHistory").addClass("displayNone"),this.isMinimizeSettingOn()&&(this.$el.prepend("<div class='btnToggleMinimization btn-box'>Q"+this.questionNumObj.get("QuestionNum")+"</div>"),this.toggleQuestionMinimization(null,e?"on":"off")),s.initTooltips(this.$el)},loadMediaPreview:function(e){l.checkUrl(e)?(o.embedMediaFull({container:this.$el.find(".studentResponseMediaContainer"),mediaUrl:e}),this.$el.find(".addMediaDropdown").addClass("displayNone"),this.$el.find(".mediaHeading").removeClass("displayNone")):(this.$el.find(".studentResponseMediaContainer").empty(),this.$el.find(".addMediaDropdown").removeClass("displayNone"),this.$el.find(".mediaHeading").addClass("displayNone"),this.$el.find(".txtMediaUrl").addClass("displayNone"))},embedMedia:function(e){var t="paste"===e.type?e.originalEvent.clipboardData.getData("text"):this.$el.find('input[name="txtMediaUrl"]').val();s.alertLongUrl(t)&&this.loadMediaPreview(t)},removeAddedMedia:function(){this.$el.find(".txtMediaUrl").val("").addClass("displayNone"),this.$el.find(".mediaHeading").addClass("displayNone"),this.$el.find(".addMediaDropdown").removeClass("displayNone"),this.$el.find(".studentResponseMediaContainer").html("")},showRubric:function(e){return(new d.default).render({standardId:$(e.currentTarget).data("standardid")}),!1},answerChanged:function(){this.$el.find("[contenteditable]").addClass("ansUpdated").removeClass("isDraft")},viewAnswerHistory:function(){var e=this,t=new Backbone.BootstrapModal({title:"Previous responses for Question "+this.model.get("QuestionNum"),content:this.previousResponseListTemplate({responses:this.previousResponses,grades:sCH.readerConfig.gradeNameMap}),cssClass:"modal-al-previous-response-list",cancelText:!1,allowCancel:!0,okText:"Close"}).on("shown",(function(){e.renderMediaForResponses.call(this),t.$el.find("a.img").click((function(){return o.openMediaInPopup($(this).attr("href")),!1}))})).open()},showAddMediaFromUrlTextbox:function(){this.$el.find(".txtMediaUrl, .mediaHeading").removeClass("displayNone"),this.$el.find(".addMediaDropdown").addClass("displayNone"),Backbone.pubEv.trigger("questionsTagBlocker")},openUploadFilePopup:function(){var e=this,t=$('<div id="popup">        <div id="uploadContainer"></div>      </div>');new Backbone.BootstrapModal({title:"Select file to upload",content:t,okText:"Submit"}).on("shown",(function(){i.mountReactComponent(u.default,t.find("#uploadContainer")[0],{uploadUrl:alcfg.node.reader.upload_media_image,enableMultiple:!1,enableMultipleErrorMessage:"You can upload only one image.",disablePreview:!0,fileType:alcfg.imageExtensions.map((function(e){return"image/"+e})).join(","),fileTypeErrorMessage:"You can only upload images from your computer.",fileDropPlaceholder:"Try dropping an image here, or click to select an image to upload.",successMessage:"The image you uploaded will be saved with your response. Click submit after adding optional text.",maxFileSize:4e6,submitData:{},containerModal:this})})).on("ok",(function(){var t=this;this.disableOk("Submitting..."),this.preventClose(),sCH.reactUploader.submit((function(n){"string"==typeof n?(e.$el.find(".txtMediaUrl").val(n),e.loadMediaPreview(n),t.close()):t.close()}))})).on("cancel",(function(){i.unmountReactComponent(t[0])})).open().disableOk()},renderMediaForResponses:function(){this.$el.find(".studentResponseMediaContainer").each((function(){o.embedMediaFull({container:$(this),mediaUrl:$(this).data("url")})}))},questionNumUpdate:function(e){if(this.model.get("TagId")===e){var t=sCH.questionsNumC.getQNumById(this.model.get("TagId"));this.$el.find(".questionTagTitle .qNum").text("question "+t),this.model.set("QuestionNum",t)}},isMinimizeSettingOn:function(){return sCH.readerConfig.Settings.MinimizeQuestions&&!sCH.readerConfig.Settings.QuestionGates&&!this.tagListMode},toggleQuestionMinimization:function(e,t){e?this.$el.toggleClass("minimized"):"on"===t?this.$el.addClass("minimized"):"off"===t&&this.$el.removeClass("minimized"),Backbone.pubEv.trigger("updateMargin")},destroy:function(){s.destroyMediumEditor(this.medium),this.remove(),this.undelegateEvents(),this.model.off(null,null,this),sCH.questionTagResponsesC.off(null,null,this),Backbone.pubEv.off("getGateTag",this.getGateTag,this),Backbone.pubEv.off("draftUnsavedResponses",this.draftUnsavedResponse,this),Backbone.pubEv.off("questionNumUpdated",this.questionNumUpdate,this)}})},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(8),i=n(5),o=n(86),r=n(1774),l=n(323),d=n(10),c=n(324),u=n(649),p=n(48),h=n(170),g=n(192);t.default=Backbone.View.extend({template:n(1775),obj:{},events:{"click .loadAllReplies":"loadAllReplies","click .btnClose":"closeNote","click .btnEdit:not(.disabled)":"editNote","click .btnDelete:not(.disabled)":"deleteNote","click .btnReply:not(.disabled)":"replyNote","click .btnDeleteResponse:not(.disabled)":"deleteReply","click .imgPreview":"enlarge","click .embedMediaPreviewRich":"enlarge","click .videoPlayButton":"enlarge","focus .noteReplyText":"startAddingReply","blur .noteReplyText":"doneAddingReply","click .btnMove":"moveNote","click .extraHelpIconContainer:not(.locked)":"manageExtraHelpStudents"},initialize:function(e){this.obj=e,this.showAllReplies=!1,this.initialReplyCount=4,this.embedInTextView=0===$(".scroll .lrContainer > div.right").width()||!$(".reader").hasClass("notesPanelOpen")||!this.obj.scope.tagContainer,Backbone.pubEv.on("forceCloseNote",this.hide,this)},render:function(){this.$el.addClass("popupNoteMenu fullNote").html(this.template()),this.show(),i.initTooltips(this.$el);try{if(!this.embedInTextView){var e=this;e.$el.css({maxHeight:e.getNewMaxHeight()}),$(window).bind("resize",s.throttle((function(){e.$el.css({maxHeight:e.getNewMaxHeight()})}),100)),this.$el.find("[contenteditable]").on("changeHeight",(function(){e.updateNotesPanelHeight()}))}}catch(e){}return this},getNewMaxHeight:function(){var e=$(".textGatingGate").height();return"tour"===sCH.readerConfig.type&&(e-=120),e},renderInfoText:function(e){if(this.obj.model.get("TagId")){var t="";this.obj.model.get("IsAssociatedNote")||(this.obj.model.get("IsPublic")||e||(t+="(Private) "),!this.obj.model.isHighlightOnly()&&this.obj.model.get("UpdateDate")!==this.obj.model.get("CreateDate")&&"string"==typeof this.obj.model.get("UpdateDate")&&this.obj.model.get("UpdateDate").indexOf("Date")<0&&(t+="(Edited)"),this.obj.model.isHighlightOnly()&&(t+="(Highlight only)")),""!==t&&this.$el.find(".nameAndNote").append('<div class="info">'+t+"</div>")}},show:function(){if(this.$el.find(".name").text(sCH.userM.getNameForNote(this.obj.model.get("UserId"),this.obj.model.get("Username"))),this.$el.find(".text").html(i.linkify(this.obj.model.get("Text"))),this.obj.model.get("HTML")){var e="note:"+this.obj.model.get("TagId");o.embedMediaPreview({container:this.$el.find(".noteHtml"),mediaUrl:this.obj.model.get("HTML"),shouldUpdateMargin:!0,tagTypeAndId:e,isCreatedByCurrentUser:this.obj.model.get("CreatedByCurrentUser")})}if(""!==this.obj.model.get("Color")&&this.obj.model.get("Category")?(this.$el.find(".category").text(this.obj.model.get("Category")),this.$el.addClass(this.obj.model.get("Color"))):this.$el.find(".category").hide(),sCH.readerConfig.isReadOnly&&"studentresearch"!==sCH.readerConfig.type&&(this.$el.find(".noteDropdown").hide(),this.hideReplyUI("everything")),"student"!==sCH.userM.get("Role")&&"studentresearch"===sCH.readerConfig.type){var t=sCH.learnEntityMetaM.get("Teachers");s.find(t,{UserId:sCH.userM.get("UserId")})||this.hideReplyUI("controls")}sCH.learnEntityMetaM.get("IsQuiz")&&!this.obj.model.get("IsAssociatedNote")&&this.hideReplyUI("everything"),-1!==["grading","authoring"].indexOf(sCH.readerConfig.type)&&this.obj.model.get("IsExtraHelp")&&this.$el.find(".extraHelpIconContainer").removeClass("displayNone"),"grading"===sCH.readerConfig.type?(this.obj.model.get("IsPublic")?this.$el.find(".btnEdit").hide():this.$el.find(".noteDropdown").hide(),null!==this.obj.model.get("AssignmentId")&&this.renderInfoText(),this.$el.find("#noteTagRepliesContainer").show(),this.tagResponsesC=new r.default,this.tagResponsesC.fillByNoteTagId(this.obj.model.get("TagId"),sCH.readerConfig.assignmentId),this.tagResponsesC.on("sync",this.loadReplies,this)):-1!==["tour","student","studentir","studentresearch"].indexOf(sCH.readerConfig.type)&&(this.obj.model.get("CreatedByCurrentUser")||this.$el.find(".noteDropdown").hide(),null!==this.obj.model.get("AssignmentId")&&this.renderInfoText(!0),"studentir"!==sCH.readerConfig.type&&(this.obj.model.get("LayerId")||this.obj.model.get("IsPublic")||this.obj.model.get("CreatedByCurrentUser")&&this.obj.model.get("ReplyCount")>0)?(this.$el.find("#noteTagRepliesContainer").show(),!this.obj.model.get("IsPublic")||this.obj.model.get("CreatedByCurrentUser")||sCH.readerConfig.Settings.AllowStudentSharedNotes||this.hideReplyUI("controls"),this.tagResponsesC=new r.default,this.tagResponsesC.fillByNoteTagId(this.obj.model.get("TagId"),sCH.readerConfig.assignmentId),"tour"===sCH.readerConfig.type?this.loadReplies():this.tagResponsesC.on("sync",this.loadReplies,this)):this.hideReplyUI("everything")),sCH.readerConfig.activeFullNote&&sCH.readerConfig.activeFullNote.hide(),sCH.readerConfig.activeFullNote=this,this.embedInTextView?($(".popUpsWrapper").append(this.$el),this.popUp=!0):this.obj.scope.tagContainer.addClass("active").append(this.$el),this.obj.model.isHighlightOnly()||setTimeout((function(){Backbone.pubEv.trigger("updateMargin")}),250),this.highlightInText(),this.embedInTextView?(this.$el.addClass("bottom"),$(".readerpanel.next").addClass("bottomPopupOpened"),sCH.readerConfig.isPDF||this.$el.css({left:$(".scroll .textSectionContainer").offset().left})):(this.$el.removeClass("bottom"),this.$el.css({marginRight:i.scrollbarWidth()})),i.destroyMediumEditor(this.medium);var n=this.$el.find("[contenteditable]"),a="grading"===sCH.readerConfig.type||"student"===sCH.readerConfig.type&&this.obj.model.get("IsPublic")||this.obj.model.get("LayerId"),l=sCH.getAssignmentUsers(),d=s.includes(["studentir","studentresearch"],sCH.readerConfig.type)?l.studentPeers:a?this.obj.model.get("IsExtraHelp")&&"grading"===sCH.readerConfig.type?l.teachersAndStudents.filter((function(e){return"teacher"===e.role||e.isStruggling})):l.teachersAndStudents:l.coTeachers;this.tagger=u.initTagging(n,d),this.medium=i.initMediumEditor(n),sCH.readerConfig.assignmentLocked&&(this.$el.find(".btnReply, .btnEdit, .btnDelete").attr("disabled","disabled").addClass("disabled"),this.$el.find("[contenteditable]").attr("contenteditable","false")),this.obj.model.get("IsAssociatedNote")&&(this.$el.addClass("flagComment").prepend("<h1>&ldquo;I don't understand&rdquo;</h1>"),this.model.get("HighlightedText")&&this.$el.addClass("flagComment").find(".name").after('<div class="highlightedTextContainer"><div class="icon-highlighter no-hover"></div><div class="quotedText">'+this.model.get("HighlightedText")+"</div></div>")),this.obj.model.isHighlightOnly()&&(this.$el.closest(".noteTagContainer").removeClass("displayNone"),Backbone.pubEv.trigger("updateMargin")),"authoring"===sCH.readerConfig.type&&this.obj.model.get("IsExtraHelp")&&!sCH.userM.isOnPrimePlan()&&p.hidePrimeFeatureText(this.$el.find(".text"))},hide:function(){var e=this;setTimeout((function(){e.obj.scope.tagContainer.removeClass("active")})),this.obj.model.isHighlightOnly()&&this.$el.closest(".noteTagContainer").addClass("displayNone"),1===$(".bottom").length&&$(".readerpanel.next").removeClass("bottomPopupOpened"),this.$el.remove(),this.unhighlightInText(),Backbone.pubEv.off("forceCloseNote",this.hide,this),setTimeout((function(){Backbone.pubEv.trigger("updateMargin")}),250),sCH.readerConfig.activeFullNote=null,Backbone.pubEv.trigger("queuedPopupNoteEvents"),Backbone.pubEv.trigger("popupAddTagHide")},highlightInText:function(){var e=this.obj.model.get("TagId");if(e){$(".notesTag.active").removeClass("active");var t=$(".notesTag[data-tagid='"+e+"']");t.addClass("active").removeClass("transparent"),t.find(".notesTag").addClass("transparent"),parseInt(t.data("tagid"))<parseInt(t.parent().data("tagid"))&&t.parent().addClass("transparent")}},unhighlightInText:function(){$(".notesTag.active[data-transparent='1']").addClass("transparent"),$(".notesTag.active").removeClass("active hover")},hideReplyUI:function(e){"everything"===e?(this.$el.find("#noteTagRepliesContainer").remove(),this.$el.find(".noteMenuButtons .btnClose").removeClass("displayNone")):"controls"===e&&this.$el.find(".noteReplyText, .btnReply").remove()},loadAllReplies:function(){this.showAllReplies=!0,this.loadReplies()},loadReplies:function(){this.tagResponsesC.once("add",this.loadReplies,this);var e="",t=this.tagResponsesC.sortBy((function(e){return e.get("CreateDate")}));if(this.$el.find(".loadAllReplies").text(""),this.showAllReplies)this.showAllReplies=!1;else if(this.tagResponsesC.length>this.initialReplyCount){var n=this.tagResponsesC.length-this.initialReplyCount;t=t.slice(-1*this.initialReplyCount),this.$el.find(".loadAllReplies").text("View "+n+" older "+(1===n?"reply":"replies"))}var a="grading"===sCH.readerConfig.type&&sCH.readerConfig.isSmallGroupsEnabled&&!this.model.get("AssignmentId");s.each(t,(function(t,n){var s=t.get("IsDeleted"),o=!t.get("CreatedByCurrentUser")&&"grading"!==sCH.readerConfig.type||s?"":'<a class="btnDeleteResponse icon-trash" data-tagresponseid="'+t.get("NoteTagResponseId")+'"></a>',r=null!=t.get("TeacherTitle")?t.get("TeacherTitle"):t.get("FirstName"),l=t.get("CreatedByCurrentUser")?"Me":r+" "+t.get("LastName").slice(0,1)+".",d="";if(a){var c=sCH.studentsC.find({UserId:t.get("UserId")});d=c&&c.get("SmallGroupName")?" ("+c.get("SmallGroupName")+")":""}e+='<div><div class="nameAndNote"><div class="name">'+l+d+"</div>",e+=s?'<div class="text info">(Reply deleted) '+("grading"===sCH.readerConfig.type?i.linkify(t.get("Text")):"")+"</div>":'<abbr class="timeago" title="'+t.get("CreateDate")+'Z" ></abbr>'+o+'<div class="text">'+i.linkify(t.get("Text",!0))+"</div>",e+='</div><div style="clear:both;"></div></div><div class="breaker"></div>'})),this.$el.find("#noteTagReplies").html(e),this.$el.find("abbr.timeago").timeago(),sCH.readerConfig.assignmentLocked?this.$el.find(".btnDeleteResponse").addClass("disabled"):this.$el.find(".btnReply").removeClass("disabled").attr("disabled",!1).text("Reply"),this.updateNotesPanelHeight()},closeNote:function(){var e=this.$el.find(".noteReplyText[contenteditable]:not(:hidden)");if(e.length>0&&e.text().trim()&&!confirm(alcfg.alertsText.unsavedNoteReply))return!1;this.hide(),Backbone.pubEv.trigger("rerenderNotes")},editNote:function(){this.obj.scope.addNoteV=new c.default({model:this.obj.model,scope:this.obj.scope,edit:!0}).render()},manageExtraHelpStudents:function(e){g.renderManageExtraHelpStudentsPopup(),e.stopPropagation()},deleteNote:function(){var e=this;new Backbone.BootstrapModal({title:alcfg.confirmsText.noteDelete,content:"",cssClass:"modal-al-delete-note",okText:"Delete",okFocus:!1,cancelText:"Cancel"}).open((function(){if(e.obj.model.deleteData(),e.obj.model.get("IsAssociatedNote")){var t=sCH.studentFlagsC.find({AssociatedNoteTagId:e.obj.model.get("TagId")});t&&(t.set("AssociatedNoteTagId",null),$('.flagTagContainer[data-tagid="'+t.get("TagId")+'"]').removeClass("withComment hasReply"),e.updateNotificationCount(e.obj.model.get("TagId"),!0))}else e.obj.scope.tagListMode||("authoring"===sCH.readerConfig.type&&sCH.learnEntityMetaM.set("NoteTagCount",sCH.learnEntityMetaM.get("NoteTagCount")-1),Backbone.pubEv.trigger("rerenderNotes"));e.hide()}))},updateNotificationCount:function(e,t){var n=s.filter(Backbone.notificationHelper.notifications,(function(t){return t.TagId===e}));s.each(n,(function(e){e.IsClicked=!0,e.IsDeleted=t,Backbone.notificationHelper.unreadCount=s.without(Backbone.notificationHelper.unreadCount,e.NotificationId)})),Backbone.notificationHelper.updateNotificationButton()},updateNotesPanelHeight:function(){Backbone.pubEv.trigger("refreshNotesPanelHeight")},replyNote:function(){var e=this.$el.find("[contenteditable]"),t=e.html(),n={TextSectionId:sCH.readerConfig.currentSectionId,Action:"add"},o={};if(e.text().trim()){if(this.obj.model.get("TagId")){if(o={NoteTagId:this.obj.model.get("TagId")},this.$el.find("btnReply").hasClass("disabled"))return!1;var r=i.calculateWordAndCharacterCountFromHtml(t);if(i.alertLongContenteditableText(r.characterCount))return;this.$el.find(".btnReply").addClass("disabled").attr("disabled",!0).text("Replying...");var d=this.obj.model.get("TagId"),c=u.getTaggedUserList(e);if(this.tagResponsesC.addReply({noteTagId:d,assignmentId:sCH.readerConfig.assignmentId,studentLayerId:sCH.readerConfig.studentLayerId,text:t,taggedUserIds:c},(function(){this.loadReplies(),Backbone.pubEv.trigger("rerenderNotes"),"student"===sCH.userM.get("Role")&&h.trigger({type:"dance"})}),this),this.obj.model.get("IsAssociatedNote"))if("student"!==sCH.userM.get("Role")){var p=sCH.studentFlagsC.find({AssociatedNoteTagId:d});p&&$('.flagTagContainer[data-tagid="'+p.get("TagId")+'"]').addClass("hasReply")}else this.updateNotificationCount(d,!1);Backbone.tracking.trackGAEvent("reply:submit",{assignmentId:sCH.readerConfig.assignmentId,tagId:this.obj.model.get("TagId")})}if(this.$el.find("[contenteditable]").html(""),Backbone.tracking.trackGAEvent("reply","submit"),"studentir"===sCH.readerConfig.type)l.noteReplyUpdatedListener(a({},$.extend(!0,{},o,n)));else if(("student"===sCH.readerConfig.type||"tour"===sCH.readerConfig.type)&&!this.obj.model.get("CreatedByCurrentUser")&&sCH.replyDataByStudent&&sCH.userM.get("UserId")in sCH.replyDataByStudent){var g=sCH.replyDataByStudent[sCH.userM.get("UserId")],f=s.find(g,{Id:this.obj.model.get("TagId")});f?f.Title=t:g.push({Id:this.obj.model.get("TagId"),Title:t})}}else i.bootstrap.alert({message:"Please enter some text.",alert:"warning"})},deleteReply:function(e){var t=this;new Backbone.BootstrapModal({title:"Delete this reply?",content:"",cssClass:"modal-al-delete-reply",okText:"Delete"}).open((function(){var n=$(e.currentTarget).data("tagresponseid");t.tagResponsesC.find({NoteTagResponseId:n}).deleteData(),t.loadReplies()}))},enlarge:function(){o.openMediaInPopup(this.obj.model.get("HTML"),this.obj.model.get("MediaAttribution"))},startAddingReply:function(){i.onDevice()&&$(".reader").addClass("deviceKeyboard")},doneAddingReply:function(){i.onDevice()&&$(".reader").removeClass("deviceKeyboard")},moveNote:function(e){var t={noteTagId:this.obj.model.get("TagId"),numCharsToMove:parseInt($("#txtCharsToMove").val())*("left"===$(e.currentTarget).text()?-1:1)},n="studentresearch"===sCH.readerConfig.type?sCH.studentNotesC.findWhere({TagId:t.noteTagId}):sCH.teacherNotesC.findWhere({TagId:t.noteTagId});n.set("StartIndex",n.get("StartIndex")+t.numCharsToMove),n.set("EndIndex",n.get("EndIndex")+t.numCharsToMove),Backbone.pubEv.trigger("rerenderNotes"),d.MoveNote(t),console.log(t.noteTagId)},destroy:function(){i.destroyMediumEditor(this.medium),u.destroyTagging(this.tagger,this.$el.find("[contenteditable]"))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(1792),o=n(129),r=n(1793),l=n(149),d=n(43);t.default=Backbone.View.extend({template:n(1794),maxCharactersAllowedForHighlightingWord:1e3,initialize:function(e){if(this.startIndex=e.startIndex,this.endIndex=e.endIndex,this.selectedText=e.selectedText,this.isSelectionInPopup=e.isSelectionInPopup,this.isSelectionInTranslatePopup=e.isSelectionInTranslatePopup,this.isOnDevice=d.safari||s.onDevice(),this.isPlayEntireText=e.isPlayEntireText||!1,this.keepWordHighlightingOn=!this.isOnDevice&&this.isPlayEntireText,this.containerSelectedText=e.containerSelectedText,this.isTextGated=this.isPlayEntireText&&e.isTextGated,this.selectedText&&0!==this.selectedText.trim().length){this.exactContainerText=this.containerSelectedText||a.join(a.map($(".inTextSearchResult.inverse:not(.notereference)"),(function(e){return $(e).text()})),""),this.highlightWordBeingReadState=!this.isOnDevice&&!e.isSelectionInPopup&&(this.keepWordHighlightingOn||!0);var t=this.isSelectionInTranslatePopup?$("#translateLanguageSelect").val():void 0;this.availableVoices=i.default.getVoices(t),this.selectedVoiceName=s.getCookie("defaultTTSPollyVoice"),this.render(),$(".btnPlayEntireText").addClass("disabled");var n=this;Backbone.pubEv.on("texttospeech_destroy",(function(e){e&&e.isFromPopupAddTag&&n.isPlayEntireText||n.destroy()}),this)}else s.bootstrap.alert({message:alcfg.alertsText.ttsNoTextSelect,alert:"danger"})},events:{"change .ddlVoices":"voiceChanged","click .btnPlay:not(.disabled)":"say","click .btnPause":"pause","click .btnResume":"resume","click .btnClose":"destroy","click .btnPlayFromBeginning":"playFromBeginning","change #chkHighlightWordWhenSpeaking":"toggleShowWordBeingRead","change #rateSlider":"handleSettingChange"},say:function(){var e=this;if(this.$el.find(".btnPlay").addClass("disabled"),-1===a.map(this.availableVoices,"name").indexOf(this.selectedVoiceName)&&(this.selectedVoiceName=this.availableVoices[0].name,this.isSelectionInTranslatePopup||s.setCookie("defaultTTSPollyVoice",this.selectedVoiceName)),0===$(".texttospeech.bottom").length?this.$el.find(".ddlVoices").selectpicker("val",this.selectedVoiceName):this.$el.find(".ddlVoices").val(this.selectedVoiceName),this.startIndexOfCurrentWord=this.startIndex,this.selectedTextStartIndex=this.startIndex,this.checkIfPreviousVoiceSettingsAreSameAndLoaded()&&this.isStopAndPlaySupported()?i.default.playAudioFromBeginning():i.default.speak(e.selectedText,this.selectedVoiceName,{rate:e.selectedRate(),startIndex:this.startIndex,endIndex:this.endIndex,voiceId:this.selectedVoiceName,textSectionId:sCH.readerConfig.currentSectionId,assignmentId:sCH.readerConfig.assignmentId||-1,studentLayerId:sCH.readerConfig.studentLayerId||-1,readerType:sCH.readerConfig.type,isPreview:sCH.readerConfig.isReadOnly||!1,fetchSpeechmark:this.highlightWordBeingReadState,isDevice:this.isOnDevice,isPlayEntireText:this.isPlayEntireText,onstart:function(){e.$el.find(".word").html("Playing..."),e.$el.find(".settings").addClass("disabled"),e.$el.find(".btnPlay, .btnResume, .btnPlayFromBeginning").addClass("displayNone"),e.$el.find(".btnPause, .btnPlayFromBeginning").removeClass("displayNone"),e.$el.find(".btnPlay").removeClass("disabled"),s.clearWrapOnElement("textSelectionHandles")},onChunkPlayed:function(t){e.currentAudioChunk=t},onend:function(){e.stop(!0)},onerror:function(){e.destroy()},highlightSpeechmark:function(t){if(t!==e.currentAudioBeingHighlighted||!e.ttsWordHighlighterTimer){e.timeAudioWasPaused=0,e.currentAudioBeingHighlighted=t,e.timeSpeechStarted=new Date;var n=0,a=t[n];e.highlightNextWord=function(){if(window.clearTimeout(e.ttsWordHighlighterTimer),e.highlightWordBeingReadState?a&&a.value&&(void 0===e.nextWordStartIndex||e.nextWordStartIndex>-1)&&Backbone.pubEv.trigger("skipToTag",{sectionId:sCH.readerConfig.currentSectionId,searchContext:{length:a.value.length,onlyShowTextSelectionHandles:!0,invertColor:e.isPlayEntireText},searchOffset:{startIndex:e.startIndexOfCurrentWord,endIndex:e.startIndexOfCurrentWord+a.value.length,scroll:e.isPlayEntireText&&0===n}}):s.clearWrapOnElement("textSelectionHandles"),++n<t.length){if(e.isTextGated&&e.startIndexOfCurrentWord>=e.endIndex)return void e.hitGatedQuestion();var i=(new Date).getTime()-e.timeSpeechStarted,o=t[n],r=o.time-(i-(e.timeAudioWasPaused||0));e.nextWordStartIndex=e.exactContainerText.indexOf(o.value,e.startIndexOfCurrentWord-e.startIndex),e.startIndexOfCurrentWord=e.selectedTextStartIndex+e.nextWordStartIndex,a=o,e.ttsWordHighlighterTimer=window.setTimeout(e.highlightNextWord,r)}},e.highlightNextWord()}}},(function(){l.handleOfflineError(),e.stop(!0)})),"tour"===sCH.readerConfig.type){if(!o.isActionCurrentStep("student reading aid1")&&!o.isActionCurrentStep("student reading aid2"))return void o.blinkStepNumber();o.advance()}},checkIfPreviousVoiceSettingsAreSameAndLoaded:function(){return i.default.fallback_parts&&i.default.fallback_parts.length>0&&i.default.msgvoicename===this.selectedVoiceName&&i.default.msgparameters.rate===this.selectedRate()&&i.default.msgparameters.fetchSpeechmark===this.highlightWordBeingReadState},hitGatedQuestion:function(){var e=this.$el.find(".btnResume");this.pause(),e.addClass("disabled"),s.clearWrapOnElement("textSelectionHandles");var t=function(n){var a=sCH.questionsNumC.getFirstNotAnsweredQuestion();sCH.questionsNumC.find({QuestionTagId:n}).get("EndIndex")===a.EndIndex?Backbone.pubEv.once("gatedQuestionAnswered",(function(e){t(e.answeredQuestionTagId)})):(e.removeClass("disabled"),Backbone.pubEv.once("gatedQuestionAnswerUndo",(function(n){e.addClass("disabled"),Backbone.pubEv.once("gatedQuestionAnswered",(function(e){t(e.answeredQuestionTagId)}))})))};Backbone.pubEv.once("gatedQuestionAnswered",(function(e){t(e.answeredQuestionTagId)}))},stop:function(e){e?(i.default.cancel(),this.$el.find(".btnPlay").addClass("displayNone")):this.$el.find(".btnPlay").removeClass("displayNone"),this.stopWordHighlighting(),this.$el.find(".word").html(""),this.$el.find(".settings").removeClass("disabled"),this.$el.find(".btnPause, .btnResume").addClass("displayNone")},pause:function(){this.audioPauseTime=new Date,window.clearTimeout(this.ttsWordHighlighterTimer),this.currentAudioChunk.pause(),this.$el.find(".btnPause").addClass("displayNone"),this.$el.find(".btnResume").removeClass("displayNone"),this.$el.find(".container .word").addClass("displayNone"),this.$el.find(".settings").removeClass("disabled")},resume:function(){var e=sCH.questionsNumC.getFirstNotAnsweredQuestion();e&&e.TextSectionId===sCH.readerConfig.currentSectionId&&-1!==e.StartIndex?this.endIndex=e.EndIndex:(this.endIndex=999999,this.isTextGated=!1),this.timeAudioWasPaused=(this.timeAudioWasPaused||0)+((new Date).getTime()-this.audioPauseTime.getTime()),this.currentAudioChunk.play(),this.highlightNextWord&&this.highlightNextWord(),this.$el.find(".btnResume").addClass("displayNone"),this.$el.find(".btnPause").removeClass("displayNone"),this.$el.find(".container .word").removeClass("displayNone")},playFromBeginning:function(){this.stop(!0),this.isOnDevice?(this.$el.find(".btnPlay").removeClass("displayNone"),this.$el.find(".btnPlayFromBeginning").addClass("displayNone")):this.say()},render:function(){this.$el.addClass("texttospeech");var e=!this.isOnDevice&&!this.isSelectionInPopup;this.$el.html(this.template({voices:this.availableVoices,rate:this.selectedRate(),showHighlightWordToggle:e,highlightWordBeingReadState:this.highlightWordBeingReadState,disableWordHighlighting:this.keepWordHighlightingOn||this.selectedText.length>this.maxCharactersAllowedForHighlightingWord,isPlayEntireText:this.isPlayEntireText})),s.addMediumZIndex(this.$el),this.isPlayEntireText&&this.$el.addClass("showBelowPopups"),this.show()},show:function(){$("main.scroll .textview.view").append(this.$el),0===$(".scroll .lrContainer > div.right").width()?(this.$el.addClass("bottom"),$(".readerpanel.next").addClass("bottomPopupOpened"),sCH.readerConfig.isPDF||this.$el.css({left:$(".scroll .textSectionContainer").offset().left})):(this.$el.find(".ddlVoices").selectpicker(),this.$el.removeClass("bottom")),this.$el.show();var e=this;new r("#rateSlider",{ticks:[0,1,2,3,4],ticks_labels:["Slower","","","","Faster"]}).on("slideStop",(function(t){e.rateChanged(t)}));this.isOnDevice?(this.$el.find(".word").html("Press play to start"),this.$el.find(".btnPlay").removeClass("displayNone")):this.say()},stopWordHighlighting:function(){window.clearTimeout(this.ttsWordHighlighterTimer),this.ttsWordHighlighterTimer=null,s.clearWrapOnElement("textSelectionHandles")},voiceChanged:function(){this.selectedVoiceName=decodeURIComponent(this.$el.find(".ddlVoices").val()),this.isSelectionInTranslatePopup||s.setCookie("defaultTTSPollyVoice",this.selectedVoiceName),this.handleSettingChange()},selectedRate:function(){return s.getCookie("defaultTTSPollyRate")?s.getCookie("defaultTTSPollyRate"):2},rateChanged:function(){var e=parseFloat($("#rateSlider").val());s.setCookie("defaultTTSPollyRate",e),this.handleSettingChange()},toggleShowWordBeingRead:function(e){this.highlightWordBeingReadState=$(e.currentTarget).prop("checked"),this.handleSettingChange()},handleSettingChange:function(){if(this.$el.find(".btnResume").addClass("displayNone"),this.isOnDevice)if(this.highlightWordBeingReadState){var e=this;if(this.$el.find(".icon-play").addClass("disabled"),this.showLoadingMessageTimeout=window.setTimeout((function(){e.$el.find(".word").html("Loading...")}),500),i.default.fallback_speechmark_parts=[],!i.default.msgparameters)return;i.default.getSpeechmark({text:e.selectedText,rate:e.selectedRate(),voiceId:i.default.getPollyVoiceIdByName(this.selectedVoiceName),partIndex:0,onSuccess:function(t){i.default.fallback_speechmark_parts[0]=i.default.parseSpeechmarkOutput(t),e.$el.find(".icon-play").removeClass("disabled"),e.$el.find(".word").html(""),window.clearTimeout(e.showLoadingMessageTimeout)},onError:function(){s.bootstrap.alert({message:"Something went wrong. Could not fetch word highlighting.",alert:"danger"}),e.$el.find("#chkHighlightWordWhenSpeaking").prop("checked",!1),e.$el.find(".word").html(""),window.clearTimeout(e.showLoadingMessageTimeout)}})}else this.$el.find(".icon-play").removeClass("disabled")},destroy:function(){this.stop(!0),i.default.cancel(),i.default.speechMarkAjax&&(i.default.speechMarkAjax.abort("aborted"),i.default.speechMarkAjax=null),i.default.fallback_parts=null,this.$el.unbind(),s.clearWrapOnElement("textSelectionHandles"),s.clearSearchHighlights(),Backbone.pubEv.off("texttospeech_destroy",this.destroy,this),$(".texttospeech.bottom").length>0&&$(".readerpanel.next").removeClass("bottomPopupOpened"),this.$el.remove(),$(".btnhearit, .btnPlayEntireText").removeClass("disabled")},isStopAndPlaySupported:function(){return!d.safari&&!d.ios}},{canPlay:function(){var e=$("<audio>")[0];return!(!e.canPlayType||!e.canPlayType("audio/x-wav;")&&!e.canPlayType("audio/mpeg;"))||"speechSynthesis"in window}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(792),o=n(323),r=n(438),l=n(10),d=n(1825),c=n(149),u=n(167),p=n(43);t.default=Backbone.View.extend({initialize:function(e){this.reader=e.reader;var t=e.settings;try{rangy.init()}catch(e){}sCH.initReader(),sCH.readerConfig.currentSectionId=t.currentSectionId?t.currentSectionId:-1,sCH.readerConfig.providedScrollTop=t.providedScrollTop?t.providedScrollTop:-1,sCH.readerConfig.skipToTag=t.skipToTag?{tagId:t.skipToTag.tagId,openTag:t.skipToTag.openTag}:{},sCH.readerConfig.finishedRendering=!1,t.hasOwnProperty("questionTagId")&&(sCH.readerConfig.skipToTag={tagId:parseInt(t.questionTagId),tagType:"question"},t.hasOwnProperty("sectionId")&&(sCH.readerConfig.skipToTag.sectionId=parseInt(t.sectionId))),s.unbindTouchMove($(".reader")),this.scroll=new d.default({header:this.reader.header}),this.childViews=[this.scroll],sCH.learnEntitySectionsC.on("sync",this.loadTags,this),this.postInitialize(t),Backbone.pubEv.on("reader_destroy",this.destroy,this);var n=this;Backbone.pubEv.on("skipToSection",(function(e){if(e){var t=n.checkUnsavedChanges();t?(new Backbone.BootstrapModal({title:"Wait!",content:t,okText:"Yes, take me away!"}).open((function(){a()})),Backbone.pubEv.trigger("loadingShowHide",!1)):a()}function a(){r.sendReadingTimeToServer(!1),sCH.readerConfig.currentSectionId=e,s.scrollElement().scrollTop(0),Backbone.pubEv.trigger("loadSection")}})),Backbone.pubEv.on("skipToTag",this.skipToTagEvent,this),Backbone.pubEv.on("loadSection",this.loadSection,this),$(window).keydown((function(e){if("student"===sCH.readerConfig.type){var t=e.metaKey||e.ctrlKey;(114==e.keyCode||t&&70==e.keyCode||9==e.keyCode)&&(e.preventDefault(),t&&70==e.keyCode&&$(".searchDropdown .btnStartSearch").click())}if(t&&80===e.keyCode)return Backbone.pubEv.trigger("printCurrentSection"),!1})),window["onpagehide"in window&&(p.mobile||p.tablet)?"onpagehide":"onbeforeunload"]=function(){if(!sCH.userM.isAnonUser()){if((c.checkingConnection||" and syncing..."===$(".connection").attr("data-content"))&&window.location.href.indexOf("student/reader")>0)return alcfg.alertsText.exitingOfflineReader;var e=n.checkUnsavedChanges();return sCH.readerConfig.isMedia||(sCH.readerConfig.scrollTopPx=s.scrollElement().scrollTop()),r.trackReaderClose(),e}},this.onVisibilityChange=function(){sCH.userM.isAnonUser()||("visible"===document.visibilityState?r.startReadingTimer():"hidden"===document.visibilityState&&(r.stopReadingTimer(),sCH.readerConfig.isMedia||(sCH.readerConfig.scrollTopPx=s.scrollElement().scrollTop()),r.sendReadingTimeToServer(!0)))},document.addEventListener("visibilitychange",this.onVisibilityChange)},hashChange:function(){if((c.checkingConnection||" and syncing..."===$(".connection").attr("data-content"))&&window.location.href.indexOf("student/reader")>0){if(!confirm(alcfg.alertsText.exitingOfflineReader))return!1}else{var e=this.checkUnsavedChanges();if(e&&!confirm(e))return!1;sCH.readerConfig.isMedia||(sCH.readerConfig.scrollTopPx=s.scrollElement().scrollTop())}return!0},checkUnsavedChanges:function(){var e;if(sCH.readerConfig&&"student"===sCH.readerConfig.type)Backbone.pubEv.trigger("draftUnsavedResponses");else if(sCH.readerConfig&&"authoring"===sCH.readerConfig.type){$(".teacherQuestion [contenteditable]:not(:hidden)").each((function(){""!==$.trim($(this).text().trim())&&(e=alcfg.alertsText.unsavedQuestionsAuthoring)}))}return""!==$(".noteReplyText[contenteditable]:not(:hidden)").text().trim()&&(e=alcfg.alertsText.unsavedNoteReply),""!==$(".noteText[contenteditable]:not(:hidden)").text().trim()&&(e=alcfg.alertsText.unsavedNote),e},loadReaderData:function(){var e=this;l.FetchReaderData({assignmentId:sCH.readerConfig.assignmentId,layerId:sCH.readerConfig.layerId,studentLayerId:sCH.readerConfig.studentLayerId},(function(t){if(t){if(s.updateTagsForSEO({pageTitle:t.LearnEntityMetaM.Title,pageDescription:'The entire text of "'+t.LearnEntityMetaM.Title+'" with embedded questions aligned to Common Core and Depth of Knowledge (DOK) as well as scaffolding notes and media.'}),"AccessExpired"===t.AccessState&&(sCH.readerConfig.isAccessExpired=!0),t.LearnEntityMetaM.Territories&&"student"!==sCH.userM.get("Role")&&sCH.userM.getCountryCode((function(n){-1===t.LearnEntityMetaM.Territories.indexOf(n)&&e.showTextNotAvailableInCountryPopup(n)})),"AddFromSchoolLibrary"===t.LearnEntityMetaM.LayerSource&&sCH.userM.getPrimarySchool()&&1773===sCH.userM.getPrimarySchool().DistrictId)return Backbone.pubEv.trigger("loadingShowHide",!1),void new Backbone.BootstrapModal({title:'No access <span class="icon-premium-lock"></span>',content:"This assignment was from the District Library, which is a Prime feature on Actively Learn.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"OK"}).open((function(){window.location.hash="student"===sCH.readerConfig.type?"#student/classes":"#teacher/classes"}));if(sCH.loadReaderData(t,(function(){"grading"===sCH.readerConfig.type&&e.getTeacherCommentSuggestions(),"grading"!==sCH.readerConfig.type&&"authoring"!==sCH.readerConfig.type||(sCH.readerConfig.assignedClasses=t.ClassesLayerIsAssignedIn)})),o.initializeReaderUpdates(),e.initializeSettings((function(){e.loadSection(),sCH.readerConfig.isReadOnly||r.initialize()})),sCH.userM.get("IntercomTrial")&&s.intercom("trackEvent","reader-enter",{assignmentId:sCH.readerConfig.assignmentId,studentLayerId:sCH.readerConfig.studentLayerId}),Backbone.tracking.logNSFEvent({event:"reader enter",assignmentId:sCH.readerConfig.assignmentId}),sCH.userM.isAnonUser()&&(Backbone.tracking.logAnonEvent("preview-layer",{layerId:sCH.readerConfig.layerId,learnEntityId:sCH.learnEntityMetaM.get("LearnEntityId")}),t.shouldRedirectToPreview&&(sCH.readerConfig.isReadOnly=!0,Backbone.router.navigate(window.location.hash.replace("authoring","authoring/preview").replace("#",""),{trigger:!1}))),!(sCH.learnEntityMetaM.get("RentalPrices")||sCH.readerConfig.isQuiz||sCH.readerConfig.isMedia||sCH.readerConfig.isPDF)){var n=sCH.learnEntitySectionsMetaC.getValidSectionsJson().filter((function(e){return e.TextSectionId!==sCH.readerConfig.currentSectionId}));l.DownloadRestOfSections(n)}}}),(function(e){Backbone.pubEv.trigger("loadingShowHide",!1),i.handleReaderAccessError(e)}))},showTextNotAvailableInCountryPopup:function(e){new Backbone.BootstrapModal({title:"No access",content:"<p>The publisher of this rental text has not made it available in "+e+".</p>",okText:"Ok",cancelText:!1,allowCancel:!1,cssClass:"danger"}).on("ok",(function(){s.redirectUserByHash(sCH.lastAccessedPreReaderUrl||s.getReaderExitUrl()),sCH.lastAccessedPreReaderUrl=null})).open()},getTeacherCommentSuggestions:function(){l.GetTeacherCommentSuggestions({assignmentId:sCH.readerConfig.assignmentId},(function(e){sCH.readerConfig.TeacherCommentSuggestions=e,Backbone.pubEv.trigger("initializeCommentSuggestionsAutoComplete")}))},overrideWithDefaultQuizSettings:function(){sCH.readerConfig.Settings.reading.AllowStudentSharedNotes=!1,sCH.readerConfig.Settings.reading.ViewPeerResponses="none",sCH.readerConfig.Settings.reading.QuestionGates=!1,sCH.readerConfig.Settings.reading.AllowStudentsMCAnswer=!1},printListener:function(e){e.matches?$(".textSection").hide():$(document).one("mouseover",(function(){$(".textSection").show()}))},setupPrinting:function(){("student"===sCH.userM.get("Role")?s.isClassTeacherOnPersonalOrHigherPlan(sCH.learnEntityMetaM.get("ClassId"))&&!sCH.learnEntityMetaM.get("IsPrintDisabled"):!sCH.userM.isOnFreePlan()&&!sCH.learnEntityMetaM.get("IsPrintDisabled"))||("matchMedia"in window?(this.matchPrintMedia=window.matchMedia("print"),this.matchPrintMedia.addListener(this.printListener)):($(window).on("beforeprint",(function(){$(".textSection").hide()})),$(window).on("afterprint",(function(){$(".textSection").show()}))))},initializeSettings:function(e){if(sCH.learnEntityMetaM.get("LayerId")&&(sCH.readerConfig.layerId=sCH.learnEntityMetaM.get("LayerId")),this.setupPrinting(),(sCH.learnEntityMetaM.get("RentalPrices")||a.includes(alcfg.paidpublishers.decrypted,sCH.learnEntityMetaM.get("Publisher")))&&($(".reader").addClass("paid"),a.includes(["authoring","student","studentir"],sCH.readerConfig.type))){var t=2e3*sCH.learnEntityMetaM.get("PageCount")*.1,n=0,i=!1;a.each(sCH.learnEntitySectionsMetaC.models,(function(e,a){i?e.set("Truncated",-1):(n+=e.get("CharacterCount"))>=t&&(sCH.readerConfig.isReadOnly?(e.set("Truncated",n-t),i=!0):e.set("Passed10Percent",!0))}))}sCH.learnEntityMetaM.get("IsEncrypted")&&$(".reader").addClass("encrypted"),(sCH.learnEntityMetaM.get("RentalPrices")||sCH.learnEntityMetaM.get("IsCopyPasteDisabled"))&&$(".textview").on("copy paste contextmenu",(function(e){return $(e.target).hasClass("txtMedia")||"hyperlink"===$(e.target).attr("name")||"true"===$(e.target).attr("contenteditable")||"true"===$(e.target).parent().attr("contenteditable")?void 0:(e.preventDefault(),!1)})),window.ActivelyRead.currentUserId=sCH.readerSettingsM.get("CurrentUserId");try{sCH.readerConfig.TextSettings=JSON.parse(sCH.readerSettingsM.get("TextSettings"))}catch(e){sCH.readerConfig.TextSettings={}}sCH.readerConfig.Settings=sCH.readerConfig.Settings||{},sCH.readerConfig.Settings.reading=a.extend({},alcfg.defaultReadingSettings),a.merge(sCH.readerConfig.Settings,JSON.parse(sCH.readerSettingsM.get("ClassSettings"))),(sCH.learnEntityMetaM.get("IsQuiz")||sCH.readerConfig.isAssessment)&&this.overrideWithDefaultQuizSettings(),a.merge(sCH.readerConfig.Settings,JSON.parse(sCH.readerSettingsM.get("AssignmentSettings")||null)||{}),sCH.readerConfig.Settings.reading.AllowLikingPeerResponses="none"!==sCH.readerConfig.Settings.reading.ViewPeerResponses&&sCH.readerConfig.Settings.reading.AllowLikingPeerResponses,sCH.readerConfig.isPDF="Box"===sCH.learnEntityMetaM.get("Source"),sCH.readerConfig.gradeNameMap=s.gradeNameMap(!1,sCH.readerConfig.Settings),sCH.readerConfig.isPDF&&$(".reader").addClass("pdfreader"),sCH.readerConfig.TextSettings=a.extend({},alcfg.defaultTextSettings,sCH.readerConfig.TextSettings),sCH.readerConfig.QuestionsDoNotGrade=sCH.readerConfig.Settings.questionsDoNotGrade,sCH.readerConfig.QuestionsDoNotGrade&&a.each(sCH.readerConfig.QuestionsDoNotGrade,(function(e){var t=sCH.questionsNumC.find({QuestionTagId:parseInt(e)});t&&(t.set("IsDoNotGrade",!0),"grading"===sCH.readerConfig.type&&sCH.readerConfig.ungradedResponseIds[t.get("QuestionTagId")]&&(a.each(Object.keys(sCH.readerConfig.ungradedResponseIdsByUser),(function(e){sCH.readerConfig.ungradedResponseIdsByUser[e]=a.difference(sCH.readerConfig.ungradedResponseIdsByUser[e],sCH.readerConfig.ungradedResponseIds[t.get("QuestionTagId")])})),delete sCH.readerConfig.ungradedResponseIds[t.get("QuestionTagId")]))}));var o=sCH.readerConfig.Settings.gradebook;if(sCH.readerConfig.Settings.reading&&(sCH.readerConfig.Settings=sCH.readerConfig.Settings.reading),sCH.readerConfig.Settings.grading=o,-1===sCH.readerConfig.currentSectionId){var r=sCH.getTextSectionIdToOpen();a.find(sCH.learnEntitySectionsMetaC.getValidSectionsJson(),{TextSectionId:r})||(r=sCH.learnEntitySectionsMetaC.getFirstSectionId(),sCH.readerSettingsM.set("LastReadTextSectionId",r)),sCH.readerConfig.currentSectionId=r}if(sCH.readerConfig.isAssessment&&$(".notesview").hide(),-1!==sCH.readerConfig.providedScrollTop||"tour"===sCH.readerConfig.type)e();else if(sCH.readerConfig.providedScrollTop=sCH.readerSettingsM.get("LastReadScrollTopPx"),u.supported&&p.ios&&window.navigator.standalone||window.isIOSApp){var l="readingPositions:"+sCH.readerConfig.assignmentId+":"+sCH.userM.get("UserId");u.db.localSettings.get(l,(function(t){t&&moment.utc(sCH.readerSettingsM.get("LastReadScrollTopPxUpdateDate")).isBefore(t.CreateDate)&&(sCH.readerConfig.currentSectionId=t.SectionId,sCH.readerConfig.providedScrollTop=t.ScrollTopPx),e()}))}else e()},mimicCurrentSectionForExpiredAccess:function(){sCH.readerConfig.currentSectionId=sCH.learnEntitySectionsMetaC.getFirstSectionId(),sCH.learnEntitySectionsC.add({TextSectionId:sCH.readerConfig.currentSectionId,TextId:null,SectionNum:1,Title:"Access expired",Content:alcfg.alertsText.accessExpiredTextSectionText["student"===sCH.readerConfig.type?"student":"teacher"],BlobUrl:null,IsDeleted:0,Visible:!1})},loadSection:function(){if("authoring"===sCH.readerConfig.type&&sCH.teacherQuestionsC&&sCH.teacherQuestionsC.removeEmpty(),-1===sCH.readerConfig.currentSectionId&&(sCH.readerConfig.currentSectionId=sCH.learnEntitySectionsMetaC.getFirstSectionId()),Backbone.pubEv.trigger("loadingShowHide",!0),sCH.readerConfig.isAccessExpired)this.mimicCurrentSectionForExpiredAccess(),this.loadTags();else if(sCH.readerSectionAlreadyLoaded(sCH.readerConfig.currentSectionId))this.scroll.renderSection();else{var e=sCH.learnEntitySectionsMetaC.getModelBySectionId(sCH.readerConfig.currentSectionId);e?(sCH.readerConfig.isMedia="video"===e.get("Type")||"media"===e.get("Type"),sCH.learnEntitySectionsC.fill(e)):(rg4js("send",{error:new Error("NULL sectionM"),customData:{currentSectionId:sCH.readerConfig.currentSectionId,sections:sCH.learnEntitySectionsMetaC.toJSON()}}),s.showErrorPopup())}},loadTags:function(){var e=this,t=[];sCH.readerTagsForSectionLoaded(sCH.readerConfig.currentSectionId,"note")||t.push("note"),sCH.readerTagsForSectionLoaded(sCH.readerConfig.currentSectionId,"question")||t.push("question","marker"),t.length>0?l.GetSectionTags({assignmentId:sCH.readerConfig.assignmentId,layerId:sCH.readerConfig.layerId,studentLayerId:sCH.readerConfig.studentLayerId,textSectionId:sCH.readerConfig.currentSectionId,type:sCH.readerConfig.type,tagTypesToFetch:t,isStudentStruggling:sCH.readerConfig.isStudentStruggling,isPreview:sCH.readerConfig.isReadOnly},(function(n){sCH.loadReaderTags(n,sCH.readerConfig.currentSectionId,t),e.pickRender(),Backbone.pubEv.trigger("rerenderStudentNoteCounts")})):this.pickRender()},pickRender:function(){""===$(".reader .header").html()&&this.reader.header.render(),sCH.readerConfig.initialRender?this.scroll.renderSection():this.render()},skipToTagEvent:function(e){if(sCH.readerConfig.skipToTag={tagId:e.tagId,tagType:e.tagType,openTag:e.openTag,originalEvent:e.originalEvent},e.searchOffset&&(sCH.readerConfig.searchOffset=e.searchOffset,sCH.readerConfig.searchContext=e.searchContext),sCH.readerConfig.currentSectionId!==e.sectionId){var t=!1,n=sCH.learnEntitySectionsMetaC.find({TextSectionId:e.sectionId});if(n.get("IsDeleted"))return void new Backbone.BootstrapModal({title:"Oops!",cssClass:"modal-al-skip-to-tag-oops",content:"The section you are trying to access is hidden.",cancelText:!1,allowCancel:!1,okText:"Close"}).open();if("student"!==sCH.readerConfig.type&&"studentir"!==sCH.readerConfig.type||e.searchContext&&e.searchContext.ignoreGating)$(".reader").hasClass("paid")&&sCH.readerConfig.isReadOnly&&sCH.learnEntitySectionsMetaC.isTruncated(e.sectionId)&&(t=!0);else if(sCH.readerConfig.isPDF){if(sCH.readerConfig.Settings.QuestionGates){var a=sCH.questionsNumC.getFirstNotAnsweredQuestion();if(a){var s=sCH.learnEntitySectionsMetaC.find({TextSectionId:a.TextSectionId});n.get("SectionNum")>s.get("SectionNum")&&(t=!0)}}}else t=!$('.sectionsDropdown li[data-textsectionid="'+e.sectionId+'"] a').hasClass("enabled");if(t)return new Backbone.BootstrapModal({title:"Oops!",cssClass:"modal-al-skip-to-tag-oops",content:"authoring"===sCH.readerConfig.type?alcfg.confirmsText.previewPaidTextRestricted:e.fromView&&"questionsummary"===e.fromView?alcfg.confirmsText.questionRestricted:alcfg.confirmsText.noteRestricted,cancelText:!1}).open(),void(sCH.readerConfig.skipToTag={});r.sendReadingTimeToServer(!1),sCH.readerConfig.currentSectionId=e.sectionId,Backbone.pubEv.trigger("loadSection")}else this.scroll.skipToTag()},show:function(e){switch(this.scroll.show(),-1!==sCH.readerConfig.providedScrollTop&&s.scrollElement().scrollTop(sCH.readerConfig.providedScrollTop),e){case"data":$(".btnDataView:visible:not(.selected)").click();break;case"grading":$(".btnGradingView:visible:not(.selected)").click();break;default:$(".btnNotesView:visible:not(.selected)").click()}},hide:function(){this.scroll.hide(),Backbone.pubEv.trigger("questionsTagUnblocker")},destroy:function(){if(s.storeZoomStateToLocalStorage(null),this.lockAssignmentTimer&&window.clearTimeout(this.lockAssignmentTimer),this.lockEndAssignmentTimer&&window.clearTimeout(this.lockEndAssignmentTimer),sCH.userM.isAnonUser()||r.trackReaderClose(),Backbone.pubEv.trigger("texttospeech_destroy"),$(window).unbind("scroll"),$(window).unbind("resize"),$(window).unbind("keydown"),$(window).off("orientationchange"),$(window).off("beforeprint"),$(window).off("afterprint"),this.matchPrintMedia&&this.matchPrintMedia.removeListener(this.printListener),window.ActivelyRead.touchTextSelection&&window.clearInterval(window.ActivelyRead.touchTextSelection),sCH.readerConfig.isPDF&&p&&p.ipad){var e=document.querySelector('meta[name="viewport"]');e&&(e.content=sCH.readerConfig.originalViewport)}a.each(["touchTextSelection","showDok"],(function(e){e in window.ActivelyRead&&delete window.ActivelyRead[e]})),window["onpagehide"in window&&(p.mobile||p.tablet)?"onpagehide":"onbeforeunload"]=null,document.removeEventListener("visibilitychange",this.onVisibilityChange),$("body").off("copy paste contextmenu"),o.unbindReaderUpdates(),Backbone.pubEv.trigger("tags_destroy");for(var t=["showStudentTags","reader_destroy","tags_destroy","skipToSection","skipToTag","modalBackgroundShow","modalBackgroundHide","popupAddTagShow","popupAddTagHide","popupAddNoteShow","popupAddNoteHide","popupAddLinkShow","popupAddLinkHide","popupFullNoteShow","popupFullNoteHide","questionsTagBlocker","questionsTagUnblocker","configureAssignmentLock","toggleStudentTags","editNewQuestion","questionNumUpdated","getGateTag","finishAddTag","updateMargin","questionDeleted","saveQuizQuestionComplete","swapQuestionComplete","handleAssessmentArrows","rerenderNotes","rerenderTags","renderSearchResult","loadSection","updateGradePanelCount","draftUnsavedResponses","gradingClickedQuestion","toggleTags","rerenderStudentNoteCounts","playEntireTextTriggered","printCurrentSection"],n=0;n<t.length;n++)Backbone.pubEv.off(t[n]);window.ActivelyRead.currentUserId=null,$(".popUpsWrapper").remove(),s.updateTagsForSEO({}),document.querySelector(".layout.reader").className="layout reader",document.querySelector(".layout.reader header").className="header"}})},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(168),r=n(86),l=n(48);t.default=Backbone.View.extend({el:"main.scroll .instructions",template:n(1864),events:{"click .btnAddInstructions, .editable":"addEditInstructions","click .btnAddMedia":"addMedia","click .btnBlockAddMedia":"showBuyPrimePopup","click .btnDone":"saveInstruction","click .btnDelete":"del","paste .txtMedia":"embedMedia","blur .txtMedia":"embedMedia"},initialize:function(){Backbone.pubEv.on("updateDirections",this.renderCurrentSection,this)},getCurrentSectionDirectionsObj:function(){var e=null;if(sCH.readerConfig.directions){var t=a.find(sCH.readerConfig.directions,{TextSectionId:sCH.readerConfig.currentSectionId});if(t)try{e=JSON.parse(t.DirectionsJson)}catch(n){try{e=JSON.parse(t.DirectionsJson+"}")}catch(e){a.remove(sCH.readerConfig.directions,{TextSectionId:sCH.readerConfig.currentSectionId})}}}return e},renderCurrentSection:function(){var e=this.getCurrentSectionDirectionsObj(),t="authoring"!==sCH.readerConfig.type||sCH.readerConfig.isReadOnly;if(!e&&t)return this.$el.hide(),void Backbone.pubEv.trigger("updateMargin",{doResizeView:!0});this.$el.html(this.template({mode:"view",type:sCH.readerConfig.type,directions:e||{},linkify:s.linkify})),this.$el.show(),this.checkMedia(e),"authoring"===sCH.readerConfig.type&&this.$el.removeClass("empty").addClass("authoring"),sCH.readerConfig.currentSectionId===sCH.learnEntitySectionsMetaC.getFirstSectionId()?this.$el.addClass("firstSection"):this.$el.removeClass("firstSection"),Backbone.pubEv.trigger("updateMargin",{doResizeView:!0})},addEditInstructions:function(){var e=this.getCurrentSectionDirectionsObj();this.$el.html(this.template({mode:"addedit",type:sCH.readerConfig.type,directions:e||{},linkify:s.linkify})),s.destroyMediumEditor(this.medium),this.medium=s.initMediumEditor(this.$el.find("[contenteditable]")),this.checkMedia(e)},checkMedia:function(e){if(e)if(e.html){this.$el.find(".btnAddMedia").addClass("on"),this.$el.find(".btnAddMedia").html("Remove Media"),this.$el.find(".questionTagEditMediaContainer").removeClass("displayNone");r.embedMediaFull({container:this.$el.find(".questionTagHtml"),mediaUrl:e.html,tagTypeAndId:"instruction"})}else this.$el.find(".btnAddMedia").html("Add Media"),this.$el.find(".questionTagEditMediaContainer").addClass("displayNone")},showBuyPrimePopup:function(){l.showBuyTeacherPopup({title:"Adding media",content:alcfg.confirmsText.freeTAddMedia})},addMedia:function(e){void 0!==e&&e.stopPropagation();var t=this.$el.find(".txtMedia"),n=this.$el.find(".btnAddMedia");this.$el.find(".questionTagEditMediaContainer").toggleClass("displayNone"),n.toggleClass("on"),n.hasClass("on")?n.html("Remove Media"):(t.val(""),n.html("Add Media"))},saveInstruction:function(){var e=this.$el.find("[contenteditable]").html().trim(),t=this.$el.find(".txtMedia").val().trim(),n=this;if(this.$el.find("[contenteditable]").text().trim()){if(s.alertLongUrl(t)){var o=this.getCurrentSectionDirectionsObj();if(this.isInstructionsChanged(o,e,t)){var r=JSON.stringify({text:e,html:t});o?a.find(sCH.readerConfig.directions,{TextSectionId:sCH.readerConfig.currentSectionId}).DirectionsJson=r:sCH.readerConfig.directions.push({DirectionsJson:r,TextSectionId:sCH.readerConfig.currentSectionId}),i.AddLayerTextSectionDirections({directionsJson:r,layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId},(function(){n.renderCurrentSection()}))}else n.renderCurrentSection()}}else s.bootstrap.alert({message:"Please enter some text.",alert:"warning"})},isInstructionsChanged:function(e,t,n){return!e||t!==e.text||n!==e.html},del:function(){if(this.getCurrentSectionDirectionsObj()){var e=this;i.DeleteLayerTextSectionDirections({layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId},(function(){a.remove(sCH.readerConfig.directions,{TextSectionId:sCH.readerConfig.currentSectionId}),e.renderCurrentSection()}))}else this.renderCurrentSection()},embedMedia:function(e){var t="paste"===e.type?e.originalEvent.clipboardData.getData("text"):this.$el.find(".txtMedia").val();s.alertLongUrl(t)&&(o.checkUrl(t)?r.embedMediaFull({container:this.$el.find(".questionTagMediaContainer"),mediaUrl:t}):this.$el.find(".questionTagMediaContainer").empty())},destroy:function(){Backbone.pubEv.off("updateDirections"),s.destroyMediumEditor(this.medium)}})},,,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<ul class=\"dropdown-menu\" id='popupMenuDropdown'>\r\n    ",_.each(options,(function(e){var t="string"==typeof e?e:e.key,n="string"!=typeof e&&e.disabled,a="btn"+t.toLowerCase().replace(/ /g,"").replace("!","").replace("'","")+(n?" optionDisabled":""),s=n&&e.disabledClickMsg?e.disabledClickMsg:"";__p+='\r\n        <li>\r\n            <a class="'+(null==(__t=a)?"":__t)+'" data-disabledclickmsg="'+(null==(__t=s)?"":__t)+'">\r\n                '+(null==(__t=t)?"":__t)+"\r\n            </a>\r\n        </li>\r\n    "})),__p+="\r\n</ul>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1895),i=n(324),o=n(1896),r=n(1898),l=n(521),d=n(1899);t.default=Backbone.View.extend({initialize:function(){this.modalBackgroundV=new s.default,this.menuHyperlinkV=new r.default,this.popupFlagMenuView=new d.default,Backbone.pubEv.on("modalBackgroundShow",(function(){this.modalBackgroundV.show()}),this),Backbone.pubEv.on("modalBackgroundHide",(function(){this.modalBackgroundV.hide()}),this),Backbone.pubEv.on("popupAddTagShow",this.addTagShow,this),Backbone.pubEv.on("popupAddTagHide",this.addTagHide,this),Backbone.pubEv.on("popupAddNoteShow",this.addNoteShow,this),Backbone.pubEv.on("popupAddNoteHide",this.addNoteHide,this),Backbone.pubEv.on("popupAddLinkShow",this.addLinkShow,this),Backbone.pubEv.on("popupAddLinkHide",this.addLinkHide,this),Backbone.pubEv.bind("menuHyperlinkShow",this.menuLinkShow,this),Backbone.pubEv.bind("menuHyperlinkHide",this.menuLinkHide,this),Backbone.pubEv.on("popupFullNoteShow",this.fullNoteShow,this),Backbone.pubEv.on("popupFullNoteHide",this.fullNoteHide,this),Backbone.pubEv.on("flagMenuShowHide",this.flagMenuShowHide,this),this.render()},render:function(){var e=$(".popUpsWrapper");this.$el.addClass("popUpsWrapper"),this.renderChildEl(),this.$el.attr("role","dialog"),e.length?e.replaceWith(this.$el):$("body").append(this.$el)},addTagShow:function(e){this.popupAddTagV&&this.popupAddTagV.show(e)},addTagHide:function(){this.popupAddTagV&&this.popupAddTagV.hide()},addNoteShow:function(e){this.addNoteShowing||(this.fullNoteHide(),this.addNoteV=new i.default(e).render(),this.addNoteShowing=!0,this.addTagHide())},addNoteHide:function(){this.modalBackgroundV.hide(),this.addTagHide(),this.addNoteShowing=!1,this.addNoteV&&(1===$(".bottom").length&&$(".readerpanel.next").removeClass("bottomPopupOpened"),this.addNoteV.close(),"0px"!==$(".reader .scroll").css("bottom")&&$(".reader .scroll").css({bottom:0}),$(".inTextSearchResult").removeClass("notereference"),a.clearSearchHighlights(),$(".reader .scroll .view.notesview").removeClass("displayNone"),Backbone.pubEv.trigger("updateMargin"))},addLinkShow:function(e){this.addLinkShowing||(this.addHyperlinkV=new Backbone.BootstrapModal({title:e.edit?"Edit the URL":"Enter a URL to link to",content:new o.default(e),okText:"Save",cssClass:"popupAddHyperlink"}).open(),this.addLinkShowing=!0,this.addTagHide())},addLinkHide:function(){this.modalBackgroundV.hide(),this.addHyperlinkV.close(),this.addTagHide(),this.addLinkShowing=!1},menuLinkShow:function(e){this.menuHyperlinkV.show(e)},menuLinkHide:function(){this.menuHyperlinkV.hide()},fullNoteShow:function(e){this.addNoteHide(),this.fullNoteHide(),this.fullNoteV=new l.default(e),this.fullNoteV.render()},fullNoteHide:function(){this.fullNoteV&&(this.fullNoteV.hide(),this.fullNoteV=null)},flagMenuShowHide:function(e){e.show?this.popupFlagMenuView.show(e):this.popupFlagMenuView.hide()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(137),s=n(13).createMuiTheme({typography:{fontFamily:'"AvenirNextLTW02-Medium", "Helvetica", "Arial", sans-serif'},palette:{primary:{light:a.lightBlue[500],main:a.lightBlue[800],dark:a.lightBlue[500],contrastText:"#fff"},accent:a.pink,error:a.red},overrides:{MuiFormControl:{root:{boxSizing:"border-box","& .Mui-disabled svg":{color:"rgba(0, 0, 0, 0.25)"}},marginDense:{marginBottom:6}},MuiFormLabel:{root:{color:"rgba(0, 0, 0, 0.54)",boxSizing:"border-box"}},MuiFormHelperText:{root:{"&:empty":{display:"none"}}},"@media (max-width: 460px)":{MuiFormLabel:{root:{marginLeft:0}}},MuiInput:{underline:{"&:before":{borderBottom:"1px solid rgba(0, 0, 0, 0.2)"}}}}});t.default=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(44);t.default=Backbone.Model.extend({sync:s.default,defaults:function(){return{UserId:null,FirstName:"",LastName:"",ImageUrl:"",NoteTagResponseId:null,NoteTagId:null,Text:"",CreateDate:null,IsDeleted:!1}},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))},fixTextField:function(){return a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Text",!0)))},deleteData:function(){if("tour"!==sCH.readerConfig.type){var e={noteTagResponseId:this.get("NoteTagResponseId")};"studentresearch"===sCH.readerConfig.type?e.studentLayerId=sCH.readerConfig.studentLayerId:e.assignmentId=sCH.readerConfig.assignmentId,a.ajax({type:"POST",url:alcfg.node["reader_"+sCH.readerConfig.type].delete_note_reply,data:e,showLoading:!1,vital:!1,onSuccess:function(){}})}this.set("IsDeleted",!0)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(264),i=n(13).withStyles,o=function(){new Backbone.BootstrapModal({title:"Actively Learn Prime Features",content:new s.default({videoId:alcfg.videoids.teacherpremiumfeatures,introText:"This video will introduce some of the features on our Prime plan that can help you and your school achieve your reading goals.",autoPlay:!0}),cancelText:!1,okText:"Close",cssClass:"modal-lg modal-al-instructional-video",showFooter:!0}).open()},r=function(){window.open("https://www.activelylearn.com/plans","_blank")},l=i((function(e){return{banner:{border:"1px solid #03A9F4",padding:"15px 10px 25px",textAlign:"center",marginBottom:10,marginTop:20},caption:{marginBottom:15,fontFamily:"Avenir Next LT W02 Demi"},contactUs:{color:"inherit !important",textDecoration:"underline"},buttonCaption:{marginTop:10,color:"#fff",zIndex:1},buttons:{display:"flex",justifyContent:"space-around"},video:{backgroundColor:"#000",background:"url(/img/PRO_premium_video_thumbnail.png)",backgroundSize:"100%"},features:{backgroundColor:"#03A9F4"},button:{width:240,padding:"15px 0px 20px",boxSizing:"border-box",display:"flex",justifyContent:"center",flexDirection:"column",textAlign:"center",position:"relative"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.7)"},icon:{"&:before":{color:"white",fontSize:50},zIndex:1}}}))((function(e){var t=e.classes,n=e.caption;return a.createElement("div",{className:"premiumBanner "+t.banner},a.createElement("div",{className:t.caption},n||"This feature is available on our Prime plan."," ",a.createElement("a",{className:t.contactUs,target:"_blank",href:"https://www.activelylearn.com/purchaseinquiry"},"Contact us")," to learn more."),a.createElement("div",{className:""+t.buttons},a.createElement("a",{onClick:o,className:"button "+t.button+" "+t.video},a.createElement("span",{className:t.overlay}),a.createElement("span",{className:"icon-video-play "+t.icon}),a.createElement("span",{className:t.buttonCaption},"Watch an overview")),a.createElement("a",{onClick:r,className:"button "+t.button+" "+t.features},a.createElement("span",{className:"icon-premium-features "+t.icon}),a.createElement("span",{className:t.buttonCaption},"See plan features"))))}));t.default=l},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(1035),o=function(e,t){var n=new i(function(e){return{trigger:"@",values:e,menuItemTemplate:function(e){var t=e.original;return $(this.menu).removeClass("noMatch"),'<div data-userid="'+t.userId+'" class="userInfo">\n        '+a.generateAvatarHtml(t.imageUrl)+"\n        "+e.string+"\n      </div>"},requireLeadingSpace:!1,allowSpaces:!0,selectClass:"active",selectTemplate:function(e){var t=e.original;return'<span\n        class="taggedUser colorName initial_'+t.value.charAt(0).toLowerCase()+'"\n        data-userid="'+t.userId+'">'+t.value+"</span>"},noMatchTemplate:function(){return $(this.menu).addClass("noMatch"),null}}}(t));return n.attach(e),function(e){$(e).on("tribute-replaced",(function(e){var t=e.originalEvent;t&&t.detail.item.original.userId&&$(t.target).find("[data-userid='"+t.detail.item.original.userId+"']").on("DOMSubtreeModified",(function(e){$(e.currentTarget).hasClass("taggedUser")&&$(e.currentTarget).removeClass()}))}))}(e),n};t.getTaggedUserList=function(e){var t=e.find(".taggedUser"),n=[];return t.length>0&&t.each((function(){n.push($(this).data("userid"))})),n},t.initTagging=function(e,t){if(s.includes(["student","studentresearch"],sCH.readerConfig.type)&&a.isClassOnPrimePlan(sCH.learnEntityMetaM.get("ClassId"))||"grading"===sCH.readerConfig.type&&sCH.userM.isOnPrimePlan()||"studentir"===sCH.readerConfig.type&&sCH.classesC.find({IsOnPrimePlan:1}))return o(e,t)},t.destroyTagging=function(e,t){e&&e.detach(t)}},,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,function(e,t){},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(1122);t.default=Backbone.Collection.extend({model:s.default,sync:a.default,fill:function(e){var t=this;this.fetch({data:e,url:alcfg.node.class_research.get_list,mainSuccess:function(e){t.set(e)},timerTimeout:1})},getModelByLayerId:function(e){return this.filter({StudentLayerId:e})[0]}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(5),i=n(1123);t.default=Backbone.Collection.extend({model:i.default,sync:a.default,fill:function(){var e=this;this.fetch({url:alcfg.node.independent_reading.student_texts,mainSuccess:function(t){e.set(t)},timerTimeout:1})},fillReadingLog:function(){var e=this;this.fetch({url:alcfg.node.independent_reading.readinglog,mainSuccess:function(t){e.set(t)},timerTimeout:1})},addLearnEntity:function(e,t){var n=this,a={learnEntityId:e.LearnEntityId};s.ajax({type:"POST",url:alcfg.node.independent_reading.add_fromcatalog,data:a,timeout:6e4,showLoading:!0,vital:!0,onSuccess:function(a){"already in bookshelf"==a.message||(e.StudentLayerId=a.data,e.Link=e.ContentUrl,n.add(e,{at:0})),t&&t(a.data)}})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(44);t.default=Backbone.Model.extend({defaults:function(){return{LearnEntityId:null,UserId:null,Title:"",Description:null,Author:"",PublishedDate:"",UpdateDate:null,Publisher:"",IsTextToSpeechDisabled:!1,Type:0,IsShared:null,SharedDate:null,LayerId:null,LayerLabels:[],AssignmentId:null,LastReadTextSectionId:-1,LastReadScrollTopPx:-1,ReaderSettings:null,Source:"",ContentUrl:"",Teachers:[],LockStartDate:null,LockEndDate:null,IsQuiz:!1,RandomizeQuestionOrder:!1,CoverArt:"",NoteTagCount:null,QuestionTagCount:null,RentalPrices:null,PageCount:null}},sync:s.default,initWithData:function(e){return this.set(this.parse(e))},fixTitleField:function(){return a.sanitize(this.get("Title",!0))},fixAuthorField:function(){return a.sanitize(this.get("Author",!0))},learnEntityId:function(){return this.get("LearnEntityId")},title:function(){return this.get("Title")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(1125),i=n(44);t.default=Backbone.Collection.extend({model:s.default,sync:i.default,initWithData:function(e){this.set(e),this.validSectionLength=this.getValidSectionIds().length},getPrevSectionId:function(e){var t=this.getValidSectionIds(),n=t.indexOf(e)-1;return-1!=n&&t[n]},getNextSectionId:function(e){var t=this.getValidSectionIds(),n=t.indexOf(e)+1;return n!=t.length&&t[n]},getFirstSectionId:function(){return this.getValidSections()[0].get("TextSectionId")},getLastSectionId:function(){return this.getValidSections().slice(-1)[0].get("TextSectionId")},getModelBySectionId:function(e){var t=this.filter({TextSectionId:e});return t.length>0?t[0]:null},isTruncated:function(e){var t=this.getModelBySectionId(e);return sCH.readerConfig.isReadOnly&&-1===t.get("Truncated")},getValidSections:function(e){return e?a.filter(this.toJSON(),{IsDeleted:!1}):this.filter({IsDeleted:!1})},getValidSectionsJson:function(){return this.getValidSections(!0)},getValidSectionIds:function(){return a.map(this.getValidSectionsJson(),"TextSectionId")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(447),o=n(44);t.default=Backbone.Collection.extend({model:i.default,sync:o.default,fill_questions:function(e,t){var n=this;this.fetch({url:alcfg.node.reader_grading.get_panel_data,data:e,mainSuccess:function(e){n.set(e.Questions),t(e.ResponseData,e.UserResetRequests)}})},initWithData:function(e,t,n){var a=this;s.each(e,(function(e,t){n&&(e.QuestionNum=t+1),a.add(e)})),t&&""!==t&&(this.textSectionsLoaded||(this.textSectionsLoaded=[]),s.each(t.toString().split(","),(function(e){a.isSectionLoaded(e)||""==e||a.textSectionsLoaded.push(e)})))},isSectionLoaded:function(e){return this.textSectionsLoaded&&-1!==this.textSectionsLoaded.indexOf(e.toString())},getModelByQuestionTagId:function(e){return this.filter({TagId:e})[0]},getModelsBySectionId:function(e){return this.filter({TextSectionId:e})},getLastModel:function(){return this.models[this.length-1]},createNewTag:function(e,t,n){a.ajax({type:"POST",url:alcfg.node.reader_authoring.add_question,data:e,showLoading:!1,vital:!1,onSuccess:function(e){e?(n.set({TagId:e.QuestionTagId,UserId:e.UserId,Username:e.Username,ImageUrl:e.ImageUrl,CreateDate:e.CreateDate,QuestionNum:e.QuestionNum}),sCH.readerSettingsM.get("IsAssigned")&&a.bootstrap.alert({message:alcfg.alertsText.changesSaved})):a.showErrorPopup()},onError:function(e){"The remote server returned an error: (401) Unauthorized."===e.responseText&&(window.location.href="/account.html")}})},addQuestion:function(e){return this.add(e),this.getLastModel()},getSectionIdByTagId:function(e){return this.filter({TagId:e})[0].get("TextSectionId")},removeEmpty:function(){for(var e=this.filter({TagId:null}),t=0;t<e.length;t++)this.remove(e[t])},updateQuestionEndIndex:function(e){var t=0,n=this;s.each(e,(function(e){var a=n.getModelByQuestionTagId(e);a&&-1===a.get("StartIndex")&&-1!==a.get("EndIndex")&&(a.set("EndIndex",t),t++)}))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(1128),o=n(44);t.default=Backbone.Collection.extend({model:i.default,sync:o.default,fillByQuestionTagId:function(e,t,n){var a=this;this.fetch({url:alcfg.node.reader_grading.responses_by_question,data:{questionTagId:e,assignmentId:t,readerType:sCH.readerConfig.type},mainSuccess:function(e){a.set(e.responses),n(e.shouldShowAutoGradeStuff)},mainError:function(e,t){"offline"===t&&$("#noteTagRepliesContainer").hide()}})},fillByStudentUserIdAndAssignmentId:function(e,t,n){var a=this;this.fetch({url:alcfg.node.reader_grading.responses_by_student,data:{studentUserId:e,assignmentId:t,readerType:sCH.readerConfig.type},mainSuccess:function(e){a.set(e.responses),n(e.shouldShowAutoGradeStuff)}})},initWithData:function(e,t){this.add(e)},submitGrades:function(e,t){var n=-1===e.questionTagResponseId?alcfg.node.reader_grading.grade_unanswered:alcfg.node.reader_grading.grade_questionresponse;a.ajax({type:"POST",url:n,data:e,showLoading:!1,vital:!0,timeout:24e3,dontAbort:!0,onSuccess:function(e){t(!0)},onError:function(){t(!1)}})},submitComment:function(e,t){-1===e.questionTagResponseId&&delete e.questionTagResponseId,a.ajax({type:"POST",url:alcfg.node.reader_grading.comment_questionresponse,data:e,showLoading:!1,vital:!0,timeout:24e3,dontAbort:!0,onSuccess:function(e){t(!0)},onError:function(){t(!1)}})},unGrade:function(e){a.ajax({type:"POST",url:alcfg.node.reader_grading.ungrade_questionresponse,data:e,showLoading:!1,vital:!1,timeout:24e3,dontAbort:!0,onSuccess:function(){}})},getGradingDataByQuestionTagId:function(e){var t=this.filter({QuestionTagId:e,IsReset:!1}),n=[],a=0;return s.each(t,(function(e){null!==e.get("Grade")&&a++,"No response"!==e.get("Text",!0)&&n.push(e.get("ImageUrl"))})),{imageUrls:n,unGradedCount:t.length-a,peerResponseCount:t.length}},getAnsweredDataByQuestionTagId:function(e){var t=this.filter({QuestionTagId:e});t=s.filter(t,(function(e){return"No response"!==e.get("Text",!0)&&!e.get("IsReset")})),t=this.filterAndSortPeerResponses(t);var n=s.filter(t,(function(e){return!e.get("CreatedByCurrentUser")})).length,a=[],i=sCH.readerConfig.Settings,o=i&&!i.NamedPeerResponses;return s.each(t,(function(e){a.push(o&&!e.get("CreatedByCurrentUser")?"icon-person":e.get("ImageUrl"))})),{imageUrls:a,peerResponseCount:n}},getResponseModelsByTagId:function(e,t){var n=this.filter({QuestionTagId:e});return"student"===sCH.readerConfig.type||t?(n=s.filter(n,(function(e){return"No response"!==e.get("Text",!0)&&!e.get("IsReset")})),this.filterAndSortPeerResponses(n)):n},filterAndSortPeerResponses:function(e){var t=sCH.readerConfig.Settings?sCH.readerConfig.Settings.ViewPeerResponses:"all";return e="all"!==t?(e=s.filter(e,(function(e){var n=e.get("Grade");return"onlyproficientandadvanced"===t&&3===n||4===n}))).sort((function(e,t){var n=t.get("Grade")-e.get("Grade");return n||moment.utc(e.get("CreateDate")).isAfter(moment.utc(t.get("CreateDate")))})):e.sort((function(e,t){return moment.utc(e.get("CreateDate")).isAfter(moment.utc(t.get("CreateDate")))}))},getChoicePercentageByTagId:function(e,t){for(var n=this.filter({QuestionTagId:e,IsReset:!1}),a=0;a<t.length;a++)t[a].count=0,0===n.length?t[a].percent=0:(s.each(n,(function(e){-1!==$.inArray(t[a].QuestionChoiceId.toString(),e.get("Text").split(","))&&t[a].count++})),t[a].percent=Math.floor(t[a].count/n.length*100));return t},getResponseByTagId:function(e){var t=this.filter({QuestionTagId:e,CreatedByCurrentUser:!0}),n={},a=t[0];if(a)return n.Answer={Text:a.get("Text"),MediaUrl:a.get("MediaUrl"),ImageUrl:a.get("ImageUrl"),FirstName:a.get("FirstName"),LastName:a.get("LastName"),Votes:a.get("VoteData"),IsDraft:a.get("IsDraft"),QuestionTagResponseId:a.get("QuestionTagResponseId"),IsReset:a.get("IsReset"),IsStudentRequestReset:a.get("IsStudentRequestReset")},a.get("IsDraft")&&t[1]&&t[1].get("TeacherComment")&&(a=t[1]),n.Grading={Text:a.get("TeacherComment"),ImageUrl:a.get("TeacherImageUrl"),TeacherName:a.get("TeacherName"),Grade:a.get("Grade")},n},getCurrentUserResponseByQuestionTagId:function(e){return this.filter({QuestionTagId:e,CreatedByCurrentUser:!0})[0]},addAnswer:function(e,t){var n=this;function i(a,i){var o,r=sCH.userM,l=s.find(n.models,(function(t){return t.get("QuestionTagId")===e.QuestionTagId&&t.get("UserId")===r.get("UserId")&&!t.get("IsReset")}));if(l?o=l.get("QuestionTagResponseId"):i?o?a.rndId=o:o=a.rndId:o=a.QuestionTagResponseId,l)l.set("MediaUrl",e.MediaUrl),l.set("Text",e.Text),l.set("IsDraft",!!e.IsDraft),l.set("IsReset",!1),l.set("TeacherComment",null),l.set("Grade",null),t&&t(l);else{var d={CreatedByCurrentUser:!0,QuestionTagResponseId:o,QuestionTagId:e.QuestionTagId,Text:e.Text,ImageUrl:r.get("ImageUrl"),FirstName:r.get("Name").split(" ")[0],LastName:r.get("Name").split(" ")[1],TeacherTitle:r.get("Title"),UserId:r.get("UserId"),CreateDate:a&&a.CreateDate?a.CreateDate:(new Date).toISOString(),Grade:a.Grade,TeacherComment:e.TeacherComment,IsDraft:!!e.IsDraft,IsReset:!1,SawExtraHelp:e.SawExtraHelp,MediaUrl:e.MediaUrl};n.add(d,{at:0})}sCH.teacherQuestionsC&&sCH.teacherQuestionsC.find({TagId:e.QuestionTagId}).updateCorrectQuestionChoices(a.correctQuestionChoiceIds),i&&(e.UserId=r.get("UserId"),a.modelAdded=l||d,a.modelIdAttribute="QuestionTagResponseId",a.collectionName="questionTagResponsesC")}var o=sCH.teacherQuestionsC.filter({TagId:e.QuestionTagId})[0];"tour"===sCH.readerConfig.type&&3!==o.get("SubType")?i(this,!0):a.ajax({type:"POST",url:alcfg.node["student"===sCH.readerConfig.type?"reader_student":"reader_studentir"].add_questionresponse,data:{questionTagId:e.QuestionTagId,assignmentId:e.AssignmentId,studentLayerId:e.StudentLayerId,isDraft:e.IsDraft,sawExtraHelp:e.SawExtraHelp,text:e.Text,grade:e.Grade,mediaUrl:e.MediaUrl,wordCount:e.WordCount||0,readerType:sCH.readerConfig.type},showLoading:!1,vital:!0,timeout:24e3,onSuccess:function(e){e?i(e,!1):alert(e)},onError:function(e,n){"offline"===n?i(this,!0):'"You have already answered this question."'===e.responseText?a.bootstrap.alert({message:"You have already answered this question. Please refresh the browser to get your latest responses.",alert:"danger",autoClose:!1}):(t(),a.showErrorPopup(a.getErrorTextFromResponse(e)))}})},undoAnswer:function(e,t){"tour"===sCH.readerConfig.type?(e.set("IsDraft",!0),t(e)):a.ajax({type:"POST",url:alcfg.node["student"===sCH.readerConfig.type?"reader_student":"reader_studentir"].mark_draft,data:{questionTagResponseId:e.get("QuestionTagResponseId"),isDraft:!0,assignmentId:sCH.readerConfig.assignmentId,studentLayerId:sCH.readerConfig.studentLayerId,readerType:sCH.readerConfig.type},showLoading:!1,vital:!0,onSuccess:function(n){n&&(e.set("IsDraft",!0),t(e))},onError:function(n,a){"offline"===a&&(e.set("IsDraft",!0),t(e),this.modelAdded=e,this.modelIdAttribute="QuestionTagResponseId")}})},resetAnswer:function(e,t){"tour"===sCH.readerConfig.type?(e.set({IsReset:!0,IsStudentReset:!0},{silent:!0}),t(e)):a.ajax({type:"POST",url:alcfg.node.reader_student.reset_answer,data:{questionTagResponseId:e.get("QuestionTagResponseId"),isReset:!0,isStudentReset:!0,assignmentId:sCH.readerConfig.assignmentId,readerType:sCH.readerConfig.type},showLoading:!1,vital:!0,onSuccess:function(n){n&&(e.set({IsReset:!0,IsStudentReset:!0},{silent:!0}),t(e))},onError:function(n,a){"offline"===a&&(e.set({IsReset:!0,IsStudentReset:!0}),t(e),this.modelAdded=e,this.modelIdAttribute="QuestionTagResponseId")}})},requestResetAnswer:function(e,t){"tour"===sCH.readerConfig.type?(e.set("IsStudentRequestReset",!0),t(e)):a.ajax({type:"POST",url:alcfg.node.reader_student.request_reset_answer,data:{questionTagResponseId:e.get("QuestionTagResponseId"),isStudentRequestReset:!0,assignmentId:sCH.readerConfig.assignmentId,readerType:sCH.readerConfig.type},showLoading:!1,vital:!0,onSuccess:function(n){n&&(e.set("IsStudentRequestReset",!0),t(e))},onError:function(n,a){"offline"===a&&(e.set("IsStudentRequestReset",!0),t(e),this.modelAdded=e,this.modelIdAttribute="QuestionTagResponseId")}})},getAllResponsesForCurrentUser:function(e){return this.filter((function(t){return t.get("QuestionTagId")===e&&t.get("CreatedByCurrentUser")&&!t.get("IsDraft")})).slice().reverse()}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(24),r=n(5),l=n(10),d=n(8),c=n(335),u=n(336),p=n(465),h=n(466),g=n(467),f=n(88),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={title:sCH.userM.get("Title"),gradeLevelId:sCH.userM.get("GradeLevelId"),subjectId:sCH.userM.get("SubjectId"),educatorType:sCH.userM.get("EducatorType"),origin:sCH.userM.get("Origin"),originOtherText:sCH.userM.get("OriginOtherText"),open:!0,subjectChanged:!1},t.handleChange=function(e){return function(n){var a,s="subjectId"===e&&sCH.userM.get("SubjectId")!==n.target.value;t.setState(((a={})[e]=n.target.value,a.subjectChanged=s,a))}},t.onSubmit=function(){var e=d.pickBy({title:t.props.shouldGet.title?t.state.title:null,subjectId:t.props.shouldGet.subjectId?t.state.subjectId:null,priorSubjectId:t.state.subjectChanged&&t.props.isSubjectChangeLimited?sCH.userM.get("SubjectId"):null,gradeLevelId:t.props.shouldGet.gradeLevelId?t.state.gradeLevelId:null,educatorType:t.props.shouldGet.educatorType?!t.state.educatorType:null,origin:t.props.shouldGet.origin?t.state.origin:null,originOtherText:t.props.shouldGet.origin&&"other"===t.state.origin?t.state.originOtherText:null});l.addMissingTeacherInfo(e,(function(){r.bootstrap.alert({message:"Your details were successfully updated"}),Object.keys(e).forEach((function(t){sCH.userM.set(r.camelToPascal(t),isNaN(e[t])?e[t]:parseInt(e[t],10))})),$("#gradelevelSubjectString").text(r.getGradelevelSubjectString()),$("#profileTitleString").text(sCH.userM.get("Title")),t.state.subjectChanged&&(sCH.catalogSubjectSlug=f.getCatalogSubjectSlugBySubjectId(t.state.subjectId),1===sCH.userM.get("AllowedSubjectSlugs").length&&sCH.userM.set("AllowedSubjectSlugs",[sCH.catalogSubjectSlug]),Backbone.pubEv.trigger("updateCatalog")),o.hideModals()}))},t}return s(t,e),t.prototype.render=function(){return i.createElement(o.default,{title:this.props.modalTitle,okText:"Submit",okCallback:this.onSubmit,maxWidth:"md",allowCancel:!1,disabledOkText:"Saving..."},i.createElement("p",{className:"info"},"To customize your experience, please tell us about yourself."),this.props.shouldGet.title&&i.createElement(c.default,{title:this.state.title,handleChange:this.handleChange}),this.props.shouldGet.gradeLevelId&&i.createElement(u.default,{gradeLevelId:this.state.gradeLevelId,onChange:this.handleChange("gradeLevelId"),showGradeLevelAsRange:!0}),(this.props.shouldGet.subjectId||this.props.isSubjectChangeLimited)&&i.createElement(p.default,{subjectId:this.state.subjectId,handleChange:this.handleChange,disabled:this.props.isSubjectChangeLimited&&!this.props.shouldGet.subjectId}),this.state.subjectChanged&&this.props.isSubjectChangeLimited&&i.createElement("p",{className:"warning"},"Note: you can change your subject only once."),this.props.isSubjectChangeLimited&&!this.props.shouldGet.subjectId&&i.createElement("p",{className:"info ctaInfo"},"Please email ",i.createElement("a",{href:"mailto:help@activelylearn.com"},"help@activelylearn.com")," if you need to change your subject again."),this.props.shouldGet.educatorType&&i.createElement(h.default,{educatorType:this.state.educatorType,handleChange:this.handleChange}),this.props.shouldGet.origin&&i.createElement(g.default,{origin:this.state.origin,originOtherText:this.state.originOtherText,handleChange:this.handleChange}))},t}(i.Component);t.default=m},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(174),i=["#D32F2F","#FFC107","#388E3C"],o=["#db5858","#fecd38","#4bb851"],r=[" Basic","Basic - Proficient"," Proficient"];t.default=function(e){return a.createElement(s.Pie,{data:{labels:r,datasets:[{data:e.data,backgroundColor:i,hoverBackgroundColor:o}]},options:{legend:{display:!1},labels:{render:"label",fontColor:"#000",position:"outside"},plugins:{datalabels:{display:!1}}}})}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(483),i=n(13),o=i.createMuiTheme,r=i.MuiThemeProvider,l=(i.withStyles,o({overrides:{MuiSwitch:{thumb:{backgroundColor:"#03A9F4"},track:{backgroundColor:"#81D4FA !important"}}}}));t.default=function(e){return a.createElement(r,{theme:l},a.createElement("a",null,e.leftOption),a.createElement(s.default,{checked:e.checked,color:"primary",disableRipple:!0}),a.createElement("a",null,e.rightOption))}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(8),o=n(5);t.getHeader=function(e){return s.createElement("div",null,s.createElement("span",{className:"labels"},e.StandardCode),e.ShortText.length>20?s.createElement("span",{title:e.ShortText,"data-placement":"bottom"},o.truncate(e.ShortText,20)):e.ShortText)},t.getProficiency=function(e,t){var n=e.filter((function(e){return e.StandardId===t})),o={numStudents:i.sumBy(n,"NumStudents"),numProficient:i.sumBy(n,"NumProficient")};return o&&o.numStudents?s.createElement("div",{className:d(o)},s.createElement(l,a({},o))," ",s.createElement("br",null),s.createElement(r,a({},o))):null},t.getClassDisplayName=function(e,t){if(e.value){var n=t.find((function(t){return t.ClassId===parseInt(e.value)})).ClassName;return n.length>28?s.createElement("span",{title:n,"data-placement":"right"},o.truncate(n,28)):n}},t.componentDidMountCallback=function(e){o.initTooltips($(".ReactTable"));var t=150*e+250;$(".ReactTable").css({width:t,maxWidth:"100%"}),$(".rt-tbody, .rt-thead").css({minWidth:t}),$(".rt-table").scroll((function(){$(".rt-table").toggleClass("scrolling",0!==$(".rt-table").scrollLeft())}))};var r=function(e){return s.createElement("span",{className:"cellInfo"},e.numProficient,"/",e.numStudents)},l=function(e){var t=(e.numProficient/e.numStudents*100).toFixed(0);return s.createElement("span",{className:"percent"},t,"%")},d=function(e){var t=parseInt((e.numProficient/e.numStudents*100).toFixed(0));return i.isNaN(t)?"":t>=67?"proficient cell":t<=33?"basic cell":"average cell"}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(54),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.dateRangeData,a=t.reportType,s=t.dataRangeOptions;o.initDateRangePicker(n.start,n.end,(function(t,n,a){e.props.setDateRange({start:t,end:n})}),a,s)},t.prototype.componentWillUnmount=function(){$(".reportrange").remove()},t.prototype.render=function(){return i.createElement("div",{className:"reportrange pull-right"},i.createElement("span",null),i.createElement("b",{className:"caret"}))},t}(i.Component);t.default=r},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1283),initialize:function(e){this.on("ok",this.save),this.on("cancel",this.destroy),this.on("shown",this.shown),this.mode=e.mode,this.standardId=e.standardId,this.isPublished=e.isPublished,this.parent=e.parent,this.callback=e.callback,this.standardSetId=e.standardSetId},shown:function(e){this.modal=e,this.medium=s.initMediumEditor(e.$el.find("[contenteditable]"))},render:function(){var e="edit"===this.mode?a.find(this.parent.standards,{StandardId:this.standardId}):{};this.$el.html(this.template({isPublished:this.isPublished,standard:e}))},getEnteredData:function(){var e=this.modal.$el.find("#txtCode"),t=this.modal.$el.find("#txtShortText"),n=this.modal.$el.find("#txtDescription");if(0===s.checkRequiredFields([e,t])+s.checkRequiredFields([n],!0)){var a={advanced:$("#txtAdvanced").text().trim(),proficient:$("#txtProficient").text().trim(),basic:$("#txtBasic").text().trim(),incomplete:$("#txtIncomplete").text().trim(),zero:$("#txtZero").text().trim()},i=[{type:"advanced",critique:[{text:a.advanced.length>0?$("#txtAdvanced").html().trim():""}]},{type:"proficient",critique:[{text:a.proficient.length>0?$("#txtProficient").html().trim():""}]},{type:"basic",critique:[{text:a.basic.length>0?$("#txtBasic").html().trim():""}]},{type:"incomplete",critique:[{text:a.incomplete.length>0?$("#txtIncomplete").html().trim():""}]},{type:"zero",critique:[{text:a.zero.length>0?$("#txtZero").html().trim():""}]}];return{StandardSetId:this.standardSetId,StandardCode:e.val(),ShortText:t.val(),Description:n.html(),RubricData:JSON.stringify(i)}}return null},save:function(){var e=this;if(this.modal.preventClose(),"edit"===this.mode){var t=this.getEnteredData();t&&(this.modal.disableOk("Saving..."),t.StandardId=this.standardId,i.EditStandard(t,(function(n){e.modal.close(),s.bootstrap.alert({message:"Updated the standard!"}),e.callback(t)})))}else{var n=e.getEnteredData();n&&(this.modal.disableOk("Adding..."),i.AddNewStandard(n,(function(t){n.StandardId=t,e.modal.close(),s.bootstrap.alert({message:"Added the standard!"}),e.callback(n)})))}},destroy:function(){s.destroyMediumEditor(this.medium)}})},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(199),i=n(1335),o=n(10),r=n(14),l=n(24),d=n(154),c=n(5);t.default=function(e){var t=e.callback,n=e.title,u=r.UserAccountSource.BRIGHTSPACE,p=r.UserAccountSource.CANVAS,h=r.UserAccountSource.SCHOOLOGY,g=r.UserAccountSource.ONEROSTER,f=r.UserAccountSource.ACHIEVE3K,m=r.UserAccountSource.CLEVER,v=a.useState(null),b=v[0],C=v[1];return a.useEffect((function(){sCH.userM.get("Accounts").google&&d.init(["https://www.googleapis.com/auth/classroom.courses","https://www.googleapis.com/auth/classroom.rosters","https://www.googleapis.com/auth/classroom.profile.emails","https://www.googleapis.com/auth/classroom.coursework.students","https://www.googleapis.com/auth/classroom.coursework.students.readonly"]),o.GetSourcesWithAPIAccess((function(e){C(e)}))}),[]),b&&a.createElement(s.AddNewClassPopup,{title:n,cssClass:"modal-al-add-class",hideModal:l.hideModals,showModal:l.showModal,schoolInfo:sCH.userM.get("SchoolInfo"),isHigherEd:sCH.userM.get("IsHigherEd"),iconUrls:{Google:"https://www.gstatic.com/classroom/logo_square_48.svg",Brightspace:"/img/Brightspace.png",Clever:"/img/Clever.png",Canvas:"/img/Canvas.png",Schoology:"/img/Schoology.png",ACHIEVE3K:"/img/Achieve3000Logo128.png",Edmodo:"/img/Edmodo.png"},onGradeLevelUpdated:i.onGradeLevelUpdated,googleImportHelper:!!sCH.userM.get("Accounts").google&&i.googleImportHelper(t),edmodoImportHelper:!!sCH.userM.get("Accounts").edmodo&&i.edmodoImportHelper(t),cleverImportHelper:!sCH.userM.get("IsMasquerading")&&!!sCH.userM.get("Accounts").clever&&sCH.userM.get("LoginSource")===m&&i.cleverImportHelper(t),canvasImportHelper:!!b.find((function(e){return e===p}))&&!!sCH.userM.get("Accounts")[p]&&i.canvasImportHelper(t),brightspaceImportHelper:!!b.find((function(e){return e===u}))&&!!sCH.userM.get("Accounts")[u]&&i.brightspaceImportHelper(t),schoologyImportHelper:!!b.find((function(e){return e===h}))&&!!sCH.userM.get("Accounts")[h]&&i.schoologyImportHelper(t),oneRosterImportHelper:!!b.find((function(e){return e===g}))&&!!sCH.userM.get("Accounts")[g]&&i.oneRosterImportHelper(t),achieve3KImportHelper:!!b.find((function(e){return e===f}))&&!!sCH.userM.get("Accounts")[f]&&i.achieve3KImportHelper(t),onSubmit:function(e){sCH.classesC.addClass(e,(function(n){l.hideModals();try{c.intercom("trackEvent","added-Class",{className:e.Name,classCode:e.Code,classSource:"native"})}catch(e){}t(n)}))}})}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(233),r=n(10),l=n(5),d=n(276),c=n(34),u=n(24);t.default=function(e){var t=e.text,n=e.isResearch,p=void 0!==n&&n,h=e.title,g=e.okText,f=e.callback,m=e.cssClass,v=void 0===m?"":m,b=i.useState(t.Title),C=b[0],y=b[1],_=i.useState(t.Author),S=_[0],w=_[1],T=i.useState(t.SkillBucketId||""),I=T[0],x=T[1],k=1===t.Type;function E(e){var n=function(e){var n={title:C,author:S||void 0,skillBucketId:parseInt(I),coverArtUrl:e,isResearch:p};p?n.studentLayerId=t.StudentLayerId:n.layerId=t.LayerId;return n}(e),a=n.isResearch?"EditResearchMetadata":"EditTextMetadata";r[a](n,(function(){var a=t;p||(a.SkillBucketId=n.skillBucketId),a.Title=n.title,a.Author=n.author,e&&(a.CoverArt=e),f&&f(a),l.bootstrap.alert({message:"The text's details have been updated!"}),u.hideModals()}))}return i.createElement(u.default,{title:h,okText:g,okCallback:function(){var e=this;k?E():sCH.reactUploader.isFileUploaded((function(t){t?sCH.reactUploader.submit((function(t){return a(e,void 0,void 0,(function(){return s(this,(function(e){return E(t),[2]}))}))})):E()}))},cssClass:v,disabledOkText:"Updating..."},i.createElement("div",{className:"articleDetails"},i.createElement(c.TextValidator,{name:"txtTitle",id:"txtTitle",label:"Title",value:C,onChange:function(e){return y(e.target.value)},required:!0,autoFocus:!0,fullWidth:!0}),!k&&"Videos"!==t.TextType&&i.createElement(c.TextValidator,{name:"txtAuthor",id:"txtAuthor",label:"Author",value:S,onChange:function(e){return w(e.target.value)},required:"Please enter the author name",fullWidth:!0}),!p&&i.createElement("div",{className:"unitSelectorContainer"},i.createElement(d.default,{contentType:I,onChange:function(e){return x(e.target.value)}})),!k&&i.createElement("div",{className:"uploadImageContainer"},i.createElement(o.default,{uploadUrl:alcfg.node.workspace.upload_coverart,enableMultipleErrorMessage:"You can upload only one image.",fileType:alcfg.imageExtensions.map((function(e){return"image/"+e})).join(","),fileTypeErrorMessage:"Select a valid image file.",fileDropPlaceholder:"Try dropping an image here, or click to select an image to upload.",maxFileSize:alcfg.MBInBytes[10],submitData:{},enableMultiple:!1,disablePreview:!0}))))}}).call(this,n(21))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24);t.default=function(e){var t,n=e.selectedLayer,i=e.coauthorFirstAdded,o=e.okCallback;return i&&(t=alcfg.confirmsText.changeAuthor.format(i.FullName)),a.createElement(s.default,{title:"Delete this assignment?",okText:"Delete",cssClass:"modal-al-items-to-be-deleted",okCallback:o},a.createElement("p",null,n.IsAssigned?alcfg.confirmsText.textsDeleteExtra:alcfg.confirmsText.textsDelete),a.createElement("p",{className:"warning"},n.IsInLibrary?alcfg.confirmsText.libraryLayerDeleteFromWorkspace:""),i&&a.createElement("p",{className:"info"},t))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(24),r=n(5),l=n(10),d=n(277),c=n(152),u=n(48),p=n(740),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={shareDataFetched:!1,note:"",teachers:null,signUpEmailLink:null,selectedUserIds:[],okBtnText:t.props.okText,cancelText:"Cancel"},t.share=function(e){var n=t.state,a=n.note,s=n.selectedUserIds,i={layerIds:[t.props.layerId],userIds:s,note:a};l.ShareLayers(i,(function(e){if(!1!==e)if(r.intercom("trackEvent","shared-Assignment",{type:"Internal"}),e.noAccessNames.length>0){var n=e.noAccessNames.join(", ")+" cannot access any more shared assignments. For unlimited sharing and receiving, your school needs to upgrade to the Prime plan.";u.showBuyTeacherPopup({title:"Sharing limit reached",content:n})}else{r.bootstrap.alert({message:"Your assignment(s) are now shared in your colleagues' Workspaces (they will have to refresh the page). They will be notified via email."})}else r.bootstrap.alert({message:'Unable to share item. If problem persists please <a class="alert-link" href="mailto:help@activelylearn.com">contact us</a> at help@activelylearn.com',alert:"danger"});Backbone.pubEv.trigger("cancelSelectMode"),o.hideModals(),t.redirect()}))},t.redirect=function(){t.props.redirectUrl&&(window.location.hash=t.props.redirectUrl)},t.isSelected=function(){return 0!==t.state.selectedUserIds.length||(r.bootstrap.alert({message:"Please select 1 or more colleagues to share your assignment with!",alert:"danger"}),!1)},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;l.GetLayerShareData({layerId:this.props.layerId},(function(t){e.setState({teachers:t.colleagues,signUpEmailLink:e.generateSignUpLink(t.shareLayerDetails),shareDataFetched:!0}),0===t.colleagues.length&&e.setState({okBtnText:null,cancelText:"Close"})}))},t.prototype.generateSignUpLink=function(e){return window.location.origin+(e.IsPreviewReaderUrl?"/#teacher/reader/authoring/preview/"+e.LayerIdToShare+"/notes":"/account.html#/signup/educator/step1?sharedLayerId="+e.LayerIdToShare+"&furl=teacher/catalog/my-folders/everything")},t.prototype.render=function(){var e=this,t=this.state,n=t.shareDataFetched,a=t.note,s=t.teachers,l=t.okBtnText,u=t.cancelText,h=t.signUpEmailLink;return n&&i.createElement(o.default,{title:this.props.title,okText:l,disabledOkText:"Sharing...",cancelText:u,allowCancel:!1,okCallback:this.share,cancelCallback:this.props.redirectUrl?this.redirect:void 0,customValidations:[{name:"isSelected",func:this.isSelected}],maxWidth:"md",shouldOverflow:!0},i.createElement("p",{className:"description"},"Sharing will create separate copies of the selected assignment for teachers to independently edit and use in their own classes."),i.createElement(d.default,{placeholder:"Start typing a colleague's name...",suggestions:s.map((function(e){return{value:e.UserId,label:e.FirstName+" "+e.LastName}})),onChange:function(t){e.setState({selectedUserIds:t.map((function(e){return e.value}))})},validators:{isSelected:""}}),i.createElement(c.default,{className:"txtDescription",id:"noteForColleague",label:"Add note to send to colleague (optional)",value:a,onChange:function(t){return e.setState({note:t.target.value})},variant:"outlined",multiline:!0,fullWidth:!0}),i.createElement(p.default,{description:"If your colleague is not signed up on Actively Learn,",signupEmailContent:r.getSignupEmailContent(h)}))},t}(i.Component);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(72),i=n(232),o=n(5);t.default=function(e){var t=e.description,n=e.signupEmailContent;return a.useEffect((function(){new i.default(".btnCopyLink",{target:function(){return document.getElementById("clipboardText")}}).on("success",(function(){o.bootstrap.alert({message:'The email has been copied to your clipboard. Use "Control+V" or "Paste" to use it.'})}))}),[]),a.createElement(a.Fragment,null,a.createElement("div",{id:"clipboardText",className:"visuallyHidden",role:"presentation"},n.emailBody),a.createElement("span",{className:"info moveup"},t," Send them an ",a.createElement("a",{className:"btnEmail infoLink",href:n.emailLink,target:"_blank"},"email to signup"),"."),a.createElement(s.default,{type:"button",buttonClass:"icon-copytoclipboard btnCopyLink",buttonTitle:"Copy email message to clipboard"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(5),i=n(266),o=n(10),r=n(199),l=n(24),d=n(742);t.default=function(e){var t=e.layerId,n=e.coAuthoredLayerTitleList,c=void 0===n?[]:n,u=e.layers,p=e.successCallback,h=e.title,g=e.okText,f=e.redirectUrl,m=void 0===f?null:f,v=e.withCopyRightReminder,b=void 0!==v&&v,C=a.useState(!1),y=C[0],_=C[1],S=a.useState(!1),w=S[0],T=S[1],I=a.useRef(),x=u.filter((function(e){return 1===e.IsInLibrary})),k=null;function E(){m&&(window.location.hash=m)}return x.length>0&&(k=x[0].LayerId),a.useEffect((function(){b&&o.GetIsCopyrightWarningConfirmed((function(e){e||_(!0)}))}),[]),a.useEffect((function(){y&&I.current&&(w?I.current.enableOkButton():I.current.disableOkButton())}),[w,y]),a.createElement(r.Modal,{title:h,okText:g,okCallback:function(){var e={layerId:t};s.attachSchoolDistrictId(e),y&&(e.copyrightReminderChecked=w),o.AddLayerToLibrary(e,(function(e){e?(p(),s.bootstrap.alert({message:"Your assignment has been added to your "+i.userM.getLibraryString()})):s.bootstrap.alert({message:'Unable to add item. If problem persists please <a class="alert-link" href="mailto:help@activelylearn.com">contact us</a> at help@activelylearn.com',alert:"danger"}),l.hideModals(),E()}))},disabledOkText:"Adding...",cancelCallback:m?E:void 0,optionButtons:[{text:"Learn more",callback:function(){return s.windowOpen(alcfg.helpArticleLink.navigateSchoolLibrary,"_blank")}}],cancelText:"Cancel",ref:I},a.createElement("p",null,"This assignment will be accessible to every teacher in your ",i.userM.getPrimePlanScope()),c&&c.length>0&&a.createElement("p",{className:"warning"},"The selected assignments below have co-authors who may edit the assignment that will be shared in the Library.",a.createElement("ul",{className:"info"},c.map((function(e,t){return a.createElement("li",{key:e+"_"+t},s.sanitize(e))})))),k&&a.createElement("p",{className:"warning"},"Note: There is an assignment for this text in the ",i.userM.getLibraryString()," already (",a.createElement("a",{href:"#teacher/reader/authoring/preview/"+k+"/notes",className:"infoLink",target:"_blank",rel:"noopener"},"preview here"),"). Do you still want to add this assignment?"),y&&a.createElement(d.default,{checked:w,setChecked:T,libraryString:i.userM.getLibraryString(),label:a.createElement("p",null,"I confirm that my school or district has a license to use this content across the school or district.")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(199);t.default=function(e){var t=e.checked,n=e.setChecked,i=e.libraryString,o=void 0===i?"my school":i,r=e.label,l=(void 0===r?null:r)||a.createElement("p",null,"I confirm that ",o," has a license to this content, or that my use of this content constitutes fair use for ",a.createElement("a",{href:"https://www.lib.uchicago.edu/copyrightinfo/fairuse.html",target:"_blank",className:"infoLink",rel:"noopener"},"educational purposes"),".");return a.createElement(s.Checkbox,{label:l,checked:t,setChecked:n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(0);t.default=function(e){var t=e.data,n=a.classNames({topictile:!0}),i=a.classNames({eq:!0,longTitle:t.TopicName.length>72}),o=function(e){var t=[];return e.TopicBuckets.forEach((function(e){if(e&&e.NumTexts>0){var n=e.TopicBucketName.replace("Related ","");1===e.NumTexts?"Poetry"===e.TopicBucketName?n="Poem":"Short Stories"===e.TopicBucketName?n="Short Story":"Drama"!==e.TopicBucketName&&(n=n.slice(0,-1)):"Poetry"===e.TopicBucketName&&(n="Poems"),t.push(e.NumTexts+" "+n)}})),t}(t).join(", "),r=a.classNames({topics:!0,longTitle:o.length>65}),l="Topic";return"Text"===t.GroupName&&(l="ela"===t.SubjectSlug?"Text":"Primary Source"),s.createElement("a",{className:n,href:"#teacher/catalog/"+t.TopicSlug,"aria-label":a.sanitize(t.TopicName)},s.createElement("div",{className:"wrapper"},s.createElement("div",{className:"coverArtWrapper",style:{backgroundImage:"url("+t.ImageUrl+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),s.createElement("div",{className:"metadata"},s.createElement("div",{className:"eqTitle"},l),s.createElement("div",{className:i},t.TopicName),o.length>0&&s.createElement("div",{className:r},s.createElement("div",{className:"topicsTitle"},"Related"),o))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(54),r=n(69);t.default=Backbone.View.extend({el:".layout .scroll",events:{},template:n(745),questionsTemplate:n(1341),initialize:function(e){this.teacherUserId=e.teacherUserId,this.mainView=e.mainView},preRender:function(){if(sCH.userM.isOnPrimePlan()){var e=o.getSchoolYearRangeOrDefault("admin"),t=this,n='<button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="This report lists questions with student responses. Statistics are across all classes."></button>',a="professional_learning"===this.mainView?"<h2>Questions authored"+n+"</h2>":"<h2>Questions authored by teacher"+n+"</h2>";this.$el.html(this.template()),this.$el.find(".reportrange").after(a),this.dateFilter=this.dateFilter?this.dateFilter:{start:e.start,end:e.end},o.initDateRangePicker(this.dateFilter.start,this.dateFilter.end,(function(e,n,a){t.dateFilter={start:e,end:n},t.render()}),"admin"),this.render(),s.initTooltips(this.$el)}else this.$el.html(new r.default({screenshotUrl:"/img/TeacherReports_Questions.png",showSampleBanner:!0}).render().$el)},render:function(){var e=this;i.GetTeacherQuestions({teacherUserId:this.teacherUserId,startDate:this.dateFilter.start.toISOString(),endDate:this.dateFilter.end.toISOString()},(function(t){t?(e.data=t,e.prepareBreakdownAndUpdateDdl(),e.filter()):s.bootstrap.alert({message:t.Message?t.Message:"Something went wrong. Please try again.",alert:"danger"})}))},fillEl:function(){if(0===this.filteredData.length){var e="professional_learning"===this.mainView?'<div class="ctaInfo">You do not have any questions that have responses for this date range and filter selection.</div>':'<div class="ctaInfo">This teacher does not have any questions that have responses for this date range and filter selection.</div>';this.$el.find(".dateRangeTableContainer").html(e)}else this.$el.find(".dateRangeTableContainer").html(this.questionsTemplate({responseData:this.filteredData,userRole:sCH.userM.get("Role")}));s.initHelpPopover(this.$el)},filter:function(){var e=$(".subheader .ddlStandards").val(),t=parseInt($(".subheader .ddlQuesType").val());this.filteredData="hasstandard"===e?a.reject(this.data,(function(e){return null===e.StandardCode})):"nostandard"===e?a.filter(this.data,{StandardCode:null}):a.filter(this.data,(function(t){return t.StandardCode===e||t.SecondStandardCode===e})),-1!==t&&(this.filteredData=a.reject(this.filteredData,(function(e){return e.SubType!==t}))),this.fillEl()},prepareBreakdownAndUpdateDdl:function(){var e=[],t=0,n=0,s={1:0,2:0,3:0};a.each(this.data,(function(a){a.StandardCode?(t++,e[a.StandardCode]?e[a.StandardCode]++:e[a.StandardCode]=1,a.SecondStandardCode&&(e[a.SecondStandardCode]?e[a.SecondStandardCode]++:e[a.SecondStandardCode]=1)):n++,s[a.SubType]++}));var i='<option value="hasstandard" data-content="With standard assigned<span>'+t+' Total Questions</span>"></option>';for(var o in e)i+='<option value="'+o+'" data-content="'+o+"<span>"+e[o]+' Total Questions</span>"></option>';i+='<option value="nostandard" data-content="No standard<span>'+n+' Total Questions</span>"></option>',$(".subheader select.ddlStandards").html(i),i='<option value="-1" data-content="All question types<span>'+this.data.length+' Total Questions</span>"></option>',a.each(a.range(1,4),(function(e){i+='<option value="'+e+'" data-content="'+(1===e?"Short answer":2===e?"Multiple choice":"Poll")+"<span>"+s[e]+' Total Questions</span>"></option>'})),$(".subheader select.ddlQuesType").html(i),$(".subheader select").selectpicker("refresh")},destroy:function(){$(".daterangepicker").remove()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="reportrange pull-right"><span></span><b class="caret"></b></div>\n<div class="dateRangeTableContainer"></div>\n<div id="pagination"></div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(10),r=n(54),l=n(69),d=n(271);t.default=Backbone.View.extend({el:".layout .scroll",template:n(745),gradingFeedbackTemplate:n(747),initialize:function(e){this.teacherUserId=e.teacherUserId,this.mainView=e.mainView},preRender:function(){if(sCH.userM.isOnPrimePlan()){var e=r.getSchoolYearRangeOrDefault("admin"),t=this,n="professional_learning"===this.mainView?'<h2>Grading feedback            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover"               data-content="This report lists student responses that you have commented on.">            </button>          </h2>':'<h2>Grading feedback by teacher          <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover"             data-content="This report lists student responses that teachers have commented on.">          </button>          </h2>';this.$el.html(this.template()).addClass("teacherGradingFeedback"),this.$el.find(".reportrange").after(n),this.$el.find(".dateRangeTableContainer").attr("id","portfolioContainer"),this.dateFilter=this.dateFilter?this.dateFilter:{start:e.start,end:e.end},r.initDateRangePicker(this.dateFilter.start,this.dateFilter.end,(function(e,n,a){t.dateFilter={start:e,end:n},t.pageNum=0,t.getData()}),"admin"),t.pageNum=0,t.totalRowCount=0,this.getData(),s.initTooltips(this.$el)}else this.$el.html(new l.default({screenshotUrl:"/img/TeacherReports_Feedback.png",showSampleBanner:!0}).render().$el)},getData:function(){if(0!==this.pageNum&&this.data[this.pageNum])this.renderCurrentPage();else{var e=this;this.data=this.data||{},o.GetGradingFeedback({teacherUserId:this.teacherUserId,startDate:this.dateFilter.start.toISOString(),endDate:this.dateFilter.end.toISOString(),pageNum:this.pageNum},(function(t){t?(e.data[e.pageNum]=t.responseData,0===e.pageNum?(e.totalRowCount=t.totalRowCount,e.numOfPages=Math.ceil(t.totalRowCount/alcfg.feedbackDataPageSize),e.renderView()):e.renderCurrentPage()):s.bootstrap.alert({message:t||"Something went wrong. Please try again.",alert:"danger"})}))}},gotoPage:function(e){this.pageNum=e.pageNumber,this.getData()},renderCurrentPage:function(){var e=this.$el.find("#pagination");this.addViewInReaderLinkToData(this.data[this.pageNum]),this.$el.find(".dateRangeTableContainer").html(this.gradingFeedbackTemplate({responseData:this.data[this.pageNum],grades:alcfg.grades.list,showOnlyLatestResponseStats:!1})),i.mountReactComponent(d.default,e[0],{currentPage:this.pageNum,currentPageItemsCount:this.data[this.pageNum].length,itemsPerPage:alcfg.feedbackDataPageSize,totalItems:this.totalRowCount,showTotalRecordsCount:!0,pageChangeCallback:this.gotoPage,parentComponentReference:this})},renderView:function(){if(0===this.data[0].length){var e="professional_learning"===this.mainView?'<div class="ctaInfo">You did not comment on any responses in this date range.</div>':'<div class="ctaInfo">This teacher did not comment on any responses in this date range.</div>';this.$el.find(".dateRangeTableContainer").html(e),this.$el.find("#pagination").empty()}else this.renderCurrentPage();s.initHelpPopover(this.$el)},addViewInReaderLinkToData:function(e){sCH.userM.get("Role");a.each(e,(function(e){a.each(e.Responses,(function(t){t.viewInReaderLink="#teacher/reader/authoring/preview/"+e.LayerId+"/notes/?questionTagId="+e.QuestionTagId+"&sectionId="+e.TextSectionId+"&showAuthoringActions=false"}))}))},destroy:function(){this.$el.removeClass("teacherGradingFeeback"),$(".daterangepicker").remove()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",responseData.length>0?(__p+="\r\n    ",_.each(responseData,(function(e){if(__p+='\r\n        <div class="questionContainer ',print("Question"===e.TagType?"":"noteTagContainer "+e.Color),__p+='">\r\n            <table>\r\n                ',"Question"===e.TagType){if(__p+='\r\n                    <tr>\r\n                        <td style="width:24px;"><span class="icon-question no-hover"></span></td>\r\n                        <td>\r\n                            <div class="questionText">'+(null==(__t=cH.sanitize(e.SourceText))?"":__t)+'</div>\r\n                            <div class="title">'+(null==(__t=cH.sanitize(e.AssignmentTitle))?"":__t)+'</div>\r\n                        </td>\r\n                        <td rowspan="2" class="meta">\r\n                            ',showOnlyLatestResponseStats){__p+="\r\n                                ";var t=e.Responses[e.Responses.length-1];__p+="\r\n                                ",t.IsReset||null===t.Grade||(__p+="\r\n                                    ",e.IsCurrentTeacherAssignment?__p+='\r\n                                        <a title="View in text"\r\n                                            href="#teacher/reader/grading/'+(null==(__t=e.AssignmentId)?"":__t)+"/grading/?question="+(null==(__t=e.TagId)?"":__t)+'"\r\n                                            target="_blank"\r\n                                            class="grade '+(null==(__t=grades[t.Grade].id)?"":__t)+' btn-box">\r\n                                                '+(null==(__t=cH.sanitize(grades[t.Grade].label))?"":__t)+"\r\n                                        </a>\r\n                                    ":__p+='\r\n                                        <span class="grade '+(null==(__t=grades[t.Grade].id)?"":__t)+'">\r\n                                            '+(null==(__t=cH.sanitize(grades[t.Grade].label))?"":__t)+"\r\n                                        </span>\r\n                                    ",__p+="\r\n                                "),__p+='\r\n                                <div class="answerDate">'+(null==(__t=e.MaxResponseDate?moment.utc(e.MaxResponseDate).local().format("MM-DD-YY"):"")?"":__t)+"</div>\r\n                            "}__p+='\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2">\r\n                            <div class="responses">\r\n                                ',_.each(e.Responses,(function(e,t){__p+='\r\n                                    <div class="responseContainer '+(null==(__t=e.IsReset?"":"margin")?"":__t)+'">\r\n                                        <div>\r\n                                            ',showOnlyLatestResponseStats?__p+='\r\n                                                <span class="heading">Response #'+(null==(__t=t+1)?"":__t)+": </span>\r\n                                            ":(__p+='\r\n                                                <span class="heading">Response #'+(null==(__t=t+1)?"":__t)+"\r\n                                                    ",print(e.Grade?" ("+cH.sanitize(grades[e.Grade].label)+")":""),__p+=':\r\n                                                </span>\r\n                                                \x3c!--TODO: create grading preview view\r\n                                                <a title="View in text" class="btn-box btnViewInReader"\r\n                                                   href="'+(null==(__t=e.viewInReaderLink)?"":__t)+'"\r\n                                                   target="_blank">View in text</a>--\x3e\r\n                                            '),__p+='\r\n                                        </div>\r\n                                        <div class="text">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(e.AnswerText)))?"":__t)+"</div>\r\n                                        ",e.TeacherComment&&(__p+='\r\n                                            <div class="clearBoth" style="height: 10px;"></div>\r\n                                            <span class="heading">Teacher comment:</span>\r\n                                            <div class="teacherComment">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(e.TeacherComment)))?"":__t)+"\r\n                                            </div>\r\n                                        "),__p+="\r\n                                    </div>\r\n                                "})),__p+="\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                "}else __p+='\r\n                    <tr>\r\n                        <td style="width:24px;"><span class="icon-notes no-hover"></span></td>\r\n                        <td>\r\n                            <div class="questionText">'+(null==(__t=cH.sanitize(e.SourceText))?"":__t)+"</div>\r\n                            ",e.IsResearch&&(__p+='\r\n                                <ul class="bubbleList"><li>Research</li></ul>\r\n                            '),__p+='\r\n                            <div class="title">'+(null==(__t=cH.sanitize(e.AssignmentTitle))?"":__t)+'</div>\r\n                        </td>\r\n                        <td rowspan="2" class="meta">\r\n                            <span class="notesTag '+(null==(__t=e.Color)?"":__t)+'">'+(null==(__t=cH.sanitize(e.Category))?"":__t)+'</span>\r\n                            <div class="answerDate">'+(null==(__t=e.MaxResponseDate?moment.utc(e.MaxResponseDate).local().format("MM-DD-YY"):"")?"":__t)+'</div>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2">\r\n                            <div class="responses">\r\n                                <div class="responseContainer">\r\n                                    <div>\r\n                                        <span class="heading">Note: </span>\r\n                                    </div>\r\n                                    <div class="text">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(e.Text)))?"":__t)+"</div>\r\n                                </div>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                ";__p+="\r\n            </table>\r\n        </div>\r\n    "}))):__p+="\r\n    <div class='ctaInfo'>No Data</div>\r\n",__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(5),i=n(65),o=function(e){return{width:s.percent(e)}};t.default=function(e){var t=e.zeroRatio,n=e.incompleteRatio,r=e.basicRatio,l=e.proficientRatio,d=e.advancedRatio,c=e.toolTipText;return a.createElement("div",{className:"gradePercentageBar"},a.createElement("span",{className:"percentLabelContainer",style:o(l+d)},c?a.createElement(i.default,{title:c},a.createElement("span",{className:"percentLabel"},s.percent(l+d))):a.createElement("span",{className:"percentLabel"},s.percent(l+d))),a.createElement("span",{className:"fraction advanced",style:o(d)}),a.createElement("span",{className:"fraction proficient",style:o(l)}),a.createElement("span",{className:"fraction basic",style:o(r)}),a.createElement("span",{className:"fraction incomplete",style:o(n)}),a.createElement("span",{className:"fraction zero",style:o(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1377);t.default=Backbone.View.extend({joinStudentModeClassOptionsTemplate:n(1379),joinNativeClassTemplate:n(1380),initialize:function(e){this.inTextView=e&&!0===e.inTextView,this.on("initialized",this.modalInitialized),this.on("ok",this.joinClass)},events:{"click .btnMyClass":"joinMyClass","click .btnNativeClass":"renderJoinNativeClass"},modalInitialized:function(e){this.modal=e},render:function(){sCH.userM.get("IsMappedToTeacher")?(this.$el.html(this.joinStudentModeClassOptionsTemplate()),this.modal.$el.find(".ok").hide()):this.renderJoinNativeClass(),a.initTooltips(this.$el)},renderJoinNativeClass:function(){this.$el.html(this.joinNativeClassTemplate({isMappedToTeacher:sCH.userM.get("IsMappedToTeacher")})),this.modal.$el.find(".ok").show()},joinClass:function(e){e.preventClose();var t=$.trim(this.$el.find(".txtClassCode").val()),n=this,s="";if(""===t?s="Enter a class code!":t.length>8?s="This class code is too long!":t.match(/^[a-z0-9]+$/i)||(s="You've entered an invalid class code. Please double check the code your teacher gave you and try again."),""===s){var i={classCode:t};e.disableOk("Joining..."),this.inTextView&&(i.checkAssignment=!0,i.assignmentId=sCH.readerConfig.assignmentId),sCH.classesC.joinClass(i,(function(t){t&&t.ClassId?(e.close(),n.inTextView?Backbone.history.loadUrl(Backbone.history.fragment):(window.setTimeout((function(){a.bootstrap.alert({message:"You've joined "+a.sanitize(t.Name)+"."})}),100),a.redirectUserByHash(a.getClassUrl(t.ClassId,"assignments")))):(e.enableOk("Join"),a.bootstrap.alert({alert:"danger",message:t.Message,autoClose:!1}))}))}else a.bootstrap.alert({alert:"danger",message:s})},joinMyClass:function(){this.modal.close(),new Backbone.BootstrapModal({title:"Join one of your classes",content:new s.default,okText:"Join",cssClass:"modal-lg modal-al-join-my-classes"})}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({template:n(1403),initialize:function(e){this.on("ok",this.withdrawFromClass),this.obj=e},render:function(){this.$el.html(this.template({userName:sCH.userM.get("Name"),className:this.obj.classM.get("Name")}))},withdrawFromClass:function(e){e.preventClose(),e.disableOk("Unenrolling...");var t=this;"UNENROLL"===this.$el.find(".txtUnenrollCaptcha").val()?sCH.classesC.leaveClass(this.obj.classM.get("ClassId"),(function(n){if(n){var s=t.obj.classM.get("Name");t.obj.classM.destroy(),e.close(),sCH.classesC.length>0?(a.redirectUserByHash(a.getClassUrl(sCH.classesC.first().get("ClassId"),"assignments")),window.setTimeout((function(){a.bootstrap.alert({message:"You unenrolled from "+s+"."})}),1e3)):a.redirectUserByHash("student/classes")}else a.bootstrap.alert({alert:"danger",message:"There was a problem unenrolling you from the class. Please try again."}),e.enableOk("Unenroll")})):(a.bootstrap.alert({alert:"danger",message:'Please type "UNENROLL" to confirm.'}),e.enableOk("Unenroll"))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+=" ",info.isHigherEd||(__p+='\r\n    <select class="ddlGradeLevels">\r\n        <option disabled selected value="">'+(null==(__t=info.defaultOpt?info.defaultOpt:"Select a grade level")?"":__t)+"</option>\r\n        ",info.grouped?(__p+='\r\n            <option value="1">Grades 2-3</option>\r\n            <option value="2">Grades 4-5</option>\r\n            <option value="3">Grades 6-8</option>\r\n            <option value="4">Grades 9-12</option>\r\n            ',info.showHigherEdOption!==undefined&&(__p+='\r\n                <option value="5">Higher Education</option>\r\n            '),__p+="\r\n        "):__p+='\r\n            <option value="2">2nd Grade</option>\r\n            <option value="3">3rd Grade</option>\r\n            <option value="4">4th Grade</option>\r\n            <option value="5">5th Grade</option>\r\n            <option value="6">6th Grade</option>\r\n            <option value="7">7th Grade</option>\r\n            <option value="8">8th Grade</option>\r\n            <option value="9">9th Grade</option>\r\n            <option value="10">10th Grade</option>\r\n            <option value="11">11th Grade</option>\r\n            <option value="12">12th Grade</option>\r\n            <option value="13">Adult Learners</option>\r\n        ',__p+="\r\n    </select>\r\n"),__p+="";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(38),l=n(39),d=n(96),c=n(101),u=n(102),p=n(103),h=n(116),g=n(5),f=n(10),m=n(8),v=n(87),b=(0,n(13).withStyles)((function(e){return{dialogRoot:{maxWidth:635},wrapper:{width:"100%",display:"flex",flexDirection:"column"},dialogContent:{display:"flex",padding:"0 25px",overflow:"hidden","& .info":{fontSize:16,lineHeight:"24px",fontFamily:"AvenirNextLTW02-Medium",marginTop:0,"&.gray":{fontSize:14,color:"rgba(0, 0, 0, 0.54)"}}},dialogTitle:{"& h2":{fontFamily:"Avenir Next LT W02 Demi"}},assignGroupsContainer:{display:"flex",alignItems:"center"},label:{color:"#546E7A",fontFamily:"Avenir Next LT W02 Demi",fontSize:13,textTransform:"uppercase"},groupCountInput:{display:"inline-block !important",width:"50px !important",fontFamily:"AvenirNextLTW02-Medium",backgroundColor:"#FFF",border:"1px solid #B0BEC5",color:"#546E7A",padding:5,margin:0,textAlign:"center"},assignBtn:{fontFamily:"Avenir Next LT W02 Demi",padding:"5px 10px",fontSize:12,color:"#546E7A",backgroundColor:"#FFF",border:"1px solid #B0BEC5",borderRadius:0,marginLeft:25},tableContainer:{overflow:"auto",marginTop:20},tableHeader:{fontFamily:"Avenir Next LT W02 Demi",fontSize:14,cursor:"pointer"},sortButton:{"&:before":{fontSize:14,marginLeft:5,lineHeight:1,verticalAlign:"bottom"}},row:{display:"flex",alignItems:"center",padding:6,"&:nth-child(even)":{background:"#FAFAFA"}},groupSelector:{width:180},groupSelectorRoot:{fontFamily:"AvenirNextLTW02-Medium",fontSize:14,"&.noGroup":{color:"#F50057"}},groupSelectorItem:{fontFamily:"AvenirNextLTW02-Medium",fontSize:14},studentName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"AvenirNextLTW02-Medium",fontSize:14,display:"inline-block",width:388},dialogActions:{display:"block",textAlign:"right",padding:"0 10px"}}})),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={studentList:[],groups:w(t.props),open:!0,saving:!1,isConfirmPopupOpen:!1,GroupIdKey:t.props.assignmentId?"AssignmentGroupId":"ClassGroupId"},t.onStudentGroupChange=function(e){return function(n){var a=t.state.studentList,s=a.find((function(t){return t.UserId===e}));s.Sequence=n.target.value;var i=t.state.groups.find((function(e){return e.Sequence===n.target.value}));s[t.state.GroupIdKey]=i?i[t.state.GroupIdKey]:null,t.setState({studentList:a})}},t.onGroupCountChange=function(){return function(e){var n,a=parseInt(e.target.value,10);if(S(a)){var s=w(t.props);if(s.length>a)s.splice(a);else for(var i=s.length;i<a;i++){var o=i+1;s.push(((n={})[t.state.GroupIdKey]=-1*o,n.GroupName="Group "+o,n.Sequence=o,n))}var r=t.state.studentList;r.map((function(e){s.find((function(t){return t.Sequence===e.Sequence}))||(e.Sequence=0,e[t.state.GroupIdKey]=null)})),t.setState({groups:s,studentList:r})}}},t.sortByGroup=function(e){var n=e.sort((function(e,t){return v(e.Sequence,t.Sequence)}));t.setState({studentList:n})},t.sortByName=function(e){var n=e.sort((function(e,t){return v(e.LastName,t.LastName)||v(e.FirstName,t.FirstName)||v(e.UserId,t.UserId)}));t.setState({studentList:n})},t.assignGroupsRandomly=function(){var e,n=t.state.groups.length;if(S(n)){for(var a=m.shuffle(t.state.studentList),s=a.length,o=[],r=0;r<s;r++){var l=r%n;o.push(i(i({},a[r]),((e={})[t.state.GroupIdKey]=t.state.groups[l][t.state.GroupIdKey],e.Sequence=t.state.groups[l].Sequence,e)))}t.sortByName(o)}},t.onUpdate=function(){for(var e,n=[],a=[],s=0,i=t.state.studentList;s<i.length;s++){var o=i[s];o[t.state.GroupIdKey]&&0!==o[t.state.GroupIdKey]||a.push(o.UserId),n.push(((e={UserId:o.UserId})[t.state.GroupIdKey]=o[t.state.GroupIdKey],e))}if(a.length>0)return g.bootstrap.alert({message:"Each student must be assigned a group.",alert:"danger"}),void t.setState({saving:!0});var r=t.state.groups.map((function(e){return e[t.state.GroupIdKey]}));f.UpdateSmallGroup({studentList:n,groupIds:r,classId:t.props.classId,assignmentId:t.props.assignmentId},(function(e){if(g.bootstrap.alert({message:"Small group settings were updated successfully!"}),!t.props.assignmentId){var n=sCH.classesC.getModelByClassId(t.props.classId);n.set("SmallGroups",e),n.set("IsSmallGroupsEnabled",!0)}t.props.onUpdate(),t.onClose()}))},t.onClose=function(){t.setState({open:!1}),t.props.onClose()},t.openConfirmationPopup=function(){t.setState({isConfirmPopupOpen:!0})},t.closeConfirmationPopup=function(){t.setState({isConfirmPopupOpen:!1})},t.confirmDisableSmallGroup=function(){f.DisableSmallGroup({classId:t.props.classId,assignmentId:t.props.assignmentId},(function(){if(g.bootstrap.alert({message:"Small group settings were disabled successfully!"}),t.onClose(),t.setState({isConfirmPopupOpen:!1}),!t.props.assignmentId){var e=sCH.classesC.getModelByClassId(t.props.classId);e.set("SmallGroups",null),e.set("IsSmallGroupsEnabled",!1)}t.props.onUpdate()}))},t}return s(t,e),t.prototype.componentWillMount=function(){this.sortByName(this.props.studentList)},t.prototype.render=function(){var e=this,t=this.props.classes,n=this.state.groups.length;return o.createElement(c.default,{open:this.state.open,maxWidth:"md",classes:{paper:t.dialogRoot}},o.createElement(h.default,{classes:{root:t.dialogTitle}},"Manage small groups ",this.props.assignmentId?" for this assignment":""),o.createElement(p.default,{className:t.dialogContent},o.createElement("div",{className:t.wrapper},o.createElement("p",{className:"info"},alcfg.infoText.classes.smallGroups," ",o.createElement("a",{className:"infoLink",href:alcfg.helpArticleLink.smallGroups},"Learn more"),"."),this.props.assignmentId&&o.createElement("p",{className:"info gray"},"Note: Changing a student's group will hide their replies to notes in their previous group."),this.state.studentList.length>0&&o.createElement("div",{className:t.assignGroupsContainer},o.createElement("div",null,o.createElement("label",{className:t.label},"Number of groups"),o.createElement("input",{type:"number",className:t.groupCountInput,min:"2",defaultValue:n,onChange:this.onGroupCountChange(),autoFocus:!1})),o.createElement(r.default,{onClick:this.assignGroupsRandomly,className:t.assignBtn},"Assign groups randomly")),o.createElement("div",{className:t.tableContainer},this.state.studentList.length>0?o.createElement("ul",null,o.createElement("li",{className:t.row},o.createElement("div",{className:t.tableHeader,style:{width:388},onClick:function(){return e.sortByName(e.state.studentList)}},"Name",o.createElement("a",{className:[t.sortButton,"icon-arrowdown"].join(" ")})),o.createElement("div",{className:t.tableHeader,style:{width:180},onClick:function(){return e.sortByGroup(e.state.studentList)}},"Group",o.createElement("a",{className:[t.sortButton,"icon-arrowdown"].join(" ")}))),this.state.studentList.map((function(n){return o.createElement("li",{className:t.row,key:n.UserId},o.createElement("div",{className:t.studentName},g.sanitize(n.LastName)+(n.LastName?", ":"")+g.sanitize(n.FirstName)),o.createElement(y,{groups:e.state.groups,groupIdKey:e.state.GroupIdKey,groupSequence:n.Sequence,studentUserId:n.UserId,classes:t,onChange:e.onStudentGroupChange,isSaving:e.state.saving}))}))):o.createElement("div",{className:"ctaInfo"},"No students")))),o.createElement(u.default,{className:t.dialogActions},this.props.isGroupEnabled&&o.createElement(r.default,{onClick:this.openConfirmationPopup,className:["btn","btn-primary","pull-left"].join(" "),color:"primary"},"Disable Small Groups"),o.createElement(r.default,{onClick:this.onClose,className:["btn","btn-primary"].join(" "),color:"primary"},"Cancel"),this.state.studentList.length>0&&o.createElement(r.default,{onClick:this.onUpdate,className:["btn","btn-primary"].join(" "),color:"primary"},"Save ",this.props.isGroupEnabled?"":" and enable")),o.createElement(_,{isConfirmPopupOpen:this.state.isConfirmPopupOpen,closeConfirmationPopup:this.closeConfirmationPopup,confirmDisableSmallGroup:this.confirmDisableSmallGroup,classes:this.props.classes}))},t}(o.Component);t.default=b(C);var y=function(e){var t=e.classes,n=e.groups,a=e.groupSequence,s=e.studentUserId,i=e.isSaving,r=e.groupIdKey;return o.createElement("div",{className:t.groupSelector},o.createElement(d.default,{value:a||0,onChange:e.onChange(s),inputProps:{classes:{root:t.groupSelectorRoot+(i&&!a?" noGroup":"")}}},o.createElement(l.default,{key:"0",value:0,className:t.groupSelectorItem},"Select a group"),n.map((function(e){return o.createElement(l.default,{key:e[r],value:e.Sequence,className:t.groupSelectorItem},e.GroupName)}))))},_=function(e){return o.createElement(c.default,{maxWidth:"md",open:e.isConfirmPopupOpen},o.createElement(h.default,{classes:{root:e.classes.dialogTitle}},"Disable small groups?"),o.createElement(p.default,{className:e.classes.dialogContent},o.createElement("p",{className:"info"},"Are you sure you want to disable small groups?")),o.createElement(u.default,null,o.createElement(r.default,{onClick:e.closeConfirmationPopup,className:["btn","btn-primary"].join(" "),color:"primary"},"Cancel"),o.createElement(r.default,{onClick:e.confirmDisableSmallGroup,className:["btn","btn-primary"].join(" "),color:"primary"},"Disable")))},S=function(e){return!(!e||isNaN(e)||e<2)||(g.bootstrap.alert({message:"You must have at least 2 groups!",alert:"danger"}),!1)},w=function(e){var t=e.assignmentId?"AssignmentGroupId":"ClassGroupId";return m.sortBy(e.existingGroups&&e.existingGroups.length>0?e.existingGroups.map((function(e,n){var a;return(a={})[t]=e[t]||-1*e.Sequence,a.GroupName="Group "+e.Sequence,a.Sequence=e.Sequence,a})):alcfg.defaultClassGroups.map((function(e,n){var a;return(a={})[t]=-1*(n+1),a.GroupName=e,a.Sequence=n+1,a})),"Sequence")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(5);t.default=function(e){var t,n=e.avatar;return n&&((t=n.charAt(0).toLowerCase()).match(/[a-z]/i)||(t="a")),n?n.length>2?a.createElement("img",{className:"image avatar",src:s.sanitize(n),alt:""}):a.createElement("span",{className:"avatar initial_"+t,"aria-hidden":"true"},n):a.createElement("span",{className:"avatar initial_a","aria-hidden":"true"},"aa")}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(497),i=n(349),o=n(24);function r(e){e[google.picker.Response.ACTION]==google.picker.Action.PICKED?(window.addGoogleDoc.docId=e[google.picker.Response.DOCUMENTS][0].id,window.addGoogleDoc.title=e[google.picker.Response.DOCUMENTS][0].name,"application/pdf"===e[google.picker.Response.DOCUMENTS][0].mimeType?gapi.client.request({path:"/drive/v2/files/"+window.addGoogleDoc.docId,method:"GET",params:{fields:"downloadUrl"}}).execute((function(e){window.addGoogleDoc.downloadUrl=e.downloadUrl,o.showModal(a.createElement(s.default,{title:"Update information for tile",source:"googleDoc",numOfBYOCInMonth:window.addGoogleDoc.numOfBYOCInMonth,classId:window.addGoogleDoc.classId,okText:"Done",cssClass:"uploadText"}))})):o.showModal(a.createElement(i.default,{title:"Update information for tile",mode:"student"===sCH.userM.get("Role")?"research":"googledoc",numOfBYOCInMonth:window.addGoogleDoc.numOfBYOCInMonth,classId:window.addGoogleDoc.classId,okText:"Add Text"}))):e[google.picker.Response.ACTION]==google.picker.Action.CANCEL&&delete window.addGoogleDoc}t.default=function(){if(window.addGoogleDoc.pickerApiLoaded&&window.addGoogleDoc.oauthToken){var e=new google.picker.View(google.picker.ViewId.DOCUMENTS).setMimeTypes("application/vnd.google-apps.document"),t=new google.picker.View(google.picker.ViewId.PDFS),n=new google.picker.DocsView(google.picker.ViewId.DOCUMENTS).setMimeTypes("application/vnd.google-apps.document").setEnableTeamDrives(!0).setIncludeFolders(!0);(new google.picker.PickerBuilder).addView(e).addView(t).addView(n).enableFeature(google.picker.Feature.SUPPORT_TEAM_DRIVES).setOAuthToken(window.addGoogleDoc.oauthToken).setDeveloperKey(alcfg.googleApiDeveloperKey).setCallback(r).setOrigin(window.location.protocol+"//"+window.location.host).build().setVisible(!0)}else window.addGoogleDoc.fail()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(20);t.init=function(e){window.addGoogleDoc=this,window.addGoogleDoc.callback=e,window.addGoogleDoc.scopes=["https://www.googleapis.com/auth/drive.readonly"],window.addGoogleDoc.pickerApiLoaded=!1,window.addGoogleDoc.oauthToken,gapi.load("auth",{callback:window.addGoogleDoc.onAuthApiLoad}),gapi.load("picker",{callback:window.addGoogleDoc.onPickerApiLoad})},t.onAuthApiLoad=function(){var e=sCH.userM.get("Accounts").google;gapi.auth.authorize({client_id:s.default.googleApiClientId,scope:window.addGoogleDoc.scopes,immediate:!!e,authuser:-1,user_id:e?e.ExternalUserId:null},window.addGoogleDoc.checkAuthResult)},t.onPickerApiLoad=function(){window.addGoogleDoc.pickerApiLoaded=!0},t.checkAuthResult=function(e){e&&!e.error&&(window.addGoogleDoc.oauthToken=e.access_token,window.addGoogleDoc.callback&&window.addGoogleDoc.callback())},t.handleAuthResult=function(e){e&&!e.error?(window.addGoogleDoc.oauthToken=e.access_token,window.addGoogleDoc.callback()):window.addGoogleDoc.authFail(e)},t.authFail=function(e){"idpiframe_initialization_failed"===e.error?a.bootstrap.alert({message:"Due to the latest updates from Chrome, you need to enable 3rd party cookies for Actively Learn.<br/>In a new tab, go to         <b>chrome://settings/content/cookies</b>, unblock 3rd party cookies and then refresh this page.",alert:"danger",autoClose:!1}):a.bootstrap.alert({message:"This account is not connected to Google Docs.",alert:"danger"}),rg4js("send",{error:new Error("Google Docs Auth"),customData:e})},t.fail=function(e){a.bootstrap.alert({message:"There was an error connecting to Google Docs.",alert:"danger"}),rg4js("send",{error:new Error("Google Docs NonAuth"),customData:e})}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){var t=e.message,n=e.screenshotUrl,s=void 0===n?null:n,i=a.createElement("div",{className:"ctaInfo"},t);return s?a.createElement("div",{className:"tileView"},i,a.createElement("div",{className:"trialSplash"},a.createElement("section",{className:"screenshot"},a.createElement("img",{src:s}),a.createElement("div",{className:"sampleText"},"Sample")))):i}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(0),l=n(10),d=n(14),c=n(48),u=n(1480),p=n(1481),h=n(1482),g=n(5),f=n(1483),m=n(24),v=n(87),b=n(1484).Treebeard,C=function(e,t,n,a){a=void 0!==a?a:[],n=void 0!==n?n:e;var s=o.filter(t,{FolderParentId:n.FolderId});return o.isEmpty(s)||(n.FolderId===e.FolderId?a=s:n.children=s,s.forEach((function(n){C(e,t,n)}))),i(i({},n),{children:a})},y=function(e,t,n){var a=o.filter(e,{FolderParentId:t.FolderId});if(!(a.length>0))return n;a.forEach((function(t){n.push(t.FolderId),y(e,t,n)}))},_={Container:function(e){var t=e.node,n=e.onClick,a=e.onToggle,s=e.customProps;return s.canManage?r.createElement(h.default,{data:t,onClick:n,onToggle:a,rootFolderId:s.rootFolderId,customProps:s}):r.createElement(p.default,{data:t,onClick:n,onToggle:a,rootFolderId:s.rootFolderId,customProps:s})}},S=function(e){function t(t){var n=e.call(this,t)||this;n.customProps={},n.shouldAutoCollapseFolders=g.onDevice(),n.collapse=function(){n.setState({isCollapsed:!0}),document.body.style.overflow=""},n.expand=function(){n.state.isCollapsed&&(n.setState({isCollapsed:!1}),document.body.style.overflow="hidden")};var a=n.props.folders[0],s=[C(a,n.sortFolders(n.props.folders))];return n.state={folders:n.props.folders,structuredFolders:s,isCollapsed:n.shouldAutoCollapseFolders},n.updateFolderState=n.updateFolderState.bind(n),n.updateFolderAuthors=n.updateFolderAuthors.bind(n),n.onClick=n.onClick.bind(n),n.onToggle=n.onToggle.bind(n),n.makeInactive=n.makeInactive.bind(n),Backbone.pubEv.on("makeSelectedFolderInactive",n.makeInactive),Backbone.pubEv.on("FolderAuthorsUpdated",n.updateFolderAuthors),n.customProps=i({onFolderAdded:n.onFolderAdded.bind(n),onFolderEdited:n.onFolderEdited.bind(n),onFolderDeleted:n.onFolderDeleted.bind(n),onFolderMoved:n.onFolderMoved.bind(n),openFolderCoauthorPopup:n.openFolderCoauthorPopup.bind(n)},n.props.customProps),n}return s(t,e),t.prototype.componentDidMount=function(){g.adjustFolderContainerHeight()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("FolderAuthorsUpdated"),Backbone.pubEv.off("makeSelectedFolderInactive"),document.body.style.overflow=""},t.prototype.componentDidUpdate=function(e){o.isEqual(e,this.props)||this.updateFolderState(this.props.folders),g.adjustFolderContainerHeight()},t.prototype.updateFolderState=function(e){this.setState({folders:e,structuredFolders:[C(e[0],this.sortFolders(e))]})},t.prototype.updateFolderAuthors=function(e){var t=this.state.folders;for(var n in e)if(e[n]){var a=o.find(t,{FolderId:parseInt(n,10)});if(a)o.find(e[n],{UserId:sCH.userM.get("UserId")})||(t=o.reject(t,{FolderId:parseInt(n,10)})),a.coauthors=e[n],this.updateFolderState(t)}},t.prototype.sortFolders=function(e){return o.merge([],e).sort((function(e,t){return v(e.Title.toLowerCase(),t.Title.toLowerCase())}))},t.prototype.onFolderAdded=function(){var e=this,t=this.state.folders,n=o.find(t,{FolderId:this.props.selectedFolderId}),a=this.props.selectedFolderId;n||(a=t[0].FolderId,n=o.find(t,{FolderId:t[0].FolderId})),m.showModal(r.createElement(f.default,{title:"Add new folder",okText:"Add",activeFolderName:n.Title,okCallback:function(s){var i={folderParentId:a,title:s};l.AddFolder(e.props.page===d.Page.LIBRARY,i,(function(a){a.folderId&&(t.push({FolderParentId:i.folderParentId,Title:i.title,Type:e.props.page===d.Page.WORKSPACE?"workspace":"library",FolderId:a.folderId,coauthors:a.coauthors,HasFolderWriteAccess:!0}),n.toggled=!0,e.updateFolderState(t)),m.hideModals()}))}}))},t.prototype.onFolderEdited=function(e){var t=this,n=this.state.folders,a=o.find(n,{FolderId:e}),s=this.props.page===d.Page.WORKSPACE&&a.HasFolderWriteAccess||this.props.page===d.Page.LIBRARY&&sCH.userM.hasManageLibraryPermissions();m.showModal(r.createElement(f.default,{title:"Edit folder",folderName:a.Title,okText:"Save",cssClass:"modal-al-edit-folder",canDelete:s,onFolderDeleted:function(){return t.onFolderDeleted(e)},okCallback:function(s){l.EditFolderName(t.props.page===d.Page.LIBRARY,{folderId:e,newTitle:s},(function(e){e&&(a.Title=s,t.updateFolderState(n),m.hideModals())}))}}))},t.prototype.onFolderDeleted=function(e){var t=this,n=o.filter(this.state.folders,{FolderParentId:e}).length;if(n>0){var a=g.plural(n,"%count folder","%count folders");m.showModal(r.createElement(w,{contains:a}))}else{var s=o.find(this.state.folders,{FolderId:e}),i=o.reject(this.state.folders,{FolderId:e});l.DeleteFolder(this.props.page===d.Page.LIBRARY,{folderId:e},(function(n){if(n.numLayers>0){var a=g.plural(n.numLayers,"%count assignment","%count assignments");m.showModal(r.createElement(w,{contains:a}))}else{if(t.collapseOldParent(s.FolderParentId,i),e===t.props.selectedFolderId){var l=t.props.folders[0].FolderId;o.find(t.state.folders,{FolderId:l}).active=!0,t.customProps.onFolderSelected(l,t.props.page)}m.hideModals(),t.updateFolderState(i),t.props.page===d.Page.LIBRARY?Backbone.pubEv.trigger("libraryFolderRemoved",e):t.props.page===d.Page.WORKSPACE&&Backbone.pubEv.trigger("workspaceFolderRemoved",e)}}))}},t.prototype.onFolderMoved=function(e,t){var n=this,a=this.state.folders,s=o.find(a,{FolderId:e}),i=[];if(y(a,s,i),o.includes(i,t))return!1;var r=s.FolderParentId;return s.FolderParentId=t,l.MoveFolder(this.props.page===d.Page.LIBRARY,{folderId:e,newFolderParentId:t},(function(e){n.collapseOldParent(r,a),o.find(a,{FolderId:t}).toggled=!0,n.updateFolderState(a)})),!0},t.prototype.openFolderCoauthorPopup=function(e){if(sCH.userM.isOnFreeOrPersonalPlan())c.showBuyTeacherPopup({title:"Co-author folder with colleagues"});else{var t=o.find(this.state.folders,{FolderId:e});m.showModal(r.createElement(u.default,{title:"Co-author "+t.Title+" with colleagues",okText:"Add",folderId:e,allowCancel:!1,cssClass:"coauthors"}))}},t.prototype.onClick=function(e,t){e.stopPropagation();var n=this.state.folders;if(this.props.selectedFolderId){var a=o.find(n,{FolderId:this.props.selectedFolderId});a&&(a.active=!1)}var s=o.find(n,{FolderId:t.FolderId}),i=t.children?t.children.length:0;s.active=!0,this.updateFolderState(n),this.customProps.onFolderSelected(t.FolderId,this.props.page,i),this.onToggle(t,!0)},t.prototype.onToggle=function(e,t){var n=this.state.folders;e.children&&(o.find(n,{FolderId:e.FolderId}).toggled=t);this.updateFolderState(n)},t.prototype.collapseOldParent=function(e,t){var n=o.find(t,{FolderId:e});0===o.filter(t,{FolderParentId:n.FolderId}).length&&(n.toggled=!1)},t.prototype.makeInactive=function(){var e=this.state.folders;if(this.props.selectedFolderId){var t=o.find(e,{FolderId:this.props.selectedFolderId});t&&(t.active=!1)}this.updateFolderState(e)},t.prototype.render=function(){var e=this,t=g.classNames({folderContainer:!0,myFolders:!0,collapsed:this.state.isCollapsed,shouldAutoCollapseFolders:this.shouldAutoCollapseFolders});return r.createElement("div",{className:t,onClick:this.expand},this.shouldAutoCollapseFolders&&r.createElement(r.Fragment,null,r.createElement("button",{className:"icon-cancel btnCollapseFolders",onClick:this.collapse}),r.createElement("div",{className:"invisibleContainer",onClick:this.collapse})),this.props.showHandyTabs&&r.createElement("ul",{className:"handyTabs"},r.createElement("li",{onClick:function(){return e.props.renderFolderFilter("everything")},className:"everything"===this.props.selectedFolderFilter?"selected":""},r.createElement("a",{className:"icon-everythingfolder"}),r.createElement("span",{className:"label"},"My Workspace")),!1,r.createElement("li",{onClick:function(){return e.props.renderFolderFilter("shared")},className:"shared"===this.props.selectedFolderFilter?"selected":""},r.createElement("a",{className:"icon-people"}),r.createElement("span",{className:"label"},"Shared")),r.createElement("li",{onClick:function(){return e.props.renderFolderFilter("savedforlater")},className:"savedforlater"===this.props.selectedFolderFilter?"selected":""},r.createElement("a",{className:"icon-star-filled"}),r.createElement("span",{className:"label"},"Starred"))),r.createElement(b,{data:this.state.structuredFolders,onToggle:this.onToggle,onClick:this.onClick,decorators:_,customProps:i(i({},this.customProps),{canManage:this.props.canManage})}))},t}(r.Component);function w(e){var t=e.contains;return r.createElement(m.default,{okText:null,cancelText:"OK",title:"Cannot delete folder"},r.createElement("p",null,"Uh oh! This folder cannot be deleted. It contains ",t,"."))}t.default=S},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10),i=n(43),o='","',r='"\r\n"';String.prototype.toProperCase=function(){return this.toLowerCase().replace(/(^[a-z]| [a-z]|-[a-z])/g,(function(e){return e.toUpperCase()}))},t.exportTableToCSV=function(e,t,n){var a=e.find("tr:has(th)"),s=e.find("tr:has(td)"),i=String.fromCharCode(11),l=String.fromCharCode(0),d='"';function c(e){return e.get().join(l).split(l).join(r).split(i).join(o)}function u(e,t){var n=$(t),a=n.find("td");return a.length||(a=n.find("th")),a.map(p).get().join(i)}function p(e,t){var n=$(t),a=void 0!==n.data("formattedexporttext")&&null!==n.data("formattedexporttext")?n.data("formattedexporttext").toString():null,s=null!==a?a:n.text();if(!n.data("exportastext")){var i=n.children();i.length>0&&(s=n.find(i.get(0).tagName).html())}return(a?"":" ")+s.replace(/<br\s?>/," ").replace('"','""').trim()}d+=c(a.map(u)),d+=r,d+=c(s.map(u))+'"',this.exportCSV(d,t,n)},t.exportCSV=function(e,n,s){var o="data:application/csv;charset=utf-8,"+encodeURIComponent(e);if(!a.onDevice()&&i.safari)t.safariCsvEmailExport(e,n,s);else if(window.navigator.msSaveBlob)window.navigator.msSaveOrOpenBlob(new Blob([e],{type:"text/plain;charset=utf-8;"}),n+".csv");else{var r=document.createElement("a");r.setAttribute("href",o),r.setAttribute("download",n+".csv"),r.style.cssText="visibility:hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},t.safariCsvEmailExport=function(e,t,n){s.EmailCsvReport({csvData:e,fileName:t,subject:a.getProductName()+" - "+n.toProperCase(),title:n},(function(e){e?a.bootstrap.alert({message:"The "+n.toLowerCase()+" has been sent to you via email. Please make sure you can receive emails from support@activelylearn.com."}):a.bootstrap.alert({message:alcfg.errorTexts.connection.error.nonblocking,alert:"danger"})}))}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(5);t.Grade=function(e){var t=e.assignmentId?"#teacher/reader/grading/"+e.assignmentId+"/grading/?student="+e.studentUserId:"",n=e.pointsEarned,l=e.pointsPossible,d=l>0?i.percent(n/l):null,c=l>0?e.percentageOnTop?s.createElement("div",null,s.createElement(r,{gradePercent:d}),s.createElement("br",null),s.createElement(o,a({},e))):s.createElement("div",null,s.createElement(o,a({},e)),s.createElement("br",null),s.createElement(r,{gradePercent:d})):s.createElement("span",null,"-");return e.assignmentId?s.createElement("a",{onClick:function(){return i.openReaderUrl(t)}},c):c};var o=function(e){return s.createElement("span",null,e.pointsEarned%1==0?e.pointsEarned:e.pointsEarned.toFixed(1),"/",e.pointsPossible%1==0?e.pointsPossible:e.pointsPossible.toFixed(1))},r=function(e){return s.createElement("span",{className:"percent cellInfo"},e.gradePercent)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(5);t.exportTableForm=function(e,t){var n=(t+"_"+moment().format("MMDDYYYY")).replaceAll(" ","_");return a.createElement("form",{className:"exportTableWrapper displayNone",method:"post",action:s.getHostName(alcfg.node.class_gradebook.export)+alcfg.node.class_gradebook.export},e.map((function(e,t){return a.createElement("input",{type:"hidden",key:t,name:"csvRows[]",value:e})})),a.createElement("input",{type:"hidden",name:"fileName",value:n}),a.createElement("input",{type:"submit",value:"Submit"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8);t.headers={name:"Student",readingTime:"Learning Time",questionCompleted:"Questions Completed",revisionCount:"Number of Answer Revisions",totalPoints:"Total Points",vocabLookups:"Vocab Lookups",notes:"Notes (Total/shared)",totalWordsWritten:"Total Words Written",viewPeerResponses:"View Peer Responses",translationLookups:"Translation Lookups",tts:"Text to Speech Requests",numIRTextsRead:"Independent Reading Texts Read",irReadingTime:"Independent Texts Learning Time",researchTextAdded:"Research Texts Added"},t.getActivityDataByAssignment=function(e){var t=[],n={totalAnswers:0,totalReadingTime:0,totalVocabLookups:0,totalNotes:0,totalWords:0,totalIRReadingTime:0,totalIRTextsCount:0,totalRevisions:0,totalResearchTextsCount:0,totalTTSCount:0,totalTranslationLookups:0};return s.each(e,(function(e){var a={};t.push({name:e.name,data:a,userId:e.userId}),a.responseData={answers:0,noRespAnswers:0,pointsSum:0,pointsMax:0,wordCount:0},s.each(e.data.responseData,(function(e){a.responseData.answers+=e.answers,a.responseData.noRespAnswers+=e.noRespAnswers,a.responseData.pointsSum+=e.pointsSum,a.responseData.pointsMax+=e.pointsMax,a.responseData.wordCount+=e.wordCount})),n.totalAnswers+=a.responseData.answers,a.revisionData={revisionCount:e.data.revisionData?e.data.revisionData.ResponseRevisedCount:0},n.totalRevisions+=a.revisionData.revisionCount,a.readingTimeData={time:s.sumBy(e.data.readingTimeData,"time")},n.totalReadingTime+=a.readingTimeData.time,a.vocabLookupsData={lookupCount:s.sumBy(e.data.vocabLookupsData,"lookupCount")},n.totalVocabLookups+=a.vocabLookupsData.lookupCount,a.peerResponseLookupsData={lookupCount:s.sumBy(e.data.peerResponseLookupsData,"lookupCount")},a.notesData={count:0,publicCount:0,wordCount:0},s.each(e.data.notesData,(function(e){a.notesData.count+=e.count,a.notesData.publicCount+=e.publicCount,a.notesData.wordCount+=e.wordCount})),a.translationLookupCount=e.data.translationData.length,a.ttsCount=e.data.ttsData.length,a.irData=e.data.irData?{textCount:e.data.irData.NumOfTexts,readingTime:e.data.irData.ReadingTime}:{textCount:0,readingTime:0},a.researchTextCount=e.data.researchData.length,n.totalNotes+=a.notesData.count,n.totalWords+=a.notesData.wordCount+a.responseData.wordCount,n.totalIRReadingTime+=a.irData.readingTime,n.totalIRTextsCount+=a.irData.textCount,n.totalResearchTextsCount+=a.researchTextCount,n.totalTranslationLookups+=a.translationLookupCount,n.totalTTSCount+=a.ttsCount})),{studentsData:t,classTotals:n}},t.getClassTotalRowData=function(e,t){return{name:"Class Total",readingTime:t?a.convertSecondsToDecimalHours(e.totalReadingTime||0):a.getFormattedTime(e.totalReadingTime||0,!1),questionCompleted:e.totalAnswers,revisionCount:e.totalRevisions,totalPoints:"",vocabLookups:e.totalVocabLookups,notes:e.totalNotes,totalWordsWritten:e.totalWords,viewPeerResponses:"",translationLookups:e.totalTranslationLookups,tts:e.totalTTSCount,numIRTextsRead:e.totalIRTextsCount,irReadingTime:t?a.convertSecondsToDecimalHours(e.totalIRReadingTime):a.getFormattedTime(e.totalIRReadingTime,!1),researchTextAdded:e.totalResearchTextsCount}},t.getClassAverageRowData=function(e,t,n){return{name:"Class Average",readingTime:n?a.convertSecondsToDecimalHours(e.totalReadingTime/t):a.getFormattedTime(e.totalReadingTime/t,!1),questionCompleted:parseInt((e.totalAnswers/t).toString(),10).toLocaleString(),revisionCount:parseInt((e.totalRevisions/t).toString(),10).toLocaleString(),totalPoints:"",vocabLookups:parseInt((e.totalVocabLookups/t).toString(),10).toLocaleString(),notes:parseInt((e.totalNotes/t).toString(),10).toLocaleString(),totalWordsWritten:parseInt((e.totalWords/t).toString(),10).toLocaleString(),viewPeerResponses:"",translationLookups:parseInt((e.totalTranslationLookups/t).toString(),10).toLocaleString(),tts:parseInt((e.totalTTSCount/t).toString(),10).toLocaleString(),numIRTextsRead:parseInt((e.totalIRTextsCount/t).toString(),10).toLocaleString(),irReadingTime:n?a.convertSecondsToDecimalHours(e.totalIRReadingTime/t):a.getFormattedTime(e.totalIRReadingTime/t,!1),researchTextAdded:parseInt((e.totalResearchTextsCount/t).toString(),10).toLocaleString()}},t.getActivityDataForExport=function(e){var n=t.getActivityDataByAssignment(e),i=n.studentsData,o=n.classTotals,r=i.length,l=[],d=t.getClassTotalRowData(o,!0);l.push(d);var c=t.getClassAverageRowData(o,r,!0);return l.push(c),s.each(i,(function(e){var t=e.data.responseData.pointsMax?Math.round(e.data.responseData.pointsSum/e.data.responseData.pointsMax*100):null,n=e.data.readingTimeData?e.data.readingTimeData.time:0,s=e.data.responseData.noRespAnswers+e.data.responseData.answers===0?-1:parseInt((100*e.data.peerResponseLookupsData.lookupCount/(e.data.responseData.noRespAnswers+e.data.responseData.answers)).toString(),10),i={name:a.sanitize(e.name),readingTime:a.convertSecondsToDecimalHours(n),questionCompleted:e.data.responseData.answers,revisionCount:e.data.revisionData.revisionCount,totalPoints:isNaN(t)||null===t?"":t+"%",vocabLookups:e.data.vocabLookupsData.lookupCount,notes:" "+e.data.notesData.count+" / "+e.data.notesData.publicCount,totalWordsWritten:e.data.notesData.wordCount+e.data.responseData.wordCount,viewPeerResponses:e.data.responseData.noRespAnswers+e.data.responseData.answers===0?"N/A":s+"%",translationLookups:e.data.translationLookupCount,tts:e.data.ttsCount,numIRTextsRead:e.data.irData.textCount,irReadingTime:a.convertSecondsToDecimalHours(e.data.irData.readingTime),researchTextAdded:e.data.researchTextCount};l.push(i)})),l}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(8),d=n(10),c=n(54),u=n(1612),p=n(789),h=n(1617),g=n(1618),f=n(791),m=n(1622),v=n(37),b=n(69),C=n(71),y=n(5),_=[{id:"overview",displayName:"Overview"},{id:"assignments",displayName:"Assignments"},{id:"standards",displayName:"Standards"},{id:"writing",displayName:"Writing"},{id:"research",displayName:"Research"},{id:"independent_reading",displayName:"Independent Reading"}],S=[{id:"overview",displayName:"Overview"},{id:"standards",displayName:"Standards"},{id:"writing",displayName:"Writing"},{id:"research",displayName:"Research"},{id:"independent_reading",displayName:"Independent Reading"}],w=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.setupView=function(e){a.toggleSubHeaderActionButtons(e,-1!==a.props.studentUserId),y.adjustHeaderSpacing()},a.switchReport=function(e){if(a.state.subtab!==e){var t="student"===sCH.userM.get("Role")?"#student/classes/"+a.props.classId+"/mydata/"+e:"#teacher/classes/"+a.props.classId+"/studentdata/"+e+"/?studentuserid="+a.props.studentUserId;if(v.addToNavigationHistory(t),a.renderSubHeaderButtons(e),Backbone.pubEv.trigger("updateSubTab",e),sCH.userM.isOnFreePlan()||-1!==a.props.studentUserId)switch(e){case"assignments":a.renderAssignmentsTab();break;case"standards":a.renderStandardsTab();break;case"writing":a.renderWritingTab();break;case"research":a.renderResearchTab();break;case"independent_reading":a.renderIRTab();break;case"overview":default:a.renderOverviewTab()}else a.renderNoStudents(e)}},a.renderSubHeaderButtons=function(e){Backbone.pubEv.trigger("UpdateStudentDataSubheaderButtons",{subtab:e})},a.toggleSubHeaderActionButtons=function(e,t){$(".btnStudentDataPrint,.btnStudentDataExport").hide(),["overview","standards","writing"].indexOf(e)>-1?($(".btnStudentDataPrint").show(),y.toggleFocusNClick(".btnStudentDataPrint",sCH.userM.isOnFreePlan()||!t)):["assignments"].indexOf(e)>-1&&($(".btnStudentDataExport").show(),y.toggleFocusNClick(".btnStudentDataExport",sCH.userM.isOnFreePlan()||!t))},a.renderOverviewTab=function(){var e=a.props,t=e.classId,n=e.studentUserId;sCH.userM.isOnFreePlan()?a.renderScreenshots("overview","/img/Classes_StudentData_Overview.png"):d.GetStudentDataOverview({classId:t,studentUserId:n},(function(e){a.setState({subtab:"overview",el:o.createElement(u.default,i({},e))})}))},a.renderAssignmentsTab=function(){var e=a.props,t=e.classId,n=e.studentUserId;sCH.userM.isOnFreePlan()?a.renderScreenshots("assignments","/img/Classes_StudentData_Assignments.png"):d.GetStudentDataAssignments({classId:t,studentUserId:n},(function(e){a.setState({subtab:"assignments",el:o.createElement(p.default,i({},e,{ClassId:t}))})}))},a.renderStandardsTab=function(){var e=a.props,t=e.classId,n=e.studentUserId;sCH.userM.isOnFreePlan()?a.renderScreenshots("standards","/img/Classes_StudentData_Standards.png"):d.GetStudentDataStandards({classId:t,studentUserId:n},(function(e){var s=c.prepareData(e,e.Standards);a.setState({subtab:"standards",el:o.createElement(h.default,i({},s,{standards:e.Standards,classId:t,studentUserId:n}))})}))},a.renderWritingTab=function(){var e=a.props,t=e.classId,n=e.studentUserId;sCH.userM.isOnFreePlan()?a.renderScreenshots("writing","/img/Classes_StudentData_Writing.png"):a.setState({subtab:"writing",el:o.createElement(g.default,{classId:t,studentUserId:n})})},a.renderResearchTab=function(){var e=a.props,t=e.classId,n=e.studentUserId;sCH.userM.isOnFreePlan()?a.renderScreenshots("research","/img/Classes_StudentData_Research.png"):a.setState({subtab:"research",el:o.createElement(m.default,{classId:t,studentUserId:n})})},a.renderIRTab=function(){var e=a.props,t=e.classId,n=e.studentUserId;sCH.userM.isOnFreePlan()?a.renderScreenshots("independent_reading","/img/Classes_Student Data_IndependentReading.png"):a.setState({subtab:"independent_reading",el:o.createElement(f.default,{classId:t,studentUserId:n})})},a.renderScreenshots=function(e,t){a.setState({subtab:e,el:o.createElement(C.default,{className:"trialSplash",view:b.default,options:{screenshotUrl:t,showSampleBanner:!0}})})},a.renderNoStudents=function(e){a.setState({subtab:e,el:o.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noStudentsInClass)})},a.state={el:null},a}return s(t,e),t.prototype.componentDidMount=function(){this.props.studentUserId&&this.switchReport(this.props.subtab||"overview"),this.setupView(this.props.subtab)},t.prototype.componentDidUpdate=function(){this.setupView(this.state.subtab)},t.prototype.render=function(){var e=this,t=this.props.studentUserId,n=this.state.subtab,a="student"===sCH.userM.get("Role")?S:_,s=-1===this.props.studentUserId&&!sCH.userM.isOnFreePlan(),i=y.classNames({pageTabsContainer:!0,disableTabs:s}),r=["independent_reading","assignments","research"].includes(n);return sCH.userM.get("ShouldShowIRInMainMenu")||(a=a.filter((function(e){return"independent_reading"!==e.id}))),t?o.createElement("div",{className:r?"tableViewWrapper":""},o.createElement("div",{role:"tablist","aria-label":"Student data tabs",className:i},l.map(a,(function(t){return o.createElement("a",{href:"javascript:void(0)",role:"tab",key:t.id,tabIndex:s?-1:null,onClick:function(){return e.switchReport(t.id)},className:"btn-box toggler btnSwitchReportType "+(e.state.subtab===t.id?"selected":"")},t.displayName)}))),o.createElement("div",{className:"dataWrapper "+(r?"tableSection":"")},this.state.el)):o.createElement("div",{className:"ctaInfo"},"No data yet!")},t}(r.Component);t.default=w},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(0),l=n(0),d=n(5),c=n(1616),u=n(60),p=1,h=50,g=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.customizedWeightsExist=a.props.Assignments&&a.props.Assignments.length>0&&a.props.Assignments.find((function(e){return e.GradeWeight!==p})),a.getHeader=function(){return{height:h,cells:[{content:"Assignment",width:this.customizedWeightsExist?500:600},{content:this.customizedWeightsExist?"Weight":"",width:this.customizedWeightsExist?100:0,classes:{headerWeight:!0,center:!0}},{content:r.createElement(r.Fragment,null,"Grade",r.createElement("div",{className:"info"},"(points earned so far)")),width:180,classes:{headerGrade:!0,center:!0}},{content:r.createElement(r.Fragment,null,"Question Progress",r.createElement("div",{className:"info"},"(# unanswered)")),width:160,classes:{center:!0}}]}},a.getBody=function(){var e={height:50,cells:[{content:"Total Grade",sortValue:null,classes:{header:!0}},{content:"",sortValue:null,classes:{header:!0}},{content:r.createElement(c.default,{color:a.gradeTotal.color,pointsEarned:a.gradeTotal.pointsEarned,pointsPossible:a.gradeTotal.pointsPossible}),sortValue:null,classes:{header:!0}},{content:"",sortValue:null,classes:{header:!0}}]};return a.state.sortedGrades.map((function(e){return a.getRow(e)})).concat(e)},a.getRow=function(e){return{height:Math.max(650*e.Title.length/window.innerWidth,h),cells:[{content:r.createElement(r.Fragment,null,r.createElement("a",{onClick:function(){return d.openReaderUrl(e.AssignmentLink)},className:"lnkAssignmentTitle"},e.Title),r.createElement("div",{className:"labels"},e.LayerLabels.join(", "))),sortValue:e.Title},{content:this.customizedWeightsExist&&e.Weight!==p?e.Weight+"x":"",sortValue:this.customizedWeightsExist?e.Weight:null,classes:{center:!0}},{content:e.PointsPossible>0?r.createElement(c.default,{color:e.Color,pointsEarned:e.PointsEarned*e.Weight,pointsPossible:e.PointsPossible*e.Weight}):"",sortValue:e.PointsPossible>0?e.PointsEarned/e.PointsPossible:null,classes:{center:!0}},{content:e.Questions?r.createElement(r.Fragment,null,d.percent(e.NumOfResponses/e.Questions),e.Questions>e.NumOfResponses&&r.createElement("div",{className:"info"},"(",e.Questions-e.NumOfResponses,")")):"",sortValue:e.Questions?e.NumOfResponses/e.Questions:null,classes:{center:!0}}]}};var s=a._prepareGrades().sortedGrades;return a.gradeTotal=a._getGradeTotal(s),a.state={sortedGrades:s},a}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.trigger("setGradesExportBtnAction",{grades:this.state.sortedGrades,customizedWeightsExist:this.customizedWeightsExist})},t.prototype.render=function(){var e=this,t=d.gradeNameMap(!1,{gradebook:this.props.Settings}).slice().reverse(),n=!this.props.Grades||!this.props.Grades.length||"student"!==sCH.userM.get("Role");return r.createElement(r.Fragment,null,r.createElement(f,{classId:this.props.ClassId,grades:this.props.Grades}),this.props.Grades&&this.props.Grades.length>0&&r.createElement(u.VTable,{header:this.getHeader(),body:this.getBody(),fixedRowCount:1,fixedColumnCount:1,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,customClassNames:["studentGradebookTable","tableSection"]}),n?null:r.createElement("div",{className:"section gradingKey"},r.createElement("h2",null,"Grading key"),r.createElement("p",null,"Point values for each question response:"),r.createElement("table",{className:"shortAnswer"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{colSpan:4},"Short Answer"))),r.createElement("tbody",null,t.map((function(t,n){return r.createElement("tr",{key:n},r.createElement("td",{className:"label"},t.label),r.createElement("td",{className:"numerator"},e.props.Settings.shortAnswer.numerators[t.id]),r.createElement("td",{className:"slash"},"/"),r.createElement("td",{className:"denominator"},e.props.Settings.shortAnswer.denominator))})))),r.createElement("table",{className:"multipleChoice","data-question":"multipleChoice"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{colSpan:4},"Multiple Choice"))),r.createElement("tbody",null,Object.keys(this.props.Settings.multipleChoice.numerators).map((function(t,n){return r.createElement("tr",{key:n},r.createElement("td",{className:"label"},t),r.createElement("td",{className:"numerator"},e.props.Settings.multipleChoice.numerators[t]),r.createElement("td",{className:"slash"},"/"),r.createElement("td",{className:"denominator"},e.props.Settings.multipleChoice.denominator))}))))))},t.prototype._getGradeTotal=function(e){if(0===e.length)return 0;var t={pointsEarned:0,pointsPossible:0};return o.each(e,(function(e){t.pointsEarned+=e.PointsEarned*e.Weight,t.pointsPossible+=e.PointsPossible*e.Weight})),t.color=d.gradeColor(this.props.Settings,t.pointsEarned,t.pointsPossible),t},t.prototype._prepareGrades=function(){var e=this;return{sortedGrades:this.props.Assignments.map((function(t){var n=e.props.Grades.filter((function(e){return e.AssignmentId===t.AssignmentId&&e.AssignmentTextSectionSplitMapId===t.AssignmentTextSectionSplitMapId})).pop(),a="student"===sCH.userM.get("Role")?"#student/reader/"+n.AssignmentId+(t.IsQuiz?"":"/notes"):"#teacher/reader/grading/"+n.AssignmentId+"/data",s=t.Title+(t.SectionRangeName?": "+t.SectionRangeName:"");return n.Weight=t.GradeWeight,n.Title=s,t.AssignmentLink=a,t.Color=d.gradeColor(e.props.Settings,n.PointsEarned,n.PointsPossible),i(i({},t),n)}))}},t}(l.Component);t.default=g;var f=function(e){var t=e.classId,n=e.grades;return t?!t||n&&n.length?null:r.createElement("div",{className:"ctaInfo"},"You don't have any grades in this class yet!"):r.createElement("div",{className:"empty"},"You haven't joined a class yet.")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.getClassGradeNameMap=function(e){var t=JSON.parse(sCH.classesC.find({ClassId:e}).get("Settings"));return a.gradeNameMap(!1,t).reduce((function(e,t){return e[t.id]=t.label,e}),{})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(60),d=n(10),c=n(5),u=n(54),p=n(8),h=n(1619),g=n(153),f=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.isStudent="student"===sCH.userM.get("Role");var s=u.getSchoolYearRangeOrDefault(a.isStudent?"irstudent":"student");return a.state={IRData:[],startDate:s.start.toISOString(),endDate:s.end.toISOString(),genres:a.props.genres},a}return s(t,e),t.prototype.componentDidMount=function(){this._renderDateFilter(),this._getData({})},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype._renderDateFilter=function(){var e=this;u.initDateRangePicker(moment(this.state.startDate),moment(this.state.endDate),(function(t,n){e._getData({startDate:t.toISOString(),endDate:n.toISOString()})}),this.isStudent?"irstudent":"student")},t.prototype._getData=function(e){var t=this;if(this.isStudent)d.GetReadingLogData((function(n){var a=t.state,s=a.startDate,o=a.endDate;e.startDate&&(s=e.startDate,o=e.endDate);var r=n.filter((function(e){return moment.utc(e.FinishDate).isAfter(s)&&moment.utc(e.FinishDate).isBefore(o)})),l=i(i({},e),{IRData:r});t.setState(l)}));else{var n=i({classId:this.props.classId,studentUserId:this.props.studentUserId,startDate:this.state.startDate,endDate:this.state.endDate},e);d.GetStudentDataIR(n,(function(n){var a=i(i({},e),{IRData:n.irData,genres:n.genres});t.setState(a)}))}},t.prototype._getTable=function(){var e=v(this.state.IRData,this.state.genres,this.props.classes),t=b();return o.createElement(l.VTable,{header:t,body:e,enableFixedColumnScroll:!0,fixedRowCount:1,fixedColumnCount:1})},t.prototype.render=function(){return o.createElement("div",{className:"studentDataResearchIR tableViewWrapper"},o.createElement("div",{id:"portfolioFilters"},o.createElement("div",{className:"reportrange pull-right"},o.createElement("span",null),o.createElement("b",{className:"caret"})),this.props.showHeading&&o.createElement("h2",null,"Independent Reading Log",o.createElement(g.default,{buttonClass:"icon-question-mark-inverse",placement:"right"},"Below is a list of texts you have read independently. Good job!"))),this.state.IRData.length?this._getTable():o.createElement("div",{className:"ctaInfo"},this.props.noDataMsg||"No data for this date range!"))},t}(r.Component),m={text:"Text",topic:"Topic",review:"Review",length:"Length",timeSpent:"Time Spent",finished:"Finished"},v=function(e,t,n){var a=[];return p.each(e,(function(e){var s=p.find(t,{GenreId:e.GenreId}),i=s?s.GenreName:"",r=Math.ceil(e.PageCount),l={text:{content:o.createElement("div",null,c.htmlDecode(e.Title),o.createElement("div",{className:"author"},e.Author)),sortValue:e.Title.toLowerCase()},topic:{content:i,sortValue:i.toLowerCase()},review:{content:o.createElement("div",{className:"rating"},o.createElement(C,{numStars:e.Rating,classes:n}),o.createElement(y,{reviewText:e.Answer,classes:n})),sortValue:e.Rating||0},length:{content:-1===r?"N/A":c.plural(r,"%count pages","%count page"),sortValue:r},timeSpent:{content:c.getFormattedTime(e.ReadingTime,!0),sortValue:e.ReadingTime||0},finished:{content:o.createElement(h.default,{className:"finishdate",title:e.FinishDate+"Z",date:moment.utc(e.FinishDate).local()}),sortValue:moment.utc(e.FinishDate)}};a.push({height:100,cells:Object.keys(m).map((function(e){return{content:l[e].content,sortValue:l[e].sortValue,width:["text","review"].indexOf(e)>-1?360:180,classes:{center:["text","review"].indexOf(e)<0}}}))})})),a},b=function(){return{height:50,cells:p.map(Object.keys(m),(function(e){return{content:m[e],width:["text","review"].indexOf(e)>-1?360:180,classes:{center:["text","review"].indexOf(e)<0}}}))}},C=function(e){e.classes;for(var t=e.numStars,n=[],a=0;a<t;a++)n.push(o.createElement("span",{key:a,className:"icon-star-filled star"}));return o.createElement("div",null,n)},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showFullReviewInPopup=function(){new Backbone.BootstrapModal({title:"Full review",content:"<p>"+t.props.reviewText+"</p>",allowCancel:!0,cancelText:!1}).open()},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.props,n=(t.classes,t.reviewText);return n?n.length<100?o.createElement("span",{dangerouslySetInnerHTML:{__html:c.sanitize(n)}}):o.createElement("div",null,o.createElement("span",{dangerouslySetInnerHTML:{__html:c.truncate(c.sanitize(n),100)}}),o.createElement("a",{className:"btnShowFullReview",onClick:function(){return e.showFullReviewInPopup()}},"more")):o.createElement("span",null,"N/A")},t}(r.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(85),i=n(133),o=n(749),r=n(274),l=n(10),d=n(14);t.handleReaderAccessError=function(e){if(Backbone.pubEv.trigger("loadingShowHide",!1),"NotAvailableInThisCountry"===e.accessError)new Backbone.BootstrapModal({title:"No access",content:"<p>The publisher of this rental text has not made it available in "+e.countryCode+".</p>",okText:"Ok",cancelText:!1,allowCancel:!1,cssClass:"danger"}).on("ok",(function(){a.redirectUserByHash(sCH.lastAccessedPreReaderUrl||a.getReaderExitUrl()),sCH.lastAccessedPreReaderUrl=null})).open();else if("AnonymousPreviewInaccessible"===e.accessError)a.showAnonymousPreviewInaccessiblePopup({inReader:!0});else if("NoAccessButSameLayerAssignmentAccessible"===e.accessError)a.redirectUserByHash(e.redirectUrl);else if("NotInClass-Deleted"===e.accessError)window.location.hash="#student/classes";else if("NotInClass-Native"===e.accessError){var t=new Backbone.BootstrapModal({title:'Please join <span style="color:#388E3C;">'+a.sanitize(e.className)+" ("+a.sanitize(e.teacherName)+")</span>",content:new o.default({inTextView:!0}),allowCancel:!1,cssClass:"modal-al-join-class-in-reader",cancelText:"I'm not in this class!",okText:"Join class",enterTriggersOk:!0});t.on("cancel",(function(){window.location.hash="#student/classes"})),t.open()}else if("NotAssigned"===e.accessError)new Backbone.BootstrapModal({content:"You do not have access to this assignment.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"OK"}).open((function(){window.location.hash="#student/classes"}));else if("NoAccess"===e.accessError||"AccessExpired"===e.accessError){if("student"===sCH.userM.get("Role"))new Backbone.BootstrapModal({title:"No access",content:alcfg.alertsText.noAccess+" We've informed your teacher and they will be getting back to you soon.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-no-access-reader"}).open((function(){e.isMath?i.redirectOnReaderExit(e):"student"===sCH.readerConfig.type&&(window.location.hash=a.getReaderExitUrl())})).on("cancel",(function(){window.location.hash=a.getReaderExitUrl()}));else if(e.licenseInfo&&e.licenseInfo.totalLicensesAvailableForStudent>0)var n=new Backbone.BootstrapModal({title:"No access",content:"You have "+e.licenseInfo.totalLicensesAvailableForStudent+" unassigned licenses \n            (that lasts "+e.licenseInfo.licenseDuration+") for this text. Would you like to use one of them now?",okText:"Ok",cssClass:"modal-lg modal-al-payment-form",cancelText:"Cancel"}).open((function(){l.AllocateLicenseToTeacher({learnEntityId:e.learnEntityMetaM.LearnEntityId},(function(e){e?window.location.reload():a.showErrorPopup()}))}),(function(){n.close(),window.location.hash=a.getReaderExitUrl()}));else new Backbone.BootstrapModal({title:sCH.userM.isSchoolUsingContentCredits()?e.learnEntityMetaM.Title:"No access",content:new r.default({textM:e.learnEntityMetaM,source:d.LearnEntityPurchaseSource.TEACHER_READER}),okText:sCH.userM.isSchoolUsingContentCredits()?"Ok":"Rent",cssClass:"modal-lg modal-al-payment-form",allowCancel:!1}).open()}else if("TeacherNoAccess-InCatalog"===e.accessError)a.redirectUserByHash(window.location.hash.replace("authoring","authoring/preview"));else if(e.accessError&&-1!==e.accessError.indexOf("TeacherNoAccess-InLibrary")){var c=e.accessError.split("-").pop();sCH.userM.isAnonUser()?new Backbone.BootstrapModal({title:"Please log in",content:"Please log in to access this text that is shared in the "+c+" Library.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"Log in"}).open((function(){window.location.href="/account.html?furl="+encodeURIComponent(window.location.hash.substr(1))})):new Backbone.BootstrapModal({title:"You do not have access to this text",content:"This text is shared in a different "+c+" Library. We'll take you back to the Catalog now.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"OK"}).open((function(){e.isMath?i.redirectOnReaderExit(e):window.location.hash=s.roleForUrl()+"/catalog"}))}else if("TeacherNoAccess"===e.accessError||"StudentNoAccess"===e.accessError){Backbone.pubEv.trigger("loadingShowHide",!1);var u=e.isMath&&e.assignmentId||sCH.readerConfig.assignmentId&&-1!==sCH.readerConfig.assignmentId||"student"===sCH.userM.get("Role");new Backbone.BootstrapModal({title:"You do not have access to this "+("studentresearch"===sCH.readerConfig.type?"text.":"assignment."),content:"We'll take you back to "+(u?"your Classes.":"your Content space."),allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"OK"}).open((function(){e.isMath?i.redirectOnReaderExit(e):window.location.hash=s.roleForUrl()+"/"+(u?"classes":"catalog")}))}else if("InvalidAssignment"==e.accessError||"InvalidLesson"==e.accessError||"InvalidText"==e.accessError){var p=e.accessError.replace("Invalid","").toLowerCase(),h="",g=void 0;sCH.userM.isAnonUser()?g="to the log in page":("assignment"===p?h="Classes":"lesson"===p?h="Catalog":"text"===p&&(h="studentresearch"===sCH.readerConfig.type?"Classes":"Bookshelf"),g="back to your "+h),new Backbone.BootstrapModal({title:"This "+("text"===p?"text":"assignment")+" does not exist",content:"We'll now take you "+g+".",allowCancel:!1,cancelText:!1}).open((function(){window.location.hash=s.roleForUrl()+"/"+h.toLowerCase()}))}else new Backbone.BootstrapModal({title:"Oops!",content:e.message||"There was a problem loading the reader. Please try again by refreshing the page or go back.",allowCancel:!1,cancelText:!1,cssClass:"modal-al-not-assigned",okText:"Go back"}).open((function(){window.history.back()}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(167),i={query:"",results:[],searchId:0};t.search=function(e,n){i.query=e,i.results=[],i.searchId++;var a=i.searchId;if(sCH.learnEntityMetaM.get("RentalPrices")){var o=sCH.learnEntitySectionsMetaC.find({TextSectionId:sCH.readerConfig.currentSectionId}).toJSON();t.matchesInSection(o,a),n(t.getSearchResultsHtml())}else{var r=sCH.learnEntitySectionsMetaC.getValidSectionIds();s.supported&&s.db.textSections.where("TextSectionId").anyOf(r).toArray((function(e){e.forEach((function(e){t.matchesInSection(e,a)})),a==i.searchId&&n(t.getSearchResultsHtml())}))}},t.searchWordsInText=function(e){var n=[],a=sCH.learnEntitySectionsC.find({TextSectionId:sCH.readerConfig.currentSectionId}).toJSON();return e.forEach((function(e){i.query=e,i.results=[],i.searchId++,t.matchesInSection(a,i.searchId),n=n.concat(i.results)})),n},t.matchesInSection=function(e,n){if(e&&n==i.searchId){var s=sCH.learnEntityMetaM.get("IsEncrypted")?a.ehtmlToHtml(e.Content,e.PickAndRoll):e.SanitizedContent,o=$("<div/>").html(s),r=a.htmlToText(o[0]),l=a.htmlToText(o[0],!0);sCH.learnEntityMetaM.get("IsEncrypted")&&(r=a.eStringToString(r),l=a.eStringToString(l));for(var d,c,u=l.length-r.length,p=a.getStyleTagContentLength(o),h=r.length-p,g=new RegExp(i.query.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"gi"),f=new RegExp(i.query.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"gi");null!=(d=g.exec(l));){var m=f.exec(r);if(m){for(;d.index-m.index>u;)m=f.exec(r).index;if(c=t.getMatchText(l,d.index,e.Title),n!=i.searchId)return;var v=m.index-p;if(!(v<0)){var b=Math.floor(v/h*100);i.results.push({textSectionId:e.TextSectionId,sectionTitle:e.Title,text:c,searchOffset:{startIndex:m.index,endIndex:m.index+i.query.length},locationPercentage:b})}}}}},t.getMatchText=function(e,t,n){var a=null!==n?110:155,s=t-a/2>0?t-a/2:0,o=e.substr(s,a),r=o.indexOf(" "),l=o.split("").reverse().join("").indexOf(" "),d=o.substr(r,o.length-r-l),c=new RegExp("("+i.query.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")","gi");return{displayText:d.replace(c,'<span class="textMatch">$1</span>'),baseText:d,index:t}},t.getSearchResultHtml=function(e,t){return'\n    <li class="'+t+'">\n      <a>\n        <div class="section" data-textsectionid="'+e.textSectionId+'">\n          '+e.sectionTitle+" location: "+e.locationPercentage+'%\n        </div>\n        <div class="text" data-text="'+e.text.baseText+'">\n          ...'+e.text.displayText+"...\n        </div>\n      </a>\n    </li>"},t.getSearchResultsHtml=function(){for(var e=!!(("student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type)&&sCH.readerConfig.Settings.QuestionGates)&&sCH.questionsNumC.getFirstNotAnsweredQuestion(),n=!!e&&(-1===e.StartIndex&&-1!==e.EndIndex),a="",s=sCH.learnEntitySectionsMetaC.validSectionLength>0?sCH.readerConfig.currentSectionId:0,o="disabled",r=0;r<i.results.length;r++)o=e?i.results[r].textSectionId<e.TextSectionId?"enabled":i.results[r].textSectionId===e.TextSectionId&&(i.results[r].searchOffset.endIndex<e.EndIndex||n)?"enabled":"disabled":"enabled",i.results[r].textSectionId===s&&(67*r,s=0),a+=t.getSearchResultHtml(i.results[r],o);return a},t.goToMatch=function(e){if(e.stopPropagation(),$(e.currentTarget).hasClass("enabled")||!sCH.readerConfig.Settings.QuestionGates){var t=$(e.currentTarget).index();try{Backbone.pubEv.trigger("skipToTag",{sectionId:i.results[t].textSectionId,searchContext:i.results[t].text.baseText,searchOffset:i.results[t].searchOffset})}catch(n){rg4js("send",{error:new Error("Search goToMatch error"),customData:{index:t,textSectionId:sCH.readerConfig.currentSectionId,resultCount:i.results?i.results.length:null,searchText:$(e.currentTarget).find(".textMatch").length?$(e.currentTarget).find(".textMatch")[0].textContent:null,error:n}})}}else new Backbone.BootstrapModal({title:"Oops!",content:alcfg.confirmsText.searchRestricted,cssClass:"modal-al-oops-search-restricted",cancelText:!1}).open()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(517),r=n(48),l=n(192);t.default=Backbone.View.extend({events:{"change .ddlStudents":"toggleStudent","click .btnSummaryToggleSharedNotes":"toggleSharedNotes","change .ddlCategories":"toggleCategory","click .btnPrintView":"printSummaryView","click .btnViewInReader":"viewInReader","click .extraHelpIconContainer:not(.locked)":"manageExtraHelpStudents"},template:n(1785),initialize:function(){this.on("initialized",this.modalInitialized),this.on("cancel",this.destroy),this.on("shown",this.shown),this.studentId=-1,"grading"===sCH.readerConfig.type?this.studentId=sCH.readerConfig.selectedStudentUserId?sCH.readerConfig.selectedStudentUserId:-1:"studentir"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type?this.studentId=0:this.studentId=sCH.readerConfig.Settings.AllowStudentSharedNotes?-1:0},modalInitialized:function(e){this.modal=e,i.GetNotesSummaryViewTags({assignmentId:sCH.readerConfig.assignmentId,layerId:sCH.readerConfig.layerId,studentLayerId:sCH.readerConfig.studentLayerId,omitTextSectionIds:sCH.teacherNotesC.textSectionsLoaded,type:sCH.readerConfig.type,isPreview:sCH.readerConfig.isReadOnly||!1},(function(t){sCH.loadNotesSummaryViewData(t),e.open()})),Backbone.tracking.trackGAEvent("user","notesummaryview")},shown:function(e){var t=this.$el.find(".list");t.css({maxHeight:$(window).height()-t.offset().top-74-31}),sCH.readerConfig.isAccessExpired&&e.$el.addClass("accessExpired")},getNoteCategoryCounts:function(e){var t={},n=sCH.teacherNotesC.models.concat(sCH.studentNotesC.models);if((sCH.readerConfig.Settings.AllowStudentSharedNotes||"student"!==sCH.readerConfig.type)&&(n=n.concat(sCH.allStudentTagsC.models)),n=a.uniqBy(n,(function(e){return e.get("TagId")})),n=this.filterOutInvalidNotes(n),"student"===sCH.readerConfig.type&&sCH.readerConfig.Settings.QuestionGates){var s=sCH.questionsNumC.getFirstNotAnsweredQuestion();s&&(n=n.filter((function(e){return!(-1!==s.StartIndex&&e.get("TextSectionId")===s.TextSectionId&&e.get("EndIndex")>s.EndIndex)})))}a.each(e,(function(e){var a=n.filter((function(t){return t.get("Category")===e}));t[e]=a.length}));var i=n.filter((function(e){return e.get("LayerId")&&$.inArray(e.get("Color"),alcfg.tags.note.noteCustomColorsArray)>-1})),o={};a.each(i,(function(e){o[e.get("Category")]?o[e.get("Category")]++:o[e.get("Category")]=1}));var r=n.filter((function(e){return e.get("AssignmentId")&&$.inArray(e.get("Color"),alcfg.tags.note.noteCustomColorsArray)>-1})),l={};return a.each(r,(function(e){l[e.get("Category")]?l[e.get("Category")]++:l[e.get("Category")]=1})),{fixedNoteCategoryNoteCounts:t,teacherCustomNoteCounts:o,studentCustomCategoryNoteCounts:l}},filterOutInvalidNotes:function(e){return a.reject(e,(function(e){return"whiteout"===e.get("Type")||"marker"===e.get("Type")||e.get("IsAssociatedNote")}))},render:function(){var e=[];a.each(s.generateNoteColorCategoryMap(sCH.readerConfig.tagConfig),(function(t,n){!t.category||t.isDeleted||t.isCustom||e.push(t.category)}));var t=sCH.studentsC.map((function(e){var t=sCH.studentNotesC.getNotesAndRepliesCountBySectionAndStudentId(-1,e.get("UserId"))+sCH.teacherNotesC.getNotesAndRepliesCountBySectionAndStudentId(-1,e.get("UserId"));return{UserId:e.get("UserId"),FirstName:e.get("FirstName"),LastName:e.get("LastName"),NoteCount:t}})),n=sCH.userM.isPLAssignment();this.$el.html(this.template({settings:sCH.readerConfig.Settings,readerType:sCH.readerConfig.type,students:t,noteCategories:e,sharedNotesCount:sCH.readerConfig.Settings.AllowStudentSharedNotes||"student"!==sCH.readerConfig.type?sCH.studentNotesC.getSharedNotesBySectionId(-1).length:0,allNotesCount:this.filterOutInvalidNotes(sCH.studentNotesC.models).length+sCH.teacherNotesC.length,noteCategoryNoteCounts:this.getNoteCategoryCounts(e),showPrintButton:n||"student"!==sCH.readerConfig.type||s.isClassTeacherOnPersonalOrHigherPlan(sCH.learnEntityMetaM.get("ClassId"))})),this.studentId>0?(this.$el.find(".ddlStudents").val(this.studentId),this.initializeNoteReplies(sCH.readerConfig.selectedStudentUserId,sCH.teacherNotesC.models.concat(sCH.studentNotesC.models))):this.renderNotes(),this.$el.find(".ddlStudents").selectpicker(),this.$el.find(".ddlCategories").selectpicker()},renderNotes:function(){var e=sCH.learnEntitySectionsMetaC.getValidSectionsJson(),t=this,n=0,i=!1,r=parseInt(this.$el.find(".ddlStudents").val()),l="-1"===this.$el.find(".ddlCategories").val()?null:this.$el.find(".ddlCategories").val();this.tags&&this.tags.destroy(),this.tags=new o.default({tagListMode:!0});var d=this.$el.find(".list");d.empty();(new Date).getTime();a.each(e,(function(e,s){var o=e.TextSectionId,c=[];if("student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type?("all"===t.$el.find(".btnSummaryToggleSharedNotes.selected").data("state")||"studentresearch"===sCH.readerConfig.type?(c=sCH.teacherNotesC.getModelsBySectionId(o),(sCH.readerConfig.Settings.AllowStudentSharedNotes||"studentresearch"===sCH.readerConfig.type)&&(c=c.concat(sCH.allStudentTagsC.getModelsBySectionId(o)))):c=sCH.teacherNotesC.getModelsBySectionAndStudentId(o,sCH.userM.get("UserId")).concat(sCH.allStudentTagsC.getModelsBySectionAndStudentId(o,sCH.userM.get("UserId"))),c=c.concat(sCH.studentNotesC.getModelsBySectionId(o))):"grading"===sCH.readerConfig.type?-1!==r||l?0===r||l?(c=sCH.teacherNotesC.getModelsBySectionId(o,!1).concat(sCH.studentNotesC.getModelsBySectionId(o,!1)).concat(sCH.allStudentTagsC.getModelsBySectionId(o,!1)),i=!0):c=sCH.teacherNotesC.getModelsBySectionAndStudentId(o,r).concat(sCH.studentNotesC.getModelsBySectionAndStudentId(o,r)).concat(sCH.allStudentTagsC.getModelsBySectionAndStudentId(o,r)):(c=sCH.teacherNotesC.getModelsBySectionId(o,!0).concat(sCH.studentNotesC.getModelsBySectionId(o,!0)).concat(sCH.allStudentTagsC.getModelsBySectionId(o,!0)),i=!0):c=sCH.teacherNotesC.getModelsBySectionId(o),c.length&&(c=a.uniqBy(c,(function(e){return e.get("TagId")}))),c.length>0){if(c=(c=t.filterOutInvalidNotes(c)).sort((function(e,t){return-1===e.get("StartIndex")&&-1===t.get("StartIndex")?e.get("EndIndex")-t.get("EndIndex"):-1===e.get("StartIndex")?1:-1===t.get("StartIndex")?-1:e.get("StartIndex")-t.get("StartIndex")})),l&&(c=c.filter((function(e){return e.get("Category")&&e.get("Category").indexOf(l)>=0}))),("student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type)&&sCH.readerConfig.Settings.QuestionGates){var u=sCH.questionsNumC.getFirstNotAnsweredQuestion();if(u){var p=sCH.learnEntitySectionsMetaC.find({TextSectionId:u.TextSectionId});c=c.filter((function(e){return sCH.learnEntitySectionsMetaC.find({TextSectionId:e.get("TextSectionId")}).get("SectionNum")<p.get("SectionNum")||e.get("TextSectionId")===u.TextSectionId&&-1!==u.StartIndex&&e.get("EndIndex")<=u.EndIndex}))}}if(c.length>0){var h=$('<div class="sectionSummaryContainer" data-sectionid="'+o+'">'+(e.Title?'<h4 class="sectionHeading">'+e.Title+"</h4>":"")+"</div>");h.appendTo(d),t.tags.addModelsAndRender({models:c,element:h}),n+=c.length}}})),0===n&&d.append('<div class="sectionSummaryContainer"><h4 class="sectionHeading">'+(i&&-1===r?"No shared notes! Please select a student to see their private notes.":"No notes!")+"</h4></div>"),s.initTooltips(this.$el)},toggleStudent:function(){var e=parseInt(this.$el.find(".ddlStudents").val()),t={studentUserId:0==e?-1:e,assignmentId:sCH.readerConfig.assignmentId};this.$el.find(".ddlCategories").selectpicker("val","-1"),this.studentSelected(t.studentUserId),this.initializeNoteReplies(sCH.readerConfig.selectedStudentUserId,sCH.teacherNotesC.models.concat(sCH.studentNotesC.models))},toggleCategory:function(){0!=this.$el.find(".ddlStudents").val()&&(this.$el.find(".ddlStudents").selectpicker("val","0"),this.studentSelected(-1)),this.renderNotes()},toggleSharedNotes:function(e){var t=$(e.currentTarget);if(t.hasClass("selected")||(this.$el.find(".btnSummaryToggleSharedNotes").removeClass("selected"),t.addClass("selected")),"self"===t.data("state")){var n=sCH.userM.get("UserId").toString();this.initializeNoteReplies(n,sCH.teacherNotesC.models.concat(sCH.allStudentTagsC.models))}else this.renderNotes()},studentSelected:function(e){(e=0===e?-1:e)!==sCH.readerConfig.selectedStudentUserId&&(sCH.readerConfig.selectedStudentUserId=e,$(".reader .ddlStudents:visible").prev().selectpicker("val",e).first().trigger("change"),Backbone.pubEv.trigger("rerenderNotes"))},initializeNoteReplies:function(e,t){e=e.toString();var n=this,s=a.map(a.filter(t,(function(t){return t.get("ReplyUserIds")&&$.inArray(e,t.get("ReplyUserIds").split(","))>-1})),(function(e){return e.get("TagId")}));s.length>0?(sCH.initReplyDataForStudent(),e in sCH.replyDataByStudent?this.renderNotes():i.GetNoteRepliesForStudent({studentUserId:e,assignmentId:sCH.readerConfig.assignmentId,noteTagIds:s},(function(t){t&&(sCH.replyDataByStudent[e]=t,n.renderNotes())}))):this.renderNotes()},printSummaryView:function(){sCH.userM.isOnFreePlan()&&"student"!==sCH.userM.get("Role")?r.showBuyTeacherPopup({title:"Printing"}):s.print(sCH.learnEntityMetaM.get("Title")+" - Notes Summary","printModal")},viewInReader:function(e){this.modal.close();var t=$(e.currentTarget).data("tagid"),n=s.getNoteTagModel(t);Backbone.pubEv.trigger("skipToTag",{sectionId:n.get("TextSectionId"),tagId:t,tagType:"note"})},manageExtraHelpStudents:function(){l.renderManageExtraHelpStudentsPopup()},destroy:function(){this.tags&&this.tags.destroy()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="questionTagGrading '+(null==(__t=0===peerResponseCount?"noPeerResponse":"")?"":__t)+'">\r\n    <div class="breaker" style="margin:0px;margin-bottom:0px !important;"></div>\r\n    ',1===SubType&&("student"!==readerType||peerResponseCount>0)){var numOfAvatarsToShow=bowser.mobile?1:3;__p+='\r\n        <div class="avatarContainer">\r\n            ',_.each(imageUrls.slice(0,numOfAvatarsToShow),(function(e){__p+="\r\n                ",__p+="icon-person"===e?'\r\n                    <a class="icon-person"></a>\r\n                ':"\r\n                    "+(null==(__t=cH.generateAvatarHtml(e,"onerror=\"this.style.display='hidden'\""))?"":__t)+"\r\n                ",__p+="\r\n            "})),__p+="\r\n            <span>"+(null==(__t=imageUrls.length>numOfAvatarsToShow?" +"+(imageUrls.length-numOfAvatarsToShow):"")?"":__t)+'</span>\r\n        </div>\r\n        <div class="count '+(null==(__t="grading"===readerType?"grading":"student")?"":__t)+'">\r\n    '}else __p+="\r\n        <div>\r\n    ";if(__p+="\r\n\r\n    ","grading"===readerType&&1===SubType?(unGradedCount&&(__p+='\r\n            <span class="new">'+(null==(__t=unGradedCount)?"":__t)+" UNGRADED</span>\r\n        "),__p+="\r\n    "):"student"!==readerType&&"tour"!==readerType||(2!==SubType&&peerResponseCount>0?__p+='\r\n            <span class="quesResponseCounts">VIEW CLASSMATES\' RESPONSES</span>\r\n        ':__p+="\r\n            <span></span>\r\n    "),__p+='\r\n    </div>\r\n    <div class="clearBoth"></div>\r\n    ',"grading"===readerType&&1!==SubType){__p+='\r\n        <div class="questionChoices" style="display: block;">\r\n            <span class="heading inverse" style="margin-right:19px;">Answer</span>\r\n            <span class="heading inverse results" style="margin-left: 0px;">Class Results</span>\r\n            ';for(var i=0;i<choices.length;i++)__p+='\r\n                <div class="choice">\r\n                    ',2===SubType&&(__p+='\r\n                        <div class="left mid spaced">\r\n                            <div class="',print(choices[i].IsCorrect?"no-hover icon-checkmark":""),__p+='"></div>\r\n                        </div>\r\n                    '),__p+='\r\n                    <div class="middle"><div class="txtChoice">'+(null==(__t=cH.sanitize(choices[i].Text))?"":__t)+'</div></div>\r\n                    <div class="right large">\r\n                        <div class="percentContainer">\r\n                            <div class="percentageBar">\r\n                                <div class="bar" style="width: '+(null==(__t=choices[i].percent)?"":__t)+'%"></div>\r\n                            </div>\r\n                            <div class="percentageText">'+(null==(__t=choices[i].percent)?"":__t)+"%</div>\r\n                        </div>\r\n                        ",2===SubType&&choiceNumToHideForStrugglingStudent===choices[i].ChoiceNum&&(__p+='\r\n                            <div class="icon-person extraHelpIcon" title="This choice will not be visible to students who need Extra Help."></div>\r\n                        '),__p+="\r\n                    </div>\r\n                </div>\r\n            ";__p+='\r\n        </div>\r\n        <div class="clearBoth" style="height: 10px;"></div>\r\n    '}__p+="\r\n</div>"}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5);t.default=Backbone.View.extend({el:"div.rubricContainer",events:{"change .ddlStandards":"standardSelectionChanged","click .close":"closeView","click .btnClose":"closeView"},template:n(1769),render:function(e){var t=a.filter(sCH.readerConfig.standards,{StandardSetDeleted:!1,StandardDeleted:!1,IsPublished:!0});!e.standardId&&t.length>0&&(e.standardId=t[0].StandardId);var n=s.getStandardById(e.standardId);this.$el.html(this.template({standards:t,role:sCH.userM.get("Role"),selectedStandard:n})).addClass("readerSidePopupContainer"),"student"!==sCH.userM.get("Role")&&(this.$el.find("select").selectpicker(),e&&e.standardId&&this.$el.find(".ddlStandards").selectpicker("val",e.standardId)),this.showStandardRubric(e.standardId),this.$el.show(),this.$el.css({right:s.getRightAlignmentToPlaceNextToRightPanel()})},standardSelectionChanged:function(){var e=parseInt(this.$el.find(".ddlStandards").val());this.showStandardRubric(e)},showStandardRubric:function(e){var t=s.getStandardById(e),n=t&&t.RubricData?JSON.parse(t.RubricData):[],i="";a.each(n,(function(e){a.map(e.critique,"text").join("").length>0&&(i+="<section><h1>"+a.find(sCH.readerConfig.gradeNameMap,{id:e.type}).label+"</h1><ul>",a.each(e.critique,(function(e){i+="<li>"+e.text+"</li>"})),i+="</ul></section>")})),i||(i+='<p class="ctaInfo">No rubric</p>'),this.$el.find(".rubric").html(i),this.$el.find(".ccStandardText").html(t.Description)},closeView:function(){this.close(!1),this.$el.hide()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var noteClass="",noteContainerClass="",tagId=tag.get("TagId"),role=tag.get("AssignmentId")?"student":"teacher",highlightedText=tagListMode?tag.get("HighlightedText"):null;"authoring"===readerType?(noteClass=tag.get("Color"),noteContainerClass=noteClass):"grading"===readerType?"student"===role?(noteClass=isStudentSelected?tag.get("Color"):"transparent",noteContainerClass=tag.get("Color")):(noteClass=tag.get("Color"),noteContainerClass=noteClass):"student"===role?(noteClass=showStudentHighlights?tag.get("Color"):tag.get("CreatedByCurrentUser")?tag.get("Color"):"transparent",noteContainerClass=tag.get("Color")+(tag.get("CreatedByCurrentUser")?"":" transparent")):(noteClass=tag.get("Color"),noteContainerClass=noteClass),__p+='\r\n\r\n<span class="notesTag '+(null==(__t=tag.get("UserId")===sCH.userM.get("UserId")?"mine":"")?"":__t)+" ",print("transparent"===noteClass?tag.get("Color"):""),__p+=" "+(null==(__t=0===tagId?"active":"")?"":__t)+" "+(null==(__t=noteClass)?"":__t)+" ",print(isHighlightOnly?"highlightOnly":""),__p+='"\r\n        data-tagid="'+(null==(__t=tagId)?"":__t)+'"\r\n        data-startindex="'+(null==(__t=tag.get("StartIndex"))?"":__t)+'"\r\n    ',print("transparent"===noteClass?'data-transparent="1"':""),__p+=">\r\n</span>\r\n",isHighlightOnly||(__p+='\r\n    <div class="noteTagContainer note '+(null==(__t=noteContainerClass)?"":__t)+" "+(null==(__t=tagListMode?"tagListMode":"")?"":__t)+'" \r\n        data-tagid="'+(null==(__t=tagId)?"":__t)+'" data-startindex="'+(null==(__t=tag.get("StartIndex"))?"":__t)+'">\r\n        <div class="inner">     \r\n            <div class="userNameContainer">\r\n                <span class="username">'+(null==(__t=sCH.userM.getNameForNote(tag.get("UserId"),tag.get("Username")))?"":__t)+'</span>\r\n                <span class="usernameShort">'+(null==(__t=sCH.userM.getNameForNote(tag.get("UserId"),cH.sanitize(tag.get("UsernameShort"))))?"":__t)+'</span>\r\n                \r\n                <div class="replyCount '+(null==(__t=hideReplyCount?"displayNone":"")?"":__t)+'">\r\n                    <span class="icon-comment no-hover"></span>\r\n                    <span class="num">'+(null==(__t=tag.get("ReplyCount")?tag.get("ReplyCount"):0)?"":__t)+"</span>\r\n                </div>\r\n                ",tag.get("HTML")&&(__p+='\r\n                    <span class="mediaIcon icon-video"></span>\r\n                '),__p+="\r\n                ",tagListMode&&(__p+='\r\n                    <div class="category '+(null==(__t=noteContainerClass)?"":__t)+'">'+(null==(__t=cH.sanitize(tag.get("Category")))?"":__t)+'</div>\r\n                    <a class="btn pull-right btnViewInReader" data-tagid="'+(null==(__t=tag.get("TagId"))?"":__t)+'" title="View in text">'+(null==(__t=bowser.mobile?"Open":"View in text")?"":__t)+"</a>\r\n                "),__p+="\r\n            </div>\r\n\r\n            ",highlightedText&&(__p+='\r\n                <div class="highlightedTextContainer ">\r\n                    ',tag.get("IsNoteReply")?__p+='<span class="icon-notes no-hover"></span>\r\n                    ':__p+='<span class="icon-highlighter no-hover"></span>',__p+='\r\n                    <div class="quotedText"><div>'+(null==(__t=cH.sanitize(highlightedText))?"":__t)+"</div></div>\r\n                </div>\r\n            "),__p+='\r\n \r\n            <div class="noteTagText">\r\n                <span class="displayPrint" style="display: none;">'+(null==(__t=linkify(cH.sanitize(tag.get("Text"))))?"":__t)+'</span>\r\n                <span class="displayScreen">'+(null==(__t=linkify(cH.sanitize(tag.get("Text"))&&tag.get("Text").length>200&&!tagListMode?tag.get("Text",!0).substring(0,197)+"...":tag.get("Text",!0)))?"":__t)+'</span>\r\n            </div>\r\n            <div class="noteTagHtml"></div>\r\n\r\n            ',"student"!==sCH.readerConfig.type&&tag.get("IsExtraHelp")&&(__p+='\r\n                <div class="extraHelpIconContainer isExtraHelp ',print(sCH.userM.isOnFreePlan()?"locked":""),__p+="\"\r\n                    data-container=\"body\"\r\n                    data-tooltip-class='noteSummaryPopupTooltip'\r\n                    title='"+(null==(__t=sCH.userM.isOnFreePlan()?alcfg.infoText.generic.extraHelpNoteFreeT:alcfg.infoText.generic.extraHelp)?"":__t)+"'>\r\n                    <span class=\"extraHelpIcon no-hover ",print(sCH.userM.isOnFreePlan()?"icon-lock":"icon-person"),__p+='"></span>\r\n                    <span>Extra Help</span>\r\n                </div>\r\n            '),__p+="\r\n        </div>\r\n    </div>\r\n"),__p+=""}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1791),initialize:function(e){this.on("ok",this.submit),this.obj=e,this.sections=this.obj.textSections},events:{"click .toggler:not(.selected)":"bulkTypeChanged"},render:function(){return this.$el.html(this.template({type:this.obj.type,sections:this.sections})),"gradeunanswered"===this.obj.type&&this.$el.find(".toggler:first").click(),this},bulkTypeChanged:function(e){var t=$(e.currentTarget);this.$el.find(".bulktype").hide(),this.$el.find("."+t.data("type")).show(),this.$el.find(".toggler").removeClass("selected"),t.addClass("selected")},submit:function(e){e.preventClose();var t=[];if(this.$el.find("input[type='checkbox']:checked").each((function(e,n){t.push($(n).attr("id").replace("section",""))})),"gradeunanswered"===this.obj.type){var n=sCH.learnEntityMetaM.get("LayerTextSectionExcerptId")?null:parseInt(this.$el.find("#txtBulkGradeQNumStart").val().trim()),o=sCH.learnEntityMetaM.get("LayerTextSectionExcerptId")?null:parseInt(this.$el.find("#txtBulkGradeQNumEnd").val().trim()),r={assignmentId:this.obj.assignmentId};if(0===t.length){if(isNaN(n)||isNaN(o)||o<n||n<1||o>sCH.questionsNumC.length)return void s.bootstrap.alert({message:"Please select a section OR enter a valid question range!",alert:"danger"});r.questionRange={start:n,end:o}}else r.sections=t.join();e.disableOk("Grading..."),i.GradeUnanswered(r,(function(t){e.close(),t?(s.bootstrap.alert({message:"Grading unanswered questions completed successfully!"}),window.location.reload(!0)):s.bootstrap.alert({message:"There was an error grading unanswered questions!",alert:"danger"})}))}else if("deletesectionquestions"===this.obj.type)0===t.length?s.bootstrap.alert({message:"Select at least one section to delete questions.",alert:"danger"}):(e.disableOk("Removing..."),i.DeleteSectionQuestions({textSectionIds:t,layerId:this.obj.layerId},(function(t){e.close(),t?window.location.reload(!0):s.bootstrap.alert({message:"There was an error deleting questions!",alert:"danger"})})));else if("hidesections"===this.obj.type){var l=a.map(a.filter(this.sections,(function(e){return e.IsDeleted})),"TextSectionId"),d=a.reject(l,(function(e){return t.indexOf(e)>-1}));0===a.reject(t,(function(e){return l.indexOf(e)>-1})).length&&0===d.length?s.bootstrap.alert({message:"Select at least one section to hide.",alert:"danger"}):t.length===this.sections.length?(e.enableOk("Remove sections"),s.bootstrap.alert({message:"You cannot hide all the sections in a text",alert:"danger"})):(e.disableOk("Hiding..."),i.HideLayerSections({sectionIds:t,layerId:this.obj.layerId},(function(t){t?(e.close(),window.location.reload(!0)):s.bootstrap.alert({message:"There was an error hiding sections!",alert:"danger"})})))}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44);t.default=Backbone.Model.extend({defaults:function(){return{Assignments:[],Students:[],Questions:[]}},sync:a.default,fill:function(e,t){var n=this;this.fetch({url:alcfg.node["reader_"+sCH.readerConfig.type].get_dataPanel,data:{readerType:sCH.readerConfig.type,classId:e,assignmentId:t,studentLayerId:sCH.readerConfig.studentLayerId,layerId:sCH.readerConfig.layerId},mainSuccess:function(e){if(!n.set(n.parse(e)))return!1}})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.View.extend({el:".scroll .dataview.view .panelHeader",events:{"change .ddlStudents":"showByStudent","click .exportsDropdown li a":"exportData","click .btnRefresh":"refreshData","click .btnToggleCurrentSection:not(.selected)":"toggleCurrentSection"},template:n(1818),initialize:function(e){this.reader=e.reader,Backbone.pubEv.on("dataPanelNeedsRefresh",this.dataPanelNeedsRefresh,this)},render:function(){var e=sCH.learnEntitySectionsMetaC.validSectionLength>1?sCH.learnEntitySectionsMetaC.findWhere({TextSectionId:sCH.readerConfig.currentSectionId}).get("Title"):null;this.$el.html(this.template({userRole:"teacher",showCurrentSectionToggle:!sCH.readerConfig.isPDF&&sCH.learnEntitySectionsMetaC.validSectionLength>1,sectionTitleForMultiSection:e})),sCH.readerConfig.dataCurrentSectionMode&&"currentSection"===sCH.readerConfig.dataCurrentSectionMode&&this.$el.find(".btnToggleCurrentSection").toggleClass("selected")},studentRender:function(){this.$el.html(this.template({userRole:"student",showCurrentSectionToggle:!1}))},showByStudent:function(){var e=parseInt(this.$el.find("select.ddlStudents").val());-1!==e?(this.reader.dataView.scroll.showByStudent(e),sCH.readerConfig.selectedStudentUserId=e):(this.reader.dataView.scroll.showByAssignment(),sCH.readerConfig.selectedStudentUserId=-1),Backbone.pubEv.trigger("toggleTags")},dataPanelNeedsRefresh:function(e){e.textSectionId&&e.textSectionId!==sCH.readerConfig.currentSectionId||this.$el.find(".btnRefresh").addClass("needsRefresh")},refreshData:function(){this.$el.find(".btnRefresh").removeClass("needsRefresh"),Backbone.pubEv.trigger("refreshAssignmentData")},exportData:function(e){var t=$(e.currentTarget).data("reporttype");Backbone.pubEv.trigger("exportAssignmentData",{reportType:t})},toggleCurrentSection:function(e){var t=$(e.currentTarget);this.$el.find(".btnToggleCurrentSection").removeClass("selected"),t.addClass("selected"),this.reader.dataView.scroll.toggleCurrentSection(t.data("filter"))},destroy:function(){this.undelegateEvents(),Backbone.pubEv.off("dataPanelNeedsRefresh")}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="panelHeader">\n  <aside class="dataview" aria-label="assignment data option"></aside>\n</div>\n<div class="results"></div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",_.each(vocabLookups,(function(e,t){__p+='\n    <ul class="banner '+(null==(__t=t>=14?"paged":"")?"":__t)+' vocabList">\n        <li class="label dropdown dropup">\n            <div class="wordContainer" data-toggle="dropdown">\n                <span>'+(null==(__t=cH.sanitize(e.word))?"":__t)+'</span>\n                <span class="count boldRight pull-right">'+(null==(__t=e.lookupCount)?"":__t)+'</span>\n            </div>\n            <ul class="dropdown-menu">\n                <li class="dropdown-header">View Word in Text</li>\n                <li role="separator" class="divider"></li>\n                ',_.each(e.uniquePositionLookups,(function(e){__p+='\n                    <li class="label"\n                        data-textsectionid="'+(null==(__t=e.TextSectionId)?"":__t)+'"\n                        data-startindex="'+(null==(__t=e.StartIndex)?"":__t)+'"\n                        data-endindex="'+(null==(__t=e.EndIndex)?"":__t)+'"\n                        data-word="'+(null==(__t=e.Word)?"":__t)+'">\n                        '+(null==(__t=cH.sanitize(e.dropdownDisplayString))?"":__t)+"\n                    </li>\n                "})),__p+="\n            </ul>\n        </li>\n    </ul>\n"})),__p+="\n",vocabLookups.length>14&&(__p+='\n    <button class="btn-box showall">Show all</button>\n'),__p+="";return __p}},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(129),r=n(170),l=n(43);t.default=Backbone.View.extend({events:{"click .btnClose":"destroy","click .btnPlayDefinition":"playDefinition","click #btnSearchDefinition":"getNewDefinition","keypress #txtDefineNewWord":"getNewDefinitionByEnter","click .image img":"showImageInPopup"},template:n(1882),initialize:function(e){a.each([":",";","'",".","?","!",",",'"',"(",")","{","}","[","]"],(function(t,n){e.word=e.word.replace(t,"")}));for(var t="",n=0;n<e.word.length;n++)e.word.charCodeAt(n)<=127&&(t+=e.word.charAt(n));this.word=t,this.inQuestionOrNote=e.inQuestionOrNote||!1,this.startIndex=e.startIndex,this.endIndex=e.endIndex,Backbone.pubEv.on("definition_destroy",this.destroy,this)},render:function(){var e=this;this.$el.addClass("definition").html(this.template({ie:l.msie})),s.addMediumZIndex(this.$el),this.word&&0!==this.word.length?i.GetDefinition({word:this.word,inQuestionOrNote:this.inQuestionOrNote,textSectionId:sCH.readerConfig.currentSectionId,assignmentId:sCH.readerConfig.assignmentId,layerId:sCH.readerConfig.layerId,studentLayerId:sCH.readerConfig.studentLayerId,startIndex:this.startIndex,endIndex:this.endIndex,isUserEntered:this.isUserEntered},(function(t){try{if(t.definitions.length>0){e.$el.find(".word").html(t.headword),e.$el.find(".partofspeech").html(t.partofspeech);var n=t.definitions.map((function(e,t){var n="<ul class='examples'>"+e.examples.slice(0,4).map((function(e){return"<li>"+e+"</li>"})).join("")+"</ul>";return'<li>\n                <div class="num">'+(t+1)+".</div>\n                <div class='text'>"+e.text+n+"</div>\n              </li>"}));e.$el.find(".definitions").append(n),t.audioUrl?e.$el.find(".btnPlayDefinition").data("audiofile",t.audioUrl).css("display","inline-block"):e.$el.find(".btnPlayDefinition").hide(),t.imageUrl?e.$el.find(".image").html('<img src="'+t.imageUrl+'" />').show():e.$el.find(".image").html("").hide(),e.show(),r.trigger({type:"treasureChest"})}else e.fillElOnError(t.wordLookedUp),e.show()}catch(n){e.fillElOnError(t.wordLookedUp),e.show()}})):s.bootstrap.alert({message:"The word you selected is invalid. Please try again.",alert:"danger"})},showImageInPopup:function(e){var t=$(this.$el.find(".image").html());t.css("width","100%");var n=$("<div />");n.html(t),new Backbone.BootstrapModal({content:n.html(),okText:"Close",cancelText:!1}).open()},getNewDefinition:function(e){e.stopPropagation();var t=this.$el.find("#txtDefineNewWord").val().trim();0!==t.length&&(t.indexOf(" ")>-1?s.bootstrap.alert({message:"Please enter a single word to define."}):(this.word=t,this.inQuestionOrNote=!0,this.isUserEntered=!0,this.startIndex=this.endIndex=null,this.render()))},getNewDefinitionByEnter:function(e){13===(e.keyCode||e.which)&&this.getNewDefinition(e)},show:function(){if($("main.scroll .textview.view").append(this.$el),0===$(".scroll .lrContainer > div.right").width()?(this.$el.addClass("bottom"),$(".readerpanel.next").addClass("bottomPopupOpened"),sCH.readerConfig.isPDF||this.$el.css({left:$(".scroll .textSectionContainer").offset().left})):this.$el.removeClass("bottom"),this.$el.show(),"tour"===sCH.readerConfig.type){if(!o.isActionCurrentStep("student reading aid1")&&!o.isActionCurrentStep("student reading aid2"))return void o.blinkStepNumber();o.advance()}},fillElOnError:function(e){var t='<a target="_blank" href="https://www.google.com/search?q=define:'+(e=s.sanitize(e))+'"><em>'+e+"</em></a>";this.$el.find(".word").html(e),this.$el.find(".partofspeech").html(""),this.$el.find(".btnPlayDefinition").hide(),this.$el.find(".definitions").append("<li>No definitions found. Search "+t+" on Google.</li>")},playDefinition:function(e){window.open($(e.currentTarget).data("audiofile"))},destroy:function(){this.$el.unbind(),s.clearSearchHighlights(),Backbone.pubEv.off("definition_destroy",this.destroy,this),$(".definition.bottom").length>0&&$(".readerpanel.next").removeClass("bottomPopupOpened"),this.$el.remove()}})},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(842),o=n(5),r=n(8),l=(0,n(13).withStyles)((function(e){return{container:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",fontFamily:"AvenirNextLTW02-Medium"},imageAuthor:{display:"flex",alignItems:"center"},link:{marginLeft:10,color:"#03A9F4",textDecoration:"underline"},byline:{marginLeft:10},license:{textAlign:"right"},licenseHelperText:{position:"relative",top:-2}}})),d=function(e){var t=e.classes;return s.createElement("div",{className:t.container,onClick:function(){return h(e.contentUrl,e.source)}},s.createElement(u,a({},e)),s.createElement("div",null,e.permissionsText||"Posted with permission"),s.createElement(p,a({},e)))},c=function(e){var t=e.classes,n=e.addLicenseInfoText?i.ccInfo.find((function(t){return t.name===e.license})).infoText.format(e.publisherName):null;return s.createElement("div",{className:t.container,onClick:function(){return h(e.contentUrl,e.source)}},s.createElement(u,a({},e)),!!e.license&&s.createElement("div",{className:t.license},s.createElement("span",{className:t.licenseHelperText},"Licensed under"),s.createElement("a",{className:t.link,href:"http://creativecommons.org/licenses/"+e.license+"/"},s.createElement("img",{title:n,alt:n,src:"https://licensebuttons.net/l/"+e.license+"/80x15.png"}))),s.createElement(p,a({},e)))},u=function(e){return s.createElement("div",{className:e.classes.imageAuthor},e.logoUrl&&s.createElement("img",{alt:e.publisherName,src:e.logoUrl}),s.createElement("div",{className:e.classes.byline},!1===e.showAuthor?" "+e.publisherName:"Text by "+o.htmlDecode(e.author)),!!e.termsUrl&&s.createElement("a",{className:e.classes.link,href:e.termsUrl},"Terms of Use"))},p=function(e){var t=o.classNames({displayNone:"The Conversation"===e.publisherName});return e.extraInfo?s.createElement("div",{className:t,dangerouslySetInnerHTML:{__html:e.extraInfo}}):null},h=function(e,t){-1===["Box","TextsManager","license.icopyright.net"].indexOf(t)&&o.windowOpen(e,"_blank")};t.default=l((function(e){var t=e.publisherName,n=r.cloneDeep(i.attributionInfo).find((function(e){return t.includes(e.publisherName)}));if(n){if("The Conversation"===t){var o=parseInt(e.contentUrl.split("-").pop());n.extraInfo=isNaN(o)?void 0:n.extraInfo.format(o)}switch(n.template){case"NonCC":return s.createElement(d,a({},n,e));case"cc":return s.createElement(c,a({},n,e))}}return null}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ccInfo=[{name:"by-nc/3.0",infoText:"{0} is licensed under Creative Commons AttributionNonCommercial 3.0 Unported (CC BY-NC 3.0)"}],t.attributionInfo=[{publisherName:"Newsweek",logoUrl:"https://images.activelylearn.com/attribution/Newsweek.png",template:"NonCC"},{publisherName:"redOrbit",logoUrl:"https://images.activelylearn.com/attribution/redOrbit.png",template:"NonCC"},{publisherName:"iDigitalTimes",logoUrl:"https://images.activelylearn.com/attribution/iDigitalTimes.png",template:"NonCC"},{publisherName:"International Business Times",logoUrl:"https://images.activelylearn.com/attribution/IBT.png",template:"NonCC"},{publisherName:"Medical Daily",logoUrl:"https://images.activelylearn.com/attribution/MedicalDaily.png",template:"NonCC"},{publisherName:"Al Jazeera",logoUrl:"https://images.activelylearn.com/attribution/AlJazeera.png",template:"NonCC"},{publisherName:"Wait But Why",logoUrl:"https://images.activelylearn.com/attribution/WaitButWhy.png",template:"NonCC"},{publisherName:"FactCheck",logoUrl:"https://images.activelylearn.com/attribution/FactCheck.png",template:"NonCC"},{publisherName:"Chicago Tribune",logoUrl:"https://images.activelylearn.com/attribution/ChicagoTribune.png",template:"NonCC"},{publisherName:"Baltimore Sun",logoUrl:"https://images.activelylearn.com/attribution/BaltimoreSun.png",template:"NonCC"},{publisherName:"Los Angeles Times",logoUrl:"https://images.activelylearn.com/attribution/LosAngelesTimes.png",template:"NonCC"},{publisherName:"Seattle Times",logoUrl:"https://images.activelylearn.com/attribution/SeattleTimes.png",template:"NonCC"},{publisherName:"Charlotte Observer",logoUrl:"https://images.activelylearn.com/attribution/CharlotteObserver.png",template:"NonCC"},{publisherName:"Dallas Morning News",logoUrl:"https://images.activelylearn.com/attribution/DallasMorningNews.png",template:"NonCC"},{publisherName:"Detroit Free Press",logoUrl:"https://images.activelylearn.com/attribution/DetroitFreePress.png",template:"NonCC"},{publisherName:"Euronews",logoUrl:"https://images.activelylearn.com/attribution/Euronews.png",template:"NonCC"},{publisherName:"Financial Post",logoUrl:"https://images.activelylearn.com/attribution/FinancialPost.png",template:"NonCC"},{publisherName:"GlobalPost",logoUrl:"https://images.activelylearn.com/attribution/GlobalPost.png",template:"NonCC"},{publisherName:"Latin Times",logoUrl:"https://images.activelylearn.com/attribution/LatinTimes.png",template:"NonCC"},{publisherName:"McClatchy Washington Bureau",logoUrl:"https://images.activelylearn.com/attribution/McClatchyWashingtonBureau.png",template:"NonCC"},{publisherName:"Miami Herald",logoUrl:"https://images.activelylearn.com/attribution/MiamiHerald.png",template:"NonCC"},{publisherName:"National Post",logoUrl:"https://images.activelylearn.com/attribution/NationalPost.png",template:"NonCC"},{publisherName:"NJ.com",logoUrl:"https://images.activelylearn.com/attribution/NJcom.png",template:"NonCC"},{publisherName:"Orlando Sentinel",logoUrl:"https://images.activelylearn.com/attribution/OrlandoSentinel.png",template:"NonCC"},{publisherName:"Philadelphia Inquirer",logoUrl:"https://images.activelylearn.com/attribution/PhiladelphiaInquirer.png",template:"NonCC"},{publisherName:"PR Newswire",logoUrl:"https://images.activelylearn.com/attribution/PRNewswire.png",template:"NonCC"},{publisherName:"San Jose Mercury News",logoUrl:"https://images.activelylearn.com/attribution/SanJoseMercuryNews.png",template:"NonCC"},{publisherName:"Star Tribune",logoUrl:"https://images.activelylearn.com/attribution/StarTribune.png",template:"NonCC"},{publisherName:"Toronto Star",logoUrl:"https://images.activelylearn.com/attribution/TorontoStar.png",template:"NonCC"},{publisherName:"Tribune Washington Bureau",logoUrl:"https://images.activelylearn.com/attribution/TribuneWashingtonBureau.png",template:"NonCC"},{publisherName:"Washington Times",logoUrl:"https://images.activelylearn.com/attribution/WashingtonTimes.png",template:"NonCC"},{publisherName:"Ensia",logoUrl:"https://images.activelylearn.com/attribution/Ensia.png",template:"NonCC"},{publisherName:"The Associated Press",logoUrl:"https://images.activelylearn.com/attribution/TheAssociatedPress.png",template:"NonCC",permissionsText:"The Associated Press contributed to this story."},{publisherName:"ZME Science",logoUrl:"https://images.activelylearn.com/attribution/ZMEScience.png",template:"NonCC"},{publisherName:"Philippines Daily Inquirer",logoUrl:"https://images.activelylearn.com/attribution/PhilippinesDailyInquirer.png",template:"NonCC"},{publisherName:"Center for Civic Education",logoUrl:"https://images.activelylearn.com/attribution/CenterforCivicEducation.png",template:"NonCC"},{publisherName:"Science News for Students",logoUrl:"https://images.activelylearn.com/attribution/ScienceNewsForStudents.png",template:"NonCC"},{publisherName:"Curiosity.com",logoUrl:"https://images.activelylearn.com/attribution/Curiosity.png",template:"NonCC"},{publisherName:"BBC News",logoUrl:"https://images.activelylearn.com/attribution/BBCNews.png",template:"NonCC"},{publisherName:"Harvard Gazette",logoUrl:"https://images.activelylearn.com/attribution/HarvardGazette.png",template:"NonCC"},{publisherName:"Teaching Tolerance Project",logoUrl:"https://images.activelylearn.com/attribution/TeachingToleranceProject.png",extraInfo:"Reprinted with permission of Teaching Tolerance, a project of the Southern Poverty Law Center. www.tolerance.org",template:"NonCC"},{publisherName:"Corporate Knights",logoUrl:"https://images.activelylearn.com/attribution/CorporateKnights.png",template:"cc",license:"by-nd/4.0"},{publisherName:"Mosaic of Science",logoUrl:"https://images.activelylearn.com/attribution/Mosaic.png",template:"cc",license:"by-nd/4.0"},{publisherName:"PLOS",logoUrl:"https://images.activelylearn.com/attribution/PLOS.png",template:"cc",license:"by-nd/4.0"},{publisherName:"USHistory.org",logoUrl:"https://images.activelylearn.com/attribution/USHistoryOrg.png",template:"cc",license:"by-nd/4.0"},{publisherName:"New Visions",logoUrl:"https://images.activelylearn.com/attribution/NewVisions.png",template:"cc",license:"by-nd/4.0"},{publisherName:"Folger Shakespeare Library",logoUrl:"https://images.activelylearn.com/attribution/FolgerShakespeareLibrary.png",template:"cc",license:"by-nd/4.0"},{publisherName:"The British Library",logoUrl:"https://images.activelylearn.com/attribution/TheBritishLibrary.png",template:"cc",license:"by-nd/4.0"},{publisherName:"Public Radio International",logoUrl:"https://images.activelylearn.com/attribution/PublicRadioInternational.png",template:"cc",license:"by/3.0"},{publisherName:"ProPublica",logoUrl:"https://images.activelylearn.com/attribution/ProPublica.png",template:"cc",license:"by/3.0"},{publisherName:"Global Voices",logoUrl:"https://images.activelylearn.com/attribution/GlobalVoices.png",template:"cc",license:"by/3.0"},{publisherName:"Robohub",logoUrl:"https://images.activelylearn.com/attribution/Robohub.png",template:"cc",license:"by/3.0"},{publisherName:"EL Education",logoUrl:"https://images.activelylearn.com/attribution/ELEducation.png",template:"cc",license:"by/3.0"},{publisherName:"Core Knowledge",logoUrl:"https://images.activelylearn.com/attribution/CoreKnowledge.png",template:"cc",license:"by/3.0"},{publisherName:"MercatorNet",logoUrl:"https://images.activelylearn.com/attribution/MercatorNet.png",template:"cc",license:"by-nc-nd/3.0"},{publisherName:"Kaiser Health News",logoUrl:"https://images.activelylearn.com/attribution/KaiserHealthNews.png",extraInfo:"<a href='http://www.kaiserhealthnews.org/'>Kaiser Health News (KHN)</a>is a nonprofit national health policy news service.",template:"cc",license:"by/4.0"},{publisherName:"CK-12",logoUrl:"http://img3.ck12.org/media/images/logo_ck12.png",extraInfo:"Questions have been modified from original.",termsUrl:"http://www.ck12.org/about/terms-of-use/",showAuthor:!1,addLicenseInfoText:!0,template:"cc",license:"by-nc/3.0"},{publisherName:"The Conversation",logoUrl:"https://images.activelylearn.com/attribution/TheConversation.png",extraInfo:"<img src='https://counter.theconversation.com/content/{0}/count.gif?distributor=republish-lightbox-advanced' width='1' height='1' />",template:"cc",license:"by-nd/4.0"},{publisherName:"Ancient History Encyclopedia",logoUrl:"https://images.activelylearn.com/attribution/AncientHistoryEncyclopedia.png",template:"cc",license:"by-nc-sa/3.0"},{publisherName:"Common Dreams",logoUrl:"https://images.activelylearn.com/attribution/CommonDreams.png",template:"cc",license:"by-nc-sa/3.0"},{publisherName:"ConstitutionCenter.org",logoUrl:"https://images.activelylearn.com/attribution/ConstitutionCenter.png",template:"cc",license:"by-nc-nd/4.0"},{publisherName:"Hastac Mag",logoUrl:"https://images.activelylearn.com/attribution/HastacMag.png",template:"cc",license:"by-nc-sa/3.0"},{publisherName:"The Free Press",logoUrl:"https://images.activelylearn.com/attribution/TheFreePress.png",template:"cc",license:"by-nc-sa/3.0"},{publisherName:"Jewish Virtual Library",logoUrl:"https://images.activelylearn.com/attribution/JewishVirtualLibrary.png",template:"cc"},{publisherName:"Chalkbeat",logoUrl:"https://images.activelylearn.com/attribution/Chalkbeat.png",template:"cc"},{publisherName:"Fordham University",logoUrl:"https://images.activelylearn.com/attribution/FordhamUniversity.png",template:"cc"},{publisherName:"The Guardian",logoUrl:"https://images.activelylearn.com/attribution/TheGuardian.png",template:"NonCC"},{publisherName:"The Nobel Foundation",logoUrl:"https://images.activelylearn.com/attribution/TheNobelFoundation.png",template:"NonCC"},{publisherName:"CollegeXpress",logoUrl:"https://images.activelylearn.com/attribution/CollegeXpress.png",template:"NonCC"},{publisherName:"ProCon.org",logoUrl:"https://images.activelylearn.com/attribution/ProCon.png",template:"NonCC"},{publisherName:"Public Domain Review",logoUrl:"https://images.activelylearn.com/attribution/PublicDomainReview.png",extraInfo:"Originally published in The Public Domain Review under a Creative Commons Attribution-ShareAlike 3.0.",template:"cc",license:"by-sa/3.0"},{publisherName:"United States Holocaust Memorial Museum",logoUrl:"https://images.activelylearn.com/attribution/USHMM.png",template:"NonCC"},{publisherName:"Owlcation",logoUrl:"https://images.activelylearn.com/attribution/Owlcation.png",extraInfo:"Originally from Owlcation",template:"NonCC"},{publisherName:"PhET",logoUrl:"https://images.activelylearn.com/attribution/PhET.png",extraInfo:"PhET Interactive Simulations<br>University of Colorado Boulder",template:"NonCC"},{publisherName:"Seventeen Moments in Soviet History",logoUrl:"https://images.activelylearn.com/attribution/SMISH.png",template:"cc",license:"by-nd/4.0"},{publisherName:"Stanford University Press",logoUrl:"https://images.activelylearn.com/attribution/StanfordUniversityPress.png",template:"cc",license:"by-nd/4.0"},{publisherName:"writersinspire.org",logoUrl:"https://images.activelylearn.com/attribution/WritersInspire.png",template:"cc",license:"by-nc-sa/2.0/uk"},{publisherName:"The Poe Museum",logoUrl:"https://images.activelylearn.com/attribution/ThePoeMuseum.png",template:"NonCC"},{publisherName:"British Library",logoUrl:"https://images.activelylearn.com/attribution/BritishLibrary.png",template:"cc",license:"by-nd/4.0"},{publisherName:"HASPI",logoUrl:"https://images.activelylearn.com/attribution/HASPI.png",template:"cc",license:"by-nc-sa/4.0"},{publisherName:"SAPIENS CC",logoUrl:"https://images.activelylearn.com/attribution/Sapiens.png",template:"cc",license:"by-nd/4.0"},{publisherName:"SAPIENS Individual License",logoUrl:"https://images.activelylearn.com/attribution/Sapiens.png",template:"NonCC"},{publisherName:"Actively Learn Adaptation of Wikipedia",logoUrl:"https://images.activelylearn.com/attribution/Wikipedia.png",extraInfo:"This article was heavily remixed, adapted, and fact-checked by a team of editors and subject-matter-experts.",template:"cc",license:"by-nd/4.0"},{publisherName:"ChemMatters",logoUrl:"https://images.activelylearn.com/attribution/ChemMatters.png",template:"NonCC"},{publisherName:"ThoughtCo",logoUrl:"https://images.activelylearn.com/attribution/ThoughtCo.png",template:"NonCC"},{publisherName:"History News Network",logoUrl:"https://images.activelylearn.com/attribution/HNH.png",extraInfo:"History News Network of George Washington University is committed to sharing information broadly and allows republishing of most of their original content.",template:"NonCC"},{publisherName:"The Pew Research Center",logoUrl:"https://images.activelylearn.com/attribution/PewResearchCenter.png",extraInfo:"Pew Research Center published the original report but has not reviewed or approved this adaptation.",template:"NonCC"},{publisherName:"The Atlantic",logoUrl:"https://images.activelylearn.com/attribution/TheAtlantic.png",extraInfo:"Republished through the Copyright Clearing Center with permission from The Atlantic.",template:"NonCC"},{publisherName:"The New York Times",logoUrl:"https://images.activelylearn.com/attribution/NewYorkTimes.png",extraInfo:"Republished through the Copyright Clearing Center with permission from The New York Times.",template:"NonCC"},{publisherName:"Library of Congress",logoUrl:"https://images.activelylearn.com/attribution/LibraryofCongress.png",extraInfo:"Licensed for worldwide use and reuse under CC0 1.0 Universal.",template:"NonCC"}]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(14),i=n(5),o=n(22),r=n(266),l=n(85),d=n(167),c=n(5),u=n(1138),p=n(688),h=n(24),g=n(0),f=n(11),m=n(1143),v=n(43);n(1908),window.cH=i,window.sCH=r,window.alcfg=u.default;var b=n(1909),C=n(1914),y=n(1917),_=n(20);n(1918),Backbone.BootstrapModal=n(1919),$(document).ready((function(){if(!navigator.cookieEnabled){var e="";return v.chrome?e="https://support.google.com/accounts/answer/61416":v.msie?e="http://windows.microsoft.com/en-US/windows-vista/Block-or-allow-cookies":v.firefox?e="https://support.mozilla.org/en-US/kb/enable-and-disable-cookies-website-preferences":v.ios?e="https://support.apple.com/en-us/HT201265":v.safari&&(e="https://support.apple.com/kb/PH19214"),new Backbone.BootstrapModal({title:"Enable cookies",content:'<p>Your browser is blocking cookies. Please enable cookies and refresh this page.</p><p><a style="color:#03A9F4" target="_blank" href="'+e+'">How to enable cookies in '+v.name+"</a></p>",cancelText:!1,allowCancel:!1,showFooter:!1}).open(),void $("#loading").html("").css({height:"auto",top:"-100px",color:"transparent"})}if("staging"===_.default.env){if($("#environment").text("Staging").addClass("show"),$("#environment").click((function(){var e=this;$(this).removeClass("show"),setTimeout((function(){$(e).addClass("show")}),5e3)})),window.version){var t=window.version.split("+"),n=t[0],u=parseInt(t[1]);$("#environment").append('<span class="version"> v'+n+"<br/>"+moment.utc(u).format("DD-MMM HH:mm:ss")+"</span>")}}else{var p=document.getElementById("environment");p&&p.parentNode.removeChild(p)}!function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],a=n.length,s=window.console=window.console||{};a--;)s[e=n[a]]||(s[e]=t)}(),window.ActivelyRead={Reader:{type:!1}},String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))}),Number.prototype.toSystemDefaultLocaleString||(Number.prototype.toSystemDefaultLocaleString=function(){return this.toLocaleString(c.getSystemLocale())}),String.prototype.replaceAll||(String.prototype.replaceAll=function(){for(var e=arguments[0],t=arguments[1],n=null!=this?this.toString():"",a=0;a<n.length;)n.substring&&n.substring(a,a+e.length)==e?(n=n.substring(0,a)+t+n.substring(a+e.length,n.length),a+=t.length):a++;return n}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var a=arguments[1],s=0;s<n;){var i=t[s];if(e.call(a,i,s,t))return s;s++}return-1},configurable:!0,writable:!0}),Backbone.pubEv=a.extend({},Backbone.Events),Backbone.Model.prototype.originalGet=Backbone.Model.prototype.get,Backbone.Model.prototype.get=function(e,t){return"function"!=typeof this["fix"+e+"Field"]||t?this.originalGet(e):this["fix"+e+"Field"]()},Backbone.Model.prototype.initialize=function(e,t){var n=this,s=a.result(this,"defaults");e&&a.each(s,(function(t,a){null===e[a]&&(n.attributes[a]=t)}))},Backbone.View.prototype.close=function(e){var t=!1!==e;if(void 0!==this){if(this.$el&&o.unmountAllChildReactComponentsUnderParent(this.$el),this.childViews)for(var n=0;n<this.childViews.length;n++)this.childViews[n].close&&this.childViews[n].close();this.undelegateEvents(),this.destroy&&this.destroy(),this.$el.removeData().unbind(),this.unbind(),t&&this.$el.empty()}},$.xhrPool={},$.xhrPool.abortAll=function(){var e=this;$.each(e,(function(t,n){"object"==typeof n&&t!==window.location.hash&&($(e[t]).each((function(e,t){window.clearTimeout(t.showLoadingTimer||t.timer),t.abort()})),$.xhrPool[t].length=0)}))},$.ajaxSetup({cache:!1}),$.timeouts=[],$.intervals=[],$.timeouts.abortAll=function(){$(this).each((function(e,t){window.clearTimeout(t)})),$.timeouts.length=0},$.intervals.abortAll=function(){$(this).each((function(e,t){window.clearInterval(t)})),$.intervals.length=0},$(document).on("click","a",(function(e){if(void 0!==$(this).attr("href")){var t=$(this).attr("href");/https?:\/\//i.test(t)&&t&&"#"!==t&&(e.preventDefault(),i.windowOpen(t))}}));var h=a.debounce((function(){i.adjustHeaderSpacing()}),500);window.addEventListener("resize",h),$("body").on("focus","[contenteditable]",(function(){var e=$(this);return e.data("beforeHeight",e.height()),e})).on("blur keyup paste input","[contenteditable]",(function(){var e=$(this);return e.data("beforeHeight")!==e.height()&&(e.data("beforeHeight",e.height()),e.trigger("changeHeight")),e})),$("body").on("click","ul.checklist div.title",(function(){$(this).siblings(".checkbox").children("label").trigger("click")})),$("body").on("dragover drop","div[contenteditable]",(function(e){return e.preventDefault(),!1})),d.init();try{l.initAppAndCheckAuthentication(null,(function(){f.render(g.createElement(m.default),document.getElementById("root")),Backbone.router=new b.default,$(window).on("hashchange",Backbone.router.hashChange),Backbone.notificationHelper=C,Backbone.tracking=y,Backbone.emulateHTTP=!0,Backbone.history.start(),window.isIOSApp&&setTimeout((function(){window.webkit.messageHandlers.general.postMessage("app loaded")}),1e3),$("#loading").remove(),setTimeout((function(){return $("#root").removeClass("preload")}),1e3),i.adjustHeaderSpacing(),!(r.userM.get("IsMasquerading")||!1!==r.userM.isAnonUser()||"student"===r.userM.get("Role")||r.userM.get("Title")&&r.userM.get("GradeLevelId")&&r.userM.get("SubjectId")&&(r.userM.get("Source")!==s.UserAccountSource.ACHIEVE3K||r.userM.get("EducatorType")&&r.userM.get("Origin")))&&window.setTimeout(S,500)}))}catch(e){console.log(e),rg4js("send",{error:e}),window.location.reload(!0)}}));var S=function(){h.showModalFromBackbone(p.default,{modalTitle:"Hi "+r.userM.get("FirstName")+"!",shouldGet:{title:!r.userM.get("Title"),gradeLevelId:!r.userM.get("GradeLevelId"),subjectId:!r.userM.get("SubjectId"),educatorType:r.userM.get("Source")===s.UserAccountSource.ACHIEVE3K&&!r.userM.get("EducatorType"),origin:r.userM.get("Source")===s.UserAccountSource.ACHIEVE3K&&!r.userM.get("Origin")}})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(14),i=n(445),o=n(8),r=n(44),l=n(20);t.default=Backbone.Model.extend({defaults:function(){return{Name:"",Title:"",ImageUrl:"",Role:"",Url:"",UserId:alcfg.anonUserId,UserName:"",Email:"",EducatorType:"",SchoolInfo:{State:"WA"},Settings:[],UserPermissions:{},BITeacherStatusBySchool:null,primaryDistrictId:""}},sync:r.default,fixNameField:function(){return a.sanitize(this.get("Name",!0))},fixImageUrlField:function(){return a.sanitize(this.get("ImageUrl",!0))},getSetting:function(e){return o.filter(this.get("Settings"),{SettingKey:e})[0]},showPopup:function(e){if(this.isALDemoUser()||this.get("DemoAccount"))return!1;var t=this.getSetting("popupsToNotShow");return!t||-1===t.Settings.indexOf(e)},getSourceString:function(){var e="";switch(Object.keys(this.get("Accounts"))[0]){case"native":e="Native";break;case"google":e="Google";break;case"edmodo":e="Edmodo";break;case"clever":e="Clever"}return e},getPlanString:function(e){var t="";switch(this.get("currentPlan")){case 0:t="Free";break;case 1:t="Personal";break;case 2:case 3:t="Prime";break;case 4:t=e?"Prime Covid":"Prime"}return"student"!==this.get("Role")&&this.get("contentCreditsInfo").isUnlimited&&(t="Unlimited"),t},isOnFreePlan:function(){return 0===this.get("currentPlan")},isOnFreeOrPersonalPlan:function(){return 0===this.get("currentPlan")||1===this.get("currentPlan")},isOnFullPrimePlan:function(){return[3,4].indexOf(this.get("currentPlan"))>=0},isOnPrimePlan:function(){return"student"===this.get("Role")?sCH.classesC.where({IsOnPrimePlan:1}).length>0:[2,3,4].indexOf(this.get("currentPlan"))>=0},shouldHidePaidTexts:function(){return!this.isOnPrimeUnlimited()&&this.get("shouldHidePaidText")},isUserCovidPrime:function(){return!sCH.userM.isAnonUser()&&sCH.userM.get("shouldShowCovidPrimeExpiryMessage")},getPrimePlanScope:function(){return this.isOnPrimePlan()&&this.getPrimarySchool().DistrictId?"district":"school"},getLibraryString:function(){return a.capitalizeString(this.getPrimePlanScope())+" Library"},hasBookCredits:function(){return sCH.userM.get("NumBookCredits").TimesGiven>0},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))},set3rdPartyInfo:function(){var e=this;if(rg4js("setUser",{identifier:this.get("UserId")+(this.get("IsMasquerading")?" | MASQUERADING":""),isAnonymous:!1}),"local"!==l.default.env&&this.get("Role")){var t="student"!==this.get("Role")&&!l.default.isMath,n=("student"!==this.get("Role")||l.default.isMath)&&!this.get("IsMasquerading"),o=("student"!==this.get("Role")||this.get("IntercomTrial"))&&!this.get("IsMasquerading")&&!(this.isALDemoUser()||this.get("DemoAccount"));if(t)try{var r=document.createElement("script");r.type="text/javascript",r.src="https://js.stripe.com/v2/",document.body.appendChild(r)}catch(e){rg4js("send",{error:new Error("Failed loading stripe js")})}if(n)try{i.injectFullStory(),window.FS.identify(null!==this.get("TeacherUserId")?this.get("TeacherUserId"):this.get("UserId").toString(),{displayName:this.get("Name"),email:this.get("UserName")});var d=this.getPrimarySchool();window.FS.setUserVars({displayName:this.get("Name"),email:this.get("UserName"),schoolId_int:d?d.SchoolId:null,schoolName_str:d?d.Name:null,source_str:this.getSourceString(),plan_str:this.getPlanString(!0),subject_str:this.get("SubjectId")?s.UserSubjects.find((function(t){return t.value===e.get("SubjectId")})).label:"NULL",gradelevel_str:this.get("GradeLevelId")?["Grade 2-3","Grade 4-5","Grade 6-8","Grade 9-12"][this.get("GradeLevelId")]:"NULL",role_str:this.get("Role")})}catch(e){}if(o)try{!function(){var e=window,t=e.Intercom;if("function"==typeof t)t("reattach_activator"),t("update",window.intercomSettings);else{var n=document,a=function(){a.c(arguments)};a.q=[],a.c=function(e){a.q.push(e)},e.Intercom=a;var s=function(){var e=n.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://widget.intercom.io/widget/"+l.default.intercomKey;var t=n.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)};"complete"===document.readyState?s():e.attachEvent?e.attachEvent("onload",s):e.addEventListener("load",s,!1)}}();var c=sCH.classesC.length||0,u=sCH.classesC.length?sCH.classesC.reduce((function(e,t){return e+t.get("Students").length}),0):0;d=this.getPrimarySchool();a.intercom("boot",{app_id:l.default.intercomKey,user_id:this.get("UserId"),name:this.get("Name"),email:this.getEmail(),created_at:this.get("CreateDate"),Plan:this.getPlanString(!0),EducatorType:this.get("Educator"),Role:this.get("Role"),Source:this.getSourceString(),GradeLevelId:this.get("GradeLevelId"),SubjectId:this.get("SubjectId"),Classes:c,Students:u,"Tour-CurrentStep":-1,company:{id:d?"dadmin"===this.get("Role")?d.DistrictId:d.SchoolId:null,name:d?d.Name:null,created_at:d?d.CreateDate:null,Plan:this.getPlanString(!0),IsHigherEd:this.get("IsHigherEd"),DistrictId:d?d.DistrictId:null}})}catch(e){}}},fill:function(){var e=this;this.fetch({url:alcfg.node.user.get_info,data:{loggingIn:!1},mainSuccess:function(t){if(null!==a.getCookie("deviceId")&&""!==a.getCookie("deviceId")||a.setCookie("deviceId",t.DeviceId),delete t.DeviceId,!e.set(e.parse(t)))return!1}})},updateName:function(e,t){var n=!1;this.get("FirstName")!==e&&(this.set("FirstName",e),n=!0),this.get("LastName")!==t&&(this.set("LastName",t),n=!0),n&&this.set("Name",this.get("FirstName")+" "+this.get("LastName"))},teacherHasAnyAdminPermission:function(){return"teacher"===this.get("Role")&&(this.get("UserPermissions").CanManageUserPermissions||this.get("UserPermissions").CanViewAdminReports||this.get("UserPermissions").CanAddCustomStandards||this.get("UserPermissions").CanManageLibrary)},getEmail:function(){return this.get("UserName")},getPrimarySchool:function(){var e=this.get("SchoolInfo");if(e&&e.length>0){var t=e[0],n=e.find((function(e){return e.DistrictId}));if(n)return n.Name=a.sanitize(n.Name),n;if(t)return t.Name=a.sanitize(t.Name),t}return{SchoolId:133797,Name:"Actively Learn T School",Country:"US",State:"WA",CreateDate:"2014-12-19 17:33:45.796",IsHigherEd:!1}},getCountryCode:function(e){if("local"===l.default.env)e("US");else if(this.get("CountryCode"))e(this.get("CountryCode"));else{var t=this;try{$.ajax({type:"GET",url:"https://api.ipdata.co/country_code?api-key=c9191288310c18ae4ecea914a769aa80ffcb89de18be6dcb924738b3",success:function(n){t.set("CountryCode",n),e(n)},error:function(){var n=t.getPrimarySchool(),a=n&&n.Country||"US";t.set("CountryCode",a),e(a)}})}catch(t){e("US")}}},isALDemoUser:function(){if(this.getEmail()&&this.getPrimarySchool()){var e=-1!==this.getEmail().indexOf("activelylearn")||-1!==sCH.userM.getEmail().indexOf("achieve3000"),t=this.getPrimarySchool().SchoolId===alcfg.demoSchoolId;return e&&t}return!1},isNonALDemoUser:function(){if(this.getEmail()&&this.getPrimarySchool()){var e=-1!==this.getEmail().indexOf("activelylearn")||-1!==sCH.userM.getEmail().indexOf("achieve3000"),t=this.getPrimarySchool().SchoolId===alcfg.demoSchoolId;return!e&&t}return!1},isInUnitsWhitelist:function(){return-1!==alcfg.unitsWhitelistedSchoolIds.indexOf(this.getPrimarySchool().SchoolId)},hasManageLibraryPermissions:function(){return o.includes(["dadmin","admin"],sCH.userM.get("Role"))||sCH.userM.teacherHasAnyAdminPermission()&&sCH.userM.get("UserPermissions").CanManageLibrary},isSchoolUsingContentCredits:function(){return"student"===this.get("Role")?sCH.classesC.where({IsUsingContentCredits:1}).length>0:!!this.get("contentCreditsInfo").isUsing},isOnPrimeUnlimited:function(){return!!this.get("contentCreditsInfo").isUsing&&!!this.get("contentCreditsInfo").isUnlimited},isPLAssignment:function(){return"student"===sCH.readerConfig.type&&"student"!==this.get("Role")},isAnonUser:function(){return sCH.userM.get("UserId")===alcfg.anonUserId},hasMasqueradePermission:function(){return"student"!==sCH.userM.get("Role")&&sCH.userM.get("Accounts").google&&sCH.userM.get("UserName").endsWith("@activelylearn.com")&&(sCH.userM.get("UserPermissions")||{}).CanMasquerade&&!sCH.userM.get("IsMasquerading")},hasUploadOneTimeRosteringCSVPermission:function(){return"student"!==sCH.userM.get("Role")&&sCH.userM.get("Accounts").google&&sCH.userM.get("UserName").endsWith("@activelylearn.com")&&(sCH.userM.get("UserPermissions")||{}).CanUploadOneTimeRosteringCSV&&!sCH.userM.get("IsMasquerading")},isV2ContentUser:function(){return!0},getNameForNote:function(e,t){if(sCH.readerConfig.isReadOnly){if(this.isAnonUser())return"Actively Learn";if(alcfg.contentTeamUserIds.indexOf(e)>-1)return a.sanitize((this.get("Title")||this.get("FirstName"))+" "+this.get("LastName"))}else if("student"===this.get("Role")&&e===this.get("UserId"))return"Me";return a.sanitize(t)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",introText&&(__p+="\r\n    <p>"+(null==(__t=introText)?"":__t)+"</p>\r\n"),__p+="\r\n",videoId&&(__p+='\r\n    <script charset="ISO-8859-1" src="//fast.wistia.com/assets/external/E-v1.js" async><\/script>\r\n    <div class="wistia_embed wistia_async_'+(null==(__t=videoId)?"":__t)+"\r\n    videoFoam=true autoPlay="+(null==(__t=autoPlay?"true":"false")?"":__t)+'"\r\n    style="width:640px;height:360px;">&nbsp;</div>\r\n'),__p+="\r\n",data&&(__p+='\r\n    <div class="embedMediaFullContainer"></div>\r\n    ',data.mediaAttribution&&(__p+='\r\n        <p class="info">Source: '+(null==(__t=data.mediaAttribution)?"":__t)+"</p>\r\n    "),__p+="\r\n"),__p+="\r\n",videoUrlData&&(__p+='\r\n    <video width="100%" height="auto" controls>\r\n        <source src="'+(null==(__t=videoUrlData.url)?"":__t)+'" type="'+(null==(__t=videoUrlData.type)?"":__t)+'">\r\n    </video>\r\n'),__p+="";return __p}},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1034),initialize:function(){this.on("ok",this.update)},events:{"click .toggler:not(.selected)":"skillBucketChanged"},render:function(){var e=a.find(sCH.userM.get("Settings"),{SettingKey:"defaultNoteCategories"}),t=e?JSON.parse(e.Settings):alcfg.tags.note.noteDefaultColorCategoryMap;return this.$el.html(this.template({data:t})),this.$el.find(".toggler:first").click(),s.initTooltips(this.$el),this},skillBucketChanged:function(e){var t=$(e.currentTarget);this.$el.find(".labelInputContainer .skillbucketList").hide(),this.$el.find("."+t.data("list")).show(),this.$el.find(".toggler").removeClass("selected"),t.addClass("selected")},update:function(e){e.preventClose();var t=a.map(this.$el.find(".labelInputContainer input"),(function(e){return $(e)}));if(s.checkRequiredFields(t))s.bootstrap.alert({alert:"danger",message:"You cannot leave a category blank."});else{e.disableOk("Updating...");var n=JSON.stringify(this.createApiDataObject());i.UpdateNoteCategoryDefaults(n,(function(t){if(t){s.bootstrap.alert({message:"Default note categories updated."});var i=n,o=a.find(sCH.userM.get("Settings"),{SettingKey:"defaultNoteCategories"});o?o.Settings=i:sCH.userM.get("Settings").push({SettingKey:"defaultNoteCategories",Settings:i}),e.close()}else s.bootstrap.alert({alert:"danger",message:'There was an error updating the note categories. If this issue persists,             please <a class="modal-link" href="mailto:help@activelylearn.com">contact us</a> at help@activelylearn.com.'})}))}},createApiDataObject:function(){var e={},t=this;return a.each(a.keys(alcfg.tags.note.noteDefaultColorCategoryMap),(function(n){var s=[],i=t.$el.find("."+t.$el.find(".toggler[data-skillbucketid="+n+"]").data("list"));a.each(i.find("input"),(function(e){var t=$(e);s.push({color:t.data("color").toLowerCase(),category:t.val()})})),e[n]=s})),e}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p>\n    Note: Updating these defaults will not change the categories you have already used in existing assignments.\n</p>\n\n<div class="topNavMenu">\n    <a class="btn-box toggler" data-skillbucketid="1" data-list="literature">Literature</a>\n    <a class="btn-box toggler" data-skillbucketid="2" data-list="infotext">Informational</a>\n    <a class="btn-box toggler" data-skillbucketid="3" data-list="science">Science</a>\n</div>\n\n<div class="labelInputContainer">\n    <div class="literature skillbucketList">\n        ',_.each(data[1],(function(e){__p+='\n            <label class="addNote '+(null==(__t=e.color)?"":__t)+'"></label>\n            <input value="'+(null==(__t=e.category)?"":__t)+'" data-color="'+(null==(__t=e.color)?"":__t)+'" maxlength="20">\n            <div class="clearBoth"></div>\n        '})),__p+='\n    </div>\n    <div class="infotext skillbucketList">\n        ',_.each(data[2],(function(e){__p+='\n            <label class="addNote '+(null==(__t=e.color)?"":__t)+'"></label>\n            <input value="'+(null==(__t=e.category)?"":__t)+'" data-color="'+(null==(__t=e.color)?"":__t)+'" maxlength="20">\n            <div class="clearBoth"></div>\n        '})),__p+='\n    </div>\n    <div class="science skillbucketList">\n        ',_.each(data[3],(function(e){__p+='\n            <label class="addNote '+(null==(__t=e.color)?"":__t)+'"></label>\n            <input value="'+(null==(__t=e.category)?"":__t)+'" data-color="'+(null==(__t=e.color)?"":__t)+'" maxlength="20">\n            <div class="clearBoth"></div>\n        '})),__p+='\n    </div>\n</div>\n\n<div class="clearBoth"></div>';return __p}},,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(326),l=n(170),d=(0,n(13).withStyles)((function(){return{jetpack:{position:"absolute",animationName:"$fly",animationDuration:"5s",animationTimingFunction:"cubic-bezier(0.3, 0.5, 0.2, 1)"},gif:{width:150},talkBubble:i(i({},r.default.talkBubble),{animationName:"$talkBubble",animationDuration:"5s",opacity:0}),"@keyframes fly":{"0%":{left:"0%",bottom:"15%"},"55%, 60%":{left:"75%",bottom:"50%"},"100%":{left:"100%",bottom:"75%"}},"@keyframes talkBubble":{"38%":{opacity:0},"60%":{opacity:1},"70%":{opacity:0}}}})),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationEnded=function(){t.props.onComplete()},t}return s(t,e),t.prototype.componentDidMount=function(){this.ref.addEventListener("animationend",this.animationEnded)},t.prototype.componentWillUnmount=function(){this.ref.removeEventListener("animationend",this.animationEnded)},t.prototype.render=function(){var e=this,t=this.props.classes;return o.createElement("div",{className:t.jetpack,ref:function(t){return e.ref=t}},o.createElement("div",{className:t.talkBubble},l.getNoteEncouragingMessage()),o.createElement("img",{className:t.gif,src:"img/Animation_JetPack.gif"}))},t}(o.Component);t.default=d(c)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(326),l=n(170),d=(0,n(13).withStyles)((function(){return i(i({},r.default),{dance:{position:"absolute",left:"65%",bottom:"50%",animationName:"$appear",animationDuration:"6s",animationTimingFunction:"linear",opacity:0},gif:{width:120},"@keyframes appear":{"17%":{opacity:1},"83%":{opacity:1}}})})),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationEnded=function(){t.props.onComplete()},t}return s(t,e),t.prototype.componentDidMount=function(){this.ref.addEventListener("animationend",this.animationEnded)},t.prototype.componentWillUnmount=function(){this.imgEl.src="",this.imgEl.src="img/Animation_Dance.gif",this.ref.removeEventListener("animationend",this.animationEnded)},t.prototype.render=function(){var e=this,t=this.props.classes;return o.createElement("div",{className:t.dance,ref:function(t){return e.ref=t}},o.createElement("div",{className:t.talkBubble},l.getRandomEncouragingMessage()),o.createElement("img",{className:t.gif,src:"img/Animation_Dance.gif",ref:function(t){return e.imgEl=t}}))},t}(o.Component);t.default=d(c)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=(0,n(13).withStyles)((function(){return{treasureChest:{position:"absolute",right:30,bottom:0,animationName:"$appear",animationDuration:"8s",animationTimingFunction:"linear",opacity:0,zIndex:9999},"@keyframes appear":{"17%":{opacity:1},"83%":{opacity:1}}}})),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationEnded=function(){t.props.onComplete()},t}return s(t,e),t.prototype.componentDidMount=function(){this.ref.addEventListener("animationend",this.animationEnded)},t.prototype.componentWillUnmount=function(){this.imgEl.src="",this.imgEl.src="img/Animation_TreasureChest.gif",this.ref.removeEventListener("animationend",this.animationEnded)},t.prototype.render=function(){var e=this,t=this.props.classes;return i.createElement("div",{className:t.treasureChest,ref:function(t){return e.ref=t}},i.createElement("img",{className:t.gif,src:"img/Animation_TreasureChest.gif",ref:function(t){return e.imgEl=t}}))},t}(i.Component);t.default=o(r)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(326),l=n(170),d=(0,n(13).withStyles)((function(){return{mountain:{bottom:0,top:0,left:0,right:0,background:"rgba(0, 0, 0, 0.56)",position:"absolute",zIndex:9,display:"flex",justifyContent:"center",animationName:"$appear",animationDuration:"7s",animationTimingFunction:"linear",opacity:0},container:{width:400,position:"absolute",bottom:-3},gif:{position:"relative",top:17,left:84,width:200},foundation:{width:"100%"},talkBubble:i(i({},r.default.talkBubble),{animationName:"$talkBubble",animationDuration:"7s",opacity:0,marginBottom:0,marginLeft:40,width:200}),"@keyframes appear":{"17%, 83%":{opacity:1}},"@keyframes talkBubble":{"38%":{opacity:0},"60%, 100%":{opacity:1}}}})),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationEnded=function(){t.props.onComplete()},t}return s(t,e),t.prototype.componentDidMount=function(){this.ref.addEventListener("animationend",this.animationEnded)},t.prototype.componentWillUnmount=function(){this.imgEl.src="",this.imgEl.src="img/Animation_MountainDance.gif",this.ref.removeEventListener("animationend",this.animationEnded)},t.prototype.render=function(){var e=this,t=this.props.classes;return o.createElement("div",{className:t.mountain,ref:function(t){return e.ref=t}},o.createElement("div",{className:t.container},o.createElement("div",{className:t.talkBubble},l.getCompletedMessage()),o.createElement("img",{className:t.gif,src:"img/Animation_MountainDance.gif",ref:function(t){return e.imgEl=t}}),o.createElement("img",{className:t.foundation,src:"img/Animation_Mountain.png"})))},t}(o.Component);t.default=d(c)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(326),l=n(170),d=(0,n(13).withStyles)((function(){return{swimming:{bottom:0,top:0,left:0,right:0,background:"rgba(0, 0, 0, 0.56)",position:"absolute",zIndex:9,animationName:"$appear",animationDuration:"11s",animationTimingFunction:"linear",opacity:0},swimmergif:{animationName:"$fly",animationDuration:"11s",animationTimingFunction:"linear",position:"absolute",bottom:"70%",right:"85%"},fishgif:{position:"absolute",bottom:"10%",right:"5%"},talkBubble:i(i({},r.default.talkBubble),{animationName:"$talkBubble",animationDuration:"11s",opacity:0,marginBottom:0,width:200,position:"absolute",bottom:"45%",right:"15%"}),"@keyframes appear":{"17%":{opacity:1},"83%":{opacity:1}},"@keyframes fly":{"45%, 100%":{bottom:"20%",right:"35%"}},"@keyframes talkBubble":{"38%, 60%":{opacity:0},"100%":{opacity:1}}}})),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationEnded=function(){t.props.onComplete()},t}return s(t,e),t.prototype.componentDidMount=function(){this.ref.addEventListener("animationend",this.animationEnded)},t.prototype.componentWillUnmount=function(){this.imgElSwimmer.src="",this.imgElSwimmer.src="img/Animation_SwimmingSwimmer.gif",this.imgElFish.src="",this.imgElFish.src="img/Animation_SwimmingFish.gif",this.ref.removeEventListener("animationend",this.animationEnded)},t.prototype.render=function(){var e=this,t=this.props.classes;return o.createElement("div",{className:t.swimming,ref:function(t){return e.ref=t}},o.createElement("div",{className:t.talkBubble},l.getCompletedMessage()),o.createElement("img",{className:t.swimmergif,src:"img/Animation_SwimmingSwimmer.gif",ref:function(t){return e.imgElSwimmer=t}}),o.createElement("img",{className:t.fishgif,src:"img/Animation_SwimmingFish.gif",ref:function(t){return e.imgElFish=t}}))},t}(o.Component);t.default=d(c)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(5),l=n(8),d=n(101),c=n(102),u=n(103),p=n(116),h=n(38),g=n(96),f=n(39),m=n(150),v=(0,n(13).withStyles)((function(e){return{dialogRoot:{maxWidth:635},dialogContent:{"& .info":{fontSize:16,lineHeight:"24px",fontFamily:"AvenirNextLTW02-Medium",marginTop:0,"&.gray":{fontSize:14,color:"rgba(0, 0, 0, 0.54)"}}},dialogTitle:{"& h2":{fontFamily:"Avenir Next LT W02 Demi"}},classSelector:{fontFamily:"AvenirNextLTW02-Medium",width:300},classSelectorItem:{fontFamily:"AvenirNextLTW02-Medium",fontSize:16},tableContainer:{overflow:"auto",marginTop:20},tableHeader:{fontFamily:"Avenir Next LT W02 Demi",fontSize:14},studentName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"AvenirNextLTW02-Medium",fontSize:14,display:"inline-block",width:388},dialogActions:{display:"block",textAlign:"right",padding:"0 10px"},learnMoreLink:{marginLeft:5,color:"#03A9F4"},row:{display:"flex",alignItems:"center",padding:6,"&:nth-child(even)":{background:"#FAFAFA"}}}})),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!0,selectedClassId:t.props.selectedClassId||"",studentByClass:{}},t.onClassChange=function(e){var n=e.target.value;t.setState({selectedClassId:n,extraHelpStudents:t.getStrugglingStudentByClass(n)})},t.updateExtraHelpStudents=function(e){return function(){var n=t.state.studentByClass,a=n[t.state.selectedClassId].find((function(t){return t.StudentUserId===e})),s=!!a.IsStruggling;a.FirstName;o.MarkStruggling({isStruggling:!s,studentUserId:e,classId:t.state.selectedClassId},(function(i){if(i){a.IsStruggling=!s,t.setState({studentByClass:n});var o=sCH.classesC.find({ClassId:t.state.selectedClassId}).get("Name"),l=t.state.studentByClass[t.state.selectedClassId].find((function(t){return t.StudentUserId===e})).FirstName+" "+(a.IsStruggling?" has been":" is no longer")+" marked as needing extra help in "+o+".";r.bootstrap.alert({message:l})}}))}},t.onClose=function(){t.setState({open:!1}),t.props.onPopupClose()},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;o.GetStudentsFromAllClasses((function(t){var n=l.groupBy(t,"ClassId");e.setState({studentByClass:n})}))},t.prototype.getStrugglingStudentByClass=function(e){return this.state.studentByClass[e]?l.map(l.filter(this.state.studentByClass[e],"IsStruggling"),"StudentUserId"):[]},t.prototype.render=function(){var e=this.props.classes;return i.createElement(d.default,{open:this.state.open,maxWidth:"md",classes:{paper:e.dialogRoot}},i.createElement(p.default,{classes:{root:e.dialogTitle}},"Designate students who need Extra Help"),i.createElement(u.default,{className:e.dialogContent},i.createElement("p",{className:"info"},alcfg.infoText.generic.extraHelp,i.createElement("a",{className:e.learnMoreLink,href:alcfg.helpArticleLink.extraHelp},"Learn more"),"."),i.createElement(C,{selectedClassId:this.state.selectedClassId,onChange:this.onClassChange,teacherClasses:this.props.teacherClasses,classes:e}),i.createElement("div",{className:e.tableContainer},this.state.selectedClassId&&i.createElement(y,{selectedClassId:this.state.selectedClassId,students:this.state.studentByClass[this.state.selectedClassId],onStudentClick:this.updateExtraHelpStudents,classes:e}))),i.createElement(c.default,null,i.createElement(h.default,{className:"btn btn-primary",color:"primary",onClick:this.onClose},"Close")))},t}(i.Component),C=function(e){var t=e.selectedClassId,n=e.onChange,a=e.teacherClasses,s=e.classes;return a.length>0?i.createElement(g.default,{value:t,onChange:n,displayEmpty:!0,className:s.classSelector},i.createElement(f.default,{value:"",disabled:!0,className:s.classSelectorItem},"Select a class"),a.map((function(e){return i.createElement(f.default,{key:e.ClassId,value:e.ClassId,className:s.classSelectorItem},e.Name)}))):i.createElement("div",{className:"ctaInfo"},"Create a class to start differentiating instruction.")},y=function(e){var t=e.selectedClassId,n=e.students,a=e.onStudentClick,s=e.classes;return n?i.createElement("ul",null,i.createElement("li",{className:s.row},i.createElement("div",{className:s.tableHeader,style:{width:388}},"Name"),i.createElement("div",{className:s.tableHeader,style:{width:180}},"Extra Help")),n.map((function(e){return i.createElement("li",{className:s.row,key:t+"-"+e.StudentUserId,onClick:a(e.StudentUserId)},i.createElement("div",{className:s.studentName},r.sanitize(e.LastName)+(e.LastName?", ":"")+r.sanitize(e.FirstName)),i.createElement(m.default,{checked:!!e.IsStruggling}))}))):i.createElement("div",{className:"ctaInfo"},"No students")};t.default=v(b)},,,,,,,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){for(var color in __p+="",!hasHtml&&sCH.userM.isOnFreePlan()?__p+='\r\n    <a title="Add media" data-placement="left" class="btnBlockAddMedia icon-image-thin"></a>\r\n':__p+='\r\n    <a title="Add media" data-placement="left" class="btnToggleMedia icon-image-thin"></a>\r\n',__p+='\r\n<div class="dropdown categoriesDropdown '+(null==(__t=studentReader?"studentReader":"")?"":__t)+'">\r\n    <a class="btnSelectCategory"\r\n        role="button"\r\n        data-toggle="dropdown"\r\n        aria-haspopup="true"\r\n        aria-expanded="false">Select category<span class="caret"></span></a>\r\n    <ul class="dropdown-menu" aria-labelledby="btnSelectCategory">\r\n        <li value="-1"><a class="categoryItem">Select category</a></li>\r\n        ',noteColorCategoryMap){var categoryObj=noteColorCategoryMap[color];studentReader&&categoryObj.isDeleted||(__p+='\r\n            <li>\r\n                <a data-color="'+(null==(__t=color)?"":__t)+'" class="categoryItem '+(null==(__t=color)?"":__t)+" \r\n                    "+(null==(__t=categoryObj.isDeleted?"deleted":"")?"":__t)+" \r\n                    "+(null==(__t=categoryObj.isCustom?"custom":"")?"":__t)+'" \r\n                    data-state="'+(null==(__t=categoryObj.isDeleted?"deleted":"")?"":__t)+'">\r\n                    <span class="text">\r\n                        '+(null==(__t=categoryObj.category?cH.sanitize(categoryObj.category.trim()):categoryObj.isCustom?"Custom":"")?"":__t)+'\r\n                    </span>\r\n                    <input class="txtCategoryEdit" placeholder="Custom" value="'+(null==(__t=cH.sanitize(categoryObj.category))?"":__t)+'" type="text" maxlength="20"/>   \r\n                    ',(!studentReader||studentReader&&categoryObj.isCustom)&&(__p+='\r\n                        <span class="saveEdit icon-save"></span>\r\n                        <span class="editCategory icon-pencil"></span>\r\n                    '),__p+="\r\n                    ",categoryObj.isCustom||(__p+='<span class="deleteCategory icon-trash"></span>'),__p+="\r\n                    ",studentReader||(__p+='<span class="enableCategory icon-plus"></span>'),__p+="\r\n                </a>\r\n            </li>\r\n        ")}__p+="\r\n        ","authoring"===readerConfig.type&&(__p+='\r\n            <li>\r\n                <a class="btn-box small pull-left btnManageDefaultCategory">Manage Defaults</a>\r\n            </li>\r\n        '),__p+='\r\n    </ul>\r\n</div>\r\n\r\n<div class="noteText" contenteditable="true" placeholder="'+(null==(__t=placeholder)?"":__t)+'"></div>\r\n<div class="clearBoth"></div>\r\n\r\n<div class="noteMediaContainer displayNone">\r\n    <input class="txtMedia" placeholder="Enter image/video URL" />\r\n    ',isContentTeamUser&&(__p+='\r\n        <input class="mediaAttribution" placeholder="Media Attribution" maxlength="256"/>\r\n    '),__p+='\r\n    <div class="noteHtml"></div>\r\n</div>\r\n\r\n<div class="shareNoteContainer">\r\n    ',"authoring"===readerConfig.type?(__p+='\r\n        <div class="switch">\r\n            <label>\r\n                <input id="chkExtraHelpNote"\r\n                    type="checkbox"\r\n                    '+(null==(__t=userM.isOnFreeOrPersonalPlan()?"disabled":"")?"":__t)+'\r\n                    class="chkExtraHelpNote">\r\n                <span class="lever"></span>\r\n                <span class="title extraHelpNote">Extra help</span>\r\n                ',userM.isOnPrimePlan()?__p+='\r\n                    <span class="icon-person extraHelpIcon" title=\''+(null==(__t=alcfg.infoText.generic.extraHelp)?"":__t)+"' data-container='body'></span>\r\n                ":__p+='\r\n                    <span class="icon-lock" data-placement="top" title=\''+(null==(__t=alcfg.freeTeacherTooltipText.extraHelp)?"":__t)+"'></span>\r\n                ",__p+="\r\n            </label>\r\n        </div>\r\n    "):"student"===readerConfig.type&&sCH.readerConfig.Settings.AllowStudentSharedNotes&&(__p+='\r\n        <div class="switch">\r\n            <label>\r\n                <input id="chkShareNote" type="checkbox" class="chkShareNote">\r\n                <span class="lever"></span>\r\n                <span class="title">Share with '+(null==(__t=sCH.readerConfig.smallGroupName||"class")?"":__t)+"</span>\r\n            </label>\r\n        </div>\r\n    "),__p+='\r\n</div>\r\n\r\n<div class="clearBoth"></div>\r\n\r\n<a class="btn small pull-right btnSaveNote">Save</a>\r\n<a class="btn small pull-right btnClose">Cancel</a>'}return __p}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8);t.default=Backbone.View.extend({className:"alert fade",alerts:["success","info","warning","danger"],template:a.template('        <% if (closable) { %>            <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>        <% } %>        <%= message %>'),autoCloseMap:{short:4,long:6,longer:8},initialize:function(e){if(this.options=a.extend({alert:"success",closable:!0,message:"",container:".alertContainer"},e),-1===a.indexOf(this.alerts,this.options.alert))throw new Error("Invalid alert: ["+this.options.alert+"] Must be one of: "+this.alerts.join(", "));!1===this.options.autoClose||this.options.autoClose||(this.options.autoClose=this.options.message.length>60?"longer":this.options.message.length<30?"short":"long")},render:function(){var e=this,t=this.template(this.options);return this.$el.addClass("alert-"+this.options.alert),this.options.closable&&this.$el.addClass("alert-dismissable"),setTimeout((function(){e.$el.html(t).addClass("in").alert(),!1!==e.options.autoClose&&setTimeout((function(){e.close()}),1e3*e.autoCloseMap[e.options.autoClose])}),5),this},close:function(){try{this.$el.removeClass("in"),this.$el.alert("close")}catch(e){this.$el.remove()}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(20);t.default=Backbone.Model.extend({defaults:function(){return{ClassId:null,Code:"",TeacherTitle:"",TeacherLastName:"",Name:"",GradeLevel:"",Assignments:[],Settings:null,Students:[],Source:null,ExternalClassId:null}},fixNameField:function(){return s.sanitize(this.get("Name",!0))},editSettings:function(e,t){var n="";"reading"===e.subMenu?n=alcfg.node.class.edit_reading_settings:"gradebook"===e.subMenu&&(n=alcfg.node.class.edit_grading_settings),s.ajax({type:"POST",url:n,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},editAssignmentSettings:function(e,t){s.ajax({type:"POST",url:alcfg.node.class_assignment.edit_reading_settings,data:e,showLoading:!0,vital:!1,onSuccess:function(e){t(e)},onError:function(){t(!1)}})},deleteAssignments:function(e,t){var n=this.get("Assignments");n=a.reject(n,(function(t){return $.inArray(t.AssignmentId,e)>-1})),this.set("Assignments",n),i.UnassignLayerFromClass({assignmentIds:e,classId:this.get("ClassId")},t)},getAssignments:function(e){var t=this;s.ajax({type:"GET",url:alcfg.node.class_assignment.list,data:{classId:t.get("ClassId")},isMathAPI:o.default.isMath,onSuccess:function(n){n?(t.set("Assignments",n.assignments),e(n)):e(!1)},onError:function(){}})},getAssignmentsForStudent:function(e){var t=this;s.ajax({type:"GET",url:alcfg.node.class_assignment.list_student,data:{classId:t.get("ClassId")},isMathAPI:o.default.isMath,onSuccess:function(n){o.default.isMath&&n.assignments?(t.set("Assignments",n.assignments),t.set("interventions",n.interventions),e(n.assignments)):n?(t.set("Assignments",n),e(n)):e(!1)},onError:function(){}})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44);t.default=Backbone.Model.extend({defaults:function(){return{StudentLayerId:null,UserId:null,LearnEntityId:null,Title:"",Description:"",Author:"",CoverArt:"",GenreId:null,PageCount:null}},sync:a.default,initWithData:function(e){return this.set(this.parse(e))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(44);t.default=Backbone.Model.extend({defaults:function(){return{StudentLayerId:null,UserId:null,LearnEntityId:null,Title:"",Description:"",Author:"",CoverArt:"",GenreId:null,PageCount:null,IsRecommended:!1,InBookshelf:null,Rating:null,Question:"",Answer:"",ReadingTime:0,FinishDate:null}},sync:s.default,initWithData:function(e){return this.set(this.parse(e))},fixAnswerField:function(){return a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Answer",!0)))},fixTitleField:function(){return a.sanitize(this.get("Title",!0))},fixDescriptionField:function(){return a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Description",!0)))},fixAuthorField:function(){return a.sanitize(this.get("Author",!0))},fixCoverArtField:function(){return a.sanitize(this.get("CoverArt",!0))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44);t.default=Backbone.Model.extend({defaults:function(){return{CurrentUserId:null,TextSettings:null,LastReadTextSectionId:-1,LastReadScrollTopPx:-1,LastReadScrollTopPxUpdateDate:null,ClassSettings:null,AssignmentSettings:null,TeacherCommentSuggestions:null}},sync:a.default,initWithData:function(e){return this.set(this.parse(e))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.Model.extend({defaults:function(){return{TextSectionId:null,Title:"",BlobUrl:null,SectionNum:null}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(167),i=n(5),o=n(1127),r=n(10),l=n(43),d=n(44);t.default=Backbone.Collection.extend({model:o.default,sync:d.default,fill:function(e){var t=this;sCH.readerConfig.isAssessment||sCH.readerConfig.isPDF||sCH.readerConfig.isMedia?(e.set("Content",e.get("BlobUrl")),this.add(e.toJSON()),this.trigger("sync")):sCH.learnEntityMetaM.get("RentalPrices")?r.GetPaidTextSectionUrl(e.get("TextSectionId"),(function(n){if(n)$.ajax(n,{dataType:"html",cache:!0,success:function(n){e.set("Content",n),sCH.learnEntityMetaM.get("IsEncrypted")||e.set("SanitizedContent",i.sanitize(n,alcfg.allowedTagsTextSection));var a=e.toJSON();t.add(a),t.trigger("sync")},error:function(n){t.fetchSection(alcfg.node.reader.getblobcontentfroms3,e)}});else{var a=sCH.learnEntitySectionsMetaC.getFirstSectionId();e.get("TextSectionId")!==a&&Backbone.pubEv.trigger("skipToSection",a)}})):s.supported?s.db.textSections.get(e.get("TextSectionId"),(function(n){sCH.learnEntityMetaM&&(n&&t.isCachedSectionOutdated(n.cacheCreateDate)?(t.add(n),t.trigger("sync")):t.fetchUnencryptedSection(e))})):this.fetchUnencryptedSection(e)},fetchUnencryptedSection:function(e){var t=this;if(e.get("BlobUrl")){var n={type:"GET",cache:!0,url:e.get("BlobUrl"),dataType:"html",showLoading:!0,silentError:!0,onSuccess:function(n){e.set("Content",n);var o=e.toJSON();s.supported&&s.storeTextSection(a.extend(o,{SanitizedContent:i.sanitize(o.Content,alcfg.allowedTagsTextSection)})),t.add(o),t.trigger("sync")},onError:function(){t.fetchSection(alcfg.node.reader.getblobcontentfroms3,e)}};l.msie&&l.version<=9&&(n.crossDomain=!0),i.ajax(n)}else;},fetchSection:function(e,t){var n=this;this.fetch({url:e,data:{textSectionId:t.get("TextSectionId")},mainSuccess:function(e){t.set("Content",e);var o=t.toJSON();sCH.learnEntityMetaM.get("RentalPrices")||s.supported&&s.storeTextSection(a.extend(o,{SanitizedContent:i.sanitize(o.Content,alcfg.allowedTagsTextSection)})),n.add(o)}})},getText:function(e){return this.filter({TextSectionId:e})[0].get("Content")},getTextSectionHtml:function(e){var t=this.getModelBySectionId(e),n=sCH.learnEntityMetaM.get("IsEncrypted")&&!sCH.readerConfig.isAccessExpired?i.ehtmlToHtml(t.get("Content"),t.get("PickAndRoll")):t.get("Content");return n&&(n=n.replaceAll("https://layers.blob.core.windows.net/img","https://images.activelylearn.com/intext/fromazure").replaceAll("https://layers.blob.core.windows.net/timg","https://images.activelylearn.com/intext/fromazure").replaceAll("<math",'<span class="ignoreForTextSelection"><math').replaceAll("</math>","</math></span>")),n},getOrder:function(e){return this.filter({TextSectionId:e})[0].get("SectionNum")},getModelBySectionId:function(e){return this.filter({TextSectionId:e})[0]},getSectionMaxOrder:function(){return a.maxBy(this.toJSON(),(function(e){return e.SectionNum}))},isCachedSectionOutdated:function(e){return e&&e>i.utcDateToUnixTimestampInMs(sCH.learnEntityMetaM.get("UpdateDate"))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.Model.extend({defaults:function(){return{TextSectionId:null,TextId:null,SectionNum:null,Title:null,Content:null,BlobUrl:null,IsDeleted:null,Visible:!1}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(44);t.default=Backbone.Model.extend({sync:s.default,defaults:function(){return{UserId:null,FirstName:"",LastName:"",ImageUrl:"",QuestionTagResponseId:null,QuestionTagId:null,Text:"",TeacherComment:"",Grade:null,GradeDate:null,AnswerDate:null,IsDraft:!1,SawExtraHelp:!1}},fixTextField:function(){var e=this.get("QuestionTagId"),t=sCH.teacherQuestionsC.get(e);return!t||3!=t.get("SubType")&&2!=t.get("SubType")?a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Text",!0))):this.get("Text",!0)},fixTeacherCommentField:function(){return a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("TeacherComment",!0)))},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))}})},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(5),i=n(8),o=n(263),r=n(44),l=n(129);t.default=Backbone.Collection.extend({model:o.default,sync:r.default,initWithData:function(e,t){var n=this;i.each(e,(function(e){n.add(e)})),t&&""!==t&&(this.textSectionsLoaded||(this.textSectionsLoaded=[]),i.each(t.toString().split(","),(function(e){n.isSectionLoaded(e)||""==e||n.textSectionsLoaded.push(e)})))},isStudentTagsFetched:function(e){return this.studentIdAlreadyFetched&&-1!==$.inArray(e,this.studentIdAlreadyFetched)},isSectionLoaded:function(e){return this.textSectionsLoaded&&-1!==this.textSectionsLoaded.indexOf(e.toString())},addStudentIdToFetchList:function(e){this.studentIdAlreadyFetched||(this.studentIdAlreadyFetched=[]),this.studentIdAlreadyFetched.push(e)},showHideAllTags:function(e){i.each(this.models,(function(t){return t.set("Visible",e)}))},hideAllTagsBut:function(e){i.each(this.models,(function(t){return t.set("Visible",t.get("UserId")===e)}))},getModelsBySectionId:function(e,t){return t?this.filter({TextSectionId:e,IsPublic:!0}):this.filter({TextSectionId:e})},getModelsBySectionAndStudentId:function(e,t,n){return n=n||!1,this.filter((function(a){return(-1===e||a.get("TextSectionId")===e)&&(a.get("UserId")===t||a.get("ReplyUserIds")&&$.inArray(t.toString(),a.get("ReplyUserIds").split(","))>-1)&&(!n||!a.get("IsAssociatedNote"))}))},getNotesAndRepliesCountBySectionAndStudentId:function(e,t){var n=0;return i.each(this.models,(function(a){if((-1===e||a.get("TextSectionId")===e)&&!a.get("IsAssociatedNote")&&"note"===a.get("Type")&&(a.get("UserId")===t&&n++,a.get("ReplyUserIds"))){var s=a.get("ReplyUserIds").split(",");i.each(s,(function(e){e===t.toString()&&a.get("UserId").toString()!==e&&n++}))}})),n},getSharedNotesBySectionId:function(e){return this.filter((function(t){return(-1===e||t.get("TextSectionId")===e)&&t.get("IsPublic")}))},fillMore:function(e,t){var n=this;i.each(e,(function(e){n.fill(e,t)}))},createNewTag:function(e,t){var n=this;function i(a,i){var o=sCH.userM,r=i?a.rndId:a.noteTagId||e.TagId;n.add({TagId:r,UserId:o.get("UserId"),Username:"student"===o.get("Role")?o.get("Name"):(o.get("Title")||o.get("FirstName"))+" "+o.get("LastName"),ImageUrl:o.get("ImageUrl"),CreatedByCurrentUser:!0,CreateDate:a&&a.createDate||(new Date).toISOString(),UpdateDate:a&&a.createDate||(new Date).toISOString(),HighlightedText:s.eStringToString(e.highlightedText),Text:e.text,HTML:e.html,MediaAttribution:e.mediaAttribution,StartIndex:e.startIndex,EndIndex:e.endIndex,LayerId:e.layerId,AssignmentId:e.assignmentId,StudentLayerId:e.studentLayerId,TextSectionId:e.textSectionId,IsExtraHelp:e.isExtraHelp,WordCount:e.wordCount,Color:e.color,Category:e.category,Type:e.type,IsPublic:e.isPublic},{at:0});var l=n.at(0);"note"===e.type&&(""===l.get("Text")?s.bootstrap.alert({message:"Highlight saved!"}):"student"!==sCH.readerConfig.type||sCH.readerConfig.Settings.AllowStudentSharedNotes||!l.get("IsPublic")||sCH.readerConfig.sharingOffAlreadyNotified?sCH.readerConfig&&"tour"===sCH.readerConfig.type||s.bootstrap.alert({message:"Note saved!"}):(s.bootstrap.alert({message:alcfg.infoText.sreader.noteSharingAlert}),sCH.readerConfig.sharingOffAlreadyNotified=!0)),t&&Backbone.pubEv.trigger("finishAddTag",l),i&&(a.modelAdded=l,a.modelIdAttribute="TagId",a.collectionName="studentNotesC")}if("tour"===sCH.readerConfig.type){var o=l.getTourTag("note",e);this.add(o),i(o)}else{var r="reader_"+sCH.readerConfig.type;s.ajax({type:"POST",data:e,url:alcfg.node[r].add_note,onSuccess:function(e){i(e)},onError:function(e,t){"offline"===t&&i(a(a({},e),{rndId:this.rndId}),!0)}})}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=n(5),i=n(8),o=n(448),r=n(44),l=n(129);t.default=Backbone.Collection.extend({model:o.default,sync:r.default,initWithData:function(e){var t=this;i.each(e,(function(e){t.filter({TagId:e.TagId}).length||t.add(e)}))},showHideAllTags:function(e){i.each(this.models,(function(t){return t.set("Visible",e)}))},hideAllTagsBut:function(e){i.each(this.models,(function(t){return t.set("Visible",t.get("UserId")===e)}))},getModelsBySectionId:function(e){return this.filter({TextSectionId:e})},getModelsBySectionAndStudentId:function(e,t){return this.filter({TextSectionId:e,UserId:t})},fillMore:function(e,t){var n=this;i.each(e,(function(e){return n.fill(e,t)}))},createNewTag:function(e,t){var n=this,i=sCH.userM;function r(a,s,r){var l=new o.default(e);l.set({TagId:a?a.markerTagId:e.TagId,UserId:i.get("UserId"),Username:i.get("Name"),ImageUrl:i.get("ImageUrl"),CreatedByCurrentUser:!0,CreateDate:a?a.createDate:(new Date).toISOString(),UpdateDate:a?a.updateDate:(new Date).toISOString(),AssociatedNoteTagId:null}),n.add(l,{at:0}),t&&Backbone.pubEv.trigger("finishAddTag",l),s&&(r.modelAdded=l,r.modelIdAttribute="TagId",r.collectionName="studentFlagsC")}if(e.TagId=s.getRandomInteger(),"tour"===sCH.readerConfig.type){var d=l.getTourTag("marker",e);this.add(d),r(d)}else{var c={assignmentId:e.AssignmentId,endIndex:e.EndIndex,highlightedText:e.HighlightedText,html:e.HTML,layerId:e.LayerId,startIndex:e.StartIndex,studentLayerId:e.StudentLayerId,subType:e.SubType,text:e.Text,textSectionId:e.TextSectionId,type:e.Type,readerType:sCH.readerConfig.type};a.AddMarker(c,(function(t,n,a){t?r(t):"offline"===n?(e.TagId=a.rndId,r(null,!0,a)):s.showErrorPopup()}))}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(1132),i=n(44);t.default=Backbone.Collection.extend({model:s.default,sync:i.default,initWithData:function(e){this.set(e)},getQNumById:function(e){var t=this.filter({QuestionTagId:e});return t.length?t[0].get("QuestionNum"):null},comparator:function(e,t){return e.attributes.QuestionNum-t.attributes.QuestionNum},addModel:function(e){a.each(this.models,(function(t){t.get("QuestionNum")>=e.QuestionNum&&(t.set("QuestionNum",t.get("QuestionNum")+1),Backbone.pubEv.trigger("questionNumUpdated",t.get("QuestionTagId")))})),this.add(e)},updateModelStandards:function(e,t,n){this.find({QuestionTagId:e}).set({StandardId:t,SecondStandardId:n})},deleteModel:function(e){var t=this.filter({QuestionTagId:e})[0];a.each(this.models,(function(e){e.get("QuestionNum")>t.get("QuestionNum")&&(e.set("QuestionNum",e.get("QuestionNum")-1),Backbone.pubEv.trigger("questionNumUpdated",e.get("QuestionTagId")))})),this.remove(t)},getFirstNotAnsweredQuestion:function(){var e=null,t=this.models;return a.every(t,(function(t){return!t.get("IsGated")||(e=t,!1)})),!!e&&{QuestionTagId:e.get("QuestionTagId"),TextSectionId:e.get("TextSectionId"),EndIndex:e.get("EndIndex"),StartIndex:e.get("StartIndex"),QuestionNum:e.get("QuestionNum")}},getLastAnsweredQuestionEndIndex:function(){var e=this.models.filter((function(e){return e.get("IsGated")}))[0];if(e){if(1===e.get("QuestionNum"))return 0;var t=this.models.find((function(t){return t.get("QuestionNum")===e.get("QuestionNum")-1}));return t?t.get("EndIndex"):null}return null},updateQuestionNumbers:function(e){var t=this;a.each(e,(function(e,n){var a=t.find({QuestionTagId:e});a.get("QuestionNum")!==n+1&&(a.set("QuestionNum",n+1),Backbone.pubEv.trigger("questionNumUpdated",a.get("QuestionTagId")))}))},updateQuestionNumbersAfterRandomization:function(e){var t=this;a.each(e,(function(e,n){t.find({QuestionTagId:e.TagId}).set("QuestionNum",n+1)}))},swapQuestionAttributes:function(e,t){var n={StartIndex:e.get("StartIndex"),EndIndex:e.get("EndIndex"),QuestionNum:e.get("QuestionNum")};e.set("EndIndex",t.get("EndIndex")),e.set("StartIndex",t.get("StartIndex")),e.set("QuestionNum",t.get("QuestionNum")),t.set("EndIndex",n.EndIndex),t.set("StartIndex",n.StartIndex),t.set("QuestionNum",n.QuestionNum)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44);t.default=Backbone.Model.extend({sync:a.default,idAttribute:"QuestionTagId",defaults:function(){return{QuestionTagId:null,TextSectionId:null,StartIndex:null,EndIndex:null,QuestionNum:null}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.Model.extend({defaults:function(){return{UserId:null,UserName:null,FirstName:null,LastName:null,ImageUrl:"",LastLoggedIn:null,QuestionsAnswered:0,QuestionsAsked:null,Accounts:{},IsStruggling:!1}},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(1135);t.default=Backbone.Collection.extend({model:s.default,sync:a.default,fill:function(e){var t=this;this.fetch({url:alcfg.node.school_report.get_district_schools,data:e,mainSuccess:function(e){t.set(e)}})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(44);t.default=Backbone.Model.extend({defaults:function(){return{SchoolId:null,Name:""}},sync:s.default,fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(1137);t.default=Backbone.Collection.extend({model:s.default,sync:a.default,fillWithColleagues:function(e,t,n){var a=this;this.fetch({url:alcfg.node.school.get_colleagues,type:"GET",data:{excludeCurrentUser:e,searchAcrossDistrict:t,excludeFreeTeachers:n},mainSuccess:function(e){a.set(e)}})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.Model.extend({defaults:function(){return{UserId:null,Title:"",FirstName:"",LastName:"",ImageUrl:"",Classes:[]}},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(43);t.default={mathApis:{archive:"/classassignment/archivemathassignments",get_archived_list:"/classassignment/getarchivedmathassignments",unarchive:"/classassignment/unarchivemathassignments",lock:"/classassignment/lockmathassignment",unlock:"/classassignment/unlockmathassignment",clearlock:"/classassignment/clearlockmathassignment",unassign:"/classassignment/unassignmathassignments",get_student_mastery_data:"/studentdata/getstudentmasterydata",get_student_intervention_data:"/studentdata/getstudentinterventiondata",get_class_mastery_data:"/classdata/getclassmasterydata",get_class_intervention_data_by_student:"/classdata/getclassinterventiondatabystudent",get_class_intervention_data_by_assignment:"/classdata/getclassinterventiondatabyassignment",get_assignments_with_interventions:"/classdata/getassignmentswithinterventions",assign_intervention:"/classdata/assignintervention"},node:{class:{list_teacher:"/class/getlist",list_student:"/class/getlist",edit:"/class/editdetails",archived_list:"/class/getarchivedlist",add:"/class/add",duplicate:"/class/duplicate",delete:"/class/delete",edit_reading_settings:"/class/editreadingsettings",edit_grading_settings:"/class/editgradingsettings",archive:"/class/archive",unarchive:"/class/unarchive",get_coteachdata:"/class/getcoteachingdata",add_coteachers:"/class/addcoteachers",remove_coteacher:"/class/removecoteacher",join:"/class/join",add_edmodo_groups:"/class/addedmodogroups",leave:"/class/leave",add_googlecourses:"/class/addgooglecourses",add_clever_sections:"/class/addcleversections",add_canvassections:"/class/addcanvassections",add_schoologysections:"/class/addschoologysections",add_brightspacesections:"/class/addbrightspacesections",add_achieve3ksections:"/class/addachieve3ksections",add_onerostersections:"/class/addonerostersections",join_cleversections:"/class/joincleversections",get_clever_sections:"/class/getcleversections",join_my_class:"/class/joinmyclass",get_for_student_mode_teacher:"/class/getlistforstudentmodeteacher",get_edmodo_groups:"/class/getedmodogroups",get_ltisource_coursesandsections:"/class/getltisourcecoursesandsections",toggle_class_hidden_state:"/class/toggleclasshiddenstate",update_gradelevel:"/class/updategradelevel",get_google_classes:"/class/getgoogleclasses",update_class_small_group:"/class/updateclasssmallgroup",disable_class_small_group:"/class/disableclasssmallgroup",update_assignment_small_group:"/class/updateassignmentsmallgroup",disable_assignment_small_group:"/class/disableassignmentsmallgroup",get_assignment_small_group:"/class/getassignmentsmallgroup",get_class_small_group:"/class/getclasssmallgroup",get_students_from_allclasses:"/class/getstudentsfromallclasses"},class_assignment:{list:"/classassignment/getlist",list_student:"/classassignment/getlistforstudent",unassign:"/classassignment/unassign",assignees:"/classassignment/getassignees",update_assignees:"/classassignment/editassignees",edit_reading_settings:"/classassignment/editreadingsettings",lock:"/classassignment/lock",unlock:"/classassignment/unlock",clearlock:"/classassignment/clearlock",archive:"/classassignment/archive",unarchive:"/classassignment/unarchive",archived_list:"/classassignment/getarchivedlist",get_student_assignment_access:"/classassignment/getstudentassignmentaccess",sync_assignments_with_canvas:"/classassignment/syncassignmentswithcanvas"},class_roster:{student_list:"/classroster/getstudentlist",student_class_list:"/classroster/getclassesbystudent",deleted_student_list:"/classroster/getdeletedstudentlist",reenroll_students:"/classroster/reenrollstudents",mark_struggling:"/classroster/markstruggling",update_student_name:"/classroster/updatestudentname",remove_student:"/classroster/removestudent",reset_student_password:"/classroster/resetstudentpassword",switch_student_class:"/classroster/switchstudentclass",remove_edmodo_student:"/classroster/removeedmodostudents",remove_clever_student:"/classroster/removecleverstudents",remove_canvas_student:"/classroster/removecanvasstudents",remove_schoology_student:"/classroster/removeschoologystudents",remove_oneroster_student:"/classroster/removeonerosterstudents",sync_withgooglecourse:"/classroster/syncwithgooglecourse",edmodo_groups:"/classroster/getedmodogroups",merge_student_accounts:"/classroster/mergestudentaccounts"},class_activity:{get_data:"/classactivity/getdata",update_columns_to_show:"/classactivity/updatecolumnstoshow"},class_gradebook:{export:"/classgradebook/export",get_assignments_students:"/classgradebook/getassignmentsstudents",get_data:"/classgradebook/getdata",get_data_for_student:"/classgradebook/getdataforstudent",get_standards_data:"/classgradebook/getstandarddata",sync_gradebookwithgooglecourse:"/classgradebook/syncgradebookwithgooglecourse",sync_gradebook_with_lti:"/lti/syncgradebook",sync_gradebook_with_canvas:"/canvas/syncgradebook",sync_gradebook_with_schoology:"/schoology/syncgradebook",assignment_split_data:"/classgradebook/assignmentsplitdata",split_assignment:"/classgradebook/splitassignment",unsplit_assignment:"/classgradebook/unsplitassignment",update_assignment_filter:"/classgradebook/updateassignmentfilter",update_grade_weights:"/classgradebook/updategradeweights",get_synced_assignments:"/classgradebook/getexternalclasssyncedassignments"},class_studentdata:{get_assignments:"/classstudentdata/getassignments",get_overview_data:"/classstudentdata/getoverviewdata",get_standards_data:"/classstudentdata/getstandardsdata",get_writing:"/classstudentdata/getwritingdata",get_research:"/classstudentdata/getresearchdata",get_independentreading:"/classstudentdata/getindependentreadingdata",get_students:"/classstudentdata/getstudents"},class_proficiency:{get_data:"/classproficiency/getdata"},class_research:{get_list:"/classresearch/getdata",edit_labels:"/classresearch/editlabels",add_online_text:"/classresearch/addonlinetext",add_google_doc:"/classresearch/addgoogledoc",add_coauthors:"/classresearch/addcoauthors",edit_metadata:"/classresearch/editmetadata",move_to_class:"/classresearch/movetoclass",delete:"/classresearch/delete",get_peers:"/classresearch/getpeers",get_citations:"/classresearch/getcitations"},class_vocabulary:{get_data:"/classvocabulary/getdata"},account:{signin:"/account/signin",masquerade:"/account/masquerade",stopMasquerading:"/account/stopmasquerading",getMasqueradeUser:"/account/getmasqueradeuser",switch_role_to_teacher:"/account/signinmappedteacher",switch_role_to_student:"/account/signinmappedstudent"},data:{grade:"/data/getstudentgradesdata",writing:"/data/getstudentwritingdata"},manageusers:{getaccounts:"/manageusers/getaccounts",getschoolbookcreditsdata:"/manageusers/getschoolbookcreditsdata",get_user_permissions:"/manageusers/getuserpermissionsdata",update_userschoolmaps:"/manageusers/updateuserschoolmaps",toggle_permission:"/manageusers/togglepermission",delete_teacheraccount:"/manageusers/deleteteacheraccount",update_allowed_subject_school_book_credit:"/manageusers/updateallowedsubjectschoolbookcredit"},standards:{get_standardsets:"/standards/getstandardsets",edit_standardset:"/standards/editstandardset",delete_standardset:"/standards/deletestandardset",publish_standardset:"/standards/publishstandardset",add_standardset:"/standards/addstandardset",get_standards:"/standards/getstandards",add_newstandard:"/standards/addnewstandard",edit_standard:"/standards/editstandard",delete_standard:"/standards/deletestandard"},independent_reading:{delete:"/independentreading/delete",student_texts:"/independentreading/getstudenttextlist",homepage_texts:"/independentreading/gethomepagetextlist",readinglog:"/independentreading/getreadinglog",text_reviews:"/independentreading/gettextreviews",school_peers:"/independentreading/getpeers",link_broken:"/independentreading/linkbroken",add_readinglog:"/independentreading/addtoreadinglog",save_manual_log_data:"/independentreading/savemanuallogdata",add_fromcatalog:"/independentreading/addtextfromlibrary",add_online_text:"/independentreading/addonlinetext",get_catalog_settings:"/independentreading/getcatalogsettings",update_catalog_settings:"/independentreading/updatecatalogsettings",get_genres:"/independentreading/getgenres"},catalog:{request_text:"/catalog/requesttext",get_catalog_subjects_topics:"/catalog/getsubjectsandtopics",get_catalog_topic_data:"/catalog/gettopicdata",get_catalog_topic_data_forunitspage:"/catalog/gettopicdataforunitspage",get_catalog_myimports:"/catalog/getmyimports",get_catalog_search_results:"/catalog/getsearchresults",purchase:"/catalog/purchase",rental_request_to_admin:"/catalog/rentalrequesttoadmin",add_to_workspace:"/catalog/addtoworkspace",save_for_later:"/catalog/saveforlater",get_saved_for_later:"/catalog/getsavedforlater"},user:{signout:"/user/signout",change_password:"/user/changepassword",get_info:"/user/getinfo",disable_covid_prime_expiry_alert_for_session:"/user/disablecovidprimeexpiryalertforsession",get_district:"/user/getdistrict",get_source_with_api_access:"/user/getsourcewithapiaccess",change_username:"/user/changeusername",change_school:"/user/changeschool",delete:"/user/deleteuser",add_missing_teacher_info:"/user/addmissingteacherinfo",mark_product_update_message_seen:"/user/markproductupdateseen",update_standalone_settings:"/user/updatestandalonesetting",update_popup_settings:"/user/updatepopupsettings"},payment:{passed10percent:"/payment/passed10percent",cancel_teacher_personal:"/payment/cancelteacherpersonal",claim_prime_code:"/payment/claimprimecode",get_book_credits_data:"/payment/getbookcreditsdata",learnentity_order_history:"/payment/getlearnentityorderhistory",update_card_details:"/payment/updatecreditcard"},reader:{oembed:"/reader/oembed",tts:"/reader/tts",ttsspeechmark:"/reader/ttsspeechmark",define:"/reader/define",get_tags:"/reader/gettags",get_notifications:"/reader/getnotifications",mark_notifications_read:"/reader/marknotificationread",mark_all_notifications_read:"/reader/markallnotificationsread",delete_notification:"/reader/deletenotification",translate:"/reader/translate",get_note_responses:"/reader/getnoteresponses",upload_media_image:"/reader/uploadmedia",get_paid_textsection_url:"/reader/getpaidtextsectionurl",summary_view_notes:"/reader/getsummaryviewnotes",get_reader_summary_questions:"/reader/getsummaryviewquestions",getblobcontentfroms3:"/reader/getblobcontentfroms3",getsignedurlsforfreetext:"/reader/getsignedurlsforfreetext",get_multiple_attribution_info:"/reader/getmultipleattributioninfo",get_textsection_summary:"/reader/gettextsectionsummary",process_media_url_notfound:"/reader/processmediaurlnotfound",get_video_captions:"https://videocaptions.activelylearn.com/"},reader_tour:{load_reader:"/readertour/load"},reader_plassignment:{load_reader:"/readerprofessionallearning/load"},reader_student:{load_reader:"/readerstudent/load",get_dataPanel:"/readerstudent/getdatapanel",add_questionresponse:"/readerstudent/addquestionresponse",mark_draft:"/readerstudent/markdraft",reset_answer:"/readerstudent/resetanswer",request_reset_answer:"/readerstudent/requestresetanswer",add_note:"/readerstudent/addnote",edit_note:"/readerstudent/editnote",delete_note:"/readerstudent/deletenote",update_note_category:"/readerstudent/updatenotecategory",delete_note_category:"/readerstudent/deletenotecategory",add_note_reply:"/readerstudent/addnotereply",delete_note_reply:"/readerstudent/deletenotereply",cast_response_vote:"/readerstudent/castresponsevote"},reader_studentir:{load_reader:"/readerstudentir/load",add_note:"/readerstudentresearch/addnote",get_dataPanel:"/readerstudentir/getdatapanel",delete_note:"/readerstudentresearch/deletenote",edit_note:"/readerstudentresearch/editnote",update_note_category:"/readerstudentresearch/updatenotecategory",add_note_reply:"/readerstudentresearch/addnotereply",add_questionresponse:"/readerstudentir/addquestionresponse",mark_draft:"/readerstudentir/markdraft"},reader_studentresearch:{load_reader:"/readerstudentresearch/load",add_note:"/readerstudentresearch/addnote",delete_note:"/readerstudentresearch/deletenote",edit_note:"/readerstudentresearch/editnote",update_note_category:"/readerstudentresearch/updatenotecategory",add_note_reply:"/readerstudentresearch/addnotereply",delete_note_reply:"/readerstudentresearch/deletenotereply"},reader_grading:{responses_by_student:"/readergrading/responsesbystudent",responses_by_question:"/readergrading/responsesbyquestion",get_panel_data:"/readergrading/questionsbyassignment",move_students_here:"/readergrading/movestudentshere",load_reader:"/readergrading/load",get_teacher_comments:"/readergrading/getteachercommentsuggestions",add_tag_question_response:"/readergrading/addquestionresponsegradingtag",remove_tag_question_response:"/readergrading/removequestionresponsegradingtag",get_responses_with_grading_tags:"/readergrading/getresponseswithgradingtags",get_dataPanel:"/readergrading/getdatapanel",allow_revision:"/readergrading/allowrevision",revise_requested_responses:"/readergrading/reviserequestedresponses",get_students:"/readergrading/getstudents",grade_questionresponse:"/readergrading/graderesponse",grade_unanswered:"/readergrading/gradeunanswered",comment_questionresponse:"/readergrading/comment",ungrade_questionresponse:"/readergrading/ungrade",bulk_grade_unanswered:"/readergrading/bulkgradeunanswered",restore_graded_responses_awaiting_revision:"/readergrading/restoregradedresponsesawaitingrevision",get_note_replies_student:"/readergrading/getnotereplies",toggle_question_donotgrade:"/readergrading/togglequestiondonotgrade",delete_note:"/readergrading/deletenote",add_note_reply:"/readergrading/addnotereply",delete_note_reply:"/readergrading/deletenotereply"},reader_authoring:{add_note:"/readerauthoring/addnote",edit_note:"/readerauthoring/editnote",delete_note:"/readerauthoring/deletenote",update_note_category:"/readerauthoring/updatenotecategory",delete_note_category:"/readerauthoring/deletenotecategory",toggle_randomize_question_order:"/readerauthoring/updaterandomizequestionorder",submit_layer_feedback:"/readerauthoring/submitfeedback",toggle_as_quiz:"/readerauthoring/toggleasquiz",load_reader:"/readerauthoring/load",add_question:"/readerauthoring/addquestion",delete_question:"/readerauthoring/deletequestion",edit_question:"/readerauthoring/editquestion",swap_question:"/readerauthoring/swapquestion",delete_questions_bysection:"/readerauthoring/deletequestionsbysection",add_marker:"/readerauthoring/addmarker",edit_hyperlink:"/readerauthoring/edithyperlink",delete_marker:"/readerauthoring/deletemarker",allocate_license:"/readerauthoring/allocatelicense",add_layer_textsection_directions:"/readerauthoring/addlayertextsectiondirections",delete_layer_textsection_directions:"/readerauthoring/deletelayertextsectiondirections",save_teaching_ideas:"/readerauthoring/saveteachingideas",delete_teaching_ideas:"/readerauthoring/deleteteachingideas",hide_sections:"/readerauthoring/hidesections",get_sections_with_student_data:"/readerauthoring/getsectionswithstudentdata",save_textsection_summary:"/readerauthoring/savetextsectionsummary",delete_textsection_summary:"/readerauthoring/deletetextsectionsummary",fix_text_errors:"/readerauthoring/fixtexterrors"},events:{anon_event:"/events/loganonevent",nsf_event:"/events/lognsfevent",reader_event:"/events/logreaderevent",save_reader_state:"/events/savereaderstate",tour_action:"/events/logtouraction",track_event_autopilot:"/events/trackeventautopilot"},professional_learning:{data:"/professionallearning/getdata",get_completion_report:"/professionallearning/getcompletionreport",review_assignment:"/professionallearning/reviewassignment",submit_files:"/professionallearning/submitfiles",update_completion:"/professionallearning/updatecompletion",teacher_questions:"/professionallearning/questions",teacher_grading_feedback:"/professionallearning/getgradingfeedback"},workspace:{add_layer_to_library:"/workspace/addlayertolibrary",add_folder:"/workspace/addfolder",edit_folder:"/workspace/editfolder",move_folder:"/workspace/movefolder",delete_folder:"/workspace/deletefolder",get_folders:"/workspace/getfolders",get_layers_in_folder:"/workspace/getlayersinfolder",clear_layer:"/workspace/clearlayer",delete_layer:"/workspace/deletelayer",move_layer:"/workspace/movelayer",remove_layer_from_folder:"/workspace/removelayerfromfolder",get_layer_coauthors:"/workspace/getlayercoauthors",add_layer_coauthors:"/workspace/addlayercoauthors",remove_layer_coauthor:"/workspace/removelayercoauthor",remove_selfas_layer_coauthor:"/workspace/removeselfaslayercoauthor",update_layer_labels:"/workspace/updatelayerlabels",duplicate:"/workspace/duplicate",share:"/workspace/share",upload_pdf:"/workspace/uploadpdf",add_google_pdf:"/workspace/addgooglepdf",add_folder_coauthors:"/workspace/addfoldercoauthors",get_folder_coauthors:"/workspace/getfoldercoauthors",remove_folder_coauthor:"/workspace/removefoldercoauthor",remove_self_asfoldercoauthor:"/workspace/removeselfasfoldercoauthor",assign_layers:"/workspace/assigntoclasses",unassign_layer:"/workspace/unassignfromclass",add_online_text:"/workspace/addonlinetext",add_google_doc:"/workspace/addgoogledoc",import_video:"/workspace/importvideo",add_quiz:"/workspace/addquiz",upload_coverart:"/workspace/uploadcoverart",get_student_count:"/workspace/getstudentcount",classes_assigned_to:"/workspace/getclassesassignedto",create_layer_textsection_excerpt:"/workspace/createlayertextsectionexcerpt",get_layer_share_data:"/workspace/getlayersharedata",edit_metadata:"/workspace/editmetadata",merge_texts:"/workspace/mergetexts",get_import_count_for_url:"/workspace/getimportcountforurl",get_confirmed_copyright_warning:"/workspace/getconfirmedcopyrightwarning"},library:{add_folder:"/library/addfolder",edit_folder:"/library/editfolder",move_folder:"/library/movefolder",delete_folder:"/library/deletefolder",list:"/library/getlist",remove_layer:"/library/removelayer",add_to_student_library:"/library/addtostudentlibrary",remove_from_student_library:"/library/removefromstudentlibrary"},internal:{move_note:"/internal/movenote"},teacher_report:{teacher_questions:"/teacherreport/questions",teacher_grading_feedback:"/teacherreport/getgradingfeedback",teacher_assignments:"/teacherreport/getteacherassignments"},coaching_report:{get_overview_data:"/coachingreport/getoverviewdata"},school_report:{get_student_activity_data:"/schoolreport/getstudentactivitydata",email_school_student_activity:"/schoolreport/emailstudentactivityreport",get_district_schools:"/schoolreport/getdistrictschools",get_teachers_data:"/schoolreport/getteachersdata",get_teacher_activity_timeline_data:"/schoolreport/getteacheractivitytimelinedata",masquerade_teacher_activity_timeline_data:"/schoolreport/masqueradeteacheractivitytimelinedata",masquerade_school_report:"/schoolreport/masqueradeschoolreport",email_csv_report:"/schoolreport/emailcsvreport",get_school_proficiency_by_contentType:"/schoolreport/getproficiencybystandardandcontenttype",get_school_proficiency_by_gradeLevel:"/schoolreport/getproficiencybystandardandgradelevel",get_school_proficiency_by_grade:"/schoolreport/getproficiencybygrade",get_district_proficiency:"/schoolreport/getdistrictproficiency"},school:{get_colleagues:"/school/getcolleagues"},profile:{change_avatar:"/profile/changeavatar",set_initials_as_avatar:"/profile/setinitialsasavatar",upload_avatar:"/profile/uploadavatar",update_first_last_name:"/profile/updatefirstlastname",get_membership_details:"/profile/getmembershipdetails"},international_rostering:{upload_csv_bulk_import:"/internationalrostering/uploadcsv"}},api:{both:{version:"/version.json"}},tags:{question:{dok:[{id:1,text:"Level 1 - Recall"},{id:2,text:"Level 2 - Skills and Concepts"},{id:3,text:"Level 3 - Strategic Thinking"},{id:4,text:"Level 4 - Extended Thinking"}],stems:[{id:1,text:"How would you describe"},{id:2,text:"Compare and contrast"},{id:3,text:"What evidence supports"},{id:4,text:"Can you analyze the impact of"}],students:{1:"All",2:"Essential"}},note:{noteColorListSpaceSeparated:"pink green blue yellow purple orange darkblue brown violet salmon",noteCustomColorsArray:["violet","salmon"],noteResearchColorsArray:["darkblue","yellow","brown","pink","orange","purple"],noteDefaultColorCategoryMap:{1:[{color:"pink",category:"Meaning & Evidence"},{color:"purple",category:"Text Structure"},{color:"blue",category:"Main Ideas"},{color:"brown",category:"Point of View"},{color:"green",category:"Characters & Plot"},{color:"orange",category:"Key Terms & Tone"},{color:"yellow",category:"My Thoughts"}],2:[{color:"pink",category:"Meaning & Evidence"},{color:"purple",category:"Text Structure"},{color:"blue",category:"Main Ideas"},{color:"brown",category:"Author's Purpose"},{color:"green",category:"People & Events"},{color:"orange",category:"Key Terms & Tone"},{color:"darkblue",category:"Evaluate Argument"},{color:"yellow",category:"My Thoughts"}],3:[{color:"pink",category:"Analysis & Evidence"},{color:"blue",category:"Main Ideas"},{color:"green",category:"Procedure"},{color:"orange",category:"Key Terms"},{color:"purple",category:"Text Structure"},{color:"brown",category:"Author's Purpose"},{color:"darkblue",category:"Evaluate Claim"},{color:"yellow",category:"My Thoughts"}]}}},videoids:{classes:"jy8h9ix9us",lessons:"hxon6hfa6y",assess:"v1ywgi6zyh",data:"y2rwrmwayy",teacherwelcome:"hxon6hfa6y",teacherstudentpreview:"5eamg2vrtj",teacherwelcomepreview:"9xprninnrk",teacherpremiumfeatures:"b7xdcm6c0i"},studentVideoUrl:"https://files.activelylearn.com/helpcenter/Student%20Overview.mp4",grades:{customGradeScaleOption:"5",list:[{id:"zero",label:"Zero"},{id:"incomplete",label:"Incomplete"},{id:"basic",label:"Basic"},{id:"proficient",label:"Proficient"},{id:"advanced",label:"Advanced"}],mcqlist:[{id:"zero",label:"Incorrect"},{id:"incomplete",label:"n/a"},{id:"basic",label:"n/a"},{id:"proficient",label:"n/a"},{id:"advanced",label:"Correct"}],defaults:{gradeLabelsOption:"-1",shortAnswer:{denominator:10,numerators:{zero:0,incomplete:5,basic:7,proficient:9,advanced:10}},multipleChoice:{denominator:5,numerators:{correct:5,incorrect:0}}},nameSets:{"-1":{zero:"Zero",incomplete:"Incomplete",basic:"Basic",proficient:"Proficient",advanced:"Advanced"},1:{zero:"Zero",incomplete:"Emerging",basic:"Developing",proficient:"Proficient",advanced:"Advanced"},2:{zero:"Zero",incomplete:"Below",basic:"Approaching",proficient:"Meets",advanced:"Exceeds"},3:{zero:"F",incomplete:"D",basic:"C",proficient:"B",advanced:"A"},4:{zero:"0",incomplete:"1",basic:"2",proficient:"3",advanced:"4"},custom:{zero:"",incomplete:"",basic:"",proficient:"",advanced:""}}},embedlyKey:"ebac26167bc0460fb33be61d846adfee",googleApiDeveloperKey:"AIzaSyBQeUzK7s9w7i4XmyMb-fJueBQrU70tkbk",edmodoClientId:{production:"79094c02fe70f2a095aa6018d0b403e29b6492ebbb0c743134ca949546068cbe",staging:"cfb62869090401c74b584a480d326870ce700f21d944715bfda014ab0dc6341d",local:"aba2f9a2a0fa660179c74c23631333cea24ef9e9ff0052b46b331bb4facfcca2"},weThePeoplePublisher:"Center for Civic Education",weThePeopleLevel2PaidLessonLeIds:[244470,244484,244556,244561,244744,248257,248384,248426,248435,248440,248441,249975,249976,249982,249983,253864,253929,253938,254487,254488,254489,257160,257167,257176,257275,257278,257281,258168,258178],weThePeopleLevel3PaidLessonLeIds:[219804,220449,220496,220503,220793,220824,220828,221790,221805,222999,223002,223313,223317,223320,224509,224522,224538,224970,224979,224994,227417,227452,211875,227544,227589,227630,230208,230224,230247,230258,230265,232722,232729,232755,232780,232783,232785,232786],paidpublishers:{decrypted:["Dover Publications","Jump!"],allowExcerpting:["Center for Civic Education","HarperCollins","A Byron Preiss Visual","Actively Learn","Aladdin","Aladdin Classics","Aladdin Paperbacks","Atheneum Books","Atheneum Books for Young Readers","Atria Books","Atria Books / Beyond Words","Center for Civic Education","Chicken Soup for the Soul Publishing, LLC","Free Press","Gallery Books","Harlequin","Howard Books","Margaret K. McElderry Books","Paula Wiseman Books","Pocket Books","Sasha S.","Scribner","Simon & Schuster Books for Young Readers","Simon & Schuster Childrens Publishing","Simon & Schuster Inc.","Simon and Schuster","Simon Pulse","Simon Spotlight","Simple Science","The Free Press","Touchstone","Washington Square Press"]},catalogSelectedFacetValuesDelimiter:"@@",activeEvents:"mousemove keydown wheel DOMMouseScroll mousewheel mousedown touchstart touchmove MSPointerDown MSPointerMove",proLink:"https://www.activelylearn.com/plans",demoSchoolId:139469,confirmsText:{noteCancelPosting:"Don't post this note?",noteDelete:"Delete this note?",linkDelete:"Delete this link?",resetResponse:"This will allow students to revise their response. Students will see any comments you've added with the response.",questionDelete:"Delete this question?",textsDelete:"This cannot be undone.",textsDeleteExtra:"The content you selected includes a class assignment. If you delete, your students will no longer see the assignment and their data will be deleted.",layerDelete:'You can look at the note and question summary views to see everything that would be removed. If student responses exist for this assignment in a class, they will also be deleted. To simply create a new assignment, go back to your Workspace and select "Duplicate."',lessonsUnassign:"This cannot be undone, and all student data for them will be lost. (The text will remain in your Workspace, and can be re-assigned later.)",classDelete:"This cannot be undone, and all data will be lost.",classDeleteCoteaching:'This cannot be undone, and all data will be lost. <p class="info">Note: Co-teachers in this class will lose access.</p>',classArchive:"You can view the list of archived classes by selecting the Un-archive icon (next to the +) from the main menu.",noResponsesToGrade:"There are no responses to grade for this question!",noQuestionsToGrade:"There are no questions to grade in this assignment!",noteRestricted:"This discussion is hidden because you haven't completed enough of this assignment. Keep reading and you will soon be able to see what your classmates are discussing!",questionRestricted:"This question is hidden because you haven't completed enough of this assignment. Keep reading and you will soon be able to see this question!",searchRestricted:"This content is hidden because you haven't completed enough of this assignment. Keep reading and you will soon be able to navigate to this result!",previewPaidTextRestricted:"This content is hidden because you need to purchase this text. Click the Back arrow to purchase.",editAnsweredQuestionKeepResponses:"Do you want to reset their responses so they have to answer again or do you want to keep the responses they have already submitted?",editAnsweredQuestion:"Do you want to reset their responses so they have to answer again?",layerAsQuiz:"When an assignment is marked as a quiz, all social features are turned off, students don't see answers after completing multiple choice questions, and questions do not stop readers in the text.",unmarkLayerAsQuiz:"Make this assignment a regular one and remove all quiz settings.",freeTExtraHelpNotes:"You can differentiate instruction by embedding notes that can only be seen by students you select as needing extra help. This feature is only available on our Prime plan.",freeTExtraHelpQuestions:"You can differentiate instruction by adding more information in questions that can only be seen by students you select as needing extra help. This feature is only available on our Prime plan.",freeTAddMedia:"You can add media like images, video and audio to provide background knowledge and create engaging questions and notes. This feature is only available on our Prime plan.",freeTExtraHelp:"You can differentiate instruction by adding more information in notes and questions that can only be seen by students you select as needing extra help. This feature is only available on our Prime plan.",questionDoNotGrade:"Comments will not be affected.",showQuizMCAnswer:"This will show the answers only after student has answered the question.",libraryCopyDownloadedEdit:"The {0} already assigned this assignment will be notified of any changes.",libraryLayerDeleteFromWorkspace:"This assignment is added to the library and will be removed if you delete it.",switchStudentClass:"{0} is already present in {1}. We will merge the student's work.",changeAuthor:"This assignment is being co-authored. Deleting it will remove you as the author and make {0} as the author of this assignment."},alertsText:{unsavedQuestionsStudent:"It looks like you are writing a response. If you exit now, any unsaved information will be lost. Are you sure you want to exit?",unsavedQuestionsAuthoring:"It looks like you are making changes to a question(s) in this text. If you exit now, any unsaved information will be lost. Are you sure you want to exit?",unsavedNote:"It looks like you are making changes to a note in this text. If you close this popup now, any unsaved information will be lost. Are you sure you want to close this popup?",unsavedNoteReply:"It looks like you are replying to a note in this text. If you close this popup now, any unsaved information will be lost. Are you sure you want to close this popup?",unableGetSelection:"Sorry, we were unable to get your selection.",noNotes:"There are no notes in this assignment.",noQuestions:"There are no questions in this assignment.",changesSaved:"Your changes are saved and now reflected in any class assignments.",noAccess:"You don't have access to this text.",learnEntityPaymentSuccess:"We have processed your purchase.",layerPaymentSuccess:"We have processed your purchase and sent you an email receipt of your order.<br/><br/>The rented assignment is now in your Workspace.",postPaymentSuccess:"We have processed your purchase and sent you an email receipt of your order.",classArchived:"The class was successfully archived. You can still see the list of archived classes and un-archive by selecting 'Show Archived' at the bottom of your class list.",classesUnArchived:"The selected classes have been successfully un-archived. They will show in the list of classes.",emailExists:"Warning: you've already created an account with this email.",exitingOfflineReader:"If you exit before connecting to the internet all your work done while offline will NOT be sent to your teacher. Are you sure you want to exit?",addFromOnlineTimeout:"This is taking longer than usual. Continue working and refresh this page in a few minutes.",lockAssignmentMessage:"Your teacher has locked this assignment. We will reload the page!",unlockAssignmentMessage:"Your teacher has unlocked this assignment. We will reload the page to start working again!",lockedFilterSelecton:"You can only select one locked assignment or unlocked assignments together.",canvasSyncedDisallowedSelectionMessage:"This assignment is already synced with your Canvas account.",lockedQuiz:"This quiz has been locked by your teacher and cannot be accessed.",failedUpdateUsername:"There was an error updating your username. Please try again later.",usernameUpdated:"Your account has been updated.",passwordMinLength:"Your password must be at least 6 characters long.",invalidEmail:"Please enter a valid email address.",requestFailed:"Something went wrong. Please try again.",teacherOfflineMessage:"You are offline. The last action did not save! Please try again when you are online.",studentOfflineMessage:"You are offline and cannot perform this action. Please try again when you are online.",hasAssigneesSingleSelectByCSSClass:"Assignments that have already been assigned to individuals need to be selected independently.",accessExpiredTextSectionText:{student:'<p>You do not have access to this assignment and your teacher has been notified.</p><p>You can still check your work by clicking on the "Notes, Questions" button above.</p>',teacher:"<p>The license for this assignment has expired. You can purchase additional licenses from the manage rental licenses option in the Class -> Assignments -> More menu.</p>"},copyClipboardPasteInstruction:' Use "Control+V" or "Paste" to use the link.',ttsNoTextSelect:"Select some text to hear it.",paymentError:"There was an error. Please do not retry. We will examine what went wrong first and contact you."},infoText:{generic:{noData:"Select &ldquo;?&rdquo; if you need help",extraHelp:'"Extra Help" allows teachers to differentiate and provide additional scaffolds for their struggling students. Since students need different levels of support, you can easily offer assistance to those who need more help.',extraHelpNoteFreeT:'This is an "Extra Help" note. They differentiate instruction and are included on the Prime plan.'},classes:{noStudents:"Select &ldquo;Invite Students&rdquo; from the subheader above.",noAssignments:'Go to your <a href="/#teacher/catalog">Content</a> space to view texts you can assign.',noVocabulary:"None of your students have defined any words while reading yet!",smallGroups:"Students in a group can only see social features like notes, note replies and question responses from other students who are in the same group."},library:{noData:"None of your colleagues have shared assignments to the Library."},catalog:{DokTitle:"DOK levels reflect the complexity of a question, ranging from recall to extended thinking.",feedbackSubmit:"Thank you for your feedback. We will review it and get back to you soon."},assess:{ManageLicenses:a.mobile?"Select to manage":"Select a paid text to view and manage rental licenses.",UnassignLessons:a.mobile?"Select to remove":"Select items to remove them from this class.",AssignmentSettings:a.mobile?"Select to customize":"Select an assignment to customize its reading settings.",AssignmentSmallGroupSettings:a.mobile?"Select to manage groups":"Select an assignment to manage its small group settings.",LockAssignment:a.mobile?"Select to lock":"Select an assignment to set a lock period for.",UnlockAssignment:a.mobile?"Select to unlock":"Select an assignment to set an unlock period for.",ClearLock:a.mobile?"Clear lock":"Select assignments below to clear lock or unlock.",PostUrl:a.mobile?"Select to post":"Select assignments below to share URL.",AssignToIndividuals:a.mobile?"Select to assign":"Select an assignment to individually assign.",ArchiveAssignment:a.mobile?"Select to archive":"Select items to archive them.",SyncAssignmentWithClassroom:a.mobile?"Select to sync":"Select assignments to sync to Google Classroom.",SyncAssignmentWithCanvas:a.mobile?"Select to sync":"Select assignments to sync to Canvas course."},allSchoolsUnavailableSchoolReports:'This report is not available with the "All schools" selected.\n      Select a school in the header to view this report.',data:{noStudents:"Uh oh, there are no students! Select a class from the main menu, then go to the Roster tab to add students.",noVocabulary:"This student has not defined any words while reading yet!",noReadingLog:"This student has not read any texts independently yet!",noReadingLogStudent:"You have not read any texts independently yet!",noDataGeneric:"No data yet!",noStudentData:"There is no data for this student!",noFilterData:"There is no data for selected filters!",noStudentsInClass:'No students are in this class! Please go to the Roster tab and select "Invite Students".'},sclasses:{noClasses:"Welcome! To join your first class, select the + next to Classes in the main menu!",noClassesMenuHidden:"Welcome! To join your first class, open the main menu and select the + next to Classes!",noCleverClasses:"Welcome! Your teachers have not activated classes yet!",noAssignments:"Your teacher is taking it easy on you! You don&rsquo;t have any assignments yet. Ask your teacher for instructions.",noVocabulary:"Define words while you read to see them here!"},sdata:{noData:"We can&rsquo;t wait to show you the data.<br/>But first you need to work on an assignment.<br/>Select a Class -> Assignments to work on one."},sbookshelf:{noTexts:'You have no texts in "My Texts". Visit the Library to add some!',noSearchResult:"There is no text matching the keyword you typed!"},sreadinglog:{noTexts:"You have not finished reading any texts independently yet!"},sresearch:{noTexts:"Add texts by clicking Add Content above!",AddLayerLabel:a.mobile?"Select to label":"LABELING: Select items below to add labels.",DeleteLayerLabel:a.mobile?"Select to remove":"LABELING: Select items below to remove labels.",DeleteLayers:a.mobile?"Select to delete":"DELETE: Select items to delete.",EditTextDetails:a.mobile?"Select to edit":"EDIT: Select an item to edit its text details.",MoveResearch:a.mobile?"Select to move":"MOVE: Select items below that you want to move to another class.",Collaborate:a.mobile?"Select to collaborate":"CO-RESEARCH: Select item below that you want to annotate with other students in this class.",CiteText:a.mobile?"Select to cite":"Please select items below that you want to cite in your project."},aData:{noVocabulary:"None of the students in the school have defined any words while reading. Make sure they know about this feature so you can see all the words they don&rsquo;t understand. ",noVocabularyGrade:"None of the students for the selected grade have defined any words while reading. Make sure they know about this feature so you can see all the words they don&rsquo;t understand. ",noGradeLevelData:"No data for this Grade Level!",noPrimeUsers:'There are no Prime teachers in this school. Learn more <a href="https://www.activelylearn.com/plans">here</a>.',notUsingSchoolBookCredits:'This school does not have a content credits add-on. Learn more <a href="https://www.activelylearn.com/plans">here</a>.',freeSchoolSelected:"The school you selected is not part of a Prime Plan.",freeSchoolSelectedByDA:"The school you selected is not part of your District Plan.",customStandardsFree:'Customizing standards is available on the Prime plan. Learn more <a href="https://go.activelylearn.com/CustomStandards">here</a>.',manageUsersFree:'Managing user accounts is available on the Prime plan. Learn more <a href="https://go.activelylearn.com/ManageSchoolPermissions">here</a>.'},sreader:{noteSharingAlert:"You just posted a shared note! Other students will see it when your teacher turns sharing on."}},popupsText:{workspace:{coAuthorNoAccess:"Co-authoring allows multiple teachers to embed questions, notes, and videos into this assignment (like Google Docs).",mergeTextsNoAccess:"Merging texts allows you to combine multiple assignments into a single one. It's available on our Prime plan."}},errorTexts:{connection:{error:{blocking:"We're sorry, we couldn't complete your last action. We've been notified and are looking into what went wrong! Please refresh the page and try again. If you were working on something, please exit this prompt and copy any unsaved information before refreshing.",nonblocking:"Sorry! We could not complete your last action. Please refresh your browser and try again.",notAuthorized:"You are not authorized to do this.",offline:"Unable to reach Actively Learn, please check your internet connection.",online:"Aaaand we're back! Please refresh the page. If you were working on something, please exit this prompt and copy any unsaved information before refreshing.",onlineAfterRequestFailedInOffilneMode:"Looks like you just came back online! Please refresh the page."}},account:{invalidEmail:"The email you entered is not valid. If you are a student and did not sign up with an email address please ask your teacher to help you reset your password."},mediaNotFound:"Media URL not found",mediaNotAuthorized:"No permission for media"},reviewTexts:{readingLog:"Why did you love it or dislike it?"},wordDelimiter:"##~",tourAssignmentId:264080,defaultReadingSettings:{Notifications:!0,QuestionGates:!0,MinimizeQuestions:!1,ViewPeerResponses:"all",NamedPeerResponses:!0,AllowLikingPeerResponses:!0,AllowStudentsMCAnswer:!0,DisAllowAnswerEditing:!0,AllowStudentSharedNotes:!0,AllowTranslation:!0,AllowDictionary:!0,AllowTextToSpeech:!0},defaultTextSettings:{spacing:"less",font:"serif",fontSize:"fontMedium",theme:"themeWhite",paraNum:"off",readerBackground:"bgWhite"},buyTeacherPopupTitle:{research:"Research Activity report",independentreading:"Independent Reading Activity report",assignments:"Assignments Activity report"},buyTeacherPopupHelpArticleLinks:{"Exporting Gradebook":"https://go.activelylearn.com/ExportGrades","Randomize order of questions":"https://go.activelylearn.com/RandomizeQuiz","Co-Authoring":"https://go.activelylearn.com/CoAuthoring",Printing:"https://go.activelylearn.com/PrintAssignment","Randomize order of choices":"https://go.activelylearn.com/CreateQuiz","Extra help for struggling students":"https://go.activelylearn.com/ExtraHelp","Assignment with Extra Help":"https://go.activelylearn.com/ExtraHelp","Exporting data from admin reports":"https://go.activelylearn.com/SchoolReports","Co-Teaching":"https://go.activelylearn.com/CoTeaching","Custom grading labels":"https://go.activelylearn.com/GradebookSettings","Merge texts":"https://go.activelylearn.com/MergeAssignment","Add to School Library":"https://go.activelylearn.com/NavigateSchoolLibrary","Assign to individual students":"https://go.activelylearn.com/AssignIndividuals","Sharing limit reached":"https://go.activelylearn.com/ShareAssignments","Upload PDF":"https://go.activelylearn.com/BYOC","Import Google Doc":"https://go.activelylearn.com/BYOC","Import Internet Article":"https://go.activelylearn.com/BYOC","Merge student accounts":"https://go.activelylearn.com/MergeStudentAccounts","Revise Answer":"https://go.activelylearn.com/ReviseAnswer","PDF formatting information":"https://go.activelylearn.com/UploadPDF","Co-author folder with colleagues":"https://go.activelylearn.com/foldercoauthoring","Model response":"https://go.activelylearn.com/modelresponse"},helpArticleLink:{directions:"https://go.activelylearn.com/TeacherDirections",managerentals:"https://go.activelylearn.com/ManageRentals",alcookies:"https://go.activelylearn.com/alcookies",convertPdf:"https://go.activelylearn.com/ConvertPDF",splitAssignments:"https://go.activelylearn.com/SplitAssignments",renewRental:"https://go.activelylearn.com/RenewRental",hideClasses:"https://go.activelylearn.com/HideClasses",extraHelp:"https://go.activelylearn.com/ExtraHelp",addDok:"https://go.activelylearn.com/AddDOK",studentOverview:"https://go.activelylearn.com/StudentOverview",teacherOverview:"https://go.activelylearn.com/TeacherOverview",studentMode:"https://go.activelylearn.com/StudentMode",navigateSchoolLibrary:"https://go.activelylearn.com/NavigateSchoolLibrary",viewVocab:"https://go.activelylearn.com/ViewVocab",whatsNew:"https://go.activelylearn.com/WhatsNew",coauthorFolder:"https://go.activelylearn.com/foldercoauthoring",contentCredits:"https://go.activelylearn.com/content-credits",wtpLicenseInfo:"https://go.activelylearn.com/wtp-license",autoGrading:"https://go.activelylearn.com/AutoGrading",importVideos:"https://go.activelylearn.com/ImportVideos",smallGroups:"https://go.activelylearn.com/SmallGroups",edmodoSignIn:"https://go.activelylearn.com/EdmodoUser"},freeTeacherTooltipText:{extraHelp:"Extra Help notes help to differentiate instruction and are available only on the Prime plan.",question:"Extra Help in questions help to differentiate instruction and are available only on the Prime plan.",modelResponse:"Model responses explain the correct answers for multiple choice questions.\n      These are only visible to teachers and students with the Prime plan.",textSummary:"Text Summary provides additional scaffolds for struggling students.\n      These are only available for teachers and students with the Prime plan."},allowedTagsTextSection:["b","i","u","em","strong","a","p","br","style"],anonUserId:151745,contentTeamUserIds:[1,155811,398831,393180,690801,74494,958193,1615941,1681802,1228497,1673613,1670950,1695243,289516,1677159,1676003,1681867,1695372,1280834,2078981,2136840,2148059],unitsWhitelistedSchoolIds:[139469,56825],imageExtensions:["jpg","jpeg","png","gif","bmp"],assignmentGradeWeights:[.25,.5,1,2,3,4,5],writingDataPageSize:15,feedbackDataPageSize:5,tileColors:["indigo","blue","teal","cyan","brown","green","pink","purple","deeporange","deeppurple","orange","amber"],blockLevelElementsAndBreak:["br","p","h1","h2","h3","h4","h5","h6","ol","ul","li","pre","address","blockquote","dl","div","fieldset","form","hr","noscript","table"],fixedGradingTags:["Missing evidence","Needs intervention","Grammatical errors","Spelling errors"],defaultClassGroups:["Group 1","Group 2","Group 3","Group 4"],MBInBytes:{10:10485760,2.5:2485760},gradeLevelMapping:{2:"2nd Grade",3:"3rd Grade",4:"4th Grade",5:"5th Grade",6:"6th Grade",7:"7th Grade",8:"8th Grade",9:"9th Grade",10:"10th Grade",11:"11th Grade",12:"12th Grade",13:"Adult Learners","-1":"Not Provided"},contentTypeMapping:{1:"Literature",2:"Informational",3:"Science","-1":"Others"},CONTENTEDITABLE_CHARACTER_LIMIT:5e4,TEXT_SUMMARY_CHARACTER_LIMIT:2e3}},,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(5),l=n(1144),d=n(1277),c=n(1279),u=n(1281),p=n(1287),h=n(1345),g=n(1357),f=n(1369),m=n(1376),v=n(1397),b=n(71),C=n(1424),y=n(1546),_=n(1558),S=n(1641),w=n(1659),T=n(1735),I=n(1906),x=n(1907),k=n(13),E=n(533);n(174).defaults.global.defaultFontColor="#000";var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shouldShowProductBanner=!sCH.userM.isAnonUser()&&!sCH.userM.get("IsMasquerading")&&"student"!==sCH.userM.get("Role")&&sCH.userM.get("UserProductUpdateMessage")&&!sCH.userM.showPopup("HowToUseCatalogV2"),t.pagesMap={teacherCatalog:C.default,teacherClasses:_.default,professionalLearning:y.default,studentClasses:S.default,independentReading:w.default,reader:T.default,adminTeachers:A(p.default),profile:A(h.default),studentData:A(g.default),adminStandards:A(u.default),adminSchool:A(l.default),manage:A(f.default),switchRole:A(d.default),pageNotFound:A(c.default)},t.state={viewName:null,viewProps:null,pageToRender:null,mainMenuTabName:null,shouldShowMainHeader:!1,isMenuOpen:!(sCH.userM.isAnonUser()||r.onDevice()&&90!==Math.abs(window.orientation)),modalElements:[]},t.handleAppClick=function(e){r.handleAppClick($(e.target))},t.showModal=function(e){return t.setState({modalElements:i(t.state.modalElements,[e])})},t.hideModals=function(e){return t.setState({modalElements:t.state.modalElements.slice(0,-e)})},t.setViewProps=function(e){var n=e.viewProps,a=e.viewName,s=e.mainMenuTabName,i=t.pagesMap[a],r=-1===["reader","account","pageNotFound","switchRole"].indexOf(a),l=o.createElement(o.Fragment,null,i&&o.createElement(i,{viewProps:n,viewName:a}));Backbone.pubEv.trigger("setSiteSection",a,!0),t.setState({viewName:a,viewProps:n,pageToRender:l,mainMenuTabName:s,shouldShowMainHeader:r})},t.toggleMenuState=function(e){t.setState({isMenuOpen:void 0===e?!t.state.isMenuOpen:e})},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("setViewProps",this.setViewProps),Backbone.pubEv.on("showModal",this.showModal),Backbone.pubEv.on("hideModals",this.hideModals),document.body.addEventListener("click",this.handleAppClick)},t.prototype.componentDidUpdate=function(){r.adjustHeaderSpacing()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("setViewProps",this.setViewProps),Backbone.pubEv.off("showModal",this.showModal),Backbone.pubEv.off("hideModals",this.hideModals),document.body.removeEventListener("click",this.handleAppClick)},t.prototype.render=function(){var e,t=this.state,n=t.viewName,a=t.viewProps,s=t.pageToRender,i=t.mainMenuTabName,l=t.isMenuOpen,d=t.shouldShowMainHeader,c=t.modalElements,u=!sCH.userM.isAnonUser()&&d,p=a&&a.isMath?r.classNames({noMainMenu:!u}):r.classNames(((e={layout:!0})[n]=!0,e.noMainMenu=!u,e));return o.createElement(k.MuiThemeProvider,{theme:E.default},this.shouldShowProductBanner&&o.createElement(x.default,null),o.createElement("div",{role:"alert",className:"alertContainer","aria-live":"polite"}),o.createElement("div",{id:"app",className:p},u&&o.createElement(m.default,{mainMenuTabName:i,classId:a.classId,isMenuOpen:l,toggleMenuState:this.toggleMenuState}),o.createElement("div",{id:"headerWrapper",className:"headerWrapper"},d?o.createElement(v.default,{viewName:n}):o.createElement(o.Fragment,null,o.createElement("header",{id:"theHeader",className:"header"}),o.createElement("div",{id:"theSubheader",className:"subheader"}))),o.createElement("div",{id:"content"},s,o.createElement("main",{id:"theScroll",className:"scroll"}))),o.createElement(I.default,null),c.map((function(e,t){return o.createElement(o.Fragment,{key:t},e)})))},t}(o.Component);t.default=N;var A=function(e){return function(t){return"switchRole"===t.viewName?o.createElement(b.default,{view:e,options:t.viewProps,shouldNotCallRender:!0}):"pageNotFound"===t.viewName?o.createElement(b.default,{view:e,options:t.viewProps}):o.createElement(o.Fragment,null,o.createElement(b.default,{view:e,options:t.viewProps,shouldNotCallRender:!0}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(22),i=n(1145),o=n(1147),r=n(1210),l=n(1212),d=n(1267),c=n(37),u=n(10),p=n(54);t.default=Backbone.View.extend({el:"div.adminSchool",dateRangeObj:{},initialize:function(e){var t=this;this.setDateRange=this.setDateRange.bind(this),t.dateRangeObj=p.getSchoolYearRangeOrDefault("admin"),"dadmin"===sCH.userM.get("Role")?sCH.userM.isOnPrimePlan()?sCH.initDistrictSchools((function(){t.schools=sCH.schoolsC.toJSON(),t.preRender(t.schools,e)})):this.preRender([{SchoolId:1,Name:"School Reports"}],e):(t.schools=sCH.userM.get("SchoolInfo"),this.preRender(t.schools,e))},setDateRange:function(e){this.dateRangeObj=e},setSchoolFromQueryString:function(e){var t=window.location.hash.split("?")[1];if(t){var n=c.getParamsFromQueryString(t);n.schoolId&&e.find((function(e){return e.SchoolId===parseInt(n.schoolId,10)}))&&(sCH.selectedSchoolId=parseInt(n.schoolId,10))}},preRender:function(e,t){var n=this;if(this.subview=t.subview||"teachers",this.tab=t.tab,this.subtab=t.subtab,n.subheader=new i.default({scope:n}),n.subheader.render(),this.childViews=[n.subheader],1===e.length)sCH.selectedSchoolId=e[0].SchoolId,n.subviewSelector(),Backbone.pubEv.trigger("setSiteSection",e[0].Name);else{var s=e.map((function(e){return{value:e.SchoolId,label:e.Name}}));s.unshift({value:-1,label:"All Schools"}),this.setSchoolFromQueryString(e),sCH.selectedSchoolId=sCH.selectedSchoolId||-1,Backbone.pubEv.trigger("setSiteSection","Administrator Reports"),Backbone.pubEv.trigger("setHeaderActions",{selectors:[{type:"school",data:s,preSelectedValue:sCH.selectedSchoolId,callback:function(e){-1!==sCH.selectedSchoolId&&-1!==e||!n.scrollView||(n.scrollView.currentSortOrder=null),sCH.selectedSchoolId=e,sCH.selectedSchoolId&&-1!==sCH.selectedSchoolId?a.enableFocusNClick(".btnExportStudentData"):a.disableFocusNClick(".btnExportStudentData"),n.subviewSelector()}}]})}},subviewSelector:function(){"performance"===this.subview?Backbone.router.navigate("teacher/school/performance/proficiencybygradelevel/?schoolId="+sCH.selectedSchoolId,{trigger:!1}):Backbone.router.navigate("teacher/school/"+this.subview,{trigger:!1});var e=$(".siteSectionSelector ul.dropdown-menu").children().first();switch(a.enableFocusNClick(".btnExportTable"),s.unmountAllChildReactComponentsUnderParent(this.$el),a.intercom("trackEvent","admin-school-reports-"+this.subview),e.hide(),$(".layout").removeClass("performance"),this.subview){case"performance":this.renderPerformance(this.tab,this.subtab);break;case"professionallearning":this.renderProfessionalLearning();break;case"students":this.renderStudents();break;default:e.show(),this.renderTeachers()}},renderTeachers:function(){this.subheader.selectTab("Teachers"),this.$el.find(".scroll").html('<div id="teacherActivityScrollView"></div>'),s.mountReactComponent(d.default,this.$el.find("#teacherActivityScrollView")[0],{schools:this.schools,setDateRange:this.setDateRange}),$(".layout").addClass("performance")},exportStudentsData:function(){a.disableFocusNClick(".btnExportStudentData"),u.EmailStudentActivityAdminReport({schoolId:sCH.selectedSchoolId,startDate:this.dateRangeObj.start.toISOString(),endDate:this.dateRangeObj.end.toISOString()},(function(e){e?a.bootstrap.alert({message:"The student's activity report has been sent to you via email.           Please make sure you can receive emails from support@activelylearn.com."}):a.bootstrap.alert({message:e.Message,alert:"danger"}),a.enableFocusNClick(".btnExportStudentData")}))},renderStudents:function(){var e,t;Backbone.router.navigate("teacher/school/students",{trigger:!1}),this.scrollView&&(e=this.scrollView.currentSortOrder,t=this.scrollView.dateFilter,this.scrollView.close(!1)),this.subheader.selectTab("Students"),this.scrollView=new o.default,e&&(this.scrollView.currentSortOrder=e),t&&(this.scrollView.dateFilter=t),this.scrollView.preRender()},renderPerformance:function(e,t){this.scrollView&&this.scrollView.close(!1),this.subheader.selectTab("Performance"),this.$el.find(".scroll").html('<div id="proficiency" />'),s.mountReactComponent(l.default,this.$el.find("#proficiency")[0],{schoolId:sCH.selectedSchoolId,tab:e,subtab:t}),$(".layout").addClass("performance")},renderProfessionalLearning:function(){this.scrollView&&this.scrollView.close(!1),this.subheader.selectTab("ProfessionalLearning"),this.scrollView=new r.default},destroy:function(){this.subheader&&this.subheader.destroy&&this.subheader.destroy()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({el:".layout .subheader",events:{"click .tabs a":"selectSubview","click .btnExportStudentData":"exportStudentActivityData","click .btnExportTable.Teachers":"exportTeacherActivityData"},template:n(1146),initialize:function(e){this.scope=e.scope},render:function(){a.renderBackboneTemplateAsync(this.el,this.template())},exportStudentActivityData:function(){this.scope.exportStudentsData()},exportTeacherActivityData:function(){$('.exportActivityWrapper input[type="submit"]').click()},selectTab:function(e){if($(".btnExportTable").hide().removeClass("Students Teachers"),"ProfessionalLearning"===e?$(".btnExportStudentData").hide():$(".btnExportStudentData").show(),sCH.userM.isOnPrimePlan()){var t="Students"===e||"Teachers"===e,n="Students"===e&&-1===sCH.selectedSchoolId;$(".btnExportTable").toggle(t).addClass(e),$(".btnExportTable").toggleClass("disabled",n).prop("disabled",n)}this.$el.find("a.btn-tab").removeClass("selected"),this.$el.find(".tab"+e).addClass("selected"),$(".searchSchool").toggleClass("displayNone","Teachers"!==e)},selectSubview:function(e){this.scope.subview=$(e.currentTarget).data("view"),this.scope.subviewSelector()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<nav role="tablist" aria-label="Tabs" class="tabs">\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabTeachers" data-view="teachers">Activity</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabPerformance" data-view="performance">Proficiency</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabProfessionalLearning" data-view="professionallearning">Professional Learning</a>\r\n</nav>\r\n\r\n<aside class="rowTwo">\r\n    <button class="btn-box btnExportTable">Export Teachers Data</button>\r\n    <button class="btn-box btnExportStudentData">Export Students Data</button>\r\n</aside>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(22),i=n(10),o=n(1148),r=n(69);t.default=Backbone.View.extend({el:".layout .scroll",initialize:function(){},setFlags:function(){this.totalStudentCount=-1,this.pageNum=0,this.numOfPages=0},preRender:function(){-1===sCH.selectedSchoolId||sCH.userM.isOnPrimePlan()?(this.$el.html('<div id="studentActivity" />'),this.setFlags(),this.renderStudentActivity()):this.$el.html(new r.default({screenshotUrl:"/img/SchoolReports_StudentActivity.png",showSampleBanner:!0}).render().$el)},renderStudentActivity:function(){var e=this.$el.find("#studentActivity");s.mountReactComponent(o.default,e[0],{options:this})},exportTable:function(){a.disableFocusNClick(".btnExportTable"),i.EmailStudentActivityAdminReport({schoolId:sCH.selectedSchoolId,startDate:this.rawData.dateRangeObj.start.toISOString(),endDate:this.rawData.dateRangeObj.end.toISOString()},(function(e){e?a.bootstrap.alert({message:"The student's activity report has been sent to you via email. Please make sure you can receive emails from support@activelylearn.com."}):a.bootstrap.alert({message:e.Message,alert:"danger"}),a.enableFocusNClick(".btnExportTable")}))},destroy:function(){this.$el.html(""),this.undelegateEvents()}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(1149),o=n(0),r=n(54),l=n(10),d=n(5),c=n(271),u=n(37),p=n(153),h=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.pageClick=function(e){a.getData(e.pageNumber)};var s=r.getSchoolYearRangeOrDefault("admin"),i={studentData:null,studentDataTotals:null,totalStudentCount:-1,dateRangeObj:{start:s.start,end:s.end},pageNum:0,numOfPages:0};return a.state=i,a.props.options.rawData=a.state,a}return s(t,e),t.prototype.componentDidMount=function(){this.getData(this.state.pageNum),this.renderDateFilter()},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype.renderDateFilter=function(){var e=this;r.initDateRangePicker(this.state.dateRangeObj.start,this.state.dateRangeObj.end,(function(t,n,a){e.setState({dateRangeObj:{start:t,end:n},studentData:null,studentDataTotals:null,totalStudentCount:-1,pageNum:0,numOfPages:0},(function(){e.getData(e.state.pageNum)}))}),"admin")},t.prototype.getData=function(e){var t=this;sCH.selectedSchoolId>0?l.GetStudentActivityAdminReport({schoolId:sCH.selectedSchoolId,startDate:this.state.dateRangeObj.start.toISOString(),endDate:this.state.dateRangeObj.end.toISOString(),pageNum:e,totalStudentCount:this.state.totalStudentCount},(function(n){if(u.replaceQueryStringParam({schoolId:sCH.selectedSchoolId}),n){var a=-1===t.state.totalStudentCount?{studentData:n.studentData,studentDataTotals:n.studentDataTotals,totalStudentCount:n.totalStudentCount,numOfPages:Math.ceil(n.totalStudentCount/30),pageNum:e}:{studentData:n.studentData,pageNum:e};t.setState(a,(function(){t.props.options.rawData=t.state}))}else d.bootstrap.alert({message:n.Message,alert:"danger"})})):this.setState({studentData:null,totalStudentCount:0})},t.prototype.render=function(){return o.createElement(o.Fragment,null,-1===sCH.selectedSchoolId?o.createElement("div",{className:"ctaInfo"},alcfg.infoText.allSchoolsUnavailableSchoolReports):o.createElement("div",{className:"studentActivityWrapper"},o.createElement("div",{className:"pageInfoTextWrapper"},o.createElement("div",{className:"reportrange pull-right"},o.createElement("span",null),o.createElement("b",{className:"caret"})),o.createElement("h2",null,"Student Activity",o.createElement(p.default,{className:"icon-question-mark-inverse"},o.createElement("p",null,"In this table, you can view overall activity statistics for your students and measure how often students use Actively Learn and also quantify the reading behaviors.",o.createElement("br",null),o.createElement("br",null),"Active Learning Time represents the time students are actively scrolling and clicking in an assignment, not overall time on task.")))),this.state.totalStudentCount&&this.state.studentData?o.createElement("div",{className:"dateRangeTableContainer"},o.createElement(i.default,{studentData:this.state.studentData,studentDataTotals:this.state.studentDataTotals,totalStudentCount:this.state.totalStudentCount}),o.createElement(c.default,{currentPage:this.state.pageNum,showTotalRecordsCount:!0,totalItems:this.state.totalStudentCount,currentPageItemsCount:this.state.studentData&&this.state.studentData.students&&this.state.studentData.students.length,pageChangeCallback:this.pageClick})):o.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric)))},t}(o.Component);t.default=h},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(60),r=n(1208),l=n(8),d=n(0),c=["name","learningTime","questionAnswered","answersWithTeacherComment","totalPoints","revisionCount","vocabLookups","translationLookups","notes","notesWithCategory"];t.default=function(e){var t=p(a({},e));return d.createElement(o.VTable,{header:u(),body:t,enableFixedColumnScroll:!0,fixedRowCount:3,fixedColumnCount:1})};var u=function(){var e={name:"Student Name",learningTime:"Active Learning Time",questionAnswered:"Number of Questions Answered",answersWithTeacherComment:"Answer with Teacher's Comment",revisionCount:"Number of Answer Revisions",totalPoints:"Total Points",vocabLookups:"Vocab Lookups",translationLookups:"Translation Lookups",notes:d.createElement("div",null,"Notes ",d.createElement("div",null,"(Total/shared)")),notesWithCategory:"Notes With Category"};return{height:80,cells:c.map((function(t){return{content:e[t],width:180,notSortable:!0}}))}},p=function(e){var t=e.studentData,n=e.studentDataTotals,a=e.totalStudentCount,i=h(n,t),o=g(n,a),r=f(t,a);return s([i,o],r)},h=function(e,t){var n={name:"Total",learningTime:i.getFormattedTime(e.totalReadingTime||0,!1),questionAnswered:e.answersCount,answersWithTeacherComment:e.teacherCommentsCount,revisionCount:e.revisionCount,totalPoints:"",vocabLookups:e.vocabLookupsCount,translationLookups:e.translationLookupsCount,notes:e.notesCount,notesWithCategory:e.notesWithCategoryCount};return{height:50,cells:c.map((function(e){return{content:n[e],width:180}}))}},g=function(e,t){var n={name:"Average",learningTime:i.getFormattedTime((e.totalReadingTime||0)/t,!1),questionAnswered:(e.answersCount/t).toFixed(1).replace(/\.0/,""),answersWithTeacherComment:(e.teacherCommentsCount/t).toFixed(1).replace(/\.0/,""),revisionCount:(e.revisionCount/t).toFixed(1).replace(/\.0/,""),totalPoints:"",vocabLookups:(e.vocabLookupsCount/t).toFixed(1).replace(/\.0/,""),translationLookups:(e.translationLookupsCount/t).toFixed(1).replace(/\.0/,""),notes:(e.notesCount/t).toFixed(1).replace(/\.0/,""),notesWithCategory:(e.notesWithCategoryCount/t).toFixed(1).replace(/\.0/,"")};return{height:50,cells:c.map((function(e){return{content:n[e],width:180}}))}},f=function(e,t){var n=r.getDataByGradeLevel(e).studentByGradeLevel,a=[];return l.forEach(n,(function(e){var t=e.data.responseData.pointsMax?Math.round(e.data.responseData.pointsSum/e.data.responseData.pointsMax*100):"N/A",n=isNaN(t)?"":t>=80?"green cell":t<=40?"red cell":"yellow cell",s=e.data.readingTimeData?e.data.readingTimeData.time:0,o={name:i.sanitize(e.name),learningTime:i.getFormattedTime(s,!1),questionAnswered:e.data.responseData.answerCount,answersWithTeacherComment:e.data.responseData.answersWithTeacherCommentCount,revisionCount:e.data.revisionData.revisionCount,totalPoints:isNaN(t)?"":d.createElement("span",{className:n},d.createElement("span",null,t,"%"),d.createElement("br",null),d.createElement("span",{className:"info"},"(",Math.round(e.data.responseData.pointsSum),"/",Math.round(e.data.responseData.pointsMax),")")),vocabLookups:e.data.vocabLookupsData.lookupCount,translationLookups:e.data.translationLookupCount,notes:e.data.notesData.count+" / "+e.data.notesData.publicCount,notesWithCategory:e.data.notesWithCategoryCount};a.push({height:50,cells:c.map((function(e){return{content:o[e],width:180}}))})})),a}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(111);t.getDataByGradeLevel=function(e){var n=t.getStudentDataRow(e);return{studentByGradeLevel:n.studentRowData,averageGradesSpread:n.averageGradesSpread}},t.prepareStudentActivityData=function(e){var t=[];return s.forEach(e.students,(function(n){var i={responseData:[],revisionData:[],readingTimeData:[],vocabLookupsData:[],translationData:[],flagData:[],notesWithCategory:[],notesData:[],noteResponsesData:null};t.push({userId:n.UserId,name:a.getStudentDisplayName(n.FirstName,n.LastName),data:i});var r=s.filter(e.responseData,{UserId:n.UserId});if(r.length){var l=[];s.forEach(r,(function(e){var t=o(e.CreateDate),n=l.slice(-1)[0]&&l.slice(-1)[0].date===t?l.slice(-1)[0]:void 0;n?(e.IsReset||n.answerCount++,n.wordCount+=e.WordCount,n.pointsSum+=e.PointsEarned||0,n.pointsMax+=e.PointsPossible||0,e.HasTeacherComment&&n.answersWithTeacherCommentCount++):l.push({date:t,answerCount:e.IsReset?0:1,answersWithTeacherCommentCount:e.HasTeacherComment?1:0,noRespAnswers:0,pointsSum:e.PointsEarned||0,pointsMax:e.PointsPossible||0,wordCount:e.WordCount})})),i.responseData=l}i.revisionData=e.revisionData.find((function(e){return e.UserId===n.UserId}));var d=s.filter(e.readingData,{UserId:n.UserId});if(d.length){var c=[];s.forEach(d,(function(e){var t=o(e.CreateDate),n=c.slice(-1)[0]&&c.slice(-1)[0].date===t?c.slice(-1)[0]:null;n?n.time+=e.ReadingTime:c.push({date:t,time:e.ReadingTime})})),i.readingTimeData=c}var u=s.filter(e.vocabLookupsData,{UserId:n.UserId});if(u.length){var p=[];s.forEach(u,(function(e){var t=o(e.CreateDate),n=p.slice(-1)[0]&&p.slice(-1)[0].date===t?p.slice(-1)[0]:void 0;n?n.lookupCount++:p.push({date:t,lookupCount:1})})),i.vocabLookupsData=p}i.translationData=s.filter(e.translationLookupsData,{UserId:n.UserId}),i.flagData=s.filter(e.flagData,{UserId:n.UserId});var h=s.filter(e.notesData,{UserId:n.UserId});if(h.length){var g=[];i.notesWithCategory=[],s.forEach(h,(function(e){var t=o(e.CreateDate),a=g.slice(-1)[0]&&g.slice(-1)[0].date===t?g.slice(-1)[0]:void 0;a?(a.count++,a.publicCount+=e.IsPublic?1:0,a.wordCount+=e.WordCount):g.push({date:t,count:1,publicCount:e.IsPublic?1:0,wordCount:e.WordCount}),e.UserId===n.UserId&&e.TagConfigId&&i.notesWithCategory.push(e)})),i.notesData=g}i.noteResponsesData=s.find(e.noteResponsesData,{UserId:n.UserId})})),t},t.getStudentDataRow=function(e){var n=t.prepareStudentActivityData(e),a=[];return s.forEach(n,(function(e){var t={};a.push({name:e.name,data:t}),t.responseData={answerCount:0,noRespAnswers:0,pointsSum:0,pointsMax:0,wordCount:0,answersWithTeacherCommentCount:0},s.forEach(e.data.responseData,(function(e){t.responseData.answerCount+=e.answerCount,t.responseData.answersWithTeacherCommentCount+=e.answersWithTeacherCommentCount,t.responseData.noRespAnswers+=e.noRespAnswers,t.responseData.pointsSum+=e.pointsSum,t.responseData.pointsMax+=e.pointsMax,t.responseData.wordCount+=e.wordCount})),t.responseData.average=t.responseData.pointsMax?t.responseData.pointsSum/t.responseData.pointsMax:-1,t.revisionData={revisionCount:e.data.revisionData?e.data.revisionData.ResponseRevisedCount:0},t.readingTimeData={time:0},s.forEach(e.data.readingTimeData,(function(e){t.readingTimeData.time+=e.time})),t.vocabLookupsData={lookupCount:0},s.forEach(e.data.vocabLookupsData,(function(e){t.vocabLookupsData.lookupCount+=e.lookupCount})),t.peerResponseLookupsData={lookupCount:0},s.forEach(e.data.peerResponseLookupsData,(function(e){t.peerResponseLookupsData.lookupCount+=e.lookupCount})),t.translationLookupCount=e.data.translationData.length,t.flagCount=e.data.flagData.length,t.notesWithCategoryCount=e.data.notesWithCategory.length,t.notesData={count:0,publicCount:0,wordCount:0},s.forEach(e.data.notesData,(function(e){t.notesData.count+=e.count,t.notesData.publicCount+=e.publicCount,t.notesData.wordCount+=e.wordCount})),t.noteResponsesData={count:e.data.noteResponsesData?e.data.noteResponsesData.NoteTagResponsesCount:0,wordCount:e.data.noteResponsesData?e.data.noteResponsesData.WordCount:0}})),{averageGradesSpread:{na:0,basic:0,average:0,proficient:0,all:0},studentRowData:a}};var o=function(e){return i.utc(e).format("YYYY-DD-MM hh:mm:ss.SSS")}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<section class="premiumContainer">\n\n</section>\n\n',text&&(__p+=' \n<section class="intro">\n    '+(null==(__t=text)?"":__t)+"\n</section>\n"),__p+="\n\n",screenshotUrl){__p+='\n    <section class="screenshot">\n        <a href="'+(null==(__t=buyLink)?"":__t)+'">\n            ';for(var i=0;i<screenshotUrl.length;i++)__p+='<img src="'+(null==(__t=screenshotUrl[i])?"":__t)+'" />\n            ';__p+="\n\n            ",showSampleBanner&&(__p+='\n                <div class="sampleText">Sample</div>\n            '),__p+="\n        </a>\n    </section>\n"}__p+=""}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(22),i=n(5),o=n(10),r=n(1211),l=n(69);t.default=Backbone.View.extend({el:".layout .scroll",initialize:function(){var e=this;-1===sCH.selectedSchoolId?e.render({}):sCH.userM.isOnPrimePlan()?o.GetProfessionalLearningCompletionReport((function(t){e.render(t)})):this.$el.html(new l.default({screenshotUrl:"/img/SchoolReports_ProfessionalLearning.png",showSampleBanner:!0}).render().$el)},render:function(e){var t=[];a.each(e.data,(function(e){var n=a.find(t,{UserId:e.UserId});if(n)n[e.Title]=e.Completions;else{var s={UserId:e.UserId,FirstName:e.FirstName,LastName:e.LastName};s[e.Title]=e.Completions,t.push(s)}})),this.$el.html('<div id="professionalLearning"/>'),s.mountReactComponent(r.default,this.$el.find("#professionalLearning")[0],{header:e.header,body:t}),i.initTooltips(this.$el),i.initHelpPopover(this.$el)},destroy:function(){}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),r=n(0),l=n(5),d=n(153),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.getHeader=function(){var e=a.props.header.map((function(e){return{content:r.createElement("div",null,l.truncate(e.Title,30)),width:130,notSortable:!0,classes:{center:!0}}}));return{height:50,cells:i([{content:"Name",width:180}],e)}},a.getBody=function(){return a.props.body.map((function(e){for(var t={content:e.LastName+", "+e.FirstName,sortValue:e.LastName+", "+e.FirstName},n=[],s=0,o=a.props.header;s<o.length;s++){var l=o[s];if(e[l.Title]){var d=e[l.Title];if(d){var c=d.split(",").map((function(e,t){return r.createElement("span",{className:"icon "+e+" no-hover",key:t})}));n.push({content:c,classes:{center:!0}})}}else n.push({content:""})}return{height:50,cells:i([t],n)}}))},a.getHeader=a.getHeader.bind(a),a.getBody=a.getBody.bind(a),a}return s(t,e),t.prototype.render=function(){var e=this.props.body&&this.props.body.length,t=e?this.getBody():[];return-1===sCH.selectedSchoolId?r.createElement("div",{className:"ctaInfo"},alcfg.infoText.allSchoolsUnavailableSchoolReports):r.createElement("div",{className:"tableViewWrapper"},e?r.createElement(r.Fragment,null,r.createElement("div",{className:"pageInfoTextWrapper"},r.createElement("h2",null,"Professional Learning Completion",r.createElement(d.default,{className:"icon-question-mark-inverse"},"In our Professional Learning Center, educators can learn the key practices to Activate, Support, and Reveal student thinking while reading! This report displays their progress as they work on mastering different practices."))),r.createElement("div",{className:"tableSection"},r.createElement(o.VTable,{header:this.getHeader(),body:t,enableFixedColumnScroll:!0,fixedRowCount:1,fixedColumnCount:1,after:r.createElement("p",null)}))):r.createElement("div",{className:"ctaInfo"},"'This report will automatically populate as teachers start completing PL modules.'"))},t}(r.Component);t.default=c},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1213),r=n(1263),l=n(71),d=n(54),c=n(69),u=n(1266),p=[{id:"proficiencybygrade",displayName:"Proficiency By Grade"},{id:"proficiencybystandard",displayName:"Proficiency By Standard"}],h=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.switchReport=function(e){if(a.state.tab!==e)switch(e){case"proficiencybystandard":a.renderProficiencyByStandardTab();break;case"proficiencybygrade":default:a.renderProficiencyByGradeTab()}},a.renderProficiencyByGradeTab=function(){sCH.userM.isOnPrimePlan()?a.setState({tab:"proficiencybygrade",el:i.createElement(o.default,{startDate:a.state.startDate,endDate:a.state.endDate,dataUpdated:a.dataUpdated})}):a.setState({tab:"proficiencybygrade",el:i.createElement(l.default,{className:"trialSplash",view:c.default,options:{screenshotUrl:"/img/SchoolReports_ProficiencybyGrade.png",showSampleBanner:!0}})}),Backbone.router.navigate("teacher/school/performance/proficiencybygradelevel/?schoolId="+sCH.selectedSchoolId,{trigger:!1})},a.dataUpdated=function(e,t){a.setState({startDate:e.toISOString(),endDate:t.toISOString(),el:null},(function(){a.renderProficiencyByGradeTab()}))},a.updateDateValue=function(e,t){a.setState({startDate:e.toISOString(),endDate:t.toISOString(),el:null})},a.renderProficiencyByStandardTab=function(){sCH.userM.isOnPrimePlan()?a.setState({tab:"proficiencybystandard",el:i.createElement(r.default,{tab:a.props.subtab})}):a.setState({tab:"proficiencybystandard",el:i.createElement(l.default,{className:"trialSplash",view:c.default,options:{screenshotUrl:"/img/SchoolReports_ProficiencybyStandard.png",showSampleBanner:!0}})}),Backbone.router.navigate("teacher/school/performance/proficiencybystandard/gradelevel/?schoolId="+sCH.selectedSchoolId,{trigger:!1})};var s=d.getSchoolYearRangeOrDefault("admin");return a.state={el:null,tab:null,startDate:s.start.toISOString(),endDate:s.end.toISOString()},a}return s(t,e),t.prototype.componentWillMount=function(){-1===sCH.selectedSchoolId&&Backbone.router.navigate("teacher/school/performance/proficiencybygradelevel/?schoolId="+sCH.selectedSchoolId,{trigger:!1})},t.prototype.componentDidMount=function(){this.switchReport(this.props.tab||"proficiencybygrade")},t.prototype.render=function(){var e=this,t=this.state,n=t.startDate,a=t.endDate,s=sCH.userM.getPrimarySchool();return i.createElement(i.Fragment,null,-1===sCH.selectedSchoolId?i.createElement(i.Fragment,null,sCH.userM.isOnPrimePlan()?i.createElement(u.default,{startDate:n,endDate:a,dataUpdated:this.updateDateValue,isDistrictAdmin:s&&s.DistrictId&&"dadmin"===sCH.userM.get("Role")}):i.createElement("div",{className:"ctaInfo"},alcfg.infoText.allSchoolsUnavailableSchoolReports)):i.createElement("div",{className:"proficiencyContainer"},i.createElement("p",{className:"pageTabsContainer"},p.map((function(t){return i.createElement("a",{key:t.id,href:"javascript:void(0)",onClick:function(){return e.switchReport(t.id)},className:"btn-box toggler btnSwitchReportType "+(e.state.tab===t.id?"selected":"")},t.displayName)}))),sCH.userM.isOnPrimePlan()&&"proficiencybygrade"===this.state.tab?i.createElement("div",{className:"reportrange pull-right"},i.createElement("span",null),i.createElement("b",{className:"caret"})):null,i.createElement("div",{className:"dataWrapper"},this.state.el)))},t}(i.Component);t.default=h},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(1214),l=n(5),d=n(71),c=n(54),u=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.renderDateFilter=function(){c.initDateRangePicker(moment(a.props.startDate),moment(a.props.endDate),(function(e,t){a.props.dataUpdated(e,t)}),"admin")},a.renderProficiencyByGradeTab=function(){o.GetSchoolData({schoolId:sCH.selectedSchoolId,filterDeleted:!1,startDate:a.props.startDate,endDate:a.props.endDate},(function(e){a.setState({tab:"proficiencybygrade",el:i.createElement(d.default,{className:"performance",view:r.default,options:e})},(function(){l.initTooltips($(".dataWrapper"))}))}))},a.state={el:null},a}return s(t,e),t.prototype.componentDidMount=function(){this.renderProficiencyByGradeTab(),this.renderDateFilter()},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype.render=function(){return this.state.el},t}(i.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(1215);t.default=Backbone.View.extend({el:".layout .scroll",events:{},template:n(1262),initialize:function(e){this.data=e||{gradeData:[]}},render:function(){var e=!0;return"dadmin"===sCH.userM.get("Role")?e=!1:sCH.userM.get("SchoolInfo").length>1&&(e=!1),$(".layout").addClass(e?" singleSchool":""),this.data.gradeData.length?(this.$el.html(this.template()),a.mountReactComponent(s.default,this.$el.find("#studentPerformanceChart")[0],{gradeData:this.data.gradeData})):this.$el.html('<div class="ctaInfo">'+alcfg.infoText.data.noDataGeneric+"</div>"),this}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(130),r=n(482),l=n(54),d=n(711),c=n(1261),u=n(13).withStyles,p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={selectedSubject:"all",formattedGradeData:n.getSplitDataByGradeLevel(t.gradeData)},n.onSubjectChange=n.onSubjectChange.bind(n),n}return s(t,e),t.prototype.getFilteredGradeData=function(e,t){return t&&"all"!==t?e.filter((function(e){return e.SubjectSlug===t})):e},t.prototype.getSplitDataByGradeLevel=function(e){var t=[];return e.forEach((function(e){var n=t.filter((function(t){return t.gradeLevel===e.GradeLevel})),a=e.GradeAverage,s=l.getLevelFromGrade(a);if(n.length)n[0][s]++;else{var i={gradeLevel:parseInt(e.GradeLevel),basic:0,average:0,proficient:0,subjectSlug:e.SubjectSlug};i[s]=1,t.push(i)}})),t.sort((function(e,t){return e.gradeLevel-t.gradeLevel}))},t.prototype.getGradeLevelLabel=function(e){return e?13===e?"Adult Learners":"Grade "+e:"NA"},t.prototype.onSubjectChange=function(e){var t=e.target.value,n=this.props.gradeData,a=this.getFilteredGradeData(n,t);this.setState({formattedGradeData:this.getSplitDataByGradeLevel(a),selectedSubject:t})},t.prototype.getGradeDataGroupByGradeLevel=function(e){return e.reduce((function(e,t){return e[t.gradeLevel]?e[t.gradeLevel].push(t):e[t.gradeLevel]=[t],e}),{})},t.prototype.render=function(){var e=this,t=this.props.classes,n=this.state,a=n.selectedSubject,s=n.formattedGradeData,l=this.getGradeDataGroupByGradeLevel(s);return i.createElement("div",null,i.createElement("div",{className:t.allStudentChartSection},i.createElement("p",{className:t.allStudentsHeading},"All Students"),i.createElement(c.default,{className:t.subjectSelector,handleChange:this.onSubjectChange,selectedSubject:a}),0===s.length?i.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric):i.createElement(d.default,{data:r.getStudentPerformancePieChartData(s)})),s.length>0&&i.createElement(o.default,{container:!0,spacing:3},i.createElement(o.default,{container:!0,item:!0,xs:!0},Object.keys(l).map((function(n){return i.createElement(o.default,{key:n,item:!0,xs:4},i.createElement(d.default,{data:r.getStudentPerformancePieChartData(l[n])}),i.createElement("p",{className:t.gradeTitle},e.getGradeLevelLabel(n)))})))))},t}(i.Component);t.default=u({allStudentsHeading:{margin:"40px 0 10px",textAlign:"center",textTransform:"uppercase",fontSize:"20px",fontWeight:"Bold"},gradeTitle:{margin:"10px 0 40px",textAlign:"center",fontSize:"20px",fontWeight:"Bold"},allStudentChartSection:{marginBottom:"80px",position:"relative"},subjectSelector:{position:"absolute",right:0,top:0},"@media (max-width: 700px)":{subjectSelector:{top:"-40px"}}})(p)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(96),i=n(39);t.default=function(e,t){var n=e.className,o=e.handleChange,r=e.selectedSubject;return a.createElement(s.default,{onChange:o,value:r,className:n},a.createElement(i.default,{value:"all",key:"-1"},"All Subjects"),a.createElement(i.default,{value:"ela",key:"1"},"ELA"),a.createElement(i.default,{value:"science",key:"2"},"Science"),a.createElement(i.default,{value:"social-studies",key:"3"},"Social Studies"))}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\r\n    <h2>Student Proficiency</h2>\r\n    <p class="pageInfoText">See the number of students basic or below, between basic and proficient, or above proficient by grade level. This is based on the grades teachers have given them for their assignments in Actively Learn.</p>\r\n    <div id="studentPerformanceChart"></div>\r\n</div>';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(0),r=n(0),l=n(716),d=n(10),c=n(1264),u=n(1265),p=n(54);!function(e){e[e.GradeLevel=0]="GradeLevel",e[e.ContentType=1]="ContentType"}(i||(i={}));var h=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.renderDateFilter=function(){p.initDateRangePicker(moment(a.state.startDate),moment(a.state.endDate),(function(e,t){a.setState({startDate:e.toISOString(),endDate:t.toISOString(),el:null,dataForContentType:null,dataForGradeLevel:null},(function(){a.renderComponent()}))}),"admin")},a._switchTransactionType=function(){switch(a.state.reportType===i.GradeLevel?i.ContentType:i.GradeLevel){case i.ContentType:a.renderByContent();break;default:a.renderByGradeLevel()}};var s=i[i.ContentType].toLowerCase(),o=p.getSchoolYearRangeOrDefault("admin");return a.state={reportType:a.props.tab===s?i.ContentType:i.GradeLevel,el:null,startDate:o.start.toISOString(),endDate:o.end.toISOString()},a}return s(t,e),t.prototype.componentDidMount=function(){this.renderDateFilter(),this.renderComponent()},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype.renderComponent=function(){this.state.reportType===i.ContentType?this.renderByContent():this.renderByGradeLevel()},t.prototype.renderByContent=function(){var e=this,t=function(t){e.setState({reportType:i.ContentType,el:o.createElement(c.default,{standards:t.standards,data:t.data}),dataForContentType:t},(function(){Backbone.router.navigate("teacher/school/performance/proficiencybystandard/contenttype/?schoolId="+sCH.selectedSchoolId,{trigger:!1})}))};this.state.dataForContentType?t(this.state.dataForContentType):d.GetSchoolProficiencyByContentType({schoolId:sCH.selectedSchoolId,startDate:this.state.startDate,endDate:this.state.endDate},(function(e){t(e)}))},t.prototype.renderByGradeLevel=function(){var e=this,t=function(t){e.setState({reportType:i.GradeLevel,el:o.createElement(u.default,{standards:t.standards,data:t.data}),dataForGradeLevel:t},(function(){Backbone.router.navigate("teacher/school/performance/proficiencybystandard/gradelevel/?schoolId="+sCH.selectedSchoolId,{trigger:!1})}))};this.state.dataForGradeLevel?t(this.state.dataForGradeLevel):d.GetSchoolProficiencyByGradeLevel({schoolId:sCH.selectedSchoolId,startDate:this.state.startDate,endDate:this.state.endDate},(function(e){t(e)}))},t.prototype.render=function(){return o.createElement("div",{className:"performanceByStandard"},o.createElement("div",{className:"reportType pull-left",onClick:this._switchTransactionType},o.createElement(l.default,{leftOption:"Grade Level",rightOption:"Content Area",checked:this.state.reportType===i.ContentType})),o.createElement("div",{className:"reportrange pull-right"},o.createElement("span",null),o.createElement("b",{className:"caret"})),o.createElement("div",{className:"pageInfoText"},"See the percentage of students above proficient by standard."),o.createElement("div",{className:"dataWrapper"}," ",this.state.el," "))},t}(r.Component);t.default=h},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(851),l=n(717),d=n(8),c=n(5),u=function(e){function t(t,n){return e.call(this,t,n)||this}return s(t,e),t.prototype.componentDidMount=function(){l.componentDidMountCallback(this.props.standards.length)},t.prototype.render=function(){var e=p(this.props.data),t=h(this.props.standards,e);return 0===e.length?i.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric):i.createElement(r.default,{data:e,resizable:!1,sortable:!1,minRows:0,columns:[{Header:"Content Area",accessor:"SkillBucketId",Pivot:function(e){return i.createElement(m,{props:e})},className:"sticky",headerClassName:"sticky"},{accessor:"TeacherUserId",headerClassName:"pivotColumnTeacher",className:"pivotColumnTeacher",Pivot:function(t){return i.createElement(v,{props:t,data:e})},Aggregated:function(){return""}},{accessor:"ClassId",headerClassName:"pivotColumnClass",className:"pivotColumnClass",width:200,Cell:function(t){return l.getClassDisplayName(t,e)},Aggregated:function(){return""}}].concat(t),pivotBy:["SkillBucketId","TeacherUserId"],onExpandedChange:function(){c.initTooltips($(".ReactTable"))},style:{maxHeight:window.screen.height-350+"px"},showPagination:!1})},t}(o.Component);t.default=u;var p=function(e){var t=[],n=d.groupBy(e,"SkillBucketId");return Object.keys(n).map((function(e){var a=d.groupBy(n[e],"ClassId");Object.keys(a).map((function(n){var s=a[n];t.push({ClassTeacherName:s[0].ClassTeacherName,TeacherUserId:s[0].TeacherUserId,ClassId:parseInt(n,10),ClassName:s[0].ClassName,ResponseCountByClass:s.map((function(e){return d.pick(e,["NumStudents","NumProficient","StandardId"])})),SkillBucketId:parseInt(e,10)})}))})),t},h=function(e,t){return e.map((function(e){return{Header:l.getHeader(e),accessor:"ClassId",width:150,Cell:function(n){if(n.row){var a=t.filter((function(e){return e.ClassId===n.row.ClassId&&e.SkillBucketId===n.row.SkillBucketId&&e.TeacherUserId===n.row.TeacherUserId}));if(a.length>0){var s=[];return a.forEach((function(e){s=s.concat(e.ResponseCountByClass)})),i.createElement("div",null,l.getProficiency(s,e.StandardId))}}return null},Aggregated:function(n){return i.createElement(g,{rowData:n,data:t,standards:e})}}}))},g=function(e){var t=e.rowData,n=e.data,a=e.standards,s=[];if("SkillBucketId"===t.row._pivotID)s=n.filter((function(e){return e.SkillBucketId===parseInt(t.row._pivotVal)}));else if("TeacherUserId"===t.row._pivotID&&t.subRows&&t.subRows[0]){var o=t.subRows[0].SkillBucketId;s=n.filter((function(e){return e.TeacherUserId===parseInt(t.row._pivotVal)&&e.SkillBucketId===o}))}var r=[];return s.forEach((function(e){e.ResponseCountByClass&&(r=r.concat(e.ResponseCountByClass))})),r?i.createElement("div",null,l.getProficiency(r,a.StandardId)):null},f=function(e){var t,n=c.classNames(((t={})["icon-dropdown-arrow"]=!0,t.closed=!e.isExpanded,t));return i.createElement("div",{className:n})},m=function(e){var t=e.props;return t.value?i.createElement("span",null,f(t),alcfg.contentTypeMapping[t.value]||"Other"):null},v=function(e){var t=e.props,n=e.data;return t.value?i.createElement("span",null,f(t),n.find((function(e){return e.TeacherUserId===parseInt(t.value)})).ClassTeacherName):null}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(851),l=n(8),d=n(717),c=n(5),u=function(e){function t(t,n){return e.call(this,t,n)||this}return s(t,e),t.prototype.componentDidMount=function(){d.componentDidMountCallback(this.props.standards.length)},t.prototype.render=function(){var e=p(this.props.data),t=h(this.props.standards,e);return 0===e.length?i.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric):i.createElement(r.default,{data:e,resizable:!1,sortable:!1,minRows:0,columns:[{Header:"Grade Level",accessor:"GradeLevel",Pivot:function(e){return i.createElement(m,{props:e})},width:145,className:"sticky",headerClassName:"sticky"},{accessor:"TeacherUserId",headerClassName:"pivotColumnTeacher",className:"pivotColumnTeacher",width:200,Pivot:function(t){return i.createElement(v,{props:t,data:e})},Aggregated:function(){return""}},{accessor:"ClassId",headerClassName:"pivotColumnClass",className:"pivotColumnClass",width:200,Cell:function(t){return d.getClassDisplayName(t,e)},Aggregated:function(){return""}}].concat(t),pivotBy:["GradeLevel","TeacherUserId"],onExpandedChange:function(){c.initTooltips($(".ReactTable"))},style:{maxHeight:window.screen.height-350+"px"},showPagination:!1})},t}(o.Component);t.default=u;var p=function(e){var t=l.groupBy(e,"ClassId");return Object.keys(t).map((function(e){var n=t[e];return{ClassId:n[0].ClassId,TeacherUserId:n[0].TeacherUserId,GradeLevel:n[0].GradeLevel,ClassTeacherName:n[0].ClassTeacherName,ClassName:n[0].ClassName,ResponseCountByClass:n.map((function(e){return l.pick(e,["NumStudents","NumProficient","StandardId"])}))}}))},h=function(e,t){return e.map((function(e){return{Header:d.getHeader(e),accessor:"ClassId",width:150,Cell:function(n){if(n.row){var a=t.filter((function(e){return e.ClassId===n.row.ClassId&&e.GradeLevel===n.row.GradeLevel&&e.TeacherUserId===n.row.TeacherUserId}));if(a.length>0){var s=[];return a.forEach((function(e){s=s.concat(e.ResponseCountByClass)})),i.createElement("div",null,d.getProficiency(s,e.StandardId))}}return null},Aggregated:function(n){return i.createElement(g,{rowData:n,data:t,standards:e})}}}))},g=function(e){var t=e.rowData,n=e.data,a=e.standards,s=[];if("GradeLevel"===t.row._pivotID)s=n.filter((function(e){return e.GradeLevel===t.row._pivotVal}));else if("TeacherUserId"===t.row._pivotID&&t.subRows&&t.subRows[0]){var o=t.subRows[0].GradeLevel;s=n.filter((function(e){return e.TeacherUserId===parseInt(t.row._pivotVal)&&e.GradeLevel===o}))}var r=[];return s.forEach((function(e){e.ResponseCountByClass&&(r=r.concat(e.ResponseCountByClass))})),r?i.createElement("div",null,d.getProficiency(r,a.StandardId)):null},f=function(e){var t,n=c.classNames(((t={})["icon-dropdown-arrow"]=!0,t.closed=!e.isExpanded,t));return i.createElement("div",{className:n})},m=function(e){var t=e.props;return t.value?i.createElement("span",null,f(t),alcfg.gradeLevelMapping[t.value]):null},v=function(e){var t=e.props,n=e.data;return t.value?i.createElement("span",null,f(t),n.find((function(e){return e.TeacherUserId===parseInt(t.value)})).ClassTeacherName):null}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(54),l=n(711),d=n(482),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.renderDateFilter=function(){r.initDateRangePicker(moment(a.props.startDate),moment(a.props.endDate),(function(e,t){a.props.dataUpdated(e,t),a.renderDistrictProficiency(e.toISOString(),t.toISOString(),null)}),"admin")},a.state={districtData:{},fetchedDistrictData:!1},a.renderDistrictProficiency=a.renderDistrictProficiency.bind(a),a.renderDateFilter=a.renderDateFilter.bind(a),a}return s(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.startDate,a=t.endDate;this.renderDistrictProficiency(n,a,(function(){e.renderDateFilter()}))},t.prototype.componentWillUnmount=function(){$(".reportrange").remove()},t.prototype.renderDistrictProficiency=function(e,t,n){var a=this;this.props.isDistrictAdmin&&o.GetDistrictProficiencyData({districtId:sCH.userM.getPrimarySchool().DistrictId,filterDeleted:!1,startDate:e,endDate:t},(function(e){var t={};e.districtData.forEach((function(e){var n=r.getLevelFromGrade(e.GradeAverage),a=t[e.GradeLevel];if(a)a[n]++;else{var s={gradeLevel:e.GradeLevel};s[n]=1,t[e.GradeLevel]=s}})),a.setState({districtData:t,fetchedDistrictData:!0},n)}))},t.prototype.render=function(){var e=this.state,t=e.districtData,n=e.fetchedDistrictData,a=this.props.isDistrictAdmin;return i.createElement("div",{className:"districtProficiencyChartWrapper"},a?i.createElement(i.Fragment,null,n&&i.createElement(i.Fragment,null,Object.keys(t).length>0?i.createElement(i.Fragment,null,i.createElement("div",{className:"reportrange pull-right"},i.createElement("span",null),i.createElement("b",{className:"caret"})),i.createElement("div",{className:"districtProficiencyContainer"},i.createElement("p",{className:"districtProficiencyHeading"},"District Data"),i.createElement(l.default,{data:d.getStudentPerformancePieChartData(Object.values(t))}))):i.createElement("div",{className:"ctaInfo"},alcfg.infoText.allSchoolsUnavailableSchoolReports))):i.createElement("div",{className:"ctaInfo"},alcfg.infoText.allSchoolsUnavailableSchoolReports))},t}(i.Component);t.default=c},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(54),l=n(10),d=n(71),c=n(718),u=n(1268),p=n(1274),h=n(69),g=n(1275),f=n(37),m=n(153),v=n(14),b=n(482),C=n(363),y=n(5),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.masqueradeSchoolReport=function(e){var t,n;if(!e||!e.id)return a.setState({masqueradeReportParams:null}),a.getData(),void f.replaceQueryStringParam({});a.setState({fetchingTimeSeriesData:!0});var s=a.state.dateRangeObj;l.MasqueradeTeacherActivityTimelineData(((t={})[e.idType]=e.id,t.startDate=s.start.format(),t.endDate=s.end.format(),t),(function(t){var n;f.replaceQueryStringParam(((n={})[e.idType]=e.id,n)),a.setState({timeSeriesChartData:[{label:"teacherLoginsTimeline",data:a.segregateDataUsingTimeUnit(t[0].data)},{label:"studentLoginsTimeline",data:a.segregateDataUsingTimeUnit(t[1].data)}],masqueradeReportParams:e,fetchingTimeSeriesData:!1})})),l.MasqueradeSchoolReport(((n={})[e.idType]=e.id,n.startDate=s.start.format(),n.endDate=s.end.format(),n),(function(t){var n;f.replaceQueryStringParam(((n={})[e.idType]=e.id,n)),a.setState({el:i.createElement(g.TeacherActivityTable,{data:t,viewType:a.state.selectedTab,schoolId:"schoolId"===e.idType?e.id:-1,districtId:"districtId"===e.idType?e.id:null,isMasqueradingReport:!0}),data:t,masqueradeReportParams:e})}))};var s=r.getSchoolYearRangeOrDefault("admin");return a.state={dateRangeObj:{start:s.start,end:s.end},el:null,fetchingTimeSeriesData:!1,showSummaryView:!0,showTableView:!0,data:[],timeSeriesChartData:[],selectedTab:v.TeacherActivityChartTabs.USAGE,masqueradeReportParams:T(a.props.schools)},a.setSelectedTab=a.setSelectedTab.bind(a),a.setDateRange=a.setDateRange.bind(a),a.toggleSummaryView=a.toggleSummaryView.bind(a),a.getTimeUnit=a.getTimeUnit.bind(a),a.segregateDataUsingTimeUnit=a.segregateDataUsingTimeUnit.bind(a),a.toggleTeacherActivityTableView=a.toggleTeacherActivityTableView.bind(a),a}return s(t,e),t.prototype.componentDidMount=function(){this.state.masqueradeReportParams?(this.masqueradeSchoolReport(this.state.masqueradeReportParams),Backbone.pubEv.trigger("setTeacherActivityReportSearchData",this.state.masqueradeReportParams)):(Backbone.router.navigate("teacher/school/teachers",{trigger:!1}),this.getData()),Backbone.pubEv.on("TeacherActivityMasqueradeSchoolSearched",this.masqueradeSchoolReport)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("TeacherActivityMasqueradeSchoolSearched"),$(".daterangepicker").remove()},t.prototype.setDateRange=function(e){var t=this;this.props.setDateRange(e),this.setState({dateRangeObj:e,data:[],el:null},(function(){t.state.masqueradeReportParams?t.masqueradeSchoolReport(t.state.masqueradeReportParams):t.getData()}))},t.prototype.getTimeUnit=function(){var e=this.state.dateRangeObj,t=moment(e.start),n=moment(e.end),a=n.diff(t,"days"),s=n.diff(t,"months"),i=n.diff(t,"years");return a<=1?"hour":a<15?"day":s<3?"week":s<12?"month":i<3?"quarter":"year"},t.prototype.getCurrentBucketIndex=function(e,t,n,a){var s=n[e].date,i=s.clone().add(1,a);if(t>=s&&t<i)return e;for(;t>n[e].date&&n[++e];);return e-1},t.prototype.segregateDataUsingTimeUnit=function(e){var t=this.getTimeUnit(),n=this.state.dateRangeObj,a=moment(n.start).set({hour:0,minute:0,second:0,millisecond:0}),s=moment(n.end).set({hour:23,minute:59,second:59}),i=[],o=0,r=a;if("hour"===t)i.push({count:0,uniqueUserIdSet:new Set,date:a});else for(;r<s;)i.push({count:0,uniqueUserIdSet:new Set,date:r}),r=moment(r).add(1,t);for(var l=0;l<e.length;l++){var d=moment(e[l].date);i[o=this.getCurrentBucketIndex(o,d,i,t)].uniqueUserIdSet.add(e[l].UserId)}for(l=0;l<i.length;l++)i[l].count=Array.from(i[l].uniqueUserIdSet).length,delete i[l].uniqueUserIdSet;return i},t.prototype.getData=function(){var e=this,t=this.state.dateRangeObj,n=t.start,a=t.end;sCH.userM.isOnPrimePlan()?(l.GetTeachersData({schoolId:sCH.selectedSchoolId,startDate:n.format(),endDate:a.format()},(function(t){f.replaceQueryStringParam({schoolId:sCH.selectedSchoolId}),e.setState({el:i.createElement(g.TeacherActivityTable,{viewType:e.state.selectedTab,data:t,schoolId:sCH.selectedSchoolId,isMasqueradingReport:!1}),data:t,masqueradeReportParams:null})})),this.setState({fetchingTimeSeriesData:!0}),l.GetTeacherActivityTimelineData({schoolId:sCH.selectedSchoolId,startDate:n.format(),endDate:a.format()},(function(t){f.replaceQueryStringParam({schoolId:sCH.selectedSchoolId}),e.setState({timeSeriesChartData:[{label:"teacherLoginsTimeline",data:e.segregateDataUsingTimeUnit(t[0].data)},{label:"studentLoginsTimeline",data:e.segregateDataUsingTimeUnit(t[1].data)}],masqueradeReportParams:null,fetchingTimeSeriesData:!1})}))):this.setState({el:i.createElement(d.default,{className:"trialSplash",view:h.default,options:{screenshotUrl:"/img/SchoolReports_TeacherActivity.png",showSampleBanner:!0}}),data:[]})},t.prototype.setSelectedTab=function(e){this.setState({selectedTab:e,el:i.createElement(g.TeacherActivityTable,{viewType:e,data:this.state.data,schoolId:sCH.selectedSchoolId,isMasqueradingReport:this.state.isMasqueradingReport})})},t.prototype.toggleSummaryView=function(){this.setState({showSummaryView:!this.state.showSummaryView},(function(){setTimeout((function(){return y.adjustVirtualizedTableHeight()}),300)}))},t.prototype.toggleTeacherActivityTableView=function(){this.setState({showTableView:!this.state.showTableView})},t.prototype.render=function(){var e=this.state,t=e.selectedTab,n=e.data,a=e.timeSeriesChartData,s=e.showTableView,o=g.getCSVData({schoolId:sCH.selectedSchoolId,data:n}),r=this.getTimeUnit();return i.createElement("div",{id:"teacherActivity"},i.createElement("div",{className:"teacherActivityWrapper"},(sCH.userM.isOnPrimePlan()||this.state.masqueradeReportParams)&&i.createElement("div",{className:"pageInfoTextWrapper"},i.createElement(c.default,{reportType:"admin",dateRangeData:this.state.dateRangeObj,setDateRange:this.setDateRange,dataRangeOptions:["Last 30 Days","Current School Year","Last School Year"]}),i.createElement(u.default,{timeSeriesChartData:a,timeUnit:r,practicesChartData:b.getPracticesChartData(n),teacherCountChartData:b.getTotalNumberOfTeachersBySchool(n),selectedTab:t,dateRangeData:this.state.dateRangeObj,fetchingTimeSeriesData:this.state.fetchingTimeSeriesData,setSelectedTab:this.setSelectedTab,showSummaryView:this.state.showSummaryView,toggleSummaryView:this.toggleSummaryView,isTableDataAvailable:n.length>0}),i.createElement(p.default,{date:this.state.dateRangeObj,csvData:o}),i.createElement(w,{toggleTeacherActivityTableView:this.toggleTeacherActivityTableView,selectedTab:t,showTableView:s}),i.createElement("div",{className:"dataWrapper "+(s?"":"collapsed")},this.state.el))))},t}(o.Component);t.default=_;var S=C.makeStyles({caretBtn:{padding:0,background:"transparent",border:"none",font:"inherit",cursor:"pointer","&:hover":{color:"unset !important"}},collapsed:{transform:"rotateZ(-90deg)"}}),w=function(e){var t=e.selectedTab,n=e.toggleTeacherActivityTableView,a=e.showTableView,s=S({});return i.createElement("h2",{className:"tableHeader"},i.createElement("button",{className:s.caretBtn,onClick:n,"aria-label":"expand/collapse"},i.createElement("div",{className:"caret "+(a?"":s.collapsed)})," By Teacher"),i.createElement(m.default,{className:"icon-question-mark-inverse",placement:"top"},i.createElement("p",null,"In this table, you can view overall activity statistics for your teachers and measure how often teachers use Actively Learn with their students and also quantify the reading behaviors they are producing.",i.createElement("br",null),i.createElement("br",null),t===v.TeacherActivityChartTabs.USAGE&&i.createElement(i.Fragment,null,i.createElement("span",null,"Active Learning Time represents the time students are actively scrolling and clicking in an assignment, not overall time on task."),i.createElement("br",null),i.createElement("br",null)),"Data for co-taught classes is shown in parenthesis.")))},T=function(e){var t=window.location.hash.split("?")[1],n=null;if((sCH.userM.get("IsMasquerading")||sCH.userM.hasMasqueradePermission())&&t){var a=f.getParamsFromQueryString(t);a.districtId&&parseInt(a.districtId,10)>0?n={idType:"districtId",id:parseInt(a.districtId,10)}:a.schoolId&&parseInt(a.schoolId)>0&&!(e||[]).find((function(e){return e.SchoolId===parseInt(a.schoolId)}))&&(n={idType:"schoolId",id:parseInt(a.schoolId,10)})}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1269),i=n(14),o=n(14),r=n(1270),l=n(1272),d=n(130),c=n(13).withStyles;t.default=c({chartTitle:{padding:"20px 0",cursor:"pointer"},chartTabPanel:{paddingBottom:"50px !important"},chartTabsWrapper:{paddingBottom:"20px"},timelineChartTab:{color:"#03A9F4",padding:"15px",maxWidth:"48%",background:"white",border:"none",fontSize:"14px",fontFamily:"Avenir Next LT W02 Demi",cursor:"pointer",boxShadow:"0px 1px 2px 0px #b7b7b7"},selected:{background:"#03A9F4",color:"white !important"},summaryViewWrapper:{maxHeight:"1000px",transition:"all 0.25s ease-in",transformOrigin:"top"},hideSummaryView:{maxHeight:0,transform:"scaleY(0)"},caretBtn:{padding:0,background:"transparent",border:"none",font:"inherit",cursor:"pointer","&:hover":{color:"unset !important"}},caretCollapsed:{transform:"rotateZ(-90deg)"}})((function(e){var t=a.useState("studentsLoggedIn"),n=t[0],c=t[1],u=e.classes,p=e.teacherCountChartData,h=e.timeSeriesChartData,g=e.practicesChartData,f=e.selectedTab,m=h.find((function(e){return"studentLoginsTimeline"===e.label}))||{data:[]},v=h.find((function(e){return"teacherLoginsTimeline"===e.label}))||{data:[]},b=[{tabId:"students-loggedIn",tabPanelId:"studentsLoggedIn-tab",tabName:o.TimeSeriesChartTabNames.STUDENTS_LOGGED_IN,tabText:"# of students logged in",data:m.data},{tabId:"teachers-loggedIn",tabPanelId:"teachersLoggedIn-tab",tabName:o.TimeSeriesChartTabNames.TEACHERS_LOGGED_IN,tabText:"# of teachers logged in",data:v.data}];return a.createElement("div",null,a.createElement("div",{role:"tablist","aria-label":"usages and practices tabs"},a.createElement("button",{role:"tab",id:"usage","aria-selected":f===i.TeacherActivityChartTabs.USAGE,className:"\n            btn-box toggler btnSwitchReportType\n            "+(f===i.TeacherActivityChartTabs.USAGE?"selected":"")+"\n          ",onClick:function(){return e.setSelectedTab(i.TeacherActivityChartTabs.USAGE)},"aria-controls":"usage-tab"},"Usage"),a.createElement("button",{role:"tab",id:"practices","aria-controls":"practices-tab","aria-selected":e.selectedTab===i.TeacherActivityChartTabs.PRACTICES,className:"\n            btn-box toggler btnSwitchReportType\n            "+(f===i.TeacherActivityChartTabs.PRACTICES?"selected":""),onClick:function(){return e.setSelectedTab(i.TeacherActivityChartTabs.PRACTICES)}},"Practices")),a.createElement("h2",{className:u.chartTitle},a.createElement("button",{className:u.caretBtn,onClick:e.toggleSummaryView,"aria-label":"expand/collapse"},a.createElement("div",{className:"caret "+(e.showSummaryView?"":u.caretCollapsed)})," Summary")),a.createElement("div",{className:u.summaryViewWrapper+" "+(e.showSummaryView?"":u.hideSummaryView)},e.selectedTab===i.TeacherActivityChartTabs.USAGE&&a.createElement("div",{role:"tabpanel",id:"usage-tab","aria-labelledby":"usage"},a.createElement("div",{className:u.chartTabsWrapper,role:"tablist","aria-label":"time-line-chart-tabs"},b.map((function(e){return a.createElement("button",{role:"tab",key:e.tabId,className:"\n                        "+u.timelineChartTab+"\n                        "+(n===e.tabName?u.selected:"")+"\n                      ",onClick:function(){return c(e.tabName)}},e.tabText)}))),"dadmin"===sCH.userM.get("Role")&&-1===sCH.selectedSchoolId?a.createElement(d.default,{container:!0,alignItems:"center"},a.createElement(d.default,{item:!0,xs:12,sm:12,md:12,lg:8},a.createElement(r.default,{selectedChartTab:n,dateRangeData:e.dateRangeData,data:b,fetchingTimeSeriesData:e.fetchingTimeSeriesData,timeUnit:e.timeUnit})),a.createElement(d.default,{className:u.chartTabPanel,item:!0,xs:12,sm:12,md:8,lg:4},e.isTableDataAvailable&&a.createElement(s.default,{data:p}))):a.createElement(d.default,{container:!0,alignItems:"center"},a.createElement(d.default,{item:!0,xs:12},a.createElement(r.default,{selectedChartTab:n,dateRangeData:e.dateRangeData,data:b,fetchingTimeSeriesData:e.fetchingTimeSeriesData,timeUnit:e.timeUnit})))),e.selectedTab===i.TeacherActivityChartTabs.PRACTICES&&a.createElement("div",{role:"tabpanel",id:"practices-tab","aria-labelledby":"practices",className:u.chartTabPanel},e.isTableDataAvailable?a.createElement(l.default,{data:g}):a.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric))))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(174),i=["#ff9f40","#ffcd56","#4bc0c0","#36a2eb","#ff6384"];t.default=function(e){var t=Object.values(e.data),n={labels:Object.keys(e.data),datasets:[{data:t,backgroundColor:i,hoverBackgroundColor:i}]};return a.createElement(s.Pie,{data:n,options:{legend:{display:!1}}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1271),i=n(13).withStyles;t.default=i({chartTabPanel:{paddingBottom:"50px"}})((function(e){var t=e.classes,n=e.data,i=e.selectedChartTab;return a.createElement("div",null,n.map((function(n){return i===n.tabName?a.createElement("div",{role:"tabpanel",key:n.tabPanelId,className:t.chartTabPanel},e.fetchingTimeSeriesData?a.createElement("div",{className:"ctaInfo"},"Fetching data..."):a.createElement("div",null,n.data.length>0?a.createElement(s.default,{timeUnit:e.timeUnit,dateRangeData:e.dateRangeData,data:n.data,xAxisLabel:"# of logins"}):a.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric))):a.createElement(a.Fragment,{key:n.tabPanelId})})))}))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(174),r=n(111),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.xAxisLabel,a=e.timeUnit,s=e.dateRangeData,l=Math.max.apply(Math,t.map((function(e){return e.count}))),d={callback:function(e,t,n){return e.toSystemDefaultLocaleString()}};return l<=10&&(d.beginAtZero=!0,d.stepSize=1),l<20?d.max=l+1:l<120&&(d.max=10*Math.floor(l/10)+10),i.createElement(o.Line,{height:250,data:{datasets:[{backgroundColor:"#03A9F4",borderColor:"#03A9F4",data:t.map((function(e){return{t:r(e.date).format("MMM DD YYYY"),y:e.count}})),type:"line",fill:!1,lineTension:0,borderWidth:2,pointBorderColor:"#03A9F4",pointBackgroundColor:"white",pointBorderWidth:1}]},options:{maintainAspectRatio:!1,legend:{display:!1},scales:{xAxes:[{type:"time",time:{unit:a},ticks:{source:"data"}}],yAxes:[{scaleLabel:{display:!0,labelString:n},ticks:d}]},tooltips:{intersect:!1,mode:"index",callbacks:{title:function(e,t){if("day"===a)return e[0].xLabel;var n=t.datasets[0].data;return n[e[0].index+1]?e[0].xLabel+" - "+r(n[e[0].index+1].t).subtract(1,"day").format("MMM DD YYYY"):e[0].xLabel+" - "+r(s.end).format("MMM DD YYYY")},label:function(e,t){return"Total number of logins - "+e.yLabel}}},plugins:{datalabels:{display:!1}}}})},t}(i.Component);t.default=l},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1273),r=n(13).withStyles,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.classes;return i.createElement("div",null,i.createElement("div",{className:n.legendSection},i.createElement("span",{className:n.legendWrapper},i.createElement("span",{className:n.greenLegend+" "+n.legendColor})," Evidence of Use"),i.createElement("span",{className:n.legendWrapper},i.createElement("span",{className:n.redLegend+" "+n.legendColor})," Areas to Improve")),t.map((function(e){return i.createElement("div",{className:n.barChartWrapper,key:e.displayName},e.data.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:n.barChartTextWrapper},i.createElement("div",null,e.displayName),i.createElement("span",{className:n.barChartLabelText},e.label)),i.createElement(o.default,{data:e.data,barColors:e.barColors})))})))},t}(i.Component);t.default=r({barChartWrapper:{margin:"18px 0",fontSize:"14px",fontFamily:"Avenir Next LT W02 Demi"},barChartTextWrapper:{display:"inline-block",width:"162px",paddingRight:"20px"},"@media (min-width: 945px)":{barChartTextWrapper:{textAlign:"right"}},barChartLabelText:{color:"#000000",opacity:"0.54",fontFamily:"AvenirNextLTW02-Medium",fontSize:"13px"},legendSection:{textAlign:"right",maxWidth:"680px",width:"100%"},legendWrapper:{padding:"10px 20px 10px 0",fontFamily:"Avenir Next LT W02 Bold",fontSize:14,color:"rgba(0,0,0,0.5)"},legendColor:{width:"10px",height:"10px",display:"inline-block",borderRadius:"50%",marginRight:"5px"},greenLegend:{background:"rgb(56, 142, 60)"},redLegend:{background:"rgb(211, 47, 47)"}})(l)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(65),r=n(13).withStyles,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getPercentage=function(e,t){return e/t*100},t.prototype.render=function(){var e=this.props,t=e.data,n=e.classes,a=e.barColors,s=t.reduce((function(e,t){return e+t}),0);return i.createElement("div",{className:n.barChart},i.createElement(o.default,{title:this.getPercentage(t[0],s).toFixed(2)+"%"},i.createElement("span",{className:n.barSegment,style:{width:this.getPercentage(t[0],s)+"%",background:a[0]}})),i.createElement(o.default,{title:this.getPercentage(t[1],s).toFixed(2)+"%"},i.createElement("span",{className:n.barSegment,style:{width:this.getPercentage(t[1],s)+"%",background:a[1]}})),i.createElement(o.default,{title:this.getPercentage(t[2],s).toFixed(2)+"%"},i.createElement("span",{className:n.barSegment,style:{width:this.getPercentage(t[2],s)+"%",background:a[2]}})))},t}(i.Component);t.default=r({barChart:{maxWidth:"480px",display:"inline-block",height:"30px",width:"100%"},barSegment:{display:"inline-block",height:"100%",textAlign:"right",lineHeight:"30px"}})(l)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(5),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.state={rows:[]},a}return s(t,e),t.prototype.componentDidMount=function(){var e=this;$(this.refs.exportForm).submit((function(){e.setState({rows:e.props.csvData.data})}))},t.prototype.render=function(){var e=this.props,t=e.csvData,n=e.date,a=t.fileName+"_"+n.start.format("DD-MMM-YY")+"_"+n.end.format("DD-MMM-YY");return i.createElement("form",{ref:"exportForm",className:"exportActivityWrapper displayNone",method:"post",action:r.getHostName(alcfg.node.class_gradebook.export)+alcfg.node.class_gradebook.export},i.createElement("input",{type:"hidden",name:"fileName",className:"fileName",value:a}),this.state.rows.map((function(e,t){return i.createElement("input",{type:"hidden",key:t,name:"csvRows[]",value:e})})),i.createElement("input",{type:"submit",value:"Submit"}))},t}(o.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(60),s=n(8),i=n(0),o=n(14),r=n(5),l=n(65),d={school:220,plan:100,status:100,userName:220,answersWithTeacherComment:100,notesWithCategory:200},c=function(e){return d[e]||150},u=function(e){var t=e.allSchoolMode,n=void 0!==t&&t,a=(e.isMasqueradingReport,e.isForExportActivityData),i=void 0!==a&&a,r=e.viewType,l=void 0===r?o.TeacherActivityChartTabs.USAGE:r,d=["name","subject","plan","studentsWithReadingTime","assignmentsWithReadingTime","totalReadingTime","totalTeacherLogins","totalQuestionResponse"],c=["name","subject","school","plan","studentsWithReadingTime","studentsWithReadingTimeForCoTaughtClasses","assignmentsWithReadingTime","assignmentsWithReadingTimeForCoTaughtClasses","totalReadingTime","totalReadingTimeForCoTaughtClasses","totalTeacherLogins","totalQuestionResponse","totalFeedback","totalRevision","questioning","discussion","extraHelp","accessibility","vocabulary","notes","notesWithCategory"];return n||(c=s.without(c,"school")),sCH.userM.isOnFullPrimePlan()&&(d=s.without(d,"plan"),c=s.without(c,"plan")),i?c:l===o.TeacherActivityChartTabs.USAGE?d:["name","subject","totalReadingTime","notes","questioning","discussion","extraHelp","accessibility","vocabulary","totalFeedback","notesWithCategory","totalRevision"]},p=function(e){var t=g(e.data),n=[],a=u({viewType:e.viewType,allSchoolMode:-1===e.schoolId,isMasqueradingReport:e.isMasqueradingReport});return s.forEach(t,(function(t){var s={name:{displayValue:r.sanitize(t.LastName+", "+t.FirstName)},subject:{displayValue:r.sanitize(t.Subject)},school:{displayValue:e.isMasqueradingReport?i.createElement("a",{onClick:function(){return function(e){var t={idType:"schoolId",id:e};Backbone.pubEv.trigger("setTeacherActivityReportSearchData",t),Backbone.pubEv.trigger("TeacherActivityMasqueradeSchoolSearched",t)}(t.SchoolId)}},r.sanitize(t.SchoolName)):r.sanitize(t.SchoolName)},plan:{displayValue:t.Plan},status:{displayValue:t.Status||""},lastSignInDate:{displayValue:t.LastSignInDate?moment.utc(t.LastSignInDate).format("MMM D, YYYY"):""},userName:{displayValue:i.createElement(l.default,{title:t.UserName.length>28?t.UserName:"",tooltipPlacement:"bottom"},i.createElement("span",null,r.truncate(t.UserName,28))),sortValue:t.UserName},studentsWithReadingTime:{displayValue:i.createElement("span",null,t.NumStudents.toSystemDefaultLocaleString(),t.NumStudentsAsCoTeacher>0?" ("+t.NumStudentsAsCoTeacher.toSystemDefaultLocaleString()+")":""),sortValue:t.NumStudents},assignmentsWithReadingTime:{displayValue:i.createElement("span",null,t.AssignmentsCreated.toSystemDefaultLocaleString(),t.AssignmentsCreatedAsCoTeacher>0?" ("+t.AssignmentsCreatedAsCoTeacher.toSystemDefaultLocaleString()+")":""),sortValue:t.AssignmentsCreated},totalReadingTime:{displayValue:i.createElement("div",null,i.createElement("div",null,r.getFormattedTime(t.LearningTimeSeconds||0,!1)),t.LearningTimeSecondsAsCoTeacher>0?i.createElement("div",{title:"Total reading time for co-taught classes"}," (",r.getFormattedTime(t.LearningTimeSecondsAsCoTeacher,!1),")"):""),sortValue:t.LearningTimeSeconds+t.LearningTimeSecondsAsCoTeacher},totalQuestionResponse:{displayValue:t.NumResponses.toSystemDefaultLocaleString()},assignmentsWithEH:{displayValue:t.NumAssignmentWithEH.toSystemDefaultLocaleString()},totalFeedback:{displayValue:t.NumTeacherComment.toSystemDefaultLocaleString()},totalRevision:{displayValue:t.NumRevisions.toSystemDefaultLocaleString()},notes:{displayValue:t.NumStudentNotes.toSystemDefaultLocaleString()},questioning:{displayValue:t.NumQuestionAdded.toSystemDefaultLocaleString()},discussion:{displayValue:t.NumStudentSharedNotes.toSystemDefaultLocaleString()},extraHelp:{displayValue:t.NumAssignmentWithEH.toSystemDefaultLocaleString()},accessibility:{displayValue:(t.NumStudentsTTSCount+t.NumStudentTranslationCount).toSystemDefaultLocaleString()},vocabulary:{displayValue:t.NumStudentsLookupCount.toSystemDefaultLocaleString()},notesWithCategory:{displayValue:t.NumStudentNotesWithCategory.toSystemDefaultLocaleString()},noteReplies:{displayValue:t.NumStudentNoteResponses.toSystemDefaultLocaleString()},totalTeacherLogins:{displayValue:t.NumTeacherLogins.toSystemDefaultLocaleString()}};n.push({height:65,cells:a.map((function(e){return{content:s[e].displayValue,width:c(e),sortValue:void 0!==s[e].sortValue?s[e].sortValue:s[e].displayValue,classes:{center:"name"!==e}}}))})})),n},h={name:"Teacher Name",subject:"Subject",school:"School Name",plan:"Plan",status:"Status",userName:"UserName",lastSignInDate:"Last Sign In",studentsWithReadingTime:"# Active Students",studentsWithReadingTimeForCoTaughtClasses:"# Active Students For Co-taught Classes",assignmentsWithReadingTime:"# of Assignments",assignmentsWithReadingTimeForCoTaughtClasses:"# of Assignments For Co-taught Classes",questionAnswered:"Number of Questions Answered",answersWithTeacherComment:"Answer with Teacher's Comment",totalReadingTime:"Total Active Learning Time",totalReadingTimeForCoTaughtClasses:"Total Active Learning Time For Co-taught Classes",totalQuestionResponse:"Total Question Responses",assignmentsWithEH:"Assignments w/ Extra Help Students",totalFeedback:"Teacher Feedback",totalRevision:"Total Answer Revisions",notes:"Total Student Notes",questioning:"Questioning",discussion:"Discussion",extraHelp:"Extra Help",accessibility:"Accessibility",vocabulary:"Vocabulary",notesWithCategory:"Student Notes w/ Category",noteReplies:"Student Note Replies",totalTeacherLogins:"# of Teacher Logins"},g=function(e){return s.forEach(e,(function(e){var t=s.find(o.UserSubjects,{value:e.SubjectId});e.Subject=t?t.label:""})),e};t.getCSVData=function(e){var t,n,a,i=(t=e.data,n=[],a=g(t),s.forEach(a,(function(e){var t={name:r.sanitize(e.LastName+", "+e.FirstName),subject:r.sanitize(e.Subject),school:r.sanitize(e.SchoolName),plan:e.Plan,status:e.Status,userName:e.UserName,lastSignInDate:e.LastSignInDate?moment.utc(e.LastSignInDate).format("MMM D, YYYY"):"",studentsWithReadingTime:""+e.NumStudents,studentsWithReadingTimeForCoTaughtClasses:""+e.NumStudentsAsCoTeacher,assignmentsWithReadingTime:""+e.AssignmentsCreated,assignmentsWithReadingTimeForCoTaughtClasses:""+e.AssignmentsCreatedAsCoTeacher,totalReadingTime:""+r.convertSecondsToDecimalHours(e.LearningTimeSeconds||0),totalReadingTimeForCoTaughtClasses:""+r.convertSecondsToDecimalHours(e.LearningTimeSecondsAsCoTeacher||0),totalQuestionResponse:e.NumResponses,totalTeacherLogins:e.NumTeacherLogins,assignmentsWithEH:e.NumAssignmentWithEH,totalFeedback:e.NumTeacherComment,totalRevision:e.NumRevisions,notes:e.NumStudentNotes,notesWithCategory:e.NumStudentNotesWithCategory,noteReplies:e.NumStudentNoteResponses,questioning:e.NumQuestionAdded,discussion:e.NumStudentSharedNotes,extraHelp:e.NumAssignmentWithEH,accessibility:e.NumStudentsTTSCount+e.NumStudentTranslationCount,vocabulary:e.NumStudentsLookupCount};n.push(t)})),n),o=u({viewType:e.viewType,allSchoolMode:-1===e.schoolId,isMasqueradingReport:e.isMasqueradingReport,isForExportActivityData:!0}),l=[],d="teacher_activity",c=o.map((function(e){return h[e]}));if(l.push(c),i.forEach((function(e){var t=o.map((function(t){return e[t]}));l.push(t)})),-1!==sCH.selectedSchoolId){var p=(e.data.find((function(e){return e.SchoolId===sCH.selectedSchoolId}))||{}).SchoolName;d="teacher_activity_"+(void 0===p?"":p).toLowerCase().replace(/ /g,"_")}return{data:l.map((function(e){return e.map((function(e){return r.replaceQuoteInCSVData(e||0===e?e:"")})).join(",")})),fileName:d}},t.TeacherActivityTable=function(e){var t,n,s,o=p(e);return 0===o.length?i.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric):i.createElement(a.VTable,{header:(t=e.schoolId,n=e.isMasqueradingReport,s=e.viewType,{height:65,cells:u({viewType:s,allSchoolMode:-1===t,isMasqueradingReport:n}).map((function(e){return{content:h[e],width:c(e),classes:{center:"name"!==e}}}))}),body:o,enableFixedColumnScroll:!0,fixedRowCount:1,fixedColumnCount:1,customClassNames:["teacherActivityTableWrappper"],sortByColumnIndex:u({viewType:e.viewType,allSchoolMode:-1===e.schoolId,isMasqueradingReport:e.isMasqueradingReport}).indexOf("totalReadingTime"),sortDescending:!0})}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=n(85),i=n(20);t.default=Backbone.View.extend({el:".switchRole .scroll",template:n(1278),events:{"click .btnProceed":"switchRole","click .btnCancel":"cancel"},initialize:function(e){this.switchTo=e.switchTo,"student"===sCH.userM.get("Role")&&"student"===e.switchTo?window.location.hash="student/classes":"teacher"===sCH.userM.get("Role")&&"teacher"===e.switchTo?window.location.hash="teacher/catalog":"admin"===sCH.userM.get("Role")&&"teacher"===e.switchTo?window.location.hash="teacher/school/teachers":"dadmin"===sCH.userM.get("Role")&&"teacher"===e.switchTo?window.location.hash="teacher/school/teachers":($("body").addClass("blueBackground noCssTransitions"),this.render())},render:function(){if(this.$el.html(this.template({switchTo:this.switchTo,productImage:i.default.isMath?i.default.mathIframeOrigin+"/logo512.png":"/img/Logo_BlueBlack.png"})),"teacher"===this.switchTo){var e=this;window.setTimeout((function(){e.switchRole()}),1500)}},switchRole:function(){this.$el.find(".btnProceed").text("Proceeding...").addClass("disabled").prop("disabled",!0),a.SwitchRole({switchTo:this.switchTo},(function(e){e&&(sCH.clear(),s.initAppAndCheckAuthentication(e,(function(){window.location.href=e.Url})))}))},cancel:function(){window.history.back()},destroy:function(){this.$el.empty(),$("body").removeClass("blueBackground noCssTransitions")}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\n    <img class="logo" src="'+(null==(__t=productImage)?"":__t)+'" />\n    ',"teacher"===switchTo?__p+="\n        <p>Exiting student mode...</p>\n    ":__p+="\n        <p>\n            Heads up! You are about to enter student mode.<br><br>\n            You will now experience "+(null==(__t=cH.getProductName())?"":__t)+' just like any other student. You will need to join classes <b>(even your own!)</b> to read assignments.<br><br>\n            Remember, you can always switch back from the account menu.\n        </p>\n        \n        <div class="clearBoth" style="height: 10px;"></div>\n        <a class="btn-box callout large pull-right marginLeft btnProceed">Proceed</a>\n        <a class="btn-box large pull-right btnCancel">Cancel</a>\n    ',__p+="\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.View.extend({el:".pageNotFound .scroll",template:n(1280),initialize:function(){$("body").addClass("blueBackground"),this.render()},events:{"click .btnGoBack":"mainPage"},render:function(){return $(".mainMenu, .mainHeader").html(""),this.$el.html(this.template()),this},mainPage:function(){window.location.href="/"},destroy:function(){this.$el.empty(),$("body").removeClass("blueBackground")}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\r\n    <a href="/">\r\n        <img class="logo" src="/img/Logo_BlueBlack.png" />\r\n    </a>\r\n    <p>\r\n        We couldn\'t find what you\'re looking for!\r\n    </p>\r\n    <p>\r\n        We sincerely apologize for the inconvenience.\r\n    </p>\r\n    <p class="footNote">\r\n        -The Actively Learn Team\r\n    </p>\r\n    <a class="btnGoBack btn-box callout large">Go back to Actively Learn</a>\r\n</div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(1282),i=n(1285),o=n(10),r=n(69);t.default=Backbone.View.extend({el:"div.adminStandards",initialize:function(){this.scroll=new i.default({scope:this}),this.subheader=new s.default({scope:this}),this.childViews=[this.subheader,this.scroll],Backbone.pubEv.trigger("setSiteSection","Standards"),sCH.userM.isOnPrimePlan()?this.getStandardSets():(this.$el.find(".layout").html(new r.default({text:alcfg.infoText.aData.customStandardsFree,screenshotUrl:"/img/Manage_Standards.png",showSampleBanner:!0}).render().$el),this.scroll.preRender(alcfg.infoText.aData.customStandardsFree))},getStandardSets:function(){var e=this;o.GetStandardSets((function(t){t?(e.data=t,Backbone.pubEv.trigger("setHeaderActions",{selectors:[{type:"standardset",preSelectedValue:t[0].StandardSetId,data:a.map(t,(function(e){return{value:e.StandardSetId,label:e.Title,dataContent:e.BuildingName}})),callback:function(t){e.render(t)}}],actionButtons:{type:"Standards",props:{scope:e}}})):e.scroll.$el.html("<div class='ctaInfo'>"+alcfg.infoText.generic.noData+"</div>")}))},render:function(e){var t=a.find(this.data,{StandardSetId:e});this.selectedStandardSetId=e,t.IsDefault?$(".standardSetsDropdown").addClass("displayNone"):$(".standardSetsDropdown").removeClass("displayNone"),this.subheader.render(),this.scroll.preRender(),t.IsPublished&&$(".btnPublishStandardSet").addClass("displayNone")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(726);t.default=Backbone.View.extend({el:"div.adminStandards .subheader",events:{"click .btnAddNewStandard":"addNewStandard","click .btnPublishStandardSet":"publishStandardSet"},template:n(1284),initialize:function(e){this.scope=e.scope},render:function(){a.find(this.scope.data,{StandardSetId:this.scope.selectedStandardSetId}).IsDefault?this.$el.hide():this.$el.html(this.template()).show()},addNewStandard:function(){var e=this,t=a.find(e.scope.data,{StandardSetId:this.scope.selectedStandardSetId});new Backbone.BootstrapModal({title:"Add standard",content:new o.default({mode:"add",parent:e,standardSetId:e.scope.selectedStandardSetId,isPublished:t.IsPublished,callback:function(t){e.scope.scroll.standards.push(t),e.scope.scroll.render()}}),cssClass:"modal-al-add-standard",okText:"Add",allowCancel:!1}).open()},publishStandardSet:function(){var e=this;new Backbone.BootstrapModal({title:"Publish standard set?",content:"This will make it live to teachers.",cssClass:"modal-al-publish-standard-set",okText:"Publish"}).open((function(){var t={standardSetId:e.scope.selectedStandardSetId};i.PublishStandardSet(t,(function(){$(".btnPublishStandardSet").addClass("displayNone"),s.bootstrap.alert({message:"Published the standard set!"}),a.find(e.scope.data,{StandardSetId:e.scope.selectedStandardSetId}).IsPublished=!0}))}))},destroy:function(){this.$el.show()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="",isPublished&&(__p+='\n    <p>Note: changes will affect existing assignments.</p>\n    <div class="clearBoth" style="height: 20px;"></div>\n'),__p+='\n\n<div class="sectionTitle">Info</div>\n<label style="width:42px;">Code</label>\n<input id="txtCode" value="'+(null==(__t=cH.sanitize(standard.StandardCode))?"":__t)+'" maxlength="12" style="width:110px;" placeholder="ex. RL.1"/>\n\n<label style="width:76px;margin-left: 30px;">Short Text</label>\n<input id="txtShortText" value="'+(null==(__t=cH.sanitize(standard.ShortText))?"":__t)+'" maxlength="50" style="width:246px;" placeholder="ex. Meaning & Evidence"/>\n\n<label style="width:90px;">Description</label>\n<div contenteditable id="txtDescription">'+(null==(__t=cH.sanitize(standard.Description))?"":__t)+'</div>\n\n<div class="sectionTitle">Rubric</div>\n';var rubric=standard.RubricData?JSON.parse(standard.RubricData):[],advanced=_.find(rubric,{type:"advanced"}),proficient=_.find(rubric,{type:"proficient"}),basic=_.find(rubric,{type:"basic"}),incomplete=_.find(rubric,{type:"incomplete"}),zero=_.find(rubric,{type:"zero"});__p+='\n\n<label>Advanced</label>     <div contenteditable id="txtAdvanced">  '+(null==(__t=advanced?cH.sanitize(_.map(advanced.critique,"text").join("<br>")):"")?"":__t)+'        </div>\n<label>Proficient</label>   <div contenteditable id="txtProficient">'+(null==(__t=proficient?cH.sanitize(_.map(proficient.critique,"text").join("<br>")):"")?"":__t)+'    </div>\n<label>Basic</label>        <div contenteditable id="txtBasic">     '+(null==(__t=basic?cH.sanitize(_.map(basic.critique,"text").join("<br>")):"")?"":__t)+'              </div>\n<label>Incomplete</label>   <div contenteditable id="txtIncomplete">'+(null==(__t=incomplete?cH.sanitize(_.map(incomplete.critique,"text").join("<br>")):"")?"":__t)+'    </div>\n<label>Zero</label>         <div contenteditable id="txtZero">      '+(null==(__t=zero?cH.sanitize(_.map(zero.critique,"text").join("<br>")):"")?"":__t)+"        </div>"}return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="selectedAction">\n    <div class="selectedActionInner">\n        <span class="text"></span>\n        <button class="btnNext btn-box disabled">Next</button>\n        <button class="btnCancel btn-box">Cancel</button>\n    </div>\n</div>\n\n<div class="rowOne">\n    <a class="btn-box pull-left btnAddNewStandard">Add New Standard</a>\n    <a class="btn-box pull-left btnPublishStandardSet">Publish Set</a>\n</div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(726),r=n(87);t.default=Backbone.View.extend({el:"div.adminStandards .scroll",events:{"click .btnEditStandard":"editStandard","click .btnDeleteStandard":"deleteStandard"},template:n(1286),initialize:function(e){this.scope=e.scope},preRender:function(e){if(e)this.$el.html("<div class='ctaInfo'>"+e+"</div>");else{var t=this;i.GetStandards({standardSetId:t.scope.selectedStandardSetId},(function(e){e?(t.standards=e,t.render()):t.$el.html("<div class='ctaInfo'>"+alcfg.infoText.generic.noData+"</div>")}))}},render:function(){var e=a.find(this.scope.data,{StandardSetId:this.scope.selectedStandardSetId}),t=this.standards.sort((function(e,t){return r(e.StandardCode,t.StandardCode)}));this.$el.html(this.template({standards:t,isDefault:e.IsDefault})),s.initTooltips(this.$el)},editStandard:function(e){var t=a.find(this.scope.data,{StandardSetId:this.scope.selectedStandardSetId}),n=parseInt($(e.currentTarget).closest("li").data("standardid")),s=a.find(this.standards,{StandardId:n}),i=this;new Backbone.BootstrapModal({title:"Edit standard",content:new o.default({mode:"edit",standardId:n,standardSetId:i.scope.selectedStandardSetId,isPublished:t.IsPublished,parent:i,callback:function(e){a.extend(s,e),i.render()}}),cssClass:"modal-al-add-standard",okText:"Save",allowCancel:!1}).open()},deleteStandard:function(e){var t=parseInt($(e.currentTarget).closest("li").data("standardid")),n=this;new Backbone.BootstrapModal({title:"Delete this standard?",content:"",cssClass:"modal-al-delete-standard",okText:"Delete"}).open((function(){i.DeleteStandard({standardId:t},(function(){n.standards=n.standards.filter((function(e){return e.StandardId!==t})),n.render()})),s.bootstrap.alert({message:"Deleted the standard!"})}))},destroy:function(){}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",standards.length>0?(__p+='\n    <ul class="standardset">\n        ',_.each(standards,(function(e,t){__p+='\n            <li class="standard" data-standardid="'+(null==(__t=e.StandardId)?"":__t)+'">\n                <table class="tablesorter">\n                    <tr class="nohover info">\n                        <td colspan="',print(isDefault?"4":"5"),__p+='" class="left">\n                            <span class="code">'+(null==(__t=cH.sanitize(e.StandardCode))?"":__t)+'</span>\n                            <span class="shorttext">'+(null==(__t=cH.sanitize(e.ShortText))?"":__t)+"</span>\n                            ",isDefault||(__p+='\n                                <a class="icon-trash pull-right btnDeleteStandard"></a>\n                                <a class="icon-pencil pull-right btnEditStandard"></a>\n                            '),__p+="\n                            <br/> \n                            "+(null==(__t=cH.sanitize(e.Description))?"":__t)+'\n                        </td>\n                    </tr>\n                    <tr class="nohover rubric">\n                        ';var n=JSON.parse(e.RubricData);_.each(n,(function(e,t){__p+='\n                            <td valign="top" class="left">\n                                <div class="large">'+(null==(__t=cH.sanitize(e.type))?"":__t)+"</div>\n                                ",_.each(e.critique,(function(e){__p+='\n                                    <div class="text">'+(null==(__t=0===e.text.length?"No rubric added":cH.sanitize(e.text))?"":__t)+"</div>\n                                "})),__p+="\n                            </td>\n                        "})),__p+="\n                    </tr>\n                </table>\n            </li>\n        "})),__p+="\n    </ul>\n"):isDefault?__p+="\n    <div class='ctaInfo'>Nothing to see here yet!</div>\n":__p+="\n    <div class='ctaInfo'>Click 'Add new standard' above to get started!</div>\n",__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(1288),o=n(1290),r=n(744),l=n(746),d=n(22),c=n(1342);t.default=Backbone.View.extend({el:"div.adminTeachers",initialize:function(e){var t=this;this.subview=e.subview||"overview",this.subheader=new i.default({scope:this}),this.childViews=[this.subheader],sCH.userM.isOnPrimePlan()?sCH.initTeachersInstruction((function(){if(t.subheader.render(),sCH.teachersC.length>0){var e=a.map(sCH.teachersC.toJSON(),(function(e){return{value:e.UserId,label:s.sanitize(e.LastName)+", "+s.sanitize(e.FirstName)}}));Backbone.pubEv.trigger("setHeaderActions",{selectors:[{type:"teacher",data:a.uniqBy(e,(function(e){return e.value})),preSelectedValue:sCH.teachersC.models[0].get("UserId"),callback:function(e){sCH.instructionsSelectedTeacherUserId=e,t.subviewSelector()}}]})}else t.subviewSelector()})):(sCH.teachersC=[{UserId:1}],t.subheader.render(),t.subviewSelector())},subviewSelector:function(){Backbone.router.navigate("teacher/teachers/"+this.subview,{trigger:!1});if(s.intercom("trackEvent","admin-teacher-reports-"+this.subview),this.subheader.selectTab(this.subview),0!==sCH.teachersC.length){switch(this.scrollView&&(this.childViews.pop(),this.scrollView.close(!1)),this.subview){case"questions":this.renderQuestions();break;case"gradingfeedback":this.renderGradingFeedback();break;case"assignments":this.renderAssignments();break;default:this.renderOverview()}this.scrollView&&this.childViews.push(this.scrollView)}else $(".scroll").html("<div class='ctaInfo'>"+alcfg.infoText.aData.noPrimeUsers+"</div>")},renderAssignments:function(){this.scrollView=new o.default({teacherUserId:sCH.instructionsSelectedTeacherUserId}),this.scrollView.preRender()},renderOverview:function(){Backbone.router.navigate("teacher/teachers/overview",{trigger:!1}),this.$el.find(".scroll").html('<div id="adminDataOverview"/>'),d.mountReactComponent(c.default,this.$el.find("#adminDataOverview")[0],{teacherUserId:sCH.instructionsSelectedTeacherUserId})},renderQuestions:function(){this.scrollView=new r.default({teacherUserId:sCH.instructionsSelectedTeacherUserId}),this.scrollView.preRender()},renderGradingFeedback:function(){this.scrollView=new l.default({teacherUserId:sCH.instructionsSelectedTeacherUserId}),this.scrollView.preRender()}})},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);t.default=Backbone.View.extend({el:".adminTeachers .subheader",events:{"click .tabs a:not(.selected)":"selectSubview","change .ddlStandards":"filter","change .ddlQuesType":"filter","click .btnPrintView":"printView"},template:n(1289),initialize:function(e){this.scope=e.scope},render:function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this,[4,i.renderBackboneTemplateAsync(this.el,this.template())];case 1:return e.sent(),$(".rowTwo").hide(),[2]}}))}))},selectTab:function(e){this.$el.find("a.btn-tab").removeClass("selected"),this.$el.find('.btn-tab[data-view="'+e+'"]').addClass("selected"),"questions"===e&&sCH.userM.isOnPrimePlan()&&$(".rowTwo").show()},selectSubview:function(e){this.scope.subview=$(e.currentTarget).data("view"),this.scope.subviewSelector()},filter:function(){this.scope.scrollView.filter()},printView:function(){var e=$(".mainHeader .dropdown-toggle").text()+" - Questions report",t=$(".subheader .ddlQuesType").val(),n=$(".subheader .ddlStandards").val(),a="";"hasstandard"!==n&&(a+=" : "+n),"-1"!==t&&(a+=" : "+("1"===t?"Short Answer":"2"===t?"Multiple Choice":"Poll")),i.print(e+a)}})}).call(this,n(21))},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<nav role="tablist" aria-label="Tabs" class="tabs">\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabOverview selected" data-view="overview">Overview</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabAssignments" data-view="assignments">Assignments</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabQuestions" data-view="questions">Questions</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabGradingfeedback" data-view="gradingfeedback">Feedback</a>\r\n</nav>\r\n<aside class="rowTwo">\r\n    <button class="btn-tab btnPrintView icon-print" title="print" aria-haspopup="true" aria-expanded="false"></button>\r\n    <select class="ddlStandards">\r\n    </select>\r\n    <select class="ddlQuesType">\r\n    </select>\r\n</aside>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(10),i=n(14),o=n(132),r=n(69);t.default=Backbone.View.extend({el:".layout .scroll",events:{},initialize:function(e){this.teacherUserId=e.teacherUserId},preRender:function(){if(sCH.userM.isOnPrimePlan()){var e=this;s.GetTeacherAssignments({teacherUserId:this.teacherUserId},(function(t){e.data=t,e.render()}))}else this.$el.html(new r.default({screenshotUrl:"/img/TeacherReports_Assignments.png",showSampleBanner:!0}).render().$el)},render:function(){if(this.data.length>0){this.$el.html('<ul class="tiles instructionReport">');var e=this.$el.find("ul.instructionReport")[0];a.mountReactComponent(o.default,e,{page:i.Page.INSTRUCTION_REPORT,tiles:this.data})}else this.$el.html("<div class='ctaInfo'>This teacher does not have any assignments yet.</div>")},destroy:function(){}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(342),r=n(346),l=function(e){function t(t,n){return e.call(this,t)||this}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.isDragging?.4:1;return(0,e.connectDragSource)(i.createElement("div",{className:"tileWrapper",style:{opacity:t}},i.createElement(r.default,{data:this.props.data,page:this.props.page})))},t}(i.Component);t.default=o.DragSource("Tile",{beginDrag:function(e){return{layerId:e.data.LayerId,layerType:e.data.LayerType,folderId:e.data.FolderId,rentalPrices:e.data.RentalPrices}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging(),connectDragPreview:e.dragPreview()}}))(l)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(14),i=n(5),o=n(22),r=n(274),l=n(10),d=n(154),c=n(1331);t.default=Backbone.View.extend({events:{"change .chkSelectClass[type='checkbox']:not(.assigned)":"classSelected","change .chkSelectClass.assigned[type='checkbox']":"unassignLayerFromClass","change #ddlExcerpts":"excerptSelected","click #btnCreateLayerTextSectionExcerpt":"createLayerTextSectionExcerpt","click .syncToExternalLMSOption.disabled":"syncToExternalLMSOptionClicked"},template:n(1333),initialize:function(e){this.selectedLayer=e.selectedLayer,this.assignHelper=e.assignHelper,this.on("ok",this.assign),this.on("initialized",this.modalInitialized),this.on("cancel",this.destroy),this.on("shown",this.addTooltipToLongClassNames),Backbone.pubEv.on("layerTextSectionExcerptClosed",this.layerTextSectionExcerptClosed,this);var t=a.filter(sCH.classesC.models,(function(e){return"google"===e.get("Source")})).length>0;sCH.userM.get("Accounts").google&&t&&d.init(["https://www.googleapis.com/auth/classroom.coursework.students","https://www.googleapis.com/auth/classroom.coursework.students.readonly"],null,!1)},modalInitialized:function(e){this.modal=e,this.selectedLayer.RentalPrices&&!sCH.userM.isSchoolUsingContentCredits()?this.purchasedPreRender():this.preRender()},purchasedPreRender:function(){var e=this;l.GetStudentCount({learnEntityId:this.selectedLayer.LearnEntityId},(function(t){t&&(e.numTotalLicenses=t.numTotalLicenses,e.assignedStudentLicenses=t.assignedStudentLicenses,e.preRender())}))},preRender:function(){var e=this;l.GetAssignedClasses({layerId:this.selectedLayer.LayerId,isUserLayer:this.selectedLayer.IsUserLayer},(function(t){t.LayerIdToAssign?(e.selectedLayer.LayerId=t.LayerIdToAssign,e.selectedLayer.ShouldCopyLayer=!1):e.selectedLayer.ShouldCopyLayer=!0,e.selectedLayer.AssignedClasses=t.AssignedClasses,e.sections=t.Sections,e.excerpts=t.Excerpts,e.modal.open(),e.modal.disableOk("Assign")}))},render:function(){var e=(!this.selectedLayer.RentalPrices||alcfg.paidpublishers.allowExcerpting.indexOf(this.selectedLayer.Publisher)>-1)&&this.sections.length>1,t=sCH.classesC.toJSON(),n=t.find((function(e){return e.Source===s.ClassSource.SCHOOLOGY||e.Source===s.ClassSource.CANVAS}));return this.$el.html(this.template({classes:t,selectedLayer:this.selectedLayer,shouldShowTextSectionExcerptControls:e,excerpts:this.excerpts,hasAnySchoologyOrCanvasSection:n})),sCH.learnEntityMetaM&&sCH.learnEntityMetaM.get("LayerTextSectionExcerptId")&&(this.excerptSelected({LayerTextSectionExcerptId:sCH.learnEntityMetaM.get("LayerTextSectionExcerptId")}),this.$el.find("#ddlExcerpts").selectpicker(),this.$el.find("#ddlExcerpts").selectpicker("val",sCH.learnEntityMetaM.get("LayerTextSectionExcerptId"))),e&&(this.$el.find("#ddlExcerpts").selectpicker(),this.addCreateExcerptButton()),this},addTooltipToLongClassNames:function(){var e=!1;this.$el.find(".checklist .title").each((function(){var t=$(this)[0];t.offsetWidth<t.scrollWidth&&(e=!0,$(this).attr("title",$(this).text()))})),e&&i.initTooltips(this.$el)},addCreateExcerptButton:function(){this.$el.find("ul.dropdown-menu.inner").append('<li class="divider"></li><li><a class="btn-box callout small pull-left" id="btnCreateLayerTextSectionExcerpt">Choose specific sections</a></li>')},excerptSelected:function(e){var t=this;this.$el.find(".checklist.disabled").removeClass("disabled"),this.selectedTextSectionExcerptId=e.LayerTextSectionExcerptId||(1===e.currentTarget.selectedIndex?null:parseInt($(e.currentTarget).val())),this.selectedTextSectionExcerptTitle=e.Title||$(e.currentTarget).find("option:selected").text();var n=this.selectedLayer.AssignedClasses.filter((function(e){return e.LayerTextSectionExcerptId===t.selectedTextSectionExcerptId})).map((function(e){return e.ClassId}));sCH.classesC.forEach((function(e){var a=e.get("ClassId"),s=n.indexOf(a)>=0,i='<input\n        id="chkSelectClass'+a+'"\n        data-classid="'+a+'"\n        type="checkbox"\n        class="chkSelectClass regular-checkbox '+(s?"assigned":"")+'"\n        '+(s?"checked":"")+'/>\n        <label for="chkSelectClass'+a+'"></label>';t.$el.find('.checkbox[data-classid="'+a+'"]').html(i)}))},createLayerTextSectionExcerpt:function(){o.mountReactComponent(c.default,this.$el.find("#createExcerpt")[0],{layerId:this.selectedLayer.LayerId,textSections:this.sections,textTitle:this.selectedLayer.Title,shouldCopyLayer:this.selectedLayer.ShouldCopyLayer})},layerTextSectionExcerptClosed:function(e){o.unmountReactComponent(this.$el.find("#createExcerpt")[0]),e&&(this.$el.find("#ddlExcerpts option:last-child").after('<option selected value="'+e.LayerTextSectionExcerptId+'">'+i.sanitize(e.Title)+"</option>"),this.$el.find("#ddlExcerpts").selectpicker("refresh"),this.addCreateExcerptButton(),this.excerptSelected(e),e.LayerId&&(this.selectedLayer.LayerId=e.LayerId,this.selectedLayer.ShouldCopyLayer=!1,sCH.readerConfig?this.shouldNavigateAfterCreatingExcerpt=!0:Backbone.pubEv.trigger("createdUserLayer",{layerId:e.LayerId,isAssigned:!1})))},classSelected:function(e){var t=$(e.currentTarget).data("classid");"google"===sCH.classesC.find({ClassId:t}).get("Source")&&this.$el.find(".gclassroominfo").show(),this.$el.find("input[type='checkbox']:checked:not(.assigned)").length>0?this.modal.enableOk("Assign"):this.modal.disableOk("Assign");var n=document.querySelector('.syncToExternalLMSOption[data-classid="'+t+'"]');n&&(document.getElementById("chkSelectClass"+t).checked?n.classList.remove("disabled"):(n.classList.add("disabled"),document.getElementById("chkSyncToExternalClass"+t).checked=!1))},syncToExternalLMSOptionClicked:function(e){e.stopPropagation()},assign:function(e){if(e.preventClose(),this.$el.find("#ddlExcerpts").length>0&&""===$("#ddlExcerpts").val())i.bootstrap.alert({message:"Please select sections to assign!",alert:"danger"});else{var t=[];a.each(this.$el.find(".chkSelectClass[type='checkbox']:checked:not(.assigned)"),(function(e){t.push($(e).data("classid"))})),a.each(this.$el.find(".chkSelectClass[type='checkbox'].assigned:checked"),(function(e){t.push($(e).data("classid"))}));var n=this.getTotalUniqueStudentsForAssignedClasses(t),s=a.uniq(this.selectedLayer.AssignedClasses.map((function(e){return e.ClassId})));!t.every((function(e){return s.indexOf(e)>-1}))&&n.length>this.numTotalLicenses-this.assignedStudentLicenses?this.showPurchaseLicensesPopup({classIds:t,modal:e,layerTextSectionExcerptId:this.selectedTextSectionExcerptId||void 0}):(e.disableOk("Assigning..."),this.addAssignments({classIds:t,modal:e,layerTextSectionExcerptId:this.selectedTextSectionExcerptId||void 0}))}},addAssignments:function(e){var t=e.classIds,n=e.modal,a=e.layerTextSectionExcerptId,s=this,o={};o.schoology=this.getExternalClassesToSync("schoology"),o.canvas=this.getExternalClassesToSync("canvas"),sCH.classesC.addAssignments({layerId:this.selectedLayer.LayerId,shouldCopyLayer:this.selectedLayer.ShouldCopyLayer,newLayerSource:this.selectedLayer.NewLayerSource,classIds:t,layerTextSectionExcerptId:a,externalClassesToSync:o},(function(e){var t=s.selectedLayer.ShouldCopyLayer||s.shouldNavigateAfterCreatingExcerpt;s.shouldNavigateAfterCreatingExcerpt=!1,n.close(),s.destroy(),i.intercom("trackEvent","added-assignment"),sCH.readerConfig?(e.shouldNavigate=t,s.updateAssignedClassesDropdown(a,e.assignmentsAdded)):Backbone.pubEv.trigger("createdUserLayer",{layerId:e.assignmentsAdded[0].LayerId,isAssigned:!0}),s.assignHelper.showAssignLayerSuccessPopup(e),e.isFirstAssignment&&Backbone.tracking.trackGAEvent("Assign","Assign","Assigned Reading")}),(function(){i.bootstrap.alert({alert:"danger",message:'There was an error. If this issue persists, please           <a class="modal-link" href="mailto:help@activelylearn.com">contact us</a> at help@activelylearn.com.'})}))},getExternalClassesToSync:function(e){for(var t=[],n=[],a=document.querySelectorAll('.chkSelectClass[data-classsource="'+e+'"][type="checkbox"]:checked:not(.assigned)'),s=0;s<a.length;s++)t.push(a[s].getAttribute("data-classid"));return t.forEach((function(e){document.getElementById("chkSyncToExternalClass"+e).checked&&n.push(parseInt(e))})),n},updateAssignedClassesDropdown:function(e,t){var n=this;t.length>0&&(sCH.readerConfig.assignedClasses=sCH.readerConfig.assignedClasses||[],t.forEach((function(t){sCH.readerConfig.assignedClasses.push({ClassId:t.ClassId,LayerId:n.selectedLayer.LayerId,LayerTextSectionExcerptId:e,AssignmentId:t.AssignmentId});var a='<li class="assignmentLink">\n              <a onclick="cH.openReaderUrl(\''+("#teacher/reader/grading/"+t.AssignmentId+(sCH.readerConfig.isAssessment||sCH.userM.isOnFreePlan()?"/grading":"/data"))+"')\" >"+sCH.classesC.findWhere({ClassId:t.ClassId}).get("Name")+(e?"("+n.selectedTextSectionExcerptTitle+")":sCH.learnEntitySectionsMetaC.length>1?" (Entire text)":"")+"</a>\n            </li>";"authoring"===sCH.readerConfig.type?($(".dropdown-menu.assignmentDropdown").append(a),$(".dropdown-menu.assignmentDropdown").closest(".dropdown").removeClass("displayNone")):$(".dropdown-menu.assignmentDropdown .assignmentLink:last").after(a)})))},unassignLayerFromClass:function(e){var t=this,n=$(e.currentTarget).data("classid"),a=sCH.classesC.find({ClassId:n}).get("Name");$(e.currentTarget).is("checked")||new Backbone.BootstrapModal({title:'Unassign from "'+a+'"?',content:alcfg.confirmsText.lessonsUnassign,cssClass:"modal-al-unassign",okText:"Unassign",triggerBackboneEventOnCancel:"cancelSelectMode"}).on("ok",(function(){var e=t.selectedLayer.AssignedClasses.find((function(e){return e.LayerId===t.selectedLayer.LayerId&&e.ClassId===n&&e.LayerTextSectionExcerptId===(t.selectedTextSectionExcerptId||null)}));t.modal.close(),l.UnassignLayerFromClass({assignmentIds:[e.AssignmentId],classId:n},(function(){Backbone.router.app&&Backbone.pubEv.trigger("updateMainMenuNotification",{classId:n,assignmentIds:[e.AssignmentId],isRemoved:!0}),0===t.$el.find("input[type='checkbox']:checked").length&&Backbone.pubEv.trigger("layerUnassignedFromAllClasses"),i.bootstrap.alert({message:'Assignment removed successfully from "'+a+'"!'})}))})).on("cancel",(function(){$(e.currentTarget).prop("checked",!0)})).open()},showPurchaseLicensesPopup:function(e){var t=e.classIds,n=e.modal,a=e.layerTextSectionExcerptId,i=this;new Backbone.BootstrapModal({title:"Need more licenses!",content:"Your students may not be able to access this assignment. Would you like to buy more rental licenses?",okText:"Yes",cancelText:"Maybe later",allowCancel:!1,cssClass:"modal-al-manage-purchased"}).open((function(){new Backbone.BootstrapModal({title:i.selectedLayer.Title,content:new r.default({textM:i.selectedLayer,source:s.LearnEntityPurchaseSource.NEED_MORE_WHILE_ASSIGNING}),okText:sCH.userM.isSchoolUsingContentCredits()?"Ok":"Rent",cssClass:"modal-lg modal-al-buy-base-payment-form",allowCancel:!1}).open()}),(function(){i.addAssignments({classIds:t,modal:n,layerTextSectionExcerptId:a})}))},getTotalUniqueStudentsForAssignedClasses:function(e){return a.uniq(a.concat(a.flatten(a.map(a.filter(sCH.classesC.models,(function(t){return a.includes(e,t.get("ClassId"))})),(function(e){return e.get("Students")})))))},destroy:function(){if(Backbone.pubEv.off("layerTextSectionExcerptClosed"),this.shouldNavigateAfterCreatingExcerpt){var e=window.location.hash.replace("preview/"+sCH.readerConfig.layerId,this.selectedLayer.LayerId);i.redirectUserByHash(e)}}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(488),r=n(489),l=n(275),d=n(196),c=n(13).withStyles,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={requestType:"purchase",adminName:"",adminEmail:""},t.updateOkBtnText=function(){t.props.okBtn.text("purchase"===t.state.requestType?"Pay Now":"Request Invoice")},t.handleChange=function(e){return function(n){var a;t.setState(((a={})[e]=n.target.value,a)),$("#requestTypeForm").data("reqtype",n.target.value)}},t}return s(t,e),t.prototype.componentDidMount=function(){this.updateOkBtnText()},t.prototype.componentDidUpdate=function(e,t){t.requestType!==this.state.requestType&&this.updateOkBtnText()},t.prototype.render=function(){var e=this.state,t=e.requestType,n=e.adminName,a=e.adminEmail,s=this.props.classes;return i.createElement(i.Fragment,null,i.createElement(d.default,null,i.createElement(r.default,{"aria-label":"requestType",id:"requestTypeForm",name:"requestType",value:t,onChange:this.handleChange("requestType"),"data-reqtype":t},i.createElement(l.default,{value:"purchase",control:i.createElement(o.default,{color:"primary"}),label:"Pay Now with Credit Card"}),i.createElement(l.default,{value:"requestInvoice",control:i.createElement(o.default,{color:"primary"}),label:"Request Invoice"}))),i.createElement("div",{className:"clearBoth "+s.emptyContainer}),"purchase"===t?i.createElement(i.Fragment,null,i.createElement("div",{id:"creditCardForm"},i.createElement("h3",null,"Payment Info"),i.createElement("div",{className:s.ccNumberContainer},"Card number",i.createElement("div",{className:"info"},""),i.createElement("input",{type:"text",size:16,maxLength:16,"data-stripe":"number",className:"cc-number "+s.ccNumberInput})),i.createElement("div",{className:s.expirationDateContainer},"Expiration date",i.createElement("div",{className:"info"},"(MM/YYYY)"),i.createElement("input",{type:"text",size:2,maxLength:2,"data-stripe":"exp-month",className:"cc-month "+s.ccMonthInput})," /",i.createElement("input",{type:"text",size:4,maxLength:4,"data-stripe":"exp-year",className:"cc-year "+s.ccYearInput})),i.createElement("div",{className:"pull-left"},"Card security code",i.createElement("div",{className:"info"},"(3 or 4 digit number)"),i.createElement("input",{type:"text",size:4,maxLength:4,"data-stripe":"cvc",className:"cc-cvc "+s.ccCvcInput})),i.createElement("div",{className:"clearBoth "+s.emptyContainer})),i.createElement("div",{className:"info "+s.termsOfServiceContainer},"By submitting payment to place your order, you agree to Actively Learn's",i.createElement("a",{href:"https://www.activelylearn.com/terms",target:"_blank"},"Terms of Service"),"and",i.createElement("a",{href:"https://www.activelylearn.com/privacy",target:"_blank"},"Privacy Policy"),". When you click Rent, we will send you an email acknowledging receipt of your order.")):i.createElement("div",{id:"rentalRequestForm"},i.createElement("h3",null,"Administrator Details"),i.createElement("p",null,"Request your administrator to purchase these rental licenses. An invoice will be emailed to them. Your rental licenses will be added to your account on payment."),i.createElement("input",{id:"adminName",type:"text",value:n,placeholder:"Admin Name",onChange:this.handleChange("adminName"),className:s.adminInputField}),i.createElement("br",null),i.createElement("div",{className:"clearBoth"}),i.createElement("input",{id:"adminEmail",type:"text",value:a,placeholder:"Admin Email",onChange:this.handleChange("adminEmail"),className:s.adminInputField}),i.createElement("div",{className:"clearBoth "+s.emptyContainer})))},t}(i.Component);t.default=c((function(e){return{emptyContainer:{height:"20px"},ccNumberContainer:{float:"left",marginRight:"40px"},expirationDateContainer:{float:"left",marginRight:"40px"},leftElement:{float:"left"},ccNumberInput:{width:"215px"},ccMonthInput:{width:"41px !important"},ccYearInput:{width:"62px !important"},ccCvcInput:{width:"62px",marginBottom:"5px",float:"left"},termsOfServiceContainer:{fontSize:"12px",lineHeight:"16px"},adminInputField:{float:"right",width:"410px"}}}))(u)},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+="<p>\r\n    ",sCH.userM.isSchoolUsingContentCredits()?sCH.userM.isOnPrimeUnlimited()?print('Your school has purchased <span class="money-green">Unlimited</span> content! There is no added cost to use this text.'):print("Your school has provided rental content credits so you can assign this text to your students without buying rental licenses yourself."):paidLearnEntity&&teacherOnlyRenewal?print(alcfg.weThePeopleLevel2PaidLessonLeIds.concat(alcfg.weThePeopleLevel3PaidLessonLeIds).indexOf(text.LearnEntityId)>-1?"To renew your license for "+text.Title+", you must purchase licenses for the entire textbook.":"Renew your rental below."):paidLearnEntity&&isTextToBeMadeFreeDuringCovid?print("Actively Learn and the Center for Civic Education have partnered to make this text available for free in response to the COVID-19 crisis. Your free license to this text will expire on July 31st."):paidLearnEntity&&paidLayer?print("You must purchase licenses to use this text. Additionally, this assignment must be rented."):paidLearnEntity?print(postPurchase?alcfg.weThePeopleLevel2PaidLessonLeIds.concat(alcfg.weThePeopleLevel3PaidLessonLeIds).indexOf(text.LearnEntityId)>-1?"To use "+text.Title+", you must purchase licenses for the entire textbook.":"Purchase more rental licenses for this text.":"A rental license for this text must be purchased for you and every student that will access it."):paidLayer&&print("This assignment must be rented. Once you do so, it can be accessed by any of your classes or students."),__p+="\r\n    <br />\r\n    ",sCH.userM.isSchoolUsingContentCredits()?__p+='\r\n        <a class="btnLearnMore" href="'+(null==(__t=alcfg.helpArticleLink.contentCredits)?"":__t)+'" target="_blank">Learn more</a>\r\n    ':isTextToBeMadeFreeDuringCovid||(__p+='\r\n        <a class="btnLearnMore" href="'+(null==(__t=alcfg.helpArticleLink.managerentals)?"":__t)+'" target="_blank">Learn more</a>\r\n    '),__p+='\r\n</p>\r\n<p class="info publisherRestrictionsDisclaimer">Note: The publisher of this title prevents copy/paste,'+(null==(__t=text.IsTextToSpeechDisabled?" text-to-speech,":"")?"":__t)+' and search within rented texts.</p>\r\n<div class="breaker"></div>\r\n\r\n<form action="" method="POST" class="payform" id="payment-form">\r\n    <div style="float:left;">\r\n        <h3>Rental Price</h3>\r\n        ',paidLearnEntity&&paidLayer);else if(paidLearnEntity){var priceObj=JSON.parse(text.RentalPrices),key=_.keys(priceObj)[0],value=priceObj[key];__p+='\r\n                <div class="label price" data-term="'+(null==(__t=key)?"":__t)+'" data-price="'+(null==(__t=value)?"":__t)+'">\r\n                    <span class="',print(sCH.userM.isSchoolUsingContentCredits()||isTextToBeMadeFreeDuringCovid?"strikethrough":""),__p+='">$'+(null==(__t=(value/100).toFixed(2))?"":__t)+"</span>\r\n                    ",(sCH.userM.isSchoolUsingContentCredits()||isTextToBeMadeFreeDuringCovid)&&(__p+='\r\n                        <span class="price">$0.00</span>\r\n                    '),__p+="\r\n                     / license\r\n                        ",isTextToBeMadeFreeDuringCovid||(__p+="\r\n                             for "+(null==(__t=key)?"":__t)+" ",print(text.Publisher===alcfg.weThePeoplePublisher?" (full text)":""),__p+="\r\n                        "),__p+="\r\n                </div>\r\n            ",isTextToBeMadeFreeDuringCovid&&(__p+='\r\n                <span class="specialDiscount label">*Rental fee waived until July 31, 2020</span>\r\n            '),__p+="\r\n            ",sCH.userM.isSchoolUsingContentCredits()||isTextToBeMadeFreeDuringCovid||(__p+='\r\n                <a class="btnMorePricingOptions" href="'+(null==(__t=alcfg.helpArticleLink.renewRental)?"":__t)+'" target="_blank">More options</a>\r\n            '),__p+="\r\n        "}else paidLayer&&(__p+='\r\n            <div class="label">\r\n                <input class="regular-radio" name="price" type="radio" data-term="short" data-price="'+(null==(__t=layer.ShortTermRentalPriceInCents)?"":__t)+'" />\r\n                $'+(null==(__t=(layer.ShortTermRentalPriceInCents/100).toFixed(2))?"":__t)+' for 1 year\r\n            </div>\r\n            <div class="label">\r\n                <input class="regular-radio" name="price" type="radio" data-term="long" data-price="'+(null==(__t=layer.LongTermRentalPriceInCents)?"":__t)+'" />\r\n                $'+(null==(__t=(layer.LongTermRentalPriceInCents/100).toFixed(2))?"":__t)+" for 6 years\r\n            </div>\r\n        ");__p+="\r\n    </div>\r\n\r\n    ",sCH.userM.isSchoolUsingContentCredits()||isTextToBeMadeFreeDuringCovid?__p+='\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n    ':(__p+="\r\n        ",paidLearnEntity&&!teacherOnlyRenewal&&(__p+='\r\n            <div class="rightSectionContainer">\r\n                <h3>Number of Student Licenses</h3>\r\n                <input class="txtQuantity" type="text" maxlength="4" value="',print(paidLearnEntity&&!postPurchase?minQuantity-1:""),__p+='" />\r\n                <div class="btn-box btnViewHeadCount" tabindex="0" data-toggle="popover" data-trigger="focus" data-placement="bottom" data-content="Loading...">\r\n                    View head count\r\n                </div>\r\n                ',doesTeacherHaveCoTeachers&&(__p+='\r\n                    <div class="containerShareTeacherLicense">\r\n                        <h3>Co-teacher</h3>\r\n                        <input id="chkAllowCoTeacherToUseLicense" type="checkbox" class="chkAllowCoTeacherToUseLicense regular-checkbox" />\r\n                        <label for="chkAllowCoTeacherToUseLicense"></label>\r\n                        <label>Allow co-teacher to use license?</label>\r\n                    </div>\r\n                '),__p+='\r\n            </div>\r\n            <div class="clearLeft"></div>\r\n            <div class="total"></div>\r\n            \r\n        '),__p+='\r\n\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n\r\n        <div class="requestForm"></div>\r\n        <div class="payment-errors"></div>\r\n        <div class="breaker" style="margin-bottom: 0;"></div>\r\n    '),__p+="\r\n</form>"}return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(5),l=n(1332),d=n(38),c=n(101),u=n(102),p=n(103),h=n(116),g=n(152),f=n(137),m=n(13),v=m.createMuiTheme,b=m.MuiThemeProvider,C=m.withStyles,y=v({palette:{primary:f.lightBlue},typography:{useNextVariants:!0,fontFamily:"AvenirNextLTW02-Medium"},breakpoints:{values:{}},overrides:{MuiDialog:{root:{alignItems:"start"}}}}),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={title:"",selectedTextSectionIds:[]},t.handleChange=function(e){t.setState({selectedTextSectionIds:e})},t.handleTitleChange=function(e){t.setState({title:e.target.value})},t.handleClose=function(){Backbone.pubEv.trigger("layerTextSectionExcerptClosed")},t.handleSubmit=function(){if(0!==t.state.selectedTextSectionIds.length)if(0!==t.state.title.trim().length){var e=t;o.CreateLayerTextSectionExcerpt({layerId:t.props.layerId,title:t.state.title,textSectionIds:t.state.selectedTextSectionIds,shouldCopyLayer:t.props.shouldCopyLayer},(function(t){Backbone.pubEv.trigger("layerTextSectionExcerptClosed",{Title:e.state.title,LayerTextSectionExcerptId:t.layerTextSectionExcerptId,LayerId:t.layerId})}))}else r.bootstrap.alert({message:"Please provide a title!",alert:"danger"});else r.bootstrap.alert({message:"Please select some sections!",alert:"danger"})},t}return s(t,e),t.prototype.render=function(){var e=r.truncate(this.props.textTitle+" Ch 1-4",70);return i.createElement(b,{theme:y},i.createElement(c.default,{open:!0,maxWidth:"md"},i.createElement(h.default,null,"Choose specific sections"),i.createElement(p.default,null,i.createElement(g.default,{name:"excerptTitle",label:"Title your excerpt (ex. "+e+")",fullWidth:!0,autoComplete:"off",onChange:this.handleTitleChange,className:this.props.classes.newTitleContainer}),i.createElement(l.default,{textSections:this.props.textSections,handleChange:this.handleChange})),i.createElement(u.default,null,i.createElement(d.default,{onClick:this.handleClose,className:this.props.classes.button,color:"primary"},"Cancel"),i.createElement(d.default,{onClick:this.handleSubmit,className:this.props.classes.button,color:"primary"},"Done"))))},t}(i.Component);t.default=C({button:{fontFamily:"Avenir Next LT W02 Demi",fontSize:16},newTitleContainer:{marginBottom:20}})(_)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(150),l=n(197),d=n(198),c=n(231),u=n(13).withStyles,p={list:{display:"flex",flexWrap:"wrap",flexDirection:"column",width:684},textSection:{padding:0,width:342,height:48}},h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!1,selectedTextSectionIds:[],textTitle:t.props.textTitle},t.handleTextSectionsChange=function(e){var n=t.state.selectedTextSectionIds;n.indexOf(e)>-1?n=n.filter((function(t){return t!==e})):n.push(e),n=n.sort((function(e,t){return e-t})),t.setState({selectedTextSectionIds:n}),t.props.handleChange(n)},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.state.selectedTextSectionIds,n=this.props,a=n.classes,s=n.textSections,u=48*Math.ceil(s.length/2);return i.createElement(l.default,{className:a.list,style:{height:u}},s.map((function(n,s){return i.createElement(d.default,{key:s,button:!0,className:a.textSection,onClick:function(){return e.handleTextSectionsChange(n.TextSectionId)}},i.createElement(r.default,{color:"primary",checked:t.indexOf(n.TextSectionId)>-1}),i.createElement(c.default,{style:{padding:0},primary:o.truncate(n.Title,65)}))})))},t}(i.Component);t.default=u(p)(h)},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",shouldShowTextSectionExcerptControls&&(__p+='\n    <div id="ddlExcerptsContainer">\n        <select id="ddlExcerpts" title="Choose sections or chapters to assign">\n            <option>Entire text</option>\n            ',_.each(excerpts,(function(e){__p+='\n                <option value="'+(null==(__t=e.LayerTextSectionExcerptId)?"":__t)+'">\n                    '+(null==(__t=cH.sanitize(e.Title))?"":__t)+"\n                </option>\n            "})),__p+='\n        </select>\n        <a class="icon-question-mark-inverse" href="https://go.activelylearn.com/assignexcerpt"></a>\n    </div>\n\n    <div id="createExcerpt"></div>\n    <div class="clearBoth" style="height: 20px;"></div>\n'),__p+='\n\n<ul class="checklist ',print(shouldShowTextSectionExcerptControls?"disabled":""),__p+='">\n    ',_.each(classes,(function(e,t){var n=!1;if(!shouldShowTextSectionExcerptControls){var a=selectedLayer.AssignedClasses.find((function(t){return t.ClassId===e.ClassId}));a&&!a.LayerTextSectionExcerptId&&(n=!0)}__p+='\n        <li class="',print(hasAnySchoologyOrCanvasSection?"hasAnySchoologyOrCanvasSection":""),__p+='">\n            <div class="checkbox" data-classid="'+(null==(__t=e.ClassId)?"":__t)+'">\n                <input id="chkSelectClass'+(null==(__t=e.ClassId)?"":__t)+'"\n                    data-classid="'+(null==(__t=e.ClassId)?"":__t)+'"\n                    data-classsource="'+(null==(__t=e.Source)?"":__t)+'"\n                    type="checkbox"\n                    class="chkSelectClass regular-checkbox '+(null==(__t=n?"assigned":"")?"":__t)+'"\n                    '+(null==(__t=n?"checked":"")?"":__t)+'/>\n                <label for="chkSelectClass'+(null==(__t=e.ClassId)?"":__t)+'"></label>\n            </div>\n            <div class="title">'+(null==(__t=cH.sanitize(e.Name))?"":__t)+"</div>\n            ","schoology"!==e.Source||n||(__p+='\n                <div class="syncToSchoologyBox syncToExternalLMSOption disabled" data-classid="'+(null==(__t=e.ClassId)?"":__t)+'">\n                    <div class="checkbox">\n                        <input id="chkSyncToExternalClass'+(null==(__t=e.ClassId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n                        <label for="chkSyncToExternalClass'+(null==(__t=e.ClassId)?"":__t)+'"></label>\n                    </div>\n                    <div class="title">Sync to schoology</div>\n                </div>\n            '),__p+="\n            ","canvas"!==e.Source||n||(__p+='\n                <div class="syncToCanvas syncToExternalLMSOption disabled" data-classid="'+(null==(__t=e.ClassId)?"":__t)+'">\n                    <div class="checkbox">\n                        <input id="chkSyncToExternalClass'+(null==(__t=e.ClassId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n                        <label for="chkSyncToExternalClass'+(null==(__t=e.ClassId)?"":__t)+'"></label>\n                    </div>\n                    <div class="title">Sync to canvas</div>\n                </div>\n            '),__p+="\n        </li>\n    "})),__p+='\n</ul>\n\n<div class="gclassroominfo info">Note: Assignment links will be saved as drafts in your Google course streams.</div>\n';return __p}},,function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(154),l=n(24),d=n(5),c=n(14),u=n(8),p=n(20),h=n(199),g=n(333);function f(e,t){sCH.userM.showPopup(e)&&setTimeout((function(){l.showModalFromBackbone(h.FirstImportSuccessPopup,{popupKey:e,infoText:t,onUpdateDoNotShowPopupSetting:function(){d.updateDoNotShowPopupSetting(e)}})}),750)}function m(e,t){try{e.forEach((function(e,n){d.intercom("trackEvent","added-Class",{className:e.Name,classSource:t})})),t===c.UserAccountSource.GOOGLE&&e&&d.intercom("trackEvent","added-Class-google",{count:e.length})}catch(e){}}function v(e){d.bootstrap.alert({message:"Failed to import your "+e+"! Please try again and contact us if the issue persists.",alert:"danger"})}function b(){d.bootstrap.alert({message:"Adding your classes...hang on for a few seconds and don't refresh the page!",autoClose:"longer"}),Backbone.pubEv.trigger("loadingShowHide",!0)}function C(){var t=this;return new e((function(e){var n=sCH.classesC.toJSON(),a=new g.default;a.fillArchived(),a.on("sync",(function(){n.push.apply(n,a.toJSON()),e(n)}),t)}))}t.edmodoImportHelper=function(t){var n=this;return{getCourses:function(){return new e((function(e){return a(n,void 0,void 0,(function(){var t,n;return s(this,(function(a){switch(a.label){case 0:return t=parseInt(sCH.userM.get("Accounts").edmodo.ExternalUserId),[4,C()];case 1:return n=a.sent(),o.GetEdmodoGroups((function(a){a?((a=a.filter((function(e){return e.owners.find((function(e){return e.id===t}))}))).forEach((function(e){n.find((function(t){return t.hasOwnProperty("ExternalClassId")&&parseInt(t.ExternalClassId)===e.id}))&&(e.isAlreadyImported=!0),e.name=e.title})),e(a)):e([])})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b(),sCH.classesC.addEdmodoGroups({groups:n},(function(e){l.hideModals(),e?(f("PostEdmodoImport","Your Edmodo groups were imported successfully!"),m(n,c.UserAccountSource.EDMODO),t&&t(e[0].classId)):v("Edmodo groups")}))}}},t.cleverImportHelper=function(t){var n=this,i=null;return{getCourses:function(){return new e((function(e){return a(n,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,C()];case 1:return t=n.sent(),o.GetCleverSections((function(n){n&&(n.error?(i=n.message,e([])):(n.forEach((function(e){t.find((function(t){return t.ExternalClassId===e.id}))&&(e.isAlreadyImported=!0)})),e(n)))})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b(),sCH.classesC.addCleverSections({sections:n},(function(e){if(l.hideModals(),e){if(f("PostCleverImport","<p>Your Clever sections were imported successfully! Students need to create an Actively Learn account via Clever to join your classes.</p>"),m(n,c.UserAccountSource.CLEVER),t){var a=e[0].ClassId;t(a)}}else v("Clever sections")}))},getErrorMessage:function(){return i}}},t.canvasImportHelper=function(t){var n,i=this;return{getCourses:function(){return new e((function(e){return a(i,void 0,void 0,(function(){var t;return s(this,(function(a){switch(a.label){case 0:return[4,C()];case 1:return t=a.sent(),o.GetLTISourceCoursesAndSections({source:c.UserAccountSource.CANVAS},(function(a){var s=a.sections,i=a.LTIAccountPublicInfo,o=[];n=i.ConsumerInstanceGuid,s.forEach((function(e){e.sections.forEach((function(a){var s=n+" "+a.id,i=t.find((function(e){return e.Source===c.UserAccountSource.CANVAS&&e.ExternalClassId===s}));o.push({name:a.name===e.name?e.name:e.name+" - "+a.name,isAlreadyImported:!!i,gradeLevel:i?i.GradeLevel:null,id:s,current_term:e.current_term,termName:e.term.name,sectionId:a.id})}))})),e(o)})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b();var a=n.map((function(e){return e.CanvasSectionId}));sCH.classesC.addCanvasSections({schoolId:n[0].SchoolId,canvasSectionIds:a,sections:n},(function(e){if(l.hideModals(),e){f("PostCanvasSectionsImport","Your Canvas courses/sections were imported successfully! Students will automatically join your classes\n          when they click the Actively Learn link in Canvas."),m(n,c.UserAccountSource.CANVAS);for(var a=0,s=n;a<s.length;a++){var i=s[a];sCH.classesC.find({Source:c.UserAccountSource.CANVAS,ExternalClassId:i.ExternalClassId}).set("GradeLevel",i.GradeLevel)}sCH.classesC.filter({Source:c.UserAccountSource.CANVAS,ExternalClassId:n[0].ExternalClassId})[0].get("ClassId");t&&setTimeout((function(){return t(e[0].ClassId)}),750)}else v("Canvas courses")}))}}},t.googleImportHelper=function(t){return{getGoogleCourses:function(){return new e((function(e){var t=function(){var t=[];d.bootstrap.alert({message:"Getting your classes from Google...hang on one second!"}),r.getCourses(null,(function(n,a){if(n&&n.length>0){var s=n.map((function(e){return e.id}));o.GetGoogleClasses({externalClassIds:s},(function(a){t=u.sortBy(n,(function(e){return e.name.toUpperCase()})),a.forEach((function(e){var n=t.find((function(t){return e.ExternalClassId===t.id}));n&&(n.isAlreadyImported=e.IsAlreadyImported,e.GradeLevel&&(n.gradeLevel=e.GradeLevel))})),e(t)}))}else e([])}))};window.googleHelper.oauthToken?t():(window.googleHelper.callback=t,gapi.auth.authorize({client_id:p.default.googleApiClientId,scope:window.googleHelper.scopes,immediate:!1,authuser:-1,user_id:sCH.userM.get("Accounts")[c.UserAccountSource.GOOGLE].ExternalUserId},window.googleHelper.handleAuthResult))}))},apiCallback:function(e){var n=e.courses;b(),n.forEach((function(e){return e.ExternalClassId=parseInt(e.ExternalClassId)})),sCH.classesC.addGoogleCourses({courses:n,googleOAuthToken:window.googleHelper.oauthToken},(function(e){if(l.hideModals(),e){if(f("GClassroom","Your Google Classroom courses were imported successfully! Students need to <b>create an "+d.getProductName()+" account by clicking           the Google button</b> on "+window.location.origin+" to join your classes."),m(n,c.UserAccountSource.GOOGLE),n.length>0){for(var a=0,s=n;a<s.length;a++){var i=s[a];sCH.classesC.find({Source:c.UserAccountSource.GOOGLE,ExternalClassId:i.ExternalClassId}).set("GradeLevel",i.GradeLevel)}var o=sCH.classesC.filter({Source:c.UserAccountSource.GOOGLE,ExternalClassId:n[0].ExternalClassId})[0].get("ClassId");t&&t(o)}}else v("Google Classroom courses")}))}}},t.schoologyImportHelper=function(t){var n,i=this;return{getCourses:function(){return new e((function(e){return a(i,void 0,void 0,(function(){var t;return s(this,(function(a){switch(a.label){case 0:return[4,C()];case 1:return t=a.sent(),o.GetLTISourceCoursesAndSections({source:c.UserAccountSource.SCHOOLOGY},(function(a){var s=a.sections,i=a.LTIAccountPublicInfo,o=[];n=i.ConsumerInstanceGuid,(s=u.orderBy(s,(function(e){return e.latestGradingPeriod.end}),["desc"])).forEach((function(e){var a=n+" "+e.id,s=t.find((function(e){return e.ExternalClassId===a})),i=e.latestGradingPeriod;o.push({name:e.course_title+" - "+e.section_title,isAlreadyImported:!!s,gradeLevel:s?s.GradeLevel:null,id:a,current_term:i.end>=(new Date).toISOString()||""===i.end,termName:i.title,sectionId:e.id})})),e(o)})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b();var a=n.map((function(e){return{gradeLevel:e.GradeLevel,sectionId:e.SectionId}}));sCH.classesC.addSchoologySections({schoolId:n[0].SchoolId,sectionIdsAndGradeLevels:a},(function(e){if(l.hideModals(),e){if(f("PostSchoologySectionsImport","Your Schoology courses/sections were imported successfully! Students will automatically join your classes\n          when they click the Actively Learn link in Schoology."),m(e,c.UserAccountSource.SCHOOLOGY),a.length>0){var n=e[0].ClassId;t&&setTimeout((function(){return t(n,750)}))}}else v("Schoology courses")}))}}},t.brightspaceImportHelper=function(t){var n,i=this;return{getCourses:function(){return new e((function(e){return a(i,void 0,void 0,(function(){var t;return s(this,(function(a){switch(a.label){case 0:return[4,C()];case 1:return t=a.sent(),o.GetLTISourceCoursesAndSections({source:c.UserAccountSource.BRIGHTSPACE},(function(a){var s=a.sections,i=a.LTIAccountPublicInfo,o=[];n=i.ConsumerInstanceGuid,s.forEach((function(e){var a=n+" "+e.sectionId,s=t.find((function(e){return e.ExternalClassId===a}));o.push({name:e.courseName+" - "+e.sectionName,isAlreadyImported:!!s,gradeLevel:s?s.GradeLevel:null,id:a,current_term:!0,termName:"",sectionId:e.sectionId})})),e(o)})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b();var a=n.map((function(e){return{gradeLevel:e.GradeLevel,sectionId:e.SectionId}}));sCH.classesC.addBrightspaceSections({schoolId:n[0].SchoolId,sectionIdsAndGradeLevels:a},(function(e){if(l.hideModals(),e){if(f("PostSchoologySectionsImport","Your Schoology courses/sections were imported successfully! Students will automatically join your classes\n          when they click the Actively Learn link in Schoology."),m(e,c.UserAccountSource.SCHOOLOGY),a.length>0){var n=e[0].ClassId;t&&setTimeout((function(){return t(n,750)}))}}else v("Schoology courses")}))}}},t.oneRosterImportHelper=function(t){var n,i=this;return{getCourses:function(){return new e((function(e){return a(i,void 0,void 0,(function(){var t;return s(this,(function(a){switch(a.label){case 0:return[4,C()];case 1:return t=a.sent(),o.GetLTISourceCoursesAndSections({source:c.UserAccountSource.ONEROSTER},(function(a){var s=a.sections,i=a.LTIAccountPublicInfo,o=[];n=i.ConsumerInstanceGuid,(s=u.orderBy(s,(function(e){return e.latestAcademicSession.EndDate}),["desc"])).forEach((function(e){var a=n+" "+e.SourcedId,s=t.find((function(e){return e.ExternalClassId===a})),i=e.latestAcademicSession;o.push({name:e.Name,isAlreadyImported:!!s,gradeLevel:s?s.GradeLevel:null,id:a,current_term:i.EndDate>=(new Date).toISOString(),termName:i.Title,sectionId:e.SourcedId})})),e(o)})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b();var a=n.map((function(e){return{gradeLevel:e.GradeLevel,sectionId:e.SectionId}}));sCH.classesC.addOneRosterSections({schoolId:n[0].SchoolId,sectionIdsAndGradeLevels:a},(function(e){l.hideModals(),e?(f("PostOneRosterSectionsImport","Your OneRoster courses/sections were imported successfully! Students will automatically join your classes\n          when they click the Actively Learn link in OneRoster."),m(e,c.UserAccountSource.ONEROSTER),t&&t(e[0].ClassId)):v("OneRoster courses")}))}}},t.achieve3KImportHelper=function(t){var n,r=this;return{getCourses:function(){return new e((function(e){return a(r,void 0,void 0,(function(){var t;return s(this,(function(a){switch(a.label){case 0:return[4,C()];case 1:return t=a.sent(),o.GetLTISourceCoursesAndSections({source:c.UserAccountSource.ACHIEVE3K},(function(a){var s=a.sections,o=a.LTIAccountPublicInfo,r=[];n=o.ConsumerInstanceGuid,u.uniqBy(s.reduce((function(e,t){return i(e,t.terms)}),[]),"sourcedId").forEach((function(e){s.filter((function(t){return t.terms.find((function(t){return t.sourcedId===e.sourcedId}))})).forEach((function(a){var s=n+" "+a.sourcedId,i=t.find((function(e){return e.ExternalClassId===s}));r.push({name:a.title,isAlreadyImported:!!i,gradeLevel:i?i.GradeLevel:null,id:s,current_term:!0,termName:e.type,sectionId:a.sourcedId})}))})),e(r)})),[2]}}))}))}))},apiCallback:function(e){var n=e.courses;b();var a=n.map((function(e){return{gradeLevel:e.GradeLevel,sectionId:e.SectionId}}));sCH.classesC.addExternalSections({schoolId:n[0].schoolId,sectionIdsAndGradeLevels:a},c.UserAccountSource.ACHIEVE3K,(function(e){if(l.hideModals(),e){f("Postachieve3kSectionsImport","Your Achieve3000 courses/sections were imported successfully! Students will automatically join your classes\n          when they click the Actively Learn link in Achieve3000."),m(e,c.UserAccountSource.ACHIEVE3K);var n=e[0].ClassId;t&&setTimeout((function(){return t(n,750)}))}else v("Achieve3000 courses")}))}}},t.onGradeLevelUpdated=function(e){var t=e.courseId,n=e.gradeLevel,i=e.source;return a(this,void 0,void 0,(function(){var e,a,r;return s(this,(function(s){switch(s.label){case 0:return[4,C()];case 1:return e=s.sent(),a=e.find((function(e){return e.Source===i&&e.ExternalClassId===t.toString()})),r={classId:a.ClassId,gradeLevel:n},o.UpdateGradeLevel(r,(function(){var e=sCH.classesC.findWhere({ClassId:a.ClassId});e&&e.set("GradeLevel",n)})),[2]}}))}))}}).call(this,n(21))},,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<p>\n    You can send students directly to assignments by sharing the links below with them.\n</p>\n\n",_.each(data,(function(e,t){__p+='\n    <div class="className">'+(null==(__t=cH.sanitize(e.className))?"":__t)+"</div>\n\n    ",_.each(e.links,(function(t,n){__p+='\n        <div style="margin-bottom: 10px;">\n            <span class="assignmentName">'+(null==(__t=cH.sanitize(t.assignmentName))?"":__t)+'</span>\n            <div class="clearBoth" style="height: 2px;"></div>\n            <span class="info moveup">'+(null==(__t=t.url)?"":__t)+'</span>\n            <button class="icon-copytoclipboard btnCopyLink" data-clipboard-text="'+(null==(__t=t.url)?"":__t)+'" title="Copy link to clipboard"></button>\n            ',"google"!==e.source&&(__p+='\n                <div class="gShare" title="Share to Google Classroom">\n                    <div class="g-sharetoclassroom" data-size="20" data-url="'+(null==(__t=t.url)?"":__t)+'" data-title="'+(null==(__t=cH.sanitize(t.assignmentName))?"":__t)+'"></div>\n                </div>\n            '),__p+="\n        </div>\n    "})),__p+="\n"})),__p+="";return __p}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=n(199),i=n(0),o=n(10),r=n(5),l=n(24),d=n(203);t.default=function(e){var t=e.learnEntityId,n=e.okCallback,c=i.useState([]),u=c[0],p=c[1];return i.useEffect((function(){a&&(u.length>0?a.enableOkButton():a.disableOkButton())}),[u,a]),i.createElement(s.Modal,{title:"Add assignment to Student Library",okText:"Add",okCallback:function(){o.AddToStudentLibrary({learnEntityId:t,districtId:sCH.userM.getPrimarySchool().DistrictId,grades:u},(function(e){l.hideModals();r.bootstrap.alert({message:"Assignment added to the Student Library! It will be reflected there in few moments."}),n()}))},cssClass:"addToStudentLibrary",disabledOkText:"Adding..",shouldOverflow:!0,onOpenCallback:function(e){e.disableOkButton(),a=e}},i.createElement("p",null,"Please select grades for this assignment."),i.createElement(d.default,{defaultValue:[],isMulti:!0,name:"grades",options:[{value:2,label:"2nd grade"},{value:3,label:"3rd grade"},{value:4,label:"4th grade"},{value:5,label:"5th grade"},{value:6,label:"6th grade"},{value:7,label:"7th grade"},{value:8,label:"8th grade"},{value:9,label:"9th grade"},{value:10,label:"10th grade"},{value:11,label:"11th grade"},{value:12,label:"12th grade"},{value:13,label:"13th grade"}],className:"basic-multi-select",classNamePrefix:"select",closeMenuOnSelect:!1,placeholder:"Select grades...",onChange:function(e){p(e?e.map((function(e){return e.value})):[])}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(199),s=n(0),i=n(10),o=n(5),r=n(24);t.default=function(e){var t=e.learnEntityId,n=e.okCallback;return s.createElement(a.Modal,{title:"Are you sure?",okText:"Remove",okCallback:function(){i.RemoveFromStudentLibrary({learnEntityId:t,districtId:sCH.userM.getPrimarySchool().DistrictId},(function(e){r.hideModals();o.bootstrap.alert({message:"Assignment removed from the Student Library!"}),n()}))},disabledOkText:"Removing.."})}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",responseData.length>0?(__p+='\r\n    <div id="portfolioContainer">\r\n        ',_.each(responseData,(function(e){__p+='\r\n        <div class="questionContainer">\r\n            <table>\r\n                <tr>\r\n                    <td style="width:24px;"><span class="icon-question"></span></td>\r\n                    <td>\r\n                        <div class="questionText">'+(null==(__t=cH.sanitize(e.QuestionText))?"":__t)+'</div>\r\n                        <div class="title">'+(null==(__t=cH.sanitize(e.AssignmentTitle))?"":__t)+'</div>\r\n                        <div class="questionStandard">'+(null==(__t=e.StandardCode?cH.sanitize(e.StandardCode):"No standard")?"":__t)+"</div>\r\n                        ",e.SecondStandardCode&&(__p+='<div class="questionStandard">'+(null==(__t=cH.sanitize(e.SecondStandardCode))?"":__t)+" </div>"),__p+='\r\n                    </td>\r\n                    <td class="meta">\r\n                        <a title="View in text" class="btn-box btnViewInReader '+(null==(__t=e.IsLayerDeleted?"disabled":"")?"":__t)+'"\r\n                           href="'+(null==(__t="#teacher/reader/authoring/preview/"+e.LayerId+"/notes/?questionTagId="+e.QuestionTagId+"&showAuthoringActions=false")?"":__t)+'"\r\n                           target="_blank">View in text</a>\r\n                        <div class="answerDate">'+(null==(__t=moment.utc(e.MinAnsweredDate).local().format("MM-DD-YY"))?"":__t)+'</div>\r\n                        <div class="proficiency">\r\n                            Responses: '+(null==(__t=e.TotalResponses)?"":__t)+"<br/>\r\n                            "+(null==(__t=(0===e.NumGraded?"Graded: 0":" Proficient: "+Math.round(e.NumProficient/e.NumGraded*1e3)/10)+"%")?"":__t)+"\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        "})),__p+="\r\n    </div>\r\n    "):__p+="\r\n    <div class='ctaInfo'>No Data</div>\r\n    ",__p+="\r\n";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(718),r=n(130),l=n(1343),d=n(54),c=n(5),u=n(10),p=n(14),h=n(13).withStyles,g=function(e){function t(t){var n=e.call(this,t)||this,a=d.getSchoolYearRangeOrDefault("admin"),s=a.start,i=a.end;return n.state={dateRangeObj:{start:s,end:i},overviewData:{numQuestionsAdded:0,numAssignmentsWithExtraHelp:0,numTeacherCommentsAdded:0,numNotesWithDiscussion:0,numTextToSpeechCall:0,numRevisionRequested:0,numNotesAddedByStudent:0,numVocabLookUp:0,avgWordsPerAssignment:0,numTranslationLookUp:0},plOverviewData:[]},n.setDateRange=n.setDateRange.bind(n),n}return s(t,e),t.prototype.componentDidMount=function(){this.getOverviewData(this.state.dateRangeObj)},t.prototype.setDateRange=function(e){this.setState({dateRangeObj:e}),this.getOverviewData(e)},t.prototype.getOverviewData=function(e){var t=this,n=e.start,a=e.end,s={teacherUserId:this.props.teacherUserId,startDate:n.toISOString(),endDate:a.toISOString()};c.attachSchoolDistrictId(s),u.GetCoachingReportOverview(s,(function(e){t.setState({overviewData:e.teacherGridData,plOverviewData:e.plModuleCompletedData})}))},t.prototype.getDotIndicatorClass=function(e,t){var n=p.teacherPracticesThresholds[t],a=n.redThreshold,s=n.greenThreshold;return e>=0?e<a?"redDot":e>=s?"greenDot":"":""},t.prototype.getPLModuleData=function(e,t){return e.find((function(e){return e.Title===t}))||{}},t.prototype.render=function(){var e=this.props.classes,t=this.state,n=t.overviewData,a=t.plOverviewData;return i.createElement("div",null,i.createElement(o.default,{reportType:"admin",dateRangeData:this.state.dateRangeObj,setDateRange:this.setDateRange}),i.createElement("section",{className:"adminOverview"},i.createElement(r.default,{alignItems:"center",className:e.gridContainer,container:!0},i.createElement(r.default,{item:!0,xs:12,className:e.dataLegendsGrid},i.createElement("span",{className:e.legendWrapper},i.createElement("span",{className:e.greenLegend+" "+e.legendColor})," Evidence of Use"),i.createElement("span",{className:e.legendWrapper},i.createElement("span",{className:e.redLegend+" "+e.legendColor})," Areas to Improve")),i.createElement(r.default,{item:!0,lg:3,md:3,sm:12,xs:12,className:e.gridHeadingText},i.createElement("span",null,"Activate Thinking")),i.createElement(l.default,{hasCompletedPLModules:a.length>0,overviewGridRowData:[{title:"Questioning",value:n.numQuestionsAdded,label:"DOK 2-4 questions",plModuleData:this.getPLModuleData(a,"Questioning"),dotIndicatorClass:this.getDotIndicatorClass(n.numQuestionsAdded,"questioning")},{title:"Discussion",value:n.numNotesWithDiscussion,label:"Discussion threads",plModuleData:this.getPLModuleData(a,"Discussion"),dotIndicatorClass:this.getDotIndicatorClass(n.numNotesWithDiscussion,"discussion")},{title:"Annotation",value:n.numNotesAddedByStudent,label:"Student notes",plModuleData:this.getPLModuleData(a,"Annotation"),dotIndicatorClass:this.getDotIndicatorClass(n.numNotesAddedByStudent,"annotation")}]}),i.createElement(r.default,{item:!0,lg:3,md:3,sm:12,xs:12,className:e.gridHeadingText},i.createElement("span",null,"Support Thinking")),i.createElement(l.default,{hasCompletedPLModules:a.length>0,overviewGridRowData:[{title:"Scaffolding",value:n.numAssignmentsWithExtraHelp,label:"Assignments w/ Extra Help",plModuleData:this.getPLModuleData(a,"Scaffolding"),dotIndicatorClass:this.getDotIndicatorClass(n.numAssignmentsWithExtraHelp,"extraHelp")},{title:"Accessibility",value:n.numTextToSpeechCall+n.numTranslationLookUp,label:"TTS / Translations",plModuleData:this.getPLModuleData(a,"Accessibility"),dotIndicatorClass:this.getDotIndicatorClass(n.numTextToSpeechCall+n.numTranslationLookUp,"accessibility")},{title:"Vocabulary",value:n.numVocabLookUp,label:"Word lookups",plModuleData:this.getPLModuleData(a,"Vocabulary"),dotIndicatorClass:this.getDotIndicatorClass(n.numVocabLookUp,"vocabulary")}]}),i.createElement(r.default,{item:!0,lg:3,md:3,sm:12,xs:12,className:e.gridHeadingText},i.createElement("span",null,"Reveal Thinking")),i.createElement(l.default,{hasCompletedPLModules:a.length>0,overviewGridRowData:[{title:"Feedback",value:n.numTeacherCommentsAdded,label:"Teacher comments",plModuleData:this.getPLModuleData(a,"Feedback"),dotIndicatorClass:this.getDotIndicatorClass(n.numTeacherCommentsAdded,"feedback")},{title:"Metacognition",value:n.numRevisionRequested,label:"Student revisions",plModuleData:this.getPLModuleData(a,"MetaCognition"),dotIndicatorClass:this.getDotIndicatorClass(n.numRevisionRequested,"metaCognition")},{title:"Writing",value:Math.round(100*n.avgWordsPerAssignment/100),label:"Avg. words per assignment",plModuleData:this.getPLModuleData(a,"Writing"),dotIndicatorClass:this.getDotIndicatorClass(n.avgWordsPerAssignment,"writing")}]}))))},t}(i.Component);t.default=h({gridContainer:{width:"100%",margin:"0 auto",maxWidth:"1000px"},rowTitle:{border:"none"},gridHeadingText:{fontSize:"20px",fontFamily:"Avenir Next LT W02 Demi",textAlign:"right",padding:"12px"},dataLegendsGrid:{textAlign:"right",fontSize:"16px",padding:"12px",fontFamily:"Avenir Next LT W02 Demi"},legendWrapper:{padding:"10px 0 10px 20px"},legendColor:{width:"10px",height:"10px",display:"inline-block",borderRadius:"50%",marginRight:"5px"},greenLegend:{background:"rgb(56, 142, 60)"},redLegend:{background:"rgb(211, 47, 47)"},"@media (max-width: 959px)":{gridContainer:{maxWidth:"250px",margin:"120px auto",clear:"both"},gridHeadingText:{textAlign:"center",padding:"20px"},legendWrapper:{display:"block",textAlign:"left"}},"@media (min-width: 1340px)":{gridContainer:{marginLeft:0}}})(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(130),i=n(1344),o=n(13).withStyles;t.default=o({gridCell:{border:"1px solid #969696",marginLeft:"-1px",marginTop:"-1px",height:"160px",padding:"20px 12px 12px"},biggerGridCell:{height:"190px"}})((function(e){var t=e.classes,n=e.hasCompletedPLModules;return a.createElement(a.Fragment,null,e.overviewGridRowData.map((function(e){return a.createElement(s.default,{item:!0,lg:3,md:3,sm:12,xs:12,className:"\n              "+(n?t.biggerGridCell:"")+"\n              "+t.gridCell+"\n            ",key:e.title},a.createElement(i.default,{overviewData:e}))})))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(13).withStyles;t.default=s({gridCellDataWrapper:{maxWidth:"89%",margin:"auto",textAlign:"center"},gridCellRedBg:{background:"rgb(255, 235, 238)"},gridCellGreenBg:{background:"rgba(56, 142, 60, 0.12)"},gridCellHeadingText:{fontSize:"20px",fontFamily:"Avenir Next LT W02 Demi",marginBottom:"10px"},gridCellDataText:{fontSize:"36px",fontFamily:"Avenir Next LT W02 Bold"},gridCellDataLabel:{color:"#646464",fontSize:"16px",marginTop:"10px"},plModulesIcon:{margin:"3px"},dotIndicator:{width:"10px",display:"inline-block",height:"10px",borderRadius:"50%",marginRight:"10px",marginBottom:"3px"},redDot:{background:"rgb(211, 47, 47)"},greenDot:{background:"rgb(56, 142, 60)"}})((function(e){var t=e.classes,n=e.overviewData;return a.createElement("div",{className:t.gridCellDataWrapper},a.createElement("div",{className:t.gridCellHeadingText},a.createElement("span",{className:t.dotIndicator+" "+t[n.dotIndicatorClass]}),n.title),a.createElement("div",{className:t.gridCellDataText},n.value),a.createElement("div",{className:t.gridCellDataLabel},n.label),a.createElement("div",null,!!n.plModuleData.hasCompletedSlideshow&&a.createElement("span",{className:"icon-slideshow "+t.plModulesIcon}),!!n.plModuleData.hasCompletedAssignment&&a.createElement("span",{className:"icon-authoring "+t.plModulesIcon}),!!n.plModuleData.hasCompletedVideo&&a.createElement("span",{className:"icon-play "+t.plModulesIcon})))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1346);t.default=Backbone.View.extend({el:"div.profile",initialize:function(e){e.scope=this,this.childViews=[],this.settingsScroll=new a.default,this.childViews.push(this.settingsScroll)},destroy:function(){void 0!==this.subheader&&this.subheader.destroy()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(233),i=n(5),o=n(1347),r=n(10),l=n(85),d=n(1348),c=n(1350),u=n(1352),p=n(688),h=n(24),g=n(1354),f=n(20);t.default=Backbone.View.extend({el:"div.profile .scroll",events:{"click .btnSaveInfo":"saveInfo","click .btnChangePassword":"changePassword","click .btnDeleteAccount":"deleteAccount","click .btnChangeAvatar":"changeAvatar","click .btnRemoveAvatar":"removeAvatar","click .btnChangeUsername":"changeUsername","click .btnChangeSchool":"changeSchool","click .btnChangeGradelevelSubject":"changeGradelevelSubject","click .btnChangeTitle":"changeTitle","click #btnCancelTeacherPersonal":"cancelTeacherPersonal","click #btnUpdateCard":"updateCard"},template:n(1356),initialize:function(){if("student"===sCH.userM.get("Role"))this.render({});else{var e=this;r.GetMembershipDetails((function(t){t.priorSubjectId&&sCH.userM.set("PriorSubjectId",t.priorSubjectId),e.render(t)}))}},render:function(e){var t="student"!==sCH.userM.get("Role")&&!!sCH.userM.get("Accounts").native;this.$el.html(this.template({settings:sCH.userM,gradelevelSubjectString:i.getGradelevelSubjectString(),plan:"student"===sCH.userM.get("Role")?null:sCH.userM.getPlanString(),expireDate:e.ExpireDate?moment.utc(e.ExpireDate).local().format("MMM Do, YYYY"):null,nextBillDate:e.NextBillDate?moment.unix(e.NextBillDate).format("MMM Do, YYYY"):null,showSaveSettingBtn:t})),i.initTooltips(this.$el),i.adjustHeaderSpacing()},deleteAccount:function(){new Backbone.BootstrapModal({title:"Delete my account",content:'<p class="warning">This will delete your account ('+sCH.userM.get("UserName")+"), classes, assignments and all your data. This cannot be undone!</p> <p>"+(sCH.userM.get("Accounts").native&&!sCH.userM.get("IsMasquerading")?'Type your account password below to delete your account:<input class="txtConfirmText" type="password" placeholder="Password" />':'Type your username below to delete your account:<input class="txtConfirmText" />')+"</p>",okText:"Delete My Account",cssClass:"modal-delete"}).open((function(){var e=this;e.preventClose();var t=this.$el.find(".txtConfirmText");i.checkRequiredFields([t])>0||(sCH.userM.get("Accounts").native||t.val()===sCH.userM.get("UserName")?(e.disableOk("Deleting..."),r.DeleteUser({confirmText:t.val().trim()},(function(t,n){t?(Backbone.tracking.trackGAEvent("settings","deleteAccount"),i.bootstrap.alert({message:"Your account was successfully deleted."}),setTimeout((function(){l.signOut("deleteAccount"),e.close()}),2500)):"Incorrect password"===n?(i.bootstrap.alert({alert:"danger",message:"The password you entered is incorrect."}),e.enableOk("Delete My Account")):(i.bootstrap.alert({alert:"danger",message:"We were unable to delete your account. If this problem persists, please contact us at help@activelylearn.com."}),e.enableOk("Delete My Account"))}))):i.bootstrap.alert({alert:"danger",message:"The Username you entered is incorrect."}))}))},saveInfo:function(){if("Saving..."!==this.$el.find(".btnSaveInfo").text()){var e=this.$el.find(".txtFirstName"),t=this.$el.find(".txtLastName");if(!(i.checkRequiredFields([e,t])>0)){var n={firstName:e.val(),lastName:t.val()},a=this;this.$el.find(".btnSaveInfo").text("Saving..."),r.UpdateFirstLastName(n,(function(e){e&&a.renderAvatarUrl(e),$(".mainHeader #btnAccount .name").text(n.firstName),sCH.userM.updateName(n.firstName,n.lastName),i.bootstrap.alert({message:"Info updated!"}),a.$el.find(".btnSaveInfo").text("Save"),Backbone.tracking.trackGAEvent("user","changeInfo")}))}}},changePassword:function(){var e={oldPassword:this.$el.find(".txtOldPwd").val(),newPassword:this.$el.find(".txtNewPwd").val(),confirmPassword:this.$el.find(".txtCNewPwd").val()};if(e.newPassword===e.confirmPassword)if(e.newPassword.length<6)i.bootstrap.alert({message:"New password must be at least 6 characters.",alert:"danger"});else{var t=this;this.$el.find(".btnChangePassword").text("Changing password..."),(new o.default).changePassword(e,(function(e,n){e?(i.bootstrap.alert({message:"Your password has changed!"}),t.$el.find(".txtOldPwd").val(""),t.$el.find(".txtNewPwd").val(""),t.$el.find(".txtCNewPwd").val("")):i.bootstrap.alert({message:n||"There was an error changing your password. Please try again later.",alert:"danger"}),t.$el.find(".btnChangePassword").text("Change password"),Backbone.tracking.trackGAEvent("user","changePassword")}))}else i.bootstrap.alert({message:"Passwords do not match!",alert:"danger"})},changeSchool:function(){new Backbone.BootstrapModal({title:"Change school",content:new u.default,allowCancel:!1,okText:"Submit"}).open()},changeGradelevelSubject:function(){var e=!sCH.userM.get("PriorSubjectId")&&!f.default.isMath;h.showModalFromBackbone(p.default,{modalTitle:"Change grade level"+(e?" or subject":""),shouldGet:{gradeLevelId:!0,subjectId:e},isSubjectChangeLimited:!0})},changeTitle:function(){h.showModalFromBackbone(p.default,{modalTitle:"Change title",shouldGet:{title:!0}})},changeAvatar:function(){new Backbone.BootstrapModal({title:"Change avatar",content:new d.default({scope:this}),allowCancel:!1,okText:"Change",cssClass:"changeAvatar"}).on("shown",(function(){a.mountReactComponent(s.default,$("#uploadContainer")[0],{uploadUrl:alcfg.node.profile.upload_avatar,enableMultiple:!1,disablePreview:!0,fileType:alcfg.imageExtensions.map((function(e){return"image/"+e})).join(","),fileTypeErrorMessage:"Select a valid avatar file.",fileDropPlaceholder:"Try dropping an image here, or click to select an image to upload.",maxFileSize:alcfg.MBInBytes[2.5],submitData:{},successMessage:"Avatar uploaded successfully!"})})).open()},removeAvatar:function(){var e=this;r.SetInitialsAsAvatar((function(t){e.renderAvatarUrl(t)}))},renderAvatarUrl:function(e){sCH.userM.set("ImageUrl",e),$(".settings .avatar").replaceWith(i.generateAvatarHtml(e)),$(".accountDropdown .avatar").replaceWith(i.generateAvatarHtml(e)),sCH.userM.set("ImageUrl",e),Backbone.tracking.trackGAEvent("user","changeImage")},changeUsername:function(){new Backbone.BootstrapModal({title:"Change username",content:new c.default({scope:this}),okText:"Continue"}).open()},cancelTeacherPersonal:function(){var e=new Backbone.BootstrapModal({okText:"Downgrade",cancelText:"Never mind",title:"Downgrade to Free plan?",content:'<p class="info green">Please note, you will not be billed for June and July on the Personal plan.</p>        If you still want to downgrade, let us know where we fall short of your expectations?<br>        <textarea></textarea>',cssClass:"cancelTeacherPro modal-delete"}).open((function(){e.preventClose(),i.checkRequiredFields([e.$el.find("textarea")])>0||r.CancelTeacherPersonal({whyCancel:e.$el.find("textarea").val()},(function(t,n){t?(e.close(),i.intercom("trackEvent","downgraded-free"),new Backbone.BootstrapModal({title:"Your Personal plan subscription has been canceled.",content:"Actively Learn needs to reload.",cssClass:"modal-al-reload",allowCancel:!1,cancelText:!1,okText:"Reload"}).open((function(){window.location.reload(!0)}))):i.bootstrap.alert({alert:"danger",message:n||"There was an error. Please do not retry. We will examine what went wrong first and contact you."})}))}))},updateCard:function(){new Backbone.BootstrapModal({title:"Update credit card details",content:new g.default,okText:"Update",cssClass:"modal-al-teacherPro"}).open()},destroy:function(){}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.Model.extend({defaults:function(){return{UserName:null,FirstName:"",LastName:"",Email:"",ImageUrl:"",Role:"",NotificationSettings:"",IsDeleted:!1,EmailSettings:"",Accounts:{}}},fixUserNameField:function(){return a.sanitize(this.get("UserName",!0))},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))},fixImageUrlField:function(){return a.sanitize(this.get("ImageUrl",!0))},changePassword:function(e,t){a.ajax({type:"POST",url:alcfg.node.user.change_password,data:e,showLoading:!0,vital:!1,onSuccess:function(){t(!0)},onError:function(e){t(!1,a.getErrorTextFromResponse(e))}})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({template:n(1349),initialize:function(e){this.on("ok",this.updateUrl),this.scope=e.scope},render:function(){return this.$el.html(this.template()),this},updateUrl:function(e){var t=this;sCH.reactUploader.isFileUploaded((function(n){if(n)sCH.reactUploader.submit((function(n){"string"==typeof n&&t.scope.renderAvatarUrl(n),e.close()}));else{var i=t.$el.find(".txtAvatarUrl"),o=a.checkRequiredFields([i]);if(e.preventClose(),o>0)return;e.disableOk("Verifying...");var r=document.createElement("img");r.onerror=function(){a.bootstrap.alert({message:"Please enter a valid image URL",alert:"danger"}),i.addClass("flash"),e.enableOk("Change")},r.onload=function(){s.ChangeAvatarUrl({avatarURL:i.val()},(function(){t.scope.renderAvatarUrl(i.val()),e.close()}))},r.setAttribute("src",i.val())}}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div id="uploadContainer"></div>\r\n<div class="divider">OR</div>\r\n<input class="txtAvatarUrl" type="text" placeholder="Enter an image URL for an avatar" />';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(20);t.default=Backbone.View.extend({events:{"click #btnChangeGoogleSignin":"handleChangeAuthClick"},template:n(1351),initialize:function(e){this.on("ok",this.submit),this.on("shown",this.shown),this.scope=e.scope},shown:function(e){this.modal=e},confirmPassword:function(e){var t=this;t.modal.preventClose(),t.confirmPasswordModal=new Backbone.BootstrapModal({title:"Enter your current password to continue",content:'<p><input class="txtPassword" type="password" placeholder="Current password" /></p>',okText:"Change username",okCloses:!1}).open((function(){var n=this.$el.find(".txtPassword");s.checkRequiredFields([n])>0||(t.currentPassword=n.val(),e("native"))}))},handleChangeAuthClick:function(){var e=this,t=function(t){gapi.auth.authorize({client_id:o.default.googleApiClientId,scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",prompt:"select_account",authuser:""},(function(n){n&&!n.error&&gapi.client.load("oauth2","v2",(function(){gapi.client.oauth2.userinfo.get().execute((function(n){n.email&&n.id?e.sendRequest({firstName:n.given_name,lastName:n.family_name,newUserName:n.email,currentSource:t,newSource:"google",currentPassword:e.currentPassword,externalUserId:n.id}):s.bootstrap.alert({message:"We could not retrieve your email from Google! Please refresh and try again.",alert:"danger",autoClose:!1})}))}))}))};sCH.userM.get("Accounts").google?t("google"):this.confirmPassword(t)},render:function(){return this.$el.html(this.template({settingsM:sCH.userM.toJSON()})),this},submit:function(){var e=this;sCH.userM.get("Accounts").native?this.confirmPassword((function(t){e.updateUsername(t)})):e.updateUsername(a.keys(sCH.userM.get("Accounts"))[0])},updateUsername:function(e){var t,n=this.$el.find(".txtNewEmail"),a=this.$el.find(".txtPassword");this.modal.preventClose(),this.$el.find(".flash").removeClass("flash"),t=s.checkRequiredFields([n,a]),s.isValidEmail(n.val())||(this.confirmPasswordModal&&this.confirmPasswordModal.close(),n.addClass("flash"),s.bootstrap.alert({alert:"danger",message:alcfg.alertsText.invalidEmail}),t++);var i=!!sCH.userM.get("Accounts").google||!!sCH.userM.get("Accounts").office365;if(i&&a.val().length<6&&(a.addClass("flash"),s.bootstrap.alert({alert:"danger",message:alcfg.alertsText.passwordMinLength}),t++),!(t>0)){var o={newUserName:n.val(),currentPassword:this.currentPassword,currentSource:e,newSource:"native"};i&&(o.newPassword=a.val()),this.sendRequest(o)}},sendRequest:function(e){var t=this;i.ChangeUserName(e,(function(e,n){if(n)sCH.userM.set("UserName",n.userName),sCH.userM.set("Accounts",n.accounts),n.firstName&&sCH.userM.set("FirstName",n.firstName),n.lastName&&sCH.userM.set("LastName",n.lastName),t.scope.initialize(),t.modal._preventClose=!1,t.modal.close(),t.confirmPasswordModal&&t.confirmPasswordModal.close(),s.bootstrap.alert({message:alcfg.alertsText.usernameUpdated});else if(s.bootstrap.alert({alert:"danger",message:e||alcfg.alertsText.failedUpdateUsername}),"The password you entered is incorrect."===e){var a=t.confirmPasswordModal.$el.find(".txtPassword");a.val(""),s.checkRequiredFields([a]),a.focus()}else t.confirmPasswordModal&&t.confirmPasswordModal.close()}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",settingsM.Accounts.office365?__p+="\n    <p>You have signed up with a Office 365 account: "+(null==(__t=settingsM.UserName)?"":__t)+". You can switch to using an email / password login.</p>\n":(__p+="\n    ",settingsM.Accounts.google?__p+="\n        <p>You have signed up with a Google account: "+(null==(__t=settingsM.UserName)?"":__t)+". You can either use a new Google account or switch to using an email / password login.</p>\n    ":__p+="            \n        <p>You have signed up with an email address: "+(null==(__t=cH.sanitize(settingsM.UserName))?"":__t)+". You can either switch to a Google account or enter a new email address.</p>\n    ",__p+='\n    <p class="gAccountContainer">\n        <a id="btnChangeGoogleSignin" class="btn-box large">'+(null==(__t=settingsM.Accounts.google?"Change Google account":"Switch to Google account")?"":__t)+'</a>\n    </p>\n    <div class="divider">OR</div>\n'),__p+='\n\n<input class="txtNewEmail" type="email"\n    placeholder="'+(null==(__t=settingsM.Accounts.google||settingsM.Accounts.office365?"Enter an email address":"Enter a different email address")?"":__t)+'" />\n',(settingsM.Accounts.google||settingsM.Accounts.office365)&&(__p+='\n    <input class="txtPassword" type="password" placeholder="Password" />\n'),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({template:n(1353),initialize:function(){this.on("ok",this.changeSchool)},render:function(){return this.$el.html(this.template()),this},changeSchool:function(e){e.preventClose();var t=this.$el.find(".txtNewSchoolName"),n=this.$el.find(".txtExtra");if(!(a.checkRequiredFields([t])>0)){var i={newSchoolName:t.val(),extra:n.val()||void 0};e.disableOk("Submitting..."),s.ChangeSchool(i,(function(t){e.close(),t?a.bootstrap.alert({message:"Thank you for your request!",autoClose:!1}):a.bootstrap.alert({message:"Unable to process your request. If this problem persists, please email help@activelylearn.com.",alert:"danger"})}))}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p>Please let us know which school you want to be moved to.</p>\n<p class="info">Current school: '+(null==(__t=sCH.userM.getPrimarySchool().Name)?"":__t)+'</p>\n<input class="txtNewSchoolName" placeholder="New school" maxlength="100" />\n<input class="txtExtra" placeholder="Any concerns or special requirements? (optional)" maxlength="512" />';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10),i=n(20);t.default=Backbone.View.extend({events:{"keypress .cc-number":"validateNumber","keypress .cc-month":"validateNumber","keypress .cc-year":"validateNumber","keypress .cc-cvc":"validateNumber"},updateCardTemplate:n(1355),initialize:function(){Stripe.setPublishableKey(i.default.stripeKey);var e=this;this.on("ok",this.updateCard),this.on("initialized",(function(t){e.modal=t}))},render:function(){this.$el.html(this.updateCardTemplate())},validateNumber:function(e){return a.isNumber(e)},updateCard:function(){this.modal.preventClose();var e=$("#payment-form"),t=Stripe.card.validateCardNumber(this.$el.find(".cc-number").val()),n=Stripe.card.validateExpiry(this.$el.find(".cc-month").val(),this.$el.find(".cc-year").val()),i=Stripe.card.validateCVC(this.$el.find(".cc-cvc").val()),o=""!==this.$el.find(".cust-name").val().trim();if(t)if(n)if(i)if(o){this.modal.disableOk("Updating..."),e.find("input").addClass("disabled");var r=this;Stripe.createToken(e,(function(t,n){n.error?(e.find(".payment-errors").text(n.error.message),r.modal.enableOk("Update"),e.find("input").removeClass("disabled")):s.UpdateCreditCard({token:n.id,cardType:n.card.type,lastFour:n.card.last4},(function(t){t?(r.modal.close(),a.bootstrap.alert({message:"Your credit card details were successfully updated."})):(r.modal.enableOk("Update"),e.find("input").removeClass("disabled"),a.bootstrap.alert({alert:"danger",message:"There was an error. Please do not retry. We will examine what went wrong first and contact you."}))}))}))}else e.find(".payment-errors").text("You have not entered your name.");else e.find(".payment-errors").text("Your cvc number is invalid.");else e.find(".payment-errors").text("Your expiration date is invalid.");else e.find(".payment-errors").text("Your credit card number is invalid.");return!1}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<form action="" method="POST" class="payform" id="payment-form">\n    <div class="cardRow">\n        <div class="block">\n            Full Name<div class="info"></div>\n            <input type="text" data-stripe="name" style="width:215px;" value="" class="cust-name" />\n        </div>\n    </div>\n\n    <div class="cardRow">\n        <div class="block">\n            Card number<div class="info"></div>\n            <input type="text" size="16" maxlength="16" data-stripe="number" style="width:215px;" value="" class="cc-number" />\n        </div>\n        <div class="block">\n            CVC (3 or 4 digit code)<div class="info"></div>\n            <input type="text" size="4" maxlength="4" data-stripe="cvc" value="" class="cc-cvc" style="width:62px;margin-bottom:5px;float:left;" />\n        </div>\n    </div>\n    <div class="cardRow">\n        <div class="block">\n            Expiration date (MM/YYYY)<div class="info"></div>\n            <input type="text" size="2" maxlength="2" data-stripe="exp-month" style="width:41px;" value="" class="cc-month" /> /\n            <input type="text" size="4" maxlength="4" data-stripe="exp-year" style="width:62px;" value="" class="cc-year" />\n        </div>\n    </div>\n    <div class="clearBoth"></div>\n    <div class="payment-errors"></div>\n</form>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="settings">\r\n    <h2>Account information</h2>\r\n    <div class="clearBoth" style="height:10px;"></div>\r\n    <table cellpadding="0" cellspacing="0" border="0">\r\n        ',settings.get("Accounts").edmodo||(__p+="\r\n            <tr>\r\n                <td>\r\n                    "+(null==(__t=cH.generateAvatarHtml(settings.get("ImageUrl"),84))?"":__t)+'\r\n                </td>\r\n                <td><a class="btn-box btnChangeAvatar">Change Avatar</a><a class="btn-box btnRemoveAvatar">Remove</a></td>\r\n            </tr>\r\n            ',(settings.get("Accounts").native||settings.get("Accounts").google||settings.get("Accounts").office365)&&(__p+='            \r\n                <tr>\r\n                    <td>Username</td>\r\n                    <td>\r\n                        <div class="disabled fs-hide">'+(null==(__t=cH.sanitize(settings.get("UserName")))?"":__t)+"</div>\r\n                        ","student"!==settings.get("Role")&&(__p+='\r\n                            <a class="btn-box btnChangeUsername">Change</a>\r\n                        '),__p+="\r\n                    </td>\r\n                </tr>\r\n            "),__p+="\r\n        "),__p+="\r\n        ","student"!==settings.get("Role")&&(__p+='\r\n        <tr>\r\n            <td>Title</td>\r\n            <td>\r\n                <div id="profileTitleString" class="disabled">'+(null==(__t=cH.sanitize(settings.get("Title")))?"":__t)+'</div>\r\n                <a class="btn-box btnChangeTitle" style="margin-top: 7px;">Change</a>\r\n            </td>\r\n        </tr>\r\n        '),__p+="\r\n        <tr>\r\n            <td>First name</td>\r\n            <td>\r\n                ",settings.get("Accounts").native&&"student"!==settings.get("Role")?__p+='\r\n                    <input class="txtFirstName" value="'+(null==(__t=cH.sanitize(settings.get("FirstName")))?"":__t)+'" maxlength="25" />\r\n                ':__p+='\r\n                    <div class="disabled">'+(null==(__t=cH.sanitize(settings.get("FirstName")))?"":__t)+"</div>\r\n                ",__p+="\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td>Last name</td>\r\n            <td>\r\n                ",settings.get("Accounts").native&&"student"!==settings.get("Role")?__p+='\r\n                    <input class="txtLastName" value="'+(null==(__t=cH.sanitize(settings.get("LastName")))?"":__t)+'" maxlength="25" />\r\n                ':__p+='\r\n                    <div class="disabled">'+(null==(__t=cH.sanitize(settings.get("LastName")))?"":__t)+"</div>\r\n                ",__p+="\r\n            </td>\r\n        </tr>\r\n        ","teacher"!==settings.get("Role")&&"admin"!==settings.get("Role")||(__p+='\r\n            <tr>\r\n                <td>School</td>\r\n                <td>\r\n                    <div class="disabled">\r\n                        ',_.each(sCH.userM.get("SchoolInfo"),(function(e){__p+="\r\n                            "+(null==(__t=cH.sanitize(e.Name))?"":__t)+"\r\n                            <br />"+(null==(__t=cH.sanitize(e.City))?"":__t),print(null!==e.State?", "+cH.sanitize(e.State):""),__p+="\r\n                            <br />\r\n                        "})),__p+="\r\n                    </div>\r\n                    ",(settings.get("Accounts").native||settings.get("Accounts").google)&&(__p+='\r\n                        <a class="btn-box btnChangeSchool">Change</a>\r\n                    '),__p+="\r\n                </td>\r\n            </tr>\r\n        "),__p+="\r\n        ",showSaveSettingBtn&&(__p+='\r\n            <tr>\r\n                <td></td>\r\n                <td><a class="btn-box btnSaveInfo">Save</a></td>\r\n            </tr>\r\n        '),__p+="\r\n    </table>\r\n\r\n    ","student"!==settings.get("Role")&&(__p+='\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n        <table cellpadding="0" cellspacing="0" border="0">\r\n            <tr>\r\n                <td>Teaching</td>\r\n                <td>\r\n                    <div id="gradelevelSubjectString" class="disabled">'+(null==(__t=gradelevelSubjectString)?"":__t)+'</div>\r\n                    <a class="btn-box btnChangeGradelevelSubject" style="margin-top: 7px;">Change</a>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n    '),__p+="\r\n\r\n    ","student"!==settings.get("Role")&&(__p+='\r\n        <div class="hideForMath">\r\n            <h2>Current plan</h2>\r\n            <div style="font-size: 16px;">\r\n                <span style=\'font-family: "Avenir Next LT W02 Demi";\' class="',print("Free"===plan?"":"money-green"),__p+='">\r\n                    '+(null==(__t=plan)?"":__t)+"\r\n                </span>\r\n                ",expireDate?__p+="\r\n                    <span style='font-size: 14px;'>(expiring "+(null==(__t=expireDate)?"":__t)+")</span>\r\n                ":nextBillDate&&(__p+="\r\n                    <span style='font-size: 14px;'>(you will be billed next on "+(null==(__t=nextBillDate)?"":__t)+")</span>\r\n                "),__p+="\r\n\r\n                ","Personal"!==plan||expireDate||(__p+='\r\n                    <a class="btn-box" id="btnCancelTeacherPersonal">Cancel subscription</a>\r\n                    <a class="btn-box" id="btnUpdateCard">Update credit card details</a>\r\n                '),__p+="\r\n            </div>\r\n        </div>\r\n    "),__p+='\r\n\r\n    <div class="clearBoth" style="height:40px;"></div>\r\n    ',settings.get("Accounts").native&&(__p+='\r\n        <h2>Change password</h2>\r\n        <div class="clearBoth" style="height:10px;"></div>\r\n        <table cellpadding="0" cellspacing="0" border="0">\r\n            <tr>\r\n                <td>Current</td>\r\n                <td><input class="txtOldPwd" type="password"/></td>\r\n            </tr>\r\n            <tr>\r\n                <td>New</td>\r\n                <td><input class="txtNewPwd" type="password"/></td>\r\n            </tr>\r\n            <tr>\r\n                <td valign="top">Confirm<br />New</td>\r\n                <td><input class="txtCNewPwd" type="password"/></td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td><br /><a class="btn-box btnChangePassword">Change password</a></td>\r\n            </tr>\r\n        </table>\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n    '),__p+="\r\n\r\n    ","dadmin"!==settings.get("Role")&&(__p+='\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n        <a class="btn-box btnDeleteAccount">Delete My Account</a>\r\n    '),__p+="\r\n</div>\r\n";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=n(1358),i=n(1360);t.default=Backbone.View.extend({el:"div.studentData",initialize:function(){var e=this;$("div.studentData .subheader").html(""),this.scroll=new i.default,this.subheader=new s.default({scroll:this.scroll}),this.childViews=[this.subheader,this.scroll],a.GetStudentGrades((function(t){e.data=t,e.render()}))},render:function(){this.subheader.render(),this.scroll.render({data:this.data})},destroy:function(){}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({el:"div.studentData .subheader",events:{"click .subview":"subViewChanged","click .sortDropdown ul a":"sort","change .ddlSkillBuckets":"filterPortfolio","change .ddlTagType":"filterPortfolio","change .ddlWordCount":"filterPortfolio","click .btnPrintView":"printView"},template:n(1359),initialize:function(e){this.scroll=e.scroll},render:function(){this.$el.html(this.template()),a.adjustHeaderSpacing()},subViewChanged:function(e){$(e.currentTarget).hasClass("selected")||(this.$el.find(".subview").removeClass("selected"),$(e.currentTarget).addClass("selected"),this.scroll.subviewSelected($(e.currentTarget).data("mode")))},sort:function(e){var t=$(e.currentTarget);$(".sortDropdown a").removeClass("selected"),t.addClass("selected"),this.scroll.sort(t.data("sort"))},filterPortfolio:function(){this.scroll.renderPortfolioStudent()},printView:function(){var e,t=this.$el.find(".subview.selected").data("mode");e="vocabulary"===t?"Vocabulary words looked up":t.charAt(0).toUpperCase()+t.slice(1)+" report",a.print(e)},destroy:function(){}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<nav role="tablist" aria-label="Tabs">\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left btnSummary subview selected" data-mode="summary">Summary</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left btnProficiency subview" data-mode="proficiency">Proficiency</a>\r\n    \x3c!--<a class="btn-tab pull-left btnPrgoress subview">Progress</a>--\x3e\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left btnVocabulary subview" data-mode="vocabulary">Vocabulary</a>\r\n    <a href="javascript:void(0)" role="tab" class="btn-tab pull-left btnPortfolio subview" data-mode="portfolio">Writing</a>\r\n</nav>\r\n\r\n<aside class="rowTwo">\r\n    <button class="btn-tab btnPrintView icon-print" title="Print" role="button" aria-haspopup="true"\r\n        aria-expanded="false"></button>\r\n\r\n    <div class="dropdown sortDropdown">\r\n        <button class="btn-tab btnSorting icon-sort" role="button" data-toggle="dropdown" aria-haspopup="true"\r\n            aria-expanded="false"></button>\r\n        <ul class="dropdown-menu" aria-labelledby="btnSorting">\r\n            <li><a href="javascript:void(0)" class="selected" data-sort="recency">Recent</a></li>\r\n            <li><a href="javascript:void(0)" class="" data-sort="frequency">Frequent</a></li>\r\n        </ul>\r\n    </div>\r\n\r\n    <div id="portfolioFilters">\r\n        <select class="ddlSkillBuckets">\r\n            <option value="-1">All content types</option>\r\n            <option value="1">Literature</option>\r\n            <option value="2">Informational</option>\r\n            <option value="3">Science</option>\r\n            <option value="5">Other</option>\r\n        </select>\r\n        <select class="ddlTagType">\r\n            <option value="all">All writing</option>\r\n            <option value="questionresponses">Only question responses</option>\r\n            <option value="notes">Only notes</option>\r\n        </select>\r\n        <select class="ddlWordCount">\r\n            <option value="5">Writing over 5 words</option>\r\n            <option value="10">Writing over 10 words</option>\r\n            <option value="15">Writing over 15 words</option>\r\n            <option value="20">Writing over 20 words</option>\r\n        </select>\r\n    </div>\r\n</aside>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(491),r=n(54),l=n(1361);t.default=Backbone.View.extend({el:"div.studentData .scroll",summaryTemplate:n(1362),lexileTemplate:n(1363),vocabularyContainerTemplate:n(1364),vocabularyTemplate:n(1365),trendsTemplate:n(1366),overallProficiencyTemplate:n(1367),portfolioTemplate:n(1368),portfolioResponseTemplate:n(747),initialize:function(){},render:function(e){if(this.studentUserId=sCH.userM.get("UserId"),sCH.userM.isOnPrimePlan()){this.data=e.data;var t=r.prepareData(this.data,this.data.Standards);this.studentDokData=t.studentDokData,this.studentStandardsData=t.studentStandardsData,this.studentCategoryData=t.studentCategoryData,this.studentReadingGradeLevelData=t.studentReadingGradeLevelData,this.studentVocabularyData=t.studentVocabularyData,this.studentPerformanceData=t.studentPerformanceData,this.studentTimeEffortData=t.studentTimeEffortData,this.ccStdMap=t.ccStdMap,this.subviewSelected("summary")}s.initTooltips(this.$el)},subviewSelected:function(e){switch(i.unmountAllChildReactComponentsUnderParent(this.$el),this.$el.removeClass("summary vocabulary proficiency portfolio gray"),$(".sortDropdown, .btnPrintView, #portfolioFilters").hide(),$(".daterangepicker").remove(),e){case"summary":this.$el.addClass(e),this.renderSummaryStudentData();break;case"proficiency":this.$el.addClass(e),this.renderProficiencyStudentData();break;case"content":this.renderContentStudent();break;case"lexile":this.renderLexileStudent();break;case"vocabulary":this.$el.addClass(e),this.renderVocabularyStudent();break;case"portfolio":this.$el.addClass(e).addClass("gray"),this.renderPortfolioStudent()}s.initTooltips(this.$el),s.initHelpPopover(this.$el),Backbone.tracking.trackGAEvent("student","data:"+e)},renderLexileStudent:function(){this.studentReadingGradeLevelData.length?this.$el.html(this.lexileTemplate({lexileData:this.studentReadingGradeLevelData,isStudentMode:!0,gradeNameMap:s.gradeNameMap(!0)})):this.$el.html("<div class='ctaInfo'>"+alcfg.infoText.data.noDataGeneric+"</div>")},renderContentStudent:function(){this.studentCategoryData.length>0?this.$el.html(this.contentTemplate({studentCommonCoreData:this.studentCommonCoreData,categoryData:this.studentCategoryData,isStudentMode:!0})):this.$el.html("<div class='ctaInfo'>"+alcfg.infoText.data.noDataGeneric+"</div>")},renderSummaryStudentData:function(){if(this.studentTimeEffortData&&this.studentTimeEffortData.length>0){var e=r.getSchoolYearRangeOrDefault("student"),t=r.sortAndFillPerformanceData(this.studentPerformanceData),n=this;this.$el.html(this.summaryTemplate({trendsHtml:this.trendsTemplate({studentPerformanceData:t.studentPerformanceData,maxResponsesInMonth:t.maxResponsesInMonth,isStudentMode:!0,gradeNameMap:s.gradeNameMap(!0)}),isStudentMode:!0})),$(".btnPrintView").show(),r.initDateRangePicker(e.start,e.end,(function(e,t,a){n.fillSummaryDataEl({min:e,max:t})}),"student"),this.fillSummaryDataEl({min:e.start,max:e.end}),window.setTimeout((function(){n.$el.find(".stackedBarContainer").scrollLeft(999999)}),500)}else this.$el.html("<div class='ctaInfo'>"+alcfg.infoText.data.noDataGeneric+"</div>")},fillSummaryDataEl:function(e){var t={answers:0,wordCount:0,readingTime:0,notes:0,notesWordCount:0,lookupCount:0},n=[],s=0;this.studentTimeEffortData.forEach((function(s){moment.utc(s.date).isBefore(e.max)&&moment.utc(s.date).isAfter(e.min)&&(t.answers+=s.answers||0,t.wordCount+=s.wordCount||0,t.readingTime+=s.readingTime||0,t.notes+=s.notes||0,t.notesWordCount+=s.notesWordCount||0,t.lookupCount+=s.lookupCount||0,s.prevCharCountAsgnArr&&s.prevCharCountAsgnArr.forEach((function(e){var t=a.find(n,(function(t){return t.assignmentId===e.assignmentId}));t?e.count>t.count&&(t.count=e.count):n.push(e)})))})),n.forEach((function(e){s+=e.count})),this.$el.find("#summaryReadingTime span.value").text(r.roundTotalStudentReadingTime(t.readingTime)),this.$el.find("#summaryPageCount span.value").text(Math.round(s/2e3).toLocaleString()),this.$el.find("#summaryDefinitionLookup span.value").text(t.lookupCount.toLocaleString()),this.$el.find("#summaryPace span.value").text(Math.ceil(10*(t.readingTime?s/t.readingTime/2e3*3600:0))/10),this.$el.find("#summaryWordCount span.value").text((t.wordCount+t.notesWordCount).toLocaleString()),this.$el.find("#summaryAnswers span.value").text(t.answers.toLocaleString()),this.$el.find("#summaryNotes span.value").text(t.notes.toLocaleString())},renderProficiencyStudentData:function(){var e=this,t=r.getSchoolYearRangeOrDefault("student"),n=t.start,l=t.end;this.$el.html(this.overallProficiencyTemplate()),$(".btnPrintView").show();var d=function(e,t){return e.filter((function(e){return moment.utc(e[t]).isAfter(n)&&moment.utc(e[t]).isBefore(l)}))},c=function(){var t=e.studentDokData?d(e.studentDokData,"date"):[];i.mountReactComponent(o.default,document.querySelector("#secStProfDok .chartsContainer"),{data:t,titleHash:alcfg.tags.question.dok,noDataText:alcfg.infoText.data.noDataGeneric}),t=e.studentStandardsData?d(e.studentStandardsData,"date"):[];var n,r=a.uniq(t.reduce((function(e,t){return null!=t.groupBy?e.concat(t.filterBy):e}),[])),l=r.length>1?[{value:-1,text:"All"}]:[];r.forEach((function(e){return l.push({value:e,text:e})})),i.mountReactComponent(o.default,document.querySelector("#secStProfStandard .chartsContainer"),{data:t,titleHash:e.ccStdMap,noDataText:alcfg.infoText.data.noDataGeneric,filters:l}),t=e.studentCategoryData?d(e.studentCategoryData,"date"):[],i.mountReactComponent(o.default,document.querySelector("#secStProfContent .chartsContainer"),{data:t,titleHash:[{id:1,text:"Literature"},{id:2,text:"Informational"},{id:3,text:"Science"},{id:5,text:"Other"}],noDataText:alcfg.infoText.data.noDataGeneric}),t=d(e.studentReadingGradeLevelData,"date");var c=[];t.forEach((function(e){n&&n.gradeLevel===e.gradeLevel?(e.sa&&(n.sa?(n.sa.gradeSum+=e.sa.gradeSum,n.sa.gradeCount+=e.sa.gradeCount):n.sa={gradeSum:e.sa.gradeSum,gradeCount:e.sa.gradeCount}),e.mc&&(n.mc?(n.mc.gradeSum+=e.mc.gradeSum,n.mc.gradeCount+=e.mc.gradeCount):n.mc={gradeSum:e.mc.gradeSum,gradeCount:e.mc.gradeCount})):(n=$.extend({},e),c.push(n))}));var u=e.lexileTemplate({lexileData:c,isStudent:!0,gradeNameMap:s.gradeNameMap(!0)});e.$el.find("#secStProfLexile .chartsContainer").html(u)};r.initDateRangePicker(n,l,(function(e,t,a){n=e,l=t,c()}),"student"),c()},renderVocabularyStudent:function(){var e=this,t=r.getSchoolYearRangeOrDefault("student"),n=t.start,i=t.end;if(this.studentVocabularyData&&this.studentVocabularyData.length>0){this.$el.html(this.vocabularyContainerTemplate({isStudentMode:!0})),this.renderVocabularyEl=function(t){var n,i=o(),r=[];if(t||(t="recency"===$(".sortDropdown li a.selected").data("sort")?"MaxCreateDate":"LookupCount"),i.length){if((i=a.sortBy(i,"Word")).forEach((function(e){n&&n.Word===e.Word?n.LookupCount+=e.LookupCount:(n=$.extend({},e),r.push(e))})),(r=a.sortBy(r,t).reverse()).length>0){var l=a.maxBy(r,(function(e){return e.LookupCount})).LookupCount;r.forEach((function(e){e.FontSize=s.lookupCountToFontSize(e.LookupCount,l)}))}e.$el.find("#vocabWrapper").html(e.vocabularyTemplate({studentVocabularyData:r})),$(".sortDropdown, .btnPrintView").show()}else e.$el.find("#vocabWrapper").html(e.vocabularyTemplate({studentVocabularyData:[]})),$(".sortDropdown, .btnPrintView").hide()};var o=function(){return e.studentVocabularyData.filter((function(e){return moment.utc(e.MaxCreateDate).isAfter(n)&&moment.utc(e.MaxCreateDate).isBefore(i)}))};r.initDateRangePicker(n,i,(function(t,a,s){n=t,i=a,e.renderVocabularyEl()}),"student"),this.renderVocabularyEl()}else this.$el.html("<div class='ctaInfo'>"+alcfg.infoText.sclasses.noVocabulary+"</div>"),$(".sortDropdown, .btnPrintView").hide()},renderPortfolioStudent:function(){var e=this,t=r.getSchoolYearRangeOrDefault("student");this.portfolioDateStart=t.start,this.portfolioDateEnd=t.end,this.$el.html(e.portfolioTemplate({isStudent:!0})),$(".btnPrintView, #portfolioFilters").show(),$(".subheader select").selectpicker(),r.initDateRangePicker(this.portfolioDateStart,this.portfolioDateEnd,(function(t,n,a){e.portfolioDateStart=t,e.portfolioDateEnd=n,l.getStudentWritingData.call(e,0)}),"student"),l.getStudentWritingData.call(e,0)},sort:function(e){var t="recency"==e?"MaxCreateDate":"LookupCount";this.renderVocabularyEl(t)},gotoPage:function(e){l.getStudentWritingData.call(this,e.pageNumber)},destroy:function(){$(".daterangepicker").remove()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(10),i=n(22),o=n(271);t.renderPagination=function(e){var t=this.$el.find("#pagination");i.mountReactComponent(o.default,t[0],{currentPage:e.currentPageNum,currentPageItemsCount:e.currentResult||0,itemsPerPage:alcfg.writingDataPageSize,totalItems:e.totalWritingCount||0,showTotalRecordsCount:!0,pageChangeCallback:this.gotoPage,parentComponentReference:this})},t.getStudentWritingData=function(e){var n=this,i=$(".ddlSkillBuckets").val(),o=$(".ddlTagType").val(),r=parseInt($(".ddlWordCount").val());s.GetStudentWritingData({studentUserId:this.studentUserId,tagType:o,skillBucketId:i,minWordsCount:r,start:n.portfolioDateStart.toISOString(),end:n.portfolioDateEnd.toISOString(),totalWritingCount:n.totalWritingCount,pageNumber:e,writingDataPageSize:alcfg.writingDataPageSize},(function(s){n.studentPortfolioData=n.isOnlyMyClassMode?a.filter(s.data,{IsCurrentTeacherAssignment:1}):s.data,0===e&&(n.totalWritingCount=s.totalCount),t.renderPortfolioResponses.call(n),t.renderPagination.call(n,{currentPageNum:e,totalPages:Math.ceil(n.totalWritingCount/alcfg.writingDataPageSize),totalWritingCount:n.totalWritingCount,currentResult:n.studentPortfolioData.length}),n.$el.animate({scrollTop:0},"500","swing")}))},t.renderPortfolioResponses=function(){this.studentPortfolioData&&this.studentPortfolioData.length>0?this.$el.find("#portfolioContainer").html(this.portfolioResponseTemplate({responseData:this.studentPortfolioData,grades:alcfg.grades.list,showOnlyLatestResponseStats:!0})):this.$el.find("#portfolioContainer").html("<div class='ctaInfo'>"+alcfg.infoText.data.noFilterData+"</div>")}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\r\n    <section>\r\n        <div class="reportrange pull-right"><span></span><b class="caret"></b></div>\r\n        <h2>Overall Stats\r\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover"\r\n                data-content="Overall statistics for all class assignments.',isStudentMode||(__p+=" Check to make sure the pace and stamina are reasonable and the student is looking up vocabulary and writing when they read."),__p+='"></button>\r\n        </h2>\r\n        <div class="twoColBlock">\r\n            <p id="summaryReadingTime"><span class="value"></span> <span class="description">hours read</span></p>\r\n            <p id="summaryPageCount"><span class="value"></span> <span class="description">pages read</span></p>\r\n            <p id="summaryDefinitionLookup"><span class="value"></span> <span class="description">vocab lookups</span>\r\n            </p>\r\n            <p id="summaryPace"><span class="value"></span> <span class="description">pages/hr pace</span></p>\r\n        </div>\r\n        <div class="twoColBlock">\r\n            <p id="summaryWordCount"><span class="value"></span> <span class="description">words written</span></p>\r\n            <p id="summaryAnswers"><span class="value"></span> <span class="description">answers</span></p>\r\n            <p id="summaryNotes"><span class="value"></span> <span class="description">notes</span></p>\r\n        </div>\r\n    </section>\r\n    <section>\r\n        <h2>Proficiency Trend\r\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover"\r\n                data-content="See how '+(null==(__t=isStudentMode?"your overall proficiency":"the overall proficiency of the student")?"":__t)+' is changing over time. The chart shows the number of Zero responses versus the number of Basic or Incomplete responses versus the number of Proficient or Advanced responses for the given time period."></button>\r\n        </h2>\r\n        <div class="trendsData">\r\n            <div class="wrapper">\r\n                '+(null==(__t=trendsHtml)?"":__t)+"\r\n            </div>\r\n        </div>\r\n    </section>\r\n</div>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",lexileData&&lexileData.length?(__p+='    \r\n    <div class="lexile suboption tableData">\r\n        <table>\r\n            <tr>\r\n                <th>Reading Level</th>\r\n                <th>Current Level</th>\r\n                <th># of Graded Responses</th>\r\n            </tr>\r\n\r\n            ',_.each(lexileData,(function(e){var t,n,a,s;__p+='\r\n            <tr>\r\n                <td class="labelInfo">'+(null==(__t=-1===e.gradeLevel?"Grade level not defined":cH.toOrdinal(e.gradeLevel)+" Grade")?"":__t)+"</td>\r\n                ",n=(t=((e.mc?.5*e.mc.gradeSum:0)+(e.sa?e.sa.gradeSum:0))/((e.mc?.5*e.mc.gradeCount:0)+(e.sa?e.sa.gradeCount:0)))>=3?"green":t<=2?"red":"yellow",a=t>=3?" "+gradeNameMap[3].label:t<=2?" "+gradeNameMap[2].label:gradeNameMap[2].label+" - "+gradeNameMap[3].label,s=(e.mc?e.mc.gradeCount:0)+(e.sa?e.sa.gradeCount:0),__p+='\r\n                <td class="grade '+(null==(__t=n)?"":__t)+'">'+(null==(__t=a)?"":__t)+"</td>\r\n                <td>"+(null==(__t=s)?"":__t)+"</td>\r\n            </tr>\r\n            "})),__p+="\r\n        </table>\r\n     </div>\r\n"):__p+='\r\n    <div class="empty">No data yet '+(null==(__t="undefined"!=typeof isStudentMode?"":"for this student")?"":__t)+"</div>\r\n",__p+="\r\n";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\n    <div class="reportrange pull-right"><span></span><b class="caret"></b></div>\n    <h2>Words Defined While Reading\n        <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="See which words '+(null==(__t=isStudentMode?"you":"a student")?"":__t)+' looked up while reading. Sort by recency or frequency."></button>\n    </h2>\n    <div id="vocabWrapper" class="dataContainer">\n    </div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",0===studentVocabularyData.length?__p+='\r\n    <div class="ctaInfo">No data for this date range!</div>\r\n':(__p+="\r\n    ",_.each(studentVocabularyData,(function(e){__p+='\r\n    <div class="cell" style="font-size: '+(null==(__t=e.FontSize)?"":__t)+'px;">\r\n        <span class="word">'+(null==(__t=cH.sanitize(e.Word))?"":__t)+'</span><span class="num">'+(null==(__t=e.LookupCount)?"":__t)+"</span>\r\n    </div>\r\n    "}))),__p+="";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="key">\n    <div class="advanced"><span class="circle"></span>'+(null==(__t=cH.sanitize(gradeNameMap[4].label))?"":__t)+'</div>\n    <div class="proficient"><span class="circle"></span>'+(null==(__t=cH.sanitize(gradeNameMap[3].label))?"":__t)+'</div>\n    <div class="basic"><span class="circle"></span>'+(null==(__t=cH.sanitize(gradeNameMap[2].label))?"":__t)+'</div>\n    <div class="incomplete"><span class="circle"></span>'+(null==(__t=cH.sanitize(gradeNameMap[1].label))?"":__t)+'</div>\n    <div class="zero"><span class="circle"></span>'+(null==(__t=cH.sanitize(gradeNameMap[0].label))?"":__t)+'</div>\n</div>\n\n<div class="yAxisScale top">\n    <span>'+(null==(__t=maxResponsesInMonth)?"":__t)+'</span>\n</div>\n<div class="yAxisScale mid">\n    <span>'+(null==(__t=parseInt(maxResponsesInMonth/2))?"":__t)+'</span>\n</div>\n<div class="yAxisScale bottom">\n    <span>0</span>\n</div>\n<div class="xaxisLabel">Number of graded responses</div>\n<div class="stackedBarContainer">\n    <div class="inner" style="width:'+(null==(__t=121*studentPerformanceData.length+1)?"":__t)+'px;">\n        <div class="chartYAxis"></div>\n        ',_.each(studentPerformanceData,(function(e){var t=e.basic+e.incomplete,n=e.proficient+e.advanced,a=300/maxResponsesInMonth*n,s=300/maxResponsesInMonth*t,i=300/maxResponsesInMonth*e.zero,o=Math.round(n/(t+n+e.zero)*100),r=Math.round(t/(t+n+e.zero)*100),l=Math.round(e.zero/(t+n+e.zero)*100),d=a*e.proficient/n,c=a*e.advanced/n,u=s*e.basic/t,p=s*e.incomplete/t,h=i;__p+='\n        <div class="stackedBarColumn '+(null==(__t=e.basic+e.advanced===0?"disabled":"")?"":__t)+'">\n            <div class="zeroBar" style="height:'+(null==(__t=h)?"":__t)+'px;" title="'+(null==(__t=l)?"":__t)+'%">\n                <span class="zero chunk" style="height: '+(null==(__t=h)?"":__t)+'px;"></span>\n            </div>\n            <div class="redBar" style="height:'+(null==(__t=s)?"":__t)+'px;" title="'+(null==(__t=r)?"":__t)+'%">\n                <span class="basic chunk" style="height: '+(null==(__t=u)?"":__t)+'px;"></span>\n                <span class="incomplete chunk" style="height: '+(null==(__t=p)?"":__t)+'px;"></span>\n            </div>\n            <div class="greenBar" style="height:'+(null==(__t=a)?"":__t)+'px" title="'+(null==(__t=o+"%")?"":__t)+'">\n                <span class="proficient chunk" style="height: '+(null==(__t=d)?"":__t)+'px;"></span>\n                <span class="advanced chunk" style="height: '+(null==(__t=c)?"":__t)+'px;"></span>\n            </div>\n            <div class="axisLabel">'+(null==(__t=cH.sanitize(e.label))?"":__t)+'</div>\n            <div class="performanceGrid"></div>\n        </div>\n        '})),__p+="\n    </div>\n</div>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="reportrange pull-right"><span></span><b class="caret"></b></div>\r\n<div class="container">\r\n    <section id="secStProfStandard">\r\n        <h2>Proficiency By Standard\r\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="See which standards require more work. The bars show the number of Proficient or Advanced answers\r\n        versus the number of Basic, Incomplete or Zero answers. If the trend is changing in the past 30 days,\r\n        you will see that to the right of the bar."></button>\r\n        </h2>\r\n        <div class="chartsContainer"></div>\r\n    </section>\r\n\r\n    <section id="secStProfDok">\r\n        <h2>\r\n            Proficiency By DoK Level\r\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="See which DoK levels require more work. The bars show the number of Proficient or Advanced answers\r\n        versus the number of Basic, Incomplete or Zero answers. If the trend is changing in the past 30 days,\r\n        you will see that to the right of the bar."></button>\r\n        </h2>\r\n        <div class="chartsContainer"></div>\r\n    </section>\r\n\r\n    <section id="secStProfContent">\r\n        <h2>Proficiency By Content\r\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="See which content areas require more work. The bars show the number of Proficient\r\n        or Advanced answers versus the number of Basic, Incomplete or Zero answers. If the\r\n        trend is changing in the past 30 days, you will see that to the right of the bar."></button>\r\n        </h2>\r\n        <div class="chartsContainer"></div>\r\n    </section>\r\n\r\n    <section id="secStProfLexile">\r\n        <h2>Proficiency By Reading Level\r\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="See variations in performance by reading level, which is a measure of text complexity.\r\n            If you see worse performance on higher reading levels, ensure you are practicing vocabulary that can help the student\'s understanding for that reading level."></button>\r\n        </h2>\r\n        <div class="chartsContainer"></div>\r\n    </section>\r\n</div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\n    <div class="reportrange pull-right"><span></span><b class="caret"></b></div>\n    <h2>Writing Log\n        <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="'+(null==(__t=isStudent?"See how you performed qualitatively for responses to short answer questions and notes across all your assignments and research.":"See how a student performs qualitatively over time by reviewing their responses to short answer questions and notes across assignments and research.")?"":__t)+'"></button>\n    </h2>\n\n    <div id="portfolioContainer"></div>\n    <div class="clearBoth"></div>\n    <div id="pagination"></div>\n</div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1370),s=n(1372),i=n(1374),o=n(1375),r=n(22);t.default=Backbone.View.extend({el:"div.manage",initialize:function(e){var t=this;this.subview=e.subview||"permissions",this.subheader=new s.default({scope:this}),this.childViews=[this.subheader],"dadmin"===sCH.userM.get("Role")?sCH.userM.isOnPrimePlan()?sCH.initDistrictSchools((function(){t.schools=sCH.schoolsC.toJSON(),t.preRender(t.schools)})):this.preRender([{SchoolId:1}]):(t.schools=sCH.userM.get("SchoolInfo"),this.preRender(t.schools))},preRender:function(e){var t=this;if(e.length>1){var n=e.map((function(e){return{value:e.SchoolId,label:e.Name}}));Backbone.pubEv.trigger("setHeaderActions",{selectors:[{type:"school",data:n,preSelectedValue:e[0].SchoolId,callback:function(e){t.currentSelectedSchoolId=e,t.subviewSelector()}}]})}else t.currentSelectedSchoolId=e[0].SchoolId,this.subviewSelector()},subviewSelector:function(){switch(r.unmountAllChildReactComponentsUnderParent(this.$el),this.subheader.selectTab(this.subview||"permissions"),this.subview){case"permissions":this.renderUserPermissions();break;case"accounts":this.renderAccounts();break;case"schoolbookcredits":this.renderSchoolBookCredits()}},renderUserPermissions:function(){Backbone.router.navigate("teacher/manage/permissions",{trigger:!1}),r.mountReactComponent(o.default,$(".scroll")[0],{schoolId:this.currentSelectedSchoolId})},renderAccounts:function(){Backbone.router.navigate("teacher/manage/accounts",{trigger:!1}),r.mountReactComponent(i.default,$(".scroll")[0],{schoolId:this.currentSelectedSchoolId})},renderSchoolBookCredits:function(){Backbone.router.navigate("teacher/manage/schoolbookcredits",{trigger:!1}),this.scrollView&&this.scrollView.destroy(),this.scrollView=new a.default({schoolId:this.currentSelectedSchoolId}),this.scrollView.preRender()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(10),i=n(69),o=n(1371),r=n(22);t.default=Backbone.View.extend({el:".layout .scroll",initialize:function(e){this.obj=e},preRender:function(){if(sCH.userM.isOnPrimePlan()){var e=this;s.GetSchoolBookCreditsData({schoolId:this.obj.schoolId},(function(t){!1===t.Success?e.render():(e.data=t,e.render())}))}else this.$el.html(new i.default({screenshotUrl:"/img/ManageUsers_ContentCredits.png",showSampleBanner:!0}).render().$el)},render:function(){if(this.data){var e={isUnlimited:null===this.data.sbcInfo.AmountInCents,totalAmount:this.data.sbcInfo.AmountInCents,amountUsed:a.sum(a.map(this.data.creditsUsedPerTeacher,"TeacherUsageAmountInCents"))};e.amountRemaining=e.totalAmount-e.amountUsed,e.amountLow=e.amountRemaining<2e4&&e.totalAmount>2e4,e.subjectsAllowed={1:!0,2:!0,3:!0,6:!0},this.data.sbcInfo.SubjectsStringNotAllowed&&a.map(this.data.sbcInfo.SubjectsStringNotAllowed.split(","),(function(t){e.subjectsAllowed[t]=!1})),r.mountReactComponent(o.default,this.$el[0],{teachers:this.data.creditsUsedPerTeacher,usage:e,schoolId:this.obj.schoolId})}else this.$el.html("<div class='ctaInfo'>"+alcfg.infoText.aData.notUsingSchoolBookCredits+"</div>")},destroy:function(){this.undelegateEvents()}})},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(60),o=n(10),r=n(5),l=70,d={height:50,cells:["Name","Username","Subject Name","Content credits used","Titles"].map((function(e){return{content:e,width:225,notSortable:"Titles"===e}}))};t.default=function(e){var t=e.usage,n=e.teachers,c=e.schoolId,u=s.useState(t.subjectsAllowed),p=u[0],h=u[1],g=n.map((function(e){var t=r.sanitize(e.LastName)+", "+r.sanitize(e.FirstName),n=r.sanitize(e.UserName),a=r.getSubjectNameFromId(e.SubjectId),s=e.TeacherUsageAmountInCents?"$"+(e.TeacherUsageAmountInCents/100).toFixed(2):"-";return{height:Math.max(11.5*e.Titles.length*14/240,l),cells:[{content:t,sortValue:t},{content:n,sortValue:n},{content:a,sortValue:a},{content:s,sortValue:s},{content:r.sanitize(e.Titles)}]}}));function f(e){var t=a({},p);t[e]=!t[e],h(t)}return s.createElement(s.Fragment,null,s.createElement("div",{className:"statsHeader"},s.createElement("div",{className:"usageStat"},"Total content credits allocated:",t.isUnlimited?s.createElement("h2",null,"Unlimited"):s.createElement("h2",null,(t.totalAmount/100).toFixed(2))),s.createElement("div",{className:"usageStat"},"Total content credits used:",s.createElement("h2",null,(t.amountUsed/100).toFixed(2))),s.createElement("div",{className:"usageStat"},"Total content credits remaining:",t.isUnlimited?s.createElement("h2",{className:"green"},"Unlimited"):s.createElement("h2",{className:t.amountLow?"red":"green"},(t.amountRemaining/100).toFixed(2)))),s.createElement("div",{className:"sbcSubjectsAllowedContainer"},s.createElement("p",null,"Select teacher subjects that can access book credits:"),s.createElement("ul",null,s.createElement("li",null,s.createElement("input",{id:"chkIsAllowedELA",type:"checkbox",className:"chkIsAllowed regular-checkbox",checked:p[1],onChange:function(){return f(1)}}),s.createElement("label",{htmlFor:"chkIsAllowedELA"}),s.createElement("span",null,"ELA")),s.createElement("li",null,s.createElement("input",{id:"chkIsAllowedSocialstudies",type:"checkbox",className:"chkIsAllowed regular-checkbox",checked:p[2],onChange:function(){return f(2)}}),s.createElement("label",{htmlFor:"chkIsAllowedSocialstudies"}),s.createElement("span",null,"Social Studies")),s.createElement("li",null,s.createElement("input",{id:"chkIsAllowedScience",type:"checkbox",className:"chkIsAllowed regular-checkbox",checked:p[3],onChange:function(){return f(3)}}),s.createElement("label",{htmlFor:"chkIsAllowedScience"}),s.createElement("span",null,"Science")),s.createElement("li",null,s.createElement("input",{id:"chkIsAllowedOther",type:"checkbox",className:"chkIsAllowed regular-checkbox",checked:p[6],onChange:function(){return f(6)}}),s.createElement("label",{htmlFor:"chkIsAllowedOther"}),s.createElement("span",null,"Others"))),s.createElement("button",{className:"btn-box btnUpdateAllowedSubjects",onClick:function(){var e={schoolId:c,subjectAllowMap:[{subjectId:1,isAllowed:p[1]},{subjectId:2,isAllowed:p[2]},{subjectId:3,isAllowed:p[3]},{subjectId:6,isAllowed:p[6]}]};o.UpdateSchoolBookCreditSubjectMaps(e,(function(){r.bootstrap.alert({message:"Successfully updated teacher subjects allowed to use content credits!"})}))}},"Update")),n.length>0?s.createElement(i.VTable,{header:d,body:g,fixedRowCount:1,fixedColumnCount:1,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,customClassNames:["creditsUsedTable"]}):s.createElement("div",{className:"ctaInfo"},"No one has used content credits yet."))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({el:".layout .subheader",events:{"click .tabs a":"selectSubView"},template:n(1373),initialize:function(e){return this.scope=e.scope,this.render(),this},render:function(){a.renderBackboneTemplateAsync(this.el,this.template())},selectTab:function(e){this.$el.find("a.btn-tab").removeClass("selected"),this.$el.find('.btn-tab[data-view="'+e+'"]').addClass("selected")},selectSubView:function(e){this.scope.subview=$(e.currentTarget).data("view"),this.scope.subviewSelector()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<nav role="tablist" aria-label="Tabs" class="tabs">\n  <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabPermissions selected" data-view="permissions">Permissions</a>\n  <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabAccounts" data-view="accounts">Accounts</a>\n  <a href="javascript:void(0)" role="tab" class="btn-tab pull-left tabSchoolBookCredits" data-view="schoolbookcredits">Content Credits</a>\n</nav>';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(65),r=n(60),l=n(71),d=n(69),c=n(10),u=n(5),p=n(234),h=n(72),g=n(8),f=50,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showBuildings=sCH.userM.isOnPrimePlan()&&"dadmin"===sCH.userM.get("Role"),t.state={teacherList:null},t.getHeader=function(){return{height:f,cells:[{content:"Name",width:t.showBuildings?270:360},{content:"Username",width:t.showBuildings?270:360},{content:"Buildings",width:t.showBuildings?270:0,notSortable:!0},{content:"Last Sign in",width:t.showBuildings?270:360,notSortable:!0},{content:"",width:70,notSortable:!0}]}},t.getBody=function(){return t.state.teacherList.map((function(e){return{height:f,cells:[{content:u.sanitize(e.LastName)+", "+u.sanitize(e.FirstName),sortValue:u.sanitize(e.LastName)+", "+u.sanitize(e.FirstName)},{content:u.sanitize(e.Username),sortValue:u.sanitize(e.Username)},{content:t.showBuildings?i.createElement(v,{teacher:e,saveBuildingsSelection:t.saveBuildingsSelection}):null,classes:{allowOverflow:!0}},{content:moment.utc(e.LastSignInDate).format("MM/DD/YY"),sortValue:e.LastSignInDate,classes:{center:!0}},{content:"teacher"===e.Role&&e.UserId!==sCH.userM.get("UserId")?i.createElement(o.default,{title:"Delete teacher",tooltipPlacement:"left"},i.createElement("button",{className:"icon-trash btnDeleteAccount","data-userid":e.UserId,onClick:t.deleteTeacherAccount,style:{marginRight:20}})):null}]}}))},t.saveBuildingsSelection=function(e,n){n&&n.length>0&&c.UpdateUserSchoolMaps({teacherUserId:e,schoolIds:n},(function(){var a=t.state.teacherList;g.find(a,{UserId:e}).SchoolIds=n,t.setState({teacherList:a}),u.bootstrap.alert({message:"User building settings updated successfully!"})}))},t.deleteTeacherAccount=function(e){var n=parseInt(e.target.getAttribute("data-userid"));new Backbone.BootstrapModal({title:"Delete account?",content:"<p>This teacher's classes will be deleted but their data will still appear in admin data reports.</p>",okText:"Delete",cssClass:"modal-delete modal-al-delete-t-account"}).open((function(){c.DeleteTeacherAccount({teacherUserId:n},(function(){var e=t.state.teacherList.filter((function(e){return e.UserId!==n}));t.setState({teacherList:e}),u.bootstrap.alert({message:"Account has been deleted!"})}))}))},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;sCH.userM.isOnPrimePlan()?c.GetAccountsData({schoolId:this.props.schoolId},(function(t){t&&e.setState({teacherList:t.teacherList})})):this.setState({teacherList:[]})},t.prototype.render=function(){return this.state.teacherList&&(sCH.userM.isOnPrimePlan()?this.state.teacherList.length>0?i.createElement(r.VTable,{header:this.getHeader(),body:this.getBody(),fixedRowCount:1,fixedColumnCount:1,enableFixedColumnScroll:!0,enableFixedRowScroll:!0}):i.createElement("div",{className:"ctaInfo",dangerouslySetInnerHTML:{__html:alcfg.infoText.aData.noPrimeUsers}}):i.createElement(l.default,{view:d.default,options:{screenshotUrl:"/img/ManageUsers_Accounts.png",showSampleBanner:!0},className:"trialSplash"}))},t}(i.Component);t.default=m;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectRef=i.createRef(),t.state={selectedBuildings:null},t.initSelect=function(){var e=[];sCH.schoolsC.models.forEach((function(n){t.props.teacher.SchoolIds.indexOf(n.get("SchoolId"))>=0&&e.push({value:n.get("SchoolId"),label:u.sanitize(n.get("Name"))})})),t.setState({selectedBuildings:e})},t.handleChange=function(e){t.setState({selectedBuildings:e}),t.props.saveBuildingsSelection(t.props.teacher.UserId,e.map((function(e){return e.value})))},t.getSelected=function(){return 1===t.state.selectedBuildings.length?t.state.selectedBuildings[0].label:t.state.selectedBuildings.length+" Buildings Selected"},t}return s(t,e),t.prototype.componentDidMount=function(){this.initSelect()},t.prototype.componentDidUpdate=function(e){this.props.teacher.UserId!==e.teacher.UserId&&this.initSelect()},t.prototype.render=function(){return this.state.selectedBuildings&&i.createElement(p.MultiSelectFilter,{suggestions:sCH.schoolsC.models.map((function(e){return{value:e.get("SchoolId"),label:u.sanitize(e.get("Name"))}})),onChange:this.handleChange,values:this.state.selectedBuildings},i.createElement(h.default,{buttonClass:"btn dropdown-toggle btn-default",buttonTitle:this.getSelected(),style:{display:"flex",alignItems:"center",justifyContent:"flex-start"}},i.createElement("div",{style:{width:230,overflow:"hidden",textOverflow:"ellipsis"}},this.getSelected()),i.createElement("div",{className:"caret"})))},t}(i.Component)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(60),r=n(71),l=n(69),d=n(10),c=n(5),u=65,p=65,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={users:null},t.getHeader=function(){return{height:u,cells:[{content:"Name",width:240},{content:"Username",width:240},{content:i.createElement(i.Fragment,null,"Can view school",i.createElement("br",null),"& teacher reports"),width:165,classes:{center:!0}},{content:i.createElement(i.Fragment,null,"Can manage",i.createElement("br",null),"school standards"),width:165,classes:{center:!0}},{content:i.createElement(i.Fragment,null,"Can manage",i.createElement("br",null),sCH.userM.getLibraryString()),width:165,classes:{center:!0}},{content:i.createElement(i.Fragment,null,"Can manage",i.createElement("br",null),"user permissions"),width:165,classes:{center:!0}}]}},t.getBody=function(){return t.state.users.map((function(e){var t="admin"===e.Role||"dadmin"===e.Role,n=e.UserId===sCH.userM.get("UserId");return{height:p,cells:[{content:c.sanitize(e.LastName)+", "+c.sanitize(e.FirstName),sortValue:c.sanitize(e.LastName)+", "+c.sanitize(e.FirstName)},{content:c.sanitize(e.Username),sortValue:c.sanitize(e.Username)},{content:i.createElement(g,{permissionName:"CanViewAdminReports",isAdmin:t,checkboxClass:"chkCanViewReports",checkboxId:"chkCanViewReports"+e.UserId,user:e}),classes:{center:!0},sortValue:!(e.CanViewAdminReports||t)},{content:i.createElement(g,{permissionName:"CanAddCustomStandards",isAdmin:t,checkboxClass:"chkCanAddCustomStandards",checkboxId:"chkCanAddCustomStandards"+e.UserId,user:e}),classes:{center:!0},sortValue:!(e.CanAddCustomStandards||t)},{content:i.createElement(g,{permissionName:"CanManageLibrary",isAdmin:t,checkboxClass:"chkCanManageLibrary",checkboxId:"chkCanManageLibrary"+e.UserId,user:e}),classes:{center:!0},sortValue:!(e.CanManageLibrary||t)},{content:i.createElement(g,{permissionName:"CanManageUserPermissions",isAdmin:t||n,checkboxClass:"chkCanManageUserPermissions",checkboxId:"chkCanManageUserPermissions"+e.UserId,user:e}),classes:{center:!0},sortValue:!(e.CanManageUserPermissions||t)}]}}))},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;sCH.userM.isOnPrimePlan()?d.GetUserPermissionsData({schoolId:this.props.schoolId},(function(t){t&&e.setState({users:t})})):this.setState({users:[]})},t.prototype.render=function(){return this.state.users&&(sCH.userM.isOnPrimePlan()?this.state.users.length>0?i.createElement(o.VTable,{header:this.getHeader(),body:this.getBody(),fixedRowCount:1,fixedColumnCount:1,enableFixedColumnScroll:!0,enableFixedRowScroll:!0}):i.createElement("div",{className:"ctaInfo",dangerouslySetInnerHTML:{__html:alcfg.infoText.aData.noPrimeUsers}}):i.createElement(r.default,{view:l.default,options:{screenshotUrl:"/img/ManageUsers_Permissions.png",showSampleBanner:!0},className:"trialSplash"}))},t}(i.Component);t.default=h;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isChecked:t.props.user[t.props.permissionName]||t.props.isAdmin},t.togglePermission=function(){var e=t.props.permissionName,n=t.props.user.UserId;d.ToggleUserPermission({teacherUserId:n,permissionName:e,isChecked:!t.state.isChecked},(function(){c.bootstrap.alert({message:"Permissions updated successfully!"})})),t.props.user[t.props.permissionName]=!t.state.isChecked,t.setState({isChecked:!t.state.isChecked})},t}return s(t,e),t.prototype.componentDidUpdate=function(e){e.user!==this.props.user&&this.setState({isChecked:this.props.user[this.props.permissionName]||this.props.isAdmin})},t.prototype.render=function(){return i.createElement(i.Fragment,null,i.createElement("input",{id:this.props.checkboxId,type:"checkbox",className:this.props.checkboxClass+" regular-checkbox",checked:this.state.isChecked,disabled:this.props.isAdmin,onChange:this.togglePermission}),i.createElement("label",{htmlFor:this.props.checkboxId}))},t}(i.Component)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(5),l=n(43),d=n(85),c=n(266),u=n(749),p=n(1381),h=n(323),g=n(8),f=n(1383),m=n(72),v=n(65),b=n(736),C=n(24),y=n(14),_=o.Component,S=o.Fragment,w=o.createRef,T=n(20),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainMenuRef=w(),t.state={isStudent:r.userIsStudent(),isOnPrimePlan:c.userM.isOnPrimePlan(),isHigherEd:c.userM.get("IsHigherEd"),onDevice:r.onDevice(),isAddClassAllowed:!c.userM.isNonALDemoUser(),selectedClassId:t.props.classId,mainMenuTabName:t.props.mainMenuTabName,classesC:c.classesC,shouldRenderIR:c.userM.get("ShouldShowIRInMainMenu")},t.handleMenuAutoClose=function(e){!(c.userM.isAnonUser()||r.onDevice()&&90!==Math.abs(window.orientation))||$(e.target).hasClass("btnMainMenu")||!t.props.isMenuOpen||(t.disableMenuTransition(),t.props.toggleMenuState(!1))},t.enableMenuTransition=function(){document.querySelector(".mainMenu").style.transition="margin-left 350ms ease-in-out"},t.disableMenuTransition=function(){document.querySelector(".mainMenu").style.transition="none"},t.handleClassUpdates=function(){h.initializeGeneralUpdates(),t.updateClassData()},t.updateClassData=function(){return t.setState({classesC:c.classesC.sort()})},t.handleOrientationChange=function(){90===Math.abs(window.orientation)||t.props.toggleMenuState(!1)},t.isClassUrl=function(){var e=window.location.hash.split("/");return"classes"==e[1]&&!isNaN(parseInt(e[2]))},t.menuToggled=function(){t.props.isMenuOpen?(document.querySelector(".mainMenu .alLogo").style.display="block",document.querySelector(".menuListWrapper").style.display="block"):(document.querySelector(".mainMenu .alLogo").style.display="none",document.querySelector(".menuListWrapper").style.display="none"),Backbone.pubEv.trigger("mainMenuToggled")},t.signOut=function(){d.signOut("mainmenu")},t.toggleMainMenu=function(){t.enableMenuTransition(),t.props.isMenuOpen||(document.querySelector(".mainMenu .alLogo").style.display="block",document.querySelector(".menuListWrapper").style.display="block"),t.props.toggleMenuState()},t.skipNavigationForKeyboard=function(e){var t=document.querySelector('.scroll [tabindex="0"],.scroll a[href],.scroll button');t?t.focus():e.target.blur()},t.updateMainMenuNotification=function(e){var n,a=c.classesC.find({ClassId:e.classId}).get("NotificationsByAssignment");a&&(e.isRemoved?g.each(e.assignmentIds,(function(e){a[e]&&(n=!0,delete a[e])})):g.each(e.assignmentIds,(function(e){a[e]&&(n=!0)})),n&&t.setState({classesC:c.classesC}))},t}return s(t,e),t.prototype.componentDidMount=function(){c.classesC.sort(),this.setState({classesC:c.classesC}),c.classesC.on("add remove",this.handleClassUpdates),c.classesC.on("change reset",this.updateClassData),r.rubberBandFix(),document.body.addEventListener("click",this.handleMenuAutoClose),$(window).on("orientationchange",this.handleOrientationChange),Backbone.pubEv.on("updateMainMenuNotification",this.updateMainMenuNotification),document.querySelector(".mainMenu").addEventListener("transitionend",this.menuToggled)},t.prototype.componentWillUnmount=function(){c.classesC.off("add remove",this.handleClassUpdates),c.classesC.off("change reset",this.updateClassData),$(window).off("orientationchange",this.handleOrientationChange),Backbone.pubEv.off("updateMainMenuNotification",this.updateMainMenuNotification),document.querySelector(".menuListWrapper").removeEventListener("transitionend",this.menuToggled),document.body.removeEventListener("click",this.handleMenuAutoClose)},t.prototype.componentWillReceiveProps=function(e){e.classId===this.props.classId&&e.mainMenuTabName===this.props.mainMenuTabName||this.setState({selectedClassId:e.classId,mainMenuTabName:e.mainMenuTabName})},t.prototype.render=function(){var e="student"!==c.userM.get("Role")&&("teacher"!==c.userM.get("Role")||c.userM.teacherHasAnyAdminPermission()),t=c.userM.get("UserPermissions"),n=c.userM.get("LTIAccountSettings"),a=!(n&&n.DisableManualClassAddAndJoin),s=!c.userM.isNonALDemoUser(),l=this.state,d=l.isStudent,u=l.isOnPrimePlan,p=l.isHigherEd,h=l.isAddClassAllowed,g=l.classesC,v=l.selectedClassId,b=l.mainMenuTabName,C=l.shouldRenderIR,y=this.props.isMenuOpen,_=this.isClassUrl(),S=r.classNames({mainMenu:!0,mainMenuOpen:y}),w=g.models.map((function(e){if(!e.attributes.IsHidden)return o.createElement(E,{isStudent:d,isSelected:v===e.get("ClassId"),isClassUrl:_,classDetails:e,key:e.get("ClassId")})}));return o.createElement("nav",{"aria-label":"Main Menu",className:S},o.createElement("div",{className:"mainMenuHeader"},o.createElement("button",{className:"skipNavigationBtn",onClick:this.skipNavigationForKeyboard},"Skip Navigation"),T.default.isMath?o.createElement("div",{className:"alLogo"},o.createElement("img",{src:T.default.mathIframeOrigin+"/logoOrange.png"})):o.createElement("div",{className:"alLogo icon-logo"}),o.createElement(m.default,{buttonClass:"btnMainMenu "+(y?"icon-cancel":"icon-menu"),buttonTitle:y?"Close menu":"Open menu",onClick:this.toggleMainMenu,tooltipColor:y?"white":"black",tooltipPlacement:y?"left":"right"})),o.createElement(f.default,{className:"menuListWrapper",renderThumbVertical:function(){return o.createElement("div",{className:"scrollThumb"})},ref:this.mainMenuRef},d?o.createElement(x,i({},{isOnPrimePlan:u,classList:w,mainMenuTabName:b,isJoinClassAllowed:a,shouldRenderIR:C})):o.createElement(k,i({},{isOnPrimePlan:u,isHigherEd:p,isAddClassAllowed:h,hasPerms:e,userPerms:t,classList:w,isUnarchiveAllowed:s,mainMenuTabName:b,shouldRenderIR:C},{handleClassUpdates:this.handleClassUpdates,updateClassData:this.updateClassData})),o.createElement("a",{className:"btnSignOut",href:"javascript:void(0)",onClick:this.signOut},"Sign out"),o.createElement("div",{className:"spacer"})))},t}(_);t.default=I;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasHiddenClass:c.classesC.findWhere({IsHidden:!0})},t.joinClass=function(){new Backbone.BootstrapModal({title:"Join class",content:new u.default,allowCancel:!1,cssClass:"modal-al-join-class",okText:"Join",enterTriggersOk:!0}).open(),Backbone.tracking.trackGAEvent("student","joinClass:start")},t.unHideClasses=function(){new Backbone.BootstrapModal({title:"Unhide classes",content:new p.default,okText:"Unhide",cssClass:"modal-lg modal-al-unarchive-classes"})},t}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.isOnPrimePlan,n=e.classList,a=e.mainMenuTabName,s=e.isJoinClassAllowed,i=e.shouldRenderIR;return o.createElement(S,null,o.createElement("section",null,o.createElement("div",{className:"sectionHeader"},"Classes",o.createElement("div",{className:"mainMenuClassBtns"},this.state.hasHiddenClass&&o.createElement(m.default,{buttonClass:"unarchiveClasses icon-archive iconBtn",buttonTitle:"Unhide classes",onClick:this.unHideClasses,tooltipColor:"white",tooltipPlacement:"left"}),s&&o.createElement(m.default,{buttonClass:"btnJoinClass icon-plus iconBtn",buttonTitle:"Join class",onClick:this.joinClass,tooltipColor:"white",tooltipPlacement:"left"}))),o.createElement("ul",{className:"classList"},n)),t&&!l.mobile&&o.createElement("section",{className:"hideForMath"},o.createElement("div",{className:"sectionHeader"},"Reports"),o.createElement("a",{className:"data"+("data"==a?" selected":""),href:"#student/data"},"My Data")),i&&o.createElement("section",{className:"hideForMath"},o.createElement("div",{className:"sectionHeader"},"Other"),o.createElement("a",{className:"independentReading"+("independentReading"==a?" selected":""),href:"#student/catalog"},y.CovidIRStatus?"Library":"Independent Reading")))},t}(_),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasArchivedClasses:c.userM.get("HasArchivedClasses")},t.addClass=function(){C.showModal(o.createElement(b.default,{callback:function(e){window.setTimeout((function(){r.bootstrap.alert({message:"Your class was created successfully! Check your email for a message to help you add students."})}),100),Backbone.tracking.trackGAEvent("teacher","addedClass"),r.redirectUserByHash(r.getClassUrl(e,"roster"))},title:"Add new class"})),Backbone.tracking.trackGAEvent("teacher","addClass:start")},t.checkArchivedClass=function(){t.setState({hasArchivedClasses:c.userM.get("HasArchivedClasses")})},t.unarchiveClasses=function(){var e=t;new Backbone.BootstrapModal({title:"Un-archive classes",content:new p.default({afterUnarchive:function(t){c.clearCollection("classesC"),c.initClasses((function(){c.classesC.on("change reset add remove",e.props.handleClassUpdates),c.classesC.on("change reset",e.props.updateClassData),e.props.handleClassUpdates(),e.checkArchivedClass(),r.bootstrap.alert({message:alcfg.alertsText.classesUnArchived}),t.close()}),!1)}}),okText:"Un-archive",cssClass:"modal-lg modal-al-unarchive-classes"})},t.gotoCatalogHomepage=function(){Backbone.pubEv.trigger("clearCatalogFilters"),Backbone.pubEv.trigger("resetSearch")},t}return s(t,e),t.prototype.componentDidMount=function(){c.userM.on("change reset add remove",this.checkArchivedClass)},t.prototype.componentWillUnmount=function(){c.userM.off("change reset add remove",this.checkArchivedClass)},t.prototype.render=function(){var e=this.props,t=e.isOnPrimePlan,n=e.isHigherEd,a=e.isAddClassAllowed,s=e.hasPerms,i=e.userPerms,r=e.classList,d=e.mainMenuTabName,c=e.isUnarchiveAllowed,u=e.shouldRenderIR,p=!l.mobile&&s||!n&&u;return o.createElement(S,null,o.createElement("ul",null,o.createElement("li",null,o.createElement("a",{className:"catalog"+("catalog"==d?" selected":""),href:"#teacher/catalog",onClick:this.gotoCatalogHomepage},"Content")),s&&(!i||i.CanViewAdminReports)&&o.createElement(S,null,o.createElement("li",{className:"hideForMath"},o.createElement("a",{className:"teachers"+("teachers"==d?" selected":""),href:"#teacher/teachers"},"Coaching Reports ",!t&&o.createElement("span",{className:"icon-premium-lock"}))),o.createElement("li",{className:"hideForMath"},o.createElement("a",{className:"school"+("school"==d?" selected":""),href:"#teacher/school"},"Administrator Reports ",!t&&o.createElement("span",{className:"icon-premium-lock"})))),o.createElement("li",{className:"hideForMath"},o.createElement("a",{className:"professionalLearning"+("professionalLearning"==d?" selected":""),href:"#teacher/professionallearning"},"Professional Learning"))),o.createElement("section",null,o.createElement("div",{className:"sectionHeader"},o.createElement("div",{className:"title"},"Classes"),a&&o.createElement("div",{className:"mainMenuClassBtns"},this.state.hasArchivedClasses&&c&&o.createElement(m.default,{buttonClass:"unarchiveClasses icon-archive iconBtn",buttonTitle:"Unarchive classes",tooltipPlacement:"left",tooltipColor:"white",onClick:this.unarchiveClasses}),o.createElement(m.default,{buttonClass:"btnAddClass icon-plus iconBtn",buttonTitle:"Add new class",onClick:this.addClass,tooltipPlacement:"left",tooltipColor:"white"}))),o.createElement("ul",{className:"classList"},r)),p&&o.createElement("section",{className:"hideForMath"},o.createElement("div",{className:"sectionHeader"},"Manage"),o.createElement("ul",null,!l.mobile&&s&&o.createElement(S,null,(!i||i.CanAddCustomStandards)&&o.createElement("li",null,o.createElement("a",{className:"standards"+("standards"==d?" selected":""),href:"#teacher/standards"},"Standards ",!t&&o.createElement("span",{className:"icon-premium-lock"}))),(!i||i.CanManageUserPermissions)&&o.createElement("li",null,o.createElement("a",{className:"manage"+("manage"==d?" selected":""),href:"#teacher/manage"},"Manage Users ",!t&&o.createElement("span",{className:"icon-premium-lock"})))),!n&&u&&o.createElement("li",null,o.createElement("a",{className:"independentReading"+("independentReading"==d?" selected":""),href:"#teacher/ir/catalog"},y.CovidIRStatus?"Student Library":"Independent Reading")))))},t}(_),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasClassNotifications:!1,resetCount:0,flagCount:0,flagResponseCount:0,notificationTitle:""},t.checkNotification=function(e){if(!T.default.isMath){var n=JSON.parse(e.attributes.Settings);if(null==n||!n.reading||n.reading.Notifications){var a=0,s=0,i=0,o="",r=e.attributes.NotificationsByAssignment;r&&Object.keys(r).forEach((function(e){var t=r[e];t.Comprehension&&(s+=t.Comprehension.split(",").length),t.QuestionResponseResetRequest&&(a+=t.QuestionResponseResetRequest.split(",").length),t.FlagResponse&&(i+=t.FlagResponse.split(",").length)})),a+s+i>0&&(s&&(o+="<div class='noBreak'>Don't understand flags: <span class='count'>"+s+"</span></div>"),i&&(o+="<div class='noBreak'>Don't understand flag's</div><div>replies: <span class='count'>"+i+"</span></div>"),a&&(o+="<div class='noBreak'>Revision requests: <span class='count'>"+a+"</span></div>"),t.setState({hasClassNotifications:!0,resetCount:a,flagResponseCount:i,flagCount:s,notificationTitle:o}))}}},t.goToClass=function(e){var n;if(t.props.isStudent)n="assignments",h.subscribeStudentToClassUpdates(e);else if(t.props.isClassUrl){var a=window.location.hash.split("/");n=a.length>=4&&a[3]?a[3]:"assess"}else n="assess";window.location.href=r.getClassUrl(e,n)},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.classDetails,n=e.isSelected,a=e.isStudent;this.checkNotification(t),a&&n&&h.subscribeStudentToClassUpdates(t.get("ClassId"))},t.prototype.componentWillReceiveProps=function(e){this.checkNotification(e.classDetails)},t.prototype.render=function(){var e=this,t=this.props,n=t.classDetails,a=t.isSelected,s=this.state,i=s.hasClassNotifications,l=s.resetCount,d=s.flagCount,c=s.flagResponseCount,u=s.notificationTitle,p=r.sanitize(n.attributes.ClassId),h=r.htmlDecode(r.sanitize(n.attributes.Name)),g=r.classNames({hasNotifications:i,selected:a});return o.createElement("li",null,o.createElement("a",{className:g,href:"javascript:void(0)",onClick:function(){return e.goToClass(p)},"data-classid":p},h,l+d+c>0&&o.createElement(v.default,{title:r.htmlDecode(u),tooltipColor:"white",tooltipPlacement:"left"},o.createElement("span",{className:"notificationCount","data-html":"true","data-placement":"left"},l+d+c))))},t}(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1378),initialize:function(){this.on("initialized",this.modalInitialized),this.on("ok",this.joinMyClass)},events:{"change [type='checkbox']":"courseSelected"},modalInitialized:function(e){this.modal=e;var t=this;i.GetClassesForStudentModeTeacher((function(e){e&&(t.teacherClasses=e,t.modal.open())}))},render:function(){return this.$el.html(this.template({alClasses:sCH.classesC.toJSON(),courses:this.teacherClasses})),this.modal.disableOk(),this},courseSelected:function(){0!==this.$el.find("ul.checklist input[type='checkbox']:checked").length?this.modal.enableOk():this.modal.disableOk()},joinMyClass:function(e){if(e.preventClose(),!this.$el.parents(".modal").find(".btn.ok").hasClass("disabled")){e.disableOk("Joining...");var t=[];a.each(this.$el.find("input[type='checkbox']:checked"),(function(e){t.push($(e).data("classid"))})),sCH.classesC.joinMyClass({classIds:t},(function(n){e.close(),n?(s.bootstrap.alert({message:"Joined your classes!"}),s.redirectUserByHash(s.getClassUrl(t[0],"assignments"))):s.bootstrap.alert({message:"Failed to join your classes! We are looking into it.",alert:"danger"})}))}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",courses.length>0?(__p+='\n    <p>Select your classes you want to join in Student Mode.</p>\n    <ul class="checklist">\n        ',_.each(courses,(function(e,t){var n=_.find(alClasses,(function(t){return t.ClassId===e.ClassId}));__p+='\n                <li>\n                    <div class="checkbox">\n                        ',__p+=n?'\n                            <div class="assigned"></div>\n                        ':'\n                        <input id="chkSelectCourse'+(null==(__t=e.ClassId)?"":__t)+'" data-classid="'+(null==(__t=e.ClassId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n                            <label for="chkSelectCourse'+(null==(__t=e.ClassId)?"":__t)+'"></label>\n                        ',__p+='\n                    </div>\n                    <div class="title">'+(null==(__t=cH.sanitize(e.Name))?"":__t)+"</div>\n                </li>\n        "})),__p+="\n    </ul>\n"):__p+="\n    <p>No courses found!</p>\n",__p+="";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<a class="btnMyClass btn-box large">Join one of my classes</a>\n<div class="divider">OR</div>\n<a class="btnNativeClass btn-box large">Join another teacher\'s class using a code</a>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<p>\n  Enter the "+(null==(__t=cH.getProductName())?"":__t)+" class code "+(null==(__t=isMappedToTeacher?"provided by a colleague":"your teacher provided")?"":__t)+':\n  <br />(For example: f2bce or 23b1da4e)\n</p>\n<input class="txtClassCode" placeholder="Class code" />';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(333),i=n(10);t.default=Backbone.View.extend({template:n(1382),initialize:function(e){this.afterUnarchive=e?e.afterUnarchive:null,this.on("ok",this.unArchive),this.on("initialized",this.modalInitialized)},events:{"change [type='checkbox']":"classSelected"},modalInitialized:function(e){if(this.modal=e,"student"===sCH.userM.get("Role")){var t=this;this.classesC=new s.default,a.each(sCH.classesC.models,(function(e){e.get("IsHidden")&&t.classesC.add(e)})),e.open()}else this.classesC=new s.default,this.classesC.fillArchived(),this.classesC.on("sync",(function(){e.open()}),this)},render:function(){return this.$el.html(this.template({classes:this.classesC.toJSON()})),this.modal.disableOk(),this},classSelected:function(){0!==this.$el.find("ul input[type='checkbox']:checked").length?this.modal.enableOk():this.modal.disableOk()},unArchive:function(e){e.preventClose(),e.disableOk("student"===sCH.userM.get("Role")?"Unhiding...":"Un-Archiving...");var t=[],n=this;a.each(this.$el.find("input[type='checkbox']:checked"),(function(e){t.push($(e).data("classid"))})),"student"===sCH.userM.get("Role")?i.ToggleClassHiddenState({classIds:t,shouldHideClass:!1},(function(){Backbone.router.navigate("student/classes",{trigger:!1}),window.location.reload()})):this.classesC.unArchiveClasses(t,(function(a){a&&n.afterUnarchive&&(n.$el.find("input[type='checkbox']").length===t.length&&sCH.userM.set("HasArchivedClasses",!1),n.afterUnarchive(e))}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",classes.length?(__p+='\r\n    <ul class="checklist">\r\n    ',_.each(classes,(function(e,t){__p+='\r\n        <li>\r\n            <div class="checkbox">\r\n                <input id="chkSelectClass'+(null==(__t=e.ClassId)?"":__t)+'" data-classid="'+(null==(__t=e.ClassId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\r\n                <label for="chkSelectClass'+(null==(__t=e.ClassId)?"":__t)+'"></label>\r\n            </div>\r\n            <div class="title">'+(null==(__t=cH.sanitize(e.Name))?"":__t)+"</div>\r\n        </li>\r\n    "})),__p+="        \r\n    </ul>\r\n"):__p+="\r\n    <p>You do not have any archived classes. To archive a class, please use the Archive option in the class settings pane.</p>\r\n",__p+="";return __p}},,,,,,,,,,,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(5),l=n(43),d=n(65),c=n(1398),u=n(1399),p=n(1400),h=n(1401),g=n(1414),f=n(1418),m=n(1419),v=n(14),b=n(153),C=n(1423),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.h1Ref=o.createRef(),t.state={role:sCH.userM.get("Role"),hasMasqueradePermission:sCH.userM.hasMasqueradePermission(),hasUploadOneTimeRosteringCSVPermission:sCH.userM.hasUploadOneTimeRosteringCSVPermission(),firstName:sCH.userM.get("FirstName"),avatar:sCH.userM.get("ImageUrl"),isMappedToTeacher:sCH.userM.get("IsMappedToTeacher"),actions:{isSearchEnabled:!1,searchCallback:null,searchPlaceholder:"Search by title, author, or publisher",searchCollapseOnSmallScreens:!1,selectors:null,actionButtons:null,customHeaderClass:""},searchAutocompleteData:null,isSearchOpen:!1,visiblePageHeading:null,pageTitle:null,subSectionTitle:null,subSectionObj:null,shouldTooltipOpen:!1,selectedObjsForSelectors:[]},t.handleToolTipOpen=function(){t.h1Ref.current.scrollWidth>t.h1Ref.current.offsetWidth&&!t.state.shouldTooltipOpen&&t.setState({shouldTooltipOpen:!0})},t.handleSearchOpen=function(e){return t.setState({isSearchOpen:e})},t.setSelectedObjsForSelectors=function(e){t.setState({selectedObjsForSelectors:e})},t.setSubSectionTitle=function(e){return t.setState({subSectionTitle:e},t.setHtmlPageTitle)},t.setSubSectionObj=function(e){return t.setState({subSectionObj:e})},t.setHtmlPageTitle=function(){var e=r.getProductName();t.state.pageTitle?e=t.state.pageTitle+" - "+e:t.state.visiblePageHeading&&(e=t.state.visiblePageHeading+" - "+e),t.state.subSectionTitle&&(e=t.state.subSectionTitle+" - "+e),document.title=e},t.setHeaderActions=function(e){var n={isSearchEnabled:e.isSearchEnabled,searchCallback:e.searchCallback,searchPlaceholder:e.searchPlaceholder||"Search by title, author, or publisher",searchCollapseOnSmallScreens:e.searchCollapseOnSmallScreens,selectors:e.selectors,actionButtons:e.actionButtons,customHeaderClass:e.customHeaderClass||""};t.setState({actions:n,searchAutocompleteData:e.searchAutocompleteData})},t.setSiteSection=function(e,n){var a=n?{selectedObjsForSelectors:[],subSectionTitle:null,actions:{}}:{},s={profile:"My Profile",studentData:"Reports",independentReading:v.CovidIRStatus?"Library":r.onDevice()?"IR":"Independent Reading",research:"My Research",adminTeachers:"Teacher Name",manage:"Manage Users",professionalLearning:o.createElement(S,null)};"professionalLearning"===e?t.setState(i({visiblePageHeading:s[e],pageTitle:"Professional Learning Center"},a)):"teacherCatalog"===e?t.setState(i({pageTitle:"Content",visiblePageHeading:null},a)):s[e]?t.setState(i({visiblePageHeading:s[e],pageTitle:s[e]},a)):(e=r.htmlDecode(r.sanitize(e)),t.setState(i({visiblePageHeading:e,pageTitle:e},a)))},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("setSiteSection",this.setSiteSection,this),Backbone.pubEv.on("setSubSectionTitle",this.setSubSectionTitle,this),Backbone.pubEv.on("setSubSectionObj",this.setSubSectionObj,this),Backbone.pubEv.on("setHeaderActions",this.setHeaderActions,this),this.setSiteSection(this.props.viewName,!0),r.rubberBandFix(),this.setHtmlPageTitle()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("setSiteSection",this.setSiteSection),Backbone.pubEv.off("setSubSectionTitle",this.setSubSectionTitle),Backbone.pubEv.off("setSubSectionObj",this.setSubSectionObj),Backbone.pubEv.off("setHeaderActions",this.setHeaderActions)},t.prototype.componentDidUpdate=function(e,t){this.state.pageTitle!==t.pageTitle&&this.setHtmlPageTitle(),r.adjustHeaderSpacing()},t.prototype.render=function(){var e,t=this,n=this.state,a=n.firstName,s=n.avatar,i=n.role,l=n.isMappedToTeacher,d=n.hasMasqueradePermission,c=n.hasUploadOneTimeRosteringCSVPermission,u=n.shouldTooltipOpen,p=n.selectedObjsForSelectors,h=n.visiblePageHeading,f=n.pageTitle,m=n.actions,v=n.searchAutocompleteData,b=n.subSectionTitle,C=n.subSectionObj,y=r.classNames(((e={mainHeader:!0,header:!0,mobile:!!r.onDevice()})[m.customHeaderClass||""]=!0,e));return o.createElement(o.Fragment,null,o.createElement("header",{id:"theHeader",className:y},o.createElement(_,{isMappedToTeacher:l,visiblePageHeading:h,pageTitle:f,actions:m,searchAutocompleteData:v,subSectionTitle:b,subSectionObj:C,selectedObjsForSelectors:p,shouldTooltipOpen:u,viewName:this.props.viewName,handleSearchOpen:this.handleSearchOpen,setSelectedObjsForSelectors:this.setSelectedObjsForSelectors,handleToolTipOpen:this.handleToolTipOpen,h1Ref:this.h1Ref,handleToolTipClose:function(){return t.setState({shouldTooltipOpen:!1})}}),o.createElement(g.default,{firstName:a,avatar:s,role:i,isMappedToTeacher:l,hasMasqueradePermission:d,hasUploadOneTimeRosteringCSVPermission:c})),o.createElement("div",{id:"theSubheader",className:"subheader"}))},t}(o.Component);t.default=y;var _=function(e){var t=e.isMappedToTeacher,n=e.visiblePageHeading,a=e.pageTitle,s=e.actions,i=e.subSectionTitle,l=e.subSectionObj,g=e.handleToolTipOpen,v=e.handleToolTipClose,b=e.h1Ref,y=e.shouldTooltipOpen,_=e.setSelectedObjsForSelectors,S=e.selectedObjsForSelectors,w=e.viewName,T=r.classNames({siteSection:!0,studentMode:t,visuallyHidden:!n});return o.createElement("div",{className:"left"},"teacherCatalog"===w&&o.createElement(o.Fragment,null,o.createElement("a",{className:"anonymousSiteLogo icon-logo",href:"https://www.activelylearn.com",target:"_blank"}),o.createElement(C.default,null)),l&&l.subjectName?o.createElement(f.default,{topicName:i,subjectName:l.subjectName}):o.createElement(o.Fragment,null,o.createElement(d.default,{title:a||"",onOpen:g,onClose:v,open:y},o.createElement("h1",{className:T,ref:b},n||a)),s.isSearchEnabled&&o.createElement(c.default,{actions:s,pageTitle:a,subSectionTitle:i,handleSearchOpen:e.handleSearchOpen,searchAutocompleteData:e.searchAutocompleteData})),i&&l&&"Content"===a&&o.createElement(m.default,{topicName:i,subjectName:l.subjectName,isUnitsPage:l.isUnitsPage}),s.selectors&&o.createElement(p.default,{selectors:s.selectors,setSelectedObjsForSelectors:_,selectedObjsForSelectors:S}),o.createElement("div",{className:"siteSectionActions",style:{display:s&&s.actionButtons?"flex":"none"}},s.actionButtons&&o.createElement(h.default,{actions:s,setSelectedObjsForSelectors:_,selectedObjsForSelectors:S})),"adminSchool"===w&&(sCH.userM.get("IsMasquerading")||sCH.userM.hasMasqueradePermission())&&o.createElement(u.default,null))},S=function(){return o.createElement(o.Fragment,null,o.createElement("div",{style:{float:"left",overflow:"hidden",textOverflow:"ellipsis"}},l.mobile?"Professional Learning":"Professional Learning Center"),o.createElement(b.default,{buttonClass:"icon-question-mark-inverse"},v.professionalLearningHelpText.heading,o.createElement("br",null),o.createElement("br",null),o.createElement("ul",null,v.professionalLearningHelpText.bulletPoints.map((function(e,t){return o.createElement("li",{key:t}," ",e)})))))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(691),l=n(8),d=n(72),c=n(43),u=n(14),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.searchInputRef=i.createRef(),t.state={searchQuery:"",searchAutocompleteResults:[],isSearchPerformed:!1,shouldCollapseSearch:!1,searchCollapsed:!1,searchAutocompleteData:t.props.searchAutocompleteData,isSearchAutocompleteSelected:!1,isInvalidInput:!1,isAutocompleteVisible:!1},t.handleSearchInputChange=function(e){var n=e.target.value;if(t.setState({searchQuery:n,isInvalidInput:!1}),document.querySelector(".alertContainer").innerHTML="",t.state.searchAutocompleteData)if(n.length>2){var a=new r(t.state.searchAutocompleteData.source,{tokenize:!0,matchAllTokens:!0,threshold:.3,location:0,distance:32,maxPatternLength:32,minMatchCharLength:4,keys:["TopicName","KeywordsForSearch","subjectName"]}).search(n.trim());t.setState({searchAutocompleteResults:a,isAutocompleteVisible:!0})}else t.setState({searchAutocompleteResults:[]});else t.performSearch(n),n||t.setState({isSearchPerformed:!1})},t.searchPerformed=function(e){if(t.setState({isSearchPerformed:!0,searchCollapsed:!e,searchQuery:e,searchAutocompleteResults:[]},(function(){t.searchInputRef.current&&t.searchInputRef.current.focus()})),t.state.searchQuery){var n=t.state.searchQuery.length>15?t.state.searchQuery.substring(0,15).trim()+"...":t.state.searchQuery;document.title="Search Results for "+n+" - "+t.props.pageTitle+" - Actively Learn"}},t.searchAutocompleteCallback=function(e){t.state.searchAutocompleteData.callback(e),t.searchPerformed(e.target.getAttribute("data-value")||""),t.setState({isSearchAutocompleteSelected:!0})},t.collapseSearch=function(){!t.state.searchQuery&&t.props.actions.searchCollapseOnSmallScreens&&o.shouldCollapseSearchForSmallScreen()?(t.setState({shouldCollapseSearch:!0,searchCollapsed:!0}),t.props.handleSearchOpen(!1)):(t.props.handleSearchOpen(!0),t.setState({shouldCollapseSearch:!1}))},t.delayedCollapseSearch=l.debounce(t.collapseSearch,100),t.expandSearch=function(){t.props.handleSearchOpen(!0),t.setState({searchCollapsed:!1,isInvalidInput:!1},(function(){return t.searchInputRef.current.focus()}))},t.search=function(e){if(e.preventDefault(),!t.state.searchAutocompleteData)return!1;var n=t.state.searchQuery.trim();$(".siteSectionSearch .icon-search").tooltip("destroy"),n.length<3?(0===n.length?o.bootstrap.alert({alert:"danger",message:"Enter text to search"}):o.bootstrap.alert({alert:"danger",message:"Enter at least 3 characters to search"}),t.setState({isInvalidInput:!0})):t.shouldPerformSearch(n)&&t.performSearch(n)},t.shouldPerformSearch=function(e){return-1===u.blockedCatalogSearchTerms.indexOf(e.toLocaleLowerCase())},t.performSearch=function(e){t.searchPerformed(e),t.props.actions.searchCallback(e,t);var n=t.props.subSectionTitle?t.props.subSectionTitle+" - ":"";e||(document.title=""+n+t.props.pageTitle+" - Actively Learn")},t.resetSearch=function(e){!e||void 0===e.shouldNavigate||e.shouldNavigate?t.performSearch(""):t.searchPerformed(""),t.state.isSearchAutocompleteSelected&&t.state.searchAutocompleteData&&t.state.searchAutocompleteData.clearSearch&&t.state.searchAutocompleteData.clearSearch(),t.setState({isSearchPerformed:!1,isSearchAutocompleteSelected:!1})},t.updateAutocompleteData=function(e){return t.setState({searchAutocompleteData:e,searchQuery:"",isSearchPerformed:!1})},t.handleSearchBlur=l.debounce((function(){t.setState({isAutocompleteVisible:!1,isInvalidInput:!1}),t.collapseSearch()}),300),t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("searchPerformed",this.searchPerformed,this),Backbone.pubEv.on("resetSearch",this.resetSearch,this),Backbone.pubEv.on("updateAutocompleteData",this.updateAutocompleteData,this),setTimeout(this.collapseSearch,100),c.mobile||window.addEventListener("resize",this.delayedCollapseSearch)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("searchPerformed",this.searchPerformed),Backbone.pubEv.off("resetSearch",this.resetSearch,this),Backbone.pubEv.off("updateAutocompleteData",this.updateAutocompleteData),this.delayedCollapseSearch.cancel(),this.handleSearchBlur.cancel(),window.removeEventListener("resize",this.delayedCollapseSearch)},t.prototype.componentWillReceiveProps=function(e){e.actions.isSearchEnabled&&e.actions.searchCollapseOnSmallScreens!==this.props.actions.searchCollapseOnSmallScreens&&setTimeout(this.collapseSearch,100)},t.prototype.render=function(){var e=this,t=this.props.actions,n=this.state,a=n.searchQuery,s=n.shouldCollapseSearch,o=n.searchCollapsed,r=n.searchAutocompleteResults,l=n.isSearchPerformed,c=n.searchAutocompleteData,u=n.isInvalidInput,p=n.isAutocompleteVisible,h=r.map((function(t){return"IR"===c.page?function(t){return i.createElement("li",{role:"option",className:"irAutocompleteItem","data-facets":'{"Genres":"'+t.subjectName+'"}',key:t.subjectName,onClick:e.searchAutocompleteCallback,"data-value":t.subjectName},t.subjectName)}(t):function(t){var n=t.TopicSlug,a="Social Studies"===t.SubjectName?"Social S.":t.SubjectName,s=t.TopicName;return i.createElement("li",{key:t.TopicId,onClick:e.searchAutocompleteCallback,role:"option"},i.createElement("a",{href:"#teacher/catalog/"+n,className:"main"},i.createElement("div",{className:"type"},a),i.createElement("div",{className:"title"},s)))}(t)})),g=c&&c.helperText?i.createElement("li",{className:"helperText"},c.helperText):"";return i.createElement("div",{className:"siteSectionSearch"},i.createElement("form",{onSubmit:this.search,onFocus:function(){return e.setState({isAutocompleteVisible:!0})}},s&&o?i.createElement("input",{type:"text",value:a,disabled:!0}):i.createElement("input",{type:"text",className:u?"flash":"",placeholder:t.searchPlaceholder,"aria-label":t.searchPlaceholder,value:a,onChange:this.handleSearchInputChange,ref:this.searchInputRef,onBlur:this.handleSearchBlur,onInvalid:this.search,"aria-owns":"searchAutocomplete",required:!0})),!l&&i.createElement(d.default,{buttonClass:"icon-search",buttonTitle:"Search",type:"submit",onClick:o?this.expandSearch:this.search}),l&&i.createElement(d.default,{buttonClass:"icon-cancel",onClick:this.resetSearch,type:"reset",buttonTitle:"Cancel"}),r.length>0&&p&&i.createElement("ul",{id:"searchAutocomplete",role:"listbox"},g,h))},t}(i.Component);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(363),i=n(72),o=n(13).withStyles;t.default=o((function(){return{container:{backgroundColor:"hsl(0,0%,100%)",border:"1px solid rgba(0,0,0,0.2)",borderRadius:4,marginTop:5,height:36},selectContainer:{verticalAlign:"top","&:before":{border:"none !important"},"&:after":{border:"none !important"}},select:{backgroundColor:"#e6e6e6",paddingLeft:6,height:23,lineHeight:"25px",borderRadius:"4px 0 0 4px"},searchSchool:{backgroundColor:"hsl(0,0%,100%)",border:"none",padding:"0 7px",verticalAlign:"text-bottom","& button:before":{fontSize:22}},textFieldSchool:{border:"0 !important",height:24,marginLeft:4,width:"180px !important",paddingRight:"0 !important"}}}))((function(e){var t=e.classes,n=a.useState({idType:"schoolId",id:0}),o=n[0],r=n[1];a.useEffect((function(){return Backbone.pubEv.on("setTeacherActivityReportSearchData",(function(e){r(e)})),function(){Backbone.pubEv.off("setTeacherActivityReportSearchData")}}));return a.createElement("form",{onSubmit:function(e){Backbone.pubEv.trigger("TeacherActivityMasqueradeSchoolSearched",o),e.preventDefault()},className:"searchSchool "+t.container},a.createElement(s.Select,{native:!0,className:t.selectContainer,classes:{select:t.select},variant:"filled",value:o.idType,onChange:function(e){return r({idType:e.target.value,id:0})}},a.createElement("option",{value:"schoolId"},"SchoolId"),a.createElement("option",{value:"districtId"},"DistrictId")),a.createElement(s.Input,{classes:{root:t.searchSchool,input:t.textFieldSchool},id:"adornment-schoolId",onChange:function(e){return r({idType:o.idType,id:parseInt(e.target.value,10)})},value:o.id||"",placeholder:"Paste id and press enter",disableUnderline:!0,endAdornment:a.createElement(s.InputAdornment,{position:"end"},a.createElement(i.default,{buttonClass:"icon-search",buttonTitle:"Search","aria-label":"Look data for selected school/district",type:"submit"}))}))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(5),i=n(234),o={fontSize:12,marginLeft:10};t.default=function(e){var t=e.selectedObjsForSelectors,n=e.setSelectedObjsForSelectors;a.useEffect((function(){r()}),[e.selectors]),a.useEffect((function(){for(var n=0;n<t.length;n++)e.selectors[n].callback(t[n].value)}),[e.selectedObjsForSelectors]);var r=function(){var t=[];e.selectors.forEach((function(e){var n=e.data.find((function(t){return t.value===e.preSelectedValue}));t.push(n)})),n(t)},l=e.selectors.map((function(r,l){if(r.data.length>(r.minShowOptions||0))return a.createElement(i.default,{value:t[l],key:r.type,onChange:function(a){return function(a,s){var i=[];e.selectors.forEach((function(e,n){n===s?i.push(a):i.push(t[n])})),n(i)}(a,l)},suggestions:r.data.map((function(e){return function(e){var t=e.dataContent?a.createElement(a.Fragment,null,s.htmlDecode(s.sanitize(e.label))," ",a.createElement("span",{style:o},s.sanitize(e.dataContent))):s.htmlDecode(s.sanitize(e.label));return{value:"string"==typeof e.value?s.sanitize(e.value):e.value,label:s.htmlDecode(s.sanitize(e.label)),component:t}}(e)})),inputId:"siteSectionSelector"+l,inputLabel:"Type to search & select an item",hasCustomComponent:!0})}));return a.createElement("div",{className:"siteSectionSelector pull-left"},l)}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(1402),o=n(1404),r=n(1411),l=n(48),d=n(1412),c=n(43);t.default=function(e){var t=e.actions,n=e.setSelectedObjsForSelectors,l=e.selectedObjsForSelectors,d=t.actionButtons,c=d.type,p=d.props;return s.createElement(s.Fragment,null,"StudentClass"===c&&s.createElement(i.default,a({},p)),"TeacherClass"===c&&s.createElement(o.default,a({},p)),"Standards"===c&&s.createElement(r.default,a({},p,{actions:t},{setSelectedObjsForSelectors:n,selectedObjsForSelectors:l})),"IR"===c&&s.createElement(u,null))};var u=function(e){return c.mobile?s.createElement("button",{className:"btn-tab icon-filter",onClick:function(){$("#facets, #facets + .results").toggle()},title:"Filter by grade range"}):"student"!==sCH.userM.get("Role")&&s.createElement("button",{onClick:function(){sCH.userM.isOnPrimePlan()?new Backbone.BootstrapModal({title:"Filter by grade range",content:new d.default,okText:"Save",cssClass:"classSettings"}):l.showBuyTeacherPopup({title:"IR Catalog settings",content:"Filtering the IR Catalog based on individual student's grade ranges is only available on the Prime plan."})},className:"btn-tab icon-gear"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(751),s=n(10),i=n(0),o=n(155);t.default=function(e){return i.createElement(o.default,{dropdownClass:"classSettingsDropdown",buttonClass:"btnClassMenu icon-gear",buttonId:"btnClassMenu",menuCustomClass:"dropdown-menu-right",buttonTitle:e.showUnenrollBtn?"Unenroll or hide":"Hide"},e.showUnenrollBtn&&i.createElement(o.DropdownItem,{className:"btnUnEnroll",onClick:function(){var t=sCH.classesC.getModelByClassId(e.classId);new Backbone.BootstrapModal({title:"Unenroll from "+t.get("Name"),content:new a.default({classM:t}),allowCancel:!1,okText:"Unenroll",cssClass:"deleteClass"}).open(),Backbone.tracking.trackGAEvent("student","unenrollClass:start")},text:"Unenroll"}),i.createElement(o.DropdownItem,{className:"btnHide",onClick:function(){var t=sCH.classesC.getModelByClassId(e.classId);new Backbone.BootstrapModal({title:"Hide "+t.get("Name")+"?",content:"Once a class is hidden it will not show in the list of classes in the main menu. If you want to unhide the class later, you can do so from the unhide button in the left menu.",okText:"Hide",cssClass:"hideClass"}).open((function(){s.ToggleClassHiddenState({classIds:[e.classId],shouldHideClass:!0},(function(){Backbone.router.navigate("student/classes",{trigger:!1}),window.location.reload()}))}))},text:"Hide"}))}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<p>\n    Are you sure you want to unenroll yourself ("+(null==(__t=userName)?"":__t)+") from this class ("+(null==(__t=className)?"":__t)+')? \n    You will no longer have access to the assignments and your work.\n</p>\n<p>Type "UNENROLL" below to confirm.</p>\n<input class="txtUnenrollCaptcha" />';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(22),l=n(1405),d=n(48),c=n(493),u=n(1409),p=n(10),h=n(753),g=n(155),f=n(24),m=n(20),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={classType:o.getUserOrClassType(t.props.classM),teachers:t.props.classM?t.props.classM.get("Teachers"):[],isDuplicateClassAllowed:"native"===o.getUserOrClassType(t.props.classM)&&t.props.isTeacherOwner},t.openedClassMenu=function(e){if($(".mainHeader").find(".classSettingsDropdown ul").is(":visible")){var t=document.querySelector(".classSettingsDropdown .dropdown-menu").getBoundingClientRect(),n=document.getElementById("content").getBoundingClientRect();t.left<n.left&&$(".classSettingsDropdown .dropdown-menu").removeClass("dropdown-menu-right"),o.intercom("trackEvent","opened-class-gear")}},t.manageCoteaching=function(){!m.default.isMath&&sCH.userM.isOnFreeOrPersonalPlan()?d.showBuyTeacherPopup({title:"Co-Teaching",content:"Co-teaching allows multiple teachers to access this class, manage the roster, \n          assign texts, grade, and access reports."}):f.showModal(i.createElement(l.default,{title:"Co-Teachers",okText:"Invite",allowCancel:!1,cssClass:"coteachers",classId:t.props.classId,callback:function(e){e&&(0===sCH.classesC.length?o.redirectUserByHash("teacher/catalog"):o.redirectUserByHash("teacher/classes"))}}))},t.showClassSettings=function(e){var n=t.props.classM,a="",s=e.target.getAttribute("data-sub");switch(s){case"name":a="Edit class details";break;case"reading":a="Class reading settings";break;case"gradebook":a="Grading settings"}"name"!==s&&o.intercom("trackEvent","class-settings-"+s),new Backbone.BootstrapModal({title:a,okText:"Save",cancelText:"Cancel",cssClass:"classSettings",allowCancel:!0,content:new c.default({classM:n,submenu:s})}).open()},t.duplicateClass=function(){var e=t.props.classM;new Backbone.BootstrapModal({title:"Duplicate class",content:new u.default({gradeLevel:e.get("GradeLevel"),name:e.get("Name"),classId:e.get("ClassId"),callback:function(t){window.setTimeout((function(){o.bootstrap.alert({message:"Class was successfully duplicated from "+e.get("Name")+"."})}),100),o.redirectUserByHash(o.getClassUrl(t,"assess"))}}),cssClass:"modal-al-add-class",okText:"Duplicate"}).open()},t.editSmallGroupSettings=function(){if(sCH.userM.isOnFreePlan())d.showBuyTeacherPopup({title:"Small groups settings",content:alcfg.infoText.classes.smallGroups});else{$("body").append('<div id="smallGroups"></div>');var e=t;p.GetSmallGroup({classId:t.props.classId},(function(t){r.mountReactComponent(h.default,$("#smallGroups")[0],{classId:e.props.classId,studentList:t.studentGroupMaps,isGroupEnabled:t.isSmallGroupsEnabled,existingGroups:t.classGroups,onUpdate:function(){},onClose:function(){r.unmountReactComponent($("#smallGroups")[0]),$("#smallGroups").remove()}})}))}},t.archiveClass=function(){var e=t,n=t.props.classId;new Backbone.BootstrapModal({title:"Archive this class?",content:alcfg.confirmsText.classArchive,cssClass:"modal-al-archive",okText:"Archive"}).open((function(){var t=this;t.preventClose(),t.disableOk("Archiving..."),sCH.classesC.archiveClass(n,(function(){sCH.userM.set("HasArchivedClasses",!0),Backbone.tracking.trackGAEvent("teacher","archiveClass:end"),sCH.clearCollection("allStudentsC"),e.removeClassAndRedirect(n,t),o.bootstrap.alert({message:alcfg.alertsText.classArchived})}))})),Backbone.tracking.trackGAEvent("teacher","archiveClass:start")},t.getDeleteClassPopupMessage=function(e){return t.props.isTeacherOwner?e>1?alcfg.confirmsText.classDeleteCoteaching:alcfg.confirmsText.classDelete:""},t.removeClassAndRedirect=function(e,t){sCH.classesC.getModelByClassId(e).destroy(),t.close(),sCH.classesC.length?o.redirectUserByHash(o.getClassUrl(sCH.classesC.first().get("ClassId"),"assess")):o.redirectUserByHash("teacher/catalog")},t.deleteClass=function(){var e=t,n=t.props,a=n.classM,s=n.classId;new Backbone.BootstrapModal({title:t.props.isTeacherOwner?"Delete this class?":"Leave this class?",content:e.getDeleteClassPopupMessage(a.get("Teachers").length),cssClass:"modal-al-delete-class",okText:t.props.isTeacherOwner?"Delete":"Leave"}).open((function(){var t=this;t.preventClose(),t.disableOk("Deleting..."),e.props.isTeacherOwner?sCH.classesC.deleteClass(s,(function(){e.removeClassAndRedirect(s,t)})):p.RemoveCoteacher({classId:s,userId:sCH.userM.get("UserId")},(function(){e.removeClassAndRedirect(s,t)}))})),Backbone.tracking.trackGAEvent("teacher","deleteClass:start")},t}return s(t,e),t.prototype.render=function(){var e=this.state,t=e.classType,n=e.isDuplicateClassAllowed,a=this.props,s=a.isTeacherOwner,o=a.classM;return i.createElement(g.default,{dropdownClass:"classSettingsDropdown",buttonClass:"btnClassMenu icon-gear",buttonId:"btnClassMenu",buttonTitle:"Settings, co-teaching, and more",menuCustomClass:"dropdown-menu-right",onClick:this.openedClassMenu},("native"===t||"clever"===o.get("Source"))&&i.createElement(g.DropdownItem,{className:"btnClassSettings",onClick:this.showClassSettings,text:"Edit class details","data-sub":"name"}),i.createElement(g.DropdownItem,{className:"btnClassSettings hideForMath",onClick:this.showClassSettings,text:"Reading settings","data-sub":"reading"}),i.createElement(g.DropdownItem,{className:"btnSmallGroupSettings hideForMath","data-sub":"smallgroup",onClick:this.editSmallGroupSettings,text:i.createElement(i.Fragment,null,"Small group settings",i.createElement("span",{className:"primeFeature icon-premium-lock"}))}),i.createElement(g.DropdownItem,{className:"btnClassSettings hideForMath",onClick:this.showClassSettings,text:"Grading settings","data-sub":"gradebook"}),(!window.isIOSApp||window.isIOSApp&&sCH.userM.isOnPrimePlan())&&i.createElement(g.DropdownItem,{className:"btnCoteaching",onClick:this.manageCoteaching,text:i.createElement(i.Fragment,null,"Co-teaching",i.createElement("span",{className:"primeFeature icon-premium-lock hideForMath"}))}),i.createElement("li",{role:"separator",className:"divider"}),n&&i.createElement(g.DropdownItem,{className:"btnDuplicateClass hideForMath",onClick:this.duplicateClass,text:"Duplicate class"}),i.createElement(g.DropdownItem,{className:"btnArchiveClass",onClick:this.archiveClass,text:"Archive class"}),i.createElement(g.DropdownItem,{className:"btnDeleteClass",onClick:this.deleteClass,text:(s?"Delete":"Leave")+" class"}))},t}(i.Component);t.default=v},function(e,t,n){"use strict";var a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(24),o=n(10),r=n(5),l=n(8),d=n(492);t.default=function(e){var t=e.title,n=e.callback,c=e.okText,u=e.classId,p=e.cssClass,h=void 0===p?"":p,g=e.allowCancel,f=void 0===g||g,m=s.useState({current:[],potential:[]}),v=m[0],b=m[1],C=s.useState([]),y=C[0],_=C[1],S=s.useState(!1),w=S[0],T=S[1],I=v.current.map((function(e){return e.UserId})),x=v.potential.filter((function(e){return-1===I.indexOf(e.UserId)}));function k(e){return e.UserId!==e.ClassOwnerUserId}return s.useEffect((function(){o.GetCoteachData({classId:u},(function(e){b(e),T(!0)}))}),[]),w&&s.createElement(d.default,{modalTitle:t,okText:c,disabledOkText:"Inviting...",allowCancel:f,cssClass:h,okCallback:function(e){if(y.length>0){var t=sCH.classesC.getModelByClassId(u).get("Name");o.AddCoteachers({classId:u,userIds:y,className:t},(function(){r.bootstrap.alert({message:"Co-authors added will be notified via email."}),n();var e=x.filter((function(e){return-1!==y.indexOf(e.UserId)})),t=sCH.classesC.filter({ClassId:u})[0];t.set("Teachers",t.get("Teachers").concat(e)),r.intercom("trackEvent","added-Coteacher"),r.bootstrap.alert({message:"Co-teachers added!"}),i.hideModals()}))}},header:"Co-teaching allows multiple teachers to grade assignments and view reports for this class.",users:x,currentAuthors:v.current,removeCoauthor:function(e){var t=$(e.target).data("userid"),r=t===sCH.userM.get("UserId"),d=r?"Leave class":"Remove teacher";i.showModal(s.createElement(i.default,{title:d,okText:d,okCallback:function(){return function(e,t){o.RemoveCoteacher({classId:u,userId:e},(function(){i.hideModals();var s=sCH.classesC.filter({ClassId:u})[0];t?(sCH.classesC.remove(s),i.hideModals()):(s.set("Teachers",l.reject(s.get("Teachers"),(function(t){return t.UserId==e}))),b({potential:a(v.potential),current:v.current.filter((function(t){return t.UserId!==e}))})),n(t)}))}(t,r)}},"Are you sure you want to ",r?"leave this class?":"remove this teacher from this class?"))},selectedUserIds:y,noSelectionMsg:"Please select 1 or more colleagues to co-teach this class with!",setSelectedUserIds:_,hasPermissionToRemoveCoAuthor:k,isOwner:function(e){return!k(e)},noUserText:"Currently, no other teachers at your school are on the Prime plan. Get a coworker to create an account and then add them as a co-teacher here.",currentAuthorsText:"Current teachers"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5);t.default=Backbone.View.extend({template:n(1407),initialize:function(e){this.gradeLabels=e.gradeLabels,this.parent=e.parentPopup,this.on("ok",this.updateGradeLabels)},render:function(){this.$el.html(this.template({gradeLabels:this.gradeLabels}))},updateGradeLabels:function(e){var t=this,n=[];if(a.each(this.$el.find(".gradesName"),(function(e){var a=$(e).val();a||n.push($(e)),t.gradeLabels[$(e).data("label")]=a})),n.length)return s.checkRequiredFields(n),e.preventClose(),void s.bootstrap.alert({message:"Labels cannot be blank.",alert:"danger"});t.parent.updateGradeLabels(t.gradeLabels)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p class="info">Note: your custom labels will not be saved until you press Save in the Grading settings popup.</p>\n\n',_.each(gradeLabels,(function(e,t){__p+='\n    <label class="capitalize" for="'+(null==(__t="grade"+t)?"":__t)+'">'+(null==(__t=cH.capitalizeString(t))?"":__t)+"</label>\n    ",__p+="zero"==t?'\n        <input placeholder="Label" value="'+(null==(__t=e)?"":__t)+'" class="gradesName" maxlength="12" data-label="'+(null==(__t=t)?"":__t)+'" id="'+(null==(__t="grade"+t)?"":__t)+'"/>\n    ':'\n        <input placeholder="Label" value="'+(null==(__t=e)?"":__t)+'" class="gradesName" maxlength="20" data-label="'+(null==(__t=t)?"":__t)+'" id="'+(null==(__t="grade"+t)?"":__t)+'" />\n    ',__p+="\n"})),__p+="\n";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="section namesetting">\r\n    <input placeholder="Class name (max length 40)" value="'+(null==(__t=cH.sanitize(c.Name))?"":__t)+'" class="txtName" maxlength="40" />\r\n    ',"native"===classType&&(__p+=""+(null==(__t=gradelevels)?"":__t)),__p+="\r\n    ",sCH.userM.get("SchoolInfo").length>1&&(__p+="\r\n        <select class=\"ddlSchools\" title='Select a school...'>\r\n            ",_.each(sCH.userM.get("SchoolInfo"),(function(e){var t=c.SchoolId===e.SchoolId;__p+='\r\n                <option value="'+(null==(__t=e.SchoolId)?"":__t)+'" ',print(t?"selected":""),__p+=">"+(null==(__t=cH.sanitize(e.Name))?"":__t)+"</option>\r\n            "})),__p+="\r\n        </select>\r\n    "),__p+='\r\n</div>\r\n\r\n<div class="section readingsetting '+(null==(__t=assignmentMode?"assignmentMode":"")?"":__t)+'">\r\n    ',assignmentMode?__p+='\r\n    <div>\r\n        <label>\r\n            <input type="radio" value="no" class="assignmentSettings" name="assignmentSettings" />\r\n            Use class reading settings\r\n        </label>\r\n    </div>\r\n    <div>\r\n        <label>\r\n            <input type="radio" value="yes" class="assignmentSettings" name="assignmentSettings" '+(null==(__t=isQuiz?'checked="true"':"")?"":__t)+" />\r\n            Customize reading settings for this "+(null==(__t=isQuiz?"quiz":"assignment")?"":__t)+"\r\n        </label>\r\n    </div>\r\n    ":__p+="\r\n        <p>These settings affect the student reading experience for all class "+(null==(__t=isQuiz?"quiz":"assignments")?"":__t)+" that do not have individually customized reading settings.</p>\r\n    ",__p+='\r\n\r\n    <div class="groupedSubsections">\r\n        <div class="subsection hideForMath">\r\n            <div class="sectionTitle">Social</div>\r\n            <div class="label">\r\n                <input id="chkAllowStudentSharedNotes" type="checkbox" class="regular-checkbox" />\r\n                <label for="chkAllowStudentSharedNotes"></label>\r\n                <p>See classmates shared notes</p>\r\n            </div>\r\n            <div class="label">\r\n                <input id="chkViewPeerResponses" type="checkbox" class="chkViewPeerResponses regular-checkbox" />\r\n                <label for="chkViewPeerResponses"></label>\r\n                <p>See classmates responses after answering questions</p>\r\n            </div>\r\n            <div class="viewPeerResponseSelectContainer">\r\n                <select class="ddlCCViewPeerResponses" '+(null==(__t=sCH.userM.isOnFreePlan()?"disabled":"")?"":__t)+'>\r\n                    <option value=\'all\'>All</option>\r\n                    <option value=\'onlyproficientandadvanced\'>Only Proficient and Advanced</option>\r\n                    <option value=\'onlyadvanced\'>Only Advanced</option>\r\n                </select>\r\n                <div class="clearBoth"></div>\r\n            </div>\r\n            <div class="label lblNamedPeerResponses">\r\n                <input id="chkNamedPeerResponses" type="checkbox" class="chkNamedPeerResponses regular-checkbox" />\r\n                <label for="chkNamedPeerResponses"></label>\r\n                <p>See classmates names with their responses</p>\r\n            </div>\r\n            <div class="label lblLikePeerResponses">\r\n                <input id="chkAllowLikingPeerResponses" type="checkbox" class="chkAllowLikingPeerResponses regular-checkbox" />\r\n                <label for="chkAllowLikingPeerResponses"></label>\r\n                <p>Allow students to like classmates\' responses</p>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="subsection hideForMath">\r\n            <div class="sectionTitle">Questions and responses</div>\r\n            <div class="label">\r\n                <input id="chkQuestionGates" type="checkbox" class="chkQuestionGates regular-checkbox" />\r\n                <label for="chkQuestionGates"></label>\r\n                <p>Questions require a response to continue reading</p>\r\n            </div>\r\n            <div class="label lblMinimizeQuestions indented">\r\n                <input id="chkMinimizeQuestions" type="checkbox" class="chkMinimizeQuestions regular-checkbox" />\r\n                <label for="chkMinimizeQuestions"></label>\r\n                <p>Minimize questions (ex. for a first read activity)</p>\r\n            </div>\r\n            <div class="label enableForQuiz">\r\n                <input id="chkAllowStudentsMCAnswer" type="checkbox" class="regular-checkbox" />\r\n                <label for="chkAllowStudentsMCAnswer"></label>\r\n                <p>See correct multiple choice answer after responding</p>\r\n            </div>\r\n            <div class="label enableForQuiz">\r\n                <input id="chkDisAllowAnswerEditing" type="checkbox" class="regular-checkbox" />\r\n                <label for="chkDisAllowAnswerEditing"></label>\r\n                <p>\r\n                    Responses are locked until you allow revisions\r\n                    <div class="subtitle">\r\n                        When off, students can revise their response until graded. \r\n                        ',isQuiz||(__p+="\r\n                            To prevent cheating, you may also want to turn off 'See classmates responses after answering questions' above.\r\n                        "),__p+='\r\n                    </div>\r\n                </p>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="subsection">\r\n            <div class="sectionTitle hideForMath">Other</div>\r\n            <div class="label enableForQuiz hideForMath">\r\n                <input id="chkNotifications" type="checkbox" class="chkNotifications regular-checkbox" />\r\n                <label for="chkNotifications"></label>\r\n                <p>Enable notifications</p>\r\n            </div>\r\n            <div class="label enableForQuiz">\r\n                <input id="chkAllowTranslation" type="checkbox" class="chkAllowTranslation regular-checkbox" />\r\n                <label for="chkAllowTranslation"></label>\r\n                <p>Enable language translation</p>\r\n            </div>\r\n            <div class="label enableForQuiz">\r\n                <input id="chkAllowDictionary" type="checkbox" class="chkAllowDictionary regular-checkbox" />\r\n                <label for="chkAllowDictionary"></label>\r\n                <p>Enable word lookups</p>\r\n            </div>\r\n            <div class="label enableForQuiz">\r\n                <input id="chkAllowTextToSpeech" type="checkbox" class="chkAllowTextToSpeech regular-checkbox" />\r\n                <label for="chkAllowTextToSpeech"></label>\r\n                <p>Enable text to speech</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="breaker"></div>\r\n\r\n    <div class="hideForMath">\r\n        ',isTeacherOwner&&(__p+='\r\n            <input id="chkCopyReadingSettingsAllClasses" type="checkbox" class="regular-checkbox" />\r\n            <label for="chkCopyReadingSettingsAllClasses"></label>\r\n            ',assignmentMode?__p+="\r\n                <span>Apply settings to this "+(null==(__t=isQuiz?"quiz":"assignment")?"":__t)+" in ALL classes where you teach it</span>\r\n            ":__p+="\r\n                <span>Apply these settings to all classes</span>\r\n        "),__p+="\r\n\r\n        ",!isQuiz&&assignmentMode||(__p+='\r\n            <p class="info">Note: Quizzes have no social features and students do not see any answers after responding</p>\r\n        '),__p+='\r\n    </div>\r\n</div>\r\n\r\n<div class="section gradebooksetting">\r\n    <div class="subsection">\r\n        <div class="sectionTitle">\r\n            Labels for short answer grades\r\n        </div>\r\n\r\n        <select class="ddlCCgradeLabels gradeLabels">\r\n            <option value="-1">Zero &nbsp;&middot;&nbsp; Incomplete &nbsp;&middot;&nbsp; Basic &nbsp;&middot;&nbsp; Proficient &nbsp;&middot;&nbsp; Advanced</option>\r\n            <option value="1">Zero &nbsp;&middot;&nbsp; Emerging &nbsp;&middot;&nbsp; Developing &nbsp;&middot;&nbsp; Proficient  &nbsp;&middot;&nbsp; Advanced</option>\r\n            <option value="2">Zero &nbsp;&middot;&nbsp; Below &nbsp;&middot;&nbsp; Approaching &nbsp;&middot;&nbsp; Meets &nbsp;&middot;&nbsp; Exceeds</option>\r\n            <option value="3">F &nbsp;&middot;&nbsp; D &nbsp;&middot;&nbsp; C &nbsp;&middot;&nbsp; B &nbsp;&middot;&nbsp; A</option>\r\n            <option value="4">0 &nbsp;&middot;&nbsp; 1 &nbsp;&middot;&nbsp; 2 &nbsp;&middot;&nbsp; 3 &nbsp;&middot;&nbsp; 4</option>\r\n            <option value="custom" data-content="<span class=\'btn-box callout\'>Add your own</span>">\r\n                Custom grading scale\r\n            </option>\r\n        </select>\r\n    </div>\r\n\r\n    <div class="subsection">\r\n        <div class="sectionTitle">\r\n            Points for short answer responses\r\n        </div>\r\n\r\n        <table class="shortAnswer" data-question="shortAnswer">\r\n            <tbody>\r\n                <tr class="advanced" data-grade="advanced">\r\n                    <td class="label">Advanced</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"><input title="Points possible for a short answer." type="number" min="1" step="1" pattern="\\d+" /></td>\r\n                </tr>\r\n                <tr class="proficient" data-grade="proficient">\r\n                    <td class="label">Proficient</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"></td>\r\n                </tr>\r\n                <tr class="basic" data-grade="basic">\r\n                    <td class="label">Basic</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"></td>\r\n                </tr>\r\n                <tr class="incomplete" data-grade="incomplete">\r\n                    <td class="label">Incomplete</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"></td>\r\n                </tr>\r\n                <tr class="zero" data-grade="zero">\r\n                    <td class="label">Zero</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <div class="subsection">\r\n        <div class="sectionTitle">\r\n            Points for multiple choice responses\r\n        </div>\r\n        <table class="multipleChoice" data-question="multipleChoice">\r\n            <tbody>\r\n                <tr class="correct" data-grade="correct">\r\n                    <td class="label">Correct</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"><input title="Points possible for a multiple choice answer." type="number" min="1" step="1" pattern="\\d+" /></td>\r\n                </tr>\r\n                <tr class="incorrect" data-grade="incorrect">\r\n                    <td class="label">Incorrect</td>\r\n                    <td class="numerator"><input type="number" min="0" step="1" pattern="\\d+" /></td>\r\n                    <td class="slash">/</td>\r\n                    <td class="denominator"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <div class="subsection">\r\n        <div class="sectionTitle">\r\n            Other\r\n        </div>\r\n        <div class="label">\r\n            <input id="chkAllowGradingTagging" type="checkbox" class="regular-checkbox" />\r\n            <label for="chkAllowGradingTagging"></label>\r\n            <p>Enable tagging of student responses</p>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="breaker"></div>\r\n\r\n    ',isTeacherOwner&&!triggeredFromReader&&(__p+='\r\n    <div class="hideForMath">\r\n        <input id="chkCopyGradebookSettingsAllClasses" type="checkbox" class="regular-checkbox" />\r\n        <label for="chkCopyGradebookSettingsAllClasses"></label>\r\n        <span>Apply these settings to all your classes</span>\r\n    </div>\r\n    '),__p+='\r\n</div>\r\n\r\n<div class="clearBoth"></div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({template:n(1410),gltemplate:n(752),initialize:function(e){this.on("ok",this.duplicateClass),this.isHigherEd=sCH.userM.get("IsHigherEd"),this.obj=e},render:function(){var e=this.gltemplate({info:{isHigherEd:this.isHigherEd,grouped:!1}});return this.$el.html(this.template({gradelevels:e,isGoogleUser:!1,isEdmodoUser:!1,isCleverUser:!1,isCanvasUser:!1,isBrightspaceUser:!1,isSchoologyUser:!1,isAchieve3KUser:!1,isOneRosterUser:!1,isDuplicating:!0,isHigherEd:this.isHigherEd,originClassName:this.obj.name})),this.$el.find(".ddlGradeLevels").val(this.obj.gradeLevel),this.$el.find("select").selectpicker(),this},duplicateClass:function(e){e.preventClose();var t=this.$el.find(".txtName"),n=this.$el.find(".ddlGradeLevels"),s=this.$el.find(".ddlSchools");if(!(a.checkRequiredFields([t,n,s])>0)){var i={classId:this.obj.classId,name:t.val(),gradeLevel:this.isHigherEd?"":n.val()};s.length>0&&(i.schoolId=parseInt(s.val()));var o=this;e.disableOk("Duplcating..."),sCH.classesC.duplicateClass(i,(function(t){e.close(),o.obj.callback&&o.obj.callback(t)}))}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",isGoogleUser&&(__p+='\r\n    <a class="btnGoogleCourses btn-box large"><img src="https://www.gstatic.com/classroom/logo_square_48.svg" />Import'+(null==(__t=bowser.mobile?"":" courses from Google Classroom")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n",isEdmodoUser&&(__p+='\r\n    <a class="btnEdmodoGroups btn-box large"><img src="/img/Edmodo.png" />Import'+(null==(__t=bowser.mobile?"":" groups from Edmodo")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n",isCleverUser&&(__p+='\r\n    <a class="btnCleverSections btn-box large"><img src="/img/Clever.png" />Import'+(null==(__t=bowser.mobile?"":" sections from Clever")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n",isCanvasUser&&(__p+='\r\n    <a class="btnCanvasSections btn-box large"><img src="/img/Canvas.png" />Import'+(null==(__t=bowser.mobile?"":" courses from Canvas")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n",isBrightspaceUser&&(__p+='\r\n    <a class="btnBrightspaceSections btn-box large"><img src="/img/Canvas.png" />Import'+(null==(__t=bowser.mobile?"":" courses from Brightspace")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n",isOneRosterUser&&(__p+='\r\n    <a class="btnOneRosterSections btn-box large">Import'+(null==(__t=bowser.mobile?"":" classes from your district's SIS")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n",isSchoologyUser&&(__p+='\r\n    <a class="btnSchoologySections btn-box large"><img src="/img/Schoology.png" />Import'+(null==(__t=bowser.mobile?"":" courses from Schoology")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n\r\n",isAchieve3KUser&&(__p+='\r\n    <a class="btnAchieve3K btn-box large" data-source=\'achieve3k\'><img src="/img/Achieve3000Logo128.png" />Import'+(null==(__t=bowser.mobile?"":" courses from Achieve3000")?"":__t)+'</a>\r\n    <div class="divider">OR</div>\r\n'),__p+="\r\n\r\n<p>\r\n    "+(null==(__t=isDuplicating?"Duplicate <b>"+originClassName+"</b> by entering the following info below:":"To start a new class, enter the info below:")?"":__t)+'\r\n</p>\r\n<input class="txtName" placeholder="Class name (Max-length 40)" maxlength="40"/>\r\n'+(null==(__t=gradelevels)?"":__t)+"\r\n\r\n",sCH.userM.get("SchoolInfo").length>1&&(__p+="\r\n    <select class=\"ddlSchools\" title='Select a school...'>\r\n        ",_.each(sCH.userM.get("SchoolInfo"),(function(e){__p+='\r\n            <option value="'+(null==(__t=e.SchoolId)?"":__t)+'">'+(null==(__t=cH.sanitize(e.Name))?"":__t)+"</option>\r\n        "})),__p+="\r\n    </select>\r\n"),__p+="\r\n\r\n",isCleverUser?__p+='\r\n    <p class="info">Your students will need a code to join this class, because it is not being sync\'ed from your SIS.</p>\r\n':isEdmodoUser&&(__p+='\r\n    <p class="info">Your students will need a code to join this class, because it is not being sync\'ed from Edmodo.</p>\r\n'),__p+="";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(8),l=n(5),d=n(10),c=n(155),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addStandardSet=function(){var e=t,n=new Backbone.BootstrapModal({content:t.generateAddEditStandardSetHtml(),cssClass:"modal-al-add-standard-set",title:"Add new standard set",okText:"Add"}).open((function(){var t=n.$el.find("#txtTitle"),a=n.$el.find("#txtShortTitle"),s=n.$el.find(".ddlSchools"),o=l.checkRequiredFields([t,a,s]),r=sCH.userM.getPrimarySchool();if(n.preventClose(),0===o){n.disableOk("Adding...");var c={title:t.val().trim(),shortTitle:a.val().trim(),state:r.State};l.attachSchoolIdOrDistrictIdByRole(c,n),d.AddStandardSet(c,(function(t){var a=e.props,s=a.actions,o=a.selectedObjsForSelectors,r=a.setSelectedObjsForSelectors;a.scope.data.push({StandardSetId:t,Title:c.title,ShortTitle:c.shortTitle,IsPublished:!1,IsDefault:!1,SchoolId:c.schoolId});var d={dataContent:e.getBuildingName(c),value:t,label:c.title};s.selectors[0].data.push(d),o[0]=d,Backbone.pubEv.trigger("setHeaderActions",s),r(i(o)),n.close(),l.bootstrap.alert({message:"Added the standard set!"})}))}}));n.$el.on("shown.bs.modal",(function(e){n.$el.find("select").selectpicker()}))},t.generateAddEditStandardSetHtml=function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null);var a='<select class="ddlSchools" title="Select a school...">';return r.each(sCH.userM.get("SchoolInfo"),(function(e){var t=e.SchoolId===n;a+="<option value='"+e.SchoolId+"' "+(t?"selected":"")+">"+e.Name+"</option>"})),a+="</select>",'<input id="txtTitle" '+(e?'value = "'+e+'"':"")+' placeholder="Standard set title" />        <input id="txtShortTitle" '+(t?'value="'+t+'"':"")+' placeholder="Shorter title" maxlength="28" />        <span class="info">Note: the shorter title will be used in the data reports to save space.</span>        '+(sCH.userM.get("SchoolInfo").length>1?a:"")},t.editStandardSet=function(){var e=t,n=t.props,a=n.actions,s=n.selectedObjsForSelectors,o=n.setSelectedObjsForSelectors,c=n.scope,u=parseInt(s[0].value),p=r.find(c.data,{StandardSetId:u}),h=new Backbone.BootstrapModal({title:"Edit standard set",content:t.generateAddEditStandardSetHtml(p.Title,p.ShortTitle,p.SchoolId),cssClass:"modal-al-edit-standard-set",okText:"Save"}).open((function(){h.preventClose();var t=h.$el.find("#txtTitle"),n=h.$el.find("#txtShortTitle"),r=h.$el.find(".ddlSchools");if(0===l.checkRequiredFields([t,n,r])){var c={standardSetId:u,title:t.val().trim(),shortTitle:n.val().trim()};l.attachSchoolIdOrDistrictIdByRole(c,h),d.EditStandardSet(c,(function(){p.Title=c.title,p.ShortTitle=c.shortTitle;var t={dataContent:e.getBuildingName(c),value:u,label:c.title};a.selectors[0].data=a.selectors[0].data.map((function(e){return e.value===s[0].value?t:e})),s[0]=t,s[0]=t,Backbone.pubEv.trigger("setHeaderActions",a),o(i(s)),l.bootstrap.alert({message:"Updated the standard set!"}),h.close()}))}}));h.$el.on("shown.bs.modal",(function(e){h.$el.find("select").selectpicker()}))},t.deleteStandardSet=function(){new Backbone.BootstrapModal({title:"Delete standard set?",content:"This cannot be undone.                 Teachers who have already used standards in this set will still see them in questions, rubric and data views.",cssClass:"modal-delete modal-al-delete-standard-set",okText:"Delete"}).open((function(){var e=t.props,n=e.actions,a=e.selectedObjsForSelectors,s=e.setSelectedObjsForSelectors;d.DeleteStandardSet({standardSetId:a[0].value},(function(){n.selectors[0].data=n.selectors[0].data.filter((function(e){return e.value!==a[0].value})),a[0]=n.selectors[0].data[0],a[0]=n.selectors[0].data[0],Backbone.pubEv.trigger("setHeaderActions",n),s(i(a)),l.bootstrap.alert({message:"Deleted the standard set!"})}))}))},t.getBuildingName=function(e){return e.districtId?l.getSchoolNameByDistrictId(e.districtId):l.getSchoolNameById(e.schoolId)},t}return s(t,e),t.prototype.render=function(){return o.createElement(o.Fragment,null,o.createElement("button",{className:"btnAddStandardSet pull-left icon-plus",title:"Add a new standard set",onClick:this.addStandardSet}),o.createElement(c.default,{dropdownClass:"standardSetsDropdown",buttonClass:"btnStandardSetMenu icon-gear",buttonId:"btnStandardSetMenu",menuCustomClass:"dropdown-menu-right",buttonTitle:"Edit, delete"},o.createElement(c.DropdownItem,{className:"btnEditStandardSet",onClick:this.editStandardSet,text:"Edit name"}),o.createElement(c.DropdownItem,{className:"btnDeleteStandardSet",onClick:this.deleteStandardSet,text:"Delete"})))},t}(o.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({events:{},template:n(1413),initialize:function(){this.on("initialized",this.modalInitialized),this.on("ok",this.updateIRCatalogSettings)},modalInitialized:function(e){this.modal=e;var t=this;s.GetIRCatalogSettings((function(e){t.data=e,t.modal.open()}))},render:function(e){this.$el.html(this.template()),this.$el.find("#chkFilterByGradeLevel").prop("checked",this.data.IsFilterIRCatalogByGradeLevel)},updateIRCatalogSettings:function(){var e=this,t=$("#chkFilterByGradeLevel").is(":checked");this.modal.preventClose(),this.modal.disableOk("Saving..."),s.UpdateIRCatalogSettings({filterByGradeLevel:t},(function(){e.modal.close(),a.bootstrap.alert({message:"Updated settings!"})}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p>Any changes you make will apply to schools you are in.</p>\n<div class="section">\n    <div class="groupedSubsections">\n        <div class="subsection">\n            <div class="sectionTitle">IR Catalog</div>\n            <div class="label">\n                <input id="chkFilterByGradeLevel" type="checkbox" class="regular-checkbox" />\n                <label for="chkFilterByGradeLevel"></label>\n                <p>Students can only see texts in their grade range and below.</p>\n            </div>\n        </div>\n    </div>\n\n    <div class="breaker"></div>\n</div>\n\n<div class="clearBoth"></div>';return __p}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(1415),o=n(37),r=n(5),l=n(1417),d=n(155),c=n(72),u=n(43),p=n(18),h=n(20),g=s.Fragment;t.default=function(e){var t=e.isMappedToTeacher,n=e.role,i=function(){var e=alcfg.node.account.stopMasquerading;o.postRedirect(r.getHostName(e)+e)};return s.createElement("div",{className:"right"},!u.mobile&&sCH.userM.get("IsMasquerading")&&s.createElement(f,a({},{stopMasquerading:i})),!u.mobile&&t&&s.createElement(m,null),!u.mobile&&"student"!==n&&sCH.userM.hasBookCredits()&&s.createElement(v,null),s.createElement(C,{role:n}),sCH.userM.isAnonUser()?s.createElement(b,null):s.createElement(l.default,a({},e,{stopMasquerading:i})))};var f=function(e){return s.createElement(c.default,{buttonClass:"stopMasquerading icon-stop-masq",buttonTitle:"Stop Masquerading",onClick:e.stopMasquerading})},m=function(){return s.createElement("button",{className:"dropdown studentMode",onClick:function(){window.location.href="#student/switchrole"}},"Exit Student Mode")},v=function(){return s.createElement(c.default,{buttonClass:"iconBtn btnViewBookCredits icon-heart-money",buttonTitle:"View Book Credits, Available credits: "+(sCH.userM.get("NumBookCredits").Available/100).toFixed(2),onClick:function(){new Backbone.BootstrapModal({title:"Book credits",content:new i.default,cancelText:!1,okText:"Close",cssClass:"modal-al-view-book-credits"})}})},b=function(){return s.createElement(g,null,s.createElement("a",{className:"btn-box callout pull-right"+(u.mobile?"":" large"),href:"/account.html?furl="+encodeURIComponent(window.location.hash.substr(1))},"Log In"),s.createElement("a",{className:"btn-box callout pull-right"+(u.mobile?"":" large"),href:"/account.html#/signup/educator/step1"},"Sign Up"))},C=function(e){var t=function(t){switch($(t.currentTarget).data("action")){case"helpCenter":if(h.default.isMath){r.windowOpen("https://go.activelylearn.com/MathHC","_blank");break}var n="student"===e.role?"https://helpstudent.activelylearn.com":"http://help.activelylearn.com";r.windowOpen(n,"_blank");break;case"teacherResources":r.windowOpen("https://try.activelylearn.com/become-an-ambassador","_blank");break;case"whatsNew":r.windowOpen(alcfg.helpArticleLink.whatsNew,"_blank");break;case"chatWithUs":r.intercom("show")}},n=function(e){window.open($(e.currentTarget).data("url"))},a=p({helpDropdown:!0,hideForMath:"student"===e.role});return s.createElement(d.default,{dropdownClass:a,buttonClass:"iconBtn btn-tab btnContextualHelp icon-question-mark",buttonId:"btnHelp",menuCustomClass:"dropdown-menu-right",buttonTitle:"Help & Support"},s.createElement(d.DropdownItem,{"data-action":"helpCenter",onClick:t,text:"Help Center"}),"student"!==e.role?s.createElement(g,null,s.createElement("li",{className:"hideForMath"},s.createElement("a",{role:"none"},"Overview Videos:",s.createElement("span",{className:"btnIntroVideo","data-url":alcfg.helpArticleLink.teacherOverview,role:"link",tabIndex:0,onClick:n},"Teacher"),s.createElement("span",{className:"btnIntroVideo","data-url":alcfg.helpArticleLink.studentOverview,role:"link",tabIndex:0,onClick:n},"Student"))),!sCH.userM.isAnonUser()&&s.createElement(g,null,s.createElement(d.DropdownItem,{className:"btnViewTour hideForMath",onClick:function(){sCH.lastAccessedPreReaderUrl=window.location.hash,window.location.hash="#teacher/reader/tour/"+alcfg.tourAssignmentId+"/notes"},text:"Getting Started Tour"}),s.createElement(d.DropdownItem,{"data-action":"chatWithUs",onClick:t,text:"Send Us a Message"})),s.createElement("li",{role:"separator",className:"divider hideForMath"}),s.createElement(d.DropdownItem,{className:"hideForMath","data-action":"teacherResources",onClick:t,text:"Become an Ambassador"}),s.createElement(d.DropdownItem,{className:"hideForMath","data-action":"whatsNew",onClick:t,text:"New Product Features"})):s.createElement(d.DropdownItem,{"data-url":alcfg.helpArticleLink.studentOverview,onClick:n,text:"Getting Started Video"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({events:{},template:n(1416),initialize:function(){this.on("initialized",this.modalInitialized)},modalInitialized:function(e){var t=this;this.modal=e,s.GetBookCreditsData((function(n){t.data=n,e.open()}))},render:function(){this.$el.html(this.template({data:this.data})),a.initTooltips(this.$el)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<ul>\n    ",_.each(data.history,(function(e){__p+="\n        <li>\n            <span>Received:</span>+ $"+(null==(__t=(e.CreditInCents/100).toFixed(2))?"":__t)+'\n            <span class="info" title="'+(null==(__t=e.Notes||"")?"":__t)+'">('+(null==(__t=moment.utc(e.CreateDate).format("MMM Do, YYYY"))?"":__t),print(e.Notes?" - "+e.Notes:""),__p+=")</span>\n        </li>\n    "})),__p+="\n    <li>\n        <span>Used:</span> - $"+(null==(__t=(data.used/100).toFixed(2))?"":__t)+'\n    </li>\n    <li>-------------------------------------</li>\n    <li class="money-green">\n        <span>Available:</span>&nbsp;&nbsp;&nbsp;$'+(null==(__t=(data.available/100).toFixed(2))?"":__t)+"\n    </li>\n</ul>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(754),i=n(22),o=n(37),r=n(5),l=n(10),d=n(155),c=n(85),u=n(233),p=a.Fragment;t.default=function(e){var t=e.firstName,n=e.avatar,h=e.role,g=e.isMappedToTeacher,f=e.hasMasqueradePermission,m=e.hasUploadOneTimeRosteringCSVPermission,v=e.stopMasquerading;return a.createElement(d.default,{dropdownClass:"accountDropdown",buttonClass:"btnAccount",buttonId:"btnAccount","aria-label":"Account info",menuCustomClass:"dropdown-menu-right",buttonChild:a.createElement(p,null,a.createElement("span",{className:"name"},r.sanitize(t)),a.createElement(s.default,{avatar:n}))},"student"!==h?a.createElement(p,null,sCH.userM.isOnFreeOrPersonalPlan()&&!window.isIOSApp?a.createElement(d.DropdownItem,{className:"btnEnterPrimeCode hideForMath",onClick:function(){var e=new Backbone.BootstrapModal({title:"Start Prime plan",content:'<p>If you have received a code, enter it below.</p><input class="txtCode" />'}).open((function(){e.preventClose();var t=e.$el.find(".txtCode").val().trim();t.length>0&&l.ClaimPrimeCode({code:t},(function(){r.bootstrap.alert({message:"You have been upgraded to the Prime plan!"}),window.setTimeout((function(){window.location.reload()}),2e3)}))}))},text:a.createElement(p,null,"Enter ",a.createElement("span",{className:"money-green"},"Prime")," code")}):a.createElement(d.DropdownItem,{className:"hideForMath",href:"#teacher/profile/settings",text:a.createElement(p,null,"Plan: ",a.createElement("span",{className:"money-green"},sCH.userM.getPlanString()))}),a.createElement("li",{role:"separator",className:"divider hideForMath"}),a.createElement(d.DropdownItem,{href:"#teacher/switchrole",text:"Switch to Student Mode"})):g&&a.createElement("li",null,a.createElement("a",{href:"#student/switchrole"},"Exit Student Mode")),!g&&a.createElement(d.DropdownItem,{href:"#"+("student"===h?"student":"teacher")+"/profile/settings",text:"My profile"}),f&&a.createElement(d.DropdownItem,{className:"masquerade",onClick:function(){var e=new Backbone.BootstrapModal({title:"Masquerade as user",okText:"Masquerade",content:'\n        <div><input class="txtUserName" placeholder="Enter username" maxlength="100" /></div>\n        <div class="error"></div>\n        <div class="success"></div>\n        <div class="loginSourceContainer">\n          <label for="loginSource">Login source to simulate</label>\n          <select id="loginSource" class="loginSource" />\n        </div>\n      ',cssClass:"modal-al-masquerade",allowCancel:!1}).open((function(){e.preventClose(),e.disableOk("Masquerading...");var t=this.$el.find(".txtUserName").val().trim(),n=this.$el.find(".loginSource").val();if(t){var a=alcfg.node.account.masquerade;o.postRedirect(r.getHostName(a)+a,{userName:t,loginSource:n})}else r.bootstrap.alert({alert:"warning",message:"Enter a username to masquerade"}),setTimeout((function(){return e.enableOk("Masquerade")}),1e3)}));e.$el.on("shown.bs.modal",(function(){e.disableOk("Masquerade"),e.$el.find(".txtUserName").on("keyup",(function(t){13===t.keyCode&&e.$el.find("a.ok").click()}));var t=null;e.$el.find(".txtUserName").on("input",(function(n){e.disableOk("Masquerade"),e.$el.find(".error, .success, .loginSourceContainer").hide(),t&&clearTimeout(t),t=setTimeout((function(){clearTimeout(t),n.target.value.trim()&&l.GetMasqueradeUser(n.target.value,(function(t){if("string"==typeof t)e.$el.find(".error").text(t).show();else{var n=t.masqueradeAsUser,a=t.userAccounts;e.enableOk("Masquerade");var s=n.FirstName+" "+n.LastName+"\n                  (ID: "+n.UserId+" | "+n.UserName+")";e.$el.find(".success").text(s).show(),e.$el.find(".loginSource").html(""),Object.keys(a).forEach((function(t){e.$el.find(".loginSource").append('<option value="'+t+'">'+t+"</option>")})),e.$el.find(".loginSourceContainer").toggle(Object.keys(a).length>1)}}))}),250)}))}))},text:"Masquerade"}),m&&a.createElement(d.DropdownItem,{onClick:function(){var e=$('<div id="popup">        <input id="resellerId" placeholder="Enter the reseller\'s id" />\n        <select id="country" >\n          <option value="-1">Select the country where the schools are located</option>\n          <option value="TR">Turkey</option>\n          <option value="AE">UAE</option>\n        </select>\n        <div id="csvUploadContainer"></div>\n        <div id="errors"></div>\n      </div>'),t=new Backbone.BootstrapModal({title:"Upload onetime roster CSV file",content:e,okText:"Submit",cssClass:"modal-lg onetime-rostering-csv-upload"}).on("shown",(function(){i.mountReactComponent(u.default,e.find("#csvUploadContainer")[0],{uploadUrl:alcfg.node.international_rostering.upload_csv_bulk_import,submitData:{},successMessage:"The data uploaded in the CSV has been successfully rostered!",enableMultiple:!1,disablePreview:!0,fileType:["text/csv",".csv"].join(","),fileTypeErrorMessage:"Select a valid csv file",fileDropPlaceholder:"Try dropping some files here, or click to select files to upload."}),t.$el.find("select").selectpicker()})).on("ok",(function(){var e=this,t=this;this.preventClose(),t.$el.find(".flash").removeClass("flash");var n=t.$el.find("#resellerId").val(),a=t.$el.find("#country").val();n.length&&-1!==["GlobEd"].indexOf(n)?"-1"===a?(t.$el.find("#country").next(".bootstrap-select").addClass("flash"),r.bootstrap.alert({message:"Please enter a valid country",alert:"danger"})):(this.disableOk("Submitting"),sCH.reactUploader.submit((function(n){if("noFiles"===n.message)return r.bootstrap.alert({message:"No Files Selected",alert:"danger"}),void e.enableOk();if("Success"!==n&&n.responseJSON instanceof Array){var a="<ul>";n.responseJSON.forEach((function(e){a+="<li>Line Number "+(e.rowNumber?e.rowNumber:"NA")+". Error detail: "+e.errorType})),a+="</ul",t.$el.find("#errors").append(a),t.enableOk("Submit")}else t.close()}),{resellerId:n,country:a})):(t.$el.find("#resellerId").addClass("flash"),r.bootstrap.alert({message:"Please enter a valid reseller id",alert:"danger"}))})).open()},text:"Upload One-time rostering CSV"}),sCH.userM.get("IsMasquerading")&&a.createElement(d.DropdownItem,{className:"stopMasquerading",onClick:v,text:"Stop masquerading"}),a.createElement(d.DropdownItem,{className:"btnSignOut",onClick:function(){c.signOut("header")},text:"Sign out"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(137),s=n(0),i=n(37),o=n(13),r=o.createMuiTheme,l=o.MuiThemeProvider,d=o.withStyles,c={"news-and-articles":a.lightBlue,ela:a.pink,"social-studies":a.purple,science:a.green,library:a.brown,"my-imports":a.orange},u=d((function(e){return{headerTopic:{color:"#FFF",fontSize:22,padding:"8px 10px",paddingRight:50,width:355,maxWidth:355,boxSizing:"border-box",fontFamily:"Avenir Next LT W02 Demi",backgroundColor:e.color,display:"block",lineHeight:1,position:"relative",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",margin:0},cancel:{position:"absolute",right:"10px !important",lineHeight:.8,"&:before":{lineHeight:1,color:"#FFF",fontSize:"16px !important"}},"@media (max-width: 1024px)":{headerTopic:{maxWidth:360}},"@media (max-width: 480px)":{headerTopic:{maxWidth:190,paddingRight:30}},"@media (max-width: 400px)":{headerTopic:{maxWidth:140,paddingRight:30}}}}))((function(e){var t="Library"===e.topicName?sCH.userM.getLibraryString():e.topicName;return s.createElement("div",{className:e.classes.headerTopicWrapper,id:"catalogTopicHeader"},s.createElement("h1",{className:e.classes.headerTopic},t,s.createElement("a",{href:"#teacher/catalog",className:e.classes.cancel+" icon-cancel","aria-label":"Go Back to Catalog"})))}));t.default=function(e){var t=function(e){return r({typography:{useNextVariants:!0},color:c[e][500],palette:{primary:c[e]}})}(i.getSlug(e.subjectName));return s.createElement(l,{theme:t},s.createElement(u,{topicName:e.topicName,classes:e.classes,theme:t}))}},function(e,t,n){"use strict";var a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(1420),o=n(1421),r=n(1422),l=n(88),d=n(5),c=function(){var e=d.onDevice();return{levelFilter:{display:"inline-block",marginLeft:e?4:10,marginRight:e?4:10,marginTop:5,position:"relative",padding:e?0:"0 16px 0 0",fontFamily:"Avenir Next LT W02 Demi","&::before":{height:0,borderBottom:"none"},"&:focus::after":{transform:"scaleX(1.15)",transformOrigin:"0 0"},"&.selected::before":{height:2},"& > div":{paddingRight:e?0:8,paddingLeft:e?0:8,"& > span::before":{lineHeight:"25px"}},"& > svg":{left:"85%"}},filterItems:{fontFamily:"AvenirNextLTW02-Medium"}}};t.default=function(e){var t=["Library","My Imports"];return e.topicName&&!e.isUnitsPage&&s.createElement("div",{id:"catalogFilters"},-1===a(t,l.topicNamesToNotFilterByGradeLevel).indexOf(e.topicName)&&s.createElement(i.default,{selectedGradeLevels:sCH.catalogSelectedGradeLevels,topicName:e.topicName,filterStyles:c}),-1===a(t,l.topicNamesToNotFilterByLexile).indexOf(e.topicName)&&s.createElement(o.default,{selectedLexiles:sCH.catalogSelectedLexiles,topicName:e.topicName,filterStyles:c}),-1===a(t,l.topicNamesToNotFilterByStandards).indexOf(e.topicName)&&s.createElement(r.default,{selectedStandardIds:sCH.catalogSelectedStandardIds,topicName:e.topicName,filterStyles:c}))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(39),r=n(96),l=n(0),d=n(13).withStyles,c=n(5),u=n(88),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedGradeLevels:t.props.selectedGradeLevels},t.clearSelection=function(){sCH.catalogSelectedGradeLevels=[],t.setState({selectedGradeLevels:[]})},t.handleChange=function(e){var n="all"===e.target.value?[]:e.target.value.split(",").map(Number);t.setState({selectedGradeLevels:n}),setTimeout((function(){return t.renderFilteredTiles(n)}),0)},t.renderFilteredTiles=function(e){sCH.catalogSelectedGradeLevels=e,"Homepage"===t.props.topicName||"My Workspace"===t.props.topicName&&u.hasSearchText()?(Backbone.pubEv.trigger("renderSearch"),Backbone.pubEv.trigger("filterSubjectDropdowns")):"My Workspace"===t.props.topicName?Backbone.pubEv.trigger("filterMyFolderTiles"):Backbone.pubEv.trigger("renderTopicTiles")},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("clearGradeLevelFilter",this.clearSelection)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("clearGradeLevelFilter")},t.prototype.render=function(){var e=this.props.classes.levelFilter,t="all";this.state.selectedGradeLevels.length>0&&(e+=" selected",t=this.state.selectedGradeLevels.join(","));var n=c.onDevice()?{renderValue:function(){return l.createElement("span",{className:"icon-filter",title:"Grade"})},IconComponent:function(){return null}}:null;return l.createElement(r.default,i({value:t,className:e,onChange:this.handleChange,inputProps:{name:"gradeLevels",id:"gradeLevels"},displayEmpty:!0},n),l.createElement(o.default,{className:this.props.classes.filterItems,value:"all"},"All grade levels"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"3,4"},"3rd - 4th grade"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"5,6"},"5th - 6th grade"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"7,8"},"7th - 8th grade"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"9,10"},"9th - 10th grade"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"11,12"},"11th - 12th grade"))},t}(l.Component);t.default=function(e){var t=d(e.filterStyles)(p);return l.createElement(t,i({},e))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(39),r=n(96),l=n(0),d=n(5),c=n(88),u=n(13).withStyles,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedLexiles:t.props.selectedLexiles},t.clearSelection=function(){sCH.catalogSelectedLexiles=[],t.setState({selectedLexiles:[]})},t.handleChange=function(e){var n="all"===e.target.value?[]:e.target.value.split(",").map(Number);t.setState({selectedLexiles:n}),setTimeout((function(){return t.renderFilteredTiles(n)}),0)},t.renderFilteredTiles=function(e){sCH.catalogSelectedLexiles=e,"Homepage"===t.props.topicName||"My Workspace"===t.props.topicName&&c.hasSearchText()?(Backbone.pubEv.trigger("renderSearch"),Backbone.pubEv.trigger("filterSubjectDropdowns")):"My Workspace"===t.props.topicName?Backbone.pubEv.trigger("filterMyFolderTiles"):Backbone.pubEv.trigger("renderTopicTiles")},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("clearLexileFilter",this.clearSelection)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("clearLexileFilter")},t.prototype.render=function(){var e=this.props.classes.levelFilter,t="all";this.state.selectedLexiles.length>0&&(e+=" selected",t=this.state.selectedLexiles.join(","));var n=d.onDevice()?{renderValue:function(){return l.createElement("span",{className:"icon-filter",title:"Lexile"})},IconComponent:function(){return null}}:null;return l.createElement(r.default,i({value:t,className:e,onChange:this.handleChange,inputProps:{name:"lexiles",id:"lexiles"}},n),l.createElement(o.default,{className:this.props.classes.filterItems,value:"all"},"All Lexile levels"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"450,790"},"450L - 790L"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"770,980"},"770L - 980L"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"955,1155"},"955L - 1155L"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"1080,1305"},"1080L - 1305L"),l.createElement(o.default,{className:this.props.classes.filterItems,value:"1215,9999"},"1215L+"))},t}(l.Component);t.default=function(e){var t=u(e.filterStyles)(p);return l.createElement(t,i({},e))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(150),l=n(39),d=n(0),c=n(5),u=n(197),p=n(198),h=n(231),g=n(101),f=n(102),m=n(103),v=n(116),b=n(96),C=n(38),y=n(88),_=n(13),S=_.withStyles,w=_.createMuiTheme,T=_.MuiThemeProvider,I=w({typography:{fontFamily:"AvenirNextLTW02-Medium"}}),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!1,selectedStandardSet:"all",selectedStandardIds:t.props.selectedStandardIds},t.clearSelection=function(){sCH.catalogSelectedStandardIds=[],t.setState({selectedStandardSet:"all",selectedStandardIds:[]})},t.handleStandardSetChange=function(e){var n=e.target.value;"all"===n?(t.setState({selectedStandardIds:[],selectedStandardSet:n}),setTimeout((function(){t.handleClose()}),0)):t.setState({open:!0,selectedStandardSet:n})},t.handleStandardIdsChange=function(e){var n=t.state.selectedStandardIds;n.indexOf(e)>-1?n=n.filter((function(t){return t!==e})):n.push(e),t.setState({selectedStandardIds:n})},t.handleClose=function(){sCH.catalogSelectedStandardIds=t.state.selectedStandardIds,t.setState({open:!1}),"Homepage"===t.props.topicName||"My Workspace"===t.props.topicName&&y.hasSearchText()?(Backbone.pubEv.trigger("renderSearch"),Backbone.pubEv.trigger("filterSubjectDropdowns")):"My Workspace"===t.props.topicName?Backbone.pubEv.trigger("filterMyFolderTiles"):Backbone.pubEv.trigger("renderTopicTiles")},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("clearStandardsFilter",this.clearSelection)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("clearStandardsFilter")},t.prototype.render=function(){var e=this,t=this.state.selectedStandardIds.length>0,n=this.props.classes.levelFilter+(t?" selected":""),a=sCH.userM.get("StandardSets"),s="all"===this.state.selectedStandardSet?[]:a.find((function(t){return t.StandardSetId===e.state.selectedStandardSet})).Standards,y=c.onDevice()?{renderValue:function(){return d.createElement("span",{className:"icon-filter",title:"Standards"})},IconComponent:function(){return null}}:null;return d.createElement(T,{theme:I},d.createElement(b.default,i({value:"all",className:n,onChange:this.handleStandardSetChange,inputProps:{name:"standardSets",id:"standardSets"}},y),d.createElement(l.default,{value:"all",className:this.props.classes.filterItems},d.createElement("span",null,this.state.selectedStandardIds.length>0?c.plural(this.state.selectedStandardIds.length,"%count standard","%count standards"):"All standards",this.state.selectedStandardIds.length>0&&d.createElement("span",{className:"extraStandardsFilter"},"selected",d.createElement("span",{className:"clearStandardsFilter"},"Clear")))),a.map((function(t,n){var a=o.intersection(e.state.selectedStandardIds,o.map(t.Standards,"StandardId")),s=0===a.length?t.Title:d.createElement("span",null,t.Title,d.createElement("span",{className:e.props.classes.numSelected},"(",a.length," selected)"));return d.createElement(l.default,{key:n,value:t.StandardSetId,className:e.props.classes.filterItems},s)}))),d.createElement(g.default,{id:"selectStandardDialog",open:this.state.open,className:this.props.classes.dialog},d.createElement(v.default,null,"Select standards to filter"),d.createElement(m.default,null,d.createElement(u.default,null,s.map((function(t,n){var a=t.StandardCode+" - "+t.ShortText;return d.createElement(p.default,{key:n,button:!0,className:e.props.classes.filterItems,onClick:function(){return e.handleStandardIdsChange(t.StandardId)}},d.createElement(r.default,{"data-standardid":t.StandardId,checked:e.state.selectedStandardIds.indexOf(t.StandardId)>-1}),d.createElement(h.default,{primary:a}))})))),d.createElement(f.default,null,d.createElement(C.default,{onClick:this.handleClose,className:this.props.classes.button,color:"primary"},"Done"))))},t}(d.Component);t.default=function(e){var t=S((function(t){var n=t.color||t.palette.primary[500];return i(i({},e.filterStyles()),{dialog:{"& h2":{fontFamily:"AvenirNextLTW02-Medium"}},button:{fontFamily:"Avenir Next LT W02 Demi",fontSize:16},numSelected:{marginLeft:10,fontSize:14,color:n}})}))(x);return d.createElement(t,i({},e))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(39),r=n(96),l=n(0),d=n(13).withStyles,c=n(14),u=n(72),p=n(48),h=function(){return{levelFilter:{marginRight:8,marginTop:5,position:"relative",padding:0,"&::before":{height:0,borderBottom:"none"},"& > div":{paddingRight:25,paddingLeft:5,width:32,"& > span::before":{fontSize:30,lineHeight:"30px",fontWeight:700},"& > .icon-ela::before":{color:"#e91e63"},"& > .icon-science::before":{color:"#4caf50"},"& > .icon-social-studies::before":{color:"#9c27b0"}}},filterItems:{fontFamily:"AvenirNextLTW02-Medium",lineHeight:1.3,'& > span[class*="icon"]':{width:30,marginRight:10,"&::before":{fontSize:30,lineHeight:"unset"}}},selectMenu:{"& > .MuiMenu-paper":{marginTop:35}},homeButton:{marginRight:"17px !important"}}},g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedSubject:sCH.catalogSubjectSlug,isInHomePage:"#teacher/catalog"===window.location.hash||-1!==window.location.hash.indexOf("#teacher/catalog")&&-1!==window.location.hash.indexOf("subject")},t.navigatedToSearch=function(){return t.setState({isInHomePage:!1})},t.handleChange=function(e){var n=e.target.value;t.shouldAllowChangingSKU(n)?n!==t.state.selectedSubject&&(sCH.catalogSubjectSlug=n,t.setState({selectedSubject:sCH.catalogSubjectSlug}),setTimeout((function(){return t.updateCatalog()}),0)):p.showBuyTeacherPopup({title:"Access this subject with our Prime plan",content:"Free users can only access the Catalog for one subject."})},t.updateCatalog=function(){Backbone.pubEv.trigger("updateCatalog")},t.navigateToHome=function(){var e="#teacher/catalog/"===window.location.hash.split("?")[0],n=e&&-1!==window.location.hash.indexOf("query");Backbone.pubEv.trigger("clearGradeLevelFilter"),Backbone.pubEv.trigger("clearLexileFilter"),Backbone.pubEv.trigger("clearStandardsFilter"),window.location.hash="#teacher/catalog",n?Backbone.pubEv.trigger("resetSearch"):e&&t.updateCatalog()},t.shouldAllowChangingSKU=function(e){return-1!==sCH.userM.get("AllowedSubjectSlugs").indexOf(e)},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("navigatedToSearch",this.navigatedToSearch)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("navigatedToSearch",this.navigatedToSearch)},t.prototype.render=function(){var e=this,t=this.props.classes.levelFilter,n=this.state.selectedSubject,a={renderValue:function(){return l.createElement("span",{className:"icon-"+sCH.catalogSubjectSlug})}},s=Object.keys(c.SubjectSlugSubjectMap);return sCH.catalogSubjectSlug?this.state.isInHomePage?l.createElement(r.default,i({value:n,className:t,onChange:this.handleChange,"aria-label":"Filter by Subject",inputProps:{name:"subjectFilter",id:"subjectFilter"},MenuProps:{className:this.props.classes.selectMenu},displayEmpty:!0},a),s.map((function(t){var n=c.SubjectSlugSubjectMap[t];return l.createElement(o.default,{key:t,className:e.props.classes.filterItems,value:t},l.createElement("span",{className:"icon-"+t}),n,!e.shouldAllowChangingSKU(t)&&l.createElement("span",{className:"icon-premium-lock"}))}))):l.createElement(u.default,{buttonClass:"icon-home "+this.props.classes.homeButton,buttonTitle:"Go to homepage",onClick:this.navigateToHome}):null},t}(l.Component);t.default=function(e){var t=d(h)(g);return l.createElement(t,i({},e))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(5),l=n(1425),d=n(20),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.componentDidMount=function(){$("#content > .layout").addClass("catalog")},t.prototype.render=function(){return d.default.isMath?o.createElement("iframe",{name:"mathIFrame",className:"iframeFullScreen",src:d.default.mathIframeOrigin+"/catalog",onLoad:function(){return r.adjustHeaderSpacing()}}):o.createElement(l.default,i({},this.props.viewProps))},t}(o.Component);t.default=c},function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(22),c=n(1426),u=n(1429),p=n(1470),h=n(1538),g=n(1541),f=n(1542),m=n(1543),v=n(1544),b=n(88),C=n(37),y=function(e){function t(t){var n=e.call(this,t)||this;return n.updateCatalog=function(){n.setState(n.getInitialState(),n.renderPage)},n.initEventListeners=function(){Backbone.pubEv.on("updateCatalog",n.updateCatalog),Backbone.pubEv.on("clearCatalogFilters",n.clearCatalogFilters),Backbone.pubEv.on("renderSearch",n.renderSearch),Backbone.pubEv.on("renderMyFolderView",n.renderMyFolderView),Backbone.pubEv.on("layerSelectedToMerge",n.layerSelectedToMerge)},n.clearCatalogFilters=function(){Backbone.pubEv.trigger("clearGradeLevelFilter"),Backbone.pubEv.trigger("clearLexileFilter"),Backbone.pubEv.trigger("clearStandardsFilter"),C.replaceQueryStringParam({}),n.renderSearch()},n.getInitialState=function(){return i(i({},b.getPageAndPageParamsByTopicSlug(n.props.topicSlug,n.props.topicBucketSlug)),{el:null})},n.renderPage=function(){"homepage"===n.state.page||"myfolders"===n.state.page?(n.state.query||b.areFiltersBeingUsed()?n.renderSearch(!0,!1):"homepage"===n.state.page?n.setState({el:l.createElement(u.default,{subjectSlug:n.state.subjectSlug})}):n.renderMyFolderView({isInitialLoad:!0,selectedFolderId:n.state.selectedFolderId,selectedFolderFilter:n.state.selectedFolderFilter}),n.generateAutoComplete()):"units"===n.state.page?n.setState({el:l.createElement(f.default,{topicSlug:n.props.topicSlug})}):"topic"===n.state.page?n.setState({el:l.createElement(g.default,{topicSlug:n.props.topicSlug,topicBucketSlug:n.props.topicBucketSlug||"all"})}):"library"===n.state.page?n.setState({el:l.createElement(v.default,{selectedFolderId:n.state.selectedFolderId})}):"myimports"===n.state.page&&n.setState({el:l.createElement(m.default,null)})},n.renderSearch=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),o(n,void 0,void 0,(function(){return r(this,(function(n){return this.state.query||b.areFiltersBeingUsed()?this.setState({el:l.createElement(h.default,{directlyFromUrl:e,fromPaging:t,filterHash:b.getFilterHash(),query:this.state.query,page:this.state.page})}):(C.replaceQueryStringParam({}),this.renderPage()),[2]}))}))},n.renderMyFolderView=function(e){return o(n,void 0,void 0,(function(){return r(this,(function(t){return this.setState({el:l.createElement(p.default,{isInitialLoad:e.isInitialLoad,selectedFolderId:e.selectedFolderId,selectedFolderFilter:e.selectedFolderFilter}),selectedFolderId:e.selectedFolderId}),[2]}))}))},n.layerSelectedToMerge=function(e){0===$(".bulkSelectionBar").length?($("#content").append('<div class="bulkSelectionBar">'),d.mountReactComponent(c.default,$("#content").find("div.bulkSelectionBar")[0],{selectedLayer:e})):Backbone.pubEv.trigger("addSelectedLayer",e)},n.generateAutoComplete=function(){Backbone.pubEv.trigger("setHeaderActions",{isSearchEnabled:!0,searchCollapseOnSmallScreens:!0,searchPlaceholder:"Search",searchCallback:function(e){n.setState({query:e},(function(){n.renderSearch(!1,!1)}))},searchAutocompleteData:{helperText:"For best results, choose a topic below:",source:b.getFilteredSubjectsAndTopicsByAllowedSubjectSlugs(sCH.catalogSubjectsAndTopics),page:"catalog",callback:function(e){}}})},b.initCatalogView(),n.state=n.getInitialState(),n.initEventListeners(),n}return s(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,b.getSubjectsAndTopics()];case 1:return e.sent(),this.renderPage(),[2]}}))}))},t.prototype.componentDidUpdate=function(e){e!==this.props&&this.updateCatalog()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("updateCatalog",this.updateCatalog),Backbone.pubEv.off("renderSearch",this.renderSearch),Backbone.pubEv.off("renderMyFolderView",this.renderMyFolderView),Backbone.pubEv.off("layerSelectedToMerge",this.layerSelectedToMerge),Backbone.pubEv.off("createdUserLayer"),Backbone.pubEv.off("purchasedText"),Backbone.pubEv.off("clearCatalogFilters",this.clearCatalogFilters)},t.prototype.render=function(){return this.state.el?this.state.el:null},t}(l.Component);t.default=y}).call(this,n(21))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(38),r=n(494),l=n(1427),d=n(5),c=n(137),u=n(13),p=u.createMuiTheme,h=u.MuiThemeProvider,g=n(24),f=p({typography:{useNextVariants:!0,fontFamily:'"AvenirNextLTW02-Medium", "Helvetica", "Arial", sans-serif'},palette:{primary:{light:c.lightBlue[500],main:c.lightBlue[500],dark:c.lightBlue[800],contrastText:"#fff"}}}),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!0,selectedLayers:[t.props.selectedLayer]},t.addSelectedLayer=function(e){var n=t.state.selectedLayers;n.map((function(e){return e.Layer.LayerId})).indexOf(e.Layer.LayerId)<0&&(n.push(e),t.setState({open:!0,selectedLayers:n}))},t.next=function(){t.state.selectedLayers.length>1?(g.showModal(i.createElement(l.default,{selectedLayers:t.state.selectedLayers})),t.close()):d.bootstrap.alert({message:"Select at least two assignments to merge!",alert:"danger"})},t.close=function(){t.setState({open:!1,selectedLayers:[]})},t}return s(t,e),t.prototype.componentWillMount=function(){Backbone.pubEv.on("addSelectedLayer",this.addSelectedLayer)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("addSelectedLayer")},t.prototype.render=function(){var e=d.plural(this.state.selectedLayers.length,"%count assignment","%count assignments");return i.createElement(h,{theme:f},i.createElement(r.default,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.open,ContentProps:{"aria-describedby":"message-id"},message:i.createElement("span",{id:"message-id"},e," marked to merge. Use the 3 dot icon to add more."),action:[i.createElement("div",{key:0},i.createElement(o.default,{color:"primary",size:"small",onClick:this.next},"Next")),i.createElement(o.default,{key:1,color:"secondary",size:"small",onClick:this.close},"Cancel")]}))},t}(i.Component);t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(10),i=n(1428),o=n(24),r=n(5),l=n(34);function d(e){var t=e.selectedLayers,n=e.sortableRef;return a.useEffect((function(){i.create(n.current,{animation:150})}),[]),a.createElement("ul",{className:"sortableList",ref:n},t.map((function(e){return a.createElement("li",{key:e.Layer.LayerId},a.createElement("span",{className:"icon-menu"}),a.createElement("div",{className:"title","data-layerid":e.Layer.LayerId},r.sanitize(e.Title)))})))}t.default=function(e){var t=e.selectedLayers,n=a.useState(""),i=n[0],c=n[1],u=a.useRef();return a.createElement(o.default,{title:"Merge texts",okText:"Merge",disabledOkText:"Merging...",okCallback:function(e){var t,n,a=(t=i.trim(),n=[],$(u.current).find("div.title").each((function(){n.push($(this).data("layerid"))})),{mergedTextTitle:t,orderedLayerIds:n});s.MergeTexts(a,(function(t){t?(window.location.hash.indexOf("my-folders")>-1?window.location.reload():Backbone.pubEv.trigger("textImported"),o.hideModals()):(r.bootstrap.alert({message:"Something went wrong.",alert:"danger"}),e.enableOkButton("Merge"))}))}},a.createElement("p",null,"The selected assignments can be reordered below, and will be merged into a new assignment in your folder. All annotations will be copied to the new assignment."),a.createElement("p",{className:"info"},"Note: existing assignments will not be affected."),a.createElement(d,{selectedLayers:t,sortableRef:u}),a.createElement(l.TextValidator,{name:"txtMergedTextTitle",id:"txtMergedTextTitle",label:"Title of new assignment",value:i,fullWidth:!0,inputProps:{maxLength:200},onChange:function(e){return c(e.target.value)},autoFocus:!0,required:!0}))}},,function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(11),c=n(8),u=n(200),p=n(14),h=n(350),g=n(88),f=n(346),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={tileComponent:null,heroTile:null},t.fetchData=function(){return o(t,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,g.getCatalogTopicData("homepage",this.props.subjectSlug)];case 1:return e=t.sent(),this.setState({tileComponent:this.getTileComponent(e.Buckets),heroTile:e.heroTile}),[2]}}))}))},t.getTileComponent=function(e){return e.map((function(e){var t=e.Topics.length>0,n=e.ViewMoreTopicSlug?{topicUrl:"#teacher/catalog/"+e.ViewMoreTopicSlug}:void 0;return l.createElement(h.default,{key:e.TopicBucketId,bucketTitle:e.TopicBucketName,page:p.Page.CATALOG,tiles:t?e.Topics:e.Texts,isTopicTileBucket:t,viewMoreLinkObj:n,shouldShowCarousel:!0})}))},t}return s(t,e),t.prototype.componentDidMount=function(){this.fetchData()},t.prototype.render=function(){var e={subjectsAndTopics:c.groupBy(sCH.catalogSubjectsAndTopics,"SubjectName"),selectedGradeLevels:sCH.catalogSelectedGradeLevels,selectedLexiles:sCH.catalogSelectedLexiles,selectedStandardIds:sCH.catalogSelectedStandardIds,topicName:"Homepage"},t=document.getElementById("theScroll");return l.createElement(l.Fragment,null,l.createElement(u.default,i({},e)),d.createPortal(l.createElement(l.Fragment,null,this.state.heroTile&&l.createElement(f.default,{data:this.state.heroTile,page:p.Page.CATALOG}),this.state.tileComponent&&l.createElement("div",{className:"tileView"},this.state.tileComponent)),t))},t}(l.Component);t.default=m}).call(this,n(21))},,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(137),l=n(0),d=n(88),c=n(38),u=n(230),p=n(2026),h=n(43),g=n(14),f=n(13),m=f.createMuiTheme,v=f.MuiThemeProvider,b=f.withStyles,C=n(87),y={default:r.lightBlue,"news-and-articles":r.lightBlue,"my-workspace":r.blueGrey,ela:r.pink,"social-studies":r.purple,science:r.green,library:r.brown,"my-imports":r.orange},_=function(e){return m({typography:{useNextVariants:!0},color:y[e][500],palette:{primary:y[e]}})},S=function(e){function t(t){var n=e.call(this,t)||this;return n.getSubjectsAndTopics=function(){return d.filterTopics(i({},n.props.subjectsAndTopics),sCH.catalogSelectedGradeLevels,sCH.catalogSelectedLexiles,sCH.catalogSelectedStandardIds)},n.expandGroup=function(e,t){var a=g.SubjectSlugSubjectMap[sCH.catalogSubjectSlug];if(a){var s=n.state.subjectsAndTopics[a].filter((function(t){return t.ShowInDropdown&&t.GroupName===e}));n.setState({groupMenuAnchorEl:t,groupMenuTopics:s})}},n.handleGroupMenuClose=function(){n.setState({groupMenuAnchorEl:null})},n.state={groupMenuAnchorEl:null,groupMenuTopics:null,topicName:n.props.topicName,subjectsAndTopics:n.getSubjectsAndTopics()},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("filterSubjectDropdowns",(function(){return e.setState({subjectsAndTopics:e.getSubjectsAndTopics()})}))},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("filterSubjectDropdowns")},t.prototype.componentDidUpdate=function(e){e.topicName!==this.props.topicName&&this.setState({topicName:this.props.topicName})},t.prototype.groupNamesToRender=function(){var e=["Curriculum Units","Type","Genres","Themes","Topics"],t=g.SubjectSlugSubjectMap[sCH.catalogSubjectSlug];if(t){var n=this.state.subjectsAndTopics[t].filter((function(e){return e.ShowInDropdown&&e.GroupName})).map((function(e){return e.GroupName}));return o.uniq(n).sort((function(t,n){return e.indexOf(t)-e.indexOf(n)}))}return[]},t.prototype.render=function(){var e=this,t=this.props.classes,n=this.state,a=n.groupMenuAnchorEl,s=n.groupMenuTopics;return l.createElement(v,{theme:_("default")},l.createElement("nav",{"aria-label":"Catalog contents menu",className:t.wrapper},l.createElement(w,{classes:t,topicName:this.state.topicName}),l.createElement("div",{className:t.verticalLine}),l.createElement("div",{id:"catalogNav"},this.groupNamesToRender().map((function(n,a){return l.createElement(I,{key:a,classes:t,groupName:n,expandGroup:e.expandGroup})})),l.createElement(T,{classes:t})),l.createElement(x,{classes:t}),l.createElement(k,{classes:t}),a&&l.createElement(u.default,{open:!0,anchorEl:a,anchorReference:"anchorEl",onClose:this.handleGroupMenuClose,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},className:t.popoverMenu},l.createElement(E,{classes:t,topics:s,closePopup:function(){return e.handleGroupMenuClose()}}))))},t}(l.Component),w=function(e){return l.createElement(v,{theme:_("my-workspace")},l.createElement(c.default,{className:e.classes.button+" "+("My Workspace"===e.topicName?"selected":""),color:"primary",onClick:function(){window.location.hash.indexOf("#teacher/catalog/my-folders/everything")>-1&&"#teacher/catalog/my-folders/everything"!==window.location.hash?(Backbone.pubEv.trigger("resetSearch",{shouldNavigate:!1}),Backbone.pubEv.trigger("clearGradeLevelFilter"),Backbone.pubEv.trigger("clearLexileFilter"),Backbone.pubEv.trigger("clearStandardsFilter"),Backbone.pubEv.trigger("renderMyFolderView",{isInitialLoad:!0,selectedFolderId:-1}),Backbone.router.navigate("teacher/catalog/my-folders/everything",{trigger:!1})):window.location.hash="#teacher/catalog/my-folders/everything"}},h.mobile?l.createElement("span",{className:"icon-folder foldericon"}):"My Workspace"))},T=function(e){return l.createElement(v,{theme:_("news-and-articles")},l.createElement(c.default,{className:e.classes.button,color:"primary",onClick:function(){window.location.hash="#teacher/catalog/news-and-articles"}},"News & Articles"))},I=function(e){var t=e.classes,n=e.groupName,a=e.expandGroup,s=_(sCH.catalogSubjectSlug);return l.createElement(v,{theme:s},l.createElement(c.default,{className:t.button,color:"primary",onClick:function(e){a(n,e.currentTarget)}},n,l.createElement("span",{className:"arrow-down",style:{borderTop:"5px solid "+s.color}})))},x=function(e){return l.createElement(v,{theme:_("library")},l.createElement(c.default,{className:e.classes.button,color:"primary","data-districtid":sCH.userM.getPrimarySchool().DistrictId,onClick:function(){window.location.hash="#teacher/catalog/library"}},sCH.userM.getLibraryString(),!sCH.userM.isOnPrimePlan()&&l.createElement("span",{className:"icon-premium-lock"})))},k=function(e){return l.createElement(v,{theme:_("my-imports")},l.createElement(c.default,{id:"my-imports",className:e.classes.button,color:"primary",onClick:function(){window.location.hash="#teacher/catalog/my-imports"}},"My Imports"))},E=function(e){var t=e.classes,n=e.topics,a=e.closePopup,s=o.groupBy(n.filter((function(e){return e.SubGroupName})),"SubGroupName"),i=Object.keys(s).sort((function(e,t){return C(e,t)})),r=n.filter((function(e){return!e.SubGroupName})),d=i.map((function(e,n){var a=s[e],i=a.length;return l.createElement(p.SubMenu,{popupClassName:i>20?"multiCols":null,title:l.createElement(N,{classes:t,groupName:e}),className:"subMenuHover"+sCH.catalogSubjectSlug,key:n},l.createElement("li",{className:t.dropdownMenuSectionHeader,style:{color:_(sCH.catalogSubjectSlug).color,paddingLeft:15,paddingTop:5,paddingRight:15},key:n+"-0"},e),a.map((function(e,t){return l.createElement(p.MenuItem,{key:n+"-"+(t+1)},l.createElement(A,{topic:e}))})))})),c=i.length+r.length;return l.createElement("div",{className:c>20?"multiCols":""},l.createElement(p.default,{className:t.dropdownMenuWrapper,openAnimation:"slide-up",forceSubMenuRender:!0,onClick:a,triggerSubMenuAction:"hover",expandIcon:l.createElement("span",{className:"no-hover icon-play"})},d,r.map((function(e,t){return l.createElement(p.MenuItem,{key:i.length+"-"+t},l.createElement(A,{topic:e}))}))))},N=function(e){return l.createElement("div",{key:e.groupName,className:e.classes.dropdownMenuSectionHeader},e.groupName,-1!==["Curriculum Units"].indexOf(e.groupName)&&l.createElement("span",{className:e.classes.new},"new"))},A=function(e){var t=e.topic;return l.createElement("a",{href:"#teacher/catalog/"+t.TopicSlug,className:"subMenuItem"+sCH.catalogSubjectSlug},t.TopicName,-1!==t.TopicSlug.indexOf("units-")&&!sCH.userM.isOnPrimePlan()&&l.createElement("span",{className:"icon-lock"}))};t.default=b((function(e){return{dropdownMenuWrapper:{fontSize:16,boxSizing:"border-box",overflowX:"hidden",minWidth:160},popoverMenu:{maxHeight:600},dropdownMenuSectionHeader:{position:"relative",lineHeight:"27px",fontFamily:"Avenir Next LT W02 Demi","&:not(:first-child)":{marginTop:27}},dropdownItem:{lineHeight:"27px","&:hover a":{color:"#03A9F4 !important"},"& a":{display:"block"}},wrapper:{display:"flex",alignItems:"center",overflow:"auto",whiteSpace:"nowrap"},new:{color:"#03a9f4",fontSize:14,lineHeight:1,marginLeft:8,textTransform:"uppercase",fontFamily:"Avenir Next LT W02 Demi"},button:{textTransform:"inherit",fontFamily:"Avenir Next LT W02 Demi",fontSize:20,borderRadius:0,padding:"8px 16px",letterSpacing:"normal",lineHeight:"1.4em",flexShrink:0,"& .icon-dropdown-arrow:before":{fontSize:12,lineHeight:0,marginLeft:5,position:"relative",top:-3},"& .arrow-down":{width:0,height:0,marginLeft:5,borderLeft:"5px solid transparent",borderRight:"5px solid transparent"},"&.disabled":{opacity:.24,pointerEvents:"none"},"&.selected":{borderBottom:"2px solid",borderColor:e.color}},verticalLine:{width:2,height:22,background:"#CFD8DC"},"@media (max-width: 480px)":{button:{"& .foldericon":{"&:before":{lineHeight:1}}}}}}))(S)},,,,,,,,,,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(137),o=n(0),r=n(37),l=n(8),d=n(43),c=n(38),u=n(13),p=u.createMuiTheme,h=u.MuiThemeProvider,g=u.withStyles,f={"news-and-articles":i.lightBlue,ela:i.pink,"social-studies":i.purple,science:i.green,library:i.brown,"my-imports":i.orange},m=function(e){return p({typography:{useNextVariants:!0},color:f[e][500],palette:{primary:f[e]}})},v=function(e){return{button:{textTransform:"inherit",fontFamily:"Avenir Next LT W02 Demi",fontSize:20,borderRadius:0,borderBottom:"solid 2px transparent",padding:"8px 16px",letterSpacing:"normal",lineHeight:"1.4em","&:hover, &.selected":{borderColor:e.color}},tabList:{display:"flex",overflow:"auto"},"@media (max-width: 480px)":{button:{fontSize:16}}}},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={topicBuckets:t.props.topicBuckets,topicBucketSlug:t.props.topicBucketSlug,allCount:t.props.allCount},t.buttons=[],t.handleChange=function(e){if(e!==t.state.topicBucketSlug){var n="all"===e?"":"/"+e;r.replaceBrowserNavigationHistory("#teacher/catalog/"+t.props.topicSlug+n),Backbone.pubEv.trigger("renderTopicTiles",{topicBucketSlug:e}),t.setState({topicBucketSlug:e})}},t}return s(t,e),t.prototype.componentWillMount=function(){Backbone.pubEv.on("topicBucketChanged",this.handleChange)},t.prototype.componentDidUpdate=function(e){l.isEqual(e,this.props)||this.setState({allCount:this.props.allCount,topicBuckets:this.props.topicBuckets})},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("topicBucketChanged")},t.prototype.render=function(){var e=this.state,t=e.topicBuckets,n=e.topicBucketSlug,a=e.allCount,s=this.props,i=s.classes,l=s.subjectName;return!this.props.isUnitsPage&&o.createElement(C,{classes:i,subjectSlug:r.getSlug(l),topicBuckets:t,topicBucketSlug:n,allCount:a,onClick:this.handleChange})},t}(o.Component),C=g(v)((function(e){var t=e.classes,n=e.subjectSlug,a=e.topicBuckets,s=e.topicBucketSlug,i=e.allCount,r=[{TopicBucketName:"All",TopicBucketSlug:"all"}];return a.length>1&&(r=r.concat(a)),o.createElement(h,{theme:m(n)},o.createElement("nav",{className:t.tabList},r.map((function(t,n){var a=0==n?i:t.Texts.length+t.Topics.length;if(a>0){var r=d.mobile?t.TopicBucketName:t.TopicBucketName+" ("+a+")";return o.createElement(y,{key:n,isSelected:s===t.TopicBucketSlug,onClick:function(){return e.onClick(t.TopicBucketSlug)},text:r})}}))))})),y=g(v)((function(e){var t=[e.classes.button,e.isSelected?"selected":""].join(" ");return o.createElement(c.default,{className:t,color:"primary",onClick:e.onClick},e.text)}));t.default=g(v)(b)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(349),r=n(758),l=n(497),d=n(1451),c=n(1452),u=n(490),p=n(39),h=n(38),g=n(48),f=n(759),m=n(20),v=n(13).withStyles,b=n(24),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numOfBYOCInMonth=t.props.numOfBYOCInMonth,t.state={anchorEl:null},t.openMenu=function(e){t.setState({anchorEl:e.currentTarget})},t.closeMenu=function(){t.setState({anchorEl:null})},t.showImportInternetArticle=function(){t.setState({anchorEl:null}),sCH.userM.isOnFreePlan()&&t.numOfBYOCInMonth>=3?g.showBYOCLimitReachedPopup("Import Internet Article"):(delete window.addGoogleDoc,b.showModal(i.createElement(o.default,{title:"Paste the URL of the online article",mode:"internet",numOfBYOCInMonth:t.numOfBYOCInMonth,okText:"Next"})))},t.showImportGoogleDoc=function(){if(t.setState({anchorEl:null}),sCH.userM.isOnFreePlan()&&t.numOfBYOCInMonth>=3)g.showBYOCLimitReachedPopup("Import Google Doc");else{if("undefined"==typeof gapi)return void new Backbone.BootstrapModal({title:"Uh oh!",content:"Sorry, but at this time Google is experiencing issues. Please refresh the page and try again.",okText:"Refresh"}).open((function(){window.location.reload(!0)}));window.addGoogleDoc?window.addGoogleDoc.oauthToken?r.default():(window.addGoogleDoc.callback=r.default,gapi.auth.authorize({client_id:m.default.googleApiClientId,scope:window.addGoogleDoc.scopes,immediate:!1,authuser:-1,user_id:sCH.userM.get("Accounts").google?sCH.userM.get("Accounts").google.ExternalUserId:null},window.addGoogleDoc.handleAuthResult)):f.init(r.default),window.addGoogleDoc.numOfBYOCInMonth=t.numOfBYOCInMonth}},t.showUploadPDF=function(){t.setState({anchorEl:null}),sCH.userM.isOnFreePlan()&&t.numOfBYOCInMonth>=3?g.showBYOCLimitReachedPopup("Upload PDF"):b.showModal(i.createElement(l.default,{title:"Update information for tile",numOfBYOCInMonth:t.numOfBYOCInMonth,okText:"Done",cssClass:"uploadText"}))},t.showCreateQuiz=function(){b.showModal(i.createElement(d.default,null)),t.setState({anchorEl:null})},t.showImportVideoPopup=function(){t.setState({anchorEl:null}),sCH.userM.isOnFreePlan()&&t.numOfBYOCInMonth>=3?g.showBYOCLimitReachedPopup("Import video"):b.showModal(i.createElement(c.default,{numOfBYOCInMonth:t.numOfBYOCInMonth}))},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("textImported",(function(t){!0!==t&&e.numOfBYOCInMonth++})),sCH.userM.get("Accounts").google&&"undefined"!=typeof gapi&&f.init()},t.prototype.render=function(){var e=this.state.anchorEl,t=this.props.classes;return i.createElement("aside",{className:t.tabList},i.createElement(h.default,{"aria-owns":e?"add-content-menu":null,"aria-haspopup":"true",onClick:this.openMenu,className:t.button},"Add Content ",i.createElement("span",{className:"arrow-down",style:{borderTop:"5px solid black"}})),i.createElement(u.default,{id:"add-content-menu",anchorEl:e,open:Boolean(e),className:t.menu,onClose:this.closeMenu,style:{marginTop:55}},i.createElement(p.default,{className:t.menuItem,onClick:this.showImportInternetArticle},"Import Internet article"),i.createElement(p.default,{className:t.menuItem,onClick:this.showImportGoogleDoc},"Import Google Doc"),i.createElement(p.default,{className:t.menuItem,onClick:this.showUploadPDF},"Upload PDF"),i.createElement(p.default,{className:t.menuItem,onClick:this.showCreateQuiz},"Create quiz"),i.createElement(p.default,{className:t.menuItem,onClick:this.showImportVideoPopup},"Import video")))},t}(i.Component);t.default=v((function(e){return{tabList:{display:"flex"},button:{textTransform:"inherit",fontFamily:"Avenir Next LT W02 Demi",fontSize:20,padding:"8px 16px",letterSpacing:"normal",lineHeight:"1.4em","& .arrow-down":{width:0,height:0,marginLeft:5,borderLeft:"5px solid transparent",borderRight:"5px solid transparent"}},menuItem:{fontFamily:"AvenirNextLTW02-Medium"}}}))(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24);t.default=function(e){return a.createElement(s.default,{title:"Most popular sites for web content",cancelText:"Done",okText:null,cssClass:"popularResources",maxWidth:"md"},a.createElement("p",null,"Teachers on Actively Learn most commonly use the following sites to find awesome online content:"),a.createElement("div",{className:"row"},a.createElement("div",{className:"section"},a.createElement("h3",null,"Current Events"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.nytimes.com"},"New York Times")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.cnn.com"},"CNN")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.npr.org"},"National Public Radio (NPR)")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.huffingtonpost.com/"},"Huffington Post")))),a.createElement("div",{className:"section"},a.createElement("h3",null,"For Younger Students"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.timeforkids.com/"},"Time For Kids")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://tweentribune.com/"},"Tween Tribune")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://magazines.scholastic.com/"},"Scholastic News For Your classroom"))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"section"},a.createElement("h3",null,"Stories"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.eastoftheweb.com/"},"East Of The Web")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"https://ebooks.adelaide.edu.au/"},"eBooks @ Adelaide")))),a.createElement("div",{className:"section"},a.createElement("h3",null,"Science"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{target:"_blank",href:"https://www.societyforscience.org/"},"Society for Science")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.livescience.com/"},"Live Science")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.nationalgeographic.com/"},"National Geographic"))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"section"},a.createElement("h3",null,"Poetry"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.poetryfoundation.org/"},"Poetry Foundation")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.poemhunter.com/"},"Poem Hunter")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.poets.org/"},"Poets.org")))),a.createElement("div",{className:"section"},a.createElement("h3",null,"Social Studies"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.history.com/"},"History")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://www.neh.gov/humanities"},"Nat'l Endowment for the Humanities")),a.createElement("li",null,a.createElement("a",{target:"_blank",href:"http://ngm.nationalgeographic.com/"},"National Geographic Magazine"))))),a.createElement("p",null,"These sites are merely suggestions  anything you find on the web can be added. If theres something that you cant find, you can always request a text through our Catalog. Enjoy!"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(39),i=n(34);t.default=function(e){var t=e.genres,n=e.genre,o=e.setGenre;return t.length>0&&a.createElement(i.SelectValidator,{id:"ddlGenres",label:"Genre",fullWidth:!0,value:n,required:!0,onChange:function(e){return o(e.target.value)}},t.map((function(e){return a.createElement(s.default,{key:e.GenreId,value:e.GenreId},e.GenreName)})))}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(24),r=n(10),l=n(5),d=n(276),c=n(34);t.default=function(e){var t=i.useState(""),n=t[0],u=t[1],p=i.useState(null),h=p[0],g=p[1];return i.createElement(o.default,{title:"Create quiz",okText:"Create",okCallback:function(){r.AddQuiz({title:n,skillBucketId:h},(function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return l.intercom("trackEvent","workspace-add-quiz"),l.bootstrap.alert({message:"A quiz has been added to your Imports!"}),Backbone.pubEv.trigger("textImported",!0),o.hideModals(),[2]}))}))}))},disabledOkText:"Creating Quiz..."},i.createElement("p",null,"Please enter the information below to create a quiz."),i.createElement(c.TextValidator,{id:"txtTitle",label:"Title",autoComplete:"off",onChange:function(e){return u(e.target.value)},value:n,required:!0,autoFocus:!0,fullWidth:!0}),i.createElement(d.default,{onChange:function(e){return g(e.target.value)},contentType:h}))}}).call(this,n(21))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=n(10),l=n(0),d=n(34),c=n(13).withStyles,u=n(24),p=n(168),h=n(276),g=n(496),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={videoUrl:"",videoTitle:"",videoMetadata:null,skillBucketId:"",validVideoUrl:null},t.isValidUrl=function(e){var n=p.parseYouTubeUrl(e);if(n)p.handleYouTubeUrl(n,t.onValidUrl,t.onInvalidUrl);else if(n=p.parseGoogleDriveVideoUrl(e))p.handleGoogleDriveVideoUrl(n,t.onValidUrl,t.onInvalidUrl);else if(e.length>4)return!1;return!0},t.onValidUrl=function(e){!t.state.validVideoUrl&&e.validVideoUrl&&t.modalRef.enableOkButton(),t.setState(e)},t.onInvalidUrl=function(){return t.setState({validVideoUrl:null,videoTitle:"",videoMediaMetadata:null})},t.handleURLChange=function(e){var n=e.target.value;t.modalRef.disableOkButton(),t.setState({videoUrl:n,videoTitle:"",videoMetadata:null,validVideoUrl:null})},t.handleTitleChange=function(e){t.setState({videoTitle:e.target.value})},t.handleSkillBucketChange=function(e){t.setState({skillBucketId:e.target.value})},t.submit=function(){t.state.validVideoUrl&&r.ImportVideo(i(i({url:t.state.validVideoUrl,title:t.state.videoTitle},t.state.videoMetadata),{skillBucketId:t.state.skillBucketId}),(function(){o.intercom("trackEvent","workspace-import-video"),o.bootstrap.alert({message:"A video has been added to your Imports!"}),Backbone.pubEv.trigger("textImported"),u.hideModals()}))},t}return s(t,e),t.prototype.render=function(){var e=this,t=this.props.classes;return l.createElement(u.default,{title:"Paste a YouTube or Google Drive video URL",okText:"Submit",okCallback:this.submit,allowCancel:!1,customValidations:[{name:"isValidUrl",func:this.isValidUrl}],disabledOkText:"Adding Video...",onOpenCallback:function(t){t.disableOkButton(),e.modalRef=t}},l.createElement("p",{className:t.infoText},"Learn how to get the video URL and set permissions",l.createElement("a",{href:alcfg.helpArticleLink.importVideos,className:"infoLink"},"here"),"."),l.createElement(d.TextValidator,{name:"videoUrl",id:"videoUrl",label:"Video URL",autoComplete:"off",placeholder:"ex. https://www.youtube.com/watch?v=I74EWeVsV1M",onChange:this.handleURLChange,value:this.state.videoUrl,validators:{isValidUrl:"Not a valid video URL!"},required:!0,autoFocus:!0,fullWidth:!0}),l.createElement(d.TextValidator,{name:"title",id:"videoTitle",label:"Title",autoComplete:"off",value:this.state.videoTitle,onChange:this.handleTitleChange,required:!0,fullWidth:!0}),l.createElement(h.default,{contentType:this.state.skillBucketId,onChange:this.handleSkillBucketChange}),l.createElement(g.default,{numOfBYOCInMonth:this.props.numOfBYOCInMonth,isVisible:sCH.userM.isOnFreePlan()}))},t}(l.Component);t.default=c((function(){return{button:{fontFamily:"Avenir Next LT W02 Demi",fontSize:16},infoText:{fontSize:16,fontFamily:"AvenirNextLTW02-Medium",marginTop:0}}}))(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24),i=n(1454),o=n(13).withStyles;function r(){s.showModal(a.createElement(i.default,null))}t.default=o({expiryAlertContainer:{background:"#03a9f4",color:"white",padding:"16px",fontSize:"16px",fontFamily:"Avenir Next LT W02 Demi",display:"flex",position:"relative"},alertText:{flex:"1",textAlign:"center"},closeButton:{fontSize:"30px",opacity:"1",color:"#FFF",marginTop:"-8px"},learnMoreLink:{color:"white",textDecoration:"underline"}})((function(e){var t=e.classes,n=e.hideCovidPrimeExpiryAlert;return a.createElement("div",{className:t.expiryAlertContainer},a.createElement("span",{className:t.alertText},"Premium access expires July 31st.",a.createElement("a",{className:t.learnMoreLink,onClick:r},"Learn more"),"."),a.createElement("button",{className:"close "+t.closeButton,type:"button","data-dismiss":"alert",onClick:n},a.createElement("span",{"aria-hidden":"true"},""),a.createElement("span",{className:"sr-only"})))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24),i=n(14),o=n(13).withStyles;t.default=o({featureList:{listStyleType:"initial",paddingLeft:"40px"},emailTemplateLink:{color:"#03A9F4"},modalContentWrapper:{padding:"20px"},purchaseCallout:{fontFamily:"Avenir Next LT W02 Bold !important"},noMarginBottom:{marginBottom:"0"},noMarginTop:{marginTop:"0"}})((function(e){var t=e.classes;return a.createElement(s.default,{title:"Premium access expires July 31st",okText:"Close",cancelText:"",maxWidth:"md",allowCancel:!1,cssClass:t.modalContentWrapper},a.createElement("p",null,"In March, we turned on free access to Actively Learn premium to support all teachers and students in their transition to remote learning. Were happy that youve been able to take advantage of this offer and have been grateful for the positive feedback."),a.createElement("p",{className:t.noMarginBottom},"We will be transitioning temporary premium accounts to free accounts on July 31st. You will still have access to your classes and assignments, but you will lose access to:"),a.createElement("ul",{className:t.featureList},a.createElement("li",null,"Student, class, and assignment data"),a.createElement("li",null,"Unlimited text and video uploads"),a.createElement("li",null,"Scaffolding and differentiation to support students with grade-level reading"),a.createElement("li",null,"Sequenced curriculum to provide a full year of instruction"),a.createElement("li",null,"Ability to print assignments to support students who dont have internet access"),a.createElement("li",null,"Teacher collaboration (sharing, co-authoring)")),a.createElement("p",{className:t.noMarginTop},"For a full list of free and premium features, check out our",a.createElement("a",{rel:"noopener",className:t.emailTemplateLink,href:"https://www.activelylearn.com/plans",target:"_blank"},"plans page"),"."),a.createElement("p",{className:t.purchaseCallout},"Act now to secure a premium license"),a.createElement("p",null,"Actively Learn premium is designed to be implemented by departments, schools, and districts. If you wish to keep your premium access, let your principal, department head, or another administrator in your district know!",a.createElement("a",{target:"_blank",className:t.emailTemplateLink,href:"mailto:?subject="+encodeURIComponent("Actively Learn for our teachers")+"&body="+encodeURIComponent(i.covidPrimeExpiryEmailBody)},"Click here"),"for an email template you can use to reach out to your administrator."),a.createElement("p",null,"If your school or district has already purchased Actively Learn for next year, please disregard this message."))}))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=t.props.data,t.tileUpdated=function(e){t.setState(e)},t}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.linkObj,n=e.tiles,a=e.category,s=e.isTopicTileBucket,r=s?n.slice(0,4).map((function(e){return o.sanitize(e.ImageUrl)})):n.slice(0,4).map((function(e){return o.sanitize(e.CoverArt)})),l=o.classNames({tile:!s,topictile:s,tileViewMore:!0});return i.createElement("a",{className:l,href:"javascript:void(0)",onClick:function(){t.topicBucketSlug?Backbone.pubEv.trigger("topicBucketChanged",t.topicBucketSlug):window.location.hash=t.topicUrl},tabIndex:0},i.createElement("div",{className:"wrapper"},"View More ",a),i.createElement("div",{className:"mosaic"},r.map((function(e,t){return i.createElement("div",{className:"partImage",style:{backgroundImage:"url("+e+")"},key:t})}))))},t}(i.Component);t.default=r},,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},l=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var d=n(0),c=n(11),u=n(342),p=n(762),h=n(8),g=n(200),f=n(764),m=n(14),v=n(132),b=n(88),C=n(1479),y=n(5),_=n(499),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAnonUser=sCH.userM.isAnonUser(),t.topicName="My Workspace",t.workspaceData={},t.containerRef=d.createRef(),t.state={tileComponent:null,folderComponent:null},t.fetchData=function(){return o(t,void 0,void 0,(function(){var e,t;return r(this,(function(n){switch(n.label){case 0:return e=this,[4,b.getWorkspaceFoldersAndLayers(this.props)];case 1:return e.workspaceData=n.sent(),t={tileComponent:this.getTileComponent()},this.props.isInitialLoad&&(t.folderComponent=this.getFolderComponent()),this.setState(t),b.updateFilterInQueryParams(),[2]}}))}))},t.filtersChanged=function(){t.setState({tileComponent:t.getTileComponent()}),b.updateFilterInQueryParams()},t.getTileComponent=function(){var e=l(t.workspaceData.layers);if(e&&e.length>0){var n=b.filterTopicTexts(e,t.topicName,sCH.catalogSelectedGradeLevels,sCH.catalogSelectedLexiles,sCH.catalogSelectedStandardIds);if(0===n.length){var a=t.workspaceData.subFolderLength?y.plural(t.workspaceData.subFolderLength,"%count subfolder","%count subfolders"):"everything"===t.props.selectedFolderFilter?"Nothing here yet! Once you assign or customize assignments, anything you use will show up here.":"Nothing here!";return d.createElement(f.default,{message:d.createElement("span",null,a)})}var s="savedforlater"===t.props.selectedFolderFilter?m.Page.CATALOG:m.Page.WORKSPACE;return d.createElement(v.default,{key:Math.random(),page:s,tiles:n,areTilesDraggable:s===m.Page.WORKSPACE})}return d.createElement(f.default,{message:d.createElement("span",null,"Nothing here!")})},t.updateFolderToggleState=function(e){if(!t.props.selectedFolderFilter&&t.props.selectedFolderId){var n=h.find(e,{FolderId:t.props.selectedFolderId});if(n){n.active=!0;var a=_.getAncestorFolders(e,t.props.selectedFolderId);h.forEach(a,(function(e){return e.toggled=!0}))}else window.location.hash="#teacher/catalog/my-folders/everything"}},t.getFolderComponent=function(){var e=[{FolderId:-1,Title:"My folders",toggled:!0}].concat(t.workspaceData.folders||[]);return t.updateFolderToggleState(e),d.createElement(C.default,{folders:e,selectedFolderId:t.workspaceData.dontUseSelectedFolderId?void 0:t.props.selectedFolderId,selectedFolderFilter:t.props.selectedFolderFilter,isOnMyFolderPage:!0})},t.unsavedForLater=function(e){"savedforlater"===t.props.selectedFolderFilter&&$("a[data-learnentityid='"+e.learnEntityId+"']").remove()},t.myFoldersTextRemoved=function(e){e.inFilteredFolder||(t.containerRef.current.querySelector("a[data-layerid='"+e.layerId+"']")&&t.containerRef.current.querySelector("a[data-layerid='"+e.layerId+"']").remove(),t.workspaceData.layers=t.workspaceData.layers.filter((function(t){return t.LayerId!==e.layerId})))},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("filterMyFolderTiles",this.filtersChanged),Backbone.pubEv.on("unsavedForLater",this.unsavedForLater),Backbone.pubEv.on("myFoldersTextRemoved",this.myFoldersTextRemoved),$(".layout").addClass("folderView"),this.isAnonUser||this.fetchData()},t.prototype.componentDidUpdate=function(e){e.isInitialLoad===this.props.isInitialLoad&&e.selectedFolderId===this.props.selectedFolderId&&e.selectedFolderFilter===this.props.selectedFolderFilter||this.fetchData()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("filterMyFolderTiles"),Backbone.pubEv.off("unsavedForLater"),Backbone.pubEv.off("myFoldersTextRemoved"),$(".layout").removeClass("folderView")},t.prototype.render=function(){var e={subjectsAndTopics:h.groupBy(sCH.catalogSubjectsAndTopics,"SubjectName"),selectedGradeLevels:sCH.catalogSelectedGradeLevels,selectedLexiles:sCH.catalogSelectedLexiles,selectedStandardIds:sCH.catalogSelectedStandardIds,topicName:this.topicName},t=document.getElementById("theScroll");return d.createElement(d.Fragment,null,d.createElement(g.default,i({},e)),c.createPortal(d.createElement("div",{className:"flex",ref:this.containerRef},this.isAnonUser?d.createElement(f.default,{message:d.createElement(w,null),screenshotUrl:"/img/Content_MyWorkspace.png"}):d.createElement(d.Fragment,null,this.state.folderComponent&&this.state.folderComponent,this.state.tileComponent&&d.createElement("div",{className:"tileView"},this.state.tileComponent))),t))},t}(d.Component);t.default=u.DragDropContext(p.default)(S);var w=function(){return d.createElement("p",null,d.createElement("a",{className:"callout",href:"/account.html#/signup/educator/step1"},"Sign Up")," or",d.createElement("a",{className:"callout",href:"/account.html"},"Log In"),"to access the Workspace, a place for you to manage, customize and share all of your assignments!")}}).call(this,n(21))},,,,,,,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(0),r=n(10),l=n(14),d=n(765),c=n(5),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onLayerMoved=function(e,t,a,s){if(-1!==t){var i="UserLayer"!==a;i&&s?c.bootstrap.alert({message:"Please purchase the text first!",alert:"danger"}):r.MoveLayerToFolder({layerId:e,oldFolderId:n.state.selectedFolderId||-1,newFolderId:t,shouldCopyLayer:i,newLayerSource:i?0===window.location.hash.indexOf("#teacher/catalog/library")?"AddFromSchoolLibrary":"AddFromCatalog":void 0},(function(t){c.bootstrap.alert({message:"Added assignment to folder!"}),i||Backbone.pubEv.trigger("myFoldersTextRemoved",{layerId:e,inFilteredFolder:n.state.selectedFolderFilter})}))}},n.onFolderSelected=function(e){n.props.isOnMyFolderPage?(Backbone.router.navigate("teacher/catalog/my-folders/"+e,{trigger:!1}),Backbone.pubEv.trigger("renderMyFolderView",{selectedFolderId:e}),n.setState({selectedFolderId:e,selectedFolderFilter:null})):window.location.hash="#teacher/catalog/my-folders/"+e},n.renderFolderFilter=function(e){n.props.isOnMyFolderPage?(Backbone.router.navigate("teacher/catalog/my-folders/"+e,{trigger:!1}),Backbone.pubEv.trigger("renderMyFolderView",{selectedFolderId:-1,selectedFolderFilter:e}),Backbone.pubEv.trigger("makeSelectedFolderInactive"),n.setState({selectedFolderId:null,selectedFolderFilter:e})):window.location.hash="#teacher/catalog/my-folders/"+e},n.workspaceFolderRemoved=function(e){var t=n.state.folders.filter((function(t){return t.FolderId!==e}));n.setState({folders:t})},n.state={selectedFolderId:n.props.selectedFolderFilter?null:n.props.selectedFolderId,selectedFolderFilter:n.props.selectedFolderFilter,folders:n.props.folders},n}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("workspaceFolderRemoved",this.workspaceFolderRemoved)},t.prototype.componentDidUpdate=function(e){i.isEqual(e,this.props)||this.setState({selectedFolderId:this.props.selectedFolderFilter?null:this.props.selectedFolderId,selectedFolderFilter:this.props.selectedFolderFilter,folders:this.props.folders})},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("workspaceFolderRemoved"),$(".layout").removeClass("folderView")},t.prototype.render=function(){return o.createElement(d.default,{page:l.Page.WORKSPACE,folders:this.state.folders,selectedFolderId:this.state.selectedFolderId,renderFolderFilter:this.renderFolderFilter,customProps:{onFolderSelected:this.onFolderSelected,onLayerMoved:this.onLayerMoved,rootFolderId:-1,folderList:this.state.folders},selectedFolderFilter:this.state.selectedFolderFilter,canManage:!0,showHandyTabs:!0})},t}(o.Component);t.default=u},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(24),o=n(10),r=n(5),l=n(8),d=n(492);t.default=function(e){var t=e.title,n=e.okText,c=e.folderId,u=e.cssClass,p=void 0===u?"":u,h=e.allowCancel,g=void 0===h||h,f=s.useState({coauthors:[],folderOwnerId:null,colleagues:[]}),m=f[0],v=f[1],b=s.useState([]),C=b[0],y=b[1],_=s.useState(!1),S=_[0],w=_[1],T=l.sortBy(m.coauthors,"HasFolderWriteAccess","desc"),I=m.coauthors.map((function(e){return e.UserId})),x=m.colleagues.filter((function(e){return-1===I.indexOf(e.UserId)}));function k(e){Backbone.pubEv.trigger("FolderAuthorsUpdated",e)}return s.useEffect((function(){o.GetFolderCoauthors({folderId:c},(function(e){v(e),w(!0)}))}),[]),S&&s.createElement(d.default,{modalTitle:t,okText:n,disabledOkText:"Adding...",allowCancel:g,cssClass:p,optionButtons:[{text:"Learn More",callback:function(){return r.windowOpen(alcfg.helpArticleLink.coauthorFolder,"_blank")}}],okCallback:function(e){C.length>0&&o.AddFolderCoauthors({folderId:c,userIds:C},(function(e){r.bootstrap.alert({message:"Co-authors added will be notified via email."}),k(e),i.hideModals()}),(function(t){if(t.length>0){var n=t.map((function(e){return m.colleagues.find((function(t){return t.UserId===e})).FullName})),a="Unable to add any co-author. Teachers who are not on Prime plan cannot be added as co-authors. The following "+r.plural(n,"teacher is","teachers are")+" not on the Prime plan: "+n.join(", ")+".";r.bootstrap.alert({message:a,alert:"danger",autoClose:!1}),e.enableOkButton("Add")}}))},header:"Co-authoring a folder allows multiple teachers to view, add and edit assignments.",users:x,currentAuthors:T,removeCoauthor:function(e){var t=$(e.currentTarget).data("userid"),n=t===sCH.userM.get("UserId");i.showModal(s.createElement(i.default,{title:"Remove co-author?",okText:"Remove "+(n?"Self":"Co-author"),okCallback:function(){return function(e,t){o.RemoveFolderCoauthor({userId:e,folderId:c},(function(n){var s=T.find((function(t){return t.UserId===e})).FullName;r.bootstrap.alert({message:s+" has been removed as co-author for this folder."}),k(n),v(a(a({},m),{coauthors:m.coauthors.filter((function(t){return t.UserId!==e}))})),t&&i.hideModals(),i.hideModals()}))}(t,n)}},"Are you sure you want to remove ",n?"yourself":"this teacher"," as a co-author?"))},selectedUserIds:C,noSelectionMsg:"Please select 1 or more colleagues to co-author this folder with!",setSelectedUserIds:y,hasPermissionToRemoveCoAuthor:function(e){var t=sCH.userM.get("UserId"),n=m.coauthors[0].UserId===t;return!e.HasFolderWriteAccess&&(n||e.UserId===t)},noUserText:"Currently, no other teachers at your school are on the Prime plan. Get a coworker to create an account and then add them as a co-author here."})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){function t(t,n){return e.call(this,t)||this}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.onClick,n=e.onToggle;return i.createElement("div",{className:"folder "+(this.props.data.active?"selected":"")},i.createElement(r,{hasSubfolders:void 0!==this.props.data.children,isToggled:this.props.data.toggled,onToggle:n}),i.createElement("div",{className:"inner",onClick:t},i.createElement("span",{className:"icon-folder"}),i.createElement("div",{className:"label"},this.props.data.Title)))},t}(i.Component);t.default=o;var r=function(e){var t=e.hasSubfolders,n=e.isToggled,a=e.onToggle;return t?n?i.createElement("div",{className:"toggler icon-dropdown-arrow",onClick:a}):i.createElement("div",{className:"toggler icon-dropdown-arrow closed",onClick:a}):i.createElement("div",{className:"toggler empty"})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(342),r=n(499),l=n(5),d=n(65),c={drop:function(e,t,n){var a=t.getItem();if(a.folderId!==e.data.FolderId){var s,i=!1,o=!1;-1===window.location.href.indexOf("library")&&(i=e.data.coauthors&&e.data.coauthors.length>1,a.folderId&&(o=(s=e.customProps.folderList.find((function(e){return e.FolderId===a.folderId}))).coauthors&&s.coauthors.length>1));var l=function(){e.customProps.onLayerMoved(a.layerId,e.data.FolderId,a.layerType,a.rentalPrices)};if(o||i){var d=r.getFolderCoauthorsName(o?s.coauthors:e.data.coauthors),c=o?"Move assignment from co-authored folder?":"Move assignment to co-authored folder?",u=o?"The folder this assignment is being moved from is co-authored with "+d+". \n          They will not be able to access the assignment if you move it.":"The folder this assignment is being moved to is co-authored with "+d+". \n          They will be able to access the assignment if you move it.";new Backbone.BootstrapModal({title:c,content:u,okText:"Move",cssClass:"modal-al-move-layer"}).open((function(){l()}),(function(){}))}else l()}}},u={drop:function(e,t,n){var a=t.getItem().folderId,s=t.getItem().coauthors,i=e.data.FolderId;if(a!==i&&(a!==e.rootFolderId&&e.customProps.onFolderMoved(a,i)&&s&&s.length>1)){r.getFolderCoauthorsName(s);l.bootstrap.alert({message:"The folder has been moved to the new location and is still being co-authored."})}}},p={beginDrag:function(e){return e.data.HasFolderWriteAccess||"library"===e.data.Type&&sCH.userM.hasManageLibraryPermissions()?{folderId:e.data.FolderId,coauthors:e.data.coauthors}:(l.bootstrap.alert({message:"As a co-author, you do not have access to move this folder.",alert:"warning"}),{})}},h=function(e){function t(t,n){var a=e.call(this,t)||this;return a.add=function(e){e.stopPropagation(),a.props.customProps.onFolderAdded()},a.edit=function(e){e.stopPropagation(),a.props.customProps.onFolderEdited(a.props.data.FolderId)},a.addCoauthors=function(e){e.stopPropagation(),a.props.customProps.openFolderCoauthorPopup(a.props.data.FolderId)},a}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.rootFolderId,n=e.onClick,a=e.onToggle,s=e.canDrop,o=e.isOver,r=e.canDropFolder,l=e.isOverFolder,d=e.connectDragSource,c=e.connectDropTarget,u=e.connectDropTargetFolder,p=this.props.data.FolderId===t,h=-1===this.props.data.FolderId,v="";return s&&o||r&&l?v="blueBorder":(s||r)&&(v="pinkBorder"),d(c(u(i.createElement("div",{className:"folder "+v+" "+(this.props.data.active?"selected":""),"data-folderid":this.props.data.FolderId},i.createElement(g,{hasSubfolders:void 0!==this.props.data.children,isToggled:this.props.data.toggled,onToggle:a}),i.createElement("div",{className:"inner",onClick:h?null:n},!h&&i.createElement(m,{coauthors:this.props.data.coauthors}),i.createElement("div",{className:"label "+(h?"isheading":"")},this.props.data.Title),i.createElement(f,{scope:this,canAdd:p,canEdit:!p&&("workspace"===this.props.data.Type||"library"===this.props.data.Type&&sCH.userM.hasManageLibraryPermissions()),canShare:!p&&"workspace"===this.props.data.Type}))))))},t}(i.Component),g=function(e){var t=e.hasSubfolders,n=e.isToggled,a=e.onToggle;return t?n?i.createElement("div",{className:"toggler icon-dropdown-arrow",onClick:a}):i.createElement("div",{className:"toggler icon-dropdown-arrow closed",onClick:a}):i.createElement("div",{className:"toggler empty"})},f=function(e){var t=e.canAdd,n=e.canEdit,a=e.canShare,s=e.scope;return t?i.createElement("button",{className:"icon-plus",onClick:s.add}):n||a?i.createElement("div",{className:"actions"},a?i.createElement(d.default,{title:"Co-author"},i.createElement("button",{className:"icon-people","data-container":"body",onClick:s.addCoauthors})):"",n&&i.createElement(d.default,{title:"Edit"},i.createElement("button",{className:"icon-pencil","data-container":"body",onClick:s.edit}))):null},m=function(e){var t=e.coauthors;if(t&&t.length>1){var n=r.getFolderCoauthoringTooltipText(t);return i.createElement(d.default,{title:n},i.createElement("span",{className:"icon-folder-people folder-icon","data-container":"body"}))}return i.createElement("span",{className:"icon-folder folder-icon"})},v=o.DropTarget("Tile",c,(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()}})),b=o.DropTarget("Folder",u,(function(e,t){return{connectDropTargetFolder:e.dropTarget(),isOverFolder:t.isOver(),canDropFolder:t.canDrop()}})),C=o.DragSource("Folder",p,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}));t.default=C(b(v(h)))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(24),i=n(34);t.default=function(e){var t=e.title,n=e.okText,o=e.activeFolderName,r=void 0===o?"":o,l=e.folderName,d=void 0===l?"":l,c=e.okCallback,u=e.canDelete,p=void 0!==u&&u,h=e.cssClass,g=void 0===h?"":h,f=e.onFolderDeleted,m=void 0===f?function(){}:f,v=a.useState(d),b=v[0],C=v[1];return a.createElement(s.default,{okText:n,title:t,okCallback:function(){c(b),s.hideModals()},cssClass:g,optionButtons:p?[{text:"Delete folder",callback:m}]:void 0},!d&&a.createElement("p",null,"This folder will be added under ",r,"."),a.createElement(i.TextValidator,{name:"txtTitle",id:"txtTitle",label:"Folder Name (Max-length 50)",value:b,onChange:function(e){return C(e.target.value)},inputProps:{maxLength:50},required:"Please enter a name for the folder",autoFocus:!0,fullWidth:!0}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(11),c=n(14),u=n(279),p=n(132),h=n(350),g=n(88),f=n(1539),m=n(8),v=n(5),b=n(22),C=n(495),y=n(200),_=50,S=500,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=l.createRef(),t.pageNumber=0,t.tiles=[],t.libraryTiles=[],t.topics=[],t.myImportsTiles=[],t.isFetchingCurrentSubject=!0,t.totalTextsFetched=0,t.subjectsSlugsToFetch=[sCH.catalogSubjectSlug],t.subjectSlugsToExclude=[],t.isScrolledToBottom=!1,t.state={tileComponent:null,displayLoading:!1,displayEndOfResults:!1},t.switchSubjectsToFetch=function(){t.pageNumber=0,t.isFetchingCurrentSubject=!1,t.subjectsSlugsToFetch=sCH.userM.get("AllowedSubjectSlugs").filter((function(e){return e!==sCH.catalogSubjectSlug})),t.subjectSlugsToExclude=[sCH.catalogSubjectSlug]},t.resetPagingState=function(){t.pageNumber=0,t.isFetchingCurrentSubject=!0,t.totalTextsFetched=0,t.subjectsSlugsToFetch=[sCH.catalogSubjectSlug],t.subjectSlugsToExclude=[]},t.fetchAndRenderData=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),o(t,void 0,void 0,(function(){var t,a,s=this;return r(this,(function(i){switch(i.label){case 0:return n||this.resetPagingState(),[4,g.search({query:this.props.query||void 0,directlyFromUrl:e,fromPaging:n,pageNumber:this.pageNumber,subjectSlugs:this.subjectsSlugsToFetch,subjectSlugsToExclude:this.subjectSlugsToExclude})];case 1:return(t=i.sent())&&(0===t.LibraryResults.length&&0===t.MyEverythingResults.length&&0===t.TextResults.length&&0===t.TopicResults.length&&0===this.pageNumber&&this.isFetchingCurrentSubject?this.updateTileComponent(l.createElement(T,{showRequestText:this.showRequestText,redirectToMyImport:this.redirectToMyImport,clearFilters:this.clearFilters})):(this.totalTextsFetched+=t.TextResults.length,0===this.pageNumber&&this.isFetchingCurrentSubject?(this.tiles=t.TextResults,this.libraryTiles=t.LibraryResults,this.myImportsTiles=t.MyEverythingResults,this.topics=t.TopicResults,this.updateTileComponent(this.getTileComponent()),$("html").animate({scrollTop:0},"500","swing"),this.setState({displayEndOfResults:!1})):(this.tiles=this.tiles.concat(t.TextResults),this.updateTileComponent(this.getTileComponent())),0===t.TextResults.length&&this.isFetchingCurrentSubject&&(this.switchSubjectsToFetch(),this.isLoadingSearch(),this.fetchAndRenderData(!1,!0)),this.totalTextsFetched>=S-_||t.TextResults.length<_&&!this.isFetchingCurrentSubject?this.displayEndOfResults():(a=$(window),t.TextResults.length<_?this.switchSubjectsToFetch():this.pageNumber++,this.isScrolledToBottom=!1,a.on("scroll",m.debounce((function(){!s.isScrolledToBottom&&a.scrollTop()+a.innerHeight()>document.body.scrollHeight-100&&(s.isScrolledToBottom=!0,a.off("scroll"),s.isLoadingSearch(),s.fetchAndRenderData(!1,!0))}),200)))),g.updateFilterInQueryParams()),this.props.directlyFromUrl&&this.props.query&&Backbone.pubEv.trigger("searchPerformed",this.props.query),g.areFiltersBeingUsed()&&v.shouldShowJoyride("HowToRefineSearchResult")&&($("#joyride")&&$("#joyride").length>0&&b.unmountReactComponent($("#joyride")[0]),I(),v.updateDoNotShowPopupSetting("HowToRefineSearchResult")),Backbone.pubEv.trigger("navigatedToSearch"),[2]}}))}))},t.getTileComponent=function(){var e=t.myImportsTiles,n=t.libraryTiles,a=t.topics,s=t.tiles;return l.createElement("div",{id:"tileListWrapper"},e.length>0&&l.createElement("div",null,l.createElement("div",{className:"featured"},"From My Workspace"),l.createElement("ul",{className:"tiles"},l.createElement(p.default,{page:c.Page.WORKSPACE,tiles:e}))),n.length>0&&l.createElement("div",null,l.createElement("div",{className:"featured"},"From District Library"),l.createElement("ul",{className:"tiles"},l.createElement(p.default,{page:c.Page.LIBRARY,tiles:n}))),a.length>0&&l.createElement(h.default,{bucketTitle:"From Actively Learn: Topics",tiles:a,isTopicTileBucket:!0,shouldShowCarousel:!0}),l.createElement("div",{className:"featured"},"From Actively Learn: Texts and Videos"),l.createElement(p.default,{page:c.Page.CATALOG,tiles:s}))},t.updateTileComponent=function(e){t.setState({tileComponent:e,displayLoading:!1})},t.showRequestText=function(){new Backbone.BootstrapModal({title:"Request text",content:new f.default,cssClass:"modal-al-request-text",allowCancel:!1,okText:"Submit"}).open()},t.clearFilters=function(){Backbone.pubEv.trigger("clearCatalogFilters")},t.redirectToMyImport=function(){location.href="#teacher/catalog/my-imports"},t.isLoadingSearch=function(){t.setState({displayLoading:!0})},t.displayEndOfResults=function(){t.setState({displayEndOfResults:!0})},t}return s(t,e),t.prototype.componentDidMount=function(){this.fetchAndRenderData(this.props.directlyFromUrl,this.props.fromPaging)},t.prototype.componentDidUpdate=function(e){m.isEqual(e,this.props)||this.fetchAndRenderData(this.props.directlyFromUrl,this.props.fromPaging)},t.prototype.render=function(){var e={subjectsAndTopics:m.groupBy(sCH.catalogSubjectsAndTopics,"SubjectName"),selectedGradeLevels:sCH.catalogSelectedGradeLevels,selectedLexiles:sCH.catalogSelectedLexiles,selectedStandardIds:sCH.catalogSelectedStandardIds,topicName:"Homepage"},t=document.getElementById("theScroll");return l.createElement(l.Fragment,null,l.createElement(y.default,i({},e)),d.createPortal(l.createElement("div",{className:"tileView",style:{display:"flex",flexDirection:"column"}},this.state.tileComponent,this.state.displayLoading&&l.createElement("div",{className:"textsLoadingSpinner"}),this.state.displayEndOfResults&&l.createElement("div",{className:"clearBoth",style:{marginBottom:30}},l.createElement(u.default,{big:!0,text:"End of results"}))),t))},t}(l.Component);t.default=w;var T=function(e){var t=e.showRequestText,n=e.clearFilters,a=e.redirectToMyImport;return l.createElement("div",{className:"ctaInfo"},l.createElement("p",null,"We couldn't find what you were looking for!"),l.createElement("p",null,"Browse by subject using the drop-down menus above, or try one of these next steps:"),g.areFiltersBeingUsed()&&l.createElement("button",{className:"btn-box",onClick:n},"Clear filters"),l.createElement("button",{className:"btn-box",onClick:a},"Import my own"),l.createElement("button",{className:"btn-box btnRequestText",onClick:t},"Request a text"))},I=function(){b.mountReactComponent(C.default,$("#joyride")[0],{steps:[{target:"#catalogNav",content:"Use topics to narrow your results and find exactly what you are looking for.",placement:"bottom",disableBeacon:!0},{target:".siteSectionSearch",content:"Or, search the filtered results by title, author or topic.",placement:"bottom",disableBeacon:!0}]})}}).call(this,n(21))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({template:n(1540),initialize:function(){this.on("ok",this.requestText)},render:function(){return this.$el.html(this.template()),this},requestText:function(e){e.preventClose();var t=this.$el.find(".txtTitle"),n=this.$el.find(".txtAuthor"),i=this.$el.find(".txtAnonName"),o=this.$el.find(".txtAnonEmail");if(!(a.checkRequiredFields([t,n,i,o])>0)){var r={title:t.val(),author:n.val(),extra:$(".txtExtra").val(),anonName:i.length>0?i.val():void 0,anonEmail:o.length>0?o.val():void 0};e.disableOk("Submitting..."),s.RequestText(r,(function(t){e.close(),t?a.bootstrap.alert({message:"Thank you for your request. Our Content team will notify you if and when we are able to add this text to the Catalog!",autoClose:!1}):a.bootstrap.alert({message:"Unable to process your text request. If this problem persists, please contact Actively Learn."})}))}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<p>Can't find what you're looking for? Request a text here and we'll do our best to add it to Actively Learn!</p>\r\n",sCH.userM.isAnonUser()&&(__p+='\r\n  <input class="txtAnonName" placeholder="Your name" maxlength="50" />\r\n  <input class="txtAnonEmail" placeholder="Your email" maxlength="50" />\r\n'),__p+='\r\n<input class="txtTitle" placeholder="Title" maxlength="256" />\r\n<input class="txtAuthor" placeholder="Author" maxlength="256" />\r\n\x3c!--<input class="txtPublisher" placeholder="Publisher (optional)"/>\r\n<input class="txtEdition" placeholder="Edition (optional)"/>--\x3e\r\n<input class="txtExtra" placeholder="Additional Information (optional)" maxlength="256"/>';return __p}},function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(11),c=n(8),u=n(200),p=n(14),h=n(88),g=n(350),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.topicName=null,t.subjectName=null,t.topicBucketSlug=null,t.buckets=[],t.state={tileComponent:null,topicBuckets:[],allCount:null},t.fetchData=function(){return o(t,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,h.getCatalogTopicData(this.props.topicSlug)];case 1:return e=t.sent(),this.subjectName=e.SubjectName,this.topicName=e.TopicName,this.buckets=e.Buckets,this.getTileComponent(this.props),[2]}}))}))},t.getTileComponent=function(e){var n=e.topicBucketSlug;n&&(t.topicBucketSlug=n);var a=t.filterItems(),s=a.numFilteredItems,i=a.filteredBuckets;if("all"!==t.topicBucketSlug&&m(i,s,t.topicBucketSlug))Backbone.pubEv.trigger("topicBucketChanged","all");else{var o=null;if(0===s)Backbone.tracking.trackGAEvent("catalog:intopic-notexts",t.topicName+" - "+sCH.catalogSelectedGradeLevels.join(",")+" - "+sCH.catalogSelectedLexiles.join(",")+" - "+sCH.catalogSelectedStandardIds.join(",")),o=l.createElement("span",{className:"ctaInfo"},"No texts with the selected filters!");else{var r="all"===t.topicBucketSlug?i:i.filter((function(e){return e.TopicBucketSlug===t.topicBucketSlug})),d=r.map((function(e){var n=e.Topics.length>0,a=r.length>1?{topicBucketSlug:e.TopicBucketSlug}:void 0;return l.createElement(g.default,{key:e.TopicBucketId,bucketTitle:e.TopicBucketName,page:p.Page.CATALOG,tiles:n?e.Topics:e.Texts,isTopicTileBucket:n,viewMoreLinkObj:a,shouldShowCarousel:"all"===t.topicBucketSlug&&r.length>1})}));o=l.createElement("div",null,d)}t.setState({allCount:s,topicBuckets:i,tileComponent:o}),h.updateFilterInQueryParams()}},t.filterItems=function(){for(var e=0,n=[],a=0,s=t.buckets;a<s.length;a++){var o=s[a],r=h.filterTopicTexts(o.Texts,t.topicName,sCH.catalogSelectedGradeLevels,sCH.catalogSelectedLexiles,sCH.catalogSelectedStandardIds);e+=r.length+o.Topics.length,n.push(i(i({},o),{Texts:r}))}return{numFilteredItems:e,filteredBuckets:n}},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("renderTopicTiles",(function(t){e.getTileComponent(t||{})})),this.fetchData()},t.prototype.componentDidUpdate=function(e){c.isEqual(e,this.props)||this.fetchData()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("renderTopicTiles")},t.prototype.render=function(){if(this.state.tileComponent){var e={subjectName:this.subjectName,topicName:this.topicName,topicBucketSlug:this.props.topicBucketSlug,topicSlug:this.props.topicSlug,topicBuckets:this.state.topicBuckets,allCount:this.state.allCount},t=document.getElementById("theScroll");return l.createElement(l.Fragment,null,l.createElement(u.default,i({},e)),d.createPortal(l.createElement("div",{className:"tileView"},this.state.tileComponent),t))}return null},t}(l.Component);t.default=f;var m=function(e,t,n){var a=e.find((function(e){return e.TopicBucketSlug===n}));return a&&0===a.Texts.length&&0===a.Topics.length&&t>0}}).call(this,n(21))},function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(11),c=n(18),u=n(781),p=n(782),h=n(783),g=n(37),f=n(88),m=n(71),v=n(69),b=n(200),C=n(13).withStyles,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedUnitId:parseInt(g.getHashQueryParams().ui),tileComponent:null},t.toggleExpand=function(e,n){var a=n?null:e;t.setState({selectedUnitId:a,tileComponent:t.getTileComponent(a)}),g.updateHashQueryStringParam("ui",a,!0)},t.fetchData=function(){return o(t,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,f.getCatalogTopicDataForUnitsPage(this.props.topicSlug)];case 1:return e=t.sent(),this.subjectName=e.SubjectName,this.topicName=e.TopicName,this.units=e.Data,this.setState({tileComponent:this.getTileComponent(this.state.selectedUnitId)}),this.handleScroll(),[2]}}))}))},t.handleScroll=function(){t.state.selectedUnitId&&$(".scroll").scrollTop(t.selectedUnitRef.offsetTop-64)},t.getTileComponent=function(e){var n=t.props.classes;return sCH.userM.isOnPrimePlan()?t.units.map((function(a,s){var i=e===a.UnitId;return l.createElement("div",{key:a.UnitId,className:n.unit,ref:function(e){i&&(t.selectedUnitRef=e)}},l.createElement("div",{className:n.unitHeading},l.createElement("h1",null,"Unit ",s+1,": ",a.Title),l.createElement("button",{className:"btn-box small",onClick:function(){return t.toggleExpand(a.UnitId,i)}},i?"Collapse":"Expand")),l.createElement("div",null,a.Rows.map((function(e,t){return l.createElement(_,{key:e.Title,row:e,isExpanded:i,classes:n,index:t})}))))})):l.createElement(m.default,{className:"trialSplash",view:v.default,options:{text:"Assign texts from curated sequenced curricular units for ELA, social studies, and science!",screenshotUrl:["/img/Content_Units_"+(t.subjectName||"").replace(" ","_")+".png"],showSampleBanner:!1}})},t}return s(t,e),t.prototype.componentDidMount=function(){this.fetchData()},t.prototype.render=function(){var e={subjectName:this.subjectName,topicName:this.topicName,topicSlug:this.props.topicSlug,isUnitsPage:!0},t=document.getElementById("theScroll");return l.createElement(l.Fragment,null,l.createElement(b.default,i({},e)),d.createPortal(l.createElement("div",{className:"unitView"},this.state.tileComponent),t))},t}(l.Component),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isExpanded:t.props.isExpanded},t.onChange=function(e){t.setState({isExpanded:!t.state.isExpanded})},t}return s(t,e),t.prototype.componentDidUpdate=function(e){this.props.isExpanded!==e.isExpanded&&this.setState({isExpanded:this.props.isExpanded})},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.row,a=e.index,s=this.state.isExpanded;return l.createElement(u.default,{key:n.Title,expanded:s,onChange:this.onChange},l.createElement(p.default,{"aria-controls":"panel"+a+"a-content",id:"panel"+a+"a-header",className:t.rowHeading},l.createElement("div",null,n.Title)),l.createElement(h.default,null,l.createElement("div",null,n.Columns.map((function(e,n){return l.createElement(l.Fragment,{key:e.ColumnTitle},l.createElement("h2",null,e.ColumnTitle),l.createElement(S,{classes:t,column:e}))})))))},t}(l.Component),S=function(e){var t=e.classes,n=e.column;return l.createElement("div",{className:t.column},l.createElement("div",{className:t.columnTextWrapper},l.createElement("p",{className:t.columnP,dangerouslySetInnerHTML:{__html:n.Description}})),l.createElement("div",{style:{flexBasis:"50%"}},n.LearnEntityMetadata.map((function(e,a){var s,i="#teacher/reader/authoring/"+(e.UserLayerId||"preview/"+e.LayerId)+"/notes",o=c(((s={})[t.columnLink]=!0,s[t.columnLinkAssigned]=e.IsAssigned>0,s)),r=w(e.StandardsCsv);return l.createElement("div",{className:t.columnMetadataWrapper,key:a+"-"+e.Title},l.createElement("span",{className:t.columnInfo},l.createElement("a",{href:i,onClick:function(){Backbone.tracking.trackGAEvent("user","Unit Layer Click",e.LayerId+"|"+n.UnitId+"|"+sCH.userM.get("UserId"))},target:"_blank",rel:"noopener",className:o},e.Title," ",e.ShowAuthorOnTile&&e.Author&&"by "+e.Author),e.Lexile&&"["+e.Lexile+"L]"),l.createElement("span",{className:t.columnStandards,title:r.standardsTooltips},r.standardsTexts))}))))},w=function(e){var t=e.split(",").map((function(e){return parseInt(e,10)})),n=[].concat.apply([],sCH.userM.get("StandardSets").map((function(e){return e.Standards}))).filter((function(e){return t.indexOf(e.StandardId)>-1}));return{standardsTexts:n.map((function(e){return e.StandardCode})).join(", "),standardsTooltips:n.map((function(e){return e.StandardCode+" - "+e.ShortText})).join(", ")}};t.default=C((function(e){return{unit:{marginBottom:50},unitHeading:{display:"flex",alignItems:"center","& > h1":{marginRight:10}},rowHeading:{fontFamily:"Avenir Next LT W02 Demi",background:"#607D8B",color:"#FFF",fontSize:22},column:{display:"flex",borderTop:"solid 1px #CFD8DC",padding:"10px 0px"},columnTextWrapper:{flexBasis:"50%",marginRight:40},columnP:{fontSize:16,fontFamily:"AvenirNextLTW02-Medium",marginTop:0,lineHeight:1.4,"& > a":{borderBottom:"dotted 1px #03A9F4"}},columnMetadataWrapper:{display:"flex",marginBottom:10,alignItems:"center"},columnLink:{fontSize:16,fontFamily:"AvenirNextLTW02-Medium",marginRight:20,color:"#03A9F4",lineHeight:1.4},columnLinkAssigned:{},columnStandards:{fontSize:14,flexBasis:"25%"},columnInfo:{flexBasis:"75%",fontSize:14,marginRight:40}}}))(y)}).call(this,n(21))},function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),d=n(11),c=n(8),u=n(200),p=n(14),h=n(88),g=n(132),f=n(764),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numOfBYOCInMonth=null,t.isAnonUser=sCH.userM.isAnonUser(),t.myImports=[],t.state={tileComponent:null},t.fetchData=function(){return o(t,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,h.getMyImportsData()];case 1:return e=t.sent(),this.numOfBYOCInMonth=e.numOfBYOCInMonth,this.myImports=e.importedTexts,this.setState({tileComponent:this.getTileComponent()}),h.updateFilterInQueryParams(),[2]}}))}))},t.myImportsTextRemoved=function(e){t.myImports=t.myImports.filter((function(t){return t.LayerId!==e.layerId})),t.setState({tileComponent:t.getTileComponent()})},t.getTileComponent=function(){var e=t.myImports;return 0===e.length?l.createElement("span",{className:"ctaInfo"},"No imports so far!"):l.createElement(g.default,{key:Math.random(),page:p.Page.WORKSPACE,tiles:e})},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("textImported",this.fetchData),Backbone.pubEv.on("myImportsTextRemoved",this.myImportsTextRemoved),this.isAnonUser||this.fetchData()},t.prototype.componentDidUpdate=function(e){c.isEqual(e,this.props)||this.isAnonUser||this.fetchData()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("textImported"),Backbone.pubEv.off("myImportsTextRemoved")},t.prototype.render=function(){var e={subjectName:"My Imports",topicName:"My Imports",numOfBYOCInMonth:this.numOfBYOCInMonth},t=document.getElementById("theScroll");return l.createElement(l.Fragment,null,l.createElement(u.default,i({},e)),d.createPortal(this.isAnonUser?l.createElement(f.default,{message:l.createElement(v,null),screenshotUrl:"/img/Content_MyImports.png"}):l.createElement("div",{className:"tileView"},this.state.tileComponent),t))},t}(l.Component);t.default=m;var v=function(){return l.createElement("p",null,l.createElement("a",{className:"callout",href:"/account.html#/signup/educator/step1"},"Sign Up")," or",l.createElement("a",{className:"callout",href:"/account.html"},"Log In"),"to access My Imports, where you can import online articles, Google Docs, videos and PDFs!")}}).call(this,n(21))},function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},l=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var d=n(0),c=n(11),u=n(342),p=n(762),h=n(8),g=n(200),f=n(14),m=n(132),v=n(88),b=n(1545),C=n(71),y=n(69),_=n(5),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.libraryTexts=[],t.containerRef=d.createRef(),t.state={tileComponent:null,folderComponent:null},t.fetchData=function(){return o(t,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,v.getLibraryData()];case 1:return e=t.sent(),this.libraryTexts=e.texts?l(e.texts):[],this.setState({tileComponent:this.getTileComponent(e),folderComponent:this.getFolderComponent(e)}),v.updateFilterInQueryParams(),[2]}}))}))},t.getTileComponent=function(e){if(sCH.userM.isOnPrimePlan()){if(0===t.libraryTexts.length)return d.createElement("span",{className:"ctaInfo"},alcfg.infoText.library.noData);var n=t.libraryTexts.filter((function(e){return e.FolderId===t.props.selectedFolderId}));return 0===n.length?e.subFolderLength?d.createElement("span",{className:"ctaInfo"},"cH.plural(obj.subFolderLength, '%count subfolder', '%count subfolders')"):d.createElement("span",{className:"ctaInfo"},"Nothing here!"):d.createElement(m.default,{page:f.Page.LIBRARY,tiles:n,areTilesDraggable:!0})}return d.createElement(C.default,{className:"trialSplash",view:y.default,options:{text:"The private "+sCH.userM.getLibraryString()+" allows your school or \n          district to centrally organize, manage, and distribute content for you and your colleagues.",screenshotUrl:"/img/PRO_placeholder_VW_Library.png"}})},t.getFolderComponent=function(e){if(sCH.userM.isOnPrimePlan()){var n=t.props.selectedFolderId||-2;return d.createElement(b.default,{folders:[{FolderId:-2,Title:sCH.userM.getLibraryString(),toggled:!0}].concat(e.folders),texts:t.libraryTexts,selectedFolderId:n})}},t.libraryTextMoved=function(e){t.libraryTexts.find((function(t){return t.LayerId===e.layerId})).FolderId=e.newFolderId;var n=t.libraryTexts.filter((function(t){return t.FolderId===e.folderId}));0===n.length?t.setState({tileComponent:d.createElement("span",{className:"ctaInfo"},"Nothing here!")}):t.setState({tileComponent:d.createElement(m.default,{page:f.Page.LIBRARY,tiles:n,areTilesDraggable:!0})})},t.libraryFolderSelected=function(e){var n=t.libraryTexts.filter((function(t){return t.FolderId===e.folderId}));if(0===n.length){var a=e.subFolderLength?_.plural(e.subFolderLength,"%count subfolder","%count subfolders"):"Nothing here!";t.setState({tileComponent:d.createElement("span",{className:"ctaInfo"},a)})}else t.setState({tileComponent:d.createElement(m.default,{page:f.Page.LIBRARY,tiles:n,areTilesDraggable:!0})})},t.libraryTextRemoved=function(e){t.containerRef.current.querySelector("a[data-layerid='"+e.layerId+"']")&&t.containerRef.current.querySelector("a[data-layerid='"+e.layerId+"']").remove(),t.libraryTexts=t.libraryTexts.filter((function(t){return t.LayerId!==e.layerId}))},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("libraryTextMoved",this.libraryTextMoved),Backbone.pubEv.on("libraryFolderSelected",this.libraryFolderSelected),Backbone.pubEv.on("libraryTextRemoved",this.libraryTextRemoved),this.fetchData(),$(".layout").addClass("folderView")},t.prototype.componentDidUpdate=function(e){h.isEqual(e,this.props)||this.fetchData()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("libraryTextMoved"),Backbone.pubEv.off("libraryFolderSelected"),Backbone.pubEv.off("libraryTextRemoved"),$(".layout").removeClass("folderView")},t.prototype.render=function(){var e=document.getElementById("theScroll");return d.createElement(d.Fragment,null,d.createElement(g.default,i({},{subjectName:"Library",topicName:"Library"})),c.createPortal(d.createElement("div",{className:"flex",ref:this.containerRef},this.state.folderComponent&&this.state.folderComponent,this.state.tileComponent&&d.createElement("div",{className:"tileView"},this.state.tileComponent)),e))},t}(d.Component);t.default=u.DragDropContext(p.default)(S)}).call(this,n(21))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(0),r=n(14),l=n(499),d=n(37),c=n(765),u=n(10),p=n(5),h=n(8),g=-2,f=function(e){function t(t,n){var a=e.call(this,t)||this;if(a.onFolderSelected=function(e,t,n){a.setState({selectedFolderId:e}),Backbone.pubEv.trigger("libraryFolderSelected",{folderId:e,subFolderLength:n}),d.addToNavigationHistory("#teacher/catalog/library/"+e)},a.getLayerToMove=function(e){var t=a.props.texts.find((function(t){return t.LayerId===e}));return h.orderBy(t.Layers.filter((function(e){return"CatalogLayer"===e.LayerType})),"UpdateDate","desc")[0]},a.onLayerMoved=function(e,t){var n=a.state.selectedFolderId||g,s=a.getLayerToMove(e);u.MoveLayerToFolder({layerId:s?s.LayerId:e,oldFolderId:n,newFolderId:t,shouldCopyLayer:!1},(function(a){p.bootstrap.alert({message:"Added assignment to folder!"}),Backbone.pubEv.trigger("libraryTextMoved",{newFolderId:t,layerId:e,folderId:n})}))},a.libraryFolderRemoved=function(e){var t=a.state.folders.filter((function(t){return t.FolderId!==e}));a.setState({folders:t})},a.props.selectedFolderId){var s=i.find(a.props.folders,{FolderId:a.props.selectedFolderId});if(s){s.active=!0;var o=l.getAncestorFolders(a.props.folders,a.props.selectedFolderId);i.forEach(o,(function(e){return e.toggled=!0}))}else window.location.hash="#teacher/catalog/library"}return a.state={selectedFolderId:a.props.selectedFolderId,folders:a.props.folders},a}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("libraryFolderRemoved",this.libraryFolderRemoved)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("libraryFolderRemoved")},t.prototype.render=function(){return o.createElement(c.default,{page:r.Page.LIBRARY,folders:this.state.folders,selectedFolderId:this.state.selectedFolderId,canManage:sCH.userM.hasManageLibraryPermissions(),customProps:{onFolderSelected:this.onFolderSelected,onLayerMoved:this.onLayerMoved,rootFolderId:g}})},t}(o.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1547),i=n(71);t.default=function(e){return a.createElement(a.Fragment,null,a.createElement(i.default,{view:s.default,options:e.viewProps,shouldNotCallRender:!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1548),s=n(1556),i=n(744),o=n(746);t.default=Backbone.View.extend({el:"div.professionalLearning",initialize:function(e){var t=e.tab||"learn";e.teacherUserId=sCH.userM.get("UserId"),e.mainView="professional_learning",this.subheader=new s.default({scope:this,tabSelected:t}),this.learnScroll=new a.default(e),this.questionsScroll=new i.default(e),this.feedbackScroll=new o.default(e),this.childViews=[this.subheader,this.learnScroll,this.questionsScroll,this.feedbackScroll]},destroy:function(){$(".daterangepicker").remove()}})},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(5),r=n(22),l=n(10),d=n(1549),c=n(1555),u=n(233),p=n(48),h=n(264);t.default=Backbone.View.extend({el:"div.professionalLearning .scroll",events:{"click .free":"showBuyTeacherPopup","click .icon-slideshow:not(.free):not(.comingsoon)":"showSlideshow","click .icon-certificate:not(.free):not(.comingsoon):not(.disabled)":"showMicrocredential","click .icon-play:not(.free):not(.comingsoon)":"showVideo","click h1":"goScroll"},initialize:function(e){this.selected=e},preRender:function(){var e=this;this.data?this.render():l.GetProfessionalLearningData((function(t){e.data=t,e.render()}))},render:function(){return a(this,void 0,void 0,(function(){var e,t,n;return s(this,(function(a){switch(a.label){case 0:return e=i.find(this.data.configData,{Title:"Whitepaper"}),t=i.groupBy(i.reject(this.data.configData,{Title:"Whitepaper"}),"BucketTitle"),this.$el.html('<div id="professionalLearning"/>'),[4,r.mountReactComponent(d.default,this.$el.find("#professionalLearning")[0],{whitepaperData:e,bucketsData:t,completionData:this.data.completionData})];case 1:return a.sent(),this.delegateEvents(),o.initTooltips(this.$el),this.selected&&(n="a[data-hash='"+this.selected.practice+"/"+this.selected.activity+"']",1===$(n).length&&"try"===this.selected.activity?(window.location.hash="#teacher/professionallearning/learn",window.location.href=$(n).attr("href")):$(n).click()),[2]}}))}))},showSlideshow:function(e){var t=$('<div id="popup"></div>'),n=parseInt($(e.currentTarget).closest("tr").data("configid")),a=$(e.currentTarget).data("folder"),s=parseInt($(e.currentTarget).data("numimages")),i=this;new Backbone.BootstrapModal({content:t,okText:"Close",allowCancel:!1,cancelText:!1,cssClass:"modal-al-slideshow"}).on("shown",(function(){r.mountReactComponent(c.default,t[0],{s3Folder:a,numImages:s,onEnd:function(){l.UpdateProfessionalLearningCompletion({configId:n,type:"Slideshow"}),i.renderComplete(n,"Slideshow",1)}})})).open().on("ok",(function(){window.location.hash="#teacher/professionallearning/learn"})),Backbone.router.navigate("teacher/professionallearning/learn/"+$(e.currentTarget).data("hash"),{trigger:!1})},showMicrocredential:function(e){var t=parseInt($(e.currentTarget).closest("tr").data("configid")),n=$(e.currentTarget).data("url"),a=i.find(this.data.configData,{ProfessionalLearningConfigId:t}).TitleKey,s=this,o=$('<div id="popup">        <p>          <span class="info">Micro-credentials allow you to receive credit for skills you can demonstrate.          Our micro-credentials have been certified by Digital Promise and can likely earn you professional           development credits. Note: Your admin will be able to see your progress as well.</span><br/><br/>          View the requirements for this micro-credential <a class="infoLink" href="'+n+'">here</a> and then           submit files below.<br/>        </p>        <div id="uploadContainer"></div>      </div>');new Backbone.BootstrapModal({title:"Earn a Micro-credential!",content:o,okText:"Submit"}).on("shown",(function(){r.mountReactComponent(u.default,o.find("#uploadContainer")[0],{uploadUrl:alcfg.node.professional_learning.submit_files,enableMultiple:!0,disablePreview:!0,fileType:alcfg.imageExtensions.map((function(e){return"image/"+e})).concat(["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.google-apps.document","application/vnd.google-apps.file","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"]).join(","),fileDropPlaceholder:"Try dropping some files here, or click to select files to upload.",submitData:{practice:a},successMessage:"Thank you for submitting!          We will assess your micro-credential application and respond to you within one week."})})).on("ok",(function(){var e=this;this.preventClose(),this.disableOk(),sCH.reactUploader.submit((function(){s.renderComplete(t,"Microcredential",0),e.close(),window.location.hash="#teacher/professionallearning/learn"}))})).open(),Backbone.router.navigate("teacher/professionallearning/learn/"+$(e.currentTarget).data("hash"),{trigger:!1})},showVideo:function(e){var t=$(e.currentTarget).data("videoid"),n=parseInt($(e.currentTarget).closest("tr").data("configid"));new Backbone.BootstrapModal({content:new h.default({videoId:t,configId:n,scope:this}),cancelText:!1,okText:"Close",cssClass:"modal-lg modal-al-instructional-video",title:""}).open().on("ok",(function(){window.location.hash="#teacher/professionallearning/learn"})),Backbone.router.navigate("teacher/professionallearning/learn/"+$(e.currentTarget).data("hash"),{trigger:!1})},renderComplete:function(e,t,n){i.find(this.data.completionData,{ProfessionalLearningConfigId:e})[t]=n},showBuyTeacherPopup:function(e){return p.showBuyTeacherPopup({title:"Professional Learning Center",content:"The Professional Learning Center with modules for 12 literacy practices is available on our Prime plan."}),!1}})}).call(this,n(21))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1550);t.default=function(e){var t=Object.keys(e.bucketsData).map((function(t,n){return a.createElement(s.default,{key:n,title:t,data:e.bucketsData[t],completionData:e.completionData})})),n="/#teacher/reader/learning/"+e.whitepaperData.AssignmentId+"/notes";return a.createElement("div",null,a.createElement("section",null,a.createElement("h1",null,"Overview"),a.createElement("p",{style:{fontSize:"16px",margin:0,lineHeight:1.4}},"The research paper Stop Skimming, Start Learning. explains depth and the ASR framework.",a.createElement("br",null),"In this collaborative document, your shared notes and answers to questions will be visible to colleagues at your school."),a.createElement("a",{href:n,className:"btn-box callout",style:{marginTop:"10px"}},"Read the research paper")),t)}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(8),i=n(1551),o=n(1552),r=n(1553),l=n(1554),d=n(0);t.default=function(e){var t=sCH.userM.isOnFreeOrPersonalPlan();return d.createElement("section",null,d.createElement("h1",null,e.title),d.createElement("table",{className:"tablesorter"},d.createElement("thead",null,d.createElement("tr",{className:"nohover"},d.createElement("th",{style:{width:"280px"}},"Practice"),d.createElement("th",{style:{width:"140px"}},"Learn"),d.createElement("th",{style:{width:"140px"}},"Try"),d.createElement("th",{style:{width:"140px"}},"Implement"),d.createElement("th",{style:{width:"140px"}},"Demonstrate"))),d.createElement("tbody",null,e.data.map((function(n,i){var o=s.find(e.completionData,{ProfessionalLearningConfigId:n.ProfessionalLearningConfigId})||{},r=t&&n.ProfessionalLearningConfigId>1;return d.createElement(c,a({key:i},n,{completionData:o,isFree:r}))})))))};var c=function(e){return d.createElement("tr",{className:e.Color,"data-configid":e.ProfessionalLearningConfigId},d.createElement("td",{className:"left"},e.Description),d.createElement(i.default,{isFree:e.isFree,isCompleted:!!e.completionData.Slideshow,titleKey:e.TitleKey,numImages:e.SlideshowNumImages}),d.createElement(o.default,{isFree:e.isFree,isCompleted:!!e.completionData.Assignment,titleKey:e.TitleKey,assignmentId:e.AssignmentId}),d.createElement(r.default,{isFree:e.isFree,isCompleted:!!e.completionData.Video,titleKey:e.TitleKey,videoId:e.VideoId}),d.createElement(l.default,{isFree:e.isFree,completedStatus:e.completionData.Microcredential,titleKey:e.TitleKey,microcredentialUrl:e.MicrocredentialUrl}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(352),s=n(0);t.default=function(e){var t="https://images.activelylearn.com/professionallearning/"+e.titleKey+"/",n=a.generateCssClassNames({iconClass:"icon-slideshow",comingSoonProperty:e.numImages,isFree:e.isFree,isCompleted:e.isCompleted}),i=n.comingSoonText,o=n.classNames;return s.createElement("td",null,e.isCompleted&&s.createElement("span",{className:"icon-checkmark"}),s.createElement("span",{title:i},s.createElement("a",{className:o,"data-hash":e.titleKey+"/learn","data-folder":t,"data-numimages":e.numImages})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(352),s=n(0);t.default=function(e){var t="#teacher/reader/learning/"+e.assignmentId+"/notes",n=a.generateCssClassNames({iconClass:"icon-authoring",comingSoonProperty:e.assignmentId,isFree:e.isFree,isCompleted:e.isCompleted}),i=n.comingSoonText,o=n.classNames;return s.createElement("td",null,e.isCompleted&&s.createElement("span",{className:"icon-checkmark"}),s.createElement("span",{title:i},s.createElement("a",{className:o,"data-hash":e.titleKey+"/try",href:t})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(352),s=n(0);t.default=function(e){var t=a.generateCssClassNames({iconClass:"icon-play",comingSoonProperty:e.videoId,isFree:e.isFree,isCompleted:e.isCompleted}),n=t.comingSoonText,i=t.classNames;return s.createElement("td",null,e.isCompleted&&s.createElement("span",{className:"icon-checkmark"}),s.createElement("span",{title:n},s.createElement("a",{className:i,"data-hash":e.titleKey+"/implement","data-videoid":e.videoId})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(352),s=n(0);t.default=function(e){var t=a.generateCssClassNames({iconClass:"icon-certificate",comingSoonProperty:e.microcredentialUrl,isFree:e.isFree,isCompleted:[0,1].indexOf(e.completedStatus)>-1,isMicrocredential:!0}),n=t.comingSoonText,i=t.classNames;return s.createElement("td",null,0===e.completedStatus&&s.createElement("span",{className:"icon-pending",title:"Waiting for review"}),1===e.completedStatus&&s.createElement("span",{className:"icon-checkmark",title:"Approved!"}),2===e.completedStatus&&s.createElement("span",{className:"icon-cancel",title:"Rejected"}),s.createElement("span",{title:n},s.createElement("a",{className:i,"data-hash":e.titleKey+"/demonstrate","data-url":e.microcredentialUrl})))}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(760).default;t.default=function(e){for(var t={dots:!0,infinite:!1,afterChange:function(t){t===e.numImages-1&&e.onEnd()}},n=[],o=1;o<=e.numImages;o++)n.push(s.createElement("div",{key:o},s.createElement("img",{src:e.s3Folder+o.toString()+".jpg"})));return s.createElement(i,a({},t),n)}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=n(5),r=n(48);t.default=Backbone.View.extend({el:"div.professionalLearning .subheader",events:{"click .btnRequestAssignmentReview":"requestAssignmentReview","click .tabs .btn-tab:not(.selected)":"handleSubheaderTabClick","change .ddlStandards":"filterQuestion","change .ddlQuesType":"filterQuestion","click .btnPrintView":"printView"},initialize:function(e){this.scope=e.scope,this.tabSelected=e.tabSelected,this.tabClasses="plcLearn plcQuestions plcFeedback",this.render()},template:n(1557),render:function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,o.renderBackboneTemplateAsync(this.el,this.template({basePath:""}))];case 1:return e.sent(),this.selectTab(this.tabSelected),[2]}}))}))},handleSubheaderTabClick:function(e){var t=$(e.currentTarget).data("tab");this.selectTab(t)},selectTab:function(e){var t="learn"===e||!sCH.userM.isOnFreeOrPersonalPlan();if(this.cleanUpPageClasses(),$(".rowTwo").show(),t)switch(this.handleTabSelectionUI(e),Backbone.router.navigate("teacher/professionallearning/"+e,{trigger:!1}),this.scope.feedbackScroll.close(!1),this.scope.learnScroll.close(!1),this.scope.questionsScroll.close(!1),e){case"learn":$("#app").addClass("plcLearn"),this.scope.learnScroll.preRender();break;case"questions":$("#app").addClass("plcQuestions"),this.scope.questionsScroll.preRender();break;case"feedback":$("#app").addClass("plcFeedback"),this.scope.feedbackScroll.preRender()}else r.showBuyTeacherPopup({title:"PLC Reports"}),this.$el.find(".btn-tab.selected").removeClass("selected"),this.$el.find('.btn-tab[data-tab="'+e+'"]').addClass("selected"),this.$el.find(".rowTwo").children().addClass("displayNone")},handleTabSelectionUI:function(e){this.$el.find(".btn-tab.selected").removeClass("selected"),this.$el.find('.btn-tab[data-tab="'+e+'"]').addClass("selected"),this.$el.find(".rowTwo").children().addClass("displayNone"),this.$el.find(".rowTwo .tab-"+e).removeClass("displayNone")},filterQuestion:function(){this.scope.questionsScroll.filter()},printView:function(){var e=$(".mainHeader .dropdown-toggle").text()+" - Questions report",t=$(".subheader .ddlQuesType").val(),n=$(".subheader .ddlStandards").val(),a="";"hasstandard"!==n&&(a+=" : "+n),"-1"!==t&&(a+=" : "+("1"===t?"Short Answer":"2"===t?"Multiple Choice":"Poll")),o.print(e+a)},requestAssignmentReview:function(){var e=new Backbone.BootstrapModal({title:"Interested in improving an assignment?",content:'Our team will review your instruction within 3 weekdays and share recommendations that will help in the following areas:        <ul>          <li><span class="bold">Activate thinking:</span> Questioning, Annotation, Discussion, and Modeling close reading</li>          <li><span class="bold">Support thinking:</span> Scaffolding, Background Knowledge, Vocab, Accessibility</li>          <li><span class="bold">Reveal thinking:</span> Formative Evaluation, Feedback, Writing, Metacognition</li>        </ul>        <input id="txtTitle" placeholder="Enter title of assignment" />        <input id="txtUrl" placeholder="Enter URL of assignment" style="margin-bottom:2px;" />        <span class="info">(ex. https://read.activelylearn.com/#teacher/reader/authoring/123456/notes)</span>        <p>Is there anything specifically you\'d like us to look at?        <div id="txtSpecifics" contenteditable="true"></div></p>',okText:"Request",cssClass:"modal-al-assignment-review"}).open((function(){i.SubmitAssignmentForReview({title:e.$el.find("#txtTitle").val(),url:e.$el.find("#txtUrl").val(),specifics:e.$el.find("#txtSpecifics").html()})}))},cleanUpPageClasses:function(){$("#app").removeClass(this.tabClasses)},destroy:function(){this.cleanUpPageClasses()}})}).call(this,n(21))},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<nav role="tablist" aria-label="Tabs" class="tabs">\n  <a href="javascript:void(0)" role="tab" class="btn-tab pull-left" data-tab="learn">Learn</a>\n  <a href="javascript:void(0)" role="tab" class="btn-tab pull-left" data-tab="questions">\n    Questions <span class="primeFeature icon-premium-lock" />\n  </a>\n  <a href="javascript:void(0)" role="tab" class="btn-tab pull-left" data-tab="feedback">\n    Feedback <span class="primeFeature icon-premium-lock" />\n  </a>\n</nav>\n\n<aside class="rowTwo">\n  <button class="btn-tab btnPrintView icon-print tab-questions" title="print" aria-haspopup="true" aria-expanded="false"></button>\n  <select class="ddlStandards tab-questions"></select>\n  <select class="ddlQuesType tab-questions"></select>\n  <button class="btn-box btnRequestAssignmentReview tab-learn">Request assignment review</button>\n<aside>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(71),i=n(1559);t.default=function(e){return a.createElement(a.Fragment,null,a.createElement(s.default,{view:i.default,options:e.viewProps,shouldNotCallRender:!0}))}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(1560),r=n(22),l=n(1589),d=n(1600),c=n(1610),u=n(1627),p=n(462),h=n(1636);t.default=Backbone.View.extend({el:"div.teacherClasses",initialize:function(e){if(e.scope=this,this.childViews=[],isNaN(e.classId))sCH.classesC.length>0?i.redirectUserByHash(i.getClassUrl(sCH.classesC.first().get("ClassId"),"assess")):alert("no classes!");else if(sCH.classesC.filter({ClassId:e.classId}).length)this.postInitialize(e);else{var t=sCH.userM.get("ArchivedClasses").indexOf(e.classId)>-1;new Backbone.BootstrapModal({title:t?"Class is archived":"Class does not exist!",content:t?alcfg.confirmsText.classArchive:"",cancelText:!1,allowCancel:!1,okText:"Close",cssClass:"modal-class-no-exist"}).open((function(){window.location.hash="#teacher/catalog"}))}},postInitialize:function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(a){switch(a.label){case 0:return t=sCH.classesC.getModelByClassId(e.classId),n=t.get("TeacherUserId")===sCH.userM.get("UserId"),Backbone.pubEv.trigger("setSiteSection",t.get("Name")),Backbone.pubEv.trigger("setHeaderActions",{actionButtons:{type:"TeacherClass",props:{classId:e.classId,classM:t,isTeacherOwner:n}}}),[4,r.mountReactComponent(o.default,this.$el.find("#theSubheader")[0],{obj:e,scope:this})];case 1:return a.sent(),this.classId=e.classId,this.studentUserId=e.studentUserId,this.subtab=e.subtab,$(".teacherClasses.layout").addClass(e.render),this["render"+e.render.charAt(0).toUpperCase()+e.render.substring(1).toLowerCase()](),[2]}}))}))},renderRoster:function(){this.classM=sCH.classesC.getModelByClassId(this.classId),this.studentsC=new p.default,this.studentsC.on("sync destroy",this.mountRoster,this),this.studentsC.fill_class({classId:this.classId,isGoogleCourse:"google"===this.classM.get("Source")})},mountRoster:function(){r.mountReactComponent(h.default,this.$el.find(".scroll")[0],{classId:this.classId,students:this.studentsC})},renderAssess:function(){this.assessScroll=new l.default({subheader:this.subheader}),this.childViews.push(this.assessScroll),this.assessScroll.preRender(this.classId)},renderGradebook:function(){this.gradebookScroll=new d.default({subheader:this.subheader}),this.childViews.push(this.gradebookScroll),this.scroll=this.gradebookScroll,this.gradebookScroll.render(this.classId,this.subtab)},renderStudentdata:function(){this.studentDataScroll=new c.default({subheader:this.subheader,studentUserId:this.studentUserId}),this.childViews.push(this.studentDataScroll),this.scroll=this.studentDataScroll,this.studentDataScroll.render(this.classId,this.subtab)},renderClassdata:function(){this.classDataScroll=new u.default({subheader:this.subheader}),this.childViews.push(this.classDataScroll),this.scroll=this.classDataScroll,this.classDataScroll.render(this.classId,this.subtab)},destroy:function(){r.unmountReactComponent($(".subheader")[0])}})}).call(this,n(21))},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1561),r=n(5),l=n(1563),d=n(154),c=n(1588),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={activeTab:t.props.obj.render,activeSubTab:null,selectMode:null,selectModeAction:null},t.data={basePath:r.getClassUrl(t.props.obj.classId,""),sCH:sCH,showInviteStudentCode:!sCH.userM.isNonALDemoUser(),isOnFreePlan:sCH.userM.isOnFreePlan()},t.startSelectMode=function(e){t.setState({selectMode:!0});var n=$(e.currentTarget).data("selectmode"),a=$(e.currentTarget).data("selecttype"),s=$(e.currentTarget).data("selectfilter"),i=$(e.currentTarget).attr("class").split(/\s+/),o=i[i.length-1].replace("btn",""),r=$(e.currentTarget).data("singleselectbycssclass"),l=$(e.currentTarget).data("selectiondisallowedclassname");Backbone.pubEv.trigger("toggleselectMode",{state:"on",mode:n,type:a,selectAction:o,filter:s,singleSelectByCSSClass:r,selectionDisallowedClassName:l}),t.setState({selectModeAction:o,selectMode:n})},t.cancelSelectMode=function(){t.setState({selectMode:null}),Backbone.pubEv.trigger("toggleselectMode",{state:"off"})},t.next=function(){Backbone.pubEv.trigger(t.state.selectModeAction),t.setState({selectMode:null})},t}return s(t,e),t.prototype.componentDidMount=function(){sCH.userM.get("Accounts").google&&d.init(["https://www.googleapis.com/auth/classroom.courses","https://www.googleapis.com/auth/classroom.rosters","https://www.googleapis.com/auth/classroom.profile.emails","https://www.googleapis.com/auth/classroom.coursework.students","https://www.googleapis.com/auth/classroom.coursework.students.readonly"]),Backbone.pubEv.on("cancelSelectMode",this.cancelSelectMode)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("cancelSelectMode",this.cancelSelectMode)},t.prototype.render=function(){return i.createElement(i.Fragment,null,this.state.selectMode&&i.createElement(c.default,{selectModeAction:this.state.selectModeAction,cancelSelectMode:this.cancelSelectMode,next:"multiple"===this.state.selectMode?this.next:null,displayText:alcfg.infoText.assess[this.state.selectModeAction],okText:"SyncAssignmentWithClassroom"===this.state.selectModeAction?"Sync":"Next"}),i.createElement("div",{style:{display:this.state.selectMode?"none":"block"}},i.createElement(o.default,{basePath:this.data.basePath,sCH:this.data.sCH,activeTab:this.state.activeTab}),i.createElement("div",{className:"rowTwo"},i.createElement(l.default,{activeTab:this.state.activeTab,activeSubTab:this.state.activeSubTab,startSelectMode:this.startSelectMode,showInviteStudentCode:this.data.showInviteStudentCode,classId:this.props.obj.classId,isOnFreePlan:this.data.isOnFreePlan,scope:this.props.scope,style:{display:this.state.selectMode?"none":"block"}}))))},t}(i.Component);t.default=u},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1562),r=n(20),l=[{className:"btn-tab pull-left tabRoster",label:"Roster",tabName:"roster"},{className:"btn-tab pull-left tabAssess",label:"Assignments",tabName:"assess"},{className:"btn-tab pull-left tabGradebook",label:"Gradebook",tabName:"gradebook"},{className:"btn-tab pull-left "+(r.default.isMath?"tabClassData":"tabStudentData"),label:r.default.isMath?"Class Data":"Student Data",tabName:r.default.isMath?"classdata":"studentdata",isPremiumFeature:!0},{className:"btn-tab pull-left "+(r.default.isMath?"tabStudentData":"tabClassData"),label:r.default.isMath?"Student Data":"Class Data",tabName:r.default.isMath?"studentdata":"classdata",isPremiumFeature:!0}],d=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.hrefGenerator=a.hrefGenerator.bind(a),a}return s(t,e),t.prototype.hrefGenerator=function(e){return this.props.basePath+e},t.prototype.render=function(){var e=this,t=this.props.sCH.userM.isOnFreePlan();return i.createElement(o.default,{items:l.map((function(n){return{href:e.props.basePath+n.tabName,className:n.className,label:n.label,tabName:n.tabName,showLockIcon:n.isPremiumFeature&&t&&!r.default.isMath}})),activeTab:this.props.activeTab})},t}(i.Component);t.default=d},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this;return i.createElement("div",{role:"tablist",className:"tabs","aria-label":"tabs"},this.props.items.map((function(t){return i.createElement("a",{key:t.tabName,href:t.href||"javascript:void(0)",role:"tab","aria-selected":t.tabName==e.props.activeTab,id:t.tabName+"Tab",className:t.className+(t.tabName==e.props.activeTab?" selected":"")},t.label,t.showLockIcon&&i.createElement("span",{className:"icon-premium-lock"}))})))},t}(i.Component);t.default=o},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1564),r=n(1573),l=n(1580),d=n(1581),c=n(1582),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.trigger("setSubSectionTitle",{assess:"Assignments",roster:"Roster",gradebook:"Gradebook",studentdata:"Student Data",classdata:"Class Data"}[this.props.activeTab])},t.prototype.render=function(){switch(this.props.activeTab){case"assess":return i.createElement(c.default,{isOnFreePlan:this.props.isOnFreePlan,startSelectMode:this.props.startSelectMode,classId:this.props.classId,scope:this.props.scope});case"roster":return i.createElement(r.default,{showInviteStudentCode:this.props.showInviteStudentCode,classId:this.props.classId,scope:this.props.scope});case"gradebook":return i.createElement(o.default,{classId:this.props.classId,scope:this.props.scope});case"studentdata":return i.createElement(l.default,null);case"classdata":return i.createElement(d.default,null);default:return null}},t}(i.Component);t.default=u},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),l=n(22),d=n(1565),c=n(1566),u=n(1569),p=n(1570),h=n(1572),g=n(5),f=n(8),m=n(10),v=n(48),b=n(14),C=n(72),y=n(153),_=n(24);!function(e){e[e.assignment=0]="assignment",e[e.standards=1]="standards",e[e.activity=2]="activity"}(o||(o={}));var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={gradebookTabSelected:"assignment",columnFilters:[],columnsToShow:[]},t.updateGradebookSubTab=function(e){return t.setState({gradebookTabSelected:e})},t.weightAssignmentGrades=function(){var e=t.props.scope,n={assignments:f.uniqBy(e.gradebookScroll.rawData.Assignments,"AssignmentId"),scroll:e.gradebookScroll,classId:t.props.classId};if(sCH.userM.isOnFreeOrPersonalPlan()){v.showBuyTeacherPopup({title:"Assignment Weighting",content:"Assignment weighting gives you more control over which assignments\n      count more heavily towards a student's class grade."})}else _.showModal(r.createElement(d.default,i({},n)))},t.splitAssignments=function(){var e=f.uniqBy(f.filter(t.props.scope.gradebookScroll.assignmentSectionCountList,(function(e){return e.SectionCount>1})),"AssignmentId");new Backbone.BootstrapModal({title:"Split assignment",content:new c.default({assignments:e,classId:t.props.classId}),okText:"Split",cssClass:"modal-al-split-assignment",optionButtons:[{text:"Unsplit",event:"unsplitAssignment"}]})},t.exportGradebook=function(){sCH.userM.isOnFreePlan()?v.showBuyTeacherPopup({title:"Exporting Gradebook"}):t.props.scope.gradebookScroll.$el.find('.exportTableWrapper input[type="submit"]').click()},t.exportActivity=function(){sCH.userM.isOnFreePlan()?v.showBuyTeacherPopup({title:"Exporting Activity"}):t.props.scope.gradebookScroll.$el.find('.exportActivityWrapper input[type="submit"]').click()},t.addRemoveColumns=function(){t.props.scope;var e={columnFilters:t.state.columnFilters,columnsToShow:t.state.columnsToShow};_.showModal(r.createElement(h.default,i({},e)))},t.syncGradebookWithCanvasOrSchoology=function(){var e=t.props.scope,n=t.props.classId,a=e.gradebookScroll.rawData.Assignments,s=sCH.classesC.getModelByClassId(n),i=s.get("Source"),o=g.capitalizeString(i);m.GetSyncedAssignments({classId:n,source:i},(function(t){e.cachedCanvasAssignmentsToSync={};var n=$('<div id="assignmentGradeWeights"></div>'),i=f.uniqBy(a.filter((function(n){return!!e.gradebookScroll.gradebook.Grades.find((function(e){return e.AssignmentId===n.AssignmentId}))&&t.includes(n.AssignmentId)})),"AssignmentId"),r=new Backbone.BootstrapModal({title:"Sync grades with "+o,content:n,cancelText:i.length>0&&"Cancel",okText:i.length>0?"Sync grades":"Cancel",cssClass:"modal-al-assignment-grade-weights"}).on("shown",(function(){var t=!!i.find((function(e){return e.AssignmentTextSectionSplitMapId}));l.mountReactComponent(u.default,n[0],{assignments:i,lmsName:o,includesAssignmentSplit:t,setValue:function(t,n){n?e.cachedCanvasAssignmentsToSync[t]=!0:delete e.cachedCanvasAssignmentsToSync[t]}})})).open((function(){r.preventClose(),0!==i.length?0!==f.keys(e.cachedCanvasAssignmentsToSync).length?(r.disableOk("Syncing..."),Backbone.pubEv.trigger("loadingShowHide",!0),m["SyncGradebookWith"+o]({classId:e.classId,assignmentIds:Object.keys(e.cachedCanvasAssignmentsToSync)},(function(e){if(200!==e.status){var t="";t=404===e.status&&"invalid assignment"===e.responseText?"Unable to sync grades. The linked "+s.get("Source")+" assignment has been deleted or is no longer valid":e.responseText,g.bootstrap.alert({alert:"danger",message:t})}else g.bootstrap.alert({message:"Synced grades successfully!"});Backbone.pubEv.trigger("loadingShowHide",!1),r.close()}))):g.bootstrap.alert({message:"Select at least one assignment to sync.",alert:"danger"}):r.close()}))}))},t.syncGradebookWithLTICourse=function(){var e=t.props.scope,n=sCH.classesC.getModelByClassId(t.props.classId),a=g.capitalizeString(n.get("SourceProduct")),s=f.filter(e.gradebookScroll.rawData.Assignments,(function(e){return!!e.LISOutcomeServiceUrl}));e.cachedLTIAssignmentsToSync={};var i=$('<div id="assignmentGradeWeights"></div>'),o=new Backbone.BootstrapModal({title:"Sync grades with "+a,content:i,okText:"Sync grades",cssClass:"modal-al-assignment-grade-weights"}).on("shown",(function(){l.mountReactComponent(u.default,i[0],{assignments:s,lmsName:a,setValue:function(t,n){n?e.cachedLTIAssignmentsToSync[t]=!0:delete e.cachedLTIAssignmentsToSync[t]}})})).open((function(){o.preventClose(),o.disableOk("Syncing..."),Backbone.pubEv.trigger("loadingShowHide",!0);var t=[];if(f.each(e.cachedLTIAssignmentsToSync,(function(n,a){a=parseInt(a,10),f.each(e.gradebook.Students,(function(n){var s=f.find(e.gradebook.Grades,{UserId:n.UserId,AssignmentId:a});s&&0!==s.PointsPossible&&t.push({assignmentId:a,userId:n.UserId,grade:s.PointsEarned/s.PointsPossible})}))})),0===t.length)return Backbone.pubEv.trigger("loadingShowHide",!1),g.bootstrap.alert({message:"Synced grades successfully!"}),void o.close();m.SyncGradebookWithLTICourse({classId:e.classId,grades:t},(function(e,t){if(e){var n="";n=404===e.status&&"invalid assignment"===e.responseText?"Unable to sync grades. The linked "+a+" assignment has been deleted or is no longer valid":e.responseText,g.bootstrap.alert({alert:"danger",message:n})}else g.bootstrap.alert({message:"Synced grades successfully!"});Backbone.pubEv.trigger("loadingShowHide",!1),o.close()}))}))},t.syncGradebookWithGoogleCourse=function(){var e=sCH.classesC.getModelByClassId(t.props.classId).get("ExternalClassId");new Backbone.BootstrapModal({title:"Sync Grades with Google Classroom",content:new p.default({courseId:e,gradebook:t.props.scope.gradebookScroll.rawData}),okText:"Submit",cssClass:"modal-lg modal-al-join-classes-from-google-classroom"})},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("updateGradebookSubTab",this.updateGradebookSubTab,this),Backbone.pubEv.on("setGradebookActivityToggleBtn",(function(t){var n=t.columnFilters,a=t.columnsToShow;e.setState({columnFilters:n,columnsToShow:a})}))},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("updateGradebookSubTab",this.updateGradebookSubTab)},t.prototype.render=function(){return r.createElement(w,{DataType:o[this.state.gradebookTabSelected],ClassId:this.props.classId,splitAssignments:this.splitAssignments,weightAssignmentGrades:this.weightAssignmentGrades,exportGradebook:this.exportGradebook,exportActivity:this.exportActivity,showAddRemoveColumnsButton:this.state.columnFilters.length>0,addRemoveColumns:this.addRemoveColumns,syncGradebookWithCanvasCourse:this.syncGradebookWithCanvasOrSchoology,syncGradebookWithSchoologyCourse:this.syncGradebookWithCanvasOrSchoology,syncGradebookWithLTICourse:this.syncGradebookWithLTICourse,syncGradebookWithGoogleCourse:this.syncGradebookWithGoogleCourse})},t}(r.Component);t.default=S;var w=function(e){var t=sCH.classesC.getModelByClassId(e.ClassId),n=t.get("Source"),a=t.get("SourceProduct"),s=!!sCH.userM.get("Accounts").google;return r.createElement(r.Fragment,null,e.DataType===o.assignment&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnWeightAssignmentGrades",onClick:e.weightAssignmentGrades},"Weight Assignments",sCH.userM.isOnFreeOrPersonalPlan()?r.createElement("span",{className:"icon-premium-lock"}):null),e.DataType===o.assignment&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnSplitAssignments",onClick:e.splitAssignments},"Split Assignments"),e.DataType===o.assignment&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnExportGradebook",onClick:e.exportGradebook},"Export Grades",r.createElement("span",{className:"primeFeature icon-premium-lock"})),e.DataType===o.assignment&&n===b.ClassSource.GOOGLE&&s&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnSyncGradebookWithGoogleCourse",onClick:e.syncGradebookWithGoogleCourse,buttonTitle:"Sync assignment grades with Google Classroom"},"Sync Grades with Classroom"),e.DataType===o.assignment&&n===b.ClassSource.LTI&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnSyncGradebookWithLTICourse",onClick:e.syncGradebookWithLTICourse,buttonTitle:"Sync assignment grades with "+a},"Sync Grades with ",a),e.DataType===o.assignment&&n===b.ClassSource.CANVAS&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnSyncGradebookWithCanvasCourse",onClick:e.syncGradebookWithCanvasCourse,buttonTitle:"Sync assignment grades with canvas"},"Sync Grades with Canvas"),e.DataType===o.assignment&&n===b.ClassSource.SCHOOLOGY&&r.createElement(C.default,{"data-tab":"gradebook",buttonClass:"btn-box btnSyncGradebookWithSchoologyCourse",onClick:e.syncGradebookWithSchoologyCourse,buttonTitle:"Sync assignment grades with schoology"},"Sync Grades with Schoology"),e.DataType===o.assignment&&r.createElement(y.default,{buttonClass:"icon-question-mark-inverse gradebookHelper"},r.createElement("ul",null,r.createElement("li",null," Ungraded responses ARE NOT included when calculating points."),r.createElement("li",null," Use bulk grading in an assignment to grade many questions at once."),r.createElement("li",null," The total column is a sum of points earned/sum of points possible (it is not an average)."))),e.DataType===o.activity&&r.createElement(C.default,{"data-tab":"activity",buttonClass:"btn-box btnExportActivity",onClick:e.exportActivity},"Export Data",r.createElement("span",{className:"primeFeature icon-premium-lock"})),e.DataType===o.activity&&e.showAddRemoveColumnsButton&&r.createElement(C.default,{className:"btn-box",onClick:e.addRemoveColumns},"Add/Remove columns"))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(13).withStyles,l=n(10),d=n(24),c=function(e){function t(t,n){var a=e.call(this,t)||this;return a.handleInputChange=function(e){var t=parseFloat(e.target.name),n=a.state.updatedAssignments,s=n.find((function(e){return e.assignmentId===t}));s?s.gradeWeight=parseFloat(e.target.value):n.push({gradeWeight:parseFloat(e.target.value),assignmentId:t}),a.setState({updatedAssignments:n})},a.onSubmit=function(){a.state.updatedAssignments.length>0?l.UpdateAssignmentGradeWeights({weights:a.state.updatedAssignments,classId:a.props.classId},(function(){a.state.updatedAssignments.forEach((function(e){a.props.scroll.rawData.Assignments.find((function(e){return e.assignmentId==e.assignmentId})).GradeWeight=e.gradeWeight})),a.props.scroll.renderGradebook(),d.hideModals()})):d.hideModals()},a.handleOpen=function(e){0===a.props.assignments.length&&e.disableOkButton()},a.state={assignments:i(a.props.assignments),updatedAssignments:[]},a}return s(t,e),t.prototype.render=function(){var e=this,t=this.props.classes;return o.createElement(d.default,{title:"Weight assignments",okText:"Save weights",onOpenCallback:this.handleOpen,okCallback:this.onSubmit,cssClass:"modal-al-assignment-grade-weights"},o.createElement("p",{className:t.p},"Assign a multiplier to weight each assignment when calculating the total grade for each student."),o.createElement("ul",{className:t.ul},this.state.assignments.map((function(n){return o.createElement("li",{className:t.assignment,key:n.AssignmentId},o.createElement("div",{className:"title"},n.Title),o.createElement("div",{className:"weight"},o.createElement("select",{className:t.weightSelector,defaultValue:n.GradeWeight,name:n.AssignmentId,onChange:e.handleInputChange},alcfg.assignmentGradeWeights.map((function(e){return o.createElement("option",{key:e,value:e},e,"x")})))))}))))},t}(o.Component);t.default=r((function(){return{ul:{"& > li:nth-of-type(odd)":{backgroundColor:"#ECEFF1"}},assignment:{overflow:"hidden",marginTop:10,display:"flex",flexFlow:"row nowrap",alignItems:"center",padding:"2px 2px 2px 5px","& .title":{width:"calc(100% - 67px)",float:"left",fontFamily:"AvenirNextLTW02-Medium",fontSize:14},"& .weight":{float:"left",width:65}},weightSelector:{padding:5,"&:focus":{border:"1px solid #03A9F4"}}}}))(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({events:{"change .ddlAssignments":"asssignmentSelected","click .splitHere .btn-box":"splitHereClicked"},template:n(1567),textSectionListForSplitTemplate:n(1568),initialize:function(e){this.assignments=e.assignments,this.classId=e.classId,this.callback=e.callback,this.on("ok",this.splitAssignment),this.on("initialized",this.modalInitialized),this.on("unsplitAssignment",this.unsplitAssignment)},modalInitialized:function(e){var t=this;this.modal=e,this.assignments.length>0?i.GetAssignmentSplitData({assignmentIds:a.map(this.assignments,"AssignmentId"),classId:this.classId},(function(e){e&&(t.assignmentTextSectionsMap=e.textSectionNames,t.assignmentSplitData=e.currentAssignmentSplitData,t.modal.open())})):this.modal.open()},render:function(){return this.$el.html(this.template({assignments:this.assignments})),this.modal.disableOk(),this.modal.$el.find(".optionButton").hide(),this.$el.find("select").selectpicker(),this},asssignmentSelected:function(e){var t=this;this.currentSelectedAssignmentId=parseInt($(e.currentTarget).val());var n=a.filter(this.assignmentTextSectionsMap,{AssignmentId:this.currentSelectedAssignmentId});this.$el.find(".textSectionList").html(this.textSectionListForSplitTemplate({textSections:n}));var s=a.filter(this.assignmentSplitData,{AssignmentId:this.currentSelectedAssignmentId});s.length>0?(a.each(s,(function(e){var n=e.TextSectionIdStr.split(",").slice(-1)[0];t.$el.find('.splitHere[data-textsectionid="'+n+'"]').addClass("selected").find(".btn-box").addClass("selected")})),this.modal.$el.find(".optionButton").show()):this.modal.$el.find(".optionButton").hide()},splitHereClicked:function(e){$(e.currentTarget).toggleClass("selected").closest(".splitHere").toggleClass("selected"),this.$el.find(".splitHere.selected").length>0?this.modal.enableOk():this.modal.disableOk()},splitAssignment:function(e){e.preventClose();var t={assignmentId:this.currentSelectedAssignmentId,splitAfterTextSectionIds:a.map(this.$el.find(".textSectionList .splitHere.selected"),(function(e){return $(e).data("textsectionid")})),classId:this.classId};0!==t.splitAfterTextSectionIds.length?(e.disableOk("Splitting..."),i.SplitAssignment(t,(function(t){e.close(),t?new Backbone.BootstrapModal({title:"Assignment is split",content:"Your assignment has been split. We need to refresh the page.",okText:"Refresh",allowCancel:!1,cancelText:!1,cssClass:"modal-al-split-assignment-refresh"}).open((function(){window.location.reload(!0)})):s.bootstrap.alert({message:"There was an error splitting your assignment. Please contact Actively Learn if this problem persists.",autoClose:!1,alert:"danger"})}))):s.bootstrap.alert({message:'Select at least one "split" button where the assignment needs to be split at.',alert:"danger"})},unsplitAssignment:function(e){i.UnsplitAssignment({assignmentId:this.currentSelectedAssignmentId,classId:this.classId},(function(t){e.close(),t?new Backbone.BootstrapModal({title:"Assignment is unsplit",content:"Your assignment has been unsplit. We need to refresh the page.",okText:"Refresh",allowCancel:!1,cancelText:!1,cssClass:"modal-al-split-assignment-refresh"}).open((function(){window.location.reload(!0)})):s.bootstrap.alert({message:"There was an error unsplitting your assignment. Please contact Actively Learn if this problem persists.",autoClose:!1,alert:"danger"})}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",0===assignments.length?__p+='\n  <p>\n    There are no multi-section assignments visible for splitting up.\n    Learn more <a class="infoLink" target="_blank" href="'+(null==(__t=alcfg.helpArticleLink.splitAssignments)?"":__t)+'">here</a>.\n  </p>\n':(__p+='\n  <p>\n    Select the assignment that you want to split up below.\n    Learn more <a class="infoLink" target="_blank" href="'+(null==(__t=alcfg.helpArticleLink.splitAssignments)?"":__t)+'">here</a>.\n  </p>\n  <select class="ddlAssignments">\n    <option value="-1">Select an assignment</option>\n    ',_.each(assignments,(function(e){__p+='\n      <option value="'+(null==(__t=e.AssignmentId)?"":__t)+'">'+(null==(__t=e.Title)?"":__t)+"</option>\n    "})),__p+='\n  </select>\n  \n  <div class="textSectionList"></div>\n'),__p+="\n";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+=(null==(__t=textSections.length>0?'<span class="info">Click on the "SPLIT HERE" buttons at places you want to split up the assignment.</span>':"")?"":__t)+"\n\n",_.each(textSections,(function(e,t){__p+='\n  <span class="sectionHeading">'+(null==(__t=e.Title)?"":__t)+"</span>\n  ",t+1!==textSections.length&&(__p+='\n    <div class="splitHere" data-textsectionid="'+(null==(__t=e.TextSectionId)?"":__t)+'"><span class="btn-box">Split here</span></div>\n  ')})),__p+="";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=function(e){function t(t,n){var a=e.call(this,t)||this;return a.handleInputChange=a.handleInputChange.bind(a),a}return s(t,e),t.prototype.handleInputChange=function(e){this.props.setValue(e.target.name,e.target.checked)},t.prototype.render=function(){var e=this;return this.props.assignments.length>0?i.createElement("div",null,i.createElement("p",null,"Select which assignment grades you want to send to ",this.props.lmsName,"."),i.createElement("ul",{className:"checklist"},this.props.assignments.map((function(t){return i.createElement("li",{key:t.AssignmentId},i.createElement("div",{className:"checkbox"},i.createElement("input",{id:"chkSelectCourse"+t.AssignmentId,name:t.AssignmentId,type:"checkbox",className:"regular-checkbox",onChange:e.handleInputChange}),i.createElement("label",{htmlFor:"chkSelectCourse"+t.AssignmentId})),i.createElement("div",{className:"title"},o.sanitize(t.Title)))}))),this.props.includesAssignmentSplit&&i.createElement("p",null,"Note: For split assignments grades will be aggregated on your ",this.props.lmsName," account!")):i.createElement("p",null,"No ",o.getProductName()," assignments have been published to ",this.props.lmsName,"!")},t}(i.Component);t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(154),o=n(10);t.default=Backbone.View.extend({template:n(1571),initialize:function(e){this.on("initialized",this.modalInitialized),this.on("ok",this.syncGradebookWithGoogleCourse),this.courseId=e.courseId,this.gradebook=e.gradebook,this.alCourseWork=[]},events:{"change [type='checkbox']":"assignmentSelected"},modalInitialized:function(e){this.modal=e;var t=this,n=a.uniq(a.map(t.gradebook.Assignments,"AssignmentId"));0!==n.length?(s.bootstrap.alert({message:"Getting your assignments from Google Classroom...hang on for a few seconds and don't refresh the page!"}),Backbone.pubEv.trigger("loadingShowHide",!0),i.init(["https://www.googleapis.com/auth/classroom.coursework.students.readonly"],(function(){i.getCourseWork(t.courseId,null,(function(e){a.each(e,(function(e){if(e.associatedWithDeveloper&&e.materials&&e.materials.length>0&&e.materials[0].link){var a=s.getAssignmentIdFromUrl(e.materials[0].link.url);$.inArray(parseInt(a),n)>=0&&t.alCourseWork.push({courseWorkId:e.id,assignmentId:parseInt(a),assignmentTitle:e.title})}}));try{0===t.alCourseWork.length&&e.length>0&&rg4js("send",{error:new Error("Google syncGrades - 0 assignments"),customData:e})}catch(e){}Backbone.pubEv.trigger("loadingShowHide",!1),t.modal.open()}))}),!1)):s.bootstrap.alert({message:"No assignments in Gradebook!",alert:"danger"})},render:function(){return this.$el.html(this.template({assignments:this.alCourseWork})),this.modal.disableOk(),this},assignmentSelected:function(){0!==this.$el.find("ul.checklist input[type='checkbox']:checked").length?this.modal.enableOk():this.modal.disableOk()},syncGradebookWithGoogleCourse:function(e){if(e.preventClose(),!this.$el.parents(".modal").find(".btn.ok").hasClass("disabled")){e.disableOk("Syncing..."),Backbone.pubEv.trigger("loadingShowHide",!0);var t=[],n=this;if(a.each(this.$el.find("input[type='checkbox']:checked"),(function(e){var s=parseInt($(e).data("assignmentid"));a.each(n.gradebook.Students,(function(e){var i,o=a.filter(n.gradebook.Grades,{UserId:e.UserId,AssignmentId:s});o.length&&(i={UserId:o[0].UserId,AssignmentId:o[0].AssignmentId,PointsEarned:0,PointsPossible:0}),a.each(o,(function(e){i.PointsEarned+=e.PointsEarned,i.PointsPossible+=e.PointsPossible})),i&&0!==i.PointsPossible&&t.push({courseWorkId:a.find(n.alCourseWork,{assignmentId:s}).courseWorkId,googleUserId:e.Accounts.google.ExternalUserId,grade:Math.round(i.PointsEarned/i.PointsPossible*Math.pow(10,2))/Math.pow(10,0)})}))})),0===t.length)return Backbone.pubEv.trigger("loadingShowHide",!1),s.bootstrap.alert({message:"Already up-to-date!"}),void e.close();i.init(["https://www.googleapis.com/auth/classroom.coursework.students.readonly"],(function(){var r=a.uniq(a.map(t,"courseWorkId")),l=[],d=function(c){i.getStudentSubmissions(n.courseId,r[c],null,(function(i,u){l=l.concat(i),c===r.length-1?(a.each(l,(function(e){var n=a.find(t,{courseWorkId:e.courseWorkId,googleUserId:e.userId});n&&(n.studentSubmissionId=e.id)})),o.SyncGradebookWithGoogleCourse({syncData:t,courseId:n.courseId,googleOAuthToken:u},(function(t){e.close(),t?s.bootstrap.alert({message:"Synced grades successfully!"}):s.bootstrap.alert({message:"Failed to sync grades with your Google Classroom course work! We are looking into it.",alert:"danger"})}))):d(++c)}))};d(0)}),!1)}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",assignments.length>0?(__p+='\n    <p>Select which assignment grades you want to send to Google Classroom.</p>\n    <ul class="checklist">\n        ',_.each(assignments,(function(e,t){__p+='\n            <li>\n                <div class="checkbox">\n                    <input id="chkSelectCourse'+(null==(__t=e.assignmentId)?"":__t)+'" data-assignmentid="'+(null==(__t=e.assignmentId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n                    <label for="chkSelectCourse'+(null==(__t=e.assignmentId)?"":__t)+'"></label>\n                </div>\n                <div class="title">'+(null==(__t=cH.sanitize(e.assignmentTitle))?"":__t)+"</div>\n            </li>\n        "})),__p+="\n    </ul>\n"):__p+="\n    <p>No "+(null==(__t=cH.getProductName())?"":__t)+" assignments have been published to Google Classroom!</p>\n",__p+="";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(13).withStyles,r=n(24),l=n(150),d=n(197),c=n(198),u=n(231),p=n(10),h=function(e){function t(t,n){var a=e.call(this,t)||this;return a.handleColumnToggle=function(e){return function(t){var n=a.state.columnsToShow;if($(t.currentTarget).find('input[type="checkbox"]')[0].checked){var s=n.map((function(e){return e.value})).indexOf(e.value);-1!==s&&n.splice(s,1)}else n.push(e);a.setState({columnsToShow:n})}},a.onSubmit=function(){var e=a.state.columnsToShow.map((function(e){return e.value}));p.UpdateClassActivityColumnsToShow({columnsToShow:e},(function(){})),Backbone.pubEv.trigger("setGradeBookActivityColumns",e),r.hideModals()},a.state={columnsToShow:t.columnsToShow},a}return s(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.classes,a=t.columnFilters,s=t.columnsToShow;return i.createElement(r.default,{title:"Add/Remove Columns",okText:"Update",okCallback:this.onSubmit,cssClass:"modal-al-activity-add-remove-columns"},i.createElement("p",null,"Select columns that you want to see in the Activity Report"),i.createElement(d.default,{className:n.list},a.map((function(t,a){return i.createElement(g,{classes:n,columnName:t,columnsSelected:s,handleChange:e.handleColumnToggle})}))))},t}(i.Component),g=function(e){var t=e.columnName,n=e.handleChange,a=e.columnsSelected,s=(e.classes,a.map((function(e){return e.value})).indexOf(t.value)>-1);return i.createElement(c.default,{key:t.value,button:!0,onClick:n(t)},i.createElement(l.default,{color:"primary",checked:s}),i.createElement(u.default,{style:{padding:0},primary:t.label}))};t.default=o((function(){return{checkbox:{display:"inline-block"}}}))(h)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(10),l=n(1574),d=n(1576),c=n(1578),u=n(154),p=n(20),h=n(72),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.classM=sCH.classesC.getModelByClassId(t.props.classId),t.inviteStudents=function(){new Backbone.BootstrapModal({content:new l.default({classM:t.classM}),okText:"Done",cancelText:!1,cssClass:"modal-lg addStudents",optionButtons:p.default.isMath?[]:[{text:"Play student overview video",event:"showInstructionalVideo"}]}).open(),Backbone.tracking.trackGAEvent("teacher","addStudents:start")},t.seeUnenrolledStudents=function(){new Backbone.BootstrapModal({title:"Unenrolled students",content:new d.default({classId:t.classM.get("ClassId"),scope:t.props.scope}),okText:"Restore",cssClass:"modal-lg modal-al-unenrolled-students"})},t.mergeStudentAccounts=function(){var e=t.props.scope,n=e.studentsC;new Backbone.BootstrapModal({title:"Merge 2 student accounts",content:new c.default({classId:t.props.classId,classStudents:n.models,successCallback:function(t){n.remove(n.find({UserId:t})),e.renderRoster()}}),okText:"Merge",cssClass:"modal-al-merge-student-accounts"}).open()},t.removeStudents=function(){var e=t.props.scope,n=t.classM.get("Source"),a={clever:"Clever",edmodo:"Edmodo",canvas:"Canvas",schoology:"Schoology",oneroster:"your district SIS"}[n],s=new Backbone.BootstrapModal({title:"Remove students",content:"canvas"===n?"Your class roster will sync with "+a+" and students that have been concluded or removed from "+a+" course or section will be marked in red.":"Your class roster will sync with "+a+" and students no longer in your "+a+" class will be "+("clever"===n?"marked in red.":"removed."),okText:"Continue"}).open((function(){s.disableOk("Removing..."),s.preventClose(),r.RemoveStudents({source:n,classId:e.classId},(function(){s.close(),o.bootstrap.alert({message:"Your class roster has successfully synced with "+a+"."}),e.renderRoster()}),(function(e){s.close(),o.bootstrap.alert({message:o.getErrorTextFromResponse(e),autoClose:!1,alert:"danger"})}))}))},t.syncWithGoogleCourse=function(){var e=t.props.scope,n=t.classM,a=function(){var t=n.get("ExternalClassId");o.bootstrap.alert({message:"Getting your latest class details from Google...hang on for a few seconds and don't refresh the page!",autoClose:"longer"}),Backbone.pubEv.trigger("loadingShowHide",!0),u.getCourseName(t,(function(a,s){r.SyncWithGoogleCourse({classId:e.classId,externalClassId:t,googleOAuthToken:s},(function(t){t&&t.success?(e.renderRoster(),t.numUsersDeletedInClassroom?new Backbone.BootstrapModal({title:"Sync with Classroom complete!",content:"<p>\n                    "+o.plural(t.numUsersDeletedInClassroom,"%count student","%count students")+" \n                    that joined this class in "+o.getProductName()+" "+o.plural(t.numUsersDeletedInClassroom,"is","are")+" \n                    not in this class in Classroom. They are marked in red in your roster.                     You can delete them here or switch them to another class.\n                  </p>",cancelText:!1,allowCancel:!1}).open():o.bootstrap.alert({message:"Sync with Classroom complete!"}),n.set({Name:a}),n.hasChanged("Name")&&(Backbone.pubEv.trigger("setSiteSection",a),sCH.classesC.updateClass({classId:n.get("ClassId"),name:a,gradeLevel:n.get("GradeLevel")}))):o.bootstrap.alert({message:"Sync with Classroom failed! We are looking into it.",alert:"danger"})}))}))};window.googleHelper.oauthToken?a():(window.googleHelper.callback=a,gapi.auth.authorize({client_id:p.default.googleApiClientId,scope:window.googleHelper.scopes,immediate:!1,authuser:-1,user_id:sCH.userM.get("Accounts").google.ExternalUserId},window.googleHelper.handleAuthResult))},t}return s(t,e),t.prototype.render=function(){var e=this.classM.get("Source"),t=-1!==["clever","edmodo","canvas","schoology","oneroster","achieve3k"].indexOf(e),n=-1===["lti","canvas","schoology","oneroster","achieve3k"].indexOf(e),a=!!sCH.userM.get("Accounts").google;return"google"===e?a&&i.createElement(h.default,{"data-tab":"roster",buttonClass:"btn-box btnSyncWithGoogleCourse",onClick:this.syncWithGoogleCourse,buttonTitle:"Sync the roster in your Google Course with this "+o.getProductName()+" class"},"Sync Class with Google Classroom"):i.createElement(i.Fragment,null,this.props.showInviteStudentCode&&i.createElement(h.default,{onClick:this.inviteStudents,"data-tab":"roster",buttonClass:"btn-box btnInviteStudents",buttonTitle:"Invite students to join this class"},"Invite Students"),n&&i.createElement(h.default,{"data-tab":"roster",buttonClass:"btn-box btnSeeUnenrolledStudents",onClick:this.seeUnenrolledStudents,buttonTitle:"Restore unenrolled students in this class"},"Restore students"),t&&i.createElement(h.default,{"data-tab":"roster",buttonClass:"btn-box btnRemoveStudents",onClick:this.removeStudents,buttonTitle:"Remove students"},"Remove Students"),n&&i.createElement(h.default,{"data-tab":"roster",buttonClass:"btn-box btnMergeStudentAccounts",onClick:this.mergeStudentAccounts,buttonTitle:"Merge student accounts"},"Merge Accounts"))},t}(i.Component);t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(20);t.default=Backbone.View.extend({template:n(1575),initialize:function(e){this.on("showInstructionalVideo",this.showInstructionalVideo),this.classM=e.classM},render:function(){return this.$el.html(this.template({c:this.classM.toJSON(),isMath:s.default.isMath})),this},showInstructionalVideo:function(){var e=a.windowOpen(alcfg.helpArticleLink.studentOverview);window.isIOSApp||e.focus()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","clever"===c.Source?__p+="\r\n    <p>\r\n        Your class rosters will be automatically populated when your students log into "+(null==(__t=cH.getProductName())?"":__t)+" through Clever.\r\n        Make sure your students sign up or log in to "+(null==(__t=cH.getProductName())?"":__t)+' by pressing the Clever button!\r\n    </p>\r\n    <img src="/img/CleverLaunchpad.png" style="width: 648px;"/>\r\n    <p class="info">Note: Since you are using Clever, you cannot add or delete individual students. This data must be managed through your SIS.</p>\r\n':"achieve3k"===c.Source?__p+='\r\n    <p>\r\n        Your students will appear below when they click the "'+(null==(__t=cH.getProductName())?"":__t)+'" link in Achieve3000.\r\n    </p>\r\n    <p class="info">\r\n        Note: Since this class was imported from Achieve3000, you cannot add students through '+(null==(__t=cH.getProductName())?"":__t)+'.\r\n        Make sure your students click the "'+(null==(__t=cH.getProductName())?"":__t)+'" link in Achieve3000 and they will be automatically joined to your '+(null==(__t=cH.getProductName())?"":__t)+" class.\r\n    </p>\r\n":"canvas"===c.Source?__p+='\r\n    <p>\r\n        Your students will appear below when they click the "'+(null==(__t=cH.getProductName())?"":__t)+'" link in Canvas.\r\n    </p>\r\n    <p class="info">\r\n        Note: Since this class was imported from Canvas, you cannot add students through '+(null==(__t=cH.getProductName())?"":__t)+'.\r\n        First add them to the course or section in Canvas and then have the student click the "'+(null==(__t=cH.getProductName())?"":__t)+'" link in Canvas and they will be automatically joined to your '+(null==(__t=cH.getProductName())?"":__t)+" class.\r\n    </p>\r\n":"schoology"===c.Source?__p+='\r\n    <p>\r\n        Your students will appear below when they click the "'+(null==(__t=cH.getProductName())?"":__t)+'" link in schoology.\r\n    </p>\r\n    <p class="info">\r\n        Note: Since this class was imported from schoology, you cannot add students through '+(null==(__t=cH.getProductName())?"":__t)+'.\r\n        First add them to the course or section in schoology and then have the student click the "'+(null==(__t=cH.getProductName())?"":__t)+'" link in schoology and they will be automatically joined to your '+(null==(__t=cH.getProductName())?"":__t)+" class.\r\n    </p>\r\n":"edmodo"===c.Source?__p+="\r\n    <p>\r\n        Your class rosters will be automatically populated when your students log into "+(null==(__t=cH.getProductName())?"":__t)+" through Edmodo.\r\n        Make sure your students sign up or log in to "+(null==(__t=cH.getProductName())?"":__t)+" by pressing the blue Edmodo button!\r\n    </p>\r\n    <p class=\"info\">Note: Since this class was imported from Edmodo, you cannot add individual students. This data must be managed through Edmodo. To remove students, click the 'Remove Students' button.</p>\r\n":"lti"===c.Source?__p+="\r\n    <p>\r\n        Your class rosters will be automatically populated when your students log into "+(null==(__t=cH.getProductName())?"":__t)+" through "+(null==(__t=cH.capitalizeString(c.SourceProduct))?"":__t)+".\r\n        Make sure your students sign up or log in to "+(null==(__t=cH.getProductName())?"":__t)+" by clicking on the "+(null==(__t=cH.getProductName())?"":__t)+" link in "+(null==(__t=cH.capitalizeString(c.SourceProduct))?"":__t)+'.\r\n    </p>\r\n    <p class="info">Note: Since this class was imported from '+(null==(__t=cH.capitalizeString(c.SourceProduct))?"":__t)+", you cannot add individual students manually in "+(null==(__t=cH.getProductName())?"":__t)+". To remove students, click the 'Remove Students' button.</p>\r\n":"oneroster"===c.Source?__p+='\r\n    <p>The roster will automatically populate when your students log in to the district portal.</p>\r\n    <p class="info">Note: Since this class was imported from your district SIS, you cannot add individual students manually in '+(null==(__t=cH.getProductName())?"":__t)+". Make sure your students sign up or log in to "+(null==(__t=cH.getProductName())?"":__t)+" by clicking the "+(null==(__t=cH.getProductName())?"":__t)+" link in the district portal. To remove students, click the 'Remove Students' button.</p>\r\n":__p+='\r\n    <div class="inviteLinkCaption">Students can sign up or log in at</div>\r\n    <div class="inviteLink">\r\n        '+(null==(__t=isMath?"math.achieve3000.com":"www.activelylearn.com")?"":__t)+'\r\n    </div>\r\n    <div class="classCodeCaption">and join this class using the code</div>\r\n    <div class="classCode">'+(null==(__t=c.Code)?"":__t)+"</div>\r\n",__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1577),initialize:function(e){this.classId=e.classId,this.scope=e.scope,this.on("ok",this.restoreAccount),this.on("initialized",this.modalInitialized)},modalInitialized:function(e){var t=this;this.modal=e,i.GetDeletedStudentsList(this.classId,(function(n){n&&(t.deletedStudents=n,e.open())}))},render:function(){return this.deletedStudents.length>0?this.$el.html(this.template({deletedStudents:this.deletedStudents})):(this.$el.html('<div class="ctaInfo">There are no unenrolled students in this class.</div>'),this.modal.$el.find(".btn.ok").hide()),this},restoreAccount:function(e){var t=[],n=this;e.preventClose(),a.each(this.$el.find("input[type='checkbox']:checked"),(function(e){t.push($(e).data("userid"))})),0!==t.length?(e.disableOk("Restoring..."),i.UndeleteStudents({userIds:t,classId:this.classId},(function(i){if(i){var o=a.filter(n.deletedStudents,(function(e){return $.inArray(e.UserId,t)>-1}));n.scope.studentsC.add(o),n.scope.mountRoster(),s.bootstrap.alert({message:"The selected students have been re-enrolled to this class."}),e.close()}else s.bootstrap.alert({message:"There was a problem. Try again later.",alert:"danger"})}))):s.bootstrap.alert({message:"Select at least one student to re-enroll.",alert:"danger"})}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<table class="checklist">\n    <thead>\n        <tr>\n            <th></th>\n            <th class="name" style="width: 200px;">Name</th>\n            <th class="name" style="width: 330px;">Username</th>\n            <th>Unenroll Date</th>\n        </tr>\n    </thead>\n    ',_.each(deletedStudents,(function(e){__p+='\n        <tr>\n            <td>\n                <div class="checkbox">\n                    <input id="chkSelectClass'+(null==(__t=e.UserId)?"":__t)+'" data-userid="'+(null==(__t=e.UserId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n                    <label for="chkSelectClass'+(null==(__t=e.UserId)?"":__t)+'"></label>\n                </div>\n            </td>\n            <td><span class="title">'+(null==(__t=cH.sanitize(e.FirstName+" "+e.LastName))?"":__t)+'</span></td>\n            <td><span class="title">'+(null==(__t=cH.sanitize(e.UserName))?"":__t)+'</span></td>\n            <td><span class="title">'+(null==(__t=moment.utc(e.ClassLeaveDate).local().format("MM/DD/YY"))?"":__t)+"</span></td>\n        </tr>\n    "})),__p+="\n</table>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1579),initialize:function(e){this.classStudents=a.sortBy(a.reject(e.classStudents,(function(e){return e.get("IsMappedToTeacher")})),(function(e){return e.get("LastName")})),this.classId=e.classId,this.successCallback=e.successCallback,this.on("initialized",this.modalInitialized),this.on("ok",this.mergeAccounts)},modalInitialized:function(e){this.modal=e},render:function(){return this.classStudents.length<2&&this.modal.$el.find(".btn.ok").hide(),this.$el.html(this.template({classStudents:this.classStudents})),this.$el.find("select").selectpicker(),this},mergeAccounts:function(e){e.preventClose();var t=this,n=this.$el.find(".ddPrimaryAccount").val(),a=this.$el.find(".ddToMergeAccount").val(),o=this.$el.find(".ddToMergeAccount option:selected").text(),r=t.$el.find(".ddPrimaryAccount option:selected").text();if(n&&a)if(n!==a)var l="<p>&bull; All data from "+o+" will be merged into "+r+".<br/>\n      &bull; "+o+'\'s account will be deleted.</p>\n      <input id="txtConfirmMerge" placeholder=\'Type "merge"\'></input>',d=new Backbone.BootstrapModal({title:"Are you sure you want to merge these accounts?",content:'<p>Confirm the details below and type "merge" in the box to continue.</p>'+l,okText:"Confirm",cssClass:"modal-al-merge-student-accounts-confirm"}).open((function(){d.preventClose(),"merge"===d.$el.find("#txtConfirmMerge").val().toLowerCase()?(d.close(),e.disableOk("Merging..."),n=parseInt(n),a=parseInt(a),i.MergeStudentAccounts({classId:t.classId,primaryUserId:n,toMergeUserId:a},(function(n){n?(e.close(),t.successCallback(a),s.bootstrap.alert({message:"The student account "+o+" was merged into "+r+". \n              Please ask the student to log out and log back in with "+r+".",autoClose:!1})):s.bootstrap.alert({message:"Something went wrong. Please try again later.",alert:"danger"})}))):s.bootstrap.alert({message:'Please type "merge" in the box to confirm the action.',alert:"danger"})}));else s.bootstrap.alert({message:"Select a different account to merge to.",alert:"danger"});else s.bootstrap.alert({message:"Select a primary account and the account to merge.",alert:"danger"})}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",0===classStudents.length?__p+='\n    <p class="warning">There are no students in this class.</p>\n':1===classStudents.length?__p+='\n    <p class="warning">There is only 1 student in this class.</p>\n':(__p+='\n    <p>When merging accounts, choose the one that has the correct username for the student as the primary account.</p>\n    <p class="info">All student data for all classes for the account being merged will be merged into the primary account.<p>\n    <p>\n        <label class="lblTwoCol">Primary account</label>\n        <select class="ddPrimaryAccount fs-hide">\n            <option value="">Select primary account</option>\n            ',_.each(classStudents,(function(e){__p+='\n                <option value="'+(null==(__t=e.get("UserId"))?"":__t)+'">'+(null==(__t=cH.sanitize(e.get("LastName")+", "+e.get("FirstName")+" ("+e.get("UserName")+")"))?"":__t)+"</option>\n            "})),__p+='\n        </select>\n    </p>\n    <div class="clearFloat"></div>\n    <p>\n        <label class="lblTwoCol">Account to merge</label>\n        <select class="ddToMergeAccount fs-hide">\n            <option value="">Select account to be merged</option>\n            ',_.each(classStudents,(function(e){__p+='\n                <option value="'+(null==(__t=e.get("UserId"))?"":__t)+'">'+(null==(__t=cH.sanitize(e.get("LastName")+", "+e.get("FirstName")+" ("+e.get("UserName")+")"))?"":__t)+"</option>\n            "})),__p+='\n        </select>\n    </p>\n    <p class="warning">Note: This action cannot be undone.</p>\n'),__p+="";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(5),d=n(784),c=n(72),u=n(234),p=n(8),h=n(20),g={container:function(e){return i(i({},e),{fontSize:16,fontWeight:400,fontFamily:"AvenirNextLTW02-Medium"})},control:function(e,t){return i(i({},e),{color:t.isFocused?"#777":"black",padding:0,display:"flex",maxHeight:25,width:250,cursor:"pointer",borderColor:t.isFocused?"#03a9f4":"rgba(0,0,0,0.2)","&:hover":{borderColor:"#03a9f4"}})},menu:function(e){return i(i({},e),{zIndex:3,width:"auto",minWidth:250,marginTop:10})}},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={students:[],showPrint:!1,showExport:!1,selectedStudent:null,studentUserId:null,gradesExportData:null},t.setGradesExportData=function(e){return t.setState({gradesExportData:e})},t.printCurrentView=function(){var e=t.getSelectedTabJoinedName()+" - "+t.getStudentName();l.print(e)},t.exportTable=function(){var e=t.getSelectedTabJoinedName()+" - "+t.getStudentName(),n=t.state.gradesExportData,a=n.grades,s=n.customizedWeightsExist,i='"Assignments",'+(s?'"Weight",':"")+'"Grades (points earned so far)","Question Progress (# unanswered)"\n'+a.map((function(e){var t=e.PointsEarned*e.Weight,n=e.PointsPossible*e.Weight,a=l.percent(e.PointsEarned/e.PointsPossible),i=1!==e.Weight?e.Weight+"x":"",o=l.percent(e.NumOfResponses/e.Questions),r=n>0?t+"/"+n+" ("+a+")":"";return'"'+e.Title+'",'+(s?'"'+i+'",':"")+'"'+r+'","'+o+"("+(e.Questions-e.NumOfResponses)+')"'})).join("\n");d.exportCSV(i,e,"Grades Report")},t.getSelectedTabJoinedName=function(){return $("a.btnSwitchReportType.selected").map((function(){return $(this).text()})).get().join(":")},t.getStudentName=function(){var e=t.state.students.map((function(e){return{value:e.UserId,label:e.LastName+(e.LastName?", ":"")+e.FirstName}})),n=p.find(e,{value:t.state.studentUserId});return(t.state.selectedStudent||n||e[0]).label},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("InitializeStudentDataStudentList",(function(t){e.setState({students:t.students,studentUserId:t.studentUserId})})),Backbone.pubEv.on("UpdateStudentDataSubheaderButtons",(function(t){["overview","standards","writing"].indexOf(t.subtab)>-1?e.setState({showPrint:!0,showExport:!1}):["assignments"].indexOf(t.subtab)>-1?e.setState({showPrint:!1,showExport:!0}):e.setState({showPrint:!1,showExport:!1})})),Backbone.pubEv.on("setGradesExportBtnAction",this.setGradesExportData)},t.prototype.componentDidUpdate=function(){l.adjustHeaderSpacing()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("InitializeStudentDataStudentList"),Backbone.pubEv.off("UpdateStudentDataSubheaderButtons"),Backbone.pubEv.off("setGradesExportBtnAction",this.setGradesExportData)},t.prototype.render=function(){var e=this,t=this.state.students.length>0,n=this.state.students.map((function(e){return{value:e.UserId,label:e.LastName+(e.LastName?", ":"")+e.FirstName}})),a=p.find(n,{value:this.state.studentUserId});return h.default.isMath?null:o.createElement(o.Fragment,null,t&&o.createElement(u.default,{value:this.state.selectedStudent||a||n[0],suggestions:n,onChange:function(t){var n=parseInt(t.value,10);e.setState({selectedStudent:t}),Backbone.pubEv.trigger("studentDataUserSelected",n)},inputId:"select-student",customSelectStyles:g}),this.state.showPrint&&o.createElement(c.default,{"data-tab":"studentData",buttonTitle:"Print",buttonClass:"icon-print btn-tab btnStudentDataPrint"+(!t||sCH.userM.isOnFreePlan()?" disabled":""),onClick:this.printCurrentView}),this.state.showExport&&o.createElement(c.default,{"data-tab":"studentData",buttonClass:"btn-box btnStudentDataExport "+(t&&!sCH.userM.isOnFreePlan()?"":"disabled"),onClick:this.exportTable},"Export",!l.onDevice()&&" Data"," ",o.createElement("span",{className:"primeFeature icon-premium-lock"})))},t}(r.Component);t.default=f},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(5),l=n(72),d=n(155),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showSort:!1},t.printCurrentView=function(){var e=t.getSelectedTabJoinedName();r.print(e)},t.getSelectedTabJoinedName=function(){return $("a.btnSwitchReportType.selected").map((function(){return $(this).text()})).get().join(":")},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("UpdateClassDataSubheaderButtons",(function(t){e.setState({showSort:"vocabulary"===t.subtab})}))},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("UpdateClassDataSubheaderButtons")},t.prototype.render=function(){return i.createElement(i.Fragment,null,this.state.showSort&&i.createElement(d.default,{dropdownClass:"dropdown sortDropdown vocabulary",buttonTitle:"Sort",buttonClass:"classDataBtn btnSorting icon-sort",buttonId:"btnSorting",tooltipPlacement:"left"},i.createElement(d.DropdownItem,{className:"selected","data-sort":"recency",text:"Recent"}),i.createElement(d.DropdownItem,{"data-sort":"frequency",text:"Frequent"})),i.createElement(l.default,{"data-tab":"classData",buttonTitle:"Print",buttonClass:"icon-print btn-tab btnClassDataPrint",onClick:this.printCurrentView}))},t}(o.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1583),i=n(1586),o=n(1587),r=n(48),l=n(5),d=n(155);t.default=function(e){return a.createElement(a.Fragment,null,a.createElement(c,{isOnFreePlan:e.isOnFreePlan,startSelectMode:e.startSelectMode}),a.createElement(u,{isOnFreePlan:e.isOnFreePlan,startSelectMode:e.startSelectMode}),a.createElement("button",{"data-tab":"assignment",className:"btn-box btnPostUrl",onClick:function(t){return e.startSelectMode(t)},"data-selectmode":"multiple","data-selecttype":"ok"},"Post URL"),(!window.isIOSApp||window.isIOSApp&&sCH.userM.isOnPrimePlan())&&a.createElement("button",{"data-tab":"assignment",className:"btn-box btnAssignToIndividuals",onClick:function(t){if(sCH.userM.isOnFreeOrPersonalPlan()){r.showBuyTeacherPopup({title:"Assign to individual students",content:"Easily differentiate instruction within your class by assigning texts to individual students."})}else e.startSelectMode(t)},"data-selectmode":"multiple","data-selecttype":"ok","data-singleselectbycssclass":"hasAssignees"},"Assign to individuals",a.createElement("span",{className:"primeFeature icon-premium-lock"})),a.createElement(s.default,{scope:e.scope,classId:e.classId,startSelectMode:e.startSelectMode}),l.onDevice()&&a.createElement(p,{startSelectMode:e.startSelectMode}),a.createElement(i.default,{classId:e.classId,onChangeEventName:"filterAssignmentsByLabel"}),a.createElement(o.default,{scope:e.scope}))};var c=function(e){return a.createElement(d.default,{dropdownClass:"settingsDropdown",customProps:{"data-tab":"assignment"},buttonClass:"btn-box",buttonId:"settingsDropdown",buttonChild:a.createElement(a.Fragment,null,"Assignment Settings ",a.createElement("span",{className:"icon-dropdown-arrow"}))},a.createElement(h,{className:"btnAssignmentSettings",text:"Reading settings",props:e}),a.createElement(h,{className:"btnAssignmentSmallGroupSettings",text:a.createElement(a.Fragment,null,"Small groups settings ",a.createElement("span",{className:"primeFeature icon-premium-lock"})),props:e}))},u=function(e){return a.createElement(d.default,{dropdownClass:"lockUnlockDropdown",customProps:{"data-tab":"assignment"},buttonClass:"btn-box btnLockUnlock",buttonId:"lockUnlockDropdown",buttonChild:a.createElement(a.Fragment,null,"Lock / unlock ",a.createElement("span",{className:"icon-dropdown-arrow"}))},a.createElement(h,{className:"btnLockAssignment",text:"Schedule locking",props:e}),a.createElement(h,{className:"btnUnlockAssignment",text:"Schedule unlocking",props:e}),a.createElement(h,{className:"btnClearLock",text:"Clear",props:e}))},p=function(e){return a.createElement(d.default,{buttonClass:"btn-box",dropdownClass:"moreDropdown hideIfNoLayers",menuCustomClass:"moreActions",customProps:{"data-tab":"assignment"},buttonChild:a.createElement(a.Fragment,null,"More ",a.createElement("span",{className:"icon-dropdown-arrow"})),buttonId:"moreDropdown"},a.createElement(d.DropdownItem,{className:"btnLockAssignment","data-selectmode":"single","data-selecttype":"ok","data-selectfilter":"locked",onClick:function(t){return e.startSelectMode(t)},text:"Lock / Unlock"}),a.createElement(d.DropdownItem,{className:"btnPostUrl","data-selectmode":"multiple","data-selecttype":"ok",onClick:function(t){return e.startSelectMode(t)},text:"Post URL"}),(!window.isIOSApp||window.isIOSApp&&e.isOnFreePlan)&&a.createElement(h,{className:"btnAssignToIndividuals",text:"Assign to individuals",props:e}),a.createElement(h,{className:"btnAssignmentSettings",text:"Assignment Settings",props:e}),a.createElement(h,{className:"btnAssignmentSmallGroupSettings",text:a.createElement(a.Fragment,null,"Small groups settings ",a.createElement("span",{className:"primeFeature icon-premium-lock"})),props:e}))},h=function(e){var t=e.text,n=e.className,s=e.props;return a.createElement(d.DropdownItem,{className:n,text:t,onClick:function(e){return s.startSelectMode(e)},"data-selectmode":"single","data-selecttype":"ok"})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1584),r=n(155),l=n(14),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={archivedAssignmentCount:null},t.unarchiveAssignment=function(){new Backbone.BootstrapModal({title:"Unarchive Assignments",content:new o.default({classId:t.props.classId,scope:t.props.scope}),okText:"Unarchive",cssClass:"modal-al-unarchive-assignments"})},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("updateArchivedAssignmentCount",(function(t){e.setState({archivedAssignmentCount:t.archivedAssignmentCount})}))},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("updateArchivedAssignmentCount")},t.prototype.render=function(){var e=this,t=sCH.classesC.findWhere({ClassId:this.props.classId});return i.createElement(r.default,{dropdownClass:"manageDropdown",buttonClass:"btn-box btnManage",buttonId:"btnManage",customProps:{"data-tab":"assignment"},buttonChild:i.createElement(i.Fragment,null,"Manage",i.createElement("span",{className:"icon-dropdown-arrow"}))},i.createElement(r.DropdownItem,{text:"Archive",onClick:function(t){return e.props.startSelectMode(t)},"data-selectmode":"multiple","data-selecttype":"ok",className:"togglable btnArchiveAssignment"}),i.createElement(r.DropdownItem,{text:i.createElement(i.Fragment,null,"Unarchive",this.state.archivedAssignmentCount>0&&i.createElement("span",{className:"txtArchivedAssignmentCount"},"("+this.state.archivedAssignmentCount+" assignments)")),className:"btnUnarchiveAssignment",onClick:this.unarchiveAssignment}),i.createElement(r.DropdownItem,{className:"togglable btnUnassignLessons",text:"Unassign",onClick:function(t){return e.props.startSelectMode(t)},"data-selectmode":"multiple","data-selecttype":"destructive"}),i.createElement(r.DropdownItem,{className:"togglable hideForMath btnManageLicenses",text:"Rental licenses","data-selectmode":"single",onClick:function(t){return e.props.startSelectMode(t)},"data-selecttype":"ok"}),t.get("Source")===l.ClassSource.GOOGLE&&t.get("ExternalClassId")&&i.createElement(r.DropdownItem,{className:"togglable btnSyncAssignmentWithClassroom",text:"Sync assignments with Google Classroom","data-selectmode":"multiple",onClick:function(t){return e.props.startSelectMode(t)},"data-selecttype":"ok"}),t.get("Source")===l.ClassSource.CANVAS&&t.get("ExternalClassId")&&i.createElement(r.DropdownItem,{className:"togglable btnSyncAssignmentWithCanvas",text:"Sync assignments with Canvas","data-selectmode":"multiple",onClick:function(t){return e.props.startSelectMode(t)},"data-selecttype":"ok","data-selectiondisallowedclassname":"canvasSynced"}))},t}(i.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1585),initialize:function(e){this.classId=e.classId,this.scope=e.scope,this.on("initialized",this.modalInitialized),this.on("ok",this.unarchiveAssignments)},modalInitialized:function(e){var t=this;this.modal=e,i.GetArchivedAssignments({classId:this.classId},(function(n){n&&(t.archivedAssignments=n,e.open())}))},render:function(){return this.archivedAssignments.length>0?this.$el.html(this.template({archivedAssignments:this.archivedAssignments})):(this.$el.html('<div class="ctaInfo">There are no archived assignments in this class.</div>'),this.modal.$el.find(".btn.ok").hide()),this},unarchiveAssignments:function(e){var t=[],n=this;e.preventClose(),a.each(this.$el.find("input[type='checkbox']:checked"),(function(e){t.push($(e).data("assignmentid"))})),0!==t.length?(e.disableOk("Unarchiving..."),i.UnarchiveAssignment({assignmentIds:t,classId:this.classId},(function(a){a?(sCH.clearCollection("classesC"),sCH.initClasses((function(){n.scope.assessScroll.preRender(n.scope.assessScroll.classM.get("ClassId")),n.scope.assessScroll.archivedAssignmentCount-=t.length,Backbone.pubEv.trigger("updateArchivedAssignmentCount",{archivedAssignmentCount:n.scope.assessScroll.archivedAssignmentCount}),Backbone.pubEv.trigger("updateMainMenuNotification",{classId:n.classId,assignmentIds:t,isRemoved:!1}),s.bootstrap.alert({message:"The selected assignments have been unarchived."}),e.close()}),!1)):s.alertBackendError()}))):s.bootstrap.alert({message:"Select at least one assignment to unarchive.",alert:"danger"})}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p>Select assignments that you want to unarchive.</p>\n<ul class="checklist">\n    ',_.each(archivedAssignments,(function(e){__p+='\n        <li>\n            <div class="checkbox">\n                <input id="chkSelectAssignment'+(null==(__t=e.AssignmentId)?"":__t)+'" data-assignmentid="'+(null==(__t=e.AssignmentId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n                <label for="chkSelectAssignment'+(null==(__t=e.AssignmentId)?"":__t)+'"></label>\n            </div>\n            <div class="title">'+(null==(__t=cH.sanitize(e.Title))?"":__t)+"</div>\n        </li>\n    "})),__p+="\n</ul>\n";return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(8),l=n(234),d=n(72),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={labels:[],selectedLabels:[]},t.handleChange=function(e){var n=e.map((function(e){return e.value}));Backbone.pubEv.trigger(t.props.onChangeEventName,n),t.setState({selectedLabels:n})},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;Backbone.pubEv.on("InitializeLabels",(function(t){t=r.uniq(t).sort(),e.setState({labels:t})}))},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("InitializeLabels")},t.prototype.render=function(){var e=0===this.state.labels.length;return i.createElement(l.MultiSelectFilter,{suggestions:this.state.labels.map((function(e){return{value:o.sanitize(e),label:o.sanitize(e)}})),onChange:this.handleChange,menuPosition:"center",isDisabled:e,className:"btn-tab"},i.createElement(d.default,{buttonClass:o.classNames({"icon-tag":!0,selected:this.state.selectedLabels.length>0,disabled:e,hideForMath:!0}),tabIndex:e?-1:null,buttonTitle:"Filter by label",style:{padding:0},tooltipPlacement:"bottom"}))},t}(i.Component);t.default=c},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(155),r=[{value:"viewdate",label:"Last view date"},{value:"ungraded",label:"Ungraded"},{value:"assigneddate",label:"Assigned date"},{value:"title",label:"Title"},{value:"state",label:"State (locked vs unlocked)"}],l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={sortBy:"viewdate"},t}return s(t,e),t.prototype.sort=function(e){this.setState({sortBy:e}),this.props.scope.assessScroll.sort(e)},t.prototype.render=function(){var e=this;return i.createElement(o.default,{dropdownClass:"sortDropdown",buttonClass:"btnSorting icon-sort",customProps:{"data-tab":"assignment"},buttonTitle:"Sort Assignments",buttonId:"sortDropdown",menuCustomClass:"dropdown-menu-right assess"},r.map((function(t){return i.createElement(o.DropdownItem,{key:t.value,className:e.state.sortBy===t.value?"selected":"",onClick:function(t){return e.sort($(t.currentTarget).data("sort"))},"data-sort":t.value,text:t.label})})))},t}(i.Component);t.default=l},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.setTilesSelected=function(e){return a.setState({tilesSelected:e})},a.state={tilesSelected:!1},a}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("tilesSelected",this.setTilesSelected)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("tilesSelected",this.setTilesSelected)},t.prototype.render=function(){return i.createElement("div",{className:"selectedAction",style:{display:"block",position:"relative"}},i.createElement("div",{className:"selectedActionInner"},i.createElement("span",{className:"text"},this.props.displayText),this.props.next&&i.createElement("button",{className:"btnNext btn-box"+(this.state.tilesSelected?"":" disabled"),onClick:this.props.next,tabIndex:this.state.tilesSelected?null:-1},this.props.okText||"Next"),i.createElement("button",{className:"btnCancel btn-box",onClick:this.props.cancelSelectMode},"Cancel")))},t}(i.Component);t.default=o},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(5),r=n(22),l=n(1590),d=n(1594),c=n(1596),u=n(10),p=n(493),h=n(87),g=n(14),f=n(132),m=n(753),v=n(1598),b=n(48),C=n(232),y=n(154),_=n(20);t.default=Backbone.View.extend({el:"div.teacherClasses .scroll",postUrlTemplate:n(1599),events:{"click .tile":"tileClicked","change .selectMode .chkSelectTile":"mathAssignmentSelected"},initialize:function(e){var t=this,n=this;Backbone.pubEv.on("toggleselectMode",this.toggleSelectMode,this),Backbone.pubEv.on("ManageLicenses",this.manageLicenses,this),Backbone.pubEv.on("UnassignLessons",this.unassignLessons,this),Backbone.pubEv.on("LockAssignment",this.lockAssignment,this),Backbone.pubEv.on("UnlockAssignment",this.unlockAssignment,this),Backbone.pubEv.on("ClearLock",this.clearLock,this),Backbone.pubEv.on("AssignmentSettings",this.assignmentSettings,this),Backbone.pubEv.on("AssignmentSmallGroupSettings",this.assignmentSmallGroupSettings,this),Backbone.pubEv.on("PostUrl",this.postUrlAssignment,this),Backbone.pubEv.on("AssignToIndividuals",this.assignToIndividuals,this),Backbone.pubEv.on("RerenderClassAssignmentTiles",(function(){n.filteredAssignments=null,n.render()}),this),Backbone.pubEv.on("ArchiveAssignment",this.archiveAssignment,this),Backbone.pubEv.on("SyncAssignmentWithClassroom",this.syncAssignmentWithClassroom,this),Backbone.pubEv.on("SyncAssignmentWithCanvas",this.syncAssignmentWithCanvas,this),Backbone.pubEv.on("filterAssignmentsByLabel",(function(e){t.filterByLabel(e)})),this.subheader=e.subheader,this.$el.html(_.default.isMath?'<div class="mathAssignments"></div>':'<ul class="tiles assignments">')},preRender:function(e){var t=this;this.classM=sCH.classesC.getModelByClassId(e),this.classM.getAssignments((function(e){t.archivedAssignmentCount=e.archivedAssignmentCount,t.render(),Backbone.pubEv.trigger("updateArchivedAssignmentCount",e);var n=[];e.assignments.map((function(e){e.LayerLabels&&(n=n.concat(e.LayerLabels))})),Backbone.pubEv.trigger("InitializeLabels",n)}))},render:function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(a){switch(a.label){case 0:return e||(e=this.classM.get("Assignments"),this.resetLabelSelection()),_.default.isMath?[2,this.renderMathAssignments()]:(o.toggleFocusNClick('button[data-tab="assignment"],[data-tab="assignment"] button',0===e.length),e.length>0?(e.sort((function(e,n){var a,s;switch(t){case"ungraded":a=e.NumTotalUngradedResponses,s=n.NumTotalUngradedResponses;break;case"assigneddate":a=e.CreateDate,s=n.CreateDate;break;case"title":return h(e.Title.toLowerCase(),n.Title.toLowerCase());case"state":a=!e.IsLocked,s=!n.IsLocked;break;case"viewdate":default:a=e.LastViewedDate&&e.LastViewedDate>e.CreateDate?e.LastViewedDate:e.CreateDate,s=n.LastViewedDate&&n.LastViewedDate>n.CreateDate?n.LastViewedDate:n.CreateDate}return a===s?0:a>s?-1:1})),$(".manageDropdown .togglable").show(),[4,r.mountReactComponent(f.default,this.$el.find("ul.assignments")[0],{page:g.Page.ASSIGNMENTS,tiles:e,classObj:this.classM.toJSON()})]):[3,2]);case 1:return a.sent(),[3,3];case 2:r.unmountAllChildReactComponentsUnderParent(this.$el),this.archivedAssignmentCount>0?(o.enableFocusNClick(".manageDropdown .btnManage"),$(".manageDropdown a:not(.btnUnarchiveAssignment)").hide(),this.$el.find("ul.tiles").html('<div class="ctaInfo">              All the assignments in this class are archived. To "unarchive" assignments, select Manage -> Unarchive.            </div>')):(n=0===this.classM.get("Assignments").length?alcfg.infoText.classes.noAssignments:"No assignments match your filter.",this.$el.find("ul.tiles").html("<div class='ctaInfo'>"+n+"</div>")),a.label=3;case 3:return[2]}}))}))},renderMathAssignments:function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=this.classM.get("Assignments"),[4,r.unmountAllChildReactComponentsUnderParent(this.$el)];case 1:return n.sent(),[4,r.mountReactComponent(v.default,this.$el.find(".mathAssignments")[0],{isSelectMode:e,assignmentsData:t})];case 2:return n.sent(),[2]}}))}))},sort:function(e){var t=this.filteredAssignments||this.classM.get("Assignments");this.currentSortBy=e,this.render(t,e)},resetLabelSelection:function(){$(".labelFilter").val()&&$(".labelFilter").val([]).selectpicker("refresh")},filterByLabel:function(e){if(e&&0!==e.length){var t=this.classM.get("Assignments"),n=[];i.each(t,(function(t){t.LayerLabels&&t.LayerLabels.length>0&&(e.every((function(e){return $.inArray(e,t.LayerLabels)>-1}))&&n.push(t))})),n.length<t.length&&(this.filteredAssignments=n),this.render(n,this.currentSortBy)}else this.filteredAssignments=null,this.render(this.classM.get("Assignments"),this.currentSortBy)},getSelectedIds:function(){if(this.selectedId){var e=[this.selectedId];return this.selectedId=null,e}var t=[];return i.each(this.$el.find("a.selected"),(function(e){t.push({assignmentId:$(e).data("id"),learnEntityId:$(e).data("learnentityid")})})),t},manageLicenses:function(){var e=this.getSelectedIds().pop(),t=i.find(this.classM.get("Assignments"),{AssignmentId:e});t.RentalPrices?new Backbone.BootstrapModal({title:"Manage rental licenses for "+t.Title,content:new l.default({learnEntityId:t.LearnEntityId,classId:-1}),cancelText:!1,okText:"Close",cssClass:"modal-al-manage-purchased"}):o.bootstrap.alert({message:"Please select a paid text!",alert:"danger"})},unassignLessons:function(){var e=this;new Backbone.BootstrapModal({title:"Unassign these items from your class?",content:alcfg.confirmsText.lessonsUnassign,cssClass:"modal-al-unassign",okText:"Unassign",triggerBackboneEventOnCancel:"cancelSelectMode"}).open((function(){var t=e.getSelectedIds(),n=i.map(t,"assignmentId"),a=(i.map(t,"learnEntityId"),this);a.preventClose(),a.disableOk("Removing..."),e.classM.deleteAssignments(n,(function(t){a.close(),t?(e.updateMainMenuNotifications({classId:e.classM.get("ClassId"),assignmentIds:n,isRemoved:!0}),e.render(),o.bootstrap.alert({message:"Assignments removed successfully!"})):o.bootstrap.alert({message:"There was an error deleting these assignments!",alert:"danger"}),Backbone.pubEv.trigger("cancelSelectMode")}))}))},archiveAssignment:function(){var e=i.map(this.getSelectedIds(),"assignmentId"),t=this;new Backbone.BootstrapModal({title:"Archive assignments?",content:'<p>Archived assignments will not be visible to students, however their data will still appear in reports.        <p>You can always unarchive by using the "unarchive" option.</p>',cssClass:"modal-al-assign-to-individual-students",okText:"Archive",triggerBackboneEventOnCancel:"cancelSelectMode"}).open((function(){u.ArchiveAssignment({assignmentIds:e,classId:t.classM.get("ClassId")},(function(n){if(n){o.bootstrap.alert({message:"The selected assignments have been archived."});var a=t.classM.get("Assignments");a=i.filter(a,(function(t){return-1===$.inArray(t.AssignmentId,e)})),t.classM.set("Assignments",a),t.archivedAssignmentCount+=e.length,Backbone.pubEv.trigger("updateArchivedAssignmentCount",{archivedAssignmentCount:t.archivedAssignmentCount}),t.updateMainMenuNotifications({classId:t.classM.get("ClassId"),assignmentIds:e,isRemoved:!0}),Backbone.pubEv.trigger("cancelSelectMode"),t.render()}else o.alertBackendError()}))}))},syncAssignmentWithClassroom:function(){var e=this,t=i.map(this.getSelectedIds(),"assignmentId"),n=this.classM.get("ExternalClassId");Backbone.pubEv.trigger("loadingShowHide",!0),o.bootstrap.alert({message:"Posting your assignments as drafts in Google Classroom...hang on for a few seconds and don't refresh the page!!"}),y.init(["https://www.googleapis.com/auth/classroom.coursework.students.readonly"],(function(){y.getCourseWork(n,null,(function(n){var a=[];i.each(n,(function(e){if(e.associatedWithDeveloper&&e.materials&&e.materials.length>0&&e.materials[0].link){var t=o.getAssignmentIdFromUrl(e.materials[0].link.url);a.push(parseInt(t))}}));var s=i.difference(t,a);if(s.length>0){var r=[],l=e.classM.get("Assignments");i.each(s,(function(e){var t=l.find((function(t){return t.assignmentId||t.AssignmentId===e})),n=t.Type,a=t.Title,s=t.concept,i=window.location.origin+(_.default.isMath?"/#student/mathreader?assignmentId="+e:"/#student/reader/"+e+(1===n?"":"/notes"));r.push({assignmentName:s||a,url:i})})),y.createCourseWork([{className:e.classM.get("Name"),source:e.classM.get("Source"),externalClassId:e.classM.get("ExternalClassId"),links:r}])}Backbone.pubEv.trigger("cancelSelectMode"),Backbone.pubEv.trigger("loadingShowHide",!1),o.bootstrap.alert({message:"Synced assignments successfully!"})}),!1)}),!1)},syncAssignmentWithCanvas:function(){var e=i.map(this.getSelectedIds(),"assignmentId"),t=this.classM.get("ClassId");u.SyncAssignmentsWithCanvas({assignmentIds:e,classId:t},(function(){Backbone.pubEv.trigger("cancelSelectMode"),Backbone.pubEv.trigger("loadingShowHide",!1),o.bootstrap.alert({message:"Synced assignments successfully!"})}))},updateMainMenuNotifications:function(e){Backbone.router.app&&Backbone.pubEv.trigger("updateMainMenuNotification",e)},assignmentSettings:function(){var e=this.getSelectedIds().pop(),t=i.find(this.classM.get("Assignments"),{AssignmentId:e});new Backbone.BootstrapModal({title:t&&(1===t.Type||t.IsQuiz)?"Quiz reading settings":"Assignment reading settings",okText:"Save",cancelText:"Cancel",cssClass:"classSettings",allowCancel:!0,content:new p.default({submenu:"reading",classM:this.classM,assignment:t}),triggerBackboneEventOnCancel:"cancelSelectMode"}).open()},assignmentSmallGroupSettings:function(){if(sCH.userM.isOnFreePlan())b.showBuyTeacherPopup({title:"Manage small groups",content:alcfg.infoText.classes.smallGroups});else{$("body").append('<div id="smallGroups"></div>');var e=this.getSelectedIds().pop(),t=this.classM.get("ClassId");u.GetSmallGroup({assignmentId:e,classId:t},(function(n){r.mountReactComponent(m.default,$("#smallGroups")[0],{classId:t,studentList:n.studentAssignmentGroupMaps,isGroupEnabled:n.isSmallGroupsEnabled,existingGroups:n.assignmentGroups,assignmentId:e,onUpdate:function(){Backbone.pubEv.trigger("cancelSelectMode")},onClose:function(){Backbone.pubEv.trigger("cancelSelectMode"),r.unmountReactComponent($("#smallGroups")[0]),$("#smallGroups").remove()}})}))}},assignToIndividuals:function(){var e=i.map(this.getSelectedIds(),"assignmentId"),t=this;new Backbone.BootstrapModal({title:"Assign to individual students",content:new c.default({classM:this.classM,assignmentIds:e,afterAssignment:function(){Backbone.pubEv.trigger("cancelSelectMode"),t.render()}}),cssClass:"modal-al-assign-to-individual-students",okText:"Save",triggerBackboneEventOnCancel:"cancelSelectMode"}).open()},lockAssignment:function(){var e=this.getSelectedIds().pop(),t=i.find(this.classM.get("Assignments"),{AssignmentId:e}),n=this,a=o.getAssignmentLockState({lockStartDate:t.LockStartDate,lockEndDate:t.LockEndDate,unlockStartDate:t.UnlockStartDate,unlockEndDate:t.UnlockEndDate,currentUtc:moment.utc()}),s=!a.noLockSet&&!a.isLockExpired&&a.lockStartDate;new Backbone.BootstrapModal({title:"Lock assignment",content:new d.default({mode:"lock",lockState:a,assignment:t,afterLock:function(){n.render()},cls:this.classM}),cssClass:"modal-al-lock",allowCancel:!1,okText:s?"Update lock":"Lock",optionButtons:s?[{text:"Clear",event:"clear"}]:[],triggerBackboneEventOnCancel:"cancelSelectMode"})},unlockAssignment:function(){var e=this.getSelectedIds().pop(),t=i.find(this.classM.get("Assignments"),{AssignmentId:e}),n=this,a=o.getAssignmentLockState({lockStartDate:t.LockStartDate,lockEndDate:t.LockEndDate,unlockStartDate:t.UnlockStartDate,unlockEndDate:t.UnlockEndDate,currentUtc:moment.utc()}),s=!a.noLockSet&&!a.isLockExpired&&a.unlockStartDate;new Backbone.BootstrapModal({title:"Set unlock period",content:new d.default({mode:"unlock",lockState:a,assignment:t,afterLock:function(){n.render()},cls:this.classM}),cssClass:"modal-al-lock",allowCancel:!1,okText:s?"Update Unlock":"Set Unlock",optionButtons:s?[{text:"Clear",event:"clear"}]:[],triggerBackboneEventOnCancel:"cancelSelectMode"})},clearLock:function(){var e=this.getSelectedIds().pop(),t=i.find(this.classM.get("Assignments"),{AssignmentId:e}),n=this,a=o.getAssignmentLockState({lockStartDate:t.LockStartDate,lockEndDate:t.LockEndDate,unlockStartDate:t.UnlockStartDate,unlockEndDate:t.UnlockEndDate,currentUtc:moment.utc()});a.noLockSet||a.isLockExpired?o.bootstrap.alert({message:'This assignment does not have any lock or unlock set. Use "Lock / Unlock" from the menu.',alert:"danger"}):new Backbone.BootstrapModal({title:"Are you sure you want to clear the "+(t.LockStartDate?"lock":"unlock")+" for this assignment?",content:"",okText:"Clear"}).open((function(){new d.default({mode:"clear",assignment:t,afterLock:function(){n.render()},cls:n.classM}).clear()}))},postUrlAssignment:function(){var e=[],t=i.map(this.getSelectedIds(),"assignmentId"),n=this.classM.get("Assignments");i.each(t,(function(t){var a=n.find((function(e){return e.AssignmentId===t})),s=window.location.origin+(_.default.isMath?"/#student/mathreader?assignmentId="+t:"/#student/reader/"+t+(1===a.Type?"":"/notes"));e.push({assignmentName:a.Title,url:s})}));var a=new Backbone.BootstrapModal({title:"Post assignment URL for students",content:this.postUrlTemplate({data:e}),okText:"Done",cancelText:!1,triggerBackboneEventOnCancel:"cancelSelectMode"}).open((function(){Backbone.pubEv.trigger("cancelSelectMode")}));a.$el.on("shown.bs.modal",(function(e){new C.default(".btnCopyLink").on("success",(function(){o.bootstrap.alert({message:"The assignment's link has been copied to your clipboard. "+alcfg.alertsText.copyClipboardPasteInstruction})}))})),window.setTimeout((function(){gapi.sharetoclassroom&&gapi.sharetoclassroom.go(".gShare"),o.initTooltips(a.$el)}),1e3)},toggleSelectMode:function(e){if(this.selectMode="on"===e.state,_.default.isMath)return this.singleSelectMode="single"===e.mode,this.selectAction=e.selectAction,this.renderMathAssignments(this.selectMode);this.selectMode?(this.$el.find(".checkbox").show().removeClass("destructive ok").addClass(e.type),this.singleSelectMode="single"===e.mode,this.selectAction=e.selectAction,this.singleSelectMode||(e.filter&&(this.selectFilter=e.filter),e.singleSelectByCSSClass&&(this.singleSelectByCSSClass=e.singleSelectByCSSClass)),e.selectionDisallowedClassName&&(this.selectionDisallowedClassName=e.selectionDisallowedClassName)):(this.$el.find(".checkbox").hide().removeClass("destructive ok"),this.$el.find(".chkSelectTile").prop("checked",!1),this.$el.find("a.selected").removeClass("selected"),o.enableFocusNClick(this.$el.find(".disabled")))},mathAssignmentSelected:function(e){if(this.selectMode){var t=$(e.currentTarget),n=t.is(":checked");this.singleSelectMode&&n&&(this.selectedId=t.data("id"),this.$el.find(".chkSelectTile").prop("checked",!1),t.prop("checked",!0),Backbone.pubEv.trigger(this.selectAction)),t.parent(".checkbox").toggleClass("selected",n);var a=this.$el.find(".chkSelectTile:checked");Backbone.pubEv.trigger("tilesSelected",a.length>0)}},tileClicked:function(e){if(this.selectMode){var t=$(e.currentTarget);if(this.selectionDisallowedClassName&&t.hasClass(this.selectionDisallowedClassName))return o.bootstrap.alert({message:alcfg.alertsText[this.selectionDisallowedClassName+"DisallowedSelectionMessage"],alert:"danger"}),void e.preventDefault();if(this.singleSelectMode)this.selectedId=t.data("id"),this.$el.find(".chkSelectTile").prop("checked",!1),t.find(".chkSelectTile").prop("checked",!0),Backbone.pubEv.trigger(this.selectAction);else if(t.hasClass("selected"))t.find(".chkSelectTile").prop("checked",!1),t.removeClass("selected"),0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelected",!1);else{var n=this.$el.find("a.selected");if(0===n.length){if(this.singleSelectByCSSClass&&t.hasClass(this.singleSelectByCSSClass))return t.find(".chkSelectTile").prop("checked",!0),t.addClass("selected"),Backbone.pubEv.trigger(this.selectAction),void e.preventDefault();Backbone.pubEv.trigger("tilesSelected",!0)}if(this.selectFilter&&n.length>0){var a=n.hasClass(this.selectFilter);if(t.hasClass(this.selectFilter)!==a)return o.bootstrap.alert({message:alcfg.alertsText[this.selectFilter+"FilterSelecton"],alert:"danger"}),void e.preventDefault()}if(this.singleSelectByCSSClass&&t.hasClass(this.singleSelectByCSSClass))return o.bootstrap.alert({message:alcfg.alertsText[this.singleSelectByCSSClass+"SingleSelectByCSSClass"],alert:"danger"}),void e.preventDefault();t.find(".chkSelectTile").prop("checked",!0),t.addClass("selected")}e.preventDefault()}},destroy:function(){Backbone.pubEv.off("toggleselectMode"),Backbone.pubEv.off("ManageLicenses"),Backbone.pubEv.off("UnassignLessons"),Backbone.pubEv.off("AssignmentSettings"),Backbone.pubEv.off("LockAssignment"),Backbone.pubEv.off("UnlockAssignment"),Backbone.pubEv.off("ClearLock"),Backbone.pubEv.off("PostUrl"),Backbone.pubEv.off("AssignToIndividuals"),Backbone.pubEv.off("RerenderClassAssignmentTiles"),Backbone.pubEv.off("ArchiveAssignment"),Backbone.pubEv.off("SyncAssignmentWithClassroom"),Backbone.pubEv.off("SyncAssignmentWithCanvas"),Backbone.pubEv.off("AssignmentSmallGroupSettings"),Backbone.pubEv.off("filterAssignmentsByLabel"),this.$el.parent().removeClass("assess"),this.undelegateEvents()}})}).call(this,n(21))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(14),i=n(10),o=n(1591),r=n(274),l=n(14);t.default=Backbone.View.extend({events:{"click .btnViewOrderHistory":"viewOrderHistory","click .btnBuyMore":"buyMore","change .ddlClass":"selectClass"},template:n(1593),initialize:function(e){this.learnEntityId=e.learnEntityId,this.selectedClassId=e.classId,this.on("initialized",this.modalInitialized)},modalInitialized:function(e){var t=this;this.modal=e,i.GetStudentAccess({learnEntityId:t.learnEntityId},(function(n){var s,i=0,o=0,r=0,l=[];a.each(n.accessList,(function(e){null!==e.LicenseId&&null==e.TeacherGrantor&&moment.utc(e.ExpireDate).isBefore(moment.utc())&&e.Passed10Percent&&i++,e.UsedSchoolContentCredits&&e.TeacherUserId===sCH.userM.get("UserId")&&r++}));var d=a.groupBy(n.accessList.filter((function(e){return!1===e.UserDeleted})),"StudentUserId"),c=Object.keys(d);s=c.length,a.each(c,(function(e){var t=d[e][0];t.hasAccess=null!==t.LicenseId&&(null===t.ExpireDate||moment.utc(t.ExpireDate).isAfter(moment.utc())),t.hasAccess||o++,l.push(t)})),t.numLicensesUsed=n.numOfLicensesUsedByStudents,t.numOfStudentLicenses=n.numOfStudentLicenses+r,t.isSchoolBookCreditsActive=n.isSchoolBookCreditsActive,t.numLicensesAllocatedThatExpired=i,t.numOfStudentsWithoutLicense=o,t.numOfStudents=s,t.textM=n.learnEntityInfo,t.studentsByClass=a.groupBy(l,"ClassId"),t.classes=a.uniqBy(n.accessList,"ClassId").map((function(e){return{ClassId:e.ClassId,ClassName:e.ClassName}})),e.open()}))},selectClass:function(e){this.selectedClassId=parseInt($(e.currentTarget).val()),this.render()},getStudentsByClass:function(e){var t=[],n=-1===e?a.uniqBy(a.reduce(this.studentsByClass,(function(e,t){return e=e.concat(t)}),[]),"StudentUserId"):this.studentsByClass[e];if(n)for(var s=0,i=n;s<i.length;s++){var o=i[s],r={StudentUserId:o.StudentUserId,FullName:o.FullName,TeacherGrantor:o.TeacherGrantor,HasAccess:o.hasAccess,ExpireDate:o.ExpireDate,LicenseId:o.LicenseId,TeacherUserId:o.TeacherUserId};t.push(r)}return t},render:function(){var e=this.getStudentsByClass(this.selectedClassId),t=l.CovidPaidTextsToBeMadeFree.indexOf(this.learnEntityId)>-1;this.$el.html(this.template({selectedClassId:this.selectedClassId,classes:this.classes,students:e,numOfStudentLicenses:this.numOfStudentLicenses,showLicenseStateCount:!(this.isSchoolBookCreditsActive&&sCH.userM.isOnPrimePlan()),numLicensesAllocatedThatExpired:this.numLicensesAllocatedThatExpired,numLicensesUsed:this.numLicensesUsed,numOfStudents:this.numOfStudents,numOfLicensesNeeded:this.numOfStudentsWithoutLicense-(this.numOfStudentLicenses-this.numLicensesUsed),textM:this.textM,isCovidPaidTextsToBeMadeFree:t})),this.$el.find("select").selectpicker()},viewOrderHistory:function(){new Backbone.BootstrapModal({title:"Order history",content:new o.default({learnEntityId:this.learnEntityId}),cssClass:"modal-al-order-history",cancelText:!1})},buyMore:function(){new Backbone.BootstrapModal({title:this.textM.Title,content:new r.default({textM:this.textM,source:s.LearnEntityPurchaseSource.MANAGE_LICENSES,parent:this}),okText:"Rent",cssClass:"modal-lg modal-al-buy-more",allowCancel:!1}).open()},licensesUpdated:function(e){this.numOfStudentLicenses+=e,this.render()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10);t.default=Backbone.View.extend({template:n(1592),initialize:function(e){this.on("initialized",this.modalInitialized),this.learnEntityId=e.learnEntityId},modalInitialized:function(e){var t=this;a.GetLearnEntityOrderHistory({learnEntityId:this.learnEntityId},(function(n){e.open(),t.render(n)}))},render:function(e){this.$el.html(this.template({orders:e}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<ul class="orders">\r\n    ',_.each(orders,(function(e){var t=moment(e.CreateDate);__p+='\r\n        <li>\r\n            <div style="border-bottom:solid 1px #E8E8E8;">'+(null==(__t=t.month()+1+"-"+t.date()+"-"+t.year())?"":__t)+"</div>\r\n            ",sCH.userM.isSchoolUsingContentCredits()?__p+="\r\n                "+(null==(__t=e.Quantity)?"":__t)+" licenses\r\n            ":__p+="\r\n                "+(null==(__t=e.Quantity+(e.LicenseLengthInDays?" ("+e.LicenseLengthInDays+" days)":""))?"":__t)+" "+(null==(__t=e.Quantity>1?"licenses":"license")?"":__t)+" rented for $"+(null==(__t=(e.AmountInCents/100).toFixed(2))?"":__t)+"\r\n            ",__p+="\r\n        </li>\r\n    "})),__p+="\r\n</ul>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+="",isCovidPaidTextsToBeMadeFree)__p+="\r\n    <p>The Center for Civic Education has made this text available for free until July 31, 2020 in response to the COVID-19 emergency. Students will be allocated licenses for free during this time. Any student licenses previously paid for will not be utilized until August 1st, 2020.</p>\r\n";else if(showLicenseStateCount){const isWTP=textM.Publisher===alcfg.weThePeoplePublisher,licenseLengthInsert=isWTP?" (1 month) ":"";__p+="\r\n    <p>\r\n        "+(null==(__t=numLicensesUsed)?"":__t)+" out of your "+(null==(__t=cH.plural(numOfStudentLicenses,"%count"+licenseLengthInsert+"license has","%count"+licenseLengthInsert+"licenses have"))?"":__t)+" been used.\r\n        \r\n        ",numLicensesAllocatedThatExpired>0&&(__p+="\r\n            "+(null==(__t=cH.plural(numLicensesAllocatedThatExpired,"%count has","%count have"))?"":__t)+" expired.<br/>\r\n        "),__p+="\r\n        ",numOfLicensesNeeded>0&&(__p+="\r\n            <span>\r\n                This text is assigned to "+(null==(__t=numOfStudents)?"":__t)+' students, so you\'ll need to buy \r\n                <span style="color: #F50057;">'+(null==(__t=numOfLicensesNeeded)?"":__t)+" more licenses</span>.\r\n            </span>\r\n        "),__p+="\r\n        ",isWTP&&(__p+='\r\n            <div class="info">Note: Assignments from <i>We the People</i> are divided into one month long licenses so they can be used more efficiently. When you assign the book to another class, students will automatically start using their one month licenses when they log in.\r\n                <a class="btnLearnMore" href="'+(null==(__t=alcfg.helpArticleLink.wtpLicenseInfo)?"":__t)+'">Learn more</a>\r\n            </div>\r\n        '),__p+='\r\n    </p>\r\n    <div>\r\n        <a class="btn-box small btnBuyMore">Buy more licenses</a>\r\n        <a class="btn-box small btnViewOrderHistory">View order history</a>\r\n    </div>\r\n'}__p+='\r\n<div class="clearBoth" style="height: 20px;"></div>\r\n<div class="info">Note: We automatically allocate licenses to students as they enter the assignment.</div>\r\n<div class="clearBoth" style="height: 20px;"></div>\r\n\r\n<div class="studentsLicense">\r\n    ',classes.length>1&&(__p+='\r\n        <select class="ddlClass">\r\n            <option '+(null==(__t=-1===selectedClassId?"selected":"")?"":__t)+' value="-1">All classes</option>\r\n            ',_.each(classes,(function(e){__p+="\r\n                <option "+(null==(__t=selectedClassId===e.ClassId?"selected":"")?"":__t)+' value="'+(null==(__t=e.ClassId)?"":__t)+'">'+(null==(__t=e.ClassName)?"":__t)+"</option>\r\n            "})),__p+="\r\n        </select>\r\n    "),__p+="\r\n\r\n    ",students&&students.length?(__p+='\r\n        <table class="tablesorter fullwidth">\r\n            <tr>\r\n                <th>Student name</th>\r\n                <th>License status</th>\r\n                \x3c!--<th style="width: 144px;">License bought by</th>--\x3e\r\n            </tr>\r\n            ',_.each(students,(function(e){__p+="\r\n                <tr>\r\n                    <td>"+(null==(__t=cH.sanitize(e.FullName))?"":__t)+"</td>\r\n                    <td>\r\n                        ",e.LicenseId?e.ExpireDate&&moment.utc(e.ExpireDate).isBefore(moment.utc())?(__p+="\r\n                            <div>\r\n                                None allocated\r\n                                ",e.TeacherUserId===sCH.userM.get("UserId")&&(__p+='\r\n                                    <div class="info">(previous license expired '+(null==(__t=moment.utc(e.ExpireDate).fromNow())?"":__t)+")</div>\r\n                                "),__p+="                                \r\n                            </div>\r\n                        "):e.ExpireDate?__p+="\r\n                            <div>Expires on "+(null==(__t=moment.utc(e.ExpireDate).local().format("MMM D, YYYY"))?"":__t)+"</div>\r\n                        ":__p+="\r\n                            Allocated\r\n                        ":__p+="\r\n                            <div>None allocated</div>\r\n                        ",__p+="\r\n                    </td>\r\n                \x3c!--<td>"+(null==(__t=e.TeacherGrantor?cH.sanitize(e.TeacherGrantor):"You")?"":__t)+"</td>--\x3e\r\n                </tr>\r\n            "})),__p+="\r\n        </table>\r\n    "):__p+='\r\n        <div class="info">No students!</div>\r\n    ',__p+="    \r\n</div>\r\n"}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(462);t.default=Backbone.View.extend({events:{"click .studentSelectorRadio":"toggleStudentSelection","click .actions .btn-box":"changeSelection","change .defaultAssignees":"selectDefaultAssignees"},template:n(1595),initialize:function(e){var t=this;this.mode=e.mode,this.lockState=e.lockState,this.assignment=e.assignment,this.cls=e.cls,this.afterLock=e.afterLock,this.studentsList=[],"clear"!==this.mode&&(this.on("initialized",this.modalInitialized),this.on("ok","lock"===this.mode?this.lock:this.unlock),this.on("cancel",(function(){t.$el.find(".reportrange")&&t.$el.find(".reportrange").data("daterangepicker")&&t.$el.find(".reportrange").data("daterangepicker").remove()})),this.on("clear",this.clear),this.on("shown",this.shown))},modalInitialized:function(e){var t=this;this.modal=e,this.modal.$el.find(".btn").attr("disabled",!0),this.assignment.Assignees&&this.assignment.Assignees.length>0?(this.studentsList=this.assignment.Assignees,this.modal.open()):(this.studentsC=new o.default,this.studentsC.on("sync destroy",(function(){t.studentsList=t.studentsC.toJSON(),t.modal.open()}),this),this.studentsC.fill_class({classId:this.cls.get("ClassId"),isGoogleCourse:"google"===this.cls.get("Source"),excludePending:!0})),"unlock"===this.mode&&this.$el.addClass("unlockmode")},render:function(){var e,t=this,n=a.sortBy(a.filter(this.cls.get("Assignments"),(function(e){return e.LockOverrideStudentIds&&e.LockOverrideStudentIds.split(",").length>0&&e.AssignmentId!=t.assignment.AssignmentId})),"Title");this.$el.html(this.template({mode:this.mode,assignment:this.assignment,students:this.studentsList,previousLockedAssignmentsByStudents:n})),t.assignment.LockOverrideStudentIds?(t.$el.find('.studentSelectorRadio[value="some"]').click(),this.$el.find("#divSelectStudents").show()):this.$el.find("#divSelectStudents").hide(),this.now=moment(),"lock"===this.mode?(this.lockDate={start:this.lockState.lockStartDate&&!this.lockState.isLockExpired?moment(this.lockState.lockStartDate.toDate()):this.now,end:this.lockState.lockEndDate&&!this.lockState.isLockExpired?moment(this.lockState.lockEndDate.toDate()):null},e=this.lockDate):(this.unlockDate={start:this.lockState.unlockStartDate&&!this.lockState.isLockExpired?moment(this.lockState.unlockStartDate.toDate()):this.now,end:this.lockState.unlockEndDate&&!this.lockState.isLockExpired?moment(this.lockState.unlockEndDate.toDate()):null},e=this.unlockDate);var s={timePicker:!0,singleDatePicker:!0,timePickerIncrement:1,minDate:this.now};this.$el.find("#datePickerStartDate.reportrange").daterangepicker(a.extend(s,{startDate:null===e.start?this.now:e.start,useNow:!0}),(function(n){e.start=n,t.updateDateSpanAndCountdown(n,$(this.element))})),this.$el.find("#datePickerEndDate.reportrange").daterangepicker(a.extend(s,{startDate:null===e.end?this.now:e.end,removeDateSelection:!0,useNow:!1,locale:{removeDateSelectionLabel:"Clear"}}),(function(n){e.end=n,t.updateDateSpanAndCountdown(n,$(this.element))})),this.$el.find(".reportrange").on("show.daterangepicker",(function(e,t){$(".daterangepicker .calendar").css({float:"none",marginBottom:"25px"})})),this.$el.find("#datePickerEndDate").on("removeDateSelection.daterangepicker",(function(n,a){e.end=null,t.updateDateSpanAndCountdown(null,$(this))})),this.$el.find("select").selectpicker(),this.updateDateSpanAndCountdown(e.start,this.$el.find("#datePickerStartDate.reportrange")),this.updateDateSpanAndCountdown(e.end,this.$el.find("#datePickerEndDate.reportrange")),this.modal.$el.find(".btn").removeAttr("disabled")},lock:function(e){if(e.preventClose(),!this.lockDate.end||this.lockDate.start.isBefore(this.lockDate.end)){var t=this;if("all"!==this.$el.find(".studentSelectorRadio:checked").val()){var n=this.$el.find(".checklist input:checkbox:not(:checked)").map((function(){return $(this).data("studentid")})).get();if(n.length===this.studentsList.length)return void s.bootstrap.alert({message:"Select at least one student for whom the lock should apply.",alert:"danger"})}e.disableOk("Locking..."),i.LockAssignment({assignmentId:this.assignment.AssignmentId,lockStartDate:this.lockDate.start.utc().toISOString(),lockEndDate:this.lockDate.end?this.lockDate.end.utc().toISOString():null,uncheckedStudentIds:n},(function(a){if(a){var i=moment().isAfter(t.lockDate.start)&&moment().isBefore(t.lockDate.end);t.assignment.LockStartDate=t.lockDate.start,t.assignment.LockEndDate=t.lockDate.end,t.assignment.UnlockStartDate=null,t.assignment.UnlockEndDate=null,t.assignment.IsLocked=i,t.assignment.LockOverrideStudentIds=n?n.join(","):null,s.bootstrap.alert({message:i?"Your assignment is now locked!":"Your assignment's lock date has been set!"})}else s.bootstrap.alert({message:"There was an error locking the assignment!",alert:"danger"});t.afterLock(),Backbone.pubEv.trigger("cancelSelectMode"),t.$el.find(".reportrange").data("daterangepicker").remove(),e.close()}))}else s.bootstrap.alert({message:"The Lock end date cannot be before start date.",alert:"danger"})},unlock:function(e){if(e.preventClose(),!this.unlockDate.end||this.unlockDate.start.isBefore(this.unlockDate.end)){var t=this;if("all"!==this.$el.find(".studentSelectorRadio:checked").val()){var n=this.$el.find(".checklist input:checkbox:not(:checked)").map((function(){return $(this).data("studentid")})).get();if(n.length===this.studentsList.length)return void s.bootstrap.alert({message:"Select at least one student for whom the unlock period should apply.",alert:"danger"})}e.disableOk("Setting Unlock..."),i.UnlockAssignment({assignmentId:this.assignment.AssignmentId,unlockStartDate:this.unlockDate.start.utc().toISOString(),unlockEndDate:this.unlockDate.end?this.unlockDate.end.utc().toISOString():null,uncheckedStudentIds:n},(function(a){if(a){var i=moment().isBefore(t.unlockDate.start)&&moment().isAfter(t.unlockDate.end);t.assignment.UnlockStartDate=t.unlockDate.start,t.assignment.UnlockEndDate=t.unlockDate.end,t.assignment.LockStartDate=null,t.assignment.LockEndDate=null,t.assignment.IsLocked=i,t.assignment.LockOverrideStudentIds=n?n.join(","):null,s.bootstrap.alert({message:"Your assignment's unlock period has been set!"})}else s.bootstrap.alert({message:"There was an error setting the unlock period for this assignment!",alert:"danger"});t.afterLock(),Backbone.pubEv.trigger("cancelSelectMode"),t.$el.find(".reportrange").data("daterangepicker").remove(),e.close()}))}else s.bootstrap.alert({message:"The unlock end date cannot be before start date.",alert:"danger"})},clear:function(e){var t=this;i.ClearLockForAssignment({assignmentId:this.assignment.AssignmentId},(function(e){e?(t.assignment.LockStartDate=null,t.assignment.LockEndDate=null,t.assignment.UnlockStartDate=null,t.assignment.UnlockEndDate=null,t.assignment.IsLocked=!1,t.assignment.LockOverrideStudentIds=null,s.bootstrap.alert({message:"Your assignment's lock state has been cleared!"}),t.afterLock(),Backbone.pubEv.trigger("cancelSelectMode"),"clear"!==t.mode&&(t.$el.find(".reportrange").data("daterangepicker").remove(),t.modal.close())):s.bootstrap.alert({message:"There was an error clearing the lock state for this assignment!",alert:"danger"})}))},updateDateSpanAndCountdown:function(e,t){t.find("span").html(e?e.format("MMM D, YYYY h:mm a"):"Select a date")},toggleStudentSelection:function(e){"all"===e.currentTarget.value?this.$el.find("#divSelectStudents").hide():this.$el.find("#divSelectStudents").show()},changeSelection:function(e){var t=this.$el.find('input[type="checkbox"]');switch($(e.currentTarget).data("selection")){case"all":t.prop("checked",!0);break;case"none":t.prop("checked",!1);break;case"invert":t.click()}},selectDefaultAssignees:function(e){var t=this,n=$(e.currentTarget).val().split(",");t.$el.find(".checklist").prop("checked",!0),a.each(n,(function(e){t.$el.find('.checklist input[data-studentid="'+e+'"]').prop("checked",!1)}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div id="divSelectDate" class="subViewContainer">\r\n    ',"lock"===mode?(__p+="\r\n        ",assignment.IsLocked?__p+="\r\n            <p>\r\n                "+(null==(__t=bowser.mobile?"Update settings or unlock":"This assignment is currently locked for the students you had selected. You can update the lock settings or clear the lock.")?"":__t)+"\r\n            </p>\r\n        ":__p+="\r\n            <p>\r\n                "+(null==(__t=bowser.mobile?"Lock assignment on":"When the assignment locks at the time below, students will not be able to answer questions or take notes, but they can still open it and see their work. <br><br>Select the period when the assignment stays locked.")?"":__t)+"\r\n            </p>\r\n        ",__p+="\r\n    "):__p+="\r\n        <p>"+(null==(__t=bowser.mobile?"Set unlock period":"Set the period below to specify when the assignment stays unlocked. Outside the period, the assignment will be locked.")?"":__t)+"</p>\r\n    ",__p+='\r\n    <label class="datePickerLabel">'+(null==(__t="lock"===mode?"Lock":"Unlock")?"":__t)+' Start:</label>\r\n    <div id="datePickerStartDate" class="reportrange">\r\n        <span></span>\r\n        <b class="caret"></b>\r\n    </div>\r\n    \r\n    <div class="clearBoth"></div>\r\n\r\n    <label class="datePickerLabel">'+(null==(__t="lock"===mode?"Lock":"Unlock")?"":__t)+' End:</label>\r\n    <div id="datePickerEndDate" class="reportrange">\r\n        <span></span>\r\n        <b class="caret"></b>\r\n    </div>\r\n    <label class="datePickerLabel">(optional)</label>\r\n\r\n    <div class="clearBoth"></div>\r\n\r\n    <div class="countdown"></div>\r\n</div>\r\n\r\n<div class="clearBoth"></div>\r\n\r\n<div>\r\n    <label><input type="radio" value="all" class="studentSelectorRadio" name="assign" checked/> Entire class</label>\r\n</div>\r\n<div>\r\n    <label><input type="radio" value="some" class="studentSelectorRadio" name="assign" '+(null==(__t=0===students.length?"disabled":"")?"":__t)+' /> Individual students</label>\r\n</div>\r\n\r\n<div id="divSelectStudents" class="subViewContainer">\r\n    <span>\r\n        Select the students for whom the '+(null==(__t="lock"===mode?"lock":"unlock period")?"":__t)+" should apply.\r\n    </span>\r\n    ",previousLockedAssignmentsByStudents.length&&(__p+='\r\n    <select class="defaultAssignees">\r\n        <option disabled selected value="">Select assignments where some students were locked...</option>\r\n        ',_.each(previousLockedAssignmentsByStudents,(function(e){__p+='\r\n        <option value="'+(null==(__t=e.LockOverrideStudentIds)?"":__t)+'">'+(null==(__t=cH.sanitize(e.Title)+(e.LayerLabels&&e.LayerLabels.length?" "+cH.sanitize(e.LayerLabels.join(" ")):"")+" - "+cH.plural(e.Assignees.length-e.LockOverrideStudentIds.split(",").length,"%count student","%count students"))?"":__t)+"</option>\r\n        "})),__p+="\r\n    </select>\r\n    "),__p+='\r\n    <div class="actions">\r\n        <a class="btn-box small btnSelectAll" data-selection="all">Select all</a>\r\n        <a class="btn-box small btnUnselectAll" data-selection="none">Unselect all</a>\r\n        <a class="btn-box small btnInvert" data-selection="invert">Invert selection</a>\r\n    </div>\r\n    <ul class="checklist">\r\n        ',_.each(students,(function(e){var t=!!assignment.LockOverrideStudentIds&&-1!==$.inArray(e.UserId.toString(),assignment.LockOverrideStudentIds.split(","));__p+='\r\n        <li>\r\n            <div class="checkbox">\r\n                <input id="chkSelectStudent'+(null==(__t=e.UserId)?"":__t)+'" data-studentid="'+(null==(__t=e.UserId)?"":__t)+'" type="checkbox" class="regular-checkbox" '+(null==(__t=t?"":"checked")?"":__t)+' />\r\n                <label for="chkSelectStudent'+(null==(__t=e.UserId)?"":__t)+'"></label>\r\n            </div>\r\n            <div class="title">'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"</div>\r\n        </li>\r\n        "})),__p+='\r\n    </ul>\r\n</div>\r\n<div class="clearBoth"></div>\r\n',(assignment.IsQuiz||1===assignment.Type)&&(__p+='\r\n<div class="info">Note: locked quizzes will not be accessible to students.</div>\r\n'),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1597),initialize:function(e){var t=this;this.classM=e.classM,this.assignmentIds=e.assignmentIds,this.afterAssignment=e.afterAssignment,this.on("ok",this.assignToIndividualStudents),this.on("initialized",this.modalInitialized),i.GetAssignees({classId:e.classM.get("ClassId")},(function(e){t.students=e.students,t.assignees=e.assignees,t.students&&t.students.length>1&&(t.students=a.sortBy(t.students,(function(e){return(e.LastName+e.FirstName).toLowerCase()})));var n=1===t.assignmentIds.length?a.filter(t.assignees,{AssignmentId:t.assignmentIds[0]}):[];t.render(n)}))},modalInitialized:function(e){this.modal=e},events:{"click .btnSelectAll":"selectAll","click .btnUnselectAll":"unselectAll","click .btnInvert":"invertSelection","change .defaultAssignees":"selectDefaultAssignees","click .actions a":"bulkAction",'click input[type="checkbox"]':"resetDefaultAssigneeSelector",'change input[type="checkbox"]':"checkForChanges","click .checkbox label":"checkboxLabelClicked","change input:radio":"switchMode"},switchMode:function(e){this.$el.find(".assignToSome").toggle("some"==this.$el.find("input:radio:checked").val()),this.checkForChanges()},checkboxLabelClicked:function(){this.resetDefaultAssigneeSelector(),this.checkForChanges()},selectDefaultAssignees:function(e){var t=$(e.currentTarget).val()?parseInt($(e.currentTarget).val()):null;if(t){var n=a.filter(this.assignees,{AssignmentId:t});this.render(n,t)}},resetDefaultAssigneeSelector:function(){this.$el.find("select").val("")},bulkAction:function(){this.resetDefaultAssigneeSelector(),this.checkForChanges()},selectAll:function(){this.$el.find('input[type="checkbox"]').prop("checked",!0)},unselectAll:function(){this.$el.find('input[type="checkbox"]').prop("checked",!1)},invertSelection:function(){this.$el.find('input[type="checkbox"]').each((function(){$(this).prop("checked",!$(this).prop("checked"))}))},render:function(e,t){var n=this,i=a.sortBy(a.filter(this.classM.get("Assignments"),(function(e){return e.Assignees&&e.Assignees.length>0&&-1===$.inArray(e.AssignmentId,n.assignmentIds)})),"Title"),o=e||[];return this.$el.html(this.template({defaultAssignmentId:t||"",students:this.students,allAssignees:this.assignees,restrictedAssignments:i,assignmentAssignees:o,noStudents:!this.students||!this.students.length,noStudentUrl:s.getClassUrl(this.classM.get("ClassId"),"roster")})),this.checkForChanges(),this.switchMode(),this.$el.find("select").selectpicker(),this},getSelectedAssigneeIds:function(){return this.$el.find("input:checked").map((function(){return $(this).data("studentid")})).get()},checkForChanges:function(){this.assigneesChanged()?this.modal.enableOk("Save"):this.modal.disableOk("Save")},assigneesChanged:function(){var e=a.filter(this.assignees,{AssignmentId:this.assignmentId}),t=a.map(e,"UserId")||[],n=this.getSelectedAssigneeIds()||[],s=a.intersection(t,n),i=(this.students&&this.students.length,"some"==this.$el.find("input:radio:checked").val());return!t.length||!i||s.length!=t.length||s.length!=n.length},assignToIndividualStudents:function(e){e.preventClose();var t=this;e.disableOk("Assigning...");var n="some"==this.$el.find("input:radio:checked").val();if(this.assigneesChanged()){var o=this.getSelectedAssigneeIds();if(n&&!o.length)return s.bootstrap.alert({message:"Please select one or more students or choose 'Entire class'.",alert:"danger"}),void e.enableOk("Save");if(n&&o.length==this.students.length)return s.bootstrap.alert({message:"To assign this text to all students, select 'Entire class'.",alert:"danger"}),void e.enableOk("Save");o="all"==this.$el.find("input:radio:checked").val()||o.length==this.students.length?[]:o,i.SaveAssignees({assignmentIds:this.assignmentIds,userIds:o},(function(n){var i=a.filter(t.classM.get("Assignments"),(function(e){return $.inArray(e.AssignmentId,t.assignmentIds)>-1})),r=a.map(o,(function(e){var n=a.find(t.students,{UserId:e});return{UserId:e,FirstName:n.FirstName,LastName:n.LastName}}));if(a.each(i,(function(e){e.Assignees=[],a.each(r,(function(t){e.Assignees.push(a.extend(t,{AssignmentId:e.AssignmentId}))}))})),e.close(),o.length)if(sCH.userM.showPopup("HowToSeeAssignees"))new Backbone.BootstrapModal({title:"Assigned to individual students",content:"<p>\n                "+a.map(i,"Title").join(", ")+" "+(1===i.length?"has":"have")+' been assigned to individual students. Hover over the student icon on the tile to see student names.\n              </p>\n              <p class="howToAnimation">\n                <img src="/img/HowToSeeAssignees.gif" />\n              </p>',allowCancel:!1,cancelText:!1,okText:"Got it!",doNotShowAgain:!0,cssClass:"modal-al-how-to-see-assignees"}).open((function(){s.updateDoNotShowPopupSetting("HowToSeeAssignees"),t.afterAssignment()}));else s.bootstrap.alert({message:"Assignment has been posted to individual students."}),t.afterAssignment();else s.bootstrap.alert({message:"Assignment has been posted to the entire class."}),t.afterAssignment();s.intercom("trackEvent","assigned-to-individuals",{AssignmentId:t.assignmentIds})}))}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div>\r\n    <p>\r\n        By default, assignments are posted to the entire class. To differentiate, select \'Individual Students\' below.\r\n    </p>\r\n    <div>\r\n        <label><input type="radio" value="all" class="assign" name="assign" '+(null==(__t=assignmentAssignees.length?"":"checked")?"":__t)+' /> Entire class</label>\r\n    </div>\r\n    <div>\r\n        <label><input type="radio" value="some" class="assign" name="assign" '+(null==(__t=assignmentAssignees.length?"checked":"")?"":__t)+" "+(null==(__t=noStudents?"disabled":"")?"":__t)+" /> Individual students</label>\r\n    </div>\r\n</div>\r\n\r\n",students&&students.length||(__p+='\r\n<div class="noStudents">\r\n    Invite students to <a href="'+(null==(__t=noStudentUrl)?"":__t)+'">join your class</a> before individually assigning work.\r\n</div>\r\n'),__p+='\r\n\r\n<div class="assignToSome">\r\n    ',restrictedAssignments.length&&(__p+='\r\n    <select class="defaultAssignees">\r\n        <option disabled '+(null==(__t=defaultAssignmentId?"":"selected")?"":__t)+' value="">Select students who worked on...</option>\r\n        ',_.each(restrictedAssignments,(function(e){__p+="\r\n        <option "+(null==(__t=defaultAssignmentId==e.AssignmentId?"selected":"")?"":__t)+' value="'+(null==(__t=e.AssignmentId)?"":__t)+'">'+(null==(__t=cH.sanitize(e.Title+(e.LayerLabels&&e.LayerLabels.length?" "+e.LayerLabels.join(" "):""))+" - "+cH.plural(e.Assignees.length,"%count student","%count students"))?"":__t)+"</option>\r\n        "})),__p+="\r\n    </select>\r\n    "),__p+='\r\n\r\n    <div class="actions">\r\n        <a class="btn-box small btnSelectAll">Select all</a>\r\n        <a class="btn-box small btnUnselectAll">Unselect all</a>\r\n        <a class="btn-box small btnInvert">Invert selection</a>\r\n    </div>\r\n\r\n    <ul class="checklist">\r\n        ',_.each(students,(function(e){__p+='\r\n        <li>\r\n            <div class="checkbox">\r\n                <input id="chkSelectStudent'+(null==(__t=e.UserId)?"":__t)+'" data-studentid="'+(null==(__t=e.UserId)?"":__t)+'" type="checkbox" class="regular-checkbox" '+(null==(__t=assignmentAssignees.length&&_.filter(assignmentAssignees,{UserId:e.UserId}).length?"checked":"")?"":__t)+' />\r\n                <label for="chkSelectStudent'+(null==(__t=e.UserId)?"":__t)+'"></label>\r\n            </div>\r\n            <div class="title">'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"</div>\r\n        </li>\r\n        "})),__p+='\r\n    </ul>\r\n\r\n    <div class="info">Note: Unassigning from students will delete any work they have done in the selected assignment.</div>\r\n</div>';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(5),d=n(60),c=n(280),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.assignmentsData,n=e.isSelectMode;return t.length>0?o.createElement("div",{className:"dataWrapper",style:{flex:"1 1 auto"}},o.createElement(d.VTable,{header:g(n),body:h(t,n),fixedRowCount:1,fixedColumnCount:0,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:n?2:1,sortDescending:!0,customClassNames:["mathAssignmentTable",n?"selectMode":""]})):o.createElement(p,null)},t}(r.Component);t.default=u;var p=function(){return o.createElement("div",{className:"ctaInfo",dangerouslySetInnerHTML:{__html:alcfg.infoText.classes.noAssignments}})},h=function(e,t){return e.map((function(e){return f(e,t)}))},g=function(e){var t=[{content:"Assignment",width:500},{content:"Date Assigned",width:100,classes:{center:!0}}];return e&&t.unshift({content:"",width:100,maxWidth:100,notSortable:!0}),{height:50,cells:t}},f=function(e,t){var n="#teacher/mathreader?assignmentId="+e.AssignmentId,a=moment.utc(e.CreateDate).local().format("MM-DD-YY"),s=+new Date(e.CreateDate),r=[{content:o.createElement("a",{onClick:function(){t||l.openReaderUrl(n)},className:"lnkAssignmentTitle "+(t?"disabled":"")},o.createElement("span",{className:"assignmentName"},l.truncate(e.name,100),o.createElement(c.AssignmentLock,i({},e))),o.createElement("span",{className:"labels"},e.standardCode)),sortValue:e.standardCode},{content:a,sortValue:s,classes:{center:!0}}];return t&&r.unshift({content:o.createElement("a",{className:"checkbox","data-id":e.AssignmentId},o.createElement("input",{id:e.AssignmentId,"data-id":e.AssignmentId,type:"checkbox",className:"chkSelectTile regular-checkbox"}),o.createElement("label",{htmlFor:e.AssignmentId})),sortValue:null,classes:{center:!0}}),{height:50,cells:r}}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<div>\n    <p>Send students directly to assignments by sharing the links below.</p>\n    ",_.each(data,(function(e,t){__p+='\n    <div style="margin-bottom: 10px;">\n        '+(null==(__t=cH.sanitize(e.assignmentName))?"":__t)+'<br />\n        <span class="info moveup">'+(null==(__t=e.url)?"":__t)+'</span>\n        <button class="icon-copytoclipboard btnCopyLink" data-clipboard-text="'+(null==(__t=e.url)?"":__t)+'" title="Copy link to clipboard"></button>\n\n        ',sCH.userM.get("Accounts").native&&(__p+='\n            <div class="gShare" title="Share to Google Classroom">\n                <div class="g-sharetoclassroom" data-size="20" data-url="'+(null==(__t=e.url)?"":__t)+'" data-title="'+(null==(__t=cH.sanitize(e.assignmentName))?"":__t)+'"></div>\n            </div>\n        '),__p+="\n    </div>\n    "})),__p+="\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(10),i=n(1601);t.default=Backbone.View.extend({el:"div.teacherClasses .scroll",initialize:function(){Backbone.pubEv.on("rerenderClassData",this.render,this),Backbone.pubEv.on("updateGradebookSubTab",this.updateGradebookSubTab,this)},render:function(e,t){this.classId=e,this.$el.html('<div id="gradebook" />'),this.subtab=t||this.subtab,this.renderGradebook()},renderGradebook:function(){var e=this;this.className=this.classId?sCH.classesC.getModelByClassId(this.classId).get("Name"):"",this.rawData={Grades:[],Students:[],Assignments:[]};var t=this.$el.find("#gradebook");s.GetAssignmentAndStudentsByClass({classId:e.classId},(function(n){e.assignmentSectionCountList=n.classAssignments,a.mountReactComponent(i.default,t[0],{options:e,ClassId:e.classId,ClassName:e.className,Assignments:n.classAssignments,FilteredAssignments:n.filteredAssignmentIds,Students:n.students,SubTab:e.subtab})}))},updateGradebookSubTab:function(e){this.subtab=e},destroy:function(){this.$el.parent().removeClass("gradebook"),this.undelegateEvents(),Backbone.pubEv.off("rerenderClassData"),Backbone.pubEv.off("gradebookTabSelected"),Backbone.pubEv.off("updateSubTab")}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),l=n(0),d=n(1602),c=n(1605),u=n(1607),p=n(10),h=n(5),g=n(8),f=n(37),m=n(71),v=n(69);!function(e){e[e.assignment=0]="assignment",e[e.standards=1]="standards",e[e.activity=2]="activity"}(o||(o={}));var b=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.assignmentReportType=0,a.state={dataType:t.SubTab&&o[t.SubTab]||o.assignment,filteredAssignmentIds:t.FilteredAssignments},a._updateAssignmentReportType=a._updateAssignmentReportType.bind(a),f.addToNavigationHistory("#teacher/classes/"+t.ClassId+"/gradebook/"+o[a.state.dataType]),a}return s(t,e),t.prototype.componentDidMount=function(){this._renderAssignmentFilter(),this._renderDataTable(),Backbone.pubEv.trigger("updateGradebookSubTab",o[this.state.dataType])},t.prototype.componentDidUpdate=function(){$(".assignmentFilter .btn").removeAttr("title")},t.prototype._switchReport=function(e){var t=this;this.state.dataType!==e&&this.setState({dataType:e},(function(){f.addToNavigationHistory("#teacher/classes/"+t.props.ClassId+"/gradebook/"+o[e]),t._renderDataTable(),Backbone.pubEv.trigger("updateGradebookSubTab",o[e])}))},t.prototype._updateAssignmentReportType=function(e){this.assignmentReportType=e||0},t.prototype._renderAssignmentFilter=function(){var e=this;C(this.props.Assignments,this.state.filteredAssignmentIds),$(".assignmentFilter select").on("hidden.bs.select",(function(t,n,a,s){var i=$(t.currentTarget).val()||[];e._handleAssignmentSelection(i.map((function(e){return parseInt(e,10)})))})),$(".assignmentFilter select").on("hide.bs.select",(function(e,t,n,a){$(".assignmentFilter .dropdown-menu.inner").scrollTop(0)})),$(".assignmentFilter .btn").removeAttr("title")},t.prototype._renderDataTable=function(){var e=this;this.state.dataType===o.activity?sCH.userM.isOnFreePlan()?(this.setState({el:r.createElement(m.default,{className:"trialSplash",view:v.default,options:{text:"Understand effort that students are putting into their class work and find areas where students can help themselves even more.",screenshotUrl:"/img/Classes_Gradebook_Activity.png",showSampleBanner:!0}})}),this._toggleSubheaderActions()):p.GetStudentGradebookActivityData({classId:this.props.ClassId},(function(t){t&&h.toggleFocusNClick(".btnExportActivity",0===t.Students.length),t.ClassId=e.props.ClassId,e.setState({el:0===e.props.Students.length?r.createElement(y,null):r.createElement(c.default,i({},t))}),e._toggleSubheaderActions()})):this.state.dataType===o.standards?sCH.userM.isOnFreePlan()?(this.setState({el:r.createElement(m.default,{className:"trialSplash",view:v.default,options:{screenshotUrl:"/img/Classes_Gradebook_Standards.png",showSampleBanner:!0}})}),this._toggleSubheaderActions()):p.GetDataForGradebookStandards({classId:this.props.ClassId},(function(t){t.Students=e.props.Students,t.ClassId=e.props.ClassId,e.setState({el:0===e.props.Students.length?r.createElement(y,null):r.createElement(u.default,i({},t))}),e._toggleSubheaderActions()})):p.GetDataForGradebookAssignment({classId:this.props.ClassId},(function(t){t.ClassId=e.props.ClassId,t.className=e.props.ClassName,t.Students=e.props.Students,t.AssignmentReportType=e.assignmentReportType,t.UpdateAssignmentReportType=e._updateAssignmentReportType,e.props.options.gradebook=JSON.parse(JSON.stringify(t)),e.props.options.rawData=t,e.setState({el:0===e.props.Students.length?r.createElement(y,null):r.createElement(d.default,i({},t))}),e._toggleSubheaderActions()}))},t.prototype._toggleSubheaderActions=function(){this.props.options.rawData&&(h.toggleFocusNClick(".btnWeightAssignmentGrades, .btnSplitAssignments",0===this.props.Students.length),h.toggleFocusNClick(".btnSyncGradebookWithGoogleCourse, .btnSyncGradebookWithLTICourse, .btnSyncGradebookWithCanvasCourse, .btnExportGradebook",0===this.props.options.rawData.Grades.length))},t.prototype._handleAssignmentSelection=function(e){var t=this;g.isEqual(e.sort(),this.state.filteredAssignmentIds)||p.UpdateAssignmentFilter({classId:this.props.ClassId,filteredAssignmentIds:e||[],settingKey:"classGradebookSettings"},(function(n){C(n,e),t.setState({filteredAssignmentIds:e},(function(){t._renderDataTable()}))}))},t.prototype._clearAssignmentFilter=function(){this._handleAssignmentSelection([])},t.prototype.render=function(){var e=this,t=this.state.filteredAssignmentIds&&this.state.filteredAssignmentIds.length,n=h.classNames({"btn-box":!0,toggler:!0,btnSwitchReportType:!0}),a=0===this.props.Students.length&&!sCH.userM.isOnFreePlan(),s=h.classNames({pageTabsContainer:!0,disableTabs:a});return r.createElement(r.Fragment,null,r.createElement("div",{className:"tabsWrapper"},r.createElement("div",{role:"tablist","aria-label":"Gradebook Tabs",className:s},r.createElement("a",{onClick:function(){return e._switchReport(o.assignment)},role:"tab",className:n+(this.state.dataType===o.assignment?" selected":""),"data-type":"grade",href:"javascript:void(0)",tabIndex:a?-1:null},"Assignments"),r.createElement("a",{onClick:function(){return e._switchReport(o.standards)},role:"tab",className:n+(this.state.dataType===o.standards?" selected":""),"data-type":"completion",href:"javascript:void(0)",tabIndex:a?-1:null},"Standards ",r.createElement("span",{className:"primeFeature icon-premium-lock"})),r.createElement("a",{onClick:function(){return e._switchReport(o.activity)},role:"tab",className:n+(this.state.dataType===o.activity?" selected":""),"data-type":"proficiency",href:"javascript:void(0)",tabIndex:a?-1:null},"Activity ",r.createElement("span",{className:"primeFeature icon-premium-lock"}))),!!this.props.Assignments.length&&r.createElement("div",{className:"multi-select-ddlb-container assignmentFilter pull-right "+(t?"selected":"")},r.createElement("div",{"data-tab":"assignment",className:"filterButton"},r.createElement("div",{className:"placeholder","data-toggle":"dropdown"},t?h.plural(this.state.filteredAssignmentIds.length,"%count assignment selected","%count assignments selected"):"Filter by assignment",r.createElement("span",{className:"icon-dropdown-arrow"})),r.createElement("select",{"data-live-search":"true",multiple:!0,title:"Filter by assignment"})),r.createElement("a",{title:"Clear Selection",className:"icon-cancel btnClearFilter",onClick:function(){return e._clearAssignmentFilter()}}))),this.state.el)},t}(l.Component);t.default=b;var C=function(e,t){$(".assignmentFilter select").html(""),g.each(e,(function(e){$(".assignmentFilter select").append('<option value="'+e.AssignmentId+'">'+e.Title+"</option>")})),$(".assignmentFilter select").selectpicker("refresh"),$(".assignmentFilter select").selectpicker("val",t),$(".assignmentFilter .btn").tooltip("destroy"),h.initTooltips($(".assignmentFilter"))},y=function(){return r.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noStudentsInClass)}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(504),r=n(1603),l=n(1604),d=n(8),c=n(0),u=n(0),p=n(5),h=n(716),g=n(786);!function(e){e[e.Grades=0]="Grades",e[e.Completion=1]="Completion"}(i||(i={}));var f=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._switchReport=a._switchReport.bind(a),a._renderReportTable=a._renderReportTable.bind(a),a.state={reportType:a.props.AssignmentReportType||i.Grades},a}return s(t,e),t.prototype.render=function(){var e=this,t=!this.props.Assignments||!this.props.Assignments.length,n=sCH.classesC.findWhere({ClassId:this.props.ClassId}).get("Name"),a=g.exportTableForm(this._getCSVData(this.props.ClassId,this.props.StudentReadingTimes),"Gradebook_"+n),s=this.state.reportType===i.Completion?c.createElement("div",null,"Completion percentage is the % of gradable questions the student answered (i.e. bulk-graded non-responses and polls are not included in this percentage)."):c.createElement("div",null,"Student grades, per assignment, sorted by recency.");return c.createElement(c.Fragment,null,a,t?c.createElement("div",{className:"ctaInfo"},"Your gradebook will automatically populate once you start grading assignments."):c.createElement("div",null,c.createElement("div",{onClick:function(){return e._switchReport()}},c.createElement(h.default,{leftOption:"Grades",rightOption:"Completion Percentage",checked:this.state.reportType===i.Completion})),s,c.createElement("br",null)),!t&&c.createElement("div",{className:"dataWrapper"},this._renderReportTable()))},t.prototype._renderReportTable=function(){if(!this.props.Students||!this.props.Students.length)return c.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric);switch(this.state.reportType){case i.Completion:return c.createElement(r.default,{settings:this.props.Settings,students:this.props.Students,assignments:this.props.Assignments,classId:this.props.ClassId,studentAssigneesByAssignment:this.props.StudentAssigneesByAssignment,studentReadingTimes:this.props.StudentReadingTimes,grades:this.props.Grades});case i.Grades:default:return c.createElement(l.default,{settings:this.props.Settings,students:this.props.Students,assignments:this.props.Assignments,classId:this.props.ClassId,studentAssigneesByAssignment:this.props.StudentAssigneesByAssignment,grades:this.props.Grades})}},t.prototype._switchReport=function(){var e=this;this.setState({reportType:this.state.reportType===i.Grades?i.Completion:i.Grades},(function(){e.props.UpdateAssignmentReportType(e.state.reportType)}))},t.prototype._getCSVData=function(e,t){var n=this,a=!d.includes(["clever","edmodo"],sCH.classesC.findWhere({ClassId:e}).get("Source")),s=[],i=[],r=o.customizedWeightsExist(this.props.Assignments);return s[0]=a?["Student","UserName","Total"]:["Student","Total"],i[0]=a?["Student","UserName","Total"]:["Student","Total"],r&&(s[1]=a?["Weight",null,null]:["Weight",null],i[1]=a?["Weight",null,null]:["Weight",null]),this.props.Assignments&&this.props.Assignments.length&&(this.props.Assignments.forEach((function(e){var t=e.Title+(e.SectionRangeName?": "+e.SectionRangeName:"");s[0].push(t),i[0].push(t),r&&(s[1].push(e.GradeWeight+"x"),i[1].push(e.GradeWeight+"x"))})),this.props.Assignments&&this.props.Students.forEach((function(e,o){var l=o+(r?2:1),c=n.props.Grades.filter((function(t){return t.UserId===e.UserId})),u=0,h=0;c.forEach((function(e){var t=d.find(n.props.Assignments,{AssignmentId:e.AssignmentId}),a=t&&t.GradeWeight||1;u+=a*e.PointsEarned,h+=a*e.PointsPossible}));var g=0,f=0,v=0,b=m(u,h);s[l]=a?[e.LastName+", "+e.FirstName,e.UserName,b]:[e.LastName+", "+e.FirstName,b],i[l]=a?[e.LastName+", "+e.FirstName,e.UserName,v]:[e.LastName+", "+e.FirstName,v],n.props.Assignments.forEach((function(a){var o=!0;if(n.props.StudentAssigneesByAssignment&&n.props.StudentAssigneesByAssignment[a.AssignmentId]&&(o=void 0!==d.find(n.props.StudentAssigneesByAssignment[a.AssignmentId],{UserId:e.UserId})),o){var r=d.find(c,{AssignmentId:a.AssignmentId,AssignmentTextSectionSplitMapId:a.AssignmentTextSectionSplitMapId}),u="";if(r){var h=r.PointsEarned,v=r.PointsPossible;r.PointsPossible>0&&(h*=a.GradeWeight,v*=a.GradeWeight,u=m(h,v))}s[l].push(u||null);var b=a.Questions||0,C=t.find((function(t){return t.UserId===e.UserId&&t.AssignmentId===a.AssignmentId})),y=C&&C.ReadingTime>0&&!!a.Questions;if(r){var _=r.NumOfResponses||0,S=p.percent(_/b);g+=_,f+=b,i[l].push(S)}else y?(i[l].push("0%"),f+=b):i[l].push(null)}else s[l].push("N/A"),i[l].push("N/A")})),v=p.percent(g/f)||null;var C=a?2:1;i[l][C]=v}))),[].concat(s,[[],[]],i).map((function(e){return e.map((function(e){return p.replaceQuoteInCSVData(e)})).join(",")}))},t}(u.Component);t.default=f;var m=function(e,t){return t?" "+e+" / "+t:""}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(504),r=n(60),l=n(5),d=n(111),c=n(0),u=n(65),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=o.customizedWeightsExist(this.props.assignments)?3:2,t=g(this.props);return c.createElement(r.VTable,{header:h(this.props),body:t,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,fixedRowCount:e,fixedColumnCount:1,customClassNames:["gradebookAssignmentsTable"]})},t}(c.Component);t.default=p;var h=function(e){e.students;var t=e.assignments.map((function(e){var t=e.Title+(e.SectionRangeName?": "+e.SectionRangeName:"");return{content:c.createElement(u.default,{title:t.length>30?t+(e.LayerLabels.length?" ("+e.LayerLabels.join(", ")+")":""):"",tooltipPlacement:"bottom"},c.createElement("div",null,c.createElement("span",{className:"labels"},l.truncate(e.LayerLabels.join(", "),30)),l.truncate(t,30))),width:180,classes:{center:!0}}}));return{height:70,cells:i([{content:"Student",width:180},{content:"Total Completed",width:180,classes:{center:!0}}],t)}},g=function(e){var t=e.settings,n=e.students,a=e.assignments,s=e.grades,r=e.classId,p=e.studentReadingTimes,h=e.studentAssigneesByAssignment,g=n.map((function(e){var n,o={content:c.createElement("a",{href:"#teacher/classes/"+r+"/studentdata/assignments/?studentuserid="+e.UserId},e.LastName,", ",e.FirstName),sortValue:e.LastName+", "+e.FirstName},g=b(a,s,e,h,p),f=g[0],C=g[1],y=0!==f,_=f?C/f:null,S=l.gradeColor(t,C,f),w={content:c.createElement("span",null,y?l.percent(_):"-"),sortValue:_,classes:(n={withbg:!0,center:!0,completed:1===_},n[S]=!0,n)},T=a.map((function(t){var n=m(t,s,e,h),a=p.find((function(n){return n.UserId===e.UserId&&n.AssignmentId===t.AssignmentId})),i="#teacher/reader/grading/"+t.AssignmentId+"/grading/?student="+e.UserId,o=!!(a&&a.ReadingTime>0&&t.Questions);if(v(t,e,h)){if(n){var r=d(d.utc(n.MaxAnswerDate).toDate()).format("MM/DD/YY h:mm a"),g=(n.NumOfResponses||0)/t.Questions;return{content:c.createElement(u.default,{title:c.createElement("span",null,"Last response submitted",c.createElement("br",null),r)},c.createElement("a",{onClick:function(){return l.openReaderUrl(i)}},l.percent(g))),sortValue:y?g:null,classes:{center:!0,completed:1===g}}}return o?{content:c.createElement("a",{onClick:function(){return l.openReaderUrl(i)}},l.percent(0)),sortValue:_,classes:{center:!0,completed:!1}}:{content:c.createElement("a",{onClick:function(){return l.openReaderUrl(i)}},"-"),classes:{center:!0}}}return{content:c.createElement("span",{className:"na"},"N/A"),classes:{center:!0}}}));return{height:50,cells:i([o,w],T)}})),C=f(t,a,s,n,p,h),y=o.getAssignmentWeightsRow(a);return i(y?[y,C]:[C],g)},f=function(e,t,n,a,s,o){var r=a.reduce((function(e,a){var i=e[0],r=e[1],l=b(t,n,a,o,s);return[i+=l[0],r+=l[1]]}),[0,0]),d=r[0],u=r[1]/d,p={content:c.createElement("span",null," ",d?l.percent(u):"-"),classes:{center:!0}},h=t.map((function(e){var t=n.filter((function(t){return t.AssignmentId===e.AssignmentId&&t.AssignmentTextSectionSplitMapId===e.AssignmentTextSectionSplitMapId})),i=(t.filter((function(e){return e.NumOfResponses})),t.reduce((function(e,t){return e+(t.NumOfResponses||0)}),0)/a.filter((function(n){var a=s.find((function(t){return t.AssignmentId===e.AssignmentId&&n.UserId===t.UserId})),i=t.find((function(e){return n.UserId===e.UserId}));return i&&i.NumOfResponses>0||a&&a.ReadingTime>0})).length),o=i/(e.Questions||0);return{content:c.createElement("div",null,i>-1?l.percent(o):"-"),classes:{completed:1===o,center:!0}}}));return{height:50,cells:i([{content:"Class Average"},p],h)}},m=function(e,t,n,a){return v(e,n,a)?t.find((function(t){return t.UserId===n.UserId&&t.AssignmentId===e.AssignmentId&&t.AssignmentTextSectionSplitMapId===e.AssignmentTextSectionSplitMapId})):null},v=function(e,t,n){var a=!0;return n&&n[e.AssignmentId]&&(a=void 0!==n[e.AssignmentId].find((function(e){return e.UserId===t.UserId}))),a},b=function(e,t,n,a,s){return e.reduce((function(e,i){var o=e[0],r=e[1],l=s.find((function(e){return e.UserId===n.UserId&&e.AssignmentId===i.AssignmentId})),d=m(i,t,n,a);return v(i,n,a)&&(d?(r+=d.NumOfResponses,o+=i.Questions):l&&l.ReadingTime>0&&i.Questions&&(o+=i.Questions)),[o,r]}),[0,0])}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(785),r=n(504),l=n(60),d=n(5),c=n(8),u=n(0),p=n(65),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=r.customizedWeightsExist(this.props.assignments)?3:2,t=f(this.props);return u.createElement(l.VTable,{header:g(this.props),body:t,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,fixedRowCount:e,fixedColumnCount:1,customClassNames:["gradebookAssignmentsTable"]})},t}(u.Component);t.default=h;var g=function(e){e.students;var t=e.assignments.map((function(e){var t=e.Title+(e.SectionRangeName?": "+e.SectionRangeName:"");return{content:u.createElement(p.default,{title:t.length>30?t+(e.LayerLabels.length?" ("+e.LayerLabels.join(", ")+")":""):"",tooltipPlacement:"bottom"},u.createElement("div",null,u.createElement("span",{className:"labels"},d.truncate(e.LayerLabels.join(", "),30)),d.truncate(t,30))),width:180,classes:{center:!0}}}));return{height:70,cells:i([{content:"Student",width:180},{content:"Total Points",width:180,classes:{center:!0}}],t)}},f=function(e){var t=e.settings,n=e.students,a=e.assignments,s=e.grades,l=e.studentAssigneesByAssignment,h=e.classId,g=r.getStudentTotals(t,n,a,s),f=n.map((function(e){var n,f=c.find(g,{userId:e.UserId}),m=d.gradeColor(t,f.pointsEarned,f.pointsPossible),v={content:u.createElement("a",{href:"#teacher/classes/"+h+"/studentdata/assignments/?studentuserid="+e.UserId},e.LastName,", ",e.FirstName),sortValue:e.LastName+", "+e.FirstName},b={content:u.createElement(o.Grade,{pointsEarned:f.pointsEarned,pointsPossible:f.pointsPossible}),sortValue:f.pointsPossible?f.pointsEarned/f.pointsPossible:null,classes:(n={withbg:!0,center:!0},n[m]=!0,n)},C=a.map((function(n){var i,h=!0;l&&l[n.AssignmentId]&&(h=void 0!==c.find(l[n.AssignmentId],{UserId:e.UserId}));var g=h?c.find(s,{UserId:e.UserId,AssignmentId:n.AssignmentId,AssignmentTextSectionSplitMapId:n.AssignmentTextSectionSplitMapId}):null,f=g&&g.UngradedQuestionIds?c.difference(g.UngradedQuestionIds.split(",").map((function(e){return parseInt(e)})),n.doNotGradeQuestionIds).length:null;if(g){var m=d.gradeColor(t,g.PointsEarned,g.PointsPossible);return{content:u.createElement(p.default,{title:f?f+" ungraded":""},u.createElement("div",null,u.createElement(o.Grade,{pointsEarned:g.PointsEarned*r.getAssignmentWeight(a,n.AssignmentId),pointsPossible:g.PointsPossible*r.getAssignmentWeight(a,n.AssignmentId),assignmentId:n.AssignmentId,studentUserId:e.UserId}))),classes:(i={},i[m]=!0,i.center=!0,i),sortValue:g.PointsPossible?g.PointsEarned/g.PointsPossible:null}}var v="#teacher/reader/grading/"+n.AssignmentId+"/grading/?student="+e.UserId;return{content:u.createElement(p.default,{title:h&&f?f+" ungraded":""},u.createElement("div",null,h?u.createElement("a",{onClick:function(){return d.openReaderUrl(v)}},"-"):u.createElement("span",{className:"na"},"N/A"))),classes:{center:!0}}}));return{height:50,cells:i([v,b],C)}})),v=m(t,a,s,g),b=r.getAssignmentWeightsRow(a);return i(b?[b,v]:[v],f)},m=function(e,t,n,a){var s=r.getPrecision(e),l=d.roundWithPrecision(a.reduce((function(e,t){return e+(t.pointsEarned||0)}),0)/a.filter((function(e){return e.pointsPossible>0})).length,s),c=d.roundWithPrecision(a.reduce((function(e,t){return e+(t.pointsPossible||0)}),0)/a.filter((function(e){return e.pointsPossible>0})).length,s),p={content:u.createElement(o.Grade,{pointsPossible:c,pointsEarned:l}),classes:{center:!0}},h=t.map((function(a){var i,r=v(t,a,n,s),l=d.gradeColor(e,r.pointsEarned,r.pointsPossible);return{content:u.createElement(o.Grade,{pointsPossible:r.pointsPossible,pointsEarned:r.pointsEarned}),classes:(i={},i[l]=!0,i.center=!0,i)}}));return{height:50,cells:i([{content:"Class Average"},p],h)}},v=function(e,t,n,a){var s=r.getAssignmentWeight(e,t.AssignmentId),i=n.filter((function(e){return e.AssignmentId===t.AssignmentId&&e.AssignmentTextSectionSplitMapId===t.AssignmentTextSectionSplitMapId}));return{pointsEarned:d.roundWithPrecision(i.reduce((function(e,t){return e+s*(t.PointsEarned||0)}),0)/i.filter((function(e){return e.PointsPossible>0})).length,a),pointsPossible:d.roundWithPrecision(i.reduce((function(e,t){return e+s*(t.PointsPossible||0)}),0)/i.filter((function(e){return e.PointsPossible>0})).length,a)}}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(1606),l=n(787),d=n(5),c=n(54),u=function(e){function t(t,n){var a=e.call(this,t,n)||this,s=l.headers;sCH.userM.get("ShouldShowIRInMainMenu")||(delete s.numIRTextsRead,delete s.irReadingTime);var i=t.ColumnsToShow&&t.ColumnsToShow.length?t.ColumnsToShow:Object.keys(s);return a.state={columnsMasterList:s,columnsToShow:a.getSortedColumnsToShow(i,s)},a}return s(t,e),t.prototype.componentDidMount=function(){var e=this;$(".btnExportActivity").removeClass("displayNone"),this._renderColumnFilter(),Backbone.pubEv.on("setGradeBookActivityColumns",(function(t){return e.setState({columnsToShow:e.getSortedColumnsToShow(t,e.state.columnsMasterList)})}))},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("setGradeBookActivityColumns")},t.prototype.getSortedColumnsToShow=function(e,t){return Object.keys(t).filter((function(t){return"name"===t||!e||0===e.length||e.indexOf(t)>-1}))},t.prototype._renderColumnFilter=function(){var e=this,t=Object.keys(this.state.columnsMasterList).filter((function(e){return"name"!==e})).map((function(t){return{value:t,label:e.state.columnsMasterList[t]}})),n=this.state.columnsToShow.filter((function(e){return"name"!==e})).map((function(t){return{value:t,label:e.state.columnsMasterList[t]}}));Backbone.pubEv.trigger("setGradebookActivityToggleBtn",{columnFilters:t,columnsToShow:n})},t.prototype.render=function(){var e=c.prepareStudentActivityData(this.props),t=this._getCSVData(e,this.state.columnsToShow),n=p(t,this.props.ClassId);return i.createElement(i.Fragment,null,n,i.createElement("p",null,"Student activity across all class assignments, independent reading and class research projects."),i.createElement("div",{className:"dataWrapper"},i.createElement(r.default,{studentsData:e,settings:this.props.Settings,classId:this.props.ClassId,columnsToShow:this.state.columnsToShow})))},t.prototype._getCSVData=function(e,t){var n=this,a=l.getActivityDataForExport(e),s=[],i=t.map((function(e){return n.state.columnsMasterList[e]}));return s.push(i),a.forEach((function(e){var n=t.map((function(t){return e[t]}));s.push(n)})),s.map((function(e){return e.map((function(e){return d.replaceQuoteInCSVData(e)})).join(",")}))},t}(o.Component);t.default=u;var p=function(e,t){var n=sCH.classesC.find({ClassId:t}).get("Name").toLowerCase().replace(/ /g,"_");return i.createElement("form",{className:"exportActivityWrapper",method:"post",action:d.getHostName(alcfg.node.class_gradebook.export)+alcfg.node.class_gradebook.export},e.map((function(e,t){return i.createElement("input",{type:"hidden",key:t,name:"csvRows[]",value:e})})),i.createElement("input",{type:"hidden",name:"fileName",value:n+"_activity"}),i.createElement("input",{type:"submit",value:"Submit"}))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(8),l=n(787),d=n(785),c=n(60),u=n(5),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this.props.settings,t=this.props.studentsData;if(t.length){var n=g(t,e,this.props.columnsToShow,this.props.classId);return o.createElement(c.VTable,{header:h(this.props.columnsToShow),body:n,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,fixedRowCount:3,fixedColumnCount:1})}return o.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noDataGeneric)},t}(o.Component);t.default=p;var h=function(e){var t={name:"Student",readingTime:o.createElement("div",null,"Learning",o.createElement("div",null,"Time")),questionCompleted:o.createElement("div",null,"Questions",o.createElement("div",null,"Completed")),revisionCount:o.createElement("div",null,"Number of",o.createElement("div",null,"Answer Revisions")),totalPoints:o.createElement("div",null,"Total",o.createElement("div",null,"Points")),vocabLookups:o.createElement("div",null,"Vocab",o.createElement("div",null,"Lookups")),notes:o.createElement("div",null,"Notes ",o.createElement("div",null,"(Total/shared)")),totalWordsWritten:o.createElement("div",null,"Total Words",o.createElement("div",null,"Written")),viewPeerResponses:o.createElement("div",null,"View Peer",o.createElement("div",null,"Responses")),translationLookups:o.createElement("div",null,"Translation",o.createElement("div",null,"Lookups")),tts:o.createElement("div",null,"Text to Speech",o.createElement("div",null,"Requests")),numIRTextsRead:o.createElement("div",null,"Independent Reading",o.createElement("div",null,"Texts Read")),irReadingTime:o.createElement("div",null,"Independent Texts",o.createElement("div",null,"Learning Time")),researchTextAdded:o.createElement("div",null,"Research",o.createElement("div",null,"Texts Added"))};return sCH.userM.get("ShouldShowIRInMainMenu")||(delete t.numIRTextsRead,delete t.irReadingTime),{height:60,cells:e.map((function(e){return{content:t[e],width:180,classes:{center:"name"!==e}}}))}},g=function(e,t,n,a){var s=l.getActivityDataByAssignment(e),o=s.studentsData,r=s.classTotals,d=f(r,o.length,n),c=m(r,n),u=v(o,t,n,a);return i([c,d],u)},f=function(e,t,n){var a=l.getClassAverageRowData(e,t);return{height:50,cells:n.map((function(e){return{content:a[e],width:180,classes:{center:"name"!==e}}}))}},m=function(e,t){var n=l.getClassTotalRowData(e);return{height:50,cells:t.map((function(e){return{content:n[e],width:180,classes:{center:"name"!==e}}}))}},v=function(e,t,n,a){var s=t.shortAnswer.denominator,i=t.shortAnswer.numerators.basic/s*100,l=t.shortAnswer.numerators.proficient/s*100,c=[];return r.forEach(e,(function(e){var t=e.data.responseData.pointsMax?Math.round(e.data.responseData.pointsSum/e.data.responseData.pointsMax*100):"N/A",s=isNaN(t)?"":t>=l?"green":t<=i?"red":"yellow",r=e.data.readingTimeData?e.data.readingTimeData.time:0,p=e.data.responseData.noRespAnswers+e.data.responseData.answers===0?-1:parseInt((100*e.data.peerResponseLookupsData.lookupCount/(e.data.responseData.noRespAnswers+e.data.responseData.answers)).toString(),10),h={name:{displayValue:o.createElement("a",{href:"#teacher/classes/"+a+"/studentdata/overview/?studentuserid="+e.userId},u.sanitize(e.name)),sortValue:u.sanitize(e.name)},readingTime:{displayValue:u.getFormattedTime(r,!1),sortValue:r},questionCompleted:{displayValue:e.data.responseData.answers,sortValue:e.data.responseData.answers},revisionCount:{displayValue:e.data.revisionData.revisionCount,sortValue:e.data.revisionData.revisionCount},totalPoints:{displayValue:o.createElement("span",{className:s},o.createElement(d.Grade,{pointsEarned:e.data.responseData.pointsSum,pointsPossible:e.data.responseData.pointsMax,percentageOnTop:!0})),sortValue:t},vocabLookups:{displayValue:e.data.vocabLookupsData.lookupCount,sortValue:e.data.vocabLookupsData.lookupCount},notes:{displayValue:e.data.notesData.count+" / "+e.data.notesData.publicCount,sortValue:e.data.notesData.count},totalWordsWritten:{displayValue:e.data.notesData.wordCount+e.data.responseData.wordCount,sortValue:e.data.notesData.wordCount},viewPeerResponses:{displayValue:e.data.responseData.noRespAnswers+e.data.responseData.answers===0?"N/A":p+"%",sortValue:p},translationLookups:{displayValue:e.data.translationLookupCount,sortValue:e.data.translationLookupCount},tts:{displayValue:e.data.ttsCount,sortValue:e.data.ttsCount},numIRTextsRead:{displayValue:e.data.irData.textCount,sortValue:e.data.irData.textCount},irReadingTime:{displayValue:u.getFormattedTime(e.data.irData.readingTime,!1),sortValue:e.data.irData.readingTime},researchTextAdded:{displayValue:e.data.researchTextCount,sortValue:e.data.researchTextCount}};c.push({height:50,cells:n.map((function(e){return{content:h[e].displayValue,width:180,sortValue:h[e].sortValue,classes:{center:"name"!==e}}}))})})),c}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(1608),o=n(0),r=n(0),l=n(1609),d=n(5),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.state={},a}return s(t,e),t.prototype.render=function(){var e=d.gradeNameMap(!1,{gradebook:this.props.Settings}).slice().reverse(),t=!this.props.Standards||0===this.props.Standards.length;return o.createElement(o.Fragment,null,o.createElement("div",{className:"pageInfoTextWrapper"},t?o.createElement("div",{className:"ctaInfo"},"No graded responses for questions that are attached to standards."):o.createElement(o.Fragment,null,o.createElement("p",null,"Student performance by standards."),o.createElement(l.default,{options:e}))),!t&&o.createElement("div",{className:"dataWrapper"},o.createElement(i.default,{settings:this.props.Settings,students:this.props.Students,standards:this.props.Standards,classId:this.props.ClassId,proficiencyGrades:this.props.ProficiencyGrades})))},t}(r.Component);t.default=c},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(748),o=n(60),r=n(14),l=n(5),d=n(8),c=n(0),u=n(65);t.default=function(e){var t=h(e);return c.createElement(o.VTable,{header:p(e),enableFixedColumnScroll:!0,enableFixedRowScroll:!0,body:t,fixedRowCount:2,fixedColumnCount:1})};var p=function(e){var t=e.standards.map((function(e){return{content:c.createElement(u.default,{title:e.ShortText.length>30?e.ShortText:"",tooltipPlacement:"bottom"},c.createElement("div",null,c.createElement("span",{className:"labels"},e.StandardCode),l.truncate(e.ShortText,30))),width:180,classes:{center:!0}}}));return{height:66,cells:s([{content:"Student",width:180}],t)}},h=function(e){var t=e.settings,n=e.students,o=e.standards,r=e.proficiencyGrades,u=e.classId,p=l.gradeNameMap(!1,{gradebook:t}).slice().reverse(),h=d.find(p,{id:"advanced"}).label,v="% of answers graded '"+d.find(p,{id:"proficient"}).label+"' or '"+h+"'",b=m(o,r),C=n.map((function(e){var t={content:c.createElement("a",{href:"#teacher/classes/"+u+"/studentdata/standards/?studentuserid="+e.UserId},e.LastName,", ",e.FirstName),sortValue:e.LastName+", "+e.FirstName},n=o.map((function(t){var n=r.filter((function(n){return(n.StandardId===t.StandardId||n.SecondStandardId===t.StandardId)&&n.StudentUserId===e.UserId})),s=f(n),o=n.length;return n.length>0?{content:c.createElement(i.default,a({},s,{toolTipText:c.createElement("div",null,v,c.createElement("div",null,"(",l.plural(o,"%count graded answer","%count graded answers"),")"))})),sortValue:g(s)}:{content:c.createElement("div",{className:"gradePercentageBar"}),sortValue:null}}));return{height:50,cells:s([t],n)}}));return s([b],C)},g=function(e){return Math.round(100*(e.proficientRatio||0)+100*(e.advancedRatio||0))+.01*Math.round(100*(e.advancedRatio||0))+1e-4*Math.round(100*(e.basicRatio||0))+1e-5*Math.round(100*(e.incompleteRatio||0))},f=function(e){return{zeroRatio:e.filter((function(e){return e.Grade===r.Grades.ZERO})).length/e.length,incompleteRatio:e.filter((function(e){return e.Grade===r.Grades.INCOMPLETE})).length/e.length,basicRatio:e.filter((function(e){return e.Grade===r.Grades.BASIC})).length/e.length,proficientRatio:e.filter((function(e){return e.Grade===r.Grades.PROFICIENT})).length/e.length,advancedRatio:e.filter((function(e){return e.Grade===r.Grades.ADVANCED})).length/e.length}},m=function(e,t){return{height:50,cells:s([{content:"Class Average"}],e.map((function(e){return{content:c.createElement(i.default,a({},v(e,t)))}})))}},v=function(e,t){var n=t.filter((function(t){return t.StandardId===e.StandardId||t.SecondStandardId===e.StandardId}));return{zeroRatio:n.filter((function(e){return e.Grade===r.Grades.ZERO})).length/n.length,incompleteRatio:n.filter((function(e){return e.Grade===r.Grades.INCOMPLETE})).length/n.length,basicRatio:n.filter((function(e){return e.Grade===r.Grades.BASIC})).length/n.length,proficientRatio:n.filter((function(e){return e.Grade===r.Grades.PROFICIENT})).length/n.length,advancedRatio:n.filter((function(e){return e.Grade===r.Grades.ADVANCED})).length/n.length}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.createElement("div",{className:"key"},e.options.map((function(e){return a.createElement("div",{className:e.id,key:e.id},a.createElement("span",{className:"circle"}),e.label)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=n(1611);t.default=Backbone.View.extend({el:"div.teacherClasses .scroll",initialize:function(e){this.subheader=e.subheader,this.studentUserId=e.studentUserId,Backbone.pubEv.on("studentDataUserSelected",s.renderStudentDataScroll,this),Backbone.pubEv.on("rerenderClassData",this.render,this),Backbone.pubEv.on("updateSubTab",this.updateSubTab,this)},render:function(e,t){this.subtab=t||this.subtab,this.$el.html('<div id="studentdata" />'),this.fetchStudentData(e)},fetchStudentData:function(e){var t=this;a.GetStudents({classId:e},(function(n){t.rawData={students:n,studentUserId:t.studentUserId||(n.length>0?n[0].UserId:-1),classId:e,subtab:t.subtab},Backbone.pubEv.trigger("InitializeStudentDataStudentList",{studentUserId:t.rawData.studentUserId,students:t.rawData.students}),s.renderStudentDataScroll.call(t)}))},updateSubTab:function(e){this.subtab=e},destroy:function(){this.$el.parent().removeClass("studentdata"),this.undelegateEvents(),Backbone.pubEv.off("studentDataUserSelected"),Backbone.pubEv.off("rerenderClassData"),Backbone.pubEv.off("updateSubTab")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(788),i=n(1623),o=n(20);t.renderStudentDataScroll=function(e){e&&(this.rawData.studentUserId=e),this.studentUserId=this.rawData.studentUserId;var t=window.location.hash.split("/")[4];t&&(this.rawData.subtab=t);var n=this.$el.find("#studentdata");a.unmountReactComponent(n[0]),a.mountReactComponent(o.default.isMath?i.default:s.default,n[0],this.rawData)}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(1613),l=n(1614),d=n(5);n(1615);var c=n(153),u=n(87),p=n(13).withStyles,h="rgba(144, 164, 174, 0.6)",g="#388E3C",f="#FFC107",m="#D32F2F",v=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.generateRecommendations=function(){var e=[];a.props.ReadingTimePaceNeedlePercentage<33&&e.push("Spend more time on assignments"),a.props.WordCountPerResponseNeedlePercentage<33&&e.push("Write longer responses to questions"),a.props.NumVocabLookups/a.props.GradesByAssignment.length<2&&e.push("Use dictionary more"),a.props.NumNotesWritten/a.props.GradesByAssignment.length<2&&e.push("Annotate more");var t=[];return a.props.GradesByStandards.forEach((function(e){var n=e.NumRed/(e.NumRed+e.NumGreen)<.65;e.StandardCode&&e.NumRed>4&&n&&t.push(e.StandardCode)})),t.length>0&&e.push("Practice these standards more: "+t.join(", ")),e},a}return s(t,e),t.prototype.componentDidMount=function(){d.initTooltips($(".dataWrapper"))},t.prototype.render=function(){return o.createElement("div",null,o.createElement(b,i({},this.props,{firstName:this.props.FirstName,lastName:this.props.LastName,recommendations:this.generateRecommendations()})),o.createElement(y,i({},this.props)),o.createElement(_,i({},this.props)),o.createElement(S,i({},this.props)))},t}(o.Component),b=function(e){if(0===e.recommendations.length)return null;var t=e.firstName+" "+e.lastName,n=e.classes,a="student"===sCH.userM.get("Role");return o.createElement("section",{className:[n.section,n.recommendations].join(" ")},o.createElement("div",{className:n.caption},"Recommendations for ",a?"you":t,o.createElement(c.default,{buttonClass:["icon-question-mark-inverse",n.infoButton].join(" "),placement:"right"},"Based on Actively Learns data and ",a?"your":t+"'s"," work (reading time, written responses, use of reading aids, etc.), the following recommendations may help ",a?"you":e.firstName," improve:")),o.createElement("ul",{className:n.recommendationList},e.recommendations.map((function(e){return o.createElement("li",{key:e},e)}))))},C=function(e,t){var n=0;if(isNaN(e))return n;var a=d.getGradeAverageThresholds(t),s=a.possible,i=a.basic/s*100,o=a.proficient/s*100;if(e>=o)n=100/3*2+(e-o)/(100-o)*(100/3);else if(e>=i){n=100/3+(e-i)/(o-i)*(100/3)}else{n=e/i*(100/3)}return n},y=function(e){var t=e.classes,n=e.GradesByAssignment.map((function(e){return e.Grade})),a=e.GradesByAssignment.map((function(e){return e.AssignmentTitle})),s=e.ReadingTimePaceByAssignment.map((function(e){return e.ReadingPace})),i=e.ReadingTimePaceByAssignment.map((function(e){return e.AssignmentTitle})),d=e.WordCountPerResponseByAssignment.map((function(e){return e.WordCountPerResponse})),u=e.WordCountPerResponseByAssignment.map((function(e){return e.AssignmentTitle}));return o.createElement("section",{className:[t.section,t.metricsSection].join(" ")+" coreMetricSection"},o.createElement("div",{className:t.metric+" containerDiv "+t.metricGrade},o.createElement("div",{className:t.metricCaption},"Grade"),o.createElement("div",{className:t.donut},o.createElement(l.default,{data:[100/3,100/3,100/3],colors:[m,f,g],labels:["Below\nBasic","Between Basic\nand Proficient","Beyond\nProficient"],labelColors:["#000","#000","#000"],needlePercent:C(e.GradesTotalAverage,e.ClassGradingSettings)})),o.createElement("div",{className:t.bar},o.createElement(r.default,{color:"#546E7A",data:n,tooltips:a}),o.createElement("div",{className:t.barCaption},"by assignment"))),o.createElement("div",{className:t.metric+" containerDiv "+t.metricReadingPace},o.createElement("div",{className:t.metricCaption},"Reading pace",o.createElement(c.default,{className:["icon-question-mark-inverse",t.infoButton].join(" ")},"In our data, we see student performance get worse when we see students spend too little time overall. We want to help diagnose based on our data. The two things that are correlated with grades are reading time and writing.")),o.createElement("div",{className:t.donut},o.createElement(l.default,{data:[100/3,100/3,100/3],colors:[m,h,g],labels:["Too fast","","Sufficient"],labelColors:["#000","#000","#000"],needlePercent:e.ReadingTimePaceNeedlePercentage})),o.createElement("div",{className:t.bar},o.createElement(r.default,{color:"#546E7A",data:s,threestep:!0,tooltips:i}),o.createElement("div",{className:t.barCaption},"by assignment"))),o.createElement("div",{className:t.metric+" containerDiv "+t.metricWords},o.createElement("div",{className:t.metricCaption},"Words per response"),o.createElement("div",{className:t.donut},o.createElement(l.default,{data:[100/3,100/3,100/3],colors:[m,h,g],labels:["Too few","","Sufficient"],labelColors:["#000","#000","#000"],needlePercent:e.WordCountPerResponseNeedlePercentage})),o.createElement("div",{className:t.bar},o.createElement(r.default,{color:"#546E7A",data:d,threestep:!0,tooltips:u}),o.createElement("div",{className:t.barCaption},"by assignment"))))},_=function(e){var t=e.classes,n=0;e.GradesByStandards.forEach((function(e){e.StandardCode&&(n=Math.max(e.NumGreen,e.NumRed,n))}));var a=!1;e.GradesByStandards.sort((function(e,t){return u((e.StandardCode||"").toLowerCase(),(t.StandardCode||"").toLowerCase())}));var s=e.GradesByStandards.map((function(e,s){if(e.StandardCode){a=!0;var i=e.NumGreen/n*70,r=e.NumRed/n*70;return o.createElement("div",{key:s,className:t.standardContainer},o.createElement("div",{className:t.standardCode},e.StandardCode),o.createElement("div",{className:t.standardCircleContainer},o.createElement("div",{className:t.standardCircle,style:{backgroundColor:g,width:i,height:i},title:e.NumGreen+" responses"})),o.createElement("div",{className:t.standardCircleContainer},o.createElement("div",{className:t.standardCircle,style:{backgroundColor:m,width:r,height:r},title:e.NumRed+" responses"})))}}));return o.createElement("section",{className:[t.section,t.standardsStats].join(" ")},o.createElement("div",{className:t.caption},"Standards"),o.createElement("div",{className:t.standardsContainer},a?s:o.createElement("div",{className:"ctaInfo"},"Not enough data!")))},S=function(e){var t=e.classes,n=d.onDevice();return o.createElement("section",{className:[t.section].join(" ")},o.createElement("div",{className:t.caption},"Reading Activity"),o.createElement("div",{className:t.scorecardsContainer},o.createElement("div",{className:t.scorecard,style:{border:"1px solid #ddd"}},o.createElement("div",{className:t.scorecardCaption},"Vocab ",!n&&"lookups"),o.createElement("div",{className:t.scorecardNum},e.NumVocabLookups)),o.createElement("div",{className:t.scorecard,style:{border:"1px solid #ddd"}},o.createElement("div",{className:t.scorecardCaption},"Text-to-speech"),o.createElement("div",{className:t.scorecardNum},e.NumReadAlouds)),o.createElement("div",{className:t.scorecard,style:{border:"1px solid #ddd"}},o.createElement("div",{className:t.scorecardCaption},"Translations"),o.createElement("div",{className:t.scorecardNum},e.NumTranslations)),o.createElement("div",{className:t.scorecard,style:{border:"1px solid #ddd"}},o.createElement("div",{className:t.scorecardCaption},"Notes ",!n&&"written"),o.createElement("div",{className:t.scorecardNum},e.NumNotesWritten))))},w=p((function(e){return{metricGrade:{borderColor:"#ddd !important"},metricReadingPace:{borderColor:"#ddd !important"},metricWords:{borderColor:"#ddd !important"},barCaption:{textAlign:"center",marginTop:-20,fontSize:15},section:{maxWidth:1e3,marginBottom:30},metricsSection:{marginTop:30,display:"flex",justifyContent:"center",flexWrap:"wrap"},metric:{width:292,position:"relative",padding:20,"&:not(:last-child)":{borderRight:"1px solid black"}},metricCaption:{fontSize:20,minHeight:"2em",textAlign:"center",fontFamily:"Avenir Next LT W02 Demi"},donut:{position:"relative",width:292,height:178,marginBottom:20},bar:{width:292,height:150},label:{position:"absolute",fontSize:25,lineHeight:"150px",textAlign:"center",top:0,left:0,right:0,zIndex:1},guageLabel:{top:"initial",bottom:20,fontSize:18,lineHeight:"initial"},recommendations:{border:"1px dashed #03A9F4",padding:10,fontSize:16,marginTop:10},caption:{fontSize:20,fontFamily:"Avenir Next LT W02 Demi"},infoButton:{fontSize:16,lineHeight:1,"&:before":{fontSize:"16px !important",lineHeight:"1 !important"}},recommendationList:{"& li:before":{content:'""',height:10,width:10,display:"inline-block",border:"1px solid black",borderRadius:20,marginLeft:10,marginRight:10}},totalGrade:{height:150,width:150,position:"relative"},gradeLabel:{height:150,width:150,position:"absolute",fontSize:25,lineHeight:"150px",textAlign:"center",top:0,zIndex:1},standardsContainer:{display:"flex",flexWrap:"wrap",minWidth:600,marginTop:10},standardContainer:{display:"flex",justifyContent:"space-around",width:"33%",height:100,alignItems:"center",border:"solid 1px #CFD8DC",marginLeft:"-1px",marginTop:"-1px"},standardCode:{width:50,fontSize:20},standardCircleContainer:{display:"flex",justifyContent:"center",width:80},standardCircle:{borderRadius:50},scorecardsContainer:{display:"flex",justifyContent:"space-between",minWidth:600,maxWidth:1024,marginTop:10},scorecard:{width:"22%",height:100,padding:20,boxSizing:"border-box",color:"#000"},scorecardCaption:{fontSize:20},scorecardNum:{fontFamily:"Avenir Next LT W02 Demi",fontSize:30,color:"rgba(84,110,122)"}}}));t.default=w(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(0),i=n(174);t.default=function(e){var t={labels:a.fill(Array(e.data.length)," "),datasets:[{label:[],backgroundColor:e.color,borderWidth:0,data:e.data}]},n={plugins:{datalabels:{display:!1}},tooltips:{enabled:e.tooltips&&e.tooltips.length,displayColors:!1,bodySpacing:2,callbacks:{label:function(t){return e.tooltips[t.index]&&e.tooltips[t.index].length>36?e.tooltips[t.index].substring(0,36)+"...":e.tooltips[t.index]},title:function(){return null}}},legend:{display:!1},maintainAspectRatio:!1,scales:{xAxes:[{gridLines:{display:!1}}],yAxes:[{ticks:{display:!1,min:0,stepSize:e.threestep?33:20,max:100},gridLines:{drawTicks:!1,drawBorder:!1,tickMarkLength:0},scaleLabel:{display:!1}}]}};return s.createElement(i.Bar,{data:t,options:n})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(0),r=n(174),l=function(e){function t(t,n){var a=e.call(this,t)||this;return a.getCanvas=function(){return a.component.current.chartInstance.canvas},a.drawNeedle=function(e){if(null!=e){var t=(100-e)/100*-180*Math.PI/180,n=a.component.current.chartInstance.outerRadius+5,s=a.getCanvas(),i=s.getContext("2d"),o=s.offsetWidth/2,r=s.offsetHeight-16.5;i.translate(o,r),i.rotate(t),i.beginPath(),i.moveTo(0,-10),i.lineTo(n,0),i.lineTo(0,10),i.fillStyle="rgba(84,110,122, 0.6)",i.fill(),i.rotate(-t),i.translate(-o,-r),i.beginPath(),i.arc(o,r,10,t+Math.PI/2,t+Math.PI+Math.PI/2),i.fill()}},a.component=o.createRef(),a}return s(t,e),t.prototype.render=function(){var e=this,t=i.fill(Array(this.props.data.length),1),n={datasets:[{data:this.props.data,backgroundColor:this.props.colors,hoverBackgroundColor:this.props.colors,borderWidth:t,borderColor:"#fff"}],labels:this.props.labels},a={events:[],tooltips:{enabled:!1},legend:{display:!1},maintainAspectRatio:!1,cutoutPercentage:90,rotation:Math.PI,circumference:Math.PI,plugins:{datalabels:{formatter:function(e,t){return t.chart.config.data.labels[t.dataIndex]},anchor:"start",align:"start",color:this.props.labelColors,font:{size:12,family:"Avenir Next LT W02 Demi"}}},animation:{onComplete:function(){return e.drawNeedle(e.props.needlePercent)}}};return o.createElement(r.Doughnut,{ref:this.component,options:a,data:n})},t}(o.Component);t.default=l},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(5),i=function(e){return{width:s.percent(e)}};t.default=function(e){var t=e.pointsPossible>0?s.percent(e.pointsEarned/e.pointsPossible):null,n=e.pointsEarned%1==0?e.pointsEarned:e.pointsEarned.toFixed(1),o=e.pointsPossible%1==0?e.pointsPossible:e.pointsPossible.toFixed(1),r=e.pointsEarned>0?" withbg":"";return a.createElement("div",{className:"gradePointsEarnedBar"},a.createElement("span",{className:"bar "+e.color+r,style:i(e.pointsEarned/e.pointsPossible)},n,"/",o," (",t,")"))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(8),l=n(491),d=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._selectStandardFilter=function(){return function(e){var t=e.target.value;a.setState({currentFilter:t})}},a._selectStandardFilter=a._selectStandardFilter.bind(a),a.state={currentFilter:-1},a}return s(t,e),t.prototype.render=function(){var e=c(this.props.studentStandardsData);return i.createElement(l.default,{data:this.props.studentStandardsData,classId:this.props.classId,titleHash:this.props.ccStdMap,filters:e,filterStyle:"selector",noDataText:"No data for the selected filter yet"})},t}(o.Component);t.default=d;var c=function(e){var t=[{value:-1,text:"All"}],n=r.uniq(r.reduce(e,(function(e,t){return null!=t.groupBy?e.concat(t.filterBy):e}),[]));return r.each(n,(function(e){t.push({value:e,text:e})})),t.length>2?t:[]}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(96),d=n(39),c=n(10),u=n(5),p=n(54),h=n(266),g=n(271),f=n(790),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.renderDateFilter=function(){p.initDateRangePicker(moment(a.state.startDate),moment(a.state.endDate),(function(e,t){a.getWritingData({startDate:e.toISOString(),endDate:t.toISOString()})}),"student")},a.handleSelectChange=function(e){return function(t){var n;a.getWritingData(((n={})[e]=t.target.value,n))}},a.getWritingData=function(e){var t=i({classId:a.props.classId,studentUserId:a.props.studentUserId,writingDataPageSize:alcfg.writingDataPageSize,skillBucketId:a.state.skillBucketId,tagType:a.state.tagType,minWordsCount:a.state.minWordsCount,startDate:a.state.startDate,endDate:a.state.endDate,pageNumber:0},e);c.GetStudentDataWriting(t,(function(n){a.setState(i(i({writingData:n.data},e),{pageNumber:t.pageNumber,totalCount:t.pageNumber>0?a.state.totalCount:n.totalCount})),$(".layout .scroll").scrollTop(0)}))};var s=p.getSchoolYearRangeOrDefault("student");return a.state={skillBucketId:-1,tagType:"all",minWordsCount:5,startDate:s.start.toISOString(),endDate:s.end.toISOString(),pageNumber:0,writingData:[],totalCount:0},a}return s(t,e),t.prototype.componentDidMount=function(){this.renderDateFilter(),this.getWritingData({})},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype.render=function(){var e=this,t=f.getClassGradeNameMap(this.props.classId);return o.createElement("div",{className:"studentDataWriting"},o.createElement("div",{id:"portfolioFilters"},o.createElement(l.default,{className:"ddlSkillBuckets",onChange:this.handleSelectChange("skillBucketId"),value:this.state.skillBucketId},o.createElement(d.default,{value:-1,key:"-1"},"All content types"),o.createElement(d.default,{value:1,key:"1"},"Literature"),o.createElement(d.default,{value:2,key:"2"},"Informational"),o.createElement(d.default,{value:3,key:"3"},"Science"),o.createElement(d.default,{value:5,key:"4"},"Other")),o.createElement(l.default,{className:"ddlTagType",onChange:this.handleSelectChange("tagType"),value:this.state.tagType},o.createElement(d.default,{value:"all",key:"all"},"All writing"),o.createElement(d.default,{value:"questionresponses",key:"questionresponses"},"Only question responses"),o.createElement(d.default,{value:"notes",key:"notes"},"Only notes")),o.createElement(l.default,{className:"ddlWordCount",onChange:this.handleSelectChange("minWordsCount"),value:this.state.minWordsCount},o.createElement(d.default,{value:5,key:"5"},"Writing over 5 words"),o.createElement(d.default,{value:10,key:"10"},"Writing over 10 words"),o.createElement(d.default,{value:15,key:"15"},"Writing over 15 words"),o.createElement(d.default,{value:20,key:"20"},"Writing over 20 words")),o.createElement("div",{className:"reportrange pull-right"},o.createElement("span",null),o.createElement("b",{className:"caret"}))),this.state.writingData.length?this.state.writingData.map((function(n,a){return o.createElement("div",{key:n.TagType+a,className:"questionContainer "+("Question"===n.TagType?"":"noteTagContainer")+" "+n.Color},o.createElement("table",null,"Question"===n.TagType?o.createElement(v,{data:n,studentUserId:e.props.studentUserId,gradeNameMap:t}):o.createElement(b,{data:n})))})):o.createElement("div",{className:"ctaInfo"},"No data"),!!this.state.totalCount&&o.createElement(g.default,{currentPage:this.state.pageNumber,showTotalRecordsCount:!0,totalItems:this.state.totalCount||0,currentPageItemsCount:this.state.writingData.length,itemsPerPage:alcfg.writingDataPageSize,pageChangeCallback:this.getWritingData}))},t}(r.Component);t.default=m;var v=function(e){var t=e.data,n=e.studentUserId,a=e.gradeNameMap,s=alcfg.grades.list,i=t.Responses&&t.Responses.length?t.Responses[t.Responses.length-1]:{},r="student"===h.userM.get("Role")?"#student/reader/"+t.AssignmentId+"/notes":"#teacher/reader/grading/"+t.AssignmentId+"/grading/?student="+n;return o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",{style:{width:24}},o.createElement("span",{className:"icon-question no-hover"})),o.createElement("td",null,o.createElement("div",{className:"questionText",dangerouslySetInnerHTML:{__html:u.sanitize(t.SourceText)}}),o.createElement("div",{className:"title"},u.htmlDecode(u.sanitize(t.AssignmentTitle)))),o.createElement("td",{rowSpan:2,className:"meta"},!i.IsReset&&null!==i.Grade&&o.createElement("a",{title:"View in text",onClick:function(){return u.openReaderUrl(r)},className:"btn-box grade "+s[i.Grade].id},a[s[i.Grade].id]),t.MaxResponseDate&&o.createElement("div",{className:"answerDate"},moment.utc(t.MaxResponseDate).local().format("MM-DD-YY")))),o.createElement("tr",null,o.createElement("td",{colSpan:2},o.createElement("div",{className:"responses"},t.Responses.map((function(e,t){return o.createElement("div",{key:t,className:"responseContainer "+(e.IsReset?"":"margin")},o.createElement("div",null,o.createElement("span",{className:"heading"},"Response #",t+1,": ")),o.createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:u.sanitize(u.wrapOldTextAreaContentInPTags(e.AnswerText))}}),e.TeacherComment&&o.createElement("div",{className:"clearBoth"},o.createElement("div",{className:"heading"},"Teacher comment:"),o.createElement("div",{className:"teacherComment",dangerouslySetInnerHTML:{__html:u.sanitize(u.wrapOldTextAreaContentInPTags(e.TeacherComment))}})))}))))))},b=function(e){var t=e.data;return o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",{style:{width:24}},o.createElement("span",{className:"icon-notes no-hover"})),o.createElement("td",null,o.createElement("div",{className:"questionText",dangerouslySetInnerHTML:{__html:u.sanitize(t.SourceText)}}),t.IsResearch?o.createElement("ul",{className:"bubbleList"},o.createElement("li",null,"Research")):null,o.createElement("div",{className:"title"},u.htmlDecode(u.sanitize(t.AssignmentTitle)))),o.createElement("td",{rowSpan:2,className:"meta"},o.createElement("span",{className:"notesTag "+t.Color},t.Category),t.MaxResponseDate&&o.createElement("div",{className:"answerDate"},moment.utc(t.MaxResponseDate).local().format("MM-DD-YY")))),o.createElement("tr",null,o.createElement("td",{colSpan:2},o.createElement("div",{className:"responses"},o.createElement("div",{className:"responseContainer"},o.createElement("div",null,o.createElement("span",{className:"heading"},"Note:")),o.createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:u.sanitize(u.wrapOldTextAreaContentInPTags(t.Text))}}))))))}},,,,function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(60),d=n(10),c=n(5),u=n(54),p=n(266),h=n(8),g=function(e){function t(t,n){var a=e.call(this,t,n)||this,s=u.getSchoolYearRangeOrDefault("student");return a.state={researchData:[],startDate:s.start.toISOString(),endDate:s.end.toISOString()},a}return s(t,e),t.prototype.componentDidMount=function(){this._renderDateFilter(),this._getData({})},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype._renderDateFilter=function(){var e=this;u.initDateRangePicker(moment(this.state.startDate),moment(this.state.endDate),(function(t,n){e._getData({startDate:t.toISOString(),endDate:n.toISOString()})}),"student")},t.prototype._getData=function(e){var t=this,n=i({classId:this.props.classId,studentUserId:this.props.studentUserId,startDate:this.state.startDate,endDate:this.state.endDate},e);d.GetStudentDataResearch(n,(function(n){var a=i(i({},e),{researchData:n});t.setState(a)}))},t.prototype._getTable=function(e){var t=m(e),n=v();return o.createElement(l.VTable,{header:n,body:t,enableFixedColumnScroll:!0,fixedRowCount:1,fixedColumnCount:1})},t.prototype.render=function(){return o.createElement("div",{className:"studentDataResearchIR tableViewWrapper"},o.createElement("div",{id:"portfolioFilters"},o.createElement("div",{className:"reportrange pull-right"},o.createElement("span",null),o.createElement("b",{className:"caret"}))),this.state.researchData.length?this._getTable(this.state.researchData):o.createElement("div",{className:"ctaInfo"},"No data for this date range!"))},t}(r.Component),f={title:"Title",addedBy:"Added By",dateAdded:"Date Added",readingTime:"Reading Time",source:"Source",labels:"Labels",notes:"# Notes"},m=function(e){var t=window.isIOSApp?"":"_blank",n=new RegExp(alcfg.wordDelimiter,"g"),a=[];return h.each(e,(function(e){var s="Box"===e.Source?"PDF":"docs.google.com-al"===e.Source?"Google Docs":e.Source,i=c.htmlDecode(c.sanitize(e.Title)),r=c.sanitize(e.AddedBy),l=e.Labels?c.sanitize(e.Labels.replace(n,", ")):"",d="student"===p.userM.get("Role")?"#student/reader/research/"+e.StudentLayerId+"/notes":"#teacher/reader/research/preview/"+e.StudentLayerId+"/notes",u={title:{content:o.createElement("a",{href:d,target:t},i),sortValue:i},addedBy:{content:r,sortValue:r},dateAdded:{content:o.createElement("span",null,moment.utc(e.CreateDate).local().format("MMM Do YYYY")),sortValue:moment(e.CreateDate)},readingTime:{content:o.createElement("span",null,c.getFormattedTime(e.TotalReadingTime,!0)),sortValue:e.TotalReadingTime||0},source:{content:s,sortValue:s},labels:{content:l,sortValue:l},notes:{content:e.NotesCount,sortValue:e.NotesCount}};a.push({height:50,cells:Object.keys(f).map((function(e){return{content:u[e].content,width:"title"===e?360:180,classes:{center:"title"!==e},sortValue:u[e].sortValue}}))})})),a},v=function(){return{height:50,cells:h.map(Object.keys(f),(function(e){return{content:f[e],width:"title"===e?360:180,classes:{center:"title"!==e}}}))}};t.default=g},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(234),l=n(133),d=n(1624),c=n(1626),u=n(280),p=n(37),h=[{id:"mastery",displayName:"Mastery Progress"},{id:"intervention",displayName:"Interventions"}],g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={assignments:[],selectedTab:h[0],selectedStudent:null,suggestions:t.props.students.map((function(e){return{value:e.UserId,label:e.LastName+(e.LastName?", ":"")+e.FirstName}}))},t.switchReport=function(e){t.state.selectedTab.id!==e&&Backbone.pubEv.trigger("updateSubTab",e),e===h[1].id?t.setState({selectedTab:h[1]}):t.setState({selectedTab:h[0]})},t.renderIntervention=function(){var e=t.props,n=e.classId,a=e.studentUserId;return p.addToNavigationHistory("#teacher/classes/"+n+"/studentdata/intervention/?studentuserid="+a),i.createElement(c.default,{classId:n,studentUserId:a})},t.renderMastery=function(){var e=t.props,n=e.classId,a=e.studentUserId;return p.addToNavigationHistory("#teacher/classes/"+n+"/studentdata/mastery/?studentuserid="+a),i.createElement(d.default,{classId:n,studentUserId:a})},t.handleSelectStudentChange=function(e){var n=parseInt(e.value,10);t.setState({selectedStudent:e},(function(){Backbone.pubEv.trigger("studentDataUserSelected",n)}))},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props.studentUserId,t=this.state.suggestions.find((function(t){return t.value===e}));this.setState({selectedStudent:t})},t.prototype.render=function(){var e=this.props.students,t=this.state,n=t.selectedStudent,a=t.selectedTab,s=t.suggestions,o=a.id===h[1].id;return e.length>0?i.createElement(i.Fragment,null,i.createElement("div",{className:"mathStudentDataHeader"},i.createElement(r.default,{value:n,suggestions:s,onChange:this.handleSelectStudentChange,inputId:"select-student",customSelectStyles:l.studentDataMasteryStudentDropdownStyles}),i.createElement(u.TabList,{tabsArray:h,selectedTab:a,onTabChange:this.switchReport})),o?this.renderIntervention():this.renderMastery()):i.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noStudentsInClass)},t}(o.Component);t.default=g},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(133),d=n(60),c=n(1625),u=n(13),p=n(10),h=n(280),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hintsAndVideoData:[],problemData:[],stepData:[],masteryData:[]},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.classId,a=t.studentUserId;a>0&&p.GetStudentDataMastery({classId:n,studentUserId:a},(function(t){e.setState(t)}))},t.prototype.render=function(){return this.state.masteryData.length>0?o.createElement(o.Fragment,null,o.createElement(h.StudentDataScoreCards,i({},this.state)),o.createElement(f,{masteryData:this.state.masteryData})):o.createElement("div",{className:"ctaInfo"},"No assignments!")},t}(r.Component),f=function(e){var t=e.masteryData;return o.createElement(d.VTable,{header:m(),body:t.map((function(e){return v(i({},e))})),fixedRowCount:1,fixedColumnCount:0,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:-1,customClassNames:["masteryStudentDataTable"]})},m=function(){return{height:60,cells:[{content:"Assignment",maxWidth:250,width:250},{content:"Mastery by problem set",width:250}]}},v=function(e){var t=e.code,n=e.name,a=e.masteryAtCompletions,s=e.interventionId,i=_(),r=a.length,d=C(a),u=d[d.length-1],p=l.getMasteryColor(u),h=d.map((function(e,t){return"Problem "+(t+1)})),g=d.map((function(e){return p})),f=100-u+"%",m=b(r);return{height:165,cells:[{content:o.createElement(y,{numProblemsCompleted:r,name:n,code:t,isIntervention:!!s}),sortValue:t},{content:0===r?o.createElement("div",{className:i.noProblemsCompleted},"No problems completed!"):o.createElement("div",{className:i.lineChartContainer,style:{maxWidth:m}},o.createElement("div",{className:i.percentage,style:{top:f}},u,"%"),o.createElement(c.default,{labels:h,pointsColor:g,color:p,data:d,title:"Mastery",additionalOptions:{tooltips:{enabled:!0,bodyFontFamily:"Avenir Next LT W02 Demi",xPadding:10,yPadding:10,bodyFontSize:14,cornerRadius:0,displayColors:!1,callbacks:{label:function(e,t){return t.datasets[e.datasetIndex].label+": "+e.yLabel+"%"}}}}})),sortValue:u}]}},b=function(e){if(0===e)return"100%";if(1===e)return"100px";if(e>=5)return"100%";var t=e-1;return Math.round(100*t/4)+"%"},C=function(e){return e.map((function(e){return l.percent(e,1)}))},y=function(e){var t=e.name,n=e.code,a=e.numProblemsCompleted,s=e.isIntervention,i=_();return o.createElement("div",{className:i.standardContainer},o.createElement("div",{className:i.standardTitle},o.createElement("div",{className:i.standardCode},n),a>0&&o.createElement("div",{className:i.masteryYAxisLabel},"Mastery"),a>0&&o.createElement("div",{className:i.sixtyYAxisLabel},"60%"),a>0&&o.createElement("div",{className:i.thirtyYAxisLabel},"30%")),o.createElement("div",{className:i.standardName},t),s&&o.createElement("div",{className:i.interventionPill},"Intervention"))},_=u.makeStyles({standardContainer:{padding:"20px 16px"},standardCode:{fontFamily:"Avenir Next LT W02 Demi",color:"#A1A1A1",position:"absolute",top:20,letterSpacing:.4},standardName:{fontFamily:"Avenir Next LT W02 Demi",fontSize:16},noProblemsCompleted:{color:"#A1A1A1",fontSize:16,textTransform:"uppercase",marginLeft:10},lineChartContainer:{paddingRight:30,position:"relative"},percentage:{position:"absolute",right:15,transform:"translate(0%, -20%)",fontFamily:"Avenir Next LT W02 Bold"},masteryYAxisLabel:{color:"#A1A1A1",position:"absolute",textTransform:"uppercase",right:2,top:23,fontSize:10,letterSpacing:2,lineHeight:1.2,fontWeight:800},sixtyYAxisLabel:{color:"#A1A1A1",position:"absolute",right:2,top:65,fontSize:10,letterSpacing:2,lineHeight:1.2,fontWeight:800},thirtyYAxisLabel:{color:"#A1A1A1",position:"absolute",right:2,top:108,fontSize:10,letterSpacing:2,lineHeight:1.2,fontWeight:800},interventionPill:{position:"absolute",bottom:10,padding:"2px 6px",borderRadius:"10px",background:"#ECEFF1",color:"rgba(0, 0, 0, 0.38)",fontSize:12}});t.default=g},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(174);t.default=function(e){var t=e.additionalOptions,n={labels:e.labels,datasets:[{label:e.title,fill:!1,data:e.data,type:"line",borderColor:e.color,borderWidth:2,pointRadius:3,pointHoverRadius:3,pointBorderColor:e.pointsColor,pointBorderWidth:2,pointBackgroundColor:e.pointsColor,lineTension:.1}]},o=a({legend:{display:!1},layout:{padding:{top:0,bottom:0,right:40,left:0}},scales:{yAxes:[{gridLines:{display:!1,drawBorder:!1,zeroLineColor:"transparent",borderDash:[1,2],borderDashOffset:0},ticks:{display:!1,min:0,max:105,stepSize:30}}],xAxes:[{gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1}}]},maintainAspectRatio:!1,animation:!1,plugins:{datalabels:{display:!1}}},t);return s.createElement(i.Line,{options:o,data:n})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(10),d=n(505),c=n(60),u=n(133),p=n(13),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={interventionData:[],expandedRows:[]},t.onRowClick=function(e){var n=t.state.expandedRows,a=e-1,s=-1!==n.indexOf(a);t.setState({expandedRows:s?n.filter((function(e){return e!==a})):n.concat(a)})},t.onAssignSuccess=function(e){var n=u.updateInterventionStatus(i(t.state.interventionData),e);t.setState({interventionData:n})},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.classId,a=t.studentUserId;l.GetStudentDataIntervention({classId:n,studentUserId:a},(function(t){e.setState({interventionData:t})}))},t.prototype.render=function(){return this.state.interventionData.length>0?o.createElement(g,{interventionData:this.state.interventionData,onAssignSuccess:this.onAssignSuccess,expandedRows:this.state.expandedRows,onRowClick:this.onRowClick}):o.createElement("div",{className:"ctaInfo"},"No interventions!")},t}(r.Component),g=function(e){var t=e.interventionData,n=e.expandedRows,a=e.onRowClick,s=e.onAssignSuccess,i=t.map((function(e,t){return m(e,-1!==n.indexOf(t),s)}));return o.createElement(c.VTable,{header:f(),body:i,fixedRowCount:1,fixedColumnCount:0,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:-1,customClassNames:["mathInterventionTable"],onRowClick:a})},f=function(){return{height:60,cells:[{content:"Assignment",maxWidth:400,width:400},{content:"Recommended Interventions",width:250},{content:"Assigned Interventions",width:250}]}},m=function(e,t,n){var a=e.assignmentId,s=e.code,i=e.name,r=e.interventions,l=r.filter((function(e){return e.status===u.InterventionStatus.Recommended})),c=r.filter((function(e){return e.status===u.InterventionStatus.Assigned})),p=l.length||c.length,h=C(),g=Math.max(l.length,c.length),f=l.length>0?60:0;return{height:t?78*g+f+70:70,cells:[{classes:{firstColumn:!0,isExpanded:t,interventionsExist:p},content:o.createElement(v,{name:i,code:s}),sortValue:i},{classes:{isExpanded:t,interventionsExist:p},content:o.createElement(o.Fragment,null,o.createElement("div",{className:h.number},l.length),o.createElement(d.default,{interventions:l,assignmentId:a,onAssignSuccess:n})),sortValue:l.length},{classes:{isExpanded:t,interventionsExist:p},content:o.createElement(o.Fragment,null,o.createElement("div",{className:h.number},c.length),o.createElement(d.default,{interventions:c})),sortValue:c.length}]}},v=function(e){var t=e.name,n=e.code,a=b();return o.createElement("div",{className:a.standardName},n," - ",t)},b=p.makeStyles({standardContainer:{marginTop:10},standardTitle:{display:"flex",justifyContent:"space-between"},standardCode:{fontFamily:"Avenir Next LT W02 Demi",color:"#546E7A"},standardName:{fontFamily:"AvenirNextLTW02-Medium",height:70,display:"flex",fontSize:16,alignItems:"center",justifyContent:"left",color:"rgba(38, 50, 57, 1.00)",letterSpacing:.5,lineHeight:1.2,fontWeight:400,paddingLeft:10}}),C=p.makeStyles({number:{height:70,fontSize:28,display:"flex",alignItems:"center",justifyContent:"center"}});t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(1628),i=n(1631),o=n(20);t.default=Backbone.View.extend({el:"div.teacherClasses .scroll",initialize:function(e){this.subheader=e.subheader,Backbone.pubEv.on("rerenderClassData",this.render,this),Backbone.pubEv.on("updateSubTab",this.updateSubTab,this)},render:function(e,t){this.subtab=t||this.subtab,this.rawData={classId:e,subtab:this.subtab},this.$el.html('<div id="classdata" />'),this.renderClassDataScroll(e)},renderClassDataScroll:function(){var e=this.$el.find("#classdata"),t=o.default.isMath?i.default:s.default;a.mountReactComponent(t,e[0],this.rawData)},currentSubtabInURL:function(){return window.location.hash.split("/")[4]},updateSubTab:function(e){this.subtab=e},destroy:function(){this.$el.parent().removeClass("classdata"),this.undelegateEvents(),Backbone.pubEv.off("studentDataUserSelected"),Backbone.pubEv.off("rerenderClassData"),Backbone.pubEv.off("updateSubTab")}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(8),l=n(10),d=n(1629),c=n(1630),u=n(71),p=n(69),h=n(37),g=n(5),f=[{id:"proficiency",displayName:"Proficiency"},{id:"vocabulary",displayName:"Vocabulary"}],m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.switchReport=function(e){if(a.state.subtab!==e)switch(a.toggleSubHeaderActionButtons(e),h.addToNavigationHistory("#teacher/classes/"+a.props.classId+"/classdata/"+(e||"proficiency")),Backbone.pubEv.trigger("updateSubTab",e),e){case"vocabulary":a.renderVocabularyTab();break;case"proficiency":default:a.renderProficiencyTab()}},a.toggleSubHeaderActionButtons=function(e){Backbone.pubEv.trigger("UpdateClassDataSubheaderButtons",{subtab:e})},a.renderProficiencyTab=function(){var e=a.props.classId,t=sCH.classesC.getModelByClassId(e).get("Students").length>0;sCH.userM.isOnFreePlan()?(g.disableFocusNClick(".btnClassDataPrint"),a.setState({subtab:"proficiency",el:i.createElement(u.default,{className:"trialSplash",view:p.default,options:{text:"Pinpoint where each student in this class is struggling by viewing proficiency by standard, DoK level or content area.",screenshotUrl:["/img/Classes_Class Data.png","/img/Classes_Class Data_2.png"],showSampleBanner:!0}})})):l.GetClassProficiency({classId:e},(function(n){g.toggleFocusNClick(".btnClassDataPrint, .btnSorting",0===n.GradeData.length&&0===n.Standards.length),a.setState({subtab:"proficiency",el:t?i.createElement(d.default,{proficiencyData:n,classId:e}):i.createElement(v,null)})}))},a.renderVocabularyTab=function(){var e=a.props.classId,t=sCH.classesC.getModelByClassId(e).get("Students").length>0;sCH.userM.isOnFreePlan()?(g.disableFocusNClick(".btnClassDataPrint, .btnSorting"),a.setState({subtab:"vocabulary",el:i.createElement(u.default,{className:"trialSplash",view:p.default,options:{text:"Help students in this class build vocabulary by seeing which words they looked up.",screenshotUrl:"/img/PRO_placeholder_VC_Vocab2.png"}})})):l.GetClassVocabularyLookups({classId:a.props.classId},(function(n){g.toggleFocusNClick(".btnClassDataPrint, .btnSorting",0===n.length),a.setState({subtab:"vocabulary",el:t?i.createElement(c.default,{vocabularyData:n,classId:e}):i.createElement(v,null)})}))},a.state={el:null,subtab:null},a}return s(t,e),t.prototype.componentDidMount=function(){this.switchReport(this.props.subtab||"proficiency")},t.prototype.render=function(){var e=this,t=0===sCH.classesC.getModelByClassId(this.props.classId).get("Students").length,n=g.classNames({pageTabsContainer:!0,disableTabs:t});return i.createElement("div",null,i.createElement("div",{role:"tablist","aria-label":"Class data tabs",className:n},r.map(f,(function(n){return i.createElement("a",{href:"javascript:void(0)",role:"tab",key:n.id,tabIndex:t?-1:null,onClick:function(){return e.switchReport(n.id)},className:"btn-box toggler btnSwitchReportType "+(e.state.subtab===n.id?"selected":"")},n.displayName)}))),i.createElement("div",{className:"dataWrapper"},this.state.el))},t}(o.Component);t.default=m;var v=function(){return i.createElement("div",{className:"ctaInfo"},alcfg.infoText.data.noStudentsInClass)}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(5),l=n(54),d=n(8),c=n(491),u=n(790),p=n(153),h=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.renderDateFilter=function(){l.initDateRangePicker(moment(a.state.startDate),moment(a.state.endDate),(function(e,t){a.renderData({startDate:e.toISOString(),endDate:t.toISOString()},null)}),"class")},a.renderData=function(e,t){var n=(a.props.proficiencyData?a.props.proficiencyData.GradeData:[]).filter((function(t){return moment.utc(t.AnswerDate).isAfter(e.startDate)&&moment.utc(t.AnswerDate).isBefore(e.endDate)})),s=a.getStandardsData(n),i=s.filteredDataStandards,o=s.standardsFilters,r=s.standardsTitleHash,l=n.map((function(e){var t={};return t.grade=e.Grade,t.date=e.AnswerDate,t.groupBy=e.Dok,t})),d=n.map((function(e){var t={};return t.grade=e.Grade,t.date=e.AnswerDate,t.groupBy=e.SkillBucketId,t}));a.setState({filteredDataContent:d,filteredDataDok:l,filteredDataStandards:i,standardsFilters:o,standardsTitleHash:r})},a.createStandardsObject=function(e,t,n){var a=null;return t&&(a=l.getStandardFilterBy(r.getStandardByCode(t,n))),{grade:e.Grade,date:e.AnswerDate,filterBy:a,groupBy:t}},a.getStandardsData=function(e){var t=a,n=[],s=[],i=[];e.forEach((function(e){var s=t.createStandardsObject(e,e.StandardCode,a.props.proficiencyData.Standards);s.filterBy&&-1===i.indexOf(s.filterBy)&&i.push(s.filterBy),n.push(s),e.SecondStandardCode&&((s=t.createStandardsObject(e,e.SecondStandardCode,a.props.proficiencyData.Standards)).filterBy&&-1===$.inArray(s.filterBy,i)&&i.push(s.filterBy),n.push(s))})),d.uniq(a.props.proficiencyData.Standards.map((function(e){return e.Title}))).sort().forEach((function(e){e&&a.props.proficiencyData.Standards.filter((function(t){return t.Title===e})).forEach((function(e){s.push({id:e.StandardCode,text:e.ShortText,filterBy:l.getStandardFilterBy(e)})}))}));var o=[];return i.length>2&&(i=i.sort(),o.push({value:-1,text:"All"}),i.forEach((function(e){o.push({value:e,text:e})}))),{filteredDataStandards:n,standardsFilters:o,standardsTitleHash:s}};var s=l.getSchoolYearRangeOrDefault("class");return a.state={startDate:s.start.toISOString(),endDate:s.end.toISOString(),proficiencyData:[],filteredDataContent:[],filteredDataDok:[],filteredDataStandards:[],standardsFilters:null,standardsTitleHash:[]},a}return s(t,e),t.prototype.componentDidMount=function(){this.renderDateFilter(),this.renderData({startDate:this.state.startDate,endDate:this.state.endDate},null)},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype.render=function(){var e=u.getClassGradeNameMap(this.props.classId),t=e.proficient,n=e.advanced,a=e.basic,s=e.incomplete,o=e.label;return i.createElement("div",{className:"classProficiencyData proficiency"},i.createElement("div",{className:"reportrange pull-right"},i.createElement("span",null),i.createElement("b",{className:"caret"})),i.createElement("section",{className:"standardsData"},i.createElement("h2",null,"Proficiency By Standard",i.createElement(p.default,{buttonClass:"icon-question-mark-inverse",placement:"right"},"See which skills require more work. The bars show the number of ",t," or ",n," answers versus the number of ",a,", ",s," or ",o," answers. If the trend is changing in the past 30 days, you will see that to the right of the bar.")),i.createElement("div",{className:"byStandardBarGraph"},i.createElement(c.default,{filters:this.state.standardsFilters,classId:this.props.classId,noDataText:"No data yet for this class and date range.",data:this.state.filteredDataStandards,titleHash:this.state.standardsTitleHash}))),i.createElement("section",{className:"dokData"},i.createElement("h2",null,"Proficiency By DoK Level",i.createElement(p.default,{buttonClass:"icon-question-mark-inverse",placement:"right"},"See which DoK levels require more work. The bars show the number of ",t," or ",n," answers versus the number of ",a,", ",s," or ",o," answers. If the trend is changing in the past 30 days, you will see that to the right of the bar.")),i.createElement("div",{className:"byDokBarGraph"},i.createElement(c.default,{classId:this.props.classId,noDataText:"No data yet for this class and date range.",data:this.state.filteredDataDok,titleHash:alcfg.tags.question.dok}))),i.createElement("section",{className:"contentData"},i.createElement("h2",null,"Proficiency By Content",i.createElement(p.default,{buttonClass:"icon-question-mark-inverse",placement:"right"},"See which content areas require more work. The bars show the number of ",t," or ",n," answers versus the number of ",a,", ",s," or ",o," answers. If the trend is changing in the past 30 days, you will see that to the right of the bar.")),i.createElement("div",{className:"byContentBarGraph"},i.createElement(c.default,{classId:this.props.classId,noDataText:"No data yet for this class and date range.",data:this.state.filteredDataContent,titleHash:[{id:1,text:"Literature"},{id:2,text:"Informational"},{id:3,text:"Science"},{id:5,text:"Other"}]}))))},t}(o.Component);t.default=h},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(5),d=n(54),c=n(8),u=n(153),p=n(65),h=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.sort=function(){$(".sortDropdown ul a").on("click",(function(e){$(".sortDropdown a").removeClass("selected");var t=$(e.currentTarget);t.addClass("selected");var n="recency"===t.data("sort")?"MaxCreateDate":"LookupCount";a.getVocabData({startDate:a.state.startDate,endDate:a.state.endDate},n)}))},a.renderDateFilter=function(){d.initDateRangePicker(moment(a.state.startDate),moment(a.state.endDate),(function(e,t){a.getVocabData({startDate:e.toISOString(),endDate:t.toISOString()},null)}),"class")},a.getVocabData=function(e,t){var n,s=c.filter(a.props.vocabularyData,(function(t){return moment.utc(t.MaxCreateDate).isAfter(e.startDate)&&moment.utc(t.MaxCreateDate).isBefore(e.endDate)})),o=[];if(t||(t="recency"===$(".sortDropdown li a.selected").data("sort")?"MaxCreateDate":"LookupCount"),s.length){if(s=c.sortBy(s,"Word"),c.each(s,(function(e){n&&n.Word===e.Word?n.LookupCount+=e.LookupCount:(n=e,o.push(e))})),(o=c.sortBy(o,t).reverse()).length>0){var r=c.maxBy(o,(function(e){return e.LookupCount})).LookupCount;c.each(o,(function(e){e.FontSize=l.lookupCountToFontSize(e.LookupCount,r)}))}a.setState(i({vocabularyData:o},e))}else a.setState(i({vocabularyData:[]},e))};var s=d.getSchoolYearRangeOrDefault("class");return a.state={startDate:s.start.toISOString(),endDate:s.end.toISOString(),vocabularyData:[]},a}return s(t,e),t.prototype.componentDidMount=function(){this.renderDateFilter(),this.getVocabData({startDate:this.state.startDate,endDate:this.state.endDate},null),this.sort()},t.prototype.componentWillUnmount=function(){$(".daterangepicker").remove()},t.prototype.componentDidUpdate=function(){this.sort()},t.prototype.render=function(){return o.createElement("div",{className:"classVocabularyData vocabulary"},o.createElement("div",{className:"reportrange pull-right"},o.createElement("span",null),o.createElement("b",{className:"caret"})),this.state.vocabularyData.length?o.createElement("div",{className:"container"},o.createElement("h2",null,"Words Defined While Reading",o.createElement(u.default,{buttonClass:"icon-question-mark-inverse",placement:"right"},"See which words your students have looked up while reading. Sort by recency or frequency.")),o.createElement("div",{id:"vocabWordsContainer",className:"dataContainer"},this.state.vocabularyData.map((function(e,t){return o.createElement(g,{data:e,key:e.Word+t})})))):o.createElement("div",{className:"ctaInfo"},alcfg.infoText.classes.noVocabulary))},t}(r.Component);t.default=h;var g=function(e){var t=e.data;return o.createElement("div",{className:"cell",style:{fontSize:t.FontSize}},o.createElement(p.default,{title:t.UserList.join(", ")},o.createElement("span",null,o.createElement("span",{className:"word"},l.sanitize(t.Word)),o.createElement("span",{className:"num"},t.LookupCount))))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(0),r=n(1632),l=n(1634),d=n(1635),c=n(37),u=n(280),p=n(234),h=n(10),g=n(133),f=n(65),m=[{id:"mastery",displayName:"Mastery Progress"},{id:"intervention",displayName:"Interventions"}],v=[{id:"interventionByStudent"},{id:"interventionByAssignment"}],b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={el:null,selectedTab:m[0],selectedInterventionView:null,assignments:[],selectedAssignment:null},t.switchReport=function(e){t.state.selectedTab.id!==e&&(t.toggleSubHeaderActionButtons(e),Backbone.pubEv.trigger("updateSubTab",e),e===m[1].id?t.setState({selectedTab:m[1],selectedInterventionView:v[0]}):t.setState({selectedTab:m[0],selectedInterventionView:null}))},t.renderMastery=function(){var e=t.props.classId;return c.addToNavigationHistory("#teacher/classes/"+e+"/classdata/mastery"),i.createElement(r.default,{classId:e})},t.renderInterventionByStudent=function(){var e=t.props.classId,n=t.state,a=n.selectedAssignment,s=n.assignments,o=a?a.value:(s[0]||{}).assignmentId;return c.addToNavigationHistory("#teacher/classes/"+e+"/classdata/intervention"),i.createElement(l.default,{classId:e,assignmentId:o})},t.renderInterventionByAssignment=function(){var e=t.props.classId;return c.addToNavigationHistory("#teacher/classes/"+e+"/classdata/intervention"),i.createElement(d.default,{classId:e})},t.switchInterventionView=function(){t.state.selectedInterventionView&&t.state.selectedInterventionView.id===v[1].id?t.setState({selectedTab:m[1],selectedInterventionView:v[0]}):t.setState({selectedTab:m[1],selectedInterventionView:v[1]})},t.toggleSubHeaderActionButtons=function(e){Backbone.pubEv.trigger("UpdateClassDataSubheaderButtons",{subtab:e})},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;h.GetAssignmentsWithInterventions({classId:this.props.classId},(function(t){e.setState({assignments:t})}))},t.prototype.render=function(){var e=this,t=this.state.assignments.map((function(e){return{value:e.assignmentId,label:e.name+" ("+e.code+")"}})),n=this.state,a=n.selectedInterventionView,s=n.selectedTab;return i.createElement(i.Fragment,null,i.createElement("div",{className:"mathClassDataHeader"},i.createElement(u.TabList,{tabsArray:m,selectedTab:s,onTabChange:this.switchReport}),"intervention"===s.id&&i.createElement("div",{className:"mathDataActions"},i.createElement(f.default,{title:"interventionByStudent"===a.id?"View by assignments":"View by students"},i.createElement("button",{className:"flipRow",onClick:this.switchInterventionView})),a&&"interventionByStudent"===a.id&&i.createElement(p.default,{value:this.state.selectedAssignment||t[0],suggestions:t,onChange:function(t){return e.setState({selectedAssignment:t},e.renderInterventionByStudent)},inputId:"select-assignment",customSelectStyles:g.classDataInterventionAssignmentDropdownStyles}))),s.id===m[0].id?this.renderMastery():a&&"interventionByStudent"===a.id?this.renderInterventionByStudent():this.renderInterventionByAssignment())},t}(o.Component);t.default=b},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(0),d=n(60),c=n(1633),u=n(65),p=n(10),h=n(133),g=n(8),f=n(5),m=n(13),v=n(786),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={masteryData:[]},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;p.GetClassDataMastery({classId:this.props.classId},(function(t){f.toggleFocusNClick(".btnExportMastery",0===t.length),e.setState({masteryData:t})}))},t.prototype.render=function(){var e=this.state.masteryData,t=this.props.classId,n=A(e),a=N(e),s=sCH.classesC.findWhere({ClassId:t}).get("Name"),o=H({assignments:a,masteryData:e,students:n}),l=v.exportTableForm(o,"Mastery_"+s);return r.createElement(r.Fragment,null,l,r.createElement(C,i({},{masteryData:e,assignments:a,students:n,classId:t})))},t}(l.Component),C=function(e){var t=e.masteryData,n=e.assignments,a=e.students,s=e.classId;return n.length?r.createElement(r.Fragment,null,r.createElement(k,null),r.createElement(d.VTable,{header:y(n),body:_(t,n,a,s),fixedRowCount:2,fixedColumnCount:1,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:-1,customClassNames:["masteryClassDataTable"]})):r.createElement("div",{className:"ctaInfo"},"No data!")},y=function(e){var t=e.map((function(e){return{content:r.createElement(I,{assignment:e}),width:220}}));return{height:90,cells:o([{content:"Student",width:220}],t)}},_=function(e,t,n,a){var s=w({assignments:t,data:e}),i=n.map((function(n){var s=e.filter((function(e){return e.userId===n.userId}));return S({masteryData:s,student:n,assignments:t,classId:a})}));return o([s],i)},S=function(e){var t=e.masteryData,n=e.student,a=e.assignments,s=e.classId,i={content:r.createElement(x,{student:n,classId:s}),sortValue:n.lastName+", "+n.firstName,classes:{studentName:!0}},l=a.map((function(e){var n=t.find((function(t){return t.assignmentId===e.assignmentId&&!!t.isAssigned}));return{content:n?r.createElement(T,{mastery:n.mastery,numProblemsCompleted:n.numProblemsCompleted}):"",sortValue:n?n.numProblemsCompleted<=2?0:n.mastery:void 0,classes:{center:!0,masteryBlock:!0}}}));return{height:60,cells:o([i],l)}},w=function(e){var t=e.assignments,n=e.data,a=t.map((function(e){var t={data:E(n,e.assignmentId),labels:["Insufficient Data"].concat(Object.values(h.MasteryLabel)),colors:["#E8E8E8"].concat(Object.values(h.MasteryColor)),tooltips:{enabled:!0,bodyFontFamily:"Avenir Next LT W02 Demi",xPadding:10,yPadding:10,bodyFontSize:14,cornerRadius:0,displayColors:!1,callbacks:{label:function(e,t){return t.labels[e.index]+": "+t.datasets[0].data[e.index]+"%"}}}};return{content:t.data?r.createElement(c.default,i({},t)):"-",classes:{center:!0}}}));return{height:200,cells:o([{content:"All Class",classes:{studentName:!0}}],a)}},T=function(e){var t=e.mastery,n=e.numProblemsCompleted,a=M(),s=h.percent(t,1),i=n>2?h.getMasteryColor(s):"#F2F2F2",o=n>2&&null!==t,l=(o?"Mastery % ":"")+"(# problems solved)";return r.createElement(u.default,{title:l,tooltipPlacement:"bottom"},r.createElement("div",{className:a.masteryBlock,style:{backgroundColor:i}},o&&r.createElement("span",null,s,"% "),r.createElement("span",null,"(",n,")")))},I=function(e){var t=e.assignment,n=r.createElement("span",null,r.createElement("span",{className:"headerName"},t.name),r.createElement("span",{className:"labels"},t.code));return t.name.length>30?r.createElement(u.default,{title:t.name,tooltipPlacement:"bottom"},n):n},x=function(e){var t=e.student,n="#teacher/classes/"+e.classId+"/studentdata/assignments/?studentuserid="+t.userId;return r.createElement("a",{href:n},t.lastName,", ",t.firstName)},k=function(){var e=M();return r.createElement("div",{className:"key "+e.legend},Object.keys(h.MasteryColor).map((function(e){return r.createElement("div",{className:e,key:e},r.createElement("span",{className:"circle",style:{backgroundColor:h.MasteryColor[e]}}),h.MasteryLabel[e])})))},E=function(e,t){var n=e.filter((function(e){return e.assignmentId===t&&!!e.isAssigned}));return h.getStudentPercentInEachMasteryRange(n)},N=function(e){return g.uniqBy(e,"assignmentId").sort((function(e,t){return+new Date(t.createDate)-+new Date(e.createDate)}))},A=function(e){return g.uniqBy(e,"userId")},M=m.makeStyles({masteryBlock:{fontFamily:"Avenir Next LT W02 Bold",fontSize:16,color:"#000",lineHeight:"60px"},legend:{marginBottom:10,maxWidth:"100%",paddingRight:15}});t.default=b;var H=function(e){var t=e.assignments,n=e.masteryData,a=e.students,s=[];return s[0]=["Student"],t&&t.length&&(t.forEach((function(e){return s[0].push(e.code+" - "+e.name)})),a.forEach((function(e,a){var i=a+1;s[i]=t.map((function(t){var a=n.find((function(n){return n.userId===e.userId&&n.standardId===t.standardId}));return a?a.mastery?h.percent(a.mastery,1):"":null})),s[i].unshift(e.lastName+", "+e.firstName)}))),s.map((function(e){return e.map((function(e){return f.replaceQuoteInCSVData(e)})).join(",")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(174);t.default=function(e){var t={labels:e.labels,datasets:[{data:e.data,borderColor:"transparent",hoverBorderColor:"transparent",backgroundColor:e.colors,hoverBackgroundColor:e.colors}]},n={tooltips:e.tooltips,legend:{display:!1},maintainAspectRatio:!1,animation:!1,plugins:{datalabels:{display:!1}}};return a.createElement(s.Pie,{options:n,data:t})}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(10),d=n(505),c=n(60),u=n(133),p=n(13),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={interventionData:[],expandedRows:[]},t.fetchData=function(){var e=t.props,n=e.classId,a=e.assignmentId;a&&l.GetClassDataInterventionByStudent({classId:n,assignmentId:a},(function(e){t.setState({interventionData:e})}))},t.onRowClick=function(e){var n=t.state.expandedRows,a=e-1,s=-1!==n.indexOf(a);t.setState({expandedRows:s?n.filter((function(e){return e!==a})):n.concat(a)})},t.onAssignSuccess=function(e){var n=u.updateInterventionStatus(i(t.state.interventionData),e);t.setState({interventionData:n})},t}return s(t,e),t.prototype.componentDidMount=function(){this.fetchData()},t.prototype.componentDidUpdate=function(e){e.assignmentId!==this.props.assignmentId&&this.fetchData()},t.prototype.render=function(){return this.state.interventionData.length>0?o.createElement(g,{interventionData:this.state.interventionData,onAssignSuccess:this.onAssignSuccess,expandedRows:this.state.expandedRows,onRowClick:this.onRowClick}):o.createElement("div",{className:"ctaInfo"},"No interventions!")},t}(r.Component),g=function(e){var t=e.interventionData,n=e.expandedRows,a=e.onRowClick,s=e.onAssignSuccess,i=t.map((function(e,t){return m(e,-1!==n.indexOf(t),s)}));return o.createElement(c.VTable,{header:f(),body:i,fixedRowCount:1,fixedColumnCount:0,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:-1,customClassNames:["mathInterventionTable"],onRowClick:a})},f=function(){return{height:50,cells:[{content:"Student",maxWidth:400,width:400},{content:"Recommended Interventions",width:250},{content:"Assigned Interventions",width:250}]}},m=function(e,t,n){var a=e.firstName,s=e.lastName,i=e.interventions,r=i.filter((function(e){return e.status===u.InterventionStatus.Recommended})),l=i.filter((function(e){return e.status===u.InterventionStatus.Assigned})),c=r.length||l.length,p=Math.max(r.length,l.length),h=r.length>0?40:0;return{height:t?93*p+h+70:70,cells:[{classes:{firstColumn:!0,isExpanded:t,interventionsExist:c},content:o.createElement(v,{firstName:a,lastName:s}),sortValue:name},{classes:{isExpanded:t,interventionsExist:c},content:o.createElement(o.Fragment,null,o.createElement(C,{count:r.length}),o.createElement(d.default,{interventions:r,status:u.InterventionStatus.Recommended,onAssignSuccess:n})),sortValue:r.length},{classes:{isExpanded:t,interventionsExist:c},content:o.createElement(o.Fragment,null,o.createElement(C,{count:l.length}),o.createElement(d.default,{interventions:l,status:u.InterventionStatus.Assigned})),sortValue:l.length}]}},v=function(e){var t=e.firstName,n=e.lastName,a=b();return o.createElement("span",{className:a.studentName},n,", ",t)},b=p.makeStyles({studentName:{fontSize:16,lineHeight:"70px"}}),C=function(e){var t=e.count,n=y();return o.createElement("div",{className:n.number},t)},y=p.makeStyles({number:{height:70,fontSize:28,display:"flex",alignItems:"center",justifyContent:"center"}});t.default=h},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(0),l=n(10),d=n(505),c=n(60),u=n(133),p=n(13),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={interventionData:[],expandedRows:[]},t.fetchData=function(){var e=t.props.classId;l.GetClassDataInterventionByAssignment({classId:e},(function(e){t.setState({interventionData:e})}))},t.onRowClick=function(e){var n=t.state.expandedRows,a=e-1,s=-1!==n.indexOf(a);t.setState({expandedRows:s?n.filter((function(e){return e!==a})):n.concat(a)})},t.onAssignSuccess=function(e){var n=u.updateInterventionStatus(i(t.state.interventionData),e);t.setState({interventionData:n})},t}return s(t,e),t.prototype.componentDidMount=function(){this.fetchData()},t.prototype.render=function(){return this.state.interventionData.length>0?o.createElement(g,{interventionData:this.state.interventionData,onAssignSuccess:this.onAssignSuccess,expandedRows:this.state.expandedRows,onRowClick:this.onRowClick}):o.createElement("div",{className:"ctaInfo"},"No interventions!")},t}(r.Component),g=function(e){var t=e.interventionData,n=e.expandedRows,a=e.onRowClick,s=e.onAssignSuccess,i=t.map((function(e,t){return m(e,-1!==n.indexOf(t),s)}));return o.createElement(c.VTable,{header:f(),body:i,fixedRowCount:1,fixedColumnCount:0,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:-1,customClassNames:["mathInterventionTable"],onRowClick:a})},f=function(){return{height:50,cells:[{content:"Assignment",maxWidth:400,width:400},{content:"Recommended Interventions",width:250},{content:"Assigned Interventions",width:250}]}},m=function(e,t,n){var a=e.name,s=e.code,i=e.interventions,r=i.filter((function(e){return e.status===u.InterventionStatus.Recommended})),l=i.filter((function(e){return e.status===u.InterventionStatus.Assigned})),c=r.length||l.length,p=Math.max(r.length,l.length),h=r.length>0?40:0;return{height:t?93*p+h+70:70,cells:[{classes:{firstColumn:!0,isExpanded:t,interventionsExist:c},content:o.createElement(v,{name:a,code:s}),sortValue:a},{classes:{isExpanded:t,interventionsExist:c},content:o.createElement(o.Fragment,null,o.createElement(C,{count:r.length}),o.createElement(d.default,{byAssignment:!0,interventions:r,status:u.InterventionStatus.Recommended,onAssignSuccess:n})),sortValue:r.length},{classes:{isExpanded:t,interventionsExist:c},content:o.createElement(o.Fragment,null,o.createElement(C,{count:l.length}),o.createElement(d.default,{byAssignment:!0,interventions:l,status:u.InterventionStatus.Assigned})),sortValue:l.length}]}},v=function(e){var t=e.name,n=e.code,a=b();return o.createElement("div",{className:a.standardContainer},o.createElement("span",{className:a.standardCode},n),o.createElement("span",{className:a.standardName},t))},b=p.makeStyles({standardContainer:{marginTop:8},standardCode:{fontFamily:"Avenir Next LT W02 Demi",color:"#A1A1A1",letterSpacing:.4,display:"block"},standardName:{fontFamily:"Avenir Next LT W02 Demi",fontSize:16}}),C=function(e){var t=e.count,n=y();return o.createElement("div",{className:n.number},t)},y=p.makeStyles({number:{height:70,fontSize:28,display:"flex",alignItems:"center",justifyContent:"center"}});t.default=h},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(8),r=n(5),l=n(10),d=n(754),c=n(72),u=n(65),p=n(60),h=n(48),g=n(1637),f=n(1638),m=n(1639),v=n(1640),b=n(14),C=n(24),y=n(20),_=50,S=70,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.classM=sCH.classesC.getModelByClassId(t.props.classId),t.state={code:t.classM.get("Code"),isOnFreeOrPersonalPlan:sCH.userM.isOnFreeOrPersonalPlan(),source:t.classM.get("Source"),classType:r.getUserOrClassType(t.classM),isOwnerTeacher:t.classM.get("TeacherUserId")===sCH.userM.get("UserId"),existingGroups:t.classM.get("SmallGroups")&&t.classM.get("SmallGroups").length>0,showInviteStudentCode:!sCH.userM.isNonALDemoUser()},t.initStudents=function(){var e=t.removeUnknownGoogleClassroomStudents();t.classM.get("Source")!==b.ClassSource.GOOGLE&&($(".btnInviteStudents").show(),r.toggleFocusNClick(".btnRemoveStudents",0===t.props.students.length),r.toggleFocusNClick(".btnMergeStudentAccounts",e.length<2)),t.setState({students:e})},t.removeUnknownGoogleClassroomStudents=function(){var e=t.props.students;return t.classM.get("Source")===b.ClassSource.GOOGLE&&e.set(t.props.students.filter((function(e){return"Unknown"!==e.get("UserName")}))),e},t.showFreeTExtraHelpPopup=function(){h.showBuyTeacherPopup({title:"Extra help for struggling students",content:alcfg.confirmsText.freeTExtraHelpNotes})},t.editName=function(e){var n=parseInt(e.target.getAttribute("data-userid")),a=t.props.students,s=a.find({UserId:n});C.showModal(i.createElement(g.default,{studentM:s,classId:t.props.classId,updateStudentList:function(){t.setState({students:a}),C.hideModals()}}))},t.resetPassword=function(e){var n=parseInt(e.target.getAttribute("data-userid")),a=t.props.students.find({UserId:n});C.showModal(i.createElement(f.default,{studentM:a}))},t.removeStudent=function(e){var n=parseInt(e.target.getAttribute("data-userid")),a=t.props.students.find({UserId:n});C.showModal(i.createElement(m.default,{studentM:a,classId:t.props.classId}))},t.switchClass=function(e){var n=parseInt(e.target.getAttribute("data-userid")),a=t.props.students.find({UserId:n});C.showModal(i.createElement(v.default,{studentM:a,sourceClassId:t.props.classId,updateStudentList:function(){return a.destroy()}}))},t.showHowToUseExtraHelp=function(){sCH.userM.showPopup("HowToUseExtraHelp")&&C.showModal(i.createElement(C.default,{title:"How to use Extra Help",cssClass:"modal-al-how-to-use-extra-help",allowCancel:!1,cancelText:"Got it!",okText:null,popupSettingKey:"HowToUseExtraHelp",shouldShowDoNotShowAgainContainer:!0},i.createElement("p",null,'To give these students extra help in questions and notes, be sure to check "Extra help".'),i.createElement("img",{className:"animGif",src:"/img/HowToExtraHelp_Roster.gif"})))},t.getHeader=function(e,t,n){var a=[],s=t===b.ClassSource.NATIVE;return s&&(a=o.uniq(o.flatten(this.props.students.models.map((function(e){return o.map(e.get("Accounts"),(function(e){return e.Source}))}))))),{height:_,cells:[{content:"Student ("+e.length+" "+(e.length>1?"students":"student")+")",width:430},{content:n?"Group":"",width:n?100:0},{content:s&&a.length>1?"Signed up with":"",width:s&&a.length>1?140:0},{content:"Last Sign in",width:150},{content:"Joined Class",width:140},{content:y.default.isMath?"":i.createElement(u.default,{tooltipPlacement:"bottom",title:"Only marked students will see assignment attributes (notes, text summary etc.) designated as extra help"},i.createElement("span",null,"Extra Help",sCH.userM.isOnFreePlan()&&i.createElement("span",{className:"icon-premium-lock"}))),classes:{"sorter-struggling":!0},width:y.default.isMath?0:80},{content:"",notSortable:!0,width:220}]}},t.getBody=function(e,t,n,a){var s=this;return e.models.map((function(e){return e.get("IsPending")?s.getPendingStudentsRow(e,t,a,n):s.getStudentsRow(e,t,n,a)}))},t.getPendingStudentsRow=function(e,t,n,a){var s=a===b.ClassSource.NATIVE,o=this.state.source===b.ClassSource.GOOGLE;return{height:S,cells:[{content:i.createElement(i.Fragment,null,i.createElement("img",{className:"profilepic avatar hideOnPortrait",alt:""}),i.createElement("div",{className:"text"},i.createElement("div",{className:"name"},r.getStudentDisplayName(e.get("FirstName"),e.get("LastName"))),i.createElement("div",{className:"username"},(s||o)&&r.sanitize(e.get("UserName"))))),sortValue:r.getStudentDisplayName(e.get("FirstName"),e.get("LastName")),classes:{"fs-hide":!0,disabled:!0,student:!0}},{content:t&&e.get("Sequence")?"Group "+e.get("Sequence"):"",sortValue:e.get("Sequence"),classes:{"fs-hide":!0,disabled:!0}},{content:""},{content:i.createElement(i.Fragment,null,"Pending log in for",i.createElement("br",null),r.getProductName()," using",i.createElement("br",null),"Google Account"),classes:{disabled:!0}},{content:""},{content:n?i.createElement("button",{className:"disabledExtraHelp",onClick:this.showFreeTExtraHelpPopup}):"",classes:{center:!0,disabled:!0}},{content:""}]}},t.getStudentsRow=function(e,n,a,s){var l=[],p=a===b.ClassSource.NATIVE,h=t.state.source===b.ClassSource.GOOGLE,g={native:"Email / Password",google:"Google",edmodo:"Edmodo",clever:"Clever",office365:"Office 365"}[Object.keys(e.get("Accounts"))[0]],f=e.get("IsDeletedInClassroom");return p&&(l=o.uniq(o.flatten(o.map(t.props.students.models,(function(e){return o.map(e.get("Accounts"),(function(e){return e.Source}))}))))),{height:S,cells:[{content:i.createElement(i.Fragment,null,i.createElement(d.default,{avatar:e.get("ImageUrl")}),i.createElement("div",{className:"text"},i.createElement("div",{className:"name"},r.getStudentDisplayName(e.get("FirstName"),e.get("LastName"))),i.createElement("div",{className:"username"},(p||h)&&r.sanitize(e.get("IsMappedToTeacher")?e.get("UserName").replace("_student",""):e.get("UserName"))))),sortValue:r.getStudentDisplayName(e.get("FirstName"),e.get("LastName")),classes:{"fs-hide":!0,deletedInClassroom:f,student:!0}},{content:n?e.get("GroupName"):"",sortValue:e.get("GroupName"),classes:{"fs-hide":!0,deletedInClassroom:f}},{content:p&&l.length>1?g:"",sortValue:g,classes:{signedUpWith:!0,deletedInClassroom:f}},{content:moment.utc(e.get("LastLoggedIn")).local().format("MM/DD/YY"),sortValue:moment.utc(e.get("LastLoggedIn")),classes:{deletedInClassroom:f}},{content:moment.utc(e.get("ClassJoinDate")).local().format("MM/DD/YY"),sortValue:moment.utc(e.get("ClassJoinDate")),classes:{deletedInClassroom:f}},{content:y.default.isMath?"":s?i.createElement("button",{className:"disabledExtraHelp",onClick:t.showFreeTExtraHelpPopup}):i.createElement(I,{student:e,studentsC:t.props.students,classId:t.props.classId,showHowToUseExtraHelp:t.showHowToUseExtraHelp}),sortValue:e.get("IsStruggling"),classes:{center:!0,deletedInClassroom:f}},{content:i.createElement(i.Fragment,null,i.createElement(u.default,{title:"Student has hidden this class"},i.createElement("a",{className:"icon-info",style:{visibility:e.get("IsHidden")?"visible":"hidden"},href:alcfg.helpArticleLink.hideClasses,target:"_blank"})),i.createElement(c.default,{style:{visibility:e.get("Accounts").native&&!e.get("IsMappedToTeacher")?"visible":"hidden"},buttonTitle:"Reset password",onClick:t.resetPassword,"data-userid":e.get("UserId"),buttonClass:"icon-resetpassword btnResetPassword"}),i.createElement(c.default,{style:{visibility:e.get("Accounts").native?"visible":"hidden"},buttonTitle:"Edit name",buttonClass:"icon-pencil","data-userid":e.get("UserId"),onClick:t.editName}),i.createElement(c.default,{style:{visibility:"native"===a||e.get("IsDeletedInClassroom")?"visible":"hidden"},buttonTitle:"Switch class",onClick:t.switchClass,"data-userid":e.get("UserId"),buttonClass:"icon-moveperson btnSwitchClass"}),i.createElement(c.default,{style:{visibility:"native"===a||e.get("IsMappedToTeacher")||e.get("IsDeletedInClassroom")?"visible":"hidden"},buttonTitle:"Remove student",tooltipPlacement:"left","data-userid":e.get("UserId"),onClick:t.removeStudent,buttonClass:"icon-trash btnRemoveStudent"})),classes:{right:!0,deletedInClassroom:f}}]}},t}return s(t,e),t.prototype.render=function(){var e=this.state,t=e.code,n=e.isOnFreeOrPersonalPlan,a=e.source,s=e.classType,o=e.isOwnerTeacher,l=e.existingGroups,d=e.showInviteStudentCode,c=s===b.ClassSource.NATIVE,u=a===b.ClassSource.GOOGLE,h=this.props.students;return i.createElement("div",{className:"tableViewWrapper"},c&&d&&i.createElement("div",{className:"classCode"},i.createElement("span",{className:"code"},"Class code: ",i.createElement("span",{className:"inner"},t.toLowerCase()))),!c&&u&&i.createElement(T,null,i.createElement("div",{className:"classCode"},i.createElement("span",{className:"code"},"Class code: ",i.createElement("span",{className:"inner"},t.toLowerCase()))),"Your students need to sign up using their school Google accounts to be joined to this class.",o&&i.createElement(i.Fragment,null,i.createElement("br",null),'You can use the class code or press the "Sync" button above to invite students to this class.')),!c&&a===b.ClassSource.CLEVER&&i.createElement(T,null,'The roster below will be automatically populated when your students log in with the "Clever" button.'),h&&(h.length>0?i.createElement(p.VTable,{header:this.getHeader(h,s,l),body:this.getBody(h,l,s,n),fixedRowCount:1,fixedColumnCount:1,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,customClassNames:[u?"googleClassRosterTable":"classRosterTable","tableSection"]}):i.createElement(i.Fragment,null,c&&i.createElement("div",{className:"ctaInfo"},r.htmlDecode(alcfg.infoText.classes.noStudents)),!c&&!!sCH.userM.get("Accounts")[b.ClassSource.EDMODO]&&i.createElement("div",{className:"ctaInfo"},"There are no students in this Edmodo group yet."),!c&&!sCH.userM.get("Accounts")[b.ClassSource.EDMODO]&&i.createElement("div",{className:"ctaInfo"},"No students yet!"))))},t}(i.Component);t.default=w;var T=function(e){return i.createElement("div",{className:"ctaInfo",style:{marginBottom:20}},e.children)},I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isStruggling:t.props.student.get("IsStruggling")},t.handleChange=function(){var e=t.props.student.get("UserId"),n=!t.state.isStruggling,a=t.props.studentsC.filter({UserId:parseInt(e)})[0];t.setState({isStruggling:n}),t.props.student.set("IsStruggling",n),l.MarkStruggling({isStruggling:n,studentUserId:parseInt(e),classId:t.props.classId},(function(e){if(e){var t=a.get("FirstName")+" "+(n?" has been":" is no longer")+" marked as needing extra help in this class.";r.bootstrap.alert({message:t})}}))},t}return s(t,e),t.prototype.componentDidUpdate=function(e){e.student!==this.props.student&&this.setState({isStruggling:this.props.student.get("IsStruggling")})},t.prototype.render=function(){return i.createElement(i.Fragment,null,i.createElement("input",{id:"chkIsStruggling"+this.props.student.get("UserId"),type:"checkbox",className:"chkIsStruggling regular-checkbox",checked:this.state.isStruggling,onChange:this.handleChange,onClick:this.props.showHowToUseExtraHelp}),i.createElement("label",{htmlFor:"chkIsStruggling"+this.props.student.get("UserId")}))},t}(i.Component)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(5),l=n(24),d=n(34),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.firstNameRef=i.createRef(),t.lastNameRef=i.createRef(),t.state={firstName:r.sanitize(t.props.studentM.get("FirstName")),lastName:r.sanitize(t.props.studentM.get("LastName"))},t.handleInputChange=function(e){var n;t.setState(((n={})[e.target.name]=e.target.value,n))},t.validateStudentName=function(){var e=t.props.studentM;return t.state.firstName!==e.get("FirstName")||t.state.lastName!==e.get("LastName")},t.onSubmit=function(){var e=t.props.studentM;o.UpdateStudentName({studentUserId:e.get("UserId"),firstName:t.state.firstName,lastName:t.state.lastName,classId:t.props.classId},(function(n){r.bootstrap.alert({message:"Student name updated."}),e.set("FirstName",t.state.firstName),e.set("LastName",t.state.lastName),e.set("ImageUrl",n.avatar),t.props.updateStudentList()}))},t}return s(t,e),t.prototype.componentDidUpdate=function(e){var t=r.sanitize(this.props.studentM.get("FirstName")),n=r.sanitize(this.props.studentM.get("LastName"));this.props!==e&&this.state.firstName!==t&&this.state.lastName!==n&&this.setState({firstName:t,lastName:n})},t.prototype.render=function(){return i.createElement(l.default,{title:"Edit student name",okText:"Update",okCallback:this.onSubmit,customValidations:[{name:"newStudent",func:this.validateStudentName}]},i.createElement(d.TextValidator,{fullWidth:!0,name:"firstName",id:"firstName",value:this.state.firstName,onChange:this.handleInputChange,validators:{newStudent:"Type new name for student"},label:"First name",required:!0}),i.createElement("br",null),i.createElement(d.TextValidator,{fullWidth:!0,name:"lastName",value:this.state.lastName,onChange:this.handleInputChange,label:"Last name",id:"lastName",required:!0}))},t}(i.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(10),i=n(5),o=n(24);t.default=function(e){var t=e.studentM;return a.createElement(o.default,{title:"Reset Password",okText:"Reset",okCallback:function(){s.ResetStudentPassword(t.get("UserId"),(function(e){e&&i.bootstrap.alert({message:i.sanitize(t.get("FirstName"))+"'s password has been reset to: <b>"+e+"</b>",autoClose:!1}),Backbone.tracking.trackGAEvent("teacher","resetPassword"),o.hideModals()}),(function(e){i.bootstrap.alert({message:e.responseText||"Unable to reset student password. Please contact us if this problem persists.",autoClose:!1,alert:"danger"}),o.hideModals()}))}},a.createElement("p",null,"The temporary password will be ",a.createElement("b",null,"password"),". Please instruct your student to change it in Account Settings."))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(10),i=n(5),o=n(24);t.default=function(e){var t=e.studentM,n=e.classId;return a.createElement(o.default,{title:"Remove student from class?",okCallback:function(){s.RemoveStudent(t.get("UserId"),n,(function(e){if(e){t.destroy(),i.bootstrap.alert({message:"Student removed from class!"}),o.hideModals();var a=(sCH.userM.get("SchoolInfo")||[]).map((function(e){return e.SchoolId})),s=sCH.classesC.getModelByClassId(n);-1===a.indexOf(s.get("SchoolId"))&&i.intercom("trackEvent","removed-students-different-school")}else o.hideModals(),i.bootstrap.alert({message:"Unable to remove student from class. Please contact us if this problem persists.",autoClose:!1,alert:"danger"});Backbone.tracking.trackGAEvent("teacher","removeStudent")}))},okText:"Remove"},a.createElement("p",null,"You will no longer have access to the student's work or reading data.",a.createElement("div",{className:"info"},"Note: The student's ",i.getProductName()," account will remain active.")))}},function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(13).withStyles,d=n(10),c=n(5),u=n(150),p=n(8),h=n(24),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AssignedClassIds=[],t.studentName=t.props.studentM.get("FirstName")+" "+t.props.studentM.get("LastName"),t.state={destClassId:null},t.handleChange=function(e){t.setState({destClassId:parseInt(e.currentTarget.value,10)})},t.confirmSwitchClass=function(){var e=t.state.destClassId;if(e)if(p.includes(t.AssignedClassIds,e)){var n=sCH.classesC.getModelByClassId(t.props.sourceClassId).get("Name");h.showModal(r.createElement(h.default,{title:"Merge student's work?",okText:"Merge",cancelText:"Cancel",okCallback:t.switchClass},alcfg.confirmsText.switchStudentClass.format(t.studentName,n)))}else t.switchClass(!1);else c.bootstrap.alert({message:"Please select the class where student needs to be moved to.",alert:"danger"})},t.switchClass=function(e){var n={sourceClassId:t.props.sourceClassId,destClassId:t.state.destClassId,studentUserId:t.props.studentM.get("UserId")};d.SwitchClass(n,(function(a){if(a.success){var s=sCH.classesC.find({ClassId:n.destClassId}).get("Name"),i=sCH.classesC.find({ClassId:t.props.sourceClassId}).get("Name");t.props.updateStudentList(),c.bootstrap.alert({message:c.sanitize(t.props.studentM.get("FirstName"))+" has been moved from "+i+" to "+s+"."})}else c.bootstrap.alert({message:"Unable to move "+c.sanitize(t.props.studentM.get("FirstName"))+". Please contact us if this problem persists.",autoClose:!1,alert:"danger"});h.hideModals(e?2:1)}))},t}return s(t,e),t.prototype.componentDidMount=function(){return i(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e=this.props.studentM.get("UserId"),t=this,[4,f(e)];case 1:return t.AssignedClassIds=n.sent(),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.props.classes,n=sCH.classesC.getModelByClassId(this.props.sourceClassId).get("Source"),a=sCH.classesC.filter((function(t){return t.get("ClassId")!==e.props.sourceClassId&&t.get("Source")===n}));return r.createElement(h.default,{title:"Switch class",okText:"Switch",okCallback:this.confirmSwitchClass},a.length>0?r.createElement("p",null,"Select the class where ",c.sanitize(this.studentName)," needs to be moved to. All work for assignments that don't exist in the new class will be deleted."):r.createElement("p",null,"The student is present in all your classes. If you want to remove the student from this class use the delete icon."),r.createElement("ul",{className:t.classContainer},a.map((function(n){return r.createElement("li",{key:n.get("ClassId"),className:t.row,value:n.get("ClassId"),onClick:e.handleChange},r.createElement(u.default,{checked:n.get("ClassId")===e.state.destClassId}),r.createElement("div",{className:t.className},n.get("Name")))}))))},t}(r.Component);t.default=l((function(){return{classContainer:{marginTop:10},row:{display:"flex",alignItems:"center",padding:6,width:260,float:"left",position:"relative"},className:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"Avenir Next LT W02 Demi",fontSize:14,display:"inline-block",width:200}}}))(g);var f=function(t){return i(void 0,void 0,void 0,(function(){return o(this,(function(n){return[2,new e((function(e){d.StudentClassMaps({studentUserId:t},(function(t){e(t||[])}))}))]}))}))}}).call(this,n(21))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(71),i=n(1642);t.default=function(e){return a.createElement(a.Fragment,null,a.createElement(s.default,{view:i.default,options:e.viewProps,shouldNotCallRender:!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(1643),r=n(1645),l=n(1647),d=n(1648),c=n(264),u=n(333),p=n(788),h=n(751),g=n(10),f=n(14),m=n(20);t.default=Backbone.View.extend({el:"div.studentClasses",initialize:function(e){if(e.scope=this,this.childViews=[],isNaN(e.classId)){var t=new u.default;if(a.each(sCH.classesC.models,(function(e){e.get("IsHidden")||t.add(e)})),t.length>0)s.redirectUserByHash(s.getClassUrl(t.first().get("ClassId"),"assignments"));else if(sCH.userM.get("LoginSource")===f.UserAccountSource.ACHIEVE3K&&0===sCH.classesC.models.length){Backbone.pubEv.trigger("setSiteSection",""),$(".menuListWrapper ul, .mainMenu button, .helpDropdown").hide();var n=new Backbone.BootstrapModal({title:"No classes",content:"\n            <p>Your teacher has not added your class yet. Once your teacher has, you'll be able to use "+s.getProductName()+".</p>\n            <p><b>Close this browser tab to return to Achieve3000.</b></p>\n          ",cancelText:!1,allowCancel:!1,okText:"Close",cssClass:"modal-class-no-exist"}).open();n.on("shown",(function(){n.$el.find(".modal-footer").hide()}))}else{var i=sCH.userM.get("Accounts").clever?alcfg.infoText.sclasses.noCleverClasses:$("#content").hasClass("mainMenuOpen")?alcfg.infoText.sclasses.noClasses:alcfg.infoText.sclasses.noClassesMenuHidden;Backbone.pubEv.trigger("setSiteSection","No Classes"),this.$el.find(".scroll").html("<div class='ctaInfo'>"+i+"</div>")}}else sCH.classesC.filter({ClassId:e.classId}).length?(this.postInitialize(e),sCH.userM.showPopup("ShowStudentOverview")&&!m.default.isMath&&(this.showInstructionalVideo(),s.updateDoNotShowPopupSetting("ShowStudentOverview"))):new Backbone.BootstrapModal({title:"Class does not exist!",content:"",cancelText:!1,allowCancel:!1,okText:"Close",cssClass:"modal-class-no-exist"}).open((function(){window.location.hash="#student/classes"}))},postInitialize:function(e){var t=this,n=sCH.classesC.filter({ClassId:e.classId})[0];sCH.classesC.on("change",(function(){return t.updateClassName(n)})),this.updateClassName(n),Backbone.pubEv.trigger("setHeaderActions",{actionButtons:{type:"StudentClass",props:{showUnenrollBtn:"native"===s.getUserOrClassType(n)&&!!n.get("AllowStudentsToUnenroll"),classId:e.classId}}}),this.subheader=new o.default(e),this.subheader.render(),this.childViews.push(this.subheader),this.subheader.selectTab(e.classId,e.render,e.subtab)},updateClassName:function(e){Backbone.pubEv.trigger("setSiteSection",e.get("Name")+" ("+e.get("TeacherTitle")+" "+e.get("TeacherLastName")+")")},showInstructionalVideo:function(){new Backbone.BootstrapModal({title:"Welcome to Actively Learn!",content:new c.default({videoUrlData:{url:alcfg.studentVideoUrl,type:"video/mp4"},introText:"This brief video will show you how to use the key features designed to make your reading more engaging."}),cancelText:!1,okText:"Close",cssClass:"modal-lg modal-al-instructional-video",showFooter:!0}).open()},renderAssignments:function(e){this.assignmentsScroll=new r.default({subheader:this.subheader}),this.childViews.push(this.assignmentsScroll),this.subheader.scroll=this.assignmentsScroll,this.assignmentsScroll.preRender(e)},renderGrades:function(e){this.gradesScroll=new l.default,this.childViews.push(this.gradesScroll),this.gradesScroll.render(e)},renderResearch:function(e){this.researchScroll=new d.default({subheader:this.subheader}),this.subheader.scroll=this.researchScroll,this.childViews.push(this.researchScroll),this.researchScroll.preRender(e)},renderMyData:function(e,t){this.renderMyDataScroll(e,t)},renderMyDataScroll:function(e,t){this.$el.find(".scroll").html('<div id="studentdata" />');var n=this.$el.find("#studentdata"),a={studentUserId:sCH.userM.get("UserId"),classId:e,subtab:t};i.mountReactComponent(p.default,n[0],a)},unenrollClass:function(){var e=sCH.classesC.getModelByClassId(this.classId);new Backbone.BootstrapModal({title:"Unenroll from "+e.get("Name"),content:new h.default({classM:e}),allowCancel:!1,okText:"Unenroll",cssClass:"deleteClass"}).open(),Backbone.tracking.trackGAEvent("student","unenrollClass:start")},hideClass:function(){g.ToggleClassHiddenState({classIds:[this.classId],shouldHideClass:!0},(function(){Backbone.router.navigate("student/classes",{trigger:!1}),window.location.reload()}))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(349),o=n(24),r=n(497),l=n(758),d=n(759),c=n(20);t.default=Backbone.View.extend({el:"div.studentClasses .subheader",events:{"click .btnAddOnlineText":"showAddOnlineText","click .btnUploadText":"showUploadText","click .btnAddGoogleDoc":"showAddGoogleDoc","click .btnAddLayerLabel, .btnDeleteLayerLabel, .btnDeleteLayers, .btnMoveResearch, .btnCollaborate, .btnCiteText, .btnEditTextDetails":"startSelectMode","click .btnCancel":"cancelSelectMode","click .btnNext":"next","change .labelFilter":"filterByLabel","click .sortDropdown ul a":"sort"},template:n(1644),initialize:function(e){this.classId=e.classId,this.scope=e.scope,sCH.userM.get("Accounts").google&&"undefined"!=typeof gapi&&d.init(),Backbone.pubEv.on("tilesSelected",this.tilesSelected,this),Backbone.pubEv.on("cancelSelectMode",this.cancelSelectMode,this)},render:function(){var e=sCH.classesC.filter({ClassId:this.classId})[0];this.$el.html(this.template({basePath:s.getClassUrl(this.classId,""),isOnPrimePlan:e.get("IsOnPrimePlan")})),s.initTooltips(this.$el)},filterByLabel:function(e){var t=$(e.currentTarget).val(),n=t&&t.length>0;this.$el.find(".icon-tag").toggleClass("selected",n),this.scroll.filterByLabel(t)},sort:function(e){var t=$(e.currentTarget);$(".sortDropdown a").removeClass("selected"),t.addClass("selected"),this.scroll.sort(t.data("sort"))},resetSortSelection:function(){$(".sortDropdown .dropdown-menu a").removeClass("selected").eq(0).addClass("selected")},initializeLabels:function(e,t){var n=this;s.toggleFocusNClick(this.$el.find(".labelContainer"),0===e.length),e.length>0&&(this.$el.find("select.labelFilter").html(""),a.each(a.uniq(e).sort(),(function(e){n.$el.find("select.labelFilter").append('<option value="'+s.sanitize(e)+'">'+s.sanitize(e)+"</option>")})),t?this.$el.find("select.labelFilter").selectpicker("refresh"):this.$el.find("select.labelFilter").selectpicker())},selectTab:function(e,t,n){this.classId=e,t=t.charAt(0).toUpperCase()+t.substring(1).toLowerCase(),$(".studentClasses").removeClass("assess grades vocabulary research mydata");try{this["select"+t](n)}catch(t){window.location.hash=e?"#student/classes/"+e+"/assignments":"#student/assignments"}},selectAssignments:function(){var e=this.$el.find(".tabAssignments");e.hasClass("selected")||(this.$el.find("a.btn-tab").removeClass("selected"),e.addClass("selected"),$(".studentClasses").addClass("assess"),this.scope.renderAssignments(this.classId))},selectGrades:function(){var e=this.$el.find(".tabGrades");e.hasClass("selected")||(this.$el.find("a.btn-tab").removeClass("selected"),e.addClass("selected"),$(".studentClasses").addClass("grades"),this.scope.renderGrades(this.classId))},selectVocabulary:function(){var e=this.$el.find(".tabVocabulary");e.hasClass("selected")||(this.$el.find("a.btn-tab").removeClass("selected"),e.addClass("selected"),$(".studentClasses").addClass("vocabulary"),this.scope.renderVocabulary(this.classId))},selectResearch:function(){var e=this.$el.find(".tabResearch");e.hasClass("selected")||(this.$el.find("a.btn-tab").removeClass("selected"),e.addClass("selected"),$(".studentClasses").addClass("research"),this.scope.renderResearch(this.classId))},selectMydata:function(e){var t=this.$el.find(".tabMyData");t.hasClass("selected")||(this.$el.find("a.btn-tab.selected").removeClass("selected"),t.addClass("selected"),$(".studentClasses").addClass("mydata"),this.scope.renderMyData(this.classId,e))},tilesSelected:function(e){e?s.enableFocusNClick(".btnNext"):s.disableFocusNClick(".btnNext")},showAddOnlineText:function(){delete window.addGoogleDoc,o.showModalFromBackbone(i.default,{title:"Paste the URL of the online article",okText:"Next",mode:"research",classId:this.classId}),Backbone.tracking.trackGAEvent("student","addOnlineText:start")},showUploadText:function(){o.showModalFromBackbone(r.default,{title:"Update information for tile",cssClass:"uploadText modal-al-upload-text",okText:"Done",classId:this.classId}),Backbone.tracking.trackGAEvent("student","addUploadText:start")},showAddGoogleDoc:function(){if("undefined"!=typeof gapi){var e=this.classId,t=function(){window.addGoogleDoc.classId=e,l.default()};window.addGoogleDoc?window.addGoogleDoc.oauthToken?t():(window.addGoogleDoc.callback=t,gapi.auth.authorize({client_id:c.default.googleApiClientId,scope:window.addGoogleDoc.scopes,immediate:!1,authuser:-1,user_id:sCH.userM.get("Accounts").google?sCH.userM.get("Accounts").google.ExternalUserId:null},window.addGoogleDoc.handleAuthResult)):d.init(t)}else new Backbone.BootstrapModal({title:"Uh oh!",content:"Sorry, but at this time Google is experiencing issues. Please refresh the page and try again.",okText:"Refresh"}).open((function(){window.location.reload(!0)}))},startSelectMode:function(e){var t=$(e.currentTarget).data("selectmode"),n=$(e.currentTarget).data("selecttype"),a=$(e.currentTarget).attr("class").split(/\s+/),s=a[a.length-1].replace("btn","");Backbone.pubEv.trigger("toggleSelectMode",{state:"on",mode:t,action:s,type:n}),this.selectModeAction=s,this.$el.find(".selectedAction .text").text(alcfg.infoText.sresearch[s]),this.$el.find(".selectedAction").removeClass("multiple single").addClass(t).show()},next:function(){Backbone.pubEv.trigger(this.selectModeAction)},cancelSelectMode:function(){Backbone.pubEv.trigger("toggleSelectMode",{state:"off"}),this.$el.find(".selectedAction").hide(),this.$el.find(".selectedAction .text").text(""),s.disableFocusNClick(".btnNext")},destroy:function(){Backbone.pubEv.off("tilesSelected")}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="selectedAction">\r\n    <div class="selectedActionInner">\r\n        <span class="text"></span>\r\n        <button class="btnNext btn-box disabled">Next</button>\r\n        <button class="btnCancel btn-box">Cancel</button>\r\n    </div>\r\n</div>\r\n\r\n<nav role="tablist" aria-label="Tabs" class="tabs">\r\n    <a role="tab" href="'+(null==(__t=basePath)?"":__t)+'assignments" class="btn-tab pull-left tabAssignments">Assignments</a>\r\n    <a role="tab" href="'+(null==(__t=basePath)?"":__t)+'grades" class="btn-tab pull-left tabGrades">Grades</a>\r\n    \x3c!--<a href="'+(null==(__t=basePath)?"":__t)+'vocab" class="btn-tab pull-left tabVocabulary">Vocabulary</a>--\x3e\r\n    ',isOnPrimePlan&&(__p+='\r\n    <a role="tab" href="'+(null==(__t=basePath)?"":__t)+'research"\r\n        class="btn-tab pull-left tabResearch">'+(null==(__t=bowser.mobile?"Research":"Research Projects")?"":__t)+'</a>\r\n    <a role="tab" href="'+(null==(__t=basePath)?"":__t)+'mydata" class="btn-tab pull-left tabMyData">\r\n        My Data\r\n    </a>\r\n    '),__p+='\r\n</nav>\r\n\r\n<aside>\r\n    <div class="rowTwo">\r\n        \x3c!--Assignment tab buttons--\x3e\r\n        <div data-tab="assignment" class="dropdown sortDropdown" style="top: 0px;">\r\n            <button class="btnSorting icon-sort" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ></button>\r\n            <ul class="dropdown-menu assess" aria-labelledby="btnSorting">\r\n                <li><a href="javascript:void(0)" class="selected" data-sort="assigneddate">Assigned date</a></li>\r\n                \x3c!--<li><a data-sort="viewdate">Last view date</a></li>--<-- View date not stored for students yet  --\x3e\r\n                <li><a href="javascript:void(0)" data-sort="unanswered">Unanswered</a></li>\r\n                <li><a href="javascript:void(0)" data-sort="title">Title</a></li>\r\n                <li><a href="javascript:void(0)" data-sort="state">State (locked vs unlocked)</a></li>\r\n            </ul>\r\n        </div>\r\n\r\n        <div data-tab="assignment" class="btn-tab labelContainer">\r\n            <button class="icon-tag" data-toggle="dropdown"></button>\r\n            <select class="labelFilter" data-live-search="true" multiple></select>\r\n        </div>\r\n\r\n        \x3c!--Research tab buttons--\x3e\r\n        <div data-tab="research" class="dropdown btnAddContent">\r\n            <button class="btn-box callout" role="button" data-toggle="dropdown" aria-haspopup="true"\r\n                aria-expanded="false">'+(null==(__t=bowser.mobile?"Add":"Add Content")?"":__t)+'<span\r\n                    class="icon-dropdown-arrow"></span></button>\r\n            <ul class="dropdown-menu" aria-labelledby="btnAddContent">\r\n                <li><a href="javascript:void(0)" class="btnAddOnlineText">Import Internet article</a></li>\r\n                <li><a href="javascript:void(0)" class="btnAddGoogleDoc">Import Google Doc</a></li>\r\n                <li><a href="javascript:void(0)" class="btnUploadText">Upload PDF</a></li>\r\n            </ul>\r\n        </div>\r\n        <button data-tab="research" class="btn-box btnCollaborate" data-selectmode="single"\r\n            data-selecttype="ok">Collaborate</button>\r\n        <div data-tab="research" class="dropdown labelDropdown">\r\n            <button id="btnLabelMenu" class="btn-box btnLabelMenu" role="button" data-toggle="dropdown" aria-haspopup="true"\r\n                aria-expanded="false" data-html="true" data-placement="right">Labels<span\r\n                    class="icon-dropdown-arrow"></span></button>\r\n            <ul class="dropdown-menu labelActions" aria-labelledby="btnLabelMenu">\r\n                <li><a href="javascript:void(0)" class="btnAddLayerLabel" data-selectmode="multiple" data-selecttype="ok">Add labels</a></li>\r\n                <li><a href="javascript:void(0)" class="btnDeleteLayerLabel" data-selectmode="multiple" data-selecttype="ok">Remove labels</a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <button data-tab="research" class="btn-box btnCiteText" data-selectmode="multiple" data-selecttype="ok">Cite</button>\r\n\r\n        <div data-tab="research" class="dropdown btnResearchMore">\r\n            <button class="btn-box" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More<span\r\n                    class="icon-dropdown-arrow"></span></button>\r\n            <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="btnResearchMore">\r\n                <li><a href="javascript:void(0)" class="btnMoveResearch" data-selectmode="multiple" data-selecttype="ok">Move</a></li>\r\n                <li><a href="javascript:void(0)" class="btnDeleteLayers" data-selectmode="multiple" data-selecttype="destructive">Delete</a></li>\r\n                <li><a href="javascript:void(0)" class="btnEditTextDetails" data-selectmode="single" data-selecttype="ok">Edit text details and\r\n                        cover image</a></li>\r\n            </ul>\r\n        </div>\r\n\r\n        <div data-tab="research" class="dropdown btnResearchMoreSmartphone">\r\n            <button class="btn-box" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More<span\r\n                    class="icon-dropdown-arrow"></span></button>\r\n            <ul class="dropdown-menu" aria-labelledby="btnResearchMoreSmartphone">\r\n                <li><a href="javascript:void(0)" class="btnCollaborate" data-selectmode="single" data-selecttype="ok">Collaborate</a></li>\r\n                <li><a href="javascript:void(0)" class="btnCiteText" data-selectmode="multiple" data-selecttype="ok">Cite</a></li>\r\n                <li class="divider"></li>\r\n                <li><a href="javascript:void(0)" class="btnAddLayerLabel" data-selectmode="multiple" data-selecttype="ok">Add labels</a></li>\r\n                <li><a href="javascript:void(0)" class="btnDeleteLayerLabel" data-selectmode="multiple" data-selecttype="ok">Remove labels</a>\r\n                </li>\r\n                <li class="divider"></li>\r\n                <li><a href="javascript:void(0)" class="btnMoveResearch" data-selectmode="multiple" data-selecttype="ok">Move</a></li>\r\n                <li><a href="javascript:void(0)" class="btnDeleteLayers" data-selectmode="multiple" data-selecttype="destructive">Delete</a></li>\r\n                <li><a href="javascript:void(0)" class="btnEditTextDetails" data-selectmode="single" data-selecttype="ok">Edit text details<br/> and cover image</a></li>\r\n            </ul>\r\n        </div>\r\n\r\n        <div data-tab="research" class="btn-tab labelContainer">\r\n            <button class="icon-tag" data-toggle="dropdown"></button>\r\n            <select class="labelFilter" data-live-search="true" multiple></select>\r\n        </div>\r\n\r\n        <div data-tab="research" class="dropdown sortDropdown" style="top: 0px;">\r\n            <button class="btnSorting icon-sort" role="button" data-toggle="dropdown" aria-haspopup="true"\r\n                aria-expanded="false"></button>\r\n            <ul class="dropdown-menu research" aria-labelledby="btnSorting">\r\n                <li><a href="javascript:void(0)" class="selected" data-sort="recency">Recently Updated</a></li>\r\n                <li><a href="javascript:void(0)" data-sort="title">Title</a></li>\r\n                <li><a href="javascript:void(0)" data-sort="author">Author</a></li>\r\n                <li><a href="javascript:void(0)" data-sort="label">Label</a></li>\r\n            </ul>\r\n        </div>\r\n\r\n        <div id="studentDataSubheader"></div>\r\n    </div>\r\n</aside>';return __p}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(5),r=n(22),l=n(87),d=n(14),c=n(132),u=n(1646),p=n(20);t.default=Backbone.View.extend({el:"div.studentClasses .scroll",events:{"click .tile":"tileClicked"},initialize:function(e){this.subheader=e.subheader,Backbone.pubEv.on("toggleSelectMode",this.toggleSelectMode,this),Backbone.pubEv.on("refreshStudentClassAssignments",this.refreshStudentClassAssignments,this),this.$el.html(p.default.isMath?'<div class="mathAssignments"></div>':'<ul class="tiles assignments">')},preRender:function(e){var t=this;this.classM=sCH.classesC.getModelByClassId(e),this.classM.getAssignmentsForStudent((function(e){if(t.allAssignments=t.classM.get("Assignments"),o.toggleFocusNClick(".sortDropdown",0===t.allAssignments.length),t.allAssignments.length>0){var n=[];i.each(t.allAssignments,(function(e){e.LayerLabels&&(n=n.concat(e.LayerLabels))})),t.subheader.initializeLabels(n),t.render()}else r.unmountAllChildReactComponentsUnderParent(t.$el),o.disableFocusNClick(".labelContainer"),t.$el.find(p.default.isMath?".mathAssignments":"ul.assignments").html("<div class='ctaInfo'>"+alcfg.infoText.sclasses.noAssignments+"</div>")}))},refreshStudentClassAssignments:function(e){e===this.classM.get("ClassId")&&(this.allAssignments=this.classM.get("Assignments"),this.currentLabelFilter?this.filterByLabel(this.currentLabelFilter):0===this.allAssignments.length?this.$el.find("ul.assignments").html("<div class='ctaInfo'>"+alcfg.infoText.sclasses.noAssignments+"</div>"):this.render(this.allAssignments,this.currentSortBy))},render:function(e,t){if(e||(e=this.allAssignments),e=i.filter(e,(function(e){return!e.Assignees||0==e.Assignees.length||i.filter(e.Assignees,{UserId:sCH.userM.get("UserId")}).length})),p.default.isMath)return this.renderMathAssignments();e.sort((function(e,n){var a,s;switch(t){case"unanswered":a=e.QuestionTagCount-e.NumOfResponses,s=n.QuestionTagCount-n.NumOfResponses;break;case"viewdate":a=e.LastViewedDate&&e.LastViewedDate>e.CreateDate?e.LastViewedDate:e.CreateDate,s=n.LastViewedDate&&n.LastViewedDate>n.CreateDate?n.LastViewedDate:n.CreateDate;break;case"title":return l(e.Title,n.Title);case"state":a=!e.IsLocked,s=!n.IsLocked;break;case"assigneddate":default:a=e.CreateDate,s=n.CreateDate}return a===s?0:a>s?-1:1})),e.length>0?r.mountReactComponent(c.default,this.$el.find("ul.assignments")[0],{page:d.Page.ASSIGNMENTS,tiles:e}):(r.unmountAllChildReactComponentsUnderParent(this.$el),this.$el.find("ul.assignments").html('<div class="ctaInfo">No assignments match your filter.</div>'))},renderMathAssignments:function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(a){switch(a.label){case 0:return t=this.classM.get("Assignments"),n=this.classM.get("interventions"),[4,r.unmountAllChildReactComponentsUnderParent(this.$el)];case 1:return a.sent(),[4,r.mountReactComponent(u.default,this.$el.find(".mathAssignments")[0],{isSelectMode:e,assignments:t,interventions:n})];case 2:return a.sent(),[2]}}))}))},sort:function(e){var t=this.filteredAssignments||this.allAssignments;this.currentSortBy=e,this.render(t,e)},tileClicked:function(e){if(this.selectMode){if($(e.currentTarget).find(".checkbox").is(":visible")){var t=$(e.currentTarget);if(this.singleSelectMode)this.selectedId=t.data("id"),this.$el.find(".chkSelectTile").prop("checked",!1),t.find(".chkSelectTile").prop("checked",!0),Backbone.pubEv.trigger(this.selectAction);else if(t.hasClass("selected"))t.find(".chkSelectTile").prop("checked",!1),t.removeClass("selected"),0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelected",!1);else 0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelected",!0),t.find(".chkSelectTile").prop("checked",!0),t.addClass("selected")}e.preventDefault()}else{(t=$(e.currentTarget)).hasClass("isQuiz")&&t.hasClass("locked")&&(e.preventDefault(),o.bootstrap.alert({message:alcfg.alertsText.lockedQuiz,alert:"danger"}))}},toggleSelectMode:function(e){this.selectMode="on"===e.state,this.selectMode?(this.selectAction=e.action,this.$el.find(".checkbox").show().removeClass("destructive ok").addClass(e.type),this.singleSelectMode="single"===e.mode):(this.$el.find(".checkbox").hide().removeClass("destructive ok"),this.$el.find(".chkSelectTile").prop("checked",!1),this.$el.find("a.selected").removeClass("selected"),o.enableFocusNClick(this.$el.find(".disabled")))},getSelectedIds:function(){if(this.selectedId){var e=[this.selectedId];return this.selectedId=null,e}var t=[];return i.each(this.$el.find("a.selected"),(function(e){t.push($(e).data("id"))})),t},filterByLabel:function(e){if(e&&0!==e.length){var t=this.classM.get("Assignments"),n=this,a=[];this.currentLabelFilter=e,i.each(t,(function(t){t.LayerLabels&&t.LayerLabels.length>0&&(e.every((function(e){return $.inArray(e,t.LayerLabels)>-1}))&&a.push(t));n.filteredAssignments=a})),this.render(this.filteredAssignments,this.currentSortBy)}else this.filteredAssignments=null,this.currentLabelFilter=null,this.render(this.allAssignments,this.currentSortBy)},destroy:function(){this.$el.parent().removeClass("assess"),Backbone.pubEv.off("refreshStudentClassAssignments")}})}).call(this,n(21))},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(5),o=n(60),r=n(280),l=function(){return s.createElement("div",{className:"ctaInfo"},alcfg.infoText.sclasses.noAssignments)},d=function(e,t){return e.map((function(e){return u(e)})).concat(t.map((function(e){return u(e)})))},c=function(){return{height:50,cells:[{content:"Assignment",width:500},{content:"Mastery",width:180,classes:{center:!0}},{content:"Date Assigned",width:100,classes:{center:!0}}]}},u=function(e){var t=e.AssignmentId?"#student/mathreader?assignmentId="+e.AssignmentId:"#student/mathreader?interventionId="+e.InterventionId,n=moment.utc(e.CreateDate).local().format("MM-DD-YY"),o=+new Date(e.CreateDate);return{height:50,cells:[{content:s.createElement("a",{onClick:function(){return i.openReaderUrl(t)},className:"lnkAssignmentTitle"},s.createElement("span",{className:"assignmentName"},e.InterventionId&&s.createElement(p,null),i.truncate(e.name,100),s.createElement(r.AssignmentLock,a({},e))),s.createElement("span",{className:"labels"},e.standardCode)),sortValue:e.standardCode},{content:e.Mastery?i.percent(e.Mastery):"-",sortValue:e.Mastery,classes:{center:!0}},{content:n,sortValue:o,classes:{center:!0}}]}},p=function(){return s.createElement("span",null," ")};t.default=function(e){var t=e.assignments,n=e.interventions;return t.length>0?s.createElement("div",{className:"dataWrapper"},s.createElement(o.VTable,{header:c(),body:d(t,n),fixedRowCount:1,fixedColumnCount:0,enableFixedColumnScroll:!0,enableFixedRowScroll:!0,sortByColumnIndex:2,sortDescending:!0,customClassNames:["mathAssignmentTable"]})):s.createElement(l,null)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=n(10),i=n(789);t.default=Backbone.View.extend({el:"div.studentClasses .scroll",render:function(e){this.$el.html('<div id="grades" class="dataWrapper"/>').show(),this.fetchGrades(e)},fetchGrades:function(e){var t=this;e&&s.GetDataForStudentGradebook({classId:e},(function(n){t.rawData=n,t.rawData.ClassId=e;var s=t.$el.find("#grades");a.mountReactComponent(i.default,s[0],t.rawData)}))},destroy:function(){this.$el.parent().removeClass("grades"),this.undelegateEvents()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(347),r=n(682),l=n(1649),d=n(1651),c=n(1653),u=n(1655),p=n(1657),h=n(10),g=n(737),f=n(14),m=n(132),v=n(24);t.default=Backbone.View.extend({el:"div.studentClasses .scroll",events:{"click .tile":"tileClicked"},initialize:function(e){this.subheader=e.subheader,Backbone.pubEv.on("toggleSelectMode",this.toggleSelectMode,this),Backbone.pubEv.on("AddLayerLabel",this.addLayerLabel,this),Backbone.pubEv.on("DeleteLayerLabel",this.deleteLayerLabel,this),Backbone.pubEv.on("MoveResearch",this.moveResearch,this),Backbone.pubEv.on("DeleteLayers",this.deleteTexts,this),Backbone.pubEv.on("Collaborate",this.collaborate,this),Backbone.pubEv.on("CiteText",this.citeText,this),Backbone.pubEv.on("EditTextDetails",this.editTextDetails,this),Backbone.pubEv.on("textImported",this.addedToLessons,this),this.$el.html('<ul class="tiles research">')},preRender:function(e){var t=this;this.classId=e,this.researchC=new r.default,this.researchC.on("sync",(function(){$(".actions").show(),t.subheader.initializeLabels(t.manageLabels()),t.render()})),this.researchC.fill({classId:e})},render:function(){s.toggleFocusNClick('button[data-tab="research"]:not(.btnAddContent, .labelContainer),[data-tab="research"]:not(.btnAddContent, .labelContainer) button',0===this.researchC.length),s.toggleFocusNClick(".btnMoveResearch",!(this.researchC.length>0&&sCH.classesC.length>1)),this.researchC.length>0?this.renderTiles(this.researchC.toJSON()):this.$el.find("ul.research").html("<div class='ctaInfo'>"+alcfg.infoText.sresearch.noTexts+"</div>"),this.$el.scrollTop(0),s.initTooltips(this.$el)},renderTiles:function(e){i.mountReactComponent(m.default,this.$el.find("ul.research")[0],{page:f.Page.RESEARCH,tiles:e})},manageLabels:function(e){var t=[];return a.each(this.researchC.toJSON(),(function(e){e.LayerLabels.length>0&&(t=t.concat(e.LayerLabels))})),t},toggleSelectMode:function(e){if(this.selectMode="on"===e.state,this.selectMode){if(this.selectAction=e.action,this.$el.find(".checkbox").show().removeClass("destructive ok").addClass(e.type),this.singleSelectMode="single"===e.mode,"DeleteLayerLabel"===e.action){var t=this;a.each(this.researchC.models,(function(e){e.get("LayerLabels")&&0!==e.get("LayerLabels").length||s.disableFocusNClick(t.$el.find("a.tile[data-id="+e.get("StudentLayerId")+"]"))}))}}else this.$el.find(".checkbox").hide().removeClass("destructive ok"),this.$el.find(".chkSelectTile").prop("checked",!1),this.$el.find("a.selected").removeClass("selected"),s.enableFocusNClick(this.$el.find(".disabled"))},tileClicked:function(e){if(this.selectMode){if($(e.currentTarget).find(".checkbox").is(":visible")){var t=$(e.currentTarget);if(this.singleSelectMode)this.selectedId=t.data("id"),this.$el.find(".chkSelectTile").prop("checked",!1),t.find(".chkSelectTile").prop("checked",!0),Backbone.pubEv.trigger(this.selectAction);else if(t.hasClass("selected"))t.find(".chkSelectTile").prop("checked",!1),t.removeClass("selected"),0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelected",!1);else 0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelected",!0),t.find(".chkSelectTile").prop("checked",!0),t.addClass("selected")}e.preventDefault()}},getSelectedIds:function(){if(this.selectedId){var e=[this.selectedId];return this.selectedId=null,e}var t=[];return a.each(this.$el.find("a.selected"),(function(e){t.push($(e).data("id"))})),t},addedToLessons:function(){this.researchC=null,this.preRender(this.classId)},collaborate:function(){var e=this.getSelectedIds()[0],t=this.researchC.filter({StudentLayerId:e})[0],n=this;new Backbone.BootstrapModal({title:"Research with other students",content:new u.default({text:t,classId:this.classId,callback:function(e){var a=t.get("CoauthorIds")?t.get("CoauthorIds").concat(e):e;t.set({CoauthorIds:a}),n.render(),Backbone.pubEv.trigger("cancelSelectMode")}}),allowCancel:!1,noInputFocus:!0,okText:"Invite",cssClass:"coauthors",triggerBackboneEventOnCancel:"cancelSelectMode"})},addLayerLabel:function(){var e=this.getSelectedIds(),t=this,n=[],s=[],i=[];a.each(this.researchC.models,(function(t){t.get("LayerLabels").length>0&&(s=s.concat(t.get("LayerLabels"))),-1!==$.inArray(t.get("StudentLayerId"),e)&&(i.push(t),n=n.concat(t.get("LayerLabels")))})),s=a.uniq(s),new Backbone.BootstrapModal({title:"Add labels",allowCancel:!1,content:new l.default({layerIds:e,existingLabelsInSelectedItems:n,userCreatedLabels:s,callback:function(e){a.each(i,(function(t){t.set("LayerLabels",a.uniq(t.get("LayerLabels").concat(e)))})),t.subheader.initializeLabels(t.manageLabels(),!0),t.render(),Backbone.pubEv.trigger("cancelSelectMode")}}),noInputFocus:!0,cssClass:"modal-al-add-label",okText:"Save",triggerBackboneEventOnCancel:"cancelSelectMode"}).open()},deleteLayerLabel:function(){var e=this.getSelectedIds(),t=this,n=[],s=[];a.each(e,(function(e){var a=t.researchC.find({StudentLayerId:e});s.push(a),a.get("LayerLabels").length>0&&(n=n.concat(a.get("LayerLabels")))})),new Backbone.BootstrapModal({title:"Remove labels",allowCancel:!1,content:new d.default({layerIds:e,existingLabelsInSelectedItems:n,callback:function(e){a.each(s,(function(t){t.set("LayerLabels",a.difference(t.get("LayerLabels"),e))})),t.subheader.initializeLabels(t.manageLabels(),!0),t.render(),Backbone.pubEv.trigger("cancelSelectMode")}}),noInputFocus:!0,cssClass:"modal-al-delete-label",okText:"Remove",triggerBackboneEventOnCancel:"cancelSelectMode"}).open()},deleteTexts:function(){var e=this,t=this.getSelectedIds();new Backbone.BootstrapModal({title:"Delete these items?",content:alcfg.confirmsText.textsDelete,cssClass:"modal-al-items-to-be-deleted",okText:"Delete",triggerBackboneEventOnCancel:"cancelSelectMode"}).open((function(){!function(e,t){h.DeleteResearch({studentLayerIds:e},(function(){a.each(e,(function(e){var n=t.researchC.find({StudentLayerId:e});t.researchC.remove(n),t.$el.find("a[data-id='"+e+"']").parent().remove()})),0==t.researchC.length&&t.render(),Backbone.pubEv.trigger("cancelSelectMode")}))}(t,e)}))},moveResearch:function(){var e=this.getSelectedIds(),t=this,n=sCH.classesC.filter((function(e){return e.get("ClassId")!==t.classId&&e.get("IsOnPrimePlan")})),s=sCH.classesC.filter({ClassId:this.classId})[0].get("Name");new Backbone.BootstrapModal({title:"Move texts to another class",content:new c.default({selectedIds:e,classes:n,currentClassName:s,callback:function(){a.each(e,(function(e){t.researchC.remove(t.researchC.filter({StudentLayerId:e})[0])})),Backbone.pubEv.trigger("cancelSelectMode"),t.render()}}),allowCancel:!0,cssClass:"modal-lg modal-al-move-research",okText:"Move",triggerBackboneEventOnCancel:"cancelSelectMode"}).open()},citeText:function(){var e=this.getSelectedIds();new Backbone.BootstrapModal({title:"Text citations",content:new p.default({layerIds:e}),cancelText:!1,cssClass:"modal-al-cite-text",optionButtons:[{text:"Copy citations",class:"btnCopyCitations"}],okText:"Close"}).open((function(){Backbone.pubEv.trigger("cancelSelectMode")}))},editTextDetails:function(){var e=this.getSelectedIds()[0],t=this.researchC.find({StudentLayerId:e}),n=this;v.showModalFromBackbone(g.default,{title:"Edit text details and cover image",text:t.toJSON(),isResearch:!0,callback:function(e){t.set("Title",e.Title),t.set("Author",e.Author),t.set("CoverArt",e.CoverArt),n.researchC.remove(t,{silent:!0}),n.researchC.add(t,{at:0}),n.render(),Backbone.pubEv.trigger("cancelSelectMode")},okText:"Save"})},filterByLabel:function(e){if(e&&0!==e.length){var t=this.researchC.filter((function(t){return e.every((function(e){return $.inArray(e,t.get("LayerLabels"))>-1}))})),n=new r.default(t);this.renderTiles(n.toJSON())}else this.renderTiles(this.researchC.toJSON())},sort:function(e){var t=o.sortTiles(e,this.researchC.toJSON());this.renderTiles(t)},search:function(e){if(0===(e=e.toLowerCase()).length)this.renderTiles(this.researchC.toJSON());else{var t=this.researchC.filter((function(t){var n=$.trim(t.get("Title").toLowerCase()),a=$.trim(t.get("Author").toLowerCase());return n.indexOf(e)>=0||a.indexOf(e)>=0})),n=new r.default(t);this.renderTiles(n.toJSON()),window.setTimeout((function(){Backbone.tracking.trackGAEvent("searchResearch",e)}),3e3)}},destroy:function(){Backbone.pubEv.off("toggleSelectMode"),Backbone.pubEv.off("AddLayerLabel"),Backbone.pubEv.off("DeleteLayerLabel"),Backbone.pubEv.off("DeleteLayers"),Backbone.pubEv.off("MoveResearch"),Backbone.pubEv.off("Collaborate"),Backbone.pubEv.off("CiteText"),Backbone.pubEv.off("EditTextDetails"),Backbone.pubEv.off("textImported"),this.undelegateEvents()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(10),r=n(277);t.default=Backbone.View.extend({template:n(1650),initialize:function(e){this.on("ok",this.addLabels),this.obj=e},render:function(){var e=this,t=this.obj.existingLabelsInSelectedItems.sort(),n=[];return a.each(t,(function(e){n.slice(-1)[0]&&n.slice(-1)[0].label===e?n.slice(-1)[0].count++:n.push({label:e,count:1})})),this.$el.html(this.template({existingLabelCountObj:n})),this.selectedLabels=[],i.mountReactComponent(r.default,this.$el.find("#labelsContainer")[0],{placeholder:"Start typing...",suggestions:this.obj.userCreatedLabels.map((function(e){return{value:e,label:e}})),onChange:function(t){e.selectedLabels=t.map((function(e){return e.value}))},allowFreeTagging:!0}),this},addLabels:function(e){e.preventClose();var t=this;if(this.obj.existingLabels&&this.obj.existingLabels.length>0);else if(0===this.selectedLabels.length)return void s.bootstrap.alert({message:"Please enter a label!",alert:"danger"});-1!=this.obj.layerIds?(e.disableOk("Saving..."),o.UpdateStudentLayerLabels(this.obj.layerIds,this.selectedLabels,!1,(function(){t.obj.callback&&t.obj.callback(t.selectedLabels),e.close(),s.bootstrap.alert({message:"Label(s) updated!"})}))):this.obj.callback(this.selectedLabels,e)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p>\n    Start typing and press Enter to create a new label (upto 25 characters). Each label will be added to all selected assignments.\n</p>\n\n<div id="labelsContainer"></div>\n\n',existingLabelCountObj.length>0&&(__p+='\n    <h1 class="light" style="">Current Labels:</h1>\n    <ul class="checklist">\n        ',_.each(existingLabelCountObj,(function(e,t){__p+='\n            <li>\n                <div class="title light">\n                    '+(null==(__t=cH.sanitize(e.label))?"":__t)+' \n                    <span class="count">('+(null==(__t=e.count)?"":__t)+")</span>\n                </div>\n            </li>\n        "})),__p+="\n    </ul>\n"),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10);t.default=Backbone.View.extend({template:n(1652),initialize:function(e){this.on("ok",this.removeLabels),this.on("initialized",this.modalInitialized),this.obj=e},modalInitialized:function(e){this.modal=e},events:{"change [type='checkbox']":"labelSelected"},render:function(){return this.$el.html(this.template({existingLabelsInSelectedItems:a.uniq(this.obj.existingLabelsInSelectedItems)})),this.modal.disableOk(),this},labelSelected:function(){0!==this.$el.find("ul.checklist input[type='checkbox']:checked").length?this.modal.enableOk():this.modal.disableOk()},removeLabels:function(e){var t=this,n=this.$el.find("input[type='checkbox']:checked");e.preventClose(),e.disableOk("Removing..."),n=a.map(n,(function(e){return $(e).data("label").toString()})),i.UpdateStudentLayerLabels(this.obj.layerIds,n,!0,(function(){t.obj.callback&&t.obj.callback(n),t.destroy(),e.close(),s.bootstrap.alert({message:"Assignments updated!"})}))},destroy:function(){}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<ul class="checklist">\n    ',_.each(existingLabelsInSelectedItems,(function(e){e=cH.sanitize(e),__p+='\n    <li>\n        <div class="checkbox">\n            <input id="chkSelectLabel'+(null==(__t=e)?"":__t)+'" data-label="'+(null==(__t=e)?"":__t)+'" type="checkbox" class="regular-checkbox" />\n            <label for="chkSelectLabel'+(null==(__t=e)?"":__t)+'"></label>\n        </div>\n        <div class="title">'+(null==(__t=e)?"":__t)+"</div>\n    </li>\n    "})),__p+="\n</ul>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({template:n(1654),initialize:function(e){this.selectedIds=e.selectedIds,this.callback=e.callback,this.classes=e.classes,this.currentClassName=e.currentClassName,this.on("initialized",this.modalInitialized),this.on("shown",(function(e){return e.disableOk("Move")})),this.on("ok",this.moveResearch)},events:{"click input.regular-checkbox":"checkboxSelected"},modalInitialized:function(e){this.modal=e},render:function(){this.$el.html(this.template({classList:this.classes,currentClassName:this.currentClassName})),a.initTooltips(this.$el)},checkboxSelected:function(e){this.$el.find("input:checked").prop("checked",!1),$(e.currentTarget).prop("checked",!0),this.modal.enableOk("Move")},moveResearch:function(e){e.preventClose();var t=this.$el.find("input:checked"),n=this;0===t.length?a.bootstrap.alert({alert:"danger",message:"Please select a class!"}):(e.disableOk("Moving..."),s.MoveResearch({studentLayerIds:this.selectedIds,classId:t.data("classid")},(function(t,s){t?(e.close(),n.callback()):(e.enableOk("Move"),a.bootstrap.alert({alert:"danger",message:s}))})))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<p>Current class: "+(null==(__t=currentClassName)?"":__t)+'</p>\n<ul class="checklist">\n    ',_.each(classList,(function(e,t){__p+='\n    <li>\n        <div class="checkbox">\n            <input id="chkSelectClass'+(null==(__t=e.get("ClassId"))?"":__t)+'" data-classid="'+(null==(__t=e.get("ClassId"))?"":__t)+'" type="checkbox" class="regular-checkbox" />\n            <label for="chkSelectClass'+(null==(__t=e.get("ClassId"))?"":__t)+'"></label>\n        </div>\n        <div class="title">'+(null==(__t=e.get("Name"))?"":__t)+"</div>\n    </li>\n    "})),__p+="\n</ul>\n";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(10),r=n(277);t.default=Backbone.View.extend({template:n(1656),initialize:function(e){var t=this;this.callback=e.callback,this.text=e.text,this.classId=e.classId,this.on("ok",this.addcoauthors),this.on("initialized",this.modalInitialized),o.GetClassPeers({classId:this.classId},(function(e){t.students=e,t.modal.open()}))},modalInitialized:function(e){this.modal=e},render:function(){var e=this;this.$el.html(this.template({students:this.students,text:this.text}));var t=this.text.get("CoauthorIds"),n=a.filter(this.students,(function(e){return-1===t.indexOf(e.UserId)}));return this.selectedUserIds=[],i.mountReactComponent(r.default,this.$el.find("#labelsContainer")[0],{placeholder:"Start typing a peer's name...",suggestions:n.map((function(e){return{value:e.UserId,label:e.FirstName+" "+e.LastName}})),onChange:function(t){e.selectedUserIds=t.map((function(e){return e.value}))}}),this},addcoauthors:function(e){e.preventClose(),e.disableOk("Inviting...");var t=this;this.selectedUserIds.length>0?o.AddResearchCoauthors({studentLayerId:this.text.get("StudentLayerId"),coauthorIds:this.selectedUserIds},(function(){e.close(),s.bootstrap.alert({message:'Co-researchers can now access this text in the "Research Projects" view.'}),t.callback&&t.callback(t.selectedUserIds)})):0===this.selectedUserIds.length&&(s.bootstrap.alert({message:"Please select 1 or more peers to co-author this project with!",alert:"danger"}),e.enableOk("Invite"))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",students.length>0?__p+='\n    <p>Read and annotate this text with other students in this class.</p>\n    <div id="labelsContainer"></div>\n':__p+='\n    <div class="empty">\n        There are no other students in your class to research this with!\n    </div>\n',__p+='\n\n<h1 class="light">Co-Authors:</h1>\n<ul class="checklist">\n    <li>\n        <div class="checkbox">'+(null==(__t=cH.generateAvatarHtml(sCH.userM.get("ImageUrl")))?"":__t)+'</div>\n        <div class="title">'+(null==(__t=cH.sanitize(sCH.userM.get("FirstName")+" "+sCH.userM.get("LastName")))?"":__t)+" (me)</div>\n    </li>\n    ",_.each(text.get("CoauthorIds"),(function(e){var t=_.find(students,{UserId:e});t&&(__p+='\n    <li>\n        <div class="checkbox">'+(null==(__t=cH.generateAvatarHtml(t.ImageUrl))?"":__t)+'</div>\n        <div class="title">'+(null==(__t=cH.sanitize(t.FirstName+" "+t.LastName))?"":__t)+"</div>\n    </li>\n    ")})),__p+="\n</ul>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(232);t.default=Backbone.View.extend({template:n(1658),initialize:function(e){this.obj=e,this.on("initialized",this.modalInitialized)},events:{"change .ddCitationStyle":"getCitations"},modalInitialized:function(e){this.modal=e,this.fillEl(),this.getCitations()},getCitations:function(){var e=this.$el.find(".ddCitationStyle").val()||"mla8",t=this;i.GetCitations({studentLayerIds:this.obj.layerIds,style:e},(function(e){t.citations=e,t.fillCitationsData()}))},fillCitationsData:function(){var e="";a.each(this.citations,(function(t){e+='<div style="margin-bottom: 20px;">'+t.replace("Www.","www.")+"</div>"})),this.$el.find(".citationsContainer").html(e),this.initCopyButton()},fillEl:function(){this.$el.html(this.template()),this.$el.find("select").selectpicker()},initCopyButton:function(){var e=[],t=this.modal.$el.find(".btnCopyCitations");a.each(this.citations,(function(t){e.push(t.replace("Www.","www.").replace("<i>",'"').replace("</i>",'"'))})),t.attr("data-clipboard-text",e.join("\n\n")),new o.default(".btnCopyCitations").on("success",(function(){s.bootstrap.alert({message:"The text's citation has been copied to your clipboard. "+alcfg.alertsText.copyClipboardPasteInstruction})}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<p>\n    <label>Citation style</label>\n    <select class="ddCitationStyle">\n        <option value="mla8">MLA</option>\n        <option value="chicagob">Chicago</option>\n        <option value="apa">APA</option>\n    </select>\n</p>\n\n<div class="citationsContainer"></div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(71),i=n(1660);t.default=function(e){return a.createElement(a.Fragment,null,a.createElement(s.default,{view:i.default,options:e.viewProps,shouldNotCallRender:!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1661),s=n(1664),i=n(1730),o=n(1731),r=n(54),l=n(43),d=n(37);t.default=Backbone.View.extend({el:"div.independentReading",initialize:function(e){if(this.childViews=[],this.studentGradeLevels=null,"student"===sCH.userM.get("Role")){var t=sCH.userM.getPrimarySchool();t&&t.IsFilterIRCatalogByGradeLevel&&(this.studentGradeLevels=r.getStudentGradeLevels())}this.subheader=new o.default({scope:this}),this.subheader.render(),"Bookshelf"===e.render?this.renderBookshelf(e.learnEntityId):"Library"===e.render?this.renderLibrary(e.learnEntityId):"ReadingLog"===e.render&&this.renderReadingLog()},renderLibrary:function(e){var t=this;this.myReadingViewsDestroy();var n=d.getHashQueryParams(),a=("student"===sCH.userM.get("Role")?"student/catalog":"teacher/ir/catalog")+(e?"/"+e:"");Backbone.router.navigate(a,{trigger:!1}),this.libraryScroll=new s.default({scope:this,learnEntityId:e,queryParams:n}),this.childViews.push(this.libraryScroll),this.subheader.tabSelectedAction("library"),Backbone.pubEv.trigger("setHeaderActions",{isSearchEnabled:!0,searchPlaceholder:l.mobile?"Search catalog":null,searchCallback:function(e){e?t.libraryScroll.search(e):(t.libraryScroll.defaultSearch(!0),$(".sortDropdownLibrary ul a").removeClass("selected"))},actionButtons:{type:"IR"}})},renderBookshelf:function(e){var t=this;this.myReadingViewsDestroy(),Backbone.router.navigate("student/bookshelf",{trigger:!1}),this.bookshelfScroll=new a.default({learnEntityId:e,scope:this}),this.childViews.push(this.bookshelfScroll),this.subheader.tabSelectedAction("bookshelf"),this.bookshelfScroll.preRender(),Backbone.pubEv.trigger("setHeaderActions",{customHeaderClass:"smallSearchBox",isSearchEnabled:!0,searchPlaceholder:l.mobile?"Title, author, publisher":null,searchCallback:function(e,n){t.bookshelfScroll.search(e)},searchAutocompleteData:null}),Backbone.pubEv.trigger("updateAutocompleteData",null)},renderReadingLog:function(){this.myReadingViewsDestroy(),Backbone.router.navigate("student/readinglog",{trigger:!1}),this.readingLogScroll=new i.default({scope:this}),this.childViews.push(this.readingLogScroll),this.subheader.tabSelectedAction("readinglog"),Backbone.pubEv.trigger("setHeaderActions",{isSearchEnabled:!1})},myReadingViewsDestroy:function(){for(var e=0;e<this.childViews.length;e++)this.childViews[e].close(!1);this.childViews=[]},destroy:function(){void 0!==this.subheader&&this.subheader.close()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(10),r=n(683),l=n(1662),d=n(14),c=n(132);t.default=Backbone.View.extend({el:"div.independentReading .scroll",events:{"click .bookshelf .tile":"tileClicked","click .btnReview":"review"},initialize:function(e){this.learnEntityId=e?e.learnEntityId:null,Backbone.pubEv.on("toggleSelectModeLessons",this.toggleSelectMode,this),Backbone.pubEv.on("DeleteLayers",this.deleteTexts,this),Backbone.pubEv.on("bookshelfSort",this.sort,this),Backbone.pubEv.on("bookshelfSearch",this.search,this),this.$el.html('<ul class="tiles bookshelf">')},preRender:function(){var e=this;sCH.initStudentBookshelf((function(){e.render()}))},render:function(){var e=this;sCH.studentBookshelfC.length>0?(this.sort(),$(".btnDeleteLayers,.sortDropdownBookself").show()):($(".btnDeleteLayers,.sortDropdownBookself").hide(),this.$el.html("<div class='ctaInfo'>"+alcfg.infoText.sbookshelf.noTexts+"</div>")),s.onDevice()?(e.$el.hide(),setTimeout((function(){e.$el.show(),e.$el.scrollTop(0)}),100)):this.$el.scrollTop(0),s.initTooltips(this.$el),this.learnEntityId&&this.review()},renderTiles:function(e){i.mountReactComponent(c.default,this.$el.find("ul.bookshelf")[0],{page:d.Page.BOOKSHELF,tiles:e})},toggleSelectMode:function(e){this.selectMode="on"===e.state,this.selectMode?(this.$el.find(".checkbox").show().removeClass("destructive ok").addClass(e.type),this.singleSelectMode="single"===e.mode):(this.$el.find(".checkbox").hide().removeClass("destructive ok"),this.$el.find(".assigned, .shared").show(),this.$el.find(".chkSelectTile").prop("checked",!1),this.$el.find("a.selected").removeClass("selected"))},tileClicked:function(e){if(this.selectMode){if($(e.currentTarget).find(".checkbox").is(":visible")){var t=$(e.currentTarget);if(this.singleSelectMode)this.selectedId=t.data("id"),this.$el.find(".chkSelectTile").prop("checked",!1),t.find(".chkSelectTile").prop("checked",!0),Backbone.pubEv.trigger(this.selectAction);else if(t.hasClass("selected"))t.find(".chkSelectTile").prop("checked",!1),t.removeClass("selected"),0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelectedLessons",!1);else 0===this.$el.find("a.selected").length&&Backbone.pubEv.trigger("tilesSelectedLessons",!0),t.find(".chkSelectTile").prop("checked",!0),t.addClass("selected")}return!1}},review:function(e){var t=this.learnEntityId?parseInt(this.learnEntityId):$(e.currentTarget).prev().data("learnentityid"),n=sCH.studentBookshelfC.find({LearnEntityId:t});if(n){var a={studentLayerId:n.get("StudentLayerId"),learnEntityId:t,title:n.get("Title"),url:"TextsManager"===n.get("ContentUrl")?"#student/reader/ir/"+n.get("StudentLayerId")+"/notes":n.get("ContentUrl")};new Backbone.BootstrapModal({title:a.title.length>0?a.title:sCH.classesC.length>0?"Review and Share":"Review",content:new l.default(a),allowCancel:!1,noInputFocus:!0,okText:"Save",cssClass:"modal-al-irreview readerPrompt"}),this.learnEntityId=null}else this.learnEntityId=null},getSelectedIds:function(){if(this.selectedId){var e=[this.selectedId];return this.selectedId=null,e}var t=[];return a.each(this.$el.find("a.selected"),(function(e){t.push($(e).data("id"))})),t},deleteTexts:function(){var e=this,t=this.getSelectedIds();new Backbone.BootstrapModal({title:"Delete these items?",content:alcfg.confirmsText.textsDelete,cssClass:"modal-al-items-to-be-deleted",okText:"Delete",triggerBackboneEventOnCancel:"cancelSelectMode"}).open((function(){!function(e,t){o.DeleteBookshelfItems({studentLayerIds:e},(function(n){a.each(e,(function(e){var n=sCH.studentBookshelfC.find({StudentLayerId:e});sCH.studentBookshelfC.remove(n),t.$el.find("a[data-id='"+e+"']").parent().remove()})),0==sCH.studentBookshelfC.length&&t.render(),Backbone.pubEv.trigger("cancelSelectMode")}))}(t,e)}))},sort:function(e){if("title"===e){var t=sCH.studentBookshelfC.sortBy((function(e){return e.get("Title").replace("A ","").replace("An ","").replace("The ","")})),n=new r.default(t);this.renderTiles(n.toJSON())}else if("author"===e){t=sCH.studentBookshelfC.sortBy((function(e){try{var t=$.trim(e.get("Author")).split(" ");return $.trim(t[t.length-1])}catch(t){return $.trim(e.get("Author"))}})),n=new r.default(t);this.renderTiles(n.toJSON())}else{t=sCH.studentBookshelfC.sortBy((function(e){return-1*e.get("StudentLayerId")})),n=new r.default(t);this.renderTiles(n.toJSON())}},search:function(e){if(0===(e=e.toLowerCase()).length)this.renderTiles(sCH.studentBookshelfC.toJSON());else{var t=sCH.studentBookshelfC.filter((function(t){var n=$.trim(t.get("Title").toLowerCase()),a=$.trim(t.get("Author").toLowerCase());return n.indexOf(e)>=0||a.indexOf(e)>=0}));if(0===t.length)i.unmountReactComponent(this.$el.find("ul.bookshelf")[0]),this.$el.find("ul.bookshelf").html("<div class='ctaInfo'>"+alcfg.infoText.sbookshelf.noSearchResult+"</div>");else{var n=new r.default(t);this.renderTiles(n.toJSON())}window.setTimeout((function(){Backbone.tracking.trackGAEvent("searchBookshelf",e)}),3e3)}},destroy:function(){Backbone.pubEv.off("toggleSelectModeLessons"),Backbone.pubEv.off("DeleteLayers"),Backbone.pubEv.off("bookshelfSort"),Backbone.pubEv.off("bookshelfSearch"),this.undelegateEvents()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(22),i=n(10),o=n(277);t.default=Backbone.View.extend({template:n(1663),events:{"click .ratingContainer span":"starClicked","click .btnSubmit":"saveManualLogData","click .btnLinkBroken":"linkBroken","blur .txtMinutes":"verifyReadingTime","blur .txtHours":"verifyReadingTime"},initialize:function(e){this.studentLayerId=e.studentLayerId,this.learnEntityId=e.learnEntityId,this.title=e.title,this.url=e.url,this.on("ok",this.saveManualLogData),this.on("initialized",this.modalInitialized),this.on("cancel",this.destroy)},modalInitialized:function(e){this.modal=e,sCH.studentsC?sCH.studentsC.fill_peers({queryForStudents:!1,studentLayerId:this.studentLayerId}):(sCH.initStudents(),sCH.studentsC.fill_peers({queryForStudents:!0,studentLayerId:this.studentLayerId})),sCH.studentsC.once("sync",(function(){e.open()}),this)},render:function(){var e=this;(this.$el.html(this.template({hasPeers:sCH.studentsC.length>0})),this.selectedUserIds=[],sCH.studentsC.length>0&&s.mountReactComponent(o.default,this.$el.find("#labelsContainer")[0],{placeholder:"Start typing a peer's name...",suggestions:sCH.studentsC.toJSON().map((function(e){return{value:e.UserId,label:e.FirstName+" "+e.LastName}})),onChange:function(t){e.selectedUserIds=t.map((function(e){return e.value}))}}),window.ActivelyRead.existingRating)&&(this.$el.find(".ratingContainer span:nth-child("+window.ActivelyRead.existingRating.Rating+")").prevAll("span").addBack().removeClass("icon-star-outline").addClass("icon-star-filled"),window.ActivelyRead.existingRating.Answer&&(window.ActivelyRead.existingRating.Answer=a.sanitize(a.wrapOldTextAreaContentInPTags(window.ActivelyRead.existingRating.Answer))),this.$el.find(".txtReview").html(window.ActivelyRead.existingRating.Answer));if(!window.ActivelyRead.isReadable&&(this.$el.find(".estimateReadingTime").removeClass("displayNone"),window.ActivelyRead.existingReadingTime)){var t=window.ActivelyRead.existingReadingTime,n=Math.floor(t/3600),i=Math.floor(t%3600/60);this.$el.find(".estimateReadingTime .txtHours").val(n),this.$el.find(".estimateReadingTime .txtMinutes").val(i)}this.medium=a.initMediumEditor(this.$el.find("[contenteditable]"))},verifyReadingTime:function(){var e=a.isValidReadingTime(this.$el.find(".txtHours").val(),this.$el.find(".txtMinutes").val());e.isValid||a.bootstrap.alert({message:e.message,alert:"danger"})},starClicked:function(e){var t=$(e.currentTarget);this.$el.find(".ratingContainer span").removeClass("icon-star-filled").addClass("icon-star-outline"),t.prevAll("span").addBack().removeClass("icon-star-outline").addClass("icon-star-filled")},linkBroken:function(){var e=this;i.IRLinkBroken({learnEntityId:this.learnEntityId,title:this.title,url:this.url},(function(){a.bootstrap.alert({alert:"info",message:"Thanks for letting us know! We will remove the text ASAP."}),e.$el.find(".info").remove()}))},saveManualLogData:function(){this.modal.preventClose();var e=this.$el.find(".ratingContainer .icon-star-filled").length,t=alcfg.reviewTexts.readingLog,n=this.$el.find(".txtReview"),s=n.text().trim()?n.html():null,o=this;if(s&&0===e)a.bootstrap.alert({message:"You must give this text a star rating to leave a review!",alert:"danger"});else{var r={rating:e,question:t,answer:s,peers:this.selectedUserIds,studentLayerId:this.studentLayerId,learnEntityId:this.learnEntityId},l=this.$el.find(".txtHours").val(),d=this.$el.find(".txtMinutes").val(),c=a.isValidReadingTime(l,d);if(c.isValid){var u=a.getTimeInSeconds(l,d);this.modal.disableOk("Saving..."),!window.ActivelyRead.isReadable&&u>0&&(r.readingTime=u,r.readingDate=moment().format("YYYY-MM-DD")),i.SaveManualLogData(r,(function(){sCH.studentBookshelfC.filter({StudentLayerId:r.studentLayerId})[0].set("FinishDate",moment.utc().format("YYYY-MM-DD")),Backbone.pubEv.trigger("bookshelfSort"),a.bootstrap.alert({alert:"info",message:"All done! Your review of this text can be found in your reading log."}),o.destroy(),o.modal.close()}))}else a.bootstrap.alert({message:c.message,alert:"danger"})}},destroy:function(){a.destroyMediumEditor(this.medium),delete window.ActivelyRead.existingRating,delete window.ActivelyRead.isReadable}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="estimateReadingTime displayNone">\n    I read the article in\n    <input class="txtHours" placeholder="hrs" maxlength="2"/> hours and\n    <input class="txtMinutes" placeholder="mins" maxlength="2"/> minutes\n</div>\n\n<span>Rate:</span>\n<span class="ratingContainer">\n    <span class="icon-star-outline"></span>\n    <span class="icon-star-outline"></span>\n    <span class="icon-star-outline"></span>\n    <span class="icon-star-outline"></span>\n    <span class="icon-star-outline"></span>\n</span>\n\n',window.ActivelyRead.isReadable||(__p+='\n    <span class="info">Article not found? <a class="btnLinkBroken infoLink">Let us know.</a></span>\n'),__p+='\n\n<div contenteditable="true" class="txtReview" placeholder="What makes the text good or bad? What did you learn that was interesting or new? '+(null==(__t=bowser.mobile?"":"(Other students and your teacher will be able to read your review.)")?"":__t)+'"></div>\n\n',hasPeers&&(__p+='\n<div id="peerRecommendContainer">\n    Recommend this text to peers in your school!\n    <div id="labelsContainer"></div>\n</div>\n'),__p+="";return __p}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,r=i.length;o<r;o++,s++)a[s]=i[o];return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(5),r=n(22),l=n(1665),d=n(506),c=n(354),u=n(684),p=n(10),h=n(132),g=n(350),f=n(14),m=n(271),v=n(43),b=n(20),C=n(87),y=n(232),_=n(37);t.default=Backbone.View.extend({el:"div.independentReading .scroll",events:{"click .toggleRefine":"toggleRefine","click #selectedFacetsIR .facet":"toggleRefine","click .btnRequestText":"showRequestText","click .tile":"preview","click .btnShowMore":"facetListToggle","click .btnShowLess":"facetListToggle","click .btnClearAllFacets":"clearFacets","click .btnClearSearch":"clearEverything"},template:n(1726),facetTemplate:n(1727),facetDetailTemplate:n(1728),ratingTemplate:n(1729),initialize:function(e){var t=this;this.obj=e,p.GetUserDistrict((function(e){t.districtId=e?e.DistrictId:void 0,t.preRender()}))},preRender:function(){var e=this.obj;this.scope=e.scope,this.studentGradeLevels=e.scope.studentGradeLevels,this.isFirstPageLoad=!0,this.learnEntityId=e?e.learnEntityId:null,this.uniqueId=0,this.queryParams=e.queryParams;var t="al_ir_"+("production"===b.default.env?"prod":"staging");sCH.userM.isOnPrimePlan()||f.CovidIRStatus?this.INDEX_NAME=t+(sCH.userM.isSchoolUsingContentCredits()||f.CovidIRStatus?"_unlimited":""):this.INDEX_NAME=t+"_free",this.FACET_CONFIG=[{name:"Teacher",title:"Teacher Additions",disjunctive:!1,sortFunction:this.sortByName},{name:"Grades",title:"Grade Levels",disjunctive:!0,sortFunction:this.sortByName},{name:"Genres",title:"Topics",disjunctive:!1,sortFunction:this.sortByName},{name:"LexileAsRange",title:"Lexile Levels",disjunctive:!1,sortFunction:this.sortByName},{name:"TextType",title:"Text Type",disjunctive:!1,sortFunction:this.sortByName},{name:"AverageRating",title:"Average Rating",type:"rating",disjunctive:!1,sortFunction:this.sortByNumberDesc},{name:"PageCountBucket",title:"Page Count",disjunctive:!1,sortFunction:this.sortByNumber}],f.CovidIRStatus&&(this.FACET_CONFIG=this.FACET_CONFIG.filter((function(e){return-1===["Teacher","AverageRating"].indexOf(e.name)}))),this.districtId&&(this.FACET_CONFIG=s([{name:"DistrictIds",title:"District Assignments",disjunctive:!1,sortFunction:this.sortByName}],this.FACET_CONFIG));var n={};o.getCookie("AlgoliaBlocked")&&(n={timeout:4e3});var a=this,i=d("AM9Z6IF37B","c9b0f7f873d4a476a6a73f14eb723660",n),l={facets:$.map(this.FACET_CONFIG,(function(e){return e.disjunctive?null:e.name})),disjunctiveFacets:$.map(this.FACET_CONFIG,(function(e){return e.disjunctive?e.name:null}))};this.helper=c(i,this.INDEX_NAME,l),this.helper.on("result",(function(e,t){r.unmountAllChildReactComponentsUnderParent(a.$el),0===e.hits.length?(a.$el.find("#hits").html("<div class='ctaInfo'>We couldn't find what you were looking for!                     <a class='btn-box small marginLeft btnClearSearch'>Clear search</a></div>"),a.$el.find("#facets").css({opacity:0}),a.$el.find("#pagination").empty(),$(".sortDropdown").hide()):(a.$el.find(".ctaInfo").remove(),a.$el.find("#facets").css({opacity:1}),a.renderPagination(e),a.renderHits(e),a.renderFacets(e,t),a.scope.subheader.renderSelectedFacets(t),a.results=e.hits,a.isFirstPageLoad&&(a.generateAutocomplete(e),a.isFirstPageLoad=!1),a.learnEntityId&&(Backbone.pubEv.trigger("searchPerformed",e.hits[0].Title),a.preview(null)),0!==a.$el.scrollTop()&&a.$el.animate({scrollTop:0},"500","swing"))})),this.helper.on("error",(function(t){t.message.indexOf("Cannot connect to the AlgoliaSearch API.")>=0&&(o.setCookie("AlgoliaBlocked",!0),e.scope.renderLibrary())})),p.UserIRData({districtId:this.districtId},(function(e){a.userIRData=e,a.render()}))},setProxyOptions:function(e){o.getCookie("AlgoliaBlocked")&&(this.helper.client.hosts={read:["https://alnodeback.activelylearn.com/api/algolianode/"+this.INDEX_NAME+e+"?req="],write:[]})},defaultSearch:function(e,t){if(void 0===e&&(e=0===$(".siteSectionSearch input").val().trim().length),void 0===t&&(t=0===this.$el.find(".facet .refined").length),e&&t&&(this.defaultView=!0,this.setProxyOptions(""),this.helper.setIndex(this.INDEX_NAME),this.helper.setQueryParameter("hitsPerPage",1),$(".sortDropdown").hide()),t&&this.helper.clearRefinements(),e&&(this.helper.setQuery(""),Backbone.router.navigate("student"===sCH.userM.get("Role")?"student/catalog":"teacher/ir/catalog",{trigger:!1})),this.addSchoolIdFilter(),this.addDistrictIdFilter(),this.studentGradeLevels){var n=this;i.each(this.studentGradeLevels,(function(e){n.helper.addDisjunctiveFacetRefinement("Grades",e)}))}this.helper.search(),this.helper.setQueryParameter("hitsPerPage",30)},addSchoolIdFilter:function(){!f.CovidIRStatus&&sCH.userM.isOnPrimePlan()&&sCH.userM.getPrimarySchool()&&this.helper.addNumericRefinement("SchoolId","=",[-1].concat(sCH.userM.get("SchoolInfo").map((function(e){return e.SchoolId}))))},addDistrictIdFilter:function(){(f.CovidIRStatus||sCH.userM.isOnPrimePlan())&&this.helper.addNumericRefinement("DistrictIds","=",[-1].concat(this.districtId||[]))},render:function(){this.$el.html(this.template()),this.learnEntityId?(this.helper.setQueryParameter("restrictSearchableAttributes","LearnEntityId"),this.search(this.learnEntityId)):this.queryParams.viewdistrictassignments&&this.districtId?(this.helper.addFacetRefinement("DistrictIds",this.districtId),delete this.queryParams.viewdistrictassignments,this.helper.search(),_.replaceQueryStringParam({viewdistrictassignments:!0})):this.defaultSearch(!0,!0)},renderHits:function(e){var t=this,n=this;if(this.defaultView){if(this.studentGradeLevels){var a=i.uniq(this.studentGradeLevels.map((function(e){return"Recommended for "+f.GradeToGradeLevelMap[e]})));e.hits=this.userIRData.Homepage.filter((function(e){return-1!==a.indexOf(e.Bucket)||"Recommended from your District"===e.Bucket&&!!e.Grades.split(",").map((function(e){return f.GradeLevels.find((function(t){return t.value===parseInt(e)})).label})).find((function(e){return-1!==t.studentGradeLevels.indexOf(e.toLowerCase())}))}))}else e.hits=this.userIRData.Homepage;var s=i.groupBy(e.hits,"Bucket");i.each(s,(function(e,t){var a=$('<div class="outerContainer"></div>').appendTo(n.$el.find("#hits"))[0];r.mountReactComponent(g.default,a,{page:f.Page.IRCATALOG,bucketTitle:t,tiles:e})}))}else r.mountReactComponent(h.default,this.$el.find("#hits")[0],{page:f.Page.IRCATALOG,tiles:e.hits});v.mobile&&$("#facets").is(":visible")&&($("#facets").hide(),$("#facets + .results").show()),this.defaultView=!1},renderFacets:function(e,t){var n=this,s=[],o=this.FACET_CONFIG;t.facetsRefinements.DistrictIds&&(o=o.filter((function(e){return"Genres"!==e.name}))),o.forEach((function(i){var o=e.getFacetByName(i.name);if(o){var r={facetName:i.name,title:i.title,type:i.type,disjunctive:i.disjunctive,facetDetailTemplate:n.facetDetailTemplate,values:[]};if(n.showFacetContent(i)){for(var l in"Grades"===o.name&&n.studentGradeLevels&&(o.data=n.studentGradeLevels.reduce((function(e,t){return e[t]=o.data[t],e}),{})),o.data){var d={facetName:i.name,label:l,value:l,id:n.getUniqueId(),count:o.data[l],refinable:!0,refined:n.helper.isRefined(i.name,l),children:[]};"DistrictIds"===o.name?parseInt(l)===n.districtId&&r.values.push(a(a({},d),{label:"Your district"})):t.facetsRefinements.AverageRating&&"AverageRating"===o.name&&!n.helper.isRefined(i.name,l)||r.values.push(d)}r.values.sort(n.getFacetSortFunction(i)),n.makeFacetCollapsibleIfNecessary(r),s.push(r)}}}));var r=i.map(s,this.facetTemplate).join("");r=i.map(s,(function(e){return"rating"===e.type?n.ratingTemplate(e):n.facetTemplate(e)})).join("");this.$el.find("#facets #list").html(r)},renderPagination:function(e){var t=this.$el.find("#pagination");r.unmountReactComponent(t[0]),this.defaultView?this.$el.find("#pagination").empty():r.mountReactComponent(m.default,t[0],{currentPage:e.page,numOfPages:e.nbPages,currentPageItemsCount:e.hits&&e.hits.length?e.hits.length:0,totalItems:e.nbHits||0,showTotalRecordsCount:!0,pageChangeCallback:this.gotoPage,parentComponentReference:this})},search:function(e){if(this.helper.clearRefinements().setQuery(e),this.addSchoolIdFilter(),this.addDistrictIdFilter(),this.studentGradeLevels){var t=this;i.each(this.studentGradeLevels,(function(e){t.helper.addDisjunctiveFacetRefinement("Grades",e)}))}this.helper.search(),sCH.userM.isOnPrimePlan()&&$(".sortDropdownLibrary").show()},showFacetContent:function(e){var t=this,n=e.hide;return e.facetsToShowOn&&i.each(e.facetsToShowOn,(function(e){t.helper.isRefined(e)&&(n=!1)})),!n},toggleRefine:function(e){var t=this;e.preventDefault();var n="selectedFacetsIR"===$(e.currentTarget).parent().attr("id"),a=n?$(e.currentTarget):$(e.currentTarget).find("label");if(n&&1===$("#selectedFacetsIR .facet").length||$(e.currentTarget).find(".facetLabel").hasClass("refined")&&1===$(".facetLabel.refined").length)this.defaultSearch(void 0,!0),_.replaceQueryStringParam({});else{var s=i.filter(this.FACET_CONFIG,{facetToShowOn:a.data("facet")});if(s.length>0&&this.helper.clearRefinements(s[0].name),"DistrictIds"===a.data("facet")){var o=n||$(e.currentTarget).find("input").is(":checked")?{}:{viewdistrictassignments:!0};_.replaceQueryStringParam(o)}(isNaN(a.data("value"))?a.data("value").split(","):[a.data("value")]).forEach((function(e){t.helper.toggleRefinement(a.data("facet"),e)})),this.helper.search(),sCH.userM.isOnPrimePlan()&&$(".sortDropdownLibrary").show()}},getFacetSortFunction:function(e){var t=e.sortFunction||this.sortByCountDesc;return e.topListIfRefined&&(t=this.sortByRefined(t)),t},makeFacetCollapsibleIfNecessary:function(e){e.has_other_values=!1,"genres"!==e.facetName&&e.values.length>7&&(e.has_other_values=!0,e.values.forEach((function(e,t){t>=7&&(e.hideByDefault=!0)})))},clearFacets:function(){this.defaultSearch(void 0,!0)},clearEverything:function(){Backbone.pubEv.trigger("resetSearch")},sortByName:function(e,t){return C(e.value,t.value)},sortByLastName:function(e,t){var n=e.value.split(" ").reverse()[0],a=t.value.split(" ").reverse()[0];return n.localeCompare(a)},sortByRefined:function(e){return function(t,n){if(t.refined!==n.refined){if(t.refined)return-1;if(n.refined)return 1}return e(t,n)}},sortByNumber:function(e,t){return parseInt(e.value)-parseInt(t.value)},sortByNumberDesc:function(e,t){return parseInt(t.value)-parseInt(e.value)},getUniqueId:function(){return"uniqueId_"+ ++this.uniqueId},sort:function(e){this.setProxyOptions(e),this.helper.setIndex(this.INDEX_NAME+e).search()},facetListToggle:function(e){$(e.currentTarget).parent().children().toggle(),$(e.currentTarget).parent().siblings("ul").find(".more").toggle()},gotoPage:function(e){this.helper.setCurrentPage(e.pageNumber).search()},preview:function(e){var t=null!==e?$(e.currentTarget).data("id"):this.learnEntityId,n=new u.default(i.filter(this.results,{LearnEntityId:parseInt(t)})[0]),a="student"!==sCH.userM.get("Role"),s=window.location.origin+"/#student/catalog/"+n.get("LearnEntityId");new Backbone.BootstrapModal({content:new l.default({text:n,districtId:this.districtId,showCopyUrlBtn:a}),cancelText:"Close",okText:"Read it now!",cssClass:"modal-lg modal-al-add-to-bookshelf",optionButtons:a?[{text:"Copy link to share with students",class:"btnCopyLink"}]:[]}).$el.on("shown.bs.modal",(function(e){new y.default(".btnCopyLink",{text:function(e){return s}}).on("success",(function(){o.bootstrap.alert({message:"The assignment's link has been copied to your clipboard. "+alcfg.alertsText.copyClipboardPasteInstruction})}))})),this.learnEntityId=null,Backbone.tracking.trackGAEvent(sCH.userM.get("Role"),"addToBookshelf:start")},generateAutocomplete:function(e){var t=this,n=this,a=i.keys(i.find(e.facets,{name:"Genres"}).data),s=i.map(a,(function(e){return{subjectName:e,isUnit:!1}}));Backbone.pubEv.trigger("updateAutocompleteData",{helperText:"Or, browse by these topics",source:s.sort(),page:"IR",callback:function(e){o.viewMoreOfFacet(e,n)},clearSearch:function(){t.defaultSearch(!0,!0)}})},destroy:function(){this.$el.html(""),this.undelegateEvents(),this.helper&&(this.helper.removeAllListeners("result"),this.helper.removeAllListeners("error"))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1666);t.default=Backbone.View.extend({events:{},template:n(1668),initialize:function(e){var t=e.text,n=e.districtId;e.showCopyUrlBtn;this.on("ok",this.addBase),this.on("initialized",this.modalInitialized),this.districtId=n,this.text=t},modalInitialized:function(e){this.modal=e,this.reviewsC=new s.default([],{districtId:this.districtId}),this.reviewsC.on("sync",this.openModal,this),this.reviewsC.fill(this.text)},openModal:function(){this.modal.open()},render:function(){return this.reviewsC.length>0?sCH.userM.getPrimarySchool()?(this.schoolReviews=this.reviewsC.filter((function(e){return e.get("SchoolId")===sCH.userM.getPrimarySchool().SchoolId})),this.otherReviews=this.reviewsC.filter((function(e){return e.get("SchoolId")!==sCH.userM.getPrimarySchool().SchoolId}))):(this.schoolReviews=[],this.otherReviews=this.reviewsC.models):(this.schoolReviews=[],this.otherReviews=[]),this.setElement(this.template({text:this.text.toJSON(),schoolReviews:this.schoolReviews,otherReviews:this.otherReviews,studentCatalogTextUrl:this.studentCatalogTextUrl})),a.initTooltips(this.$el),this},addBase:function(e){var t=this;if("student"!==sCH.userM.get("Role"))if(e.preventClose(),this.text.get("IsReadable")){var n=this.text.get("LayerId");a.windowOpen("#teacher/reader/authoring/preview/"+n,"_blank")}else a.windowOpen(decodeURIComponent(this.text.get("ContentUrl")),"_blank");else e.disableOk("Adding..."),e.preventClose(),sCH.initStudentBookshelf((function(){sCH.studentBookshelfC.addLearnEntity(t.text.toJSON(),(function(e){t.text.set("InBookshelf",!0),t.modal.close();var n=t.text.get("IsReadable")?"#student/reader/ir/"+e+"/notes":decodeURIComponent(t.text.get("ContentUrl"));a.windowOpen(n,"_blank")}))}))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=n(1667);t.default=Backbone.Collection.extend({model:s.default,initialize:function(e,t){this.districtId=t.districtId},sync:a.default,fill:function(e){var t=this,n={learnEntityId:e.get("LearnEntityId")};this.districtId&&(n.districtId=this.districtId),this.fetch({url:alcfg.node.independent_reading.text_reviews,data:n,mainSuccess:function(n){n&&(t.set(n.Reviews),e.set({Description:n.Description,ContentUrl:n.ContentUrl,IsReadable:n.IsReadable,LayerId:n.LayerId}))},timerTimeout:1})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.Model.extend({defaults:function(){return{ReviewId:null,UserName:null,ImageUrl:null,SchoolId:null,SchoolName:null,Rating:"",Question:"",Answer:"",CreateDate:null,UpdateDate:null}},fixUserNameField:function(){return a.sanitize(this.get("UserName",!0))},fixAnswerField:function(){return a.sanitize(a.wrapOldTextAreaContentInPTags(this.get("Answer",!0)))},fixFirstNameField:function(){return a.sanitize(this.get("FirstName",!0))},fixLastNameField:function(){return a.sanitize(this.get("LastName",!0))},fixSchoolNameField:function(){return a.sanitize(this.get("SchoolName",!0))},fixImageUrlField:function(){return a.sanitize(this.get("ImageUrl",!0))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="catalogDetail">\r\n    <div class="baseContentDetail">\r\n        <div class="cover">\r\n            ',text.CoverArt?__p+=' \r\n                <img src="'+(null==(__t=cH.sanitize(text.CoverArt))?"":__t)+'" width="180" onerror="this.style.display=\'none\'" />\r\n            ':__p+='\r\n                <div class="watermark"/>\r\n            ',__p+='\r\n        </div>\r\n        <div class="metadata">\r\n            <div class="title">'+(null==(__t=cH.sanitize(text.Title))?"":__t)+'</div>\r\n            <div class="author">'+(null==(__t=cH.sanitize(text.Author))?"":__t)+"</div>\r\n            ",""!==text.Publisher&&(__p+='\r\n                <div class="publisher">'+(null==(__t=cH.sanitize(text.Publisher))?"":__t)+"</div>\r\n            "),__p+='\r\n\r\n            <div style="height:20px;"></div>\r\n\r\n            ',null!==text.PageCount){var pc=Math.ceil(text.PageCount);__p+='\r\n                <div class="pageCount">'+(null==(__t=pc+(pc>1?" Pages":" Page"))?"":__t)+"</div>\r\n            "}if(__p+="\r\n            ",schoolReviews.length>0||otherReviews.length>0){__p+="\r\n                ";var sum=0,combined=schoolReviews.concat(otherReviews);_.each(combined,(function(e){e.get("Rating")&&(sum+=e.get("Rating"))}));var avg=Math.round(sum/combined.length);schoolReviews=_.filter(schoolReviews,(function(e){return cH.sanitize(e.get("Answer"),[]).length>100})),otherReviews=_.filter(otherReviews,(function(e){return cH.sanitize(e.get("Answer"),[]).length>100})),__p+="\r\n                <span class='ratingContainer'>\r\n                ";for(var i=1;i<6;i++)i<=avg&&(__p+='\r\n                        <span class="icon-star-filled"></span>\r\n                    '),__p+="\r\n                ";__p+='\r\n                </span>\r\n                <span class="count">(based on '+(null==(__t=combined.length)?"":__t)+" ratings)</span>\r\n            "}__p+="\r\n\r\n            ",text.Description&&(__p+='\r\n                <div class="description">'+(null==(__t=cH.sanitize(text.Description).replace(/<br>/g,'<div class="spacer"></div>'))?"":__t)+"</div>\r\n            "),__p+='\r\n        </div>\r\n        <div class="clearBoth" style="height:20px;"></div>\r\n    </div>\r\n    <div class="layers">\r\n        ',(schoolReviews.length>0||otherReviews.length>0)&&(__p+='\r\n            <a href="#" class="btn pull-right ok" style="margin-right: -15px;">\r\n                Read it now!\r\n            </a>\r\n        '),__p+="\r\n\r\n        ",schoolReviews.length>0&&(__p+='\r\n            <div class="breaker"></div>\r\n            <div class="layersHeading">Reviews from your school</div>\r\n            <div class="breaker"></div>\r\n        ',_.each(schoolReviews,(function(e){var t=e.get("FirstName")+" "+(e.get("LastName")?e.get("LastName").substring(0,1):"");__p+='\r\n                <div class="layer">\r\n                    ',e.get("ImageUrl")?__p+='\r\n                        <div class="layerOwnerIcon image">\r\n                            '+(null==(__t=cH.generateAvatarHtml(e.get("ImageUrl")))?"":__t)+"\r\n                        </div>\r\n                    ":__p+='\r\n                        <div class="layerOwnerIcon icon-person anon avatar"></div>\r\n                    ',__p+='\r\n                    <div class="layerData">\r\n                        <div class="authorWrapper">\r\n                            <div class="author">'+(null==(__t=cH.sanitize(t))?"":__t)+'.</div>\r\n                            <div class="review">\r\n                                ';for(var n=0;n<e.get("Rating");n++)__p+='\r\n                                    <span class="icon-star-filled"></span>\r\n                                ';__p+='\r\n                            </div>\r\n                        </div>\r\n                        <div class="school">'+(null==(__t=e.get("SchoolName"))?"":__t)+'</div>\r\n                        <div class="reviewText">\r\n                            \x3c!--<div class="question">'+(null==(__t=e.get("Question"))?"":__t)+"</div>--\x3e\r\n                            "+(null==(__t=e.get("Answer").length>100?e.get("Answer"):"")?"":__t)+'\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="breaker"></div>\r\n        '}))),__p+="\r\n        ",otherReviews.length>0&&(__p+='\r\n            <div class="breaker"></div>\r\n            <div class="layersHeading">Reviews from others</div>\r\n            <div class="breaker"></div>\r\n        ',_.each(otherReviews,(function(e){var t=e.get("FirstName")?e.get("FirstName").substring(0,1)+".":"",n=e.get("LastName")?e.get("LastName").substring(0,1)+".":"";__p+='\r\n                <div class="layer">\r\n                    <div class="layerData">\r\n                        <div class="authorWrapper">\r\n                            <div class="author">'+(null==(__t=cH.sanitize(t+n))?"":__t)+'</div>\r\n                            <div class="review">\r\n                                ';for(var a=0;a<e.get("Rating");a++)__p+='\r\n                                    <span class="icon-star-filled"></span>\r\n                                ';__p+='\r\n                            </div>\r\n                        </div>\r\n                        <div class="reviewText" style="margin-left: 0px;">\r\n                            \x3c!--<div class="question">'+(null==(__t=e.get("Question"))?"":__t)+"</div>--\x3e\r\n                            "+(null==(__t=e.get("Answer").length>100?e.get("Answer"):"")?"":__t)+'\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="breaker"></div>\r\n        '}))),__p+='\r\n    </div>\r\n    <div class="clearBoth"></div>\r\n</div>\r\n'}return __p}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div id="facets">\n    <div id="list"></div>\n</div>\n<div class="results">\n    <ul id="hits" class="tiles"></ul>\n    <div class="clearBoth"></div>\n    <div id="pagination"></div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","Subjects"===facetName&&(__p+='\n    <div class="refineBy">\n        Show results for\n    </div>\n'),__p+='\n\n<div class="facet" data-facet="'+(null==(__t=facetName)?"":__t)+'">\n    ',title&&values.length&&(__p+='\n    <div class="title">\n        '+(null==(__t=cH.sanitize(title))?"":__t)+"\n        ","undefined"!=typeof helperText&&(__p+='\n            <button class="icon-question-mark-inverse" data-role="help" data-toggle="popover" data-content="'+(null==(__t=helperText)?"":__t)+'"></button>\n        '),__p+="\n    </div>\n    "),__p+="\n\n    ",values.length&&(__p+="\n        "+(null==(__t=facetDetailTemplate({values:values,facetDetailTemplate:facetDetailTemplate,expandByDefault:!0}))?"":__t)+"\n    "),__p+="\n\n    ",has_other_values&&(__p+='\n    <div class="showMoreLessLinks">\n        <span class="btnShowMore">show more</span>\n        <span class="btnShowLess">show less</span>\n    </div>\n    '),__p+="\n</div>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<ul style="'+(null==(__t=!1===expandByDefault?"display: none;":"")?"":__t)+'">\n',_.each(values,(function(e,t){__p+="\n    ",(e.refinable||e.children.length)&&(__p+='\n    <li class="toggleRefine '+(null==(__t=e.refinable?"refinable":"")?"":__t)+" "+(null==(__t=e.hideByDefault?"more":"")?"":__t)+'">\n        <div class="facetLabel '+(null==(__t=e.refinable&&e.refined?"refined":"")?"":__t)+'">\n            ',"Subjects"===e.facetName&&(__p+='\n                <span class="icon-caret-'+(null==(__t=!e.refinable&&e.expandByDefault||e.refinable&&e.children.length?"down":"right")?"":__t)+'"></span>\n            '),__p+="\n            ",e.refinable&&(__p+='\n                <input id="'+(null==(__t=e.id)?"":__t)+'" class="" data-facet="'+(null==(__t=e.facetName)?"":__t)+'" data-value="'+(null==(__t=e.value)?"":__t)+'" type="checkbox" '+(null==(__t=e.refined?"checked":"")?"":__t)+" />\n            "),__p+='\n            <label for="'+(null==(__t=e.id)?"":__t)+'" data-facet="'+(null==(__t=e.facetName)?"":__t)+'" data-value="'+(null==(__t=e.value)?"":__t)+'">\n                '+(null==(__t=e.label)?"":__t)+"\n                ",e.refinable&&!e.hideCount&&(__p+='\n                    <span class="count">('+(null==(__t=e.count)?"":__t)+")</span>\n                "),__p+="\n            </label>\n        </div>\n        ",e.children.length&&(__p+="\n            "+(null==(__t=facetDetailTemplate({values:e.children,facetDetailTemplate:facetDetailTemplate,expandByDefault:e.expandByDefault}))?"":__t)+"\n        "),__p+="\n    </li>\n    "),__p+="\n"})),__p+="\n</ul>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="facet">\n    <div class="title">'+(null==(__t=cH.sanitize(title))?"":__t)+"</div>\n    <ul>\n        ",_.each(values,(function(e,t){__p+='\n        <li class="toggleRefine refinable facetLabel '+(null==(__t=e.refined?"refined":"")?"":__t)+'">\n            <label for="'+(null==(__t=e.id)?"":__t)+'" data-facet="'+(null==(__t=e.facetName)?"":__t)+'" data-value="'+(null==(__t=e.value)?"":__t)+"\">\n                <span class='ratingContainer'>\n                    ";for(t=1;t<6;t++)t<=parseInt(e.value.split("-")[0])&&(__p+='\n                            <span class="icon-star-filled"></span>\n                        '),__p+="\n                    ";__p+='\n                </span> & up\n                <span class="count">('+(null==(__t=e.count)?"":__t)+")</span>\n            </label>\n        </li>\n        "})),__p+="\n    </ul>\n</div>";return __p}},function(e,t,n){"use strict";(function(e){var a=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=n(791),r=n(22);t.default=Backbone.View.extend({el:"div.independentReading .scroll",initialize:function(){var e=this;i.GetGenres((function(t){e.genres=t,e.render()})),Backbone.pubEv.on("ReadingLog_Refresh",this.initialize,this)},render:function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.$el.html('<div id="studentdata" class="dataWrapper"></div>').addClass("readinglog"),[4,r.mountReactComponent(o.default,this.$el.find("#studentdata")[0],{genres:this.genres,noDataMsg:alcfg.infoText.data.noReadingLogStudent,showHeading:!0})];case 1:return e.sent(),[2]}}))}))},destroy:function(){Backbone.pubEv.off("ReadingLog_Refresh"),this.$el.removeClass("readinglog")}})}).call(this,n(21))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1732),i=n(349),o=n(24),r=n(14);t.default=Backbone.View.extend({el:"div.independentReading .subheader",events:{"click .btn-tab":"subTabSelected","click .btnDeleteLayers":"startSelectMode","click .btnCancel":"cancelSelectMode","click .btnNext":"next","click .btnAddArticle":"addArticle","click .btnAddReadingLog":"addReadingLogPopup","click .rowTwo .facet":"toggleRefine","click .sortDropdown ul a":"sort"},template:n(1734),initialize:function(e){Backbone.pubEv.on("tilesSelectedLessons",this.tilesSelected,this),Backbone.pubEv.on("cancelSelectMode",this.cancelSelectMode,this),this.scope=e.scope},toggleRefine:function(e){this.scope.libraryScroll.toggleRefine(e),0!==$(".siteSectionSearch input").val().trim().length&&Backbone.pubEv.trigger("resetSearch")},renderSelectedFacets:function(e){var t="";if(e.facetsRefinements)for(var n in e.facetsRefinements)for(var s in e.facetsRefinements[n]){var i=e.facetsRefinements[n][s];"AverageRating"===n?(i=parseInt(e.facetsRefinements[n][s].split("-")[0]),t+='<a class="btn-box toggler btn-pinned-filter facet" data-facet="'+n+'" data-value="'+e.facetsRefinements[n][s]+'">'+i+(5===i?" stars":" stars & up")+'<span class="icon-cancel"></span></a>'):"DistrictIds"===n?(i="Your district",t+='<a class="btn-box toggler btn-pinned-filter facet" data-facet="'+n+'" data-value="'+e.facetsRefinements[n][s]+'">'+i+'<span class="icon-cancel"></span></a>'):t+='<a class="btn-box toggler btn-pinned-filter facet" data-facet="'+n+'" data-value="'+e.facetsRefinements[n][s]+'">'+i+'<span class="icon-cancel"></span></a>'}if(e.disjunctiveFacetsRefinements&&!this.scope.studentGradeLevels)for(var n in e.disjunctiveFacetsRefinements){var o=e.disjunctiveFacetsRefinements[n];t+='\n          <a class="btn-box toggler btn-pinned-filter facet"\n            data-facet="'+n+'"\n            data-value="'+e.disjunctiveFacetsRefinements[n]+'"\n          >\n            '+o.join('<span class="or">or</span>')+'<span class="icon-cancel"></span>\n          </a>'}""!==t?(this.$el.find("#selectedFacetsIR").html(t),this.$el.find(".rowTwo").show()):(this.$el.find("#selectedFacetsIR").html(""),this.$el.find(".rowTwo").hide()),a.adjustHeaderSpacing()},render:function(){a.renderBackboneTemplateAsync(this.el,this.template({CovidIRStatus:r.CovidIRStatus}))},addArticle:function(){delete window.addGoogleDoc,o.showModalFromBackbone(i.default,{title:"Paste the URL of the online article",okText:"Next",mode:"ir"}),Backbone.tracking.trackGAEvent("teacher","addIROnlineText:start")},addReadingLogPopup:function(){new Backbone.BootstrapModal({title:"Add Reading Log entry",content:new s.default,okText:"Add Entry",cssClass:"modal-al-add-to-readinglog",allowCancel:!1})},subTabSelected:function(e){switch($(e.currentTarget).data("subtab")){case"library":this.scope.renderLibrary();break;case"bookshelf":this.scope.renderBookshelf();break;case"readinglog":this.scope.renderReadingLog()}},tabSelectedAction:function(e){switch(this.$el.find(".tabs .btn-tab.selected").removeClass("selected"),this.$el.find('.tabs .btn-tab[data-subtab="'+e+'"]').addClass("selected"),this.$el.find(".rowTwo").show(),this.$el.find("#selectedFacetsIR").html(""),this.$el.find(".rowTwo .sortDropdownLibrary").hide(),e){case"library":this.$el.find(".rowTwo .btnAddReadingLog").hide(),this.$el.find(".rowTwo .btnDeleteLayers").hide(),this.$el.find(".rowTwo .sortDropdownBookself").hide();break;case"bookshelf":this.$el.find(".rowTwo").show(),this.$el.find(".rowTwo .btnAddReadingLog").hide(),this.$el.find(".rowTwo .btnDeleteLayers").show(),this.$el.find(".rowTwo .sortDropdownBookself").show();break;case"readinglog":this.$el.find(".rowTwo").show(),this.$el.find(".rowTwo .btnAddReadingLog").show(),this.$el.find(".rowTwo .btnDeleteLayers").hide(),this.$el.find(".rowTwo .sortDropdownBookself").hide()}},startSelectMode:function(e){var t=$(e.currentTarget).data("selectmode"),n=$(e.currentTarget).data("selecttype"),a=$(e.currentTarget).attr("class").split(/\s+/),s=a[a.length-1].replace("btn","");Backbone.pubEv.trigger("toggleSelectModeLessons",{state:"on",mode:t,action:s,type:n}),this.selectModeAction=s,this.$el.find(".selectedAction .text").text(alcfg.infoText.sresearch[s]),this.$el.find(".selectedAction").removeClass("multiple single").addClass(t).show()},sort:function(e){var t=$(e.currentTarget);$(".sortDropdown a").removeClass("selected"),t.addClass("selected"),this.scope.childViews[0].sort(t.data("sort"))},tilesSelected:function(e){e?a.enableFocusNClick(this.$el.find(".btnNext")):a.disableFocusNClick(".btnNext")},next:function(){Backbone.pubEv.trigger(this.selectModeAction)},cancelSelectMode:function(){Backbone.pubEv.trigger("toggleSelectModeLessons",{state:"off"}),this.$el.find(".selectedAction").hide(),this.$el.find(".selectedAction .text").text(""),a.disableFocusNClick(".btnNext")},destroy:function(){Backbone.pubEv.off("tilesSelectedLessons"),this.undelegateEvents()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({events:{"click .ratingContainer span":"starClicked","blur .txtMinutes":"verifyReadingTime","blur .txtHours":"verifyReadingTime"},template:n(1733),initialize:function(){this.on("ok",this.addEntry),this.on("initialized",this.modalInitialized)},modalInitialized:function(e){var t=this;this.modal=e,s.GetGenres((function(n){t.genres=n,e.open()}))},openModal:function(){this.modal.open()},render:function(){this.$el.html(this.template({genres:this.genres})),this.medium=a.initMediumEditor(this.$el.find("[contenteditable]")),this.$el.find("select").selectpicker()},starClicked:function(e){var t=$(e.currentTarget);this.$el.find(".ratingContainer span").removeClass("icon-star-filled").addClass("icon-star-outline"),t.prevAll("span").addBack().removeClass("icon-star-outline").addClass("icon-star-filled")},addEntry:function(e){e.preventClose(),this.$el.find(".flash").removeClass("flash");var t=this.$el.find(".txtTitle"),n=this.$el.find(".ddlGenres"),i=this.$el.find(".txtWebsite"),o=this.$el.find(".ratingContainer .icon-star-filled").length,r=this.$el.find(".txtReview"),l=r.text().trim()?r.html():void 0,d=this.$el.find(".txtHours").val(),c=this.$el.find(".txtMinutes").val(),u=this,p=a.isValidReadingTime(d,c);if(p.isValid){var h=a.getTimeInSeconds(d,c);if(!(a.checkRequiredFields([t])>0))if(""!==n.val()){if(l&&l.length>2048)return a.bootstrap.alert({message:"The review cannot be longer than 2048 characters!",alert:"danger"}),void r.addClass("flash");if(l&&0===o)a.bootstrap.alert({message:"You must give this text a star rating to leave a review!",alert:"danger"});else{e.disableOk("Adding...");var g={title:t.val(),genreId:n.val(),website:i.val(),rating:o,review:l,readingTime:h};s.AddReadingLog(g,(function(t){t?(Backbone.pubEv.trigger("ReadingLog_Refresh"),a.bootstrap.alert({message:"Your reading log entry has been added."}),u.destroy(),u.modal.close()):(e.enableOk("Add..."),a.bootstrap.alert({message:"There was an error adding your entry. Please try again.",alert:"danger"}))}))}}else n.addClass("flash")}else a.bootstrap.alert({message:p.message,alert:"danger"})},verifyReadingTime:function(){var e=a.isValidReadingTime(this.$el.find(".txtHours").val(),this.$el.find(".txtMinutes").val());e.isValid||a.bootstrap.alert({message:e.message,alert:"danger"})},destroy:function(){a.destroyMediumEditor(this.medium)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<label>Title</label><input class="txtTitle" maxlength="500" />\n<label>Genre</label>\n<select class="ddlGenres">\n    <option value="">Select a topic</option>\n    ',_.each(genres,(function(e){__p+='\n    <option value="'+(null==(__t=e.GenreId)?"":__t)+'">'+(null==(__t=e.GenreName)?"":__t)+"</option>\n    "})),__p+='\n</select>\n<label>Website</label><input class="txtWebsite" placeholder="(optional)" maxlength="200" />\n\n<div class="breaker"></div>\n\n<div class="readerPrompt">\n    <div class="estimateReadingTime" style="display: block;">\n        I read the article in\n        <input class="txtHours" placeholder="hrs" maxlength="2"/> hours and\n        <input class="txtMinutes" placeholder="mins" maxlength="2"/> minutes\n    </div>\n    <span>Rate:</span>\n    <span class="ratingContainer">\n        <span class="icon-star-outline"></span>\n        <span class="icon-star-outline"></span>\n        <span class="icon-star-outline"></span>\n        <span class="icon-star-outline"></span>\n        <span class="icon-star-outline"></span>\n    </span>\n    <div contenteditable="true" class="txtReview" placeholder="What makes the text good or bad? What did you learn that was interesting or new? (Other students and your teacher will be able to read your review.)"></div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","student"!==sCH.userM.get("Role")?(__p+="\n    ",sCH.userM.isOnPrimePlan()&&!CovidIRStatus&&(__p+='\n    <div class="rowOne">\n        <button class="btn-box pull-left btnAddArticle">Add Article</button>\n    </div>\n    '),__p+="\n"):__p+='\n<div class="selectedAction">\n    <div class="selectedActionInner">\n        <span class="text"></span>\n        <button class="btnNext btn-box disabled">Next</button>\n        <button class="btnCancel btn-box">Cancel</button>\n    </div>\n</div>\n<nav role="tablist" aria-label="Tabs">\n    <div class="tabs">\n        <a href="javascript:void(0)" role="tab" data-subtab="library" class="btn-tab pull-left selected">Catalog</a>\n        <a href="javascript:void(0)" role="tab" data-subtab="bookshelf" class="btn-tab pull-left">My Texts</a>\n        <a href="javascript:void(0)" role="tab" data-subtab="readinglog" class="btn-tab pull-left">Reading Log</a>\n    </div>\n</nav>\n',__p+='\n<aside class="rowTwo">\n    <button class="btn-box pull-left btnDeleteLayers" data-selectmode="multiple" data-selecttype="destructive">\n        Delete\n    </button>\n    ',CovidIRStatus||(__p+='\n        <button class="btn-box pull-left btnAddReadingLog">\n            Add Entry\n        </button>\n    '),__p+='\n    <div id="selectedFacetsIR"></div>\n    <div class="dropdown sortDropdown sortDropdownBookself">\n        <button class="btn-tab btnSorting icon-sort" role="button" data-toggle="dropdown" aria-haspopup="true"\n            aria-expanded="false"></button>\n        <ul class="dropdown-menu assess" aria-labelledby="btnSorting">\n            <li><a href="javascript:void(0)" class="selected" data-sort="recency">Recently Added</a></li>\n            <li><a href="javascript:void(0)" data-sort="title">Title</a></li>\n            <li><a href="javascript:void(0)" data-sort="author">Author</a></li>\n        </ul>\n    </div>\n    <div class="dropdown sortDropdown sortDropdownLibrary">\n        <button class="btn-tab btnSorting icon-sort" role="button" data-toggle="dropdown" aria-haspopup="true"\n            aria-expanded="false"></button>\n        <ul class="dropdown-menu assess" aria-labelledby="btnSorting">\n            <li><a href="javascript:void(0)" class="selected" data-sort="">Popularity</a></li>\n            <li><a href="javascript:void(0)" data-sort="_recency_desc">Recently Added</a></li>\n        </ul>\n    </div>\n</aside>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(71),i=n(1736),o=n(20),r=function(e){var t=e.queryString;return a.createElement("iframe",{name:"mathIFrame",className:"iframeFullScreen",src:o.default.mathIframeOrigin+"/mathreader?"+t})},l=function(e){var t=e.viewProps;return a.createElement(a.Fragment,null,a.createElement(s.default,{view:i.default,options:t,shouldNotCallRender:!0}),a.createElement("aside",{"aria-label":"assignment info popups"},a.createElement("div",{className:"progress"}),a.createElement("div",{className:"rubricContainer readerSidePopupContainer"}),a.createElement("div",{className:"modelResponsePopup readerSidePopupContainer"}),a.createElement("div",{className:"responseGradingTagsContainer readerSidePopupContainer"})))};t.default=function(e){var t=e.viewProps;return o.default.isMath?a.createElement(r,{queryString:t.queryString}):a.createElement(l,{viewProps:t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1737),s=n(1798),i=n(1803),o=n(1815),r=n(1821),l=n(1824),d=n(1901),c=n(1903);t.default=Backbone.View.extend({el:"div.reader",scrollTemplate:n(1905),initialize:function(e){var t=this;this.obj=e,$("body").addClass("pageReader"),this.render(),this.header=new a.default({settings:e,reader:this}),this.textView=this.loadTextView({settings:e,reader:this}),this.childViews=[this.header,this.textView],"grading"===sCH.readerConfig.type&&(sCH.studentsC.fill_assignment(sCH.readerConfig.assignmentId),sCH.studentsC.on("sync",(function(){t.getRightView(e.panel)}),t))},render:function(){this.$el.find(".scroll").html(this.scrollTemplate())},loadTextView:function(e){switch(e.settings.type){case"authoring":return new l.default(e);case"grading":return new d.default(e);case"tour":case"student":case"studentir":case"studentresearch":return new c.default(e)}},getRightView:function(e){"notes"===e?(this.notesView=new s.default({reader:this}),this.childViews.push(this.notesView)):"grading"===e?(this.gradingView=new i.default({reader:this}),this.childViews.push(this.gradingView)):"data"===e&&(this.dataView="grading"===sCH.readerConfig.type?new o.default({reader:this}):new r.default({reader:this}),this.childViews.push(this.dataView)),"grading"!==sCH.readerConfig.type||this.gradingView||(this.gradingView=new i.default({reader:this}),this.childViews.push(this.gradingView))},destroy:function(){$("body").removeClass("pageReader"),sCH.resetReader(),$('div[role="dialog"]').remove(),$(".lrContainer").remove()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(14),i=n(37),o=n(738),r=n(1738),l=n(85),d=n(5),c=n(22),u=n(154),p=n(820),h=n(48),g=n(10),f=n(149),m=n(1759),v=n(1760),b=n(1762),C=n(821),y=n(1786),_=n(1788),S=n(1790),w=n(739),T=n(825),I=n(487),x=n(274),k=n(522),E=n(1795),N=n(232),A=n(43),M=n(24),H=n(741);t.default=m.default.extend({el:"div.reader .header",template:n(1796),readerInfoPanelTemplate:n(1797),events:function(){var e=m.default.prototype.events;return a.isFunction(e)&&(e=e()),a.extend({},e,{"click .logoWrapper":"navigateAway","click .btnSignUp":"navigateAway","click .btnSignIn":"navigateAway","click .btnBuyLicenses":"buyLicenses","click .btnGoToEditLayer":"goToEditLayer","click .btnAssignToClasses":"assignToClasses","click .btnCustomize":"customize","click .btnDuplicate":"duplicate","click .btnEditLayer":"editLayer","click .btnGradingView":"toggleViewClicked","click .btnNotesView":"toggleViewClicked","click .btnDataView":"toggleViewClicked","click .btnExitReader":"exitReader","click .btnReaderSettingsView":"showReaderSettings","click .btnNotifications":"toggleNotifications","click .btnInviteCoauthors":"inviteCoauthors","click .btnShareLayer":"shareLayer","click .btnAddToLibrary":"addToLibrary","click .btnClearLayer":"clearLayer","click .btnDeleteSectionQuestions":"showTextSectionList","click .ddlMarkAsQuiz a:not(.selected)":"toggleMarkAsQuiz","click .ddlRandomizeQuestion a:not(.selected)":"toggleRandomizeQuestionOrder","click .btnTextError":"textError","click .btnPrintView:not(.disabled)":"printCurrentSection","click .btnHideSections":"hideSections","click .btnEditSection":"fixTextErrors","click .btnNoteSummaryView":"noteSummaryView","click .btnQuestionSummaryView":"questionSummaryView","click .btnVocabSummaryView":"vocabSummaryView","keyup .searchDropdown .bs-searchbox input":"search","click .searchDropdown .dropdown-menu.inner li.enabled":"goToMatch","click .sectionsDropdown li a.enabled:not(.selected)":"sectionSelected","click .titleContainer":"textInfo","click .pdfHint":"togglePdfHint","click .btnPlayEntireText":"playEntireText","click .btnKeyVocabHighlight":"highlightKeyVocab"})},initialize:function(e){this.settings=e.settings,this.reader=e.reader,Backbone.pubEv.on("loadSection",this.markSectionSelected,this),Backbone.pubEv.on("updateGradePanelCount",this.updateGradePanelCount,this),Backbone.pubEv.on("printCurrentSection",this.printCurrentSection,this);try{var t="student"!==sCH.userM.get("Role")&&!sCH.userM.isAnonUser()&&a.filter(sCH.classesC.models,(function(e){return"google"===e.get("Source")})).length>0;sCH.userM.get("Accounts").google&&t&&u.init(["https://www.googleapis.com/auth/classroom.courses","https://www.googleapis.com/auth/classroom.rosters","https://www.googleapis.com/auth/classroom.profile.emails","https://www.googleapis.com/auth/classroom.coursework.students","https://www.googleapis.com/auth/classroom.coursework.students.readonly"])}catch(e){console.log(e)}},render:function(){var e=this,t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");"authoring"!==sCH.readerConfig.type&&"studentir"!==sCH.readerConfig.type&&"studentresearch"!==sCH.readerConfig.type&&"tour"!==sCH.readerConfig.type&&sCH.readerConfig.Settings.Notifications&&Backbone.notificationHelper.get();var n=(sCH.learnEntityMetaM.get("LayerUserIds")||"").indexOf(sCH.userM.get("UserId"))>-1&&sCH.classesC.length>1,a=("authoring"===sCH.readerConfig.type||"grading"===sCH.readerConfig.type&&n)&&!1!==sCH.readerConfig.showAuthoringActions&&(null===sCH.learnEntityMetaM.get("RentalPrices")||!sCH.readerConfig.isReadOnly||sCH.readerConfig.layers&&sCH.readerConfig.layers.find((function(e){return"UserLayer"===e.LayerType}))&&3===sCH.readerConfig.textLicenseState)&&!sCH.userM.isAnonUser()&&(!window.isIOSApp||window.isIOSApp&&(null===sCH.learnEntityMetaM.get("RentalPrices")||sCH.userM.isSchoolUsingContentCredits())),i=sCH.readerConfig.type.indexOf("student")>-1&&!sCH.readerConfig.isPDF&&!sCH.readerConfig.isAssessment&&k.default.canPlay()&&sCH.readerConfig.Settings.AllowTextToSpeech&&!sCH.learnEntityMetaM.get("IsTextToSpeechDisabled"),o="student"===sCH.readerConfig.type&&sCH.readerConfig.keyVocabWords.length>0,r=s.CovidPaidTextsToBeMadeFree.indexOf(sCH.learnEntityMetaM.get("LearnEntityId"))>-1;this.$el.html(this.template({title:sCH.learnEntityMetaM.get("Title"),type:sCH.readerConfig.type,notifications:sCH.readerConfig.Settings.Notifications,isAssessment:sCH.readerConfig.isAssessment,isMarkedAsQuiz:sCH.learnEntityMetaM.get("IsQuiz"),randomizeQuestionOrder:sCH.learnEntityMetaM.get("RandomizeQuestionOrder"),layerTextSectionExcerptId:sCH.learnEntityMetaM.get("LayerTextSectionExcerptId"),isPDF:sCH.readerConfig.isPDF,metadata:sCH.learnEntityMetaM.toJSON(),host:t,isReadOnly:sCH.readerConfig.isReadOnly,isLocked:sCH.readerConfig.assignmentLocked,futureLockState:sCH.readerConfig.futureLockState,isFeedbackEnabled:sCH.readerConfig.feedbackEnabled,sections:sCH.learnEntitySectionsMetaC.toJSON(),currentSectionId:sCH.readerConfig.currentSectionId,showAssign:a,summaryViewsButtonOptions:this.getSummaryViewsButtonOptions(),printButtonState:this.getPrintButtonState(),showPlayEntireTextButton:i,showKeyVocabOption:o,assignedClasses:sCH.readerConfig.assignedClasses,currentClassId:sCH.learnEntityMetaM.get("ClassId"),isGoogleSection:d.isGoogleSection(),canEditSectionText:"authoring"===sCH.readerConfig.type&&null===sCH.learnEntityMetaM.get("RentalPrices")&&!sCH.readerConfig.isReadOnly&&!sCH.readerConfig.isPDF&&(d.isGoogleSection()&&"AddFromGoogleDoc"===sCH.learnEntityMetaM.get("LayerSource")||alcfg.contentTeamUserIds.indexOf(sCH.userM.get("UserId"))>-1),smallGroupPeers:sCH.readerConfig.type&&sCH.readerConfig.smallGroupName?sCH.getSmallGroupPeersName():"",isTextToBeMadeFreeDuringCovid:r})),"grading"===sCH.readerConfig.type?(sCH.readerConfig.isAssessment&&$(".textview .btnGradingView").css("display","block"),this.updateGradePanelCount()):"authoring"===sCH.readerConfig.type&&this.$el.addClass("authoring"),sCH.readerConfig.isPDF&&(this.pdf=new b.default,$(".lrContainer").removeClass("on"));var l=this.$el.find(".ddlSearchResults");l.selectpicker({title:"Search text",noneResultsText:"",liveSearchPlaceholder:"Start typing to search..."}),l.on("hidden.bs.select",(function(e){l.next().find("ul.dropdown-menu.inner").empty()})),l.next().addClass("hideToggle");var c=sCH.learnEntityMetaM.get("RentalPrices")?"Search this section":"Search";l.next().prepend('<button class="btn-tab icon-search btnStartSearch" data-toggle="dropdown" title="'+c+'"></button>'),d.initTooltips(this.$el),(d.onDevice()&&90!==Math.abs(window.orientation)||sCH.readerConfig.isPDF)&&$(".btnNotesView").removeClass("selected");var u=this;$(window).on("orientationchange",(function(){u.fromOrientationChange=!0,90===Math.abs(window.orientation)?0==u.$el.find(".textview a.selected").length&&u.toggleNotesView(!1):$(".textview > .btnNotesView.selected, .textview > .btnGradingView.selected, .textview > .btnDataView.selected").click(),u.fromOrientationChange=!1,$(".btnNotesView, .btnGradingView, .btnDataView").removeClass("selected"),Backbone.pubEv.trigger("updateMargin")})),A.mobile&&(this.$el.find(".dropdown-submenu").on("click",(function(e){$(e.target).hasClass("moreOptionSubmenu")&&e.stopPropagation()})),setTimeout((function(){0===e.$el.find(".btnMoreActionsDropdown li").filter((function(){return"none"!==$(this).css("display")})).length&&e.$el.find(".moreActionsDropdown").hide()}),0)),this.$el.find("button, a").on("click mouseout",(function(e){setTimeout((function(){return $(e.target).tooltip("hide")}),0)})),d.adjustHeaderSpacing()},getSummaryViewsButtonOptions:function(){try{var e=[],t=sCH.readerConfig.keyVocabularyWords&&sCH.readerConfig.keyVocabularyWords.length>0;return sCH.readerConfig.isAssessment||"studentresearch"===sCH.readerConfig.type?"studentresearch"===sCH.readerConfig.type&&(e=["Notes"]):e=["Notes","Questions"],"authoring"!==sCH.readerConfig.type&&"grading"!==sCH.readerConfig.type||!t||sCH.readerConfig.isAssessment||e.push("Vocab"),e}catch(e){return[]}},getPrintButtonState:function(){var e={visible:!0,buttonClass:"",buttonHint:"Print",notAllowedByPublisher:sCH.learnEntityMetaM.get("IsPrintDisabled")},t="student"!==sCH.userM.get("Role")&&sCH.userM.isOnFreePlan();return(e.notAllowedByPublisher||t)&&(e.buttonClass="disabled"),e.notAllowedByPublisher?e.buttonHint="Publisher does not allow print for this text":t&&(e.buttonHint="Print is available only on the Premium plan"),sCH.userM.isAnonUser()||sCH.readerConfig.isMedia?e.visible=!1:"student"!==sCH.readerConfig.type&&"studentir"!==sCH.readerConfig.type||"student"!==sCH.userM.get("Role")?"grading"===sCH.readerConfig.type&&sCH.readerConfig.isAssessment&&(e.visible=!1):e.visible=!sCH.readerConfig.isAccessExpired&&d.isClassTeacherOnPersonalOrHigherPlan(sCH.learnEntityMetaM.get("ClassId")),e},sectionSelected:function(e){this.$el.find(".sectionsDropdown").find("a").removeClass("selected");var t=$(e.currentTarget);t.addClass("selected"),Backbone.pubEv.trigger("skipToSection",parseInt(t.parent().data("textsectionid")))},markSectionSelected:function(){this.$el.find(".sectionsDropdown").find("a").removeClass("selected"),this.$el.find('.sectionsDropdown li[data-textsectionid="'+sCH.readerConfig.currentSectionId+'"]').find("a").addClass("selected")},showReaderSettings:function(){new Backbone.BootstrapModal({content:new v.default,cssClass:"modal-sm readerSettings",cancelText:!1,okText:"Close",handleAppClick:!0,optionButtons:[{class:"btnRestoreDefaults",event:"restoreDefaults",text:"Restore Defaults"}]}).open()},getUngradedResponsesCount:function(){var e=0;return a.each(Object.keys(sCH.readerConfig.ungradedResponseIds),(function(t){e+=sCH.readerConfig.ungradedResponseIds[t].length})),e},updateGradePanelCount:function(){var e=this.getUngradedResponsesCount();e>0?(this.$el.find(".btnGradingView .notificationCount").text(e).show(),this.$el.find(".textview .btnGradingView").prop("title","Grading (#ungraded)").tooltip("destroy")):(this.$el.find(".btnGradingView .notificationCount").text("").hide(),this.$el.find(".textview .btnGradingView").prop("title","Grading").tooltip("destroy")),d.initTooltips(this.$el)},changeView:function(e){var t=$(".btn"+d.capitalizeString(e||"")+"View");$(".reader .readerSidePopupContainer:visible").length>0&&$(".reader .readerSidePopupContainer .close").click(),t.hasClass("selected")?((d.onDevice()&&90===Math.abs(window.orientation)||A.mobile||!d.onDevice())&&($(".reader").removeClass("fixedView"),this.pdf||$(".reader .lrContainer").addClass("on"),$(".reader").hasClass("questionblock")&&($(".reader .scroll").scrollTop(0),t.hasClass("btnDataView")||$(".reader .scroll .textview").scrollTop(0)),t.hasClass("btnGradingView")||t.hasClass("btnDataView")?($(".reader").removeClass("notesPanelOpen"),$(".reader").addClass("fixedView"),this.pdf||$(".reader .lrContainer").removeClass("on"),$(".layout > .scroll .lrContainer > .left > .textview").scrollTop($(".textSectionContainer").height()*this.notesScrollPosition||0)):$(".layout > .scroll").scrollTop($(".textSectionContainer").height()*this.notesScrollPosition||0)),this.pdf&&this.pdf.adjustLayout()):this.pdf&&this.pdf.adjustLayout()},toggleViewClicked:function(e){$(".reader .subheader").addClass("displayNone"),this.toggleView($(e.target).data("panel")||$(e.target.parentElement).data("panel")),sCH.readerConfig.popUpsWrapperController&&sCH.readerConfig.popUpsWrapperController.popupAddTagV&&sCH.readerConfig.popUpsWrapperController.popupAddTagV.destroyOpenPopups(),Backbone.pubEv.trigger("rightPanelToggled")},toggleView:function(e,t){-1===$.inArray(e,["notes","grading","data"])?(this.toggleNotesView(t),this.changeView("notes")):(this["toggle"+d.capitalizeString(e)+"View"](t),this.changeView(e))},toggleNotesView:function(e){if($(".progress").show(),this.cacheNotesScrollPosition(),A.mobile||!d.onDevice()||90===Math.abs(window.orientation)||this.fromOrientationChange)if(sCH.readerConfig.isPDF);else{if(void 0!==e?e:!this.$el.find(".textview > .btnNotesView").hasClass("selected")){var t=window.location.href.split("?")[1],n=t?"/notes/?"+t:"/notes";Backbone.router.navigate(i.getPathNameWithoutHash(d.getReaderBaseUrl()+n),{trigger:!1}),this.reader.notesView?this.reader.notesView.preRender():(this.reader.getRightView("notes"),Backbone.pubEv.trigger("rerenderStudentNoteCounts")),$(".btnGradingView, .btnDataView").removeClass("selected"),$(".gradingview, .dataview").hide(),$(".btnNotesView").addClass("selected"),$(".notesview").show(),setTimeout((function(){return $(".reader .lrContainer > div.left").css("transition","width .5s ease, max-width .5s ease")}),500),Backbone.pubEv.trigger("updateMargin"),$(".reader").addClass("notesPanelOpen")}else Backbone.router.navigate(i.getPathNameWithoutHash(d.getReaderBaseUrl()),{trigger:!1}),$(".btnNotesView").removeClass("selected"),$(".reader").removeClass("notesPanelOpen")}else d.bootstrap.alert({message:"Turn your device to landscape mode to view notes.",alert:"info"});$(".addNote.bottom").length&&$(".addNote.bottom").css({left:$(".scroll .textSectionContainer").offset().left}),$(".fullNote.bottom").length&&$(".fullNote.bottom").css({left:$(".scroll .textSectionContainer").offset().left}),$(".fullNote:not(.bottom)").length&&Backbone.pubEv.trigger("popupFullNoteHide")},toggleGradingView:function(e){if($(".progress").hide(),this.cacheNotesScrollPosition(),A.mobile||!d.onDevice()||90===Math.abs(window.orientation)||this.fromOrientationChange)if((void 0!==e?e:!this.$el.find(".textview > .btnGradingView").hasClass("selected"))||this.getUngradedResponsesCount()&&(!d.onDevice()||0!=window.orientation)){var t=window.location.href.split("?")[1],n=t?"/grading/?"+t:"/grading";Backbone.router.navigate(i.getPathNameWithoutHash(d.getReaderBaseUrl()+n),{trigger:!1}),this.reader.gradingView||this.reader.getRightView("grading"),this.reader.gradingView.preRender(),$(".btnNotesView, .btnDataView").removeClass("selected"),$(".btnGradingView").addClass("selected"),sCH.readerConfig.isPDF?$(".scroll .notesview, .dataview").hide():$(".notesview, .dataview").hide(),$(".gradingview").show()}else Backbone.router.navigate(i.getPathNameWithoutHash(d.getReaderBaseUrl()),{trigger:!1}),$(".btnGradingView").removeClass("selected"),$(".gradingview").hide(),$(".reader").removeClass("fixedView"),this.pdf||$(".reader .lrContainer").addClass("on"),$(".layout > .scroll").scrollTop($(".textSectionContainer").height()*this.notesScrollPosition||0);else d.bootstrap.alert({message:"Turn your device to landscape mode to view grading.",alert:"info"});$(".fullNote.bottom").length&&$(".fullNote.bottom").css({left:$(".scroll .textSectionContainer").offset().left}),$(".fullNote:not(.bottom)").length&&Backbone.pubEv.trigger("popupFullNoteHide")},toggleDataView:function(e){if($(".progress").hide(),this.cacheNotesScrollPosition(),A.mobile||!d.onDevice()||90===Math.abs(window.orientation)||this.fromOrientationChange)if(void 0!==e?e:!this.$el.find(".textview > .btnDataView").hasClass("selected")){var t=window.location.href.split("?")[1],n=t?"/data/?"+t:"/data";Backbone.router.navigate(i.getPathNameWithoutHash(d.getReaderBaseUrl()+n),{trigger:!1}),this.reader.dataView||this.reader.getRightView("data"),this.reader.dataView.preRender(!1),$(".btnNotesView, .btnGradingView").removeClass("selected"),$(".btnDataView").addClass("selected"),sCH.readerConfig.isPDF?$(".scroll .notesview, .gradingview").hide():$(".notesview, .gradingview").hide(),$(".dataview").show()}else Backbone.router.navigate(i.getPathNameWithoutHash(d.getReaderBaseUrl()),{trigger:!1}),$(".btnDataView").removeClass("selected"),$(".reader .scroll .textview").scrollTop(0),$(".dataview").hide(),$(".reader").removeClass("fixedView"),this.pdf||$(".reader .lrContainer").addClass("on"),$(".layout > .scroll").scrollTop($(".textSectionContainer").height()*this.notesScrollPosition||0);else d.bootstrap.alert({message:"Turn your device to landscape mode to view data.",alert:"info"});$(".addNote.bottom").length&&$(".addNote.bottom").css({left:$(".scroll .textSectionContainer").offset().left}),$(".fullNote.bottom").length&&$(".fullNote.bottom").css({left:$(".scroll .textSectionContainer").offset().left}),$(".addNote:not(.bottom)").length&&Backbone.pubEv.trigger("popupAddNoteHide"),$(".fullNote:not(.bottom)").length&&Backbone.pubEv.trigger("popupFullNoteHide")},cacheNotesScrollPosition:function(){var e=$(".reader").hasClass("fixedView")?$(".layout > .scroll .lrContainer > .left > .textview"):$(".layout > .scroll");this.notesScrollPosition=e.scrollTop()/$(".textSectionContainer").height()},toggleNotifications:function(e){""===this.$el.find(".btnNotifications .container").html()?Backbone.notificationHelper.show():Backbone.notificationHelper.hide(),e.stopPropagation()},togglePdfHint:function(e){this.pdf.togglePdfHint(),e.stopPropagation()},exitStudentReader:function(){function e(){sCH.learnEntityMetaM&&(window.location.hash=sCH.lastAccessedPreReaderUrl||d.getReaderExitUrl(),sCH.lastAccessedPreReaderUrl=null)}f.check((function(t){t?new Backbone.BootstrapModal({content:"Are you sure you want to exit? Since you are offline,             if you leave this assignment you will not be able to re-enter the assignment until you reconnect.",cancelText:"Cancel",okText:"Exit",cssClass:"modal-lg",title:"Exit Reader"}).open((function(){e()})):e()}))},exitReader:function(){if("student"===sCH.readerConfig.type)this.exitStudentReader();else{if(["authoring","grading"].indexOf(sCH.readerConfig.type)>-1)return void(sCH.lastAccessedPreReaderUrl?(window.location.hash=sCH.lastAccessedPreReaderUrl,sCH.lastAccessedPreReaderUrl=null):window.location.hash=d.getReaderExitUrl());window.location.hash=d.getReaderExitUrl()}},search:function(e){var t=this,n=$(e.currentTarget).val().trim();3===n.length&&-1!==["the","are","who","can","any"].indexOf(n)&&(n=""),n.length>2&&(this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){p.search(n,(function(e){if(""!==e)t.$el.find(".searchDropdown ul.dropdown-menu.inner").html(e);else{var n=sCH.learnEntityMetaM.get("RentalPrices")?"No results in this section!":"No results!";t.$el.find(".searchDropdown ul.dropdown-menu.inner").html("<li><a>"+n+"</a></li>")}}))}),250))},goToMatch:function(e){p.goToMatch(e),$(".ddlSearchResults").removeClass("open").find("ul.dropdown-menu.inner").empty()},textInfo:function(e){var t="grading"===sCH.readerConfig.type?window.location.href.substring(0,window.location.href.indexOf("#"))+"#student/reader/"+sCH.readerConfig.assignmentId+(sCH.readerConfig.isAssessment?"":"/notes"):"",n=new Backbone.BootstrapModal({cancelText:!1,okText:"Done",content:this.readerInfoPanelTemplate({metadata:sCH.learnEntityMetaM.toJSON(),standards:sCH.userM.get("IsHigherEd")?[]:function(){var e={},t=[];return a.each(sCH.questionsNumC.models,(function(t){var n=t.get("StandardId")||"";n in e?e[n]++:e[n]=1})),a.keys(e).sort(),a.each(a.keys,(function(n){if(""!==n){var a=d.getStandardById(parseInt(n));t.push({code:a.StandardCode,shortText:a.ShortText,count:e[n]})}})),t}(),type:sCH.readerConfig.type,isResearch:"student"===sCH.userM.get("Role")&&("studentresearch"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type),studentUrlLink:t}),cssClass:"modal-lg readerInfoPopup"}).open();n.on("shown",(function(){new N.default(".baseContentDetail .btnCopyLink").on("success",(function(){d.bootstrap.alert({message:"The assignment's link has been copied to your clipboard. "+alcfg.alertsText.copyClipboardPasteInstruction})})),d.initTooltips(n.$el),window.setTimeout((function(){gapi.sharetoclassroom&&gapi.sharetoclassroom.go(".gShare")}),1e3)}))},noteSummaryView:function(e){Backbone.pubEv.trigger("popupAddNoteHide"),Backbone.pubEv.trigger("popupFullNoteHide"),new Backbone.BootstrapModal({title:"Notes summary",content:new C.default,cssClass:"modal-al-note-summary",cancelText:!1,allowCancel:!0,okText:"Close"})},questionSummaryView:function(e){Backbone.pubEv.trigger("popupAddNoteHide"),Backbone.pubEv.trigger("popupFullNoteHide"),new Backbone.BootstrapModal({title:"Questions summary",content:new y.default,cssClass:"modal-al-question-summary "+sCH.readerConfig.TextSettings.readerBackground,cancelText:!1,allowCancel:!0,okText:"Close"})},vocabSummaryView:function(e){Backbone.pubEv.trigger("popupAddNoteHide"),Backbone.pubEv.trigger("popupFullNoteHide"),new Backbone.BootstrapModal({title:"Key vocabulary",content:new _.default,cssClass:"modal-al-vocab-summary",cancelText:!1,allowCancel:!0,okText:"Close",optionButtons:[{text:"Learn more",event:"learnMore"}]}).open()},highlightKeyVocab:function(e){var t=$(e.currentTarget);t.toggleClass("selected"),t.hasClass("selected")?Backbone.pubEv.trigger("highlightKeyVocabWords",{shouldAvoidAlert:!1}):d.clearWrapOnElement("keyVocabHighlight")},showTextSectionList:function(){new Backbone.BootstrapModal({title:"Remove questions by section",content:new T.default({type:"deletesectionquestions",layerId:sCH.readerConfig.layerId,textSections:sCH.learnEntitySectionsMetaC.getValidSectionsJson()}),okText:"Remove questions",cssClass:"modal-lg modal-al-remove-questions"}).open()},clearLayer:function(){new Backbone.BootstrapModal({title:"Remove all questions and notes?",content:alcfg.confirmsText.layerDelete,cssClass:"modal-al-remove-questions-notes",okText:"Remove all"}).open((function(){var e=this;e.preventClose(),e.disableOk("Removing..."),g.ClearLayer(sCH.readerConfig.layerId,(function(){e.close(),window.location.reload(!0)}))}))},toggleMarkAsQuiz:function(e){var t=this;new Backbone.BootstrapModal({title:sCH.learnEntityMetaM.get("IsQuiz")?"Un-mark assignment as quiz?":"Mark assignment as quiz?",content:sCH.learnEntityMetaM.get("IsQuiz")?alcfg.confirmsText.unmarkLayerAsQuiz:alcfg.confirmsText.layerAsQuiz}).open((function(){var n=this;n.preventClose(),n.disableOk("Saving..."),g.ToggleLayerAsQuiz({layerId:sCH.readerConfig.layerId},(function(a){n.close(),a?(d.bootstrap.alert({message:sCH.learnEntityMetaM.get("IsQuiz")?"The assignment is not a quiz anymore.":"The assignment has been marked as a quiz."}),sCH.learnEntityMetaM.set("IsQuiz",!sCH.learnEntityMetaM.get("IsQuiz")),t.$el.find(".ddlMarkAsQuiz a").removeClass("selected"),$(e.currentTarget).addClass("selected")):d.bootstrap.alert({message:"There was an error. Please try again.",alert:"danger"})}))}))},toggleRandomizeQuestionOrder:function(e){var t=this;if(sCH.userM.isOnFreePlan())h.showBuyTeacherPopup({title:"Randomize order of questions"});else{var n={popupTitle:sCH.learnEntityMetaM.get("RandomizeQuestionOrder")?"Do not randomize questions for students?":"Randomize questions for students?",popupOkText:sCH.learnEntityMetaM.get("RandomizeQuestionOrder")?"Do not randomize":"Randomize",successMessage:sCH.learnEntityMetaM.get("RandomizeQuestionOrder")?"Students will see the questions in the same order.":"Students will see the questions in random order."};new Backbone.BootstrapModal({title:n.popupTitle,content:"",okText:n.popupOkText}).open((function(){var a=this;a.preventClose(),a.disableOk("Saving..."),g.ToggleRandomizeQuestionOrder({layerId:sCH.readerConfig.layerId,learnEntityId:sCH.learnEntityMetaM.get("LearnEntityId"),randomizeOrder:!sCH.learnEntityMetaM.get("RandomizeQuestionOrder"),readerType:sCH.readerConfig.type},(function(s){a.close(),s?(d.bootstrap.alert({message:n.successMessage}),sCH.learnEntityMetaM.set("RandomizeQuestionOrder",!sCH.learnEntityMetaM.get("RandomizeQuestionOrder")),t.$el.find(".ddlRandomizeQuestion a").removeClass("selected"),$(e.currentTarget).addClass("selected"),sCH.learnEntityMetaM.get("RandomizeQuestionOrder")?t.$el.parent().find(".questionTagOrder").addClass("displayNone"):t.$el.parent().find(".questionTagOrder").removeClass("displayNone")):d.bootstrap.alert({message:"There was an error. Please try again.",alert:"danger"})}))}))}},textError:function(){var e=sCH.readerConfig.feedbackEnabled?"<p>See a problem with your imported text? Let us know what went wrong so we can improve text imports!</p>"+(sCH.readerConfig.isPDF?'<span class="info">If you need to rotate your PDF, go to <a href="http://www.rotatepdf.eu" target="_blank">www.rotatepdf.eu</a>, rotate and save the PDF, and then re-upload.</span>':"")+'<textarea placeholder="Please provide details of the issue you see (e.g. words or certain parts missing, poor formatting, etc.)"></textarea>':'<p>Seeing an issue with the text? Let us know what went wrong, and our team will review it.</p>        <select><option>Typo</option><option>Formatting</option><option>Miscategorized</option><option>Other</option>        <textarea placeholder="Please provide details of the issue you see (e.g. words or certain parts missing, poor formatting, etc.)"></textarea>',t=new Backbone.BootstrapModal({title:"Report text error",content:e,cssClass:"feedbackModal",okText:"Submit"}).open((function(){g.SubmitFeedbackForLayer({type:sCH.readerConfig.feedbackEnabled?"error":t.$content.find("select").val(),textEntered:t.$content.find("textarea").val(),layerId:sCH.learnEntityMetaM.get("LayerId"),textSectionId:sCH.readerConfig.currentSectionId},(function(){d.bootstrap.alert({message:alcfg.infoText.catalog.feedbackSubmit,alert:"info"})}))}))},buyLicenses:function(e){new Backbone.BootstrapModal({title:sCH.learnEntityMetaM.get("Title"),content:new x.default({textM:sCH.learnEntityMetaM.toJSON(),source:s.LearnEntityPurchaseSource.PREVIEW_READER,isRedirectToAssignAfterBuying:sCH.userM.isOnPrimeUnlimited()&&"Assign"===$(e.currentTarget).text()}),okText:sCH.userM.isSchoolUsingContentCredits()?"Continue":"Rent",cssClass:"modal-lg modal-al-payment-form",allowCancel:!1}).open()},goToEditLayer:function(){var e="#teacher/reader/authoring/"+sCH.readerConfig.layerId+(sCH.readerConfig.isAssessment?"":"/notes");d.openReaderUrl(e)},assignToClasses:function(){var e={LearnEntityId:sCH.learnEntityMetaM.get("LearnEntityId"),LayerId:sCH.learnEntityMetaM.get("LayerId"),IsUserLayer:!sCH.readerConfig.isReadOnly,NewLayerSource:sCH.readerConfig.isReadOnly?sCH.readerConfig.isInLibrary?"AddFromSchoolLibrary":"AddFromCatalog":void 0,Title:sCH.learnEntityMetaM.get("Title"),Publisher:sCH.learnEntityMetaM.get("Publisher"),RentalPrices:sCH.learnEntityMetaM.get("RentalPrices"),IsLearnEntityPurchased:!sCH.readerConfig.isReadOnly,Territories:sCH.learnEntityMetaM.get("Territories")};I.default.showCreateFirstClassPopup((function(){I.default.showAssignLayerPopup(e)}))},addToWorkspace:function(e){g.AddToWorkspace({copyLayerId:sCH.readerConfig.layerId,isAddingFromSchoolLibrary:!!sCH.readerConfig.isInLibrary},(function(t){e(t)}))},customize:function(){this.addToWorkspace((function(e){d.intercom("trackEvent","customize-catalog-text"),window.location.hash="#teacher/reader/authoring/"+e.layerId+"/notes"}))},createNewLayer:function(e){sCH.readerConfig.isReadOnly?this.addToWorkspace((function(t){var n="#teacher/reader/authoring/"+t.layerId+"/notes";e({layerId:t.layerId,redirectUrl:n})})):e({})},duplicate:function(e){var t=parseInt($(e.currentTarget).data("layerid"));new Backbone.BootstrapModal({title:"Add labels to duplicate assignment",content:new r.default({existingLabels:[],isDuplicating:!0,callback:function(e,n){n.preventClose(),n.disableOk("Saving..."),g.DuplicateLayer({layerId:t,labels:e},(function(e){n.close(),e&&(d.bootstrap.alert({message:"Successfully duplicated assignment!"}),window.setTimeout((function(){var t=sCH.readerConfig.isAssessment?"":"/notes";window.location.hash="#teacher/reader/authoring/"+e.newLayerId+t}),1e3))}))}}),cssClass:"modal-al-duplicate",okText:"Duplicate"}).open()},editLayer:function(e){var t=parseInt($(e.currentTarget).data("layerid")),n=sCH.readerConfig.layers.find((function(e){return e.LayerId===t})),a=this,s=sCH.readerConfig.layerCoauthorNameMap.find((function(e){return e.LayerId===t&&e.UserId!==sCH.userM.get("UserId")})),i=s&&s.LayerAuthorUserId===sCH.userM.get("UserId");new Backbone.BootstrapModal({title:"Edit assignment details",content:new r.default({existingLabels:n.Labels,callback:function(a,s){s.preventClose(),s.disableOk("Saving..."),g.UpdateLayerLabels({layerId:t,labels:a},(function(i){n.Labels=a;var o=d.getUserLayerTitle(a);$(e.currentTarget).prev().text(o),sCH.readerConfig.layerId===t&&$("#lblCurrentLayerTitle").text(d.truncate(o,30)),s.close(),i&&d.bootstrap.alert({message:"Successfully updated!"})}))}}),cssClass:"modal-al-edit-labels",okText:"Save",optionButtons:!s||i?[{text:"Delete assignment",event:"onLayerDeleted"}]:[]}).open().on("onLayerDeleted",(function(){M.showModalFromBackbone(o.default,{selectedLayer:n,coauthorFirstAdded:s,okCallback:function(){g.DeleteLayer(t,(function(e){e?sCH.readerConfig.layerId===t?a.exitReader():window.location.reload():(d.bootstrap.alert({message:e.Message||"Something went wrong. Please try again.",alert:"danger"}),M.hideModals())}))}})}))},inviteCoauthors:function(){sCH.userM.isOnFreeOrPersonalPlan()?h.showBuyTeacherPopup({title:"Co-Authoring",content:alcfg.popupsText.workspace.coAuthorNoAccess}):this.createNewLayer((function(e){var t=e.layerId,n=e.redirectUrl;M.showModalFromBackbone(S.default,{title:"Invite colleagues to co-author",allowCancel:!1,okText:"Invite",cssClass:"coauthors",layerId:t||sCH.readerConfig.layerId,redirectUrl:n})}))},shareLayer:function(){this.createNewLayer((function(e){var t=e.layerId,n=e.redirectUrl;M.showModalFromBackbone(w.default,{title:"Send a copy of the assignments to colleagues",layerId:t||sCH.readerConfig.layerId,redirectUrl:n,okText:"Send"})}))},addToLibrary:function(){this.createNewLayer((function(e){var t=e.layerId,n=e.redirectUrl;M.showModalFromBackbone(H.default,{title:"Add to "+sCH.userM.getLibraryString()+"?",layerId:t||sCH.readerConfig.layerId,coAuthoredLayerTitleList:[],redirectUrl:n,layers:sCH.readerConfig.layers,successCallback:function(){sCH.readerConfig.isInLibrary=!0},okText:"Add"})}))},printCurrentSection:function(){if(sCH.userM.isOnFreePlan()&&"student"!==sCH.userM.get("Role"))h.showBuyTeacherPopup({title:"Printing"});else if(sCH.readerConfig.isPDF)new Backbone.BootstrapModal({title:"Printing PDFs",content:"<p>PDF printing is currently not supported in Actively Learn.</p><p>To print the text of the PDF, open the original PDF file using Adobe Reader (Windows) or Preview (Mac) and select File -> Print.</p><p>To print the notes or questions, go to the Notes List or Question List and click the print button there.</p>",cssClass:"modal-al-printing-pdfs",cancelText:!1,okText:"Close"}).open();else{var e=$(".noteTagContainer .extraHelpIconContainer:not(.displayNone)").length>0;if(-1!==["authoring","grading"].indexOf(sCH.readerConfig.type)&&e){var t=this,n=new Backbone.BootstrapModal({title:"Print Extra Help Notes?",content:"<p>This assignment has extra help notes. Do you want to print them?</p>",cssClass:"modal-al-printing-extrahelp-notes",cancelText:"No",okText:"Yes",allowCancel:!1}).open((function(){n.close(),t.printExtraNotes=!0}));n.on("cancel",(function(e){n.close(),t.printExtraNotes=!1})),n.once("hidden",(function(e){t.prepareAndPrint(t.printExtraNotes)}))}else this.prepareAndPrint(!0)}},prepareAndPrint:function(e){if("student"===sCH.readerConfig.type){var t=$(".scroll .textview .textGatingGate").css("height");$(".scroll .textview .textGatingGate").css("height","auto")}var n=$(".reader .noteTagContainer");if(n.length>0){var s=$("<div>").attr("id","footnotesContainer").html("<h3>Notes</h3>"),i=n.clone().removeAttr("style").css("position","relative"),o=0;i=i.sort((function(e,t){return $(e).data("startindex")-$(t).data("startindex")})),a.each(i,(function(t){var n=$(t),a=parseInt(n.data("tagid")),i=0===n.find(".extraHelpIconContainer:not(.displayNone)").length;if(e||i){if(o++,$('.notesTag[data-tagid="'+a+'"]:last').after($('<span class="superscript">'+o+"</span>")),"Me"===n.find(".username").text()){var r=sCH.userM.get("FirstName")+" "+sCH.userM.get("LastName");"student"!==sCH.userM.get("Role")&&(r=(sCH.userM.get("Title")||"")+" "+sCH.userM.get("LastName")),n.find(".username").text(d.sanitize(r))}var l=d.getNoteTagModel(a);l&&(n.find(".videoPlayButton").length>0||n.find(".linkThumbnail").length>0)&&n.find(".noteTagHtml").html('<div class="printVideoContainer"><span class="printVideoThumbnail icon-play"/>'+l.get("HTML")+"</div>");var c=$("<div>").addClass("noteSuperContainer").html($("<p>"+o+"</p>")).append(t);s.append(c)}else $('.notesTag[data-tagid="'+a+'"]').addClass("hideHighlightDuringPrint")})),$(".textSectionContainer").append(s)}var r=$("figure.video iframe, .embedMediaFullContainer iframe");r.length>0&&a.each(r,(function(e){var t=$(e).attr("src");t&&($(e).hide(),$(e).parent().append('<div class="printVideoContainer"><span class="printVideoThumbnail icon-play"/><span>'+t+"</span></div>").addClass("printEmbedded"))}));var l=$(".questionTagViewMode:not(.multichoice)");if("grading"!==sCH.readerConfig.type){l.each((function(e,t){for(var n="",a=0;a<5;a++)n+='<div class="line"/>';$(t).append(n)}))}function c(){n.length>0&&($("#footnotesContainer").remove(),$(".superscript").remove(),$(".hideHighlightDuringPrint").removeClass("hideHighlightDuringPrint")),"student"===sCH.readerConfig.type&&$(".scroll .textview .textGatingGate").css("height",t),r.length>0&&(r.show().parent().removeClass("printEmbedded"),$(".printVideoContainer").remove()),l.length>0&&l.find(".line").remove()}(d.print(sCH.learnEntityMetaM.get("Title")),A.safari&&window.matchMedia)?window.matchMedia("print").addListener((function(e){e.matches||c()})):c()},hideSections:function(){sCH.userM.isOnFreePlan()?h.showBuyTeacherPopup({title:"Hide text sections"}):g.GetSectionsWithStudentData({layerId:sCH.readerConfig.layerId},(function(e){var t=a.extend({},sCH.learnEntitySectionsMetaC.toJSON());e.length>0&&a.each(t,(function(t){t.HasStudentData=!!a.find(e,{TextSectionId:t.TextSectionId})})),new Backbone.BootstrapModal({title:"Hide text sections",content:new T.default({type:"hidesections",layerId:sCH.readerConfig.layerId,textSections:t}),okText:"Hide sections",cssClass:"modal-lg modal-al-hide-sections"}).open()}))},fixTextErrors:function(){if(sCH.userM.isOnFreePlan())h.showBuyTeacherPopup({title:"Fix Text Errors"});else{var e=this.$el.find("div.editTextBarContainer");c.mountReactComponent(E.default,e[0],{}),sCH.readerConfig.editTextMode=!0}},playEntireText:function(e){Backbone.pubEv.trigger("playEntireTextTriggered")},navigateAway:function(e){var t=$(e.currentTarget).data("destination"),n="https://www.activelylearn.com",a="teacher%2Freader%2Fauthoring%2Fpreview%2F"+sCH.readerConfig.layerId+"%2Fnotes#/";switch(t){case"signup":n="/account.html?furl="+a+"signup/educator/step1",l.destroyAppInitDataAndRedirect({source:"publicassignment signup",forwardURL:n});break;case"signin":n="/account.html?furl="+a,l.destroyAppInitDataAndRedirect({source:"publicassignment signin",forwardURL:n});break;default:window.location.href=n}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(22),i=n(1739);t.default=Backbone.View.extend({initialize:function(e){this.on("ok",this.addLabels),this.labels=e.existingLabels,this.isDuplicating=!!e.isDuplicating,this.callback=e.callback},render:function(){this.$el.html('<p>Start typing and press Enter to create a new label (upto 25 characters). <p class="info">Note: these labels will be visible to students.</p></p>\n      <div id="labelsContainer"></div>');var e=this;s.mountReactComponent(i.default,this.$el.find("#labelsContainer")[0],{defaultValue:this.labels,blurBehavior:"ignore",fullWidth:!0,onChange:function(t){e.labels=t},inputRef:function(e){e&&e.setAttribute("maxlength",25)},classes:{}})},addLabels:function(e){e.preventClose();var t=e.$el.find("input").val().trim().substring(0,25);t.length>0&&this.labels.push(t),0===this.labels.length&&this.isDuplicating?a.bootstrap.alert({message:"Please enter a label!",alert:"danger"}):this.callback(this.labels,e)},destroy:function(){}})},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({events:{"click .helpDropdown li":"help","click .btnNotifications":"toggleNotifications"},initialize:function(){},help:function(e){switch($(e.currentTarget).data("action")){case"helpCenter":a.windowOpen("http://help.activelylearn.com","_blank");break;case"overviewVideos":a.windowOpen("https://www.activelylearn.com/resources-1","_blank");break;case"whatsNew":a.windowOpen(alcfg.helpArticleLink.whatsNew,"_blank")}},toggleNotifications:function(e){Backbone.notificationHelper.toggle()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10);t.default=Backbone.View.extend({template:n(1761),events:{"click .spacing .toggleButton":"changeSpacing","change .font select":"changeFont","click .fontSize .toggleButton":"changeFontSize","click .theme .toggleButton":"changeTheme","click .paraNum .toggleButton":"changeParagraphNumbering","click .readableFont":"toggleReadableFont","click .readerBackground":"changeReaderBackground","click .dyslexicDefaults a":"setDyslexicDefaults"},initialize:function(){this.on("restoreDefaults",this.restoreDefaults)},render:function(){this.$el.html(this.template({type:sCH.readerConfig.type,isGoogleSection:a.isGoogleSection()})),this.settings=sCH.readerConfig.TextSettings,this.$el.find(".fontSize .toggleButton."+this.settings.fontSize).addClass("selected"),this.$el.find(".font select").val(this.settings.font),this.$el.find('.spacing .toggleButton[data-spacing="'+this.settings.spacing+'"]').addClass("selected"),this.$el.find(".paraNum .toggleButton."+this.settings.paraNum).addClass("selected"),"themeBlack"==this.settings.theme?this.$el.find("#chkReaderBgBlack").prop("checked",!0):this.$el.find("#chkReader"+(this.settings.readerBackground?this.settings.readerBackground.charAt(0).toUpperCase()+this.settings.readerBackground.slice(1):"BgWhite")).prop("checked",!0),this.$el.find("select").selectpicker(),a.initHelpPopover(this.$el)},setDyslexicDefaults:function(e){if(this.$el.find(".fontSize .fontLarge").click(),this.$el.find(".font select").val("dyslexic").change().selectpicker("val","dyslexic"),this.$el.find('.spacing .toggleButton[data-spacing="most"]').click(),this.$el.find("label.brown").click(),!sCH.readerConfig.isReadOnly&&sCH.userM.showPopup("DyslexicInfo")&&("authoring"===sCH.readerConfig.type||sCH.userM.get("IsMappedToTeacher")))new Backbone.BootstrapModal({title:"Dyslexic settings",content:'<p>Dyslexic settings have been enabled. Font, margins, spacing, text size and background have been         updated to increase readability. You can turn it off by clicking on the "RESTORE DEFAULTS" button.</p>        <p>Students can also access these settings the same way.</p>',allowCancel:!1,cancelText:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){a.updateDoNotShowPopupSetting("DyslexicInfo")}))},restoreDefaults:function(e){this.$el.find(".fontSize .fontMedium").click(),this.$el.find(".font select").val("serif").change().selectpicker("val","serif"),this.$el.find('.spacing .toggleButton[data-spacing="less"]').click(),this.$el.find("label.white").click()},changeSpacing:function(e){var t,n,i,o=$(e.currentTarget);if(!o.hasClass("selected")){if(n=o.data("spacing"),t=Math.abs(a.scrollElement().scrollTop()),i=$(".textSectionContainer").height(),this.$el.find(".spacing .toggleButton.selected").removeClass("selected"),o.addClass("selected"),this.settings.spacing=n,$(".reader, .popUpsWrapper").removeClass("lessSpacing moreSpacing mostSpacing").addClass(n+"Spacing"),s.UpdateReaderSettings(this.settings),a.overrideGoogleDocCSSWithTextSettings(),Backbone.pubEv.trigger("updateMargin"),t>0){var r=t*($(".textSectionContainer").height()/i);a.scrollElement().scrollTop(r)}a.updatePinnedQuestionWidth()}},changeFont:function(e){var t,n,i,o=$(e.currentTarget);if(!o.hasClass("selected")){if(n=o.val(),t=Math.abs(a.scrollElement().scrollTop()),i=$(".textSectionContainer").height(),this.settings.font=n,$(".reader, .popUpsWrapper").removeClass("serifFont helveticaFont helveticaetFont dyslexicFont").addClass(n+"Font"),s.UpdateReaderSettings(this.settings),Backbone.pubEv.trigger("updateMargin"),t>0){var r=t*($(".textSectionContainer").height()/i);a.scrollElement().scrollTop(r)}a.overrideGoogleDocCSSWithTextSettings()}},changeFontSize:function(e){var t,n,i,o=$(e.currentTarget);if(!o.hasClass("selected")){if(n=o.data("fontsize"),t=Math.abs(a.scrollElement().scrollTop()),i=$(".textSectionContainer").height(),this.$el.find(".fontSize .toggleButton.selected").removeClass("selected"),o.addClass("selected"),this.settings.fontSize=n,$(".reader, .popUpsWrapper").removeClass("fontSmall fontMedium fontLarge").addClass(n),s.UpdateReaderSettings(this.settings),Backbone.pubEv.trigger("updateMargin"),t>0){var r=t*($(".textSectionContainer").height()/i);a.scrollElement().scrollTop(r)}a.overrideGoogleDocCSSWithTextSettings()}},changeTheme:function(e){var t,n=$(e.currentTarget);this.$el.find(".theme").hasClass("disabled")||$(n).hasClass("selected")||(t=n.data("theme"),this.$el.find(".theme .toggleButton.selected").removeClass("selected"),n.addClass("selected"),this.settings.theme=t,$(".reader, .popUpsWrapper").removeClass("themeWhite themeBlack").addClass(t),s.UpdateReaderSettings(this.settings),a.overrideGoogleDocCSSWithTextSettings())},changeParagraphNumbering:function(e){var t,n=$(e.currentTarget);$(n).hasClass("selected")||(t=n.data("paranum"),this.$el.find(".paraNum .toggleButton.selected").removeClass("selected"),n.addClass("selected"),this.settings.paraNum=t,"on"===t?$(".reader, .popUpsWrapper").addClass("paraNum"):$(".reader, .popUpsWrapper").removeClass("paraNum"),s.UpdateReaderSettings(this.settings))},changeReaderBackground:function(e){var t=$(e.currentTarget),n=t.attr("class").split(/\s+/).filter((function(e){return-1!=="white black brown green pink mdBrown mdGreen mdTeal mdDeepPurple mdIndigo mdLightGreen mdDeepOrange mdPink mdAmber".indexOf(e)})).pop();if(t.hasClass("selected"))return!1;if($(".reader").removeClass("bgWhite bgBrown bgGreen bgPink mdBrown mdGreen mdTeal mdDeepPurple mdIndigo mdLightGreen mdDeepOrange mdPink mdAmber"),this.$el.find(".textBackground input:checked").prop("checked",!1),t.prop("checked",!0),this.$el.find(".readerBackground").removeClass("selected"),t.addClass("selected"),"white"===n||"black"===n)$(".reader, .popUpsWrapper").addClass("bgWhite"),this.settings.readerBackground="bgWhite";else if("md"===n.substr(0,2))$(".reader, .popUpsWrapper").addClass(n),this.settings.readerBackground=n;else{var i="bg"+a.capitalizeString(n);$(".reader, .popUpsWrapper").addClass(i),this.settings.readerBackground=i}this.settings.theme=t.hasClass("black")?"themeBlack":"themeWhite",$(".reader, .popUpsWrapper").removeClass("themeWhite themeBlack").addClass(this.settings.theme),s.UpdateReaderSettings(this.settings),a.overrideGoogleDocCSSWithTextSettings()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","grading"!==sCH.readerConfig.type&&(__p+='\r\n<div class="spacing">\r\n    <h3>\r\n        Margin and Spacing\r\n        <button class="icon-question-mark-inverse" data-role="help" data-html="true" data-placement="bottom" data-toggle="popover" data-content="Margin and Spacing in particular - but also text size and font - can affect how quickly and fluently you read. <br /><br />Experiment to find a combination that works well for you."></button>\r\n    </h3>\r\n    <div class="toggleButton icon-spacing-normal" data-spacing="less"></div><div class="toggleButton icon-spacing-more" data-spacing="more"></div><div class="toggleButton icon-spacing-most" data-spacing="most"></div>\r\n</div>\r\n'),__p+='\r\n<div class="fontSize">\r\n    <h3>Text size\r\n    </h3>\r\n    <div class="toggleButton fontSmall" data-fontsize="fontSmall"></div><div class="toggleButton fontMedium" data-fontsize="fontMedium"></div><div class="toggleButton fontLarge" data-fontsize="fontLarge"></div>\r\n</div>\r\n<div class="font">\r\n    <h3>\r\n        Font\r\n    </h3>\r\n    <select>\r\n        <option value="serif" data-content="<span class=\''+(null==(__t=isGoogleSection?"googleDefaultFont":"serif")?"":__t)+"'>"+(null==(__t=isGoogleSection?"Google Doc Default":"Tisa")?"":__t)+'</span>" >'+(null==(__t=isGoogleSection?"Google Doc Default":"Tisa")?"":__t)+'</option>\r\n        <option value="helveticaet" data-content="<span class=\'helveticaet\'>Helvetica</span>" >Helvetica</option>\r\n        <option value="dyslexic" data-content="<span class=\'dyslexic\'>Open Dyslexic</span>" >Open Dyslexic</option>\r\n    </select>\r\n</div>\r\n',"grading"!==sCH.readerConfig.type&&(__p+='\r\n<div class="textBackground">\r\n    <h3>Theme</h3>\r\n    <input id="chkReaderBgWhite" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderBgWhite" class="readerBackground white"></label>\r\n    <input id="chkReaderBgBlack" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderBgBlack" class="readerBackground black"></label>\r\n    <input id="chkReaderBgBrown" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderBgBrown" class="readerBackground brown"></label>\r\n    <input id="chkReaderBgGreen" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderBgGreen" class="readerBackground green"></label>\r\n    <input id="chkReaderBgPink" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderBgPink" class="readerBackground pink"></label>\r\n    <input id="chkReaderMdGreen" type="checkbox"class="regular-checkbox"></input>\r\n    <label for="chkReaderMdGreen" class="readerBackground mdGreen"></label>\r\n    <input id="chkReaderMdDeepPurple" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdDeepPurple" class="readerBackground mdDeepPurple"></label>\r\n    <input id="chkReaderMdBrown" type="checkbox"class="regular-checkbox"></input>\r\n    <label for="chkReaderMdBrown" class="readerBackground mdBrown"></label>\r\n    <input id="chkReaderMdIndigo" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdIndigo" class="readerBackground mdIndigo"></label>\r\n    <input id="chkReaderMdPink" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdPink" class="readerBackground mdPink"></label>\r\n\x3c!--\r\n    <input id="chkReaderMdDeepOrange" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdDeepOrange" class="readerBackground mdDeepOrange"></label>\r\n    <input id="chkReaderMdBrown" type="checkbox"class="regular-checkbox"></input>\r\n    <label for="chkReaderMDBrown" class="readerBackground mdBrown"></label>\r\n    <input id="chkReaderMdTeal" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdTeal" class="readerBackground mdTeal"></label>\r\n    <input id="chkReaderMdLightGreen" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdLightGreen" class="readerBackground mdLightGreen"></label>\r\n    <input id="chkReaderMdAmber" type="checkbox" class="regular-checkbox"></input>\r\n    <label for="chkReaderMdAmber" class="readerBackground mdAmber"></label>\r\n--\x3e\r\n</div>\r\n<div class="clearBoth"></div>\r\n'),__p+='\r\n\r\n<div class="paraNum">\r\n    <h3>Paragraph Numbering</h3>\r\n    <div class="toggleButton on" data-paranum="on">On</div><div class="toggleButton off" data-paranum="off">Off</div>\r\n</div>\r\n\r\n',"grading"!==sCH.readerConfig.type&&(__p+='\r\n<div class="dyslexicDefaults">\r\n    <a class="btn-box">Use dyslexic settings</a>\r\n</div>\r\n'),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8),i=n(149),o=n(685);t.default=Backbone.View.extend({el:"div.reader .header .pdfContainer",template:n(1763),events:{"click .zoom div":"changeZoom","click .btnPdfNext:not(.disabled)":"loadNextPage","click .btnPdfPrevious:not(.disabled)":"loadPreviousPage","blur .txtCurrentPageNum":"loadPageByNum","keypress .txtCurrentPageNum":"loadPageByNumEnter"},initialize:function(){this.learnEntitySectionsMetaC=this.getAssignedSections(),this.render()},render:function(){this.$el.html(this.template({sections:sCH.learnEntitySectionsMetaC.toJSON(),currentSectionId:sCH.readerConfig.currentSectionId}))},getAssignedSections:function(){var e=sCH.learnEntityMetaM.get("AssignedTextSectionIds");if(e&&e.length>0){var t=sCH.learnEntitySectionsMetaC.toJSON().filter((function(t){return e.includes(t.TextSectionId)})),n=new o.default;return n.initWithData(t),n}return sCH.learnEntitySectionsMetaC},handlePdfNavigation:function(e){var t=this.learnEntitySectionsMetaC.filter({TextSectionId:sCH.readerConfig.currentSectionId})[0];this.$el.find(".btnPdfNext, .btnPdfPrevious").removeClass("disabled"),this.$el.find(".txtCurrentPageNum").val(t.get("SectionNum")),this.instructionsView&&(this.instructionsView.close(!1),this.instructionsView.$el.hide()),t.get("SectionNum")===this.getFirstSectionNum()&&a.disableFocusNClick(".btnPdfPrevious"),t.get("SectionNum")===this.getLastSectionNum()&&a.disableFocusNClick(".btnPdfNext"),!1!==e&&Backbone.pubEv.trigger("skipToSection",sCH.readerConfig.currentSectionId)},getLastSectionNum:function(){return s.maxBy(this.learnEntitySectionsMetaC.toJSON(),"SectionNum").SectionNum},getFirstSectionNum:function(){return s.minBy(this.learnEntitySectionsMetaC.toJSON(),"SectionNum").SectionNum},changeZoom:function(e){var t="resized"!==e?$(e.currentTarget).hasClass("zoomIn"):null;!0===t?Backbone.pubEv.trigger("pdfZoomChange",{scaleChange:.1}):!1===t&&Backbone.pubEv.trigger("pdfZoomChange",{scaleChange:-.1})},loadPreviousPage:function(){var e=this;Backbone.pubEv.trigger("loadingShowHide",!0),i.check((function(t){if(t)i.startReconnectCheck();else{var n=e.learnEntitySectionsMetaC.getPrevSectionId(sCH.readerConfig.currentSectionId);n&&(sCH.readerConfig.currentSectionId=n,e.clickedPrev=!0,e.handlePdfNavigation())}}))},loadNextPage:function(){var e=this;i.check((function(t){if(t)i.startReconnectCheck();else{if(!e.checkPageAvailable())return;Backbone.pubEv.trigger("loadingShowHide",!0);var n=e.learnEntitySectionsMetaC.getNextSectionId(sCH.readerConfig.currentSectionId);n&&(sCH.readerConfig.currentSectionId=n,e.clickedPrev=!1,e.handlePdfNavigation())}}))},loadPageByNumEnter:function(e){this.clickedPrev=!1,13===e.which&&$(e.currentTarget).blur()},loadPageByNum:function(e){var t=this;i.check((function(e){if(e)i.startReconnectCheck();else{var n=parseInt(t.$el.find(".txtCurrentPageNum").val()),s=n!==parseInt(n+"",10);if(!s){if(!t.checkPageAvailable(n))return;var o=t.learnEntitySectionsMetaC.filter({SectionNum:n});if(0!==o.length){if(sCH.readerConfig.currentSectionId===o[0].get("TextSectionId"))return;Backbone.pubEv.trigger("loadingShowHide",!0),sCH.readerConfig.currentSectionId=o[0].get("TextSectionId"),t.handlePdfNavigation()}else s=!0}if(s){var r=t.learnEntitySectionsMetaC.filter({TextSectionId:sCH.readerConfig.currentSectionId})[0].get("SectionNum");t.$el.find(".txtCurrentPageNum").val(r),a.bootstrap.alert({message:sCH.learnEntitySectionsMetaC.find({SectionNum:n})?"Page number "+n+" is not assigned.":"Please enter a valid page number.",alert:"danger"})}}}))},checkPageAvailable:function(e){if("student"!==sCH.readerConfig.type||!sCH.readerConfig.Settings.QuestionGates)return!0;var t=!0,n=sCH.questionsNumC.getFirstNotAnsweredQuestion();if(n)if(e||n.TextSectionId!==sCH.readerConfig.currentSectionId){var s=sCH.learnEntitySectionsMetaC.filter({TextSectionId:n.TextSectionId});e&&s[0].get("SectionNum")<e&&(t=!1)}else t=!1;if(!t){a.bootstrap.alert({message:"You must answer questions before you can access that page.",alert:"warning"});var i=this.learnEntitySectionsMetaC.filter({TextSectionId:sCH.readerConfig.currentSectionId})[0].get("SectionNum");this.$el.find(".txtCurrentPageNum").val(i)}return t},adjustLayout:function(){},togglePdfHint:function(){var e="";e="student"===sCH.readerConfig.type?"In a PDF, you will notice a few differences. Page navigation is in the header. Questions are always at the bottom of pages.                 Highlights need to be selected to see notes (there is no notes panel).":"grading"===sCH.readerConfig.type?"In most PDFs, you can add notes, then select highlights to view the note popup. Questions will only appear at the end of each page.":'In order to preserve the format of the different PDFs that you upload, you can only add questions to the end of each page                 by clicking on the "Add question(s) to end of page" button. Also, for most PDFs you will still be able to embed notes directly into the text.';var t="PDF formatting information";new Backbone.BootstrapModal({title:t,content:e,okText:"Got it!",cancelText:!1,optionButtons:[{class:"pull-left btnHelpArticle",text:"Details",event:"openHelpArticle"}]}).open().on("openHelpArticle",(function(){a.windowOpen(alcfg.buyTeacherPopupHelpArticleLinks[t],"_blank")}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var selectedPageNum=_.filter(sections,{TextSectionId:currentSectionId})[0].SectionNum;sections.length>1&&(__p+='\n    <a class="btnPdfPrevious icon-arrowup '+(null==(__t=1===selectedPageNum?"disabled":"")?"":__t)+'"></a>\n    <a class="btnPdfNext icon-arrowdown '+(null==(__t=selectedPageNum===sections.length?"disabled":"")?"":__t)+'"></a>\n\n    <span class="pdfPageNav">\n        <input class="txtCurrentPageNum" value="'+(null==(__t=selectedPageNum)?"":__t)+'" /> of '+(null==(__t=sections.length)?"":__t)+"\n    </span>\n"),__p+='\n<div class="zoom">\n    <div class="zoomOut icon-zoomout" data-zoom="out"></div>\n    <div class="zoomIn icon-zoomin" data-zoom="in"></div>\n</div>'}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(518),o=n(1766),r=n(520),l=n(1773),d=n(1776),c=n(1777),u=n(1778),p=n(1779),h=n(1780),g=n(1781),f=n(1783),m=n(148);t.default=Backbone.View.extend({initialize:function(e){this.element=e.element,this.notesView=e.notesView,this.tagListMode=sCH.readerConfig.isAssessment||e.tagListMode,this.render()},render:function(){try{if(!(this.tagListMode||(sCH.readerConfig.isPDF&&(this.element=$(".react-pdf__Page__textContent")),this.tagListMode||-1===this.model.get("StartIndex")||"marker"===this.model.get("Type")&&4===this.model.get("SubType")))){var e="marker"===this.model.get("Type")&&2===this.model.get("SubType");this.range=m.restoreSelection(this.element[0],this.model.get("StartIndex"),this.model.get("EndIndex"),s.getTextNodes(this.element[0],e))}switch(this.model.get("Type")){case"question":this.question();break;case"note":(this.tagListMode||this.model.get("Visible"))&&(this.model.get("AssignmentId")?this.studentNote():this.note());break;case"marker":switch(this.model.get("SubType")){case 5:this.whiteoutVideo();break;case 4:this.whiteoutMedia();break;case 3:this.hyperlink();break;case 2:this.whiteout();break;case 1:this.model.get("Visible")&&this.flag()}break;case"searchResult":this.searchResult();break;case"textSelectionHandles":this.textSelectionHandles();break;case"keyVocab":this.highlightKeyVocab();break;case"teachingIdeas":this.renderTeachingIdeas()}}catch(e){"student"===sCH.readerConfig.type&&"question"===this.model.get("Type")&&"Cannot read property 'collapse' of undefined"===e.message&&sCH.questionsNumC.filter({QuestionTagId:this.model.get("TagId")})[0].set("AnsweredByCurrentUser",!0),console.log(e)}},question:function(){var e=this.model.get("TagId")||Math.floor(100*Math.random()),t=$("<div></div>").html('<div id="tag'+e+'" class="teacherQuestion"></div>');switch(sCH.readerConfig.type){case"authoring":this.currView=new i.default({model:this.model,element:this.element,tagListMode:this.tagListMode});break;case"grading":this.currView=new o.default({model:this.model,element:this.element,tagListMode:this.tagListMode});break;case"student":case"tour":case"studentir":this.currView=new r.default({model:this.model,element:this.element,tagListMode:this.tagListMode})}var n=this.currView.render();if(this.tagListMode)this.element.append(n),sCH.readerConfig.isAssessment||this.element.append('<a class="btn-box small pull-right btnViewInReader" title="View in text" data-tagid="'+this.model.get("TagId")+'">View in text</a>').append('<div class="clearBoth" style="height:10px;"></div>');else{if(-1===this.model.get("StartIndex"))return-1===this.model.get("EndIndex")?$(".preReadingQuestion").append(n):$(".endSectionQuestions").append(n);this.range=this.range[this.range.length-1],m.embed(this.range,t[0],e),window.questionNodes.push({questionTagId:e,endIndex:this.model.get("EndIndex"),html:s.onDevice()?n.css({display:"inline-block",width:"100%"}):n})}return this.element},hyperlink:function(){for(var e=0;e<this.range.length;e++)this.currView=new c.default({model:this.model}),this.range[e].surroundContents(this.currView.render())},whiteoutMedia:function(){if(this.model.get("Text")){this.currView=new p.default({model:this.model,showEraserIcon:!0,imageSrc:this.model.get("Text")});var e=this.currView.render(),t=$(this.element[0]).find('img[src="'+this.model.get("Text")+'"]')[this.model.get("StartIndex")];this.currView.$el=$(t).wrap(e).parent(),s.initTooltips(this.currView.$el.parent())}},whiteoutVideo:function(){var e=$(this.element[0]).find('figure.video iframe[src="'+this.model.get("Text")+'"]')[this.model.get("StartIndex")];this.currView=new h.default({model:this.model});var t=this.currView.render();$(e).closest("figure.video").addClass("whiteoutVideo").next(".btnWhiteoutVideo").addClass("displayNone"),this.currView.$el=$(e).wrap(t).parent(),s.initTooltips(this.currView.$el.parent())},whiteout:function(){for(var e,t="",n=!0,i=0;i<this.range.length;i++)if(this.range[i].mediaNode){this.currView=new p.default({model:this.model,showEraserIcon:!1});var o=this.currView.render();this.currView.$el=$(this.range[i].mediaNode).wrap(o).parent()}else{this.currView=new u.default({model:this.model,showEraserIcon:n});o=this.currView.render();"authoring"===sCH.readerConfig.type&&n&&(e=$(o),n=!1),this.range[i].surroundContents(o),t+=s.eStringToString(this.currView.$el.text());var r=["STRONG","EM","B","U","I","LI","A","IMG","FIGURE","IFRAME","SPAN"];[$(o).parent(),$(o).parent().parent()].every((function(e){if(-1===r.indexOf(e[0].tagName))return!1;return 0===a.filter(e[0].childNodes,(function(e){return(3!=e.nodeType||0!=e.textContent.trim().length)&&(!$(e).hasClass("whiteout")&&!$(e).hasClass("whiteoutParagraph"))})).length&&e.addClass("whiteoutParagraph"),!0}));var l=$(o).closest("p, blockquote, h1, h2");if(l.length>0){var d=l.clone();d.find(".whiteout, .whiteoutParagraph, br, div.pnum, abbr.padRight:empty, abbr.padLeft:empty").remove(),d.find(".embeddedLink:empty").remove(),0==a.filter(d[0].childNodes,(function(e){return!(3==e.nodeType&&0==e.textContent.trim().length)})).length&&(l.addClass("whiteoutParagraph"),e&&l.addClass("authoring"))}}e&&(e.data("highlightedtext",t).closest(".whiteoutParagraph").addClass("authoring").parent(".whiteoutParagraph").addClass("authoring"),e.attr("title",t.length>200?t.substr(0,200)+"...":t),s.initTooltips(e.parent()))},flag:function(){this.currView=new g.default({model:this.model,element:this.element}),this.range=this.range[0],this.range.surroundContents(this.currView.render()),this.currView.showFlag()},note:function(){if(this.currView=new l.default({model:this.model,element:this.element,tagListMode:this.tagListMode}),this.tagListMode){var e=this.currView.render();return this.element.append(e)}this.range[0].surroundContents(this.currView.render(this.notesView));for(var t=1;t<this.range.length;t++)$(this.range[t].commonAncestorContainer).hasClass("whiteout")||this.range[t].surroundContents(this.currView.renderHighlightSegment())},studentNote:function(){if(this.currView=new d.default({model:this.model,element:this.element,tagListMode:this.tagListMode}),this.tagListMode){var e=this.currView.render();return this.element.append(e)}this.model.get("IsAssociatedNote")?this.currView.render(this.notesView):this.range[0].surroundContents(this.currView.render(this.notesView));for(var t=1;t<this.range.length;t++)$(this.range[t].commonAncestorContainer).hasClass("whiteout")||this.range[t].surroundContents(this.currView.renderHighlightSegment())},searchResult:function(){for(var e=0;e<this.range.length;e++)this.range[e].surroundContents($("<span class='inTextSearchResult'></span>")[0])},textSelectionHandles:function(){for(var e=0;e<this.range.length;e++)this.range[e].surroundContents($("<span class='textSelectionHandles'></span>")[0])},highlightKeyVocab:function(){for(var e='data-startindex="'+this.model.get("StartIndex")+'" data-endindex="'+this.model.get("EndIndex")+'"',t=0;t<this.range.length;t++)this.range[t].surroundContents($("<span class='keyVocabHighlight' "+e+"></span>")[0])},renderTeachingIdeas:function(){this.currView=new f.default(this.model.get("TeachingIdeas")).render(this.notesView)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var ts=(new Date).getTime();null===SubType&&(SubType=1),__p+='\r\n\r\n<div class="questionTagEditMode">\r\n    <div>\r\n        ',sCH.readerConfig.isPDF||tagListMode||(__p+='\r\n            <div class="icon-pin btnPin clickable" title="Toggle question pinning" data-placement="left"></div>\r\n        '),__p+='\r\n        <div class="label">\r\n            <input id="rdbShortAnswer_'+(null==(__t=ts)?"":__t)+'" class="regular-radio" data-subtype="1" name="subtype_'+(null==(__t=ts)?"":__t)+'" type="radio" ',print(1===SubType?'checked="checked"':""),__p+=' /><label for="rdbShortAnswer_'+(null==(__t=ts)?"":__t)+'"></label>Short Answer\r\n        </div>\r\n        <div class="label">\r\n            <input id="rdbMultipleChoice_'+(null==(__t=ts)?"":__t)+'" class="regular-radio" data-subtype="2" name="subtype_'+(null==(__t=ts)?"":__t)+'" type="radio" ',print(2===SubType?'checked="checked"':""),__p+=' /><label for="rdbMultipleChoice_'+(null==(__t=ts)?"":__t)+'"></label>Multiple Choice\r\n        </div>\r\n        <div class="label" style="margin-right:0;">\r\n            <input id="rdbPoll_'+(null==(__t=ts)?"":__t)+'" class="regular-radio" data-subtype="3" name="subtype_'+(null==(__t=ts)?"":__t)+'" type="radio" ',print(3===SubType?'checked="checked"':""),__p+='/><label for="rdbPoll_'+(null==(__t=ts)?"":__t)+'"></label>Poll\r\n        </div>\r\n        <div class="clearBoth"></div>\r\n    </div>\r\n    <div class="clearBoth"></div>\r\n    <div class="ccDetail dokContainer ',print(showDok?"":"displayNone"),__p+='">\r\n        <select class="ddlDok">\r\n            <option value="">Select a Depth of Knowledge level</option>\r\n            ',_.each(alcfg.tags.question.dok,(function(e){__p+='\r\n                <option value="'+(null==(__t=e.id)?"":__t)+'" ',print(e.id===Dok?"selected":""),__p+=">"+(null==(__t=e.text)?"":__t)+"</option>\r\n            "})),__p+='\r\n        </select>\r\n        <span class="extraHelpContainer nextToSomething">\r\n            <a class="btnDoKLearnMore"\r\n                title="'+(null==(__t=alcfg.infoText.catalog.DokTitle)?"":__t)+'"\r\n                href="'+(null==(__t=alcfg.helpArticleLink.addDok)?"":__t)+'"\r\n                data-container="body"\r\n                data-placement="top">?</a>\r\n        </span>\r\n    </div>\r\n    <div class="ccDetail firstStandardContainer">\r\n        <select class="ddlCCStandardIds" data-live-search="true" data-previous="'+(null==(__t=StandardId)?"":__t)+'"></select>\r\n        <div class="clearBoth"></div>\r\n        <div class="questionCCStandardDescription marginTop"></div>\r\n    </div>\r\n\r\n    <div class="ccDetail secondStandardContainer displayNone">\r\n        <select class="ddlCCStandardIds" data-live-search="true" data-previous="'+(null==(__t=SecondStandardId)?"":__t)+'"></select>\r\n        <div class="clearBoth"></div>\r\n        <div class="questionCCStandardDescription marginTop"></div>\r\n    </div>\r\n\r\n    <div class="questionTagText">\r\n        <div class="clearBoth"></div>\r\n        <div placeholder="Enter question text" class="questionTextContainer" contenteditable="true">'+(null==(__t=cH.sanitize(Text))?"":__t)+"</div>\r\n        \r\n        ",QuestionTagId||Text||(__p+='\r\n            <div class="dropdown questionStemsDropdown '+(null==(__t=sCH.readerConfig.isMedia?"":"dropup")?"":__t)+'">\r\n                <a class="btnQuestionStems" data-toggle="dropdown">Question stems</a>\r\n                <ul class="dropdown-menu questionStemsOptions">\r\n                    ',_.each(alcfg.tags.question.stems,(function(e){__p+='\r\n                        <li>\r\n                            <a data-stemid="'+(null==(__t=e.id)?"":__t)+'">'+(null==(__t=e.text)?"":__t)+"...</a>\r\n                        </li>\r\n                    "})),__p+="\r\n                </ul>\r\n            </div>\r\n        "),__p+='\r\n\r\n        <div class="extraHelpContainer ',print(ExtraHelpText&&ExtraHelpText.length>0?"":"displayNone"),__p+='">\r\n            <span class="heading inverse">Extra Help</span>\r\n            <span class="icon-person extraHelpIcon" title=\''+(null==(__t=alcfg.infoText.generic.extraHelp)?"":__t)+'\' data-container=\'body\'></span>\r\n            <div placeholder="Enter extra help text" contenteditable="true">'+(null==(__t=cH.sanitize(ExtraHelpText))?"":__t)+'</div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="questionChoices">\r\n        <div class="choices"></div>\r\n        <span class="btn-box inverse pull-left marginRight btnAddChoice">Add Choice</span>\r\n        <div id="divMultiSelectInfo" class="displayNone">Note: Students must select ALL correct choices you have selected for their response to be correct.</div>\r\n    </div>\r\n\r\n    <div class="clearBoth"></div>\r\n\r\n    <div class="modelResponseContainer ',print(ModelResponse&&ModelResponse.length>0?"":"displayNone"),__p+='">\r\n        <span class="heading inverse">Model Response</span>\r\n        <div placeholder="Enter '+(null==(__t=1===SubType?"model response":"explanation")?"":__t)+'" contenteditable="true">'+(null==(__t=cH.sanitize(ModelResponse))?"":__t)+'</div>\r\n    </div>\r\n\r\n    <div class="randomizeQuestionContainer label">\r\n        <input id="chkRandomizeChoices_'+(null==(__t=ts)?"":__t)+'" type="checkbox" class="regular-checkbox whiteCheckbox mediumScaleCheckbox " />\r\n        <label for="chkRandomizeChoices_'+(null==(__t=ts)?"":__t)+'"></label>\r\n        <span>Randomize choices for students</span>\r\n    </div>\r\n\r\n    <div class="clearBoth"></div>\r\n\r\n    <div class="breaker"></div>\r\n    <div class="questionTagEditMediaContainer">\r\n        <input class="txtMedia" value="'+(null==(__t=HTML)?"":__t)+'" placeholder="Input valid URL of an image or video" />\r\n        <div class="questionTagMediaContainer embedMediaFullContainer"></div>        \r\n    </div>\r\n\r\n    <div>\r\n        <div class="dropdown addDropdown '+(null==(__t=sCH.readerConfig.isMedia?"":"dropup")?"":__t)+'">\r\n            <a class="btn-box inverse pull-left large btnAdd"\r\n                  role="button"\r\n                  data-toggle="dropdown"\r\n                  aria-haspopup="true"\r\n                  aria-expanded="false">Options</a>\r\n            <ul class="dropdown-menu" aria-labelledby="btnAdd">\r\n                <li><a class="btnAddSecondStandard">Add another standard</a></li>\r\n                <li><a class="btnRemoveSecondStandard displayNone">Remove second standard</a></li>\r\n                <li><a class="btnAddDok">'+(null==(__t=showDok?"Remove DoK level":"Add DoK level")?"":__t)+'</a></li>\r\n                <li class="divider"></li>\r\n                ',!HTML&&sCH.userM.isOnFreePlan()?__p+='\r\n                    <li><a class="btnBlockAddMedia">Add media <span class="icon-premium-lock" /></a></li>\r\n                ':__p+='\r\n                    <li><a class="btnToggleMedia">Add media</a></li>\r\n                ',__p+='\r\n                <li><a class="btnAddExtraHelp">',print(ExtraHelpText&&ExtraHelpText.length>0?"Remove extra help":"Add extra help"),__p+='\r\n                        <span class="primeFeature icon-premium-lock" title=\''+(null==(__t=alcfg.freeTeacherTooltipText.extraHelp)?"":__t)+'\'/>\r\n                </a></li>\r\n                <li><a class="btnAddModelResponse">\r\n                        <span class="caption">'+(null==(__t=ModelResponse&&ModelResponse.length>0?"Remove":"Add")?"":__t)+" "+(null==(__t=1===SubType?"model response":"explanation")?"":__t)+'</span>                    \r\n                        <span class="primeFeature icon-premium-lock" title=\''+(null==(__t=alcfg.freeTeacherTooltipText.modelResponse)?"":__t)+'\'/>\r\n                </a></li>\r\n                \r\n                <li class="dropdown-submenu">\r\n                    <a class="btnAllowMediaResponse moreOptionSubmenu">Allow media responses</a>\r\n                    <ul class="dropdown-menu ddlAllowMediaResponse '+(null==(__t=sCH.readerConfig.isVideo?"open-up":"")?"":__t)+'">\r\n                        <li><a data-allowmediaresponse="yes" class="'+(null==(__t=AllowMediaResponse?"selected":"")?"":__t)+'">Yes</a></li>\r\n                        <li><a data-allowmediaresponse="no" class="'+(null==(__t=AllowMediaResponse?"":"selected")?"":__t)+'">No</a></li>\r\n                    </ul>\r\n                </li>\r\n\r\n                ',tagListMode||sCH.readerConfig.isPDF||(__p+='<li><a class="btnMoveQuestion">Move question</a></li>'),__p+='\r\n                \r\n                <li class="dropdown-submenu">\r\n                    <a class="btnChangeWeight moreOptionSubmenu">Change weight</a>\r\n                    <ul class="dropdown-menu ddlWeights '+(null==(__t=sCH.readerConfig.isVideo?"open-up":"")?"":__t)+'">\r\n                        <li><a data-weight="1" class="',print(1===Weight?"selected":""),__p+='">1x</a></li>\r\n                        <li><a data-weight="2" class="',print(2===Weight?"selected":""),__p+='">2x</a></li>\r\n                        <li><a data-weight="3" class="',print(3===Weight?"selected":""),__p+='">3x</a></li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n\r\n        <span class="btn-box inverse pull-right large marginLeft btnDone">Save</span>\r\n        <span class="btn-box inverse pull-right large btnCancel">Cancel</span>\r\n    </div>\r\n    <div class="clearBoth"></div>\r\n</div>\r\n'}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(86),i=n(8),o=n(192);t.default=Backbone.View.extend({qTemplate:n(519),gTemplate:n(822),element:{},initialize:function(e){this.element=e.element,this.questionNumObj=sCH.questionsNumC.find({QuestionTagId:this.model.get("TagId")}),Backbone.pubEv.on("gradeSubmitted",this.gradeSubmitted,this),sCH.questionTagResponsesC.on("add",this.responseModified,this),sCH.questionTagResponsesC.on("change",this.responseModified,this),sCH.questionTagResponsesC.on("remove",this.responseModified,this)},render:function(){return this.fillEl(),this.$el},events:{click:"grading","click .extraHelpIcon":"manageExtraHelpStudents"},grading:function(e){var t={questionTagId:this.model.get("TagId")};if(e.hasOwnProperty("originalEvent")||"resetRequest"!==sCH.readerConfig.skipToTag.originalEvent||(t.sortOrder="reset-requests"),Backbone.pubEv.trigger("gradingClickedQuestion",t),!$(e.target).parent().hasClass("questionTagHtml"))return!1},fillEl:function(){var e={Text:this.model.get("Text"),ExtraHelpText:!sCH.userM.isOnFreePlan()&&this.model.get("ExtraHelpText"),HTML:this.model.get("HTML"),SubType:this.model.get("SubType"),StandardId:this.model.get("StandardId"),SecondStandardId:this.model.get("SecondStandardId"),Dok:this.model.get("Dok"),studentsList:alcfg.tags.question.students,qNum:this.questionNumObj.get("QuestionNum"),QuestionTagId:this.model.get("TagId"),UpVotes:this.model.get("UpVotes"),DownVotes:this.model.get("DownVotes"),readerType:sCH.readerConfig.type,EndIndex:this.model.get("EndIndex"),Weight:this.model.get("Weight"),ModelResponse:!sCH.userM.isOnFreePlan()&&this.model.get("ModelResponse")},t=sCH.questionTagResponsesC.getGradingDataByQuestionTagId(this.model.get("TagId"));if(t.gradeableCount=t.gradedCount+t.notGradedCount,t.readerType=sCH.readerConfig.type,t.anonymize=!1,t.SubType=e.SubType,t.choices=this.model.get("HasChoices")?sCH.questionTagResponsesC.getChoicePercentageByTagId(this.model.get("TagId"),this.model.get("QuestionChoices")):null,t.choiceNumToHideForStrugglingStudent=this.getChoiceNumToHideForStrugglingStudent(),this.$el.html(""),this.$el.html("").addClass("grading"),this.$el.append(this.qTemplate(e),this.gTemplate(t)).addClass("teacherQuestion"),this.model.get("HTML")){var n="questionTagId:"+this.model.get("TagId");s.embedMediaFull({container:this.$el.find(".questionTagHtml"),mediaUrl:this.model.get("HTML"),tagTypeAndId:n})}else this.$el.find(".questionTagHtml").hide();this.questionNumObj.get("IsDoNotGrade")&&this.$el.addClass("doNotGrade"),a.initTooltips(this.$el)},responseModified:function(e){e.get("QuestionTagId")===this.model.get("TagId")&&this.fillEl()},gradeSubmitted:function(e){if(e&&e.QuestionTagId===this.model.get("TagId")){var t=sCH.questionTagResponsesC.find({QuestionTagResponseId:e.QuestionTagResponseId});t&&null!==e.Grade&&t.set({Grade:e.Grade})}},getChoiceNumToHideForStrugglingStudent:function(){var e=null;if(sCH.userM.isOnPrimePlan()&&2===this.model.get("SubType")){var t=this.model.get("QuestionChoices"),n=i.filter(t,{IsCorrect:!1});n.length>1&&(e=n[0].ChoiceNum)}return e},manageExtraHelpStudents:function(e){o.renderManageExtraHelpStudentsPopup(),e.stopPropagation()},destroy:function(){this.remove(),this.undelegateEvents(),this.model.off(null,null,this),sCH.questionTagResponsesC.off(null,null,this),Backbone.pubEv.off("gradeSubmitted",this.gradeSubmitted,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(86),s=n(10);t.default=Backbone.View.extend({template:n(1768),events:{"click .btn-box:not(.disabled)":"vote"},initialize:function(e){this.on("cancel",(function(){Backbone.tracking.trackGAEvent("otherresponses","hide")})),this.on("shown",this.shown),this.obj=e},render:function(){this.obj.anonymize=!sCH.readerConfig.Settings.NamedPeerResponses,sCH.readerConfig.Settings&&"all"!==sCH.readerConfig.Settings.ViewPeerResponses&&(this.obj.filteredResponsesMsg="onlyproficientandadvanced"===sCH.readerConfig.Settings.ViewPeerResponses?"Note: You are seeing "+sCH.readerConfig.gradeNameMap[4].label+" and "+sCH.readerConfig.gradeNameMap[3].label+" graded responses.":"Note: You are seeing "+sCH.readerConfig.gradeNameMap[4].label+" graded responses."),this.$el.html(this.template(this.obj)),this.renderMediaForResponses(),Backbone.tracking.trackGAEvent("otherresponses","show")},renderMediaForResponses:function(){this.$el.find(".studentResponseMediaContainer").each((function(e,t){a.embedMediaFull({container:$(this),mediaUrl:$(this).data("url")})}))},shown:function(e){e.$el.find(".modal-title").html(this.obj.Text).addClass("light");var t=this.$el.find(".questionTagResponses");t.css({maxHeight:$(window).height()-t.offset().top-74-30})},vote:function(e){var t=$(e.currentTarget).parent(),n=t.data("tagresponseid"),a=this.obj.Responses.find((function(e){return e.get("QuestionTagResponseId")==n}));s.CastResponseVote({questionTagResponseId:n,assignmentId:sCH.readerConfig.assignmentId},(function(){var e=a.get("VoteData")?a.get("VoteData").UpVotes+1:1;a.set("VoteData",{UpVotes:e,DownVotes:0,CurrentUserVote:1}),t.find(".numup").text(e),t.find(".btn-box").addClass("disabled")}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="questionTagResponses">\r\n    ',Responses.length?(__p+="\r\n        ",_.each(Responses,(function(e,t){__p+="\r\n            ",anonymize&&!e.get("CreatedByCurrentUser")?__p+='\r\n                <span class="icon-person"></span>\r\n            ':__p+="\r\n                "+(null==(__t=cH.generateAvatarHtml(e.get("ImageUrl"),"onerror=\"this.style.display='hidden'\""))?"":__t)+"\r\n            ",__p+='\r\n            <div class="responseContainer">\r\n                <div class="name">'+(null==(__t=anonymize&&!e.get("CreatedByCurrentUser")?"Anonymous":cH.sanitize(e.get("FirstName")+" "+e.get("LastName")))?"":__t)+"</div>\r\n                ",e.get("Text")&&(__p+='\r\n                    <div class="text">'+(null==(__t=cH.sanitize(e.get("Text").replace(new RegExp("\r?\n","g"),"<br />")))?"":__t)+"</div>\r\n                "),__p+="\r\n                ",e.get("MediaUrl")&&(__p+='\r\n                    <div class="studentResponseMediaContainer embedMediaFullContainer" data-url="'+(null==(__t=cH.sanitize(e.get("MediaUrl")))?"":__t)+'"></div>\r\n                '),__p+="\r\n                ",sCH.readerConfig.Settings.AllowLikingPeerResponses&&(__p+='\r\n                    <div class="voting" data-tagresponseid="'+(null==(__t=e.get("QuestionTagResponseId"))?"":__t)+'">\r\n                        ',e.get("VoteData")&&e.get("VoteData").CurrentUserVote?__p+='\r\n                            <span class="btn-box small pull-left marginRight disabled">\r\n                                <div class="thumbsup icon-thumbsup no-hover"></div>\r\n                                Like\r\n                            </span>\r\n                            <span class="numup pull-left">'+(null==(__t=e.get("VoteData")?e.get("VoteData").UpVotes:0)?"":__t)+"</span>\r\n                        ":e.get("CreatedByCurrentUser")?__p+='\r\n                            <div class="thumbsup icon-thumbsup no-hover"></div>\r\n                            <span class="numup pull-left">'+(null==(__t=e.get("VoteData")?e.get("VoteData").UpVotes:0)?"":__t)+"</span>\r\n                        ":__p+='\r\n                            <a class="btn-box small pull-left marginRight">\r\n                                <div class="thumbsup icon-thumbsup no-hover"></div>\r\n                                Like\r\n                            </a>\r\n                            <span class="numup pull-left"></span>\r\n                        ',__p+="\r\n                    </div>\r\n                "),__p+='                \r\n            </div>\r\n            <div class="clearBoth" style="background: #E8E8E8;height: 1px;margin:20px 0px;"></div>\r\n    '})),"undefined"!=typeof filteredResponsesMsg&&(__p+='\r\n            <span class="info">'+(null==(__t=filteredResponsesMsg)?"":__t)+"</span>\r\n    ")):__p+='\r\n        <div class="responseContainer" style="width:450px !important;">No responses</div>\r\n    ',__p+="\r\n</div>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="popupHeader">\r\n    <h1>Grading Rubric</h1>\r\n    <a class="close"></a>\r\n</div>\r\n<div class="clearBoth"></div>\r\n\r\n',"student"===role?__p+='\r\n    <span class="heading">'+(null==(__t=cH.sanitize(selectedStandard.StandardCode)+" - "+cH.sanitize(selectedStandard.ShortText))?"":__t)+"</span>\r\n":(__p+='\r\n     <select class="ddlStandards" data-live-search="true">\r\n        ',_.each(standards,(function(e){__p+='\r\n            <option value="'+(null==(__t=e.StandardId)?"":__t)+'">'+(null==(__t=cH.sanitize(e.StandardCode))?"":__t)+" - "+(null==(__t=cH.sanitize(e.ShortText))?"":__t)+"</option>\r\n        "})),__p+="\r\n    </select>\r\n"),__p+='\r\n\r\n<div class="ccStandardText"></div>\r\n<ul class="rubric"></ul>\r\n\r\n<div class="clearBoth" style="height:20px;"></div>\r\n<a class="btn pull-right btnClose">Close</a>\r\n<div class="clearBoth" style="height:20px;"></div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+="",!response||response.Answer.IsDraft||response.Answer.IsReset)response&&(response.Answer.IsReset||response.Answer.IsDraft)&&response.Grading.Text&&(__p+='\r\n    <div class="questionTagResponses">\r\n        <div class="breaker" style="margin:0 0 20px 0;"></div>\r\n        '+(null==(__t=cH.generateAvatarHtml(response.Grading.ImageUrl,"onerror=\"this.style.display='hidden'\""))?"":__t)+'\r\n        <div class="responseContainer">\r\n            <div class="name">'+(null==(__t=cH.sanitize(response.Grading.TeacherName))?"":__t)+'</div>\r\n            <div class="text teacherComment">'+(null==(__t=cH.sanitize(response.Grading.Text))?"":__t)+"</div>\r\n        </div>\r\n    </div>\r\n");else{var isNoResponse="No response"===response.Answer.Text;if(__p+='\r\n<div class="questionTagResponses">\r\n    ',(2===SubType&&showAnswer||1===SubType)&&(__p+=' \r\n        <div class="breaker" style="margin:0 0 20px 0;"></div>\r\n        '+(null==(__t=cH.generateAvatarHtml(response.Answer.ImageUrl))?"":__t)+"\r\n    "),__p+='\r\n\r\n    <div class="responseContainer">\r\n        ',1===SubType?__p+='\r\n            <div class="text" style="margin-bottom: 20px;">'+(null==(__t=response.Answer.Text?cH.sanitize(response.Answer.Text.replace(new RegExp("\r?\n","g"),"<br />")):"")?"":__t)+'</div>\r\n            <div class="questionTagResponseHtml"></div>\r\n            <div class="studentResponseMediaContainer embedMediaFullContainer"></div>\r\n        ':2===SubType&&showAnswer&&(isNoResponse?__p+='\r\n                <div class="name studentMCResult">UNANSWERED</div>\r\n            ':4===response.Grading.Grade?__p+='\r\n                <div class="name studentMCResult correct">CORRECT</div>\r\n            ':__p+='\r\n                <div class="name studentMCResult incorrect">INCORRECT</div>\r\n            '),__p+='\r\n    </div>\r\n    <div style="line-height: normal;">\r\n        <span class="btn-box small pull-right btnUndoAnswer displayNone" data-tagresponseid="'+(null==(__t=response.Answer.QuestionTagResponseId)?"":__t)+'">Undo answer</span>\r\n        <span class="btn-box small inverse pull-right btnResetAnswer displayNone" data-tagresponseid="'+(null==(__t=response.Answer.QuestionTagResponseId)?"":__t)+'">Revise answer</span>\r\n        <span class="btn-box small inverse pull-right btnRequestResetAnswer displayNone" data-tagresponseid="'+(null==(__t=response.Answer.QuestionTagResponseId)?"":__t)+'">Revise answer</span>\r\n        ',1===SubType&&(__p+='\r\n            <a class="icon-history pull-right btnViewAnswerHistory" title="View previous responses"></a>\r\n            ',null!==response.Grading.Grade&&(__p+='\r\n                <div class="responseGradeContainer ',print(standardId?"showRubric":""),__p+='" data-standardid="'+(null==(__t=standardId)?"":__t)+'">\r\n                    <a class="icon-question-checked no-hover"></a>\r\n                    <span class="'+(null==(__t=grades[response.Grading.Grade].id)?"":__t)+'">'+(null==(__t=cH.sanitize(grades[response.Grading.Grade].label))?"":__t)+"</span>\r\n                </div>\r\n            "),__p+="\r\n            ",isAssessment||!sCH.readerConfig.Settings.AllowLikingPeerResponses||isStudentIR||(__p+='\r\n                <div class="pull-right voting">\r\n                    <div class="thumbsup icon-thumbsup no-hover"></div>\r\n                    <span class="numup">'+(null==(__t=response.Answer.Votes?response.Answer.Votes.UpVotes:0)?"":__t)+"</span>\r\n                </div>\r\n            "),__p+="\r\n        "),__p+='\r\n    </div>\r\n    <div class="clearBoth"></div>\r\n\r\n    ',1===SubType&&""!==response.Grading.Text&&null!==response.Grading.Text)__p+='\r\n        <div class="breaker"></div>\r\n        '+(null==(__t=cH.generateAvatarHtml(response.Grading.ImageUrl,"onerror=\"this.style.display='hidden'\""))?"":__t)+'\r\n        <div class="responseContainer">\r\n            <div class="name">'+(null==(__t=cH.sanitize(response.Grading.TeacherName))?"":__t)+'</div>\r\n            <div class="text teacherComment">'+(null==(__t=cH.sanitize(response.Grading.Text))?"":__t)+"</div>\r\n        </div>\r\n    ";else if(2===SubType&&null!==response.Answer.Text){__p+='\r\n        <div class="questionChoices">\r\n            ',showAnswer&&(__p+='\r\n                <span class="heading inverse" style="margin-left:3px;margin-right:19px;">Me</span>\r\n                <span class="heading inverse">Answer</span>\r\n            '),__p+="\r\n            ";for(var myAnswers=response.Answer.Text.toString().split(","),i=0;i<choices.length;i++){var selected=-1!==$.inArray(choices[i].QuestionChoiceId.toString(),myAnswers),cssClass="";showAnswer&&!isNoResponse&&(choices[i].IsCorrect&&selected?cssClass="correct":choices[i].IsCorrect&&!selected?cssClass="incorrect":!choices[i].IsCorrect&&selected?cssClass="incorrect":choices[i].IsCorrect||selected||(cssClass="")),__p+='\r\n                    <div class="choice disabled">\r\n                        <div class="left mid '+(null==(__t=cssClass)?"":__t)+' accessibilityEnabledCheckbox">\r\n                            <input id="chkMCQ'+(null==(__t=choices[i].QuestionChoiceId)?"":__t)+'" type="checkbox" class="disabled" '+(null==(__t=selected?"checked":"")?"":__t)+'>\r\n                            <label for="chkMCQ'+(null==(__t=choices[i].QuestionChoiceId)?"":__t)+'"></label>\r\n                        </div>\r\n                        ',showAnswer&&(__p+='<div class="left mid spaced"><div class="',print(choices[i].IsCorrect?"no-hover icon-checkmark":""),__p+='"></div></div>'),__p+='\r\n                        <div class="middle"><div class="txtChoice">'+(null==(__t=cH.sanitize(choices[i].Text))?"":__t)+"</div></div>\r\n                    </div>\r\n            "}__p+="\r\n        </div>\r\n    "}else if(3===SubType){__p+='\r\n        <div class="questionChoices">\r\n            <span class="heading inverse">Me</span>\r\n            <span class="heading inverse results">Class Results</span>\r\n            ';for(var myAnswers=response.Answer.Text.toString().split(","),i=0;i<choices.length;i++){var selected=-1!==$.inArray(choices[i].QuestionChoiceId.toString(),myAnswers);__p+='\r\n                <div class="choice disabled">\r\n                    <div class="left mid accessibilityEnabledCheckbox">\r\n                        <input id="chkMCQ'+(null==(__t=choices[i].QuestionChoiceId)?"":__t)+'" type="checkbox" class="disabled" '+(null==(__t=selected?"checked":"")?"":__t)+'>\r\n                        <label for="chkMCQ'+(null==(__t=choices[i].QuestionChoiceId)?"":__t)+'"></label>\r\n                    </div>\r\n                    <div class="middle"><div class="txtChoice">'+(null==(__t=cH.sanitize(choices[i].Text))?"":__t)+'</div></div>\r\n                    <div class="right large">\r\n                        <div class="percentContainer">\r\n                            <div class="percentageBar">\r\n                                <div class="bar" style="width: '+(null==(__t=choices[i].percent)?"":__t)+'%"></div>\r\n                            </div>\r\n                            <div class="percentageText">'+(null==(__t=choices[i].percent)?"":__t)+"%</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            "}__p+="\r\n        </div>\r\n    "}__p+='\r\n    <div class="clearBoth"></div>\r\n</div>\r\n'}__p+="\r\n"}return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var ts=(new Date).getTime();if(__p+='\r\n\r\n<div class="questionTagAnswer displayNone">\r\n    ',obj.Choices)__p+='\r\n    <div class="questionChoices" style="display: block;margin-top: 0;">\r\n        <span class="heading inverse">'+(null==(__t=hasMultipleChoicesCorrect?"Select all that apply":"Select an answer")?"":__t)+"</span>\r\n        ",_.each(obj.Choices,(function(e,t){__p+='\r\n            <div class="choice">\r\n                <div class="left mid accessibilityEnabledCheckbox">\r\n                    <input id="chkMCQ'+(null==(__t=e.QuestionChoiceId)?"":__t)+'" type="checkbox">\r\n                    <label for="chkMCQ'+(null==(__t=e.QuestionChoiceId)?"":__t)+'"></label>\r\n                </div>\r\n                <div class="middle"><div class="txtChoice">'+(null==(__t=cH.sanitize(e.Text))?"":__t)+'</div></div>\r\n                <div class="right large"></div>\r\n            </div>\r\n        '})),__p+="\r\n    </div>\r\n    ";else{var locked=sCH.readerConfig.assignmentLocked,editable=locked?"false":"true",placeholder=locked?"Assignment locked":"Click to answer";__p+='\r\n            <div class="textareaContainer">\r\n            <div contenteditable="'+(null==(__t=editable)?"":__t)+'" data-placeholder="'+(null==(__t=placeholder)?"":__t)+'" class="'+(null==(__t=obj.IsDraft?"isDraft":"")?"":__t)+" "+(null==(__t=obj.IsDeleted?"isDeleted":"")?"":__t)+'">'+(null==(__t=cH.sanitize(obj.AnswerText))?"":__t)+"</div>\r\n            </div>\r\n        ",IsMediaResponseAllowed&&(__p+='\r\n            <div class="mediaHeading displayNone">\r\n                <div class="breaker"></div>\r\n                <span class="heading inverse ">Media</span>\r\n                <a class="btn-box btnRemoveMedia inverse">Remove</a>\r\n            </div>\r\n            <input name="txtMediaUrl" placeholder="Enter URL of valid image or video" value="'+(null==(__t=cH.sanitize(obj.MediaUrl))?"":__t)+'" class="txtMediaUrl displayNone" />\r\n            <div class="dropdown dropup addMediaDropdown">\r\n                <a class="btnToggleMedia icon-attachment-clip" \r\n                    role="button"\r\n                    data-toggle="dropdown"\r\n                    aria-haspopup="true"\r\n                    aria-expanded="false"\r\n                    title="Add media" data-placement="right"></a>\r\n                <ul class="dropdown-menu" aria-labelledby="btnToggleMedia">\r\n                    <li><a class="btnAddFromComputer">Upload image</a></li>\r\n                    <li><a class="btnAddURL">Add from URL</a></li>\r\n                </ul>\r\n            </div>\r\n            \r\n            <div class="studentResponseMediaContainer embedMediaFullContainer"></div>\r\n        '),__p+="\r\n    "}__p+='\r\n    \r\n    <div class="clearBoth" style="height:20px;"></div>\r\n    <span class="btn-box large inverse pull-right btnSubmit">Submit</span>\r\n    ',obj.Choices||(__p+='\r\n        <span class="btn-box large inverse pull-left btnSaveDraft">Save draft</span>\r\n        <a class="icon-history pull-right btnViewAnswerHistory" title="View previous responses"></a>\r\n    '),__p+='\r\n    <div class="clearBoth"></div>\r\n</div>\r\n'}return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",_.each(responses,(function(e,t){__p+='\n    <div class="responseContainer">\n        <div class="heading">Response #'+(null==(__t=t+1)?"":__t)+" ("+(null==(__t=moment(moment.utc(e.get("AnswerDate")||e.get("CreateDate")).local().toDate()).format("MM/DD/YY h:mm a"))?"":__t)+")</div>\n        <div>"+(null==(__t=cH.sanitize(e.get("Text")))?"":__t)+"</div>\n        ",e.get("MediaUrl")&&(__p+='\n            <div class="studentResponseMediaContainer embedMediaFullContainer" data-url="'+(null==(__t=cH.sanitize(e.get("MediaUrl")))?"":__t)+'"></div>\n        '),__p+="\n        ",e.get("TeacherComment")&&(__p+='\n            <div class="teacherCommentContainer">\n                <div class="heading">'+(null==(__t=cH.sanitize(e.get("TeacherName")))?"":__t)+'\'s Comment</div>\n                <div class="text teacherComment">'+(null==(__t=cH.sanitize(e.get("TeacherComment")))?"":__t)+"</div>\n            </div>\n        "),__p+="\n        ",e.get("Grade")&&(__p+='\n            <div class="responseGradeContainer">\n                <a class="icon-question-checked no-hover"></a>\n                <span class="'+(null==(__t=grades[e.get("Grade")].id)?"":__t)+'">'+(null==(__t=cH.sanitize(grades[e.get("Grade")].label))?"":__t)+"</span>\n            </div>\n        "),__p+="\n    </div>\n"})),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(86),o=n(48),r=n(148),l=n(521),d=n(192);t.default=Backbone.View.extend({template:n(824),tag:{},tagContainer:{},elementD:{},initialize:function(e){this.elementD=e.element,this.tagListMode=e.tagListMode,this.model.on("change",this.redrawTagContainer,this),this.model.on("destroy",this.destroy,this),Backbone.pubEv.on("noteCustomCategoryUpdate",this.updateCategory,this)},render:function(e){var t=sCH.readerConfig.isPDF,n={tag:this.model,readerType:sCH.readerConfig.type,readOnly:!0===sCH.readerConfig.isReadOnly,linkify:s.linkify,showStudentHighlights:t,tagListMode:this.tagListMode,isHighlightOnly:!1,hideReplyCount:sCH.learnEntityMetaM.get("IsQuiz")||"authoring"===sCH.readerConfig.type||!this.model.get("ReplyCount")||"student"===sCH.userM.get("Role")&&this.model.get("CreatedByCurrentUser")&&!1===this.model.get("IsPublic")};if(this.tagListMode&&("grading"===sCH.readerConfig.type?-1!==sCH.readerConfig.selectedStudentUserId:"self"===$(".btnSummaryToggleSharedNotes.selected").data("state"))){var r="grading"===sCH.readerConfig.type?sCH.readerConfig.selectedStudentUserId:sCH.userM.get("UserId");if(r!==n.tag.get("UserId")){if(n.tag=n.tag.clone(),n.tag.set("HighlightedText",n.tag.get("Text")+"-"+n.tag.get("Username")),n.tag.set("ReplyCount",0),"grading"===n.readerType){var l=sCH.studentsC.find({UserId:r});n.tag.set("Username",l.get("FirstName")+" "+l.get("LastName")+" (Reply)")}else n.tag.set("Username","Me (Reply)");n.tag.set("Category",null),n.tag.set("IsNoteReply",!0),n.hideReplyCount=!0;var d=a.filter(sCH.replyDataByStudent[r],{Id:n.tag.get("TagId")});1===d.length?n.tag.set("Text",d[0].Title):d.length>1&&n.tag.set("Text",d.length+" replies:"+a.map(d,"Title").join("<br>"))}}var c=$("<div>"+this.template(n)+"</div>");if(this.model.get("HTML")){var u="note:"+this.model.get("TagId");i.embedMediaPreview({container:c.find(".noteTagHtml"),mediaUrl:this.model.get("HTML"),shouldUpdateMargin:!0,tagTypeAndId:u,isCreatedByCurrentUser:this.model.get("CreatedByCurrentUser")})}return this.fillEl(c),this.tag=c.find(".notesTag"),this.tagContainer=c.find(".noteTagContainer"),"authoring"===sCH.readerConfig.type&&n.tag.get("IsExtraHelp")&&!sCH.userM.isOnPrimePlan()&&o.hidePrimeFeatureText(c.find(".displayScreen")),s.initTooltips(this.tagContainer),this.tagListMode?this.tagContainer:(this.model.get("TagId")||this.tag.addClass("active"),e.appendChild(this.tagContainer[0]),this.addEvents(!0),this.tag[0])},renderHighlightSegment:function(){var e=sCH.readerConfig.isPDF,t=$("<div>"+this.template({tag:this.model,readerType:sCH.readerConfig.type,readOnly:!0===sCH.readerConfig.isReadOnly,linkify:function(){},showStudentHighlights:e,tagListMode:this.tagListMode,isHighlightOnly:!0,hideReplyCount:!0})+"</div>");return this.tag=t.find(".notesTag"),this.addEvents(),this.tag[0]},redrawTagContainer:function(){if(this.tag.length&&(s.updateNoteReplyCount(this.tagContainer,this.model.get("ReplyCount")),!sCH.readerConfig.activeFullNote&&!sCH.readerConfig.activeAddNote)){if(this.tag.removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.model.get("Color")),this.tagContainer.removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.model.get("Color")),$(".notesTag[data-tagid='"+this.model.get("TagId")+"']").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.model.get("Color")),this.model.get("IsExtraHelp")?this.tagContainer.find(".extraHelpIconContainer").removeClass("displayNone"):this.tagContainer.find(".extraHelpIconContainer").addClass("displayNone"),this.model.isHighlightOnly()&&this.model.get("TagId"))this.tagContainer.addClass("displayNone");else{var e=this.model.get("HTML"),t=this.model.get("Text");if(this.tagListMode&&(this.model.hasChanged("ReplyCount")||this.model.hasChanged("ReplyUserIds"))||this.tagContainer.find(".noteTagText").html(s.linkify(t&&t.length>200?t.substring(0,197)+"...":t)),this.tagContainer.find(".category").attr("class","category").text(this.model.get("Category")).addClass(this.model.get("Color")),e){var n=this.tagContainer.find(".noteTagHtml");n.removeClass("displayNone");var a="note:"+this.model.get("TagId");i.embedMediaPreview({container:n,mediaUrl:this.model.get("HTML"),shouldUpdateMargin:!0,tagTypeAndId:a,isCreatedByCurrentUser:this.model.get("CreatedByCurrentUser")})}else this.tagContainer.find(".noteTagHtml").addClass("displayNone");this.tagContainer.removeClass("displayNone")}this.tagListMode||Backbone.pubEv.trigger("updateMargin")}},fillEl:function(e){this.model.isHighlightOnly()&&this.model.get("TagId")&&e.find(".noteTagContainer")[0].classList.add("displayNone"),this.model.get("HTML")?e.find(".noteTagHtml")[0].classList.remove("displayNone"):e.find(".noteTagHtml")[0].classList.add("displayNone"),e.find(".replyCount").length>0&&(this.model.get("ReplyCount")>0?(e.find(".replyCount")[0].classList.remove("displayNone"),e.find(".num").text(this.model.get("ReplyCount"))):e.find(".replyCount")[0].classList.add("displayNone"))},openFullNote:function(){if(!sCH.readerConfig.activeAddNote||!1!==sCH.readerConfig.activeAddNote.closePopup()){if(s.promptUnSavedNoteReply())return;this.fullNoteV=new l.default({model:this.model,scope:this,setFocusInReply:!0}),this.fullNoteV.render()}},addEvents:function(e){var t=this;this.tag.click((function(e){if(t.tagContainer.hasClass("active"))return!1;if(e.currentTarget===e.target){if(rangy.getSelection().toString())return!1;var n=!0;if(sCH.readerConfig.activeAddNote&&(n=confirm(alcfg.alertsText.unsavedNote))&&(sCH.readerConfig.activeAddNote.skipUnsavedNoteCheck=!0),n){var a=$(this);if(a.hasClass("transparent")){var s=a.closest(":not(.transparent)");return s.length>0&&s.click(),!1}t.openFullNote()}}})),this.tagContainer.click((function(e){if(!$(this).hasClass("active"))return s.viewportSkipToElement(t.tag),t.openFullNote(),!1})).hover((function(){t.tag.addClass("hover"),$(".notesTag[data-tagid='"+t.model.get("TagId")+"']").addClass("hover")}),(function(){t.tag.removeClass("hover"),$(".notesTag[data-tagid='"+t.model.get("TagId")+"']").removeClass("hover")})),this.tagContainer.find(".extraHelpIconContainer").length>0&&this.tagContainer.find(".extraHelpIconContainer:not(.locked)").click((function(e){t.manageExtraHelpStudents(e)}))},updateCategory:function(e){this.model.get("Color")===e.color&&this.model.checkUserId(e.userId)&&this.model.set({Category:e.category},{silent:!0})},manageExtraHelpStudents:function(e){d.renderManageExtraHelpStudentsPopup(),e.stopPropagation()},destroy:function(e){if(this.tagListMode)this.tagContainer.remove();else{if(!this.tag.length)return;var t=this.tag.parent()[0];this.tag.contents().unwrap(),r.safeNormalize(t),this.tagContainer.remove();var n=$(".notesTag[data-tagid='"+this.model.get("TagId")+"']");$.each(n,(function(e,t){$(t).after($(t).html()),$(t).remove()})),e&&e.doNotUpdateMargin||Backbone.pubEv.trigger("updateMargin")}this.remove(),this.undelegateEvents(),this.model.off(null,null,this),Backbone.pubEv.off("noteCustomCategoryUpdate",this.updateCategory,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(644),o=n(44),r=n(129);t.default=Backbone.Collection.extend({model:i.default,sync:o.default,fillByNoteTagId:function(e,t){if("tour"===sCH.readerConfig.type){if(r.cachedNoteReplies){var n=a.filter(r.cachedNoteReplies,(function(t){return t.get("NoteTagId")===e}));this.add(n)}}else{var s=this,i={noteTagId:e};t&&(i.assignmentId=t),this.fetch({url:alcfg.node.reader.get_note_responses,data:i,mainSuccess:function(e){s.add(e)},mainError:function(e,t){"offline"===t&&($("#noteTagRepliesContainer #noteTagReplies").hide(),$("#noteTagRepliesContainer .breaker").hide(),$("#noteTagRepliesContainer .noteReplyText").hide(),$("#noteTagRepliesContainer .btn-container .btn ").not(".btnClose").hide())}})}},addReply:function(e,t,n){var a=this;function i(e,t){var n=a.find({NoteTagResponseId:e.noteTagResponseId});n&&t?n.set("NoteTagResponseId",t.NoteTagResponseId):a.add({CreatedByCurrentUser:!0,NoteTagResponseId:t?t.NoteTagResponseId:e.noteTagResponseId,NoteTagId:e.noteTagId,Text:e.text,ImageUrl:t?t.ImageUrl:sCH.userM.get("ImageUrl"),FirstName:t?t.FirstName:sCH.userM.get("FirstName"),LastName:t?t.LastName:sCH.userM.get("LastName"),TeacherTitle:sCH.userM.get("Title"),UserId:t?t.UserId:sCH.userM.get("UserId"),CreateDate:t?t.CreateDate:(new Date).toISOString(),TaggedUserIds:e.taggedUserIds})}if("tour"===sCH.readerConfig.type){var o=r.getTourTag("response",{NoteTagId:e.noteTagId,AssignmentId:e.assignmentId,Text:e.text,CreatedByCurrentUser:!0,UserId:sCH.userM.get("UserId"),ImageUrl:sCH.userM.get("ImageUrl"),FirstName:sCH.userM.get("FirstName"),LastName:sCH.userM.get("LastName"),CreateDate:(new Date).toISOString()});a.add(o),r.cachedNoteReplies.push(o),t.apply(n);var l=sCH.teacherNotesC.filter({TagId:e.noteTagId})[0];l&&l.set("ReplyCount",l.get("ReplyCount")+1)}else e.noteTagResponseId=s.getRandomInteger(),s.ajax({type:"POST",url:alcfg.node["reader_"+sCH.readerConfig.type].add_note_reply,data:e,showLoading:!1,vital:!0,onSuccess:function(a){i(e,a),t.apply(n)},onError:function(t,n){"offline"===n?i(e):s.showErrorPopup(s.getErrorTextFromResponse(t))}})}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",sCH.userM.get("IsMasquerading")&&(__p+='\r\n    <div style="background:gray;padding:10px;height:34px;position:relative;top:-20px;margin:0 -20px;">\r\n        <input id="txtCharsToMove" placeholder="#" maxlength="3" style="width:20px;padding:6px;position:relative;top:2px;margin-right:5px;" />\r\n        <a class="btn small whitebg btnMove">left</a>\r\n        <a class="btn small whitebg btnMove">right</a>\r\n    </div>\r\n    <div class="clearBoth"></div>\r\n'),__p+='\r\n\r\n<div class="nameAndNote">\r\n    <div class="dropdown noteDropdown pull-right">\r\n        <a class="icon-moreactions btnNoteDropdown"\r\n            title=""\r\n            role="button"\r\n            data-toggle="dropdown"\r\n            aria-haspopup="true"\r\n            aria-expanded="false"></a>\r\n        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="btnNoteDropdown">\r\n            <li><a class="btnEdit">Edit</a></li>\r\n            <li><a class="btnDelete">Delete</a></li>\r\n        </ul>\r\n    </div>                    \r\n    <div class="name"></div>\r\n    <div class="text"></div>\r\n</div>\r\n\r\n<div class="noteHtml"></div>\r\n\r\n<div class="btn-box loadAllReplies"></div>\r\n\r\n<div style="clear:both;"></div>\r\n\r\n<div class="category"></div>\r\n\r\n',"student"!==sCH.readerConfig.type&&(__p+='\r\n    <div class="extraHelpIconContainer displayNone ',print(sCH.userM.isOnFreePlan()?"locked":""),__p+="\"\r\n        data-container=\"body\"\r\n        data-tooltip-class='noteSummaryPopupTooltip'\r\n        title='"+(null==(__t=sCH.userM.isOnFreePlan()?alcfg.infoText.generic.extraHelpNoteFreeT:alcfg.infoText.generic.extraHelp)?"":__t)+"'>\r\n        <span class=\"extraHelpIcon no-hover ",print(sCH.userM.isOnFreePlan()?"icon-lock":"icon-person"),__p+='"></span>\r\n        <span>Extra Help</span>\r\n    </div>\r\n'),__p+='\r\n\r\n<div style="clear:both;"></div>\r\n\r\n',"authoring"!==sCH.readerConfig.type&&(__p+='\r\n    <div id="noteTagRepliesContainer">\r\n        <div class="breaker"></div>\r\n        <div id="noteTagReplies"></div>\r\n        <div id="noteReply">\r\n            <div contenteditable="true" class="noteReplyText" placeholder="Enter reply"></div>\r\n            <div class="clearBoth"></div>\r\n            <div class="btn-container" style="margin-top: 10px;">\r\n                <a class="btn small pull-right btnReply">Reply</a>\r\n                <a class="btn small pull-right btnClose">Cancel</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n'),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(86),o=n(148),r=n(521);t.default=Backbone.View.extend({template:n(824),tag:{},tagContainer:{},elementD:{},initialize:function(e){this.elementD=e.element,this.tagListMode=e.tagListMode,this.model.on("change",this.redrawTagContainer,this),this.model.on("destroy",this.destroy,this),Backbone.pubEv.on("toggleStudentTags",this.toggleStudentTags,this),Backbone.pubEv.on("noteCustomCategoryUpdate",this.updateCategory,this)},render:function(e){var t=sCH.readerConfig.isPDF,n={tag:this.model,readerType:sCH.readerConfig.type,readOnly:!0===sCH.readerConfig.isReadOnly,isStudentSelected:this.model.get("IsPublic")||-1!==sCH.readerConfig.selectedStudentUserId,linkify:s.linkify,showStudentHighlights:t,tagListMode:this.tagListMode,isHighlightOnly:!1,hideReplyCount:sCH.learnEntityMetaM.get("IsQuiz")||"authoring"===sCH.readerConfig.type||!this.model.get("ReplyCount")||"student"===sCH.userM.get("Role")&&this.model.get("CreatedByCurrentUser")&&!1===this.model.get("IsPublic")};if(this.tagListMode&&("grading"===sCH.readerConfig.type?-1!==sCH.readerConfig.selectedStudentUserId:"self"===$(".btnSummaryToggleSharedNotes.selected").data("state"))){var o="grading"===sCH.readerConfig.type?sCH.readerConfig.selectedStudentUserId:sCH.userM.get("UserId");if(o!==n.tag.get("UserId")){if(n.tag=n.tag.clone(),n.tag.set("HighlightedText",n.tag.get("Text")+"-"+n.tag.get("Username")),n.tag.set("ReplyCount",0),"grading"===n.readerType){var r=sCH.studentsC.find({UserId:o});n.tag.set("Username",r.get("FirstName")+" "+r.get("LastName")+" (Reply)")}else n.tag.set("Username","Me (Reply)");n.tag.set("Category",null),n.tag.set("IsNoteReply",!0),n.hideReplyCount=!0;var l=a.filter(sCH.replyDataByStudent[o],{Id:n.tag.get("TagId")});1===l.length?n.tag.set("Text",l[0].Title):l.length>1&&n.tag.set("Text",l.length+" replies:"+a.map(l,"Title").join("<br>"))}}var d=$("<div>"+this.template(n)+"</div>");return this.model.get("HTML")&&i.embedMediaPreview({container:d.find(".noteTagHtml"),mediaUrl:this.model.get("HTML"),shouldUpdateMargin:!0,isCreatedByCurrentUser:this.model.get("CreatedByCurrentUser")}),this.fillEl(d),this.tag=d.find(".notesTag"),this.tagContainer=d.find(".noteTagContainer"),this.tagListMode?this.tagContainer:(e.appendChild(this.tagContainer[0]),this.addEvents(!0),this.tag[0])},renderHighlightSegment:function(){var e=sCH.readerConfig.isPDF,t=$("<div>"+this.template({tag:this.model,readerType:sCH.readerConfig.type,readOnly:!0===sCH.readerConfig.isReadOnly,isStudentSelected:this.model.get("IsPublic")||-1!==sCH.readerConfig.selectedStudentUserId,linkify:function(){},showStudentHighlights:e,tagListMode:this.tagListMode,isHighlightOnly:!0,hideReplyCount:!0})+"</div>");return this.tag=t.find(".notesTag"),this.addEvents(),this.tag[0]},redrawTagContainer:function(){if(this.tag.length&&(s.updateNoteReplyCount(this.tagContainer,this.model.get("ReplyCount")),!sCH.readerConfig.activeFullNote&&!sCH.readerConfig.activeAddNote)){if(this.tag.removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.model.get("Color")),this.tagContainer.removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.model.get("Color")),$(".notesTag[data-tagid='"+this.model.get("TagId")+"']").removeClass(alcfg.tags.note.noteColorListSpaceSeparated).addClass(this.model.get("Color")),this.model.isHighlightOnly()&&this.model.get("TagId"))this.tagContainer.addClass("displayNone");else{var e=this.model.get("HTML"),t=this.model.get("Text");if(this.tagListMode&&(this.model.hasChanged("ReplyCount")||this.model.hasChanged("ReplyUserIds"))||this.tagContainer.find(".noteTagText").html(s.linkify(t&&t.length>200?t.substring(0,197)+"...":t)),e){var n=this.tagContainer.find(".noteTagHtml");n.removeClass("displayNone"),i.embedMediaPreview({container:n,mediaUrl:e,shouldUpdateMargin:!0,isCreatedByCurrentUser:this.model.get("CreatedByCurrentUser")})}else this.tagContainer.find(".noteTagHtml").addClass("displayNone");this.tagContainer.removeClass("displayNone")}this.tagListMode||Backbone.pubEv.trigger("updateMargin")}},fillEl:function(e){(this.model.isHighlightOnly()&&!this.tagListMode||this.model.get("IsAssociatedNote"))&&e.find(".noteTagContainer")[0].classList.add("displayNone"),this.model.get("HTML")?e.find(".noteTagHtml")[0].classList.remove("displayNone"):e.find(".noteTagHtml")[0].classList.add("displayNone"),e.find(".replyCount").length>0&&s.updateNoteReplyCount(e,this.model.get("ReplyCount"))},openFullNote:function(){if(!sCH.readerConfig.activeAddNote||!1!==sCH.readerConfig.activeAddNote.closePopup()){if(s.promptUnSavedNoteReply())return;this.fullNoteV=new r.default({model:this.model,scope:this,setFocusInReply:!0}),this.fullNoteV.render()}},addEvents:function(e){var t=this;this.tag.click((function(e){if(t.tagContainer.hasClass("active"))return!1;if(e.currentTarget===e.target){if(rangy.getSelection().toString())return!1;var n=!0;if(sCH.readerConfig.activeAddNote&&(n=confirm(alcfg.alertsText.unsavedNote))&&(sCH.readerConfig.activeAddNote.skipUnsavedNoteCheck=!0),n){var a=$(this);if(a.hasClass("transparent")){var s=a.closest(":not(.transparent)");return s.length>0&&s.click(),!1}t.openFullNote()}}})),this.tagContainer.click((function(e){$(this).hasClass("active")||(s.viewportSkipToElement(t.tag),t.openFullNote())})).hover((function(){var e=$(".notesTag[data-tagid='"+t.model.get("TagId")+"']");t.tag.addClass("hover"),e.addClass("hover"),t.tag.data("transparent")&&!t.tag.hasClass("active")&&(t.tag.removeClass("transparent"),e.removeClass("transparent"))}),(function(){var e=$(".notesTag[data-tagid='"+t.model.get("TagId")+"']");t.tag.removeClass("hover"),e.removeClass("hover"),t.tag.data("transparent")&&!t.tag.hasClass("active")&&(t.tag.addClass("transparent"),e.addClass("transparent"))}))},toggleStudentTags:function(e){this.model.checkUserId(e.studentUserId)&&this.model.get("TextSectionId")===e.sectionId&&(this.model.set({Visible:e.show}),e.show||this.destroy())},updateCategory:function(e){this.model.get("Color")===e.color&&this.model.checkUserId(e.userId)&&this.model.set({Category:e.category},{silent:!0})},destroy:function(e){if(this.tagListMode)this.tagContainer.remove();else{if(!this.tag.length)return;var t=this.tag.parent()[0];this.tag.contents().unwrap(),o.safeNormalize(t),this.tagContainer.remove();var n=$(".notesTag[data-tagid='"+this.model.get("TagId")+"']");$.each(n,(function(e,t){$(t).after($(t).html()),$(t).remove()})),e&&e.doNotUpdateMargin||Backbone.pubEv.trigger("updateMargin")}this.remove(),this.undelegateEvents(),this.model.off(null,null,this),Backbone.pubEv.off("toggleStudentTags",this.toggleStudentTags,this),Backbone.pubEv.off("noteCustomCategoryUpdate",this.updateCategory,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(148);t.default=Backbone.View.extend({tagName:"span",initialize:function(){this.model.bind("destroy",this.destroy,this)},render:function(){return this.fillEl(),this.$el[0]},fillEl:function(){this.$el.addClass("hyperlink")},events:{mousedown:"menuHyperlink",touchend:"menuHyperlink"},menuHyperlink:function(e){var t=e.currentTarget===e.target||$(e.target).hasClass("notesTag");if(0===$(".popupMenu[style*='block']").length&&t){if(window.ActivelyRead.showLinkMenu=!0,"touchend"===e.type){var n=e.currentTarget.getBoundingClientRect();Backbone.pubEv.trigger("menuHyperlinkShow",{model:this.model,left:n.left+30,top:n.bottom-32})}else Backbone.pubEv.trigger("menuHyperlinkShow",{model:this.model,top:e.pageY,left:e.pageX});if("touchend"===e.type)return!1}},destroy:function(){var e=this.$el.parent()[0];this.$el.contents().unwrap(),a.safeNormalize(e),this.remove(),this.undelegateEvents(),this.model.off(null,null,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(148);t.default=Backbone.View.extend({tagName:"span",initialize:function(e){this.model.bind("destroy",this.destroy,this),this.showEraserIcon=e.showEraserIcon},render:function(){return this.fillEl(),this.$el[0]},fillEl:function(){this.$el.addClass("whiteout"),"authoring"===sCH.readerConfig.type&&this.showEraserIcon&&this.$el.addClass("authoring icon-eraser"),this.$el.toggleClass("readOnly",!0===sCH.readerConfig.isReadOnly)},events:{click:"menuWhiteout"},menuWhiteout:function(e){var t=this;new Backbone.BootstrapModal({title:"Restore whiteout text?",content:'<div class="info">'+this.$el.data("highlightedtext")+"</div>",cssClass:"modal-al-undo-whiteout",allowCancel:!0,okText:"Restore"}).open((function(){t.model.deleteData(),Backbone.pubEv.trigger("updateMargin")}))},destroy:function(){var e=this.$el.parent()[0];this.$el.contents().unwrap(),a.safeNormalize(e),[$(e),$(e).parent(),$(e).parent().parent()].every((function(e){return e.removeClass("whiteoutParagraphFirstLine whiteoutParagraph authoring"),!0})),this.remove(),this.undelegateEvents(),this.model.off(null,null,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.View.extend({tagName:"div",events:{click:"menuWhiteoutMedia"},initialize:function(e){this.model.bind("destroy",this.destroy,this),this.showEraserIcon=e.showEraserIcon,this.imageSrc=e.imageSrc},render:function(){return this.fillEl(),this.$el[0]},fillEl:function(){this.$el.addClass("whiteout"),"authoring"===sCH.readerConfig.type&&this.showEraserIcon&&this.$el.addClass("authoring icon-eraser").attr("title","Restore Image"),this.$el.toggleClass("readOnly",!0===sCH.readerConfig.isReadOnly)},menuWhiteoutMedia:function(e){var t=this;new Backbone.BootstrapModal({title:"Restore whiteout image?",content:t.imageSrc?"<img src='"+t.imageSrc+"'/>":"",cssClass:"modal-lg modal-al-undo-whiteout",allowCancel:!0,okText:"Restore"}).open((function(){t.model.deleteData(),Backbone.pubEv.trigger("updateMargin")}))},destroy:function(){this.$el.contents().unwrap(),this.remove(),this.undelegateEvents(),this.model.off(null,null,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.View.extend({tagName:"div",events:{click:"restoreWhiteout"},initialize:function(e){this.model.bind("destroy",this.destroy,this),this.videoHtmlClone=e.videoHtmlClone},render:function(){return this.fillEl(),this.$el[0]},fillEl:function(){this.$el.addClass("whiteout"),"authoring"===sCH.readerConfig.type&&this.$el.addClass("authoring icon-eraser").attr("title","Restore video"),this.$el.toggleClass("readOnly",!0===sCH.readerConfig.isReadOnly)},restoreWhiteout:function(){var e=this;new Backbone.BootstrapModal({title:"Restore video?",cssClass:"modal-al-undo-whiteout",content:'<div style="text-align:center"><iframe frameborder="0" src="'+this.model.get("Text")+'" style="width: 100%; height:300px;" /></div>',allowCancel:!0,okText:"Restore"}).open((function(){e.model.deleteData(),e.$el.closest("figure.video").removeClass("whiteoutVideo").next(".btnWhiteoutVideo").removeClass("displayNone"),Backbone.pubEv.trigger("updateMargin")}))},destroy:function(){this.$el.contents().unwrap(),this.remove(),this.undelegateEvents(),this.model.off(null,null,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({template:n(1782),tag:{},tagContainer:{},elementD:{},initialize:function(e){this.elementD=e.element,this.model.bind("destroy",this.destroy,this),Backbone.pubEv.on("toggleStudentTags",this.toggleStudentTags,this)},render:function(){return this.$el.html(this.template({tag:this.model.toJSON(),readerType:sCH.readerConfig.type})),this.tag=this.$el.find(".flagTag"),this.tagContainer=this.$el.find(".flagTagContainer"),this.tag[0]},showFlag:function(){var e=this.tag.position().top+9,t=$(".flagTagContainer[data-top='"+e+"']");if(t.length>0){var n=""===t.find(".count").text()?1:parseInt(t.find(".count").text());n++,t.find(".count").text(n),this.tagContainer.remove(),this.tagContainer=t}else"grading"===sCH.readerConfig.type&&this.model.get("AssociatedNoteTagId")&&this.$el.find(".names span").wrap('<a class="btnGotoFlagNote"></a>'),this.tagContainer.css({top:e}),this.tagContainer.attr("data-top",e),$(".endSectionQuestions").append(this.tagContainer),this.addEvents(e);if("grading"===sCH.readerConfig.type){var s=$("<li"+(this.model.get("AssociatedNoteTagId")?' class="gotoFlagNote" data-tagid="'+this.model.get("AssociatedNoteTagId")+'"':"")+"><a>"+a.sanitize(this.model.get("Username"))+"</a></li>");if(this.model.get("AssociatedNoteTagId")){var i=this;s.click((function(e){var t=$(this).data("tagid"),n=sCH.studentNotesC.filter({TagId:t})[0];Backbone.pubEv.trigger("popupFullNoteShow",{model:n,scope:{tagListMode:!1,tagContainer:i.tagContainer}})}))}(t=t.length>0?t:this.tagContainer).find(".dropdown-menu").append(s)}if(this.model.get("AssociatedNoteTagId")&&!(this.tagContainer.hasClass("withComment")&&!this.tagContainer.hasClass("hasReply"))){this.tagContainer.addClass("withComment").removeClass("hasReply");var o=sCH.studentNotesC.find({TagId:this.model.get("AssociatedNoteTagId")});if(o&&o.get("ReplyCount")>0){var r=o.get("ReplyUserIds").split(",");sCH.userM.get("UserId")===parseInt(r[r.length-1])&&this.tagContainer.addClass("hasReply")}}"student"!=sCH.userM.get("Role")&&"tour"!==sCH.readerConfig.type||this.tagContainer.addClass("student")},addEvents:function(e){var t=this;this.tagContainer.find(".imgFlag").click((function(n){if(t.model.get("AssociatedNoteTagId")&&""===t.tagContainer.find(".count").text()){n.stopPropagation();var a=t.model.get("AssociatedNoteTagId"),s=sCH.studentNotesC.filter({TagId:a})[0];Backbone.pubEv.trigger("popupFullNoteShow",{model:s,scope:{tagListMode:!1,tagContainer:t.tagContainer}})}else"student"!==sCH.readerConfig.type&&"tour"!==sCH.readerConfig.type||Backbone.pubEv.trigger("flagMenuShowHide",{top:e,scope:t,show:!0})}))},toggleStudentTags:function(e){this.model.checkUserId(e.studentUserId)&&this.model.set({Visible:e.show})},destroy:function(){this.tagContainer.remove(),this.remove(),this.undelegateEvents(),this.model.off(null,null,this)}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<span class='flagTag' data-tagid=\""+(null==(__t=tag.TagId)?"":__t)+"\"></span>\r\n<div class='flagTagContainer dropdown marker' data-tagid=\""+(null==(__t=tag.TagId)?"":__t)+"\">\r\n    <div class='count'></div>\r\n    ","grading"===readerType?__p+='\r\n        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="imgFlag"></ul>\r\n        <div class="imgFlag icon-flag"\r\n             role="button"\r\n             data-toggle="dropdown"\r\n             aria-haspopup="true"\r\n             aria-expanded="false"></div>\r\n    ':__p+='\r\n        <div class="imgFlag icon-flag"></div>\r\n    ',__p+="\r\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({template:n(1784),initialize:function(e){this.teachingIdeasObj=e},render:function(e){var t=this.template({overallIdea:a.linkify(this.teachingIdeasObj.overallIdea),relatedLayers:this.teachingIdeasObj.relatedLayers,relatedLayerPrefix:"#teacher/reader/authoring/preview/"}),n=$('<div class="teachingIdeas">').html(t);return("grading"===sCH.readerConfig.type||"authoring"===sCH.readerConfig.type&&$(".btnAddTeachingIdeas").length>0)&&(n[0].style.marginTop="71px"),e.appendChild(n[0]),this},destroy:function(){$(".teachingIdeas")[0].remove(),this.remove(),this.undelegateEvents()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<h1 class="heading">Ideas for teaching this text</h1>\n<div class="overallIdea">'+(null==(__t=overallIdea)?"":__t)+"</div>\n",relatedLayers&&(__p+='\n  <h1 class="heading">Related Assignments</h1>\n'),__p+="\n<ul>\n  ",_.each(relatedLayers,(function(e){__p+='\n    <li>\n      <span class="layerHelperText">'+(null==(__t=e.helperText)?"":__t)+'</span>\n      <a class="layerLink" href="'+(null==(__t=relatedLayerPrefix+e.layerId)?"":__t)+'/notes" target="_blank">'+(null==(__t=e.title)?"":__t)+"</a>\n    </li>\n  "})),__p+="\n</ul>";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",showPrintButton&&(__p+='\n    <a class="btn-tab pull-right icon-print btnPrintView" title="Print these notes"></a>\n'),__p+='\n<p style="border-bottom:solid 1px #e8e8e8;padding:20px 30px;margin:0 -30px;margin-top:-10px;">\n    ',"grading"===readerType?(__p+='\n        <select class="ddlStudents" data-live-search="true">\n            <option value="-1" data-content="All shared notes ',sharedNotesCount&&(__p+="<span class='noteCount'>"+(null==(__t=sharedNotesCount)?"":__t)+"</span> "),__p+='"></option>\n            <option value="0" data-content="All notes ',allNotesCount&&(__p+="<span class='noteCount'>"+(null==(__t=allNotesCount)?"":__t)+"</span> "),__p+='"></option>\n            ',_.each(students,(function(e){__p+='\n            <option data-content="'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+" ",e.NoteCount&&(__p+="<span class='noteCount'>"+(null==(__t=e.NoteCount)?"":__t)+"</span> "),__p+='"\n                    value="'+(null==(__t=e.UserId)?"":__t)+'">\n                '+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"\n            </option>\n            "})),__p+="\n        </select>\n    "):"student"===readerType?__p+='\n        <a class="btn-box toggler btnSummaryToggleSharedNotes selected" data-state="all">All notes</a>\n        <a class="btn-box toggler btnSummaryToggleSharedNotes" data-state="self">Only my notes and replies</a>\n    ':"studentir"===readerType&&(__p+='\n        <a class="btn-box toggler btnSummaryToggleSharedNotes" data-state="all">All notes</a>\n        <a class="btn-box toggler btnSummaryToggleSharedNotes selected" data-state="self">Only my notes and replies</a>\n    '),__p+="\n\n    ",noteCategories.length>0||_.keys(noteCategoryNoteCounts.studentCustomCategoryNoteCounts).length>0?(__p+='\n        <select class="ddlCategories">\n            <option value="-1" selected="selected">All categories</option>\n            ',_.each(noteCategories,(function(e){__p+='\n                <option data-content="'+(null==(__t=e)?"":__t)+" ",noteCategoryNoteCounts.fixedNoteCategoryNoteCounts[e]&&(__p+="<span class='noteCount'>"+(null==(__t=noteCategoryNoteCounts.fixedNoteCategoryNoteCounts[e])?"":__t)+"</span>"),__p+='" value="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</option>\n            "})),__p+="\n            ",_.each(_.keys(noteCategoryNoteCounts.teacherCustomNoteCounts),(function(e){__p+='\n                <option data-content="'+(null==(__t=e)?"":__t)+" ",noteCategoryNoteCounts.teacherCustomNoteCounts[e]&&(__p+="<span class='noteCount'>"+(null==(__t=noteCategoryNoteCounts.teacherCustomNoteCounts[e])?"":__t)+"</span>"),__p+='" value="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</option>\n            "})),__p+="\n            ",_.keys(noteCategoryNoteCounts.studentCustomCategoryNoteCounts).length>0&&(__p+='\n                <optgroup label="Student custom categories">\n                ',_.each(_.keys(noteCategoryNoteCounts.studentCustomCategoryNoteCounts),(function(e){__p+='\n                    <option data-content="'+(null==(__t=e)?"":__t)+" ",noteCategoryNoteCounts.studentCustomCategoryNoteCounts[e]&&(__p+="<span class='noteCount'>"+(null==(__t=noteCategoryNoteCounts.studentCustomCategoryNoteCounts[e])?"":__t)+"</span>"),__p+='" value="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</option>\n                "})),__p+="\n                </optgroup>\n            "),__p+="\n                \n        </select>\n    "):__p+="\n        &nbsp;\n    ",__p+='\n</p>\n<div class="list"></div>\n';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(517),r=n(48);t.default=Backbone.View.extend({events:{"click .btnPrintView":"printSummaryView","click .btnViewInReader":"viewInReader","change .ddlStandards":"filterQuestions","change .ddlDok":"filterQuestions"},template:n(1787),initialize:function(){this.on("initialized",this.modalInitialized),this.on("cancel",this.destroy)},modalInitialized:function(e){this.modal=e;var t=this;Backbone.pubEv.on("gradingClickedQuestion",(function(){t.modal.close()}),this),i.GetQuestionSummaryViewTags({assignmentId:sCH.readerConfig.assignmentId,studentLayerId:sCH.readerConfig.studentLayerId,omitTextSectionIds:sCH.teacherQuestionsC.textSectionsLoaded,layerId:sCH.readerConfig.layerId,type:sCH.readerConfig.type,isPreview:sCH.readerConfig.isReadOnly||!1},(function(t){sCH.loadQuestionsSummaryViewData(t),e.open()})),sCH.readerConfig.isAccessExpired&&e.$el.addClass("accessExpired"),Backbone.tracking.trackGAEvent("user","questionsummaryview")},render:function(){if(0===sCH.questionsNumC.length)this.$el.html('<h4 class="sectionHeading">No questions!</h4>');else{var e=sCH.questionsNumC.toJSON().sort((function(e,t){return e.QuestionNum-t.QuestionNum})),t="student"===sCH.readerConfig.type,n=[];a.forEach(e,(function(e){e.StandardId&&n.push({StandardId:e.StandardId}),e.SecondStandardId&&n.push({StandardId:e.SecondStandardId})}));var i=a.intersectionBy(sCH.readerConfig.standards,n,"StandardId");this.tags=new o.default({tagListMode:!0});var r=sCH.userM.isPLAssignment();if(this.$el.html(this.template({showPrintButton:r||"student"!==sCH.readerConfig.type||s.isClassTeacherOnPersonalOrHigherPlan(sCH.learnEntityMetaM.get("ClassId")),readerType:sCH.readerConfig.type,standards:i||[]})),this.$el.find(".ddlStandards").selectpicker(),this.$el.find(".ddlDok").selectpicker(),(t||"studentir"===sCH.readerConfig.type)&&sCH.readerConfig.Settings.QuestionGates){var l=sCH.questionsNumC.getFirstNotAnsweredQuestion();l&&(e=a.filter(e,(function(e){return l.QuestionNum>=e.QuestionNum})))}this.renderFilteredQuestions(e)}},printSummaryView:function(){sCH.userM.isOnFreePlan()&&"student"!==sCH.userM.get("Role")?r.showBuyTeacherPopup({title:"Printing"}):s.print(sCH.learnEntityMetaM.get("Title")+" - Questions Summary","printModal")},viewInReader:function(e){this.modal.close();var t,n=$(e.currentTarget).data("tagid");sCH.teacherQuestionsC.filter({TagId:n}).length>0&&(t=sCH.teacherQuestionsC.filter({TagId:n})[0]),sCH.readerConfig.isMedia?Backbone.pubEv.trigger("skipToVideoQuestion",{questionTagId:n}):Backbone.pubEv.trigger("skipToTag",{sectionId:t.get("TextSectionId"),tagId:n,tagType:"question",fromView:"questionsummary"})},filterQuestions:function(){var e=parseInt(this.$el.find(".ddlStandards").val())||null,t=parseInt(this.$el.find(".ddlDok").val())||null,n=a.filter(sCH.questionsNumC.toJSON(),(function(n){var a=!e||(n.StandardId===e||n.SecondStandardId===e),s=!t||n.Dok===t;return a&&s})).sort((function(e,t){return e.QuestionNum-t.QuestionNum}));this.$el.find("div.sectionSummaryContainer").remove(),this.renderFilteredQuestions(n)},renderFilteredQuestions:function(e){if(0===e.length)this.$el.append('<div class="sectionSummaryContainer"><h4 class="sectionHeading">No questions!</h4></div>');else{for(var t=this,n=[],s=sCH.learnEntitySectionsMetaC.getValidSectionsJson(),i=0;i<e.length;i++){var o=sCH.teacherQuestionsC.find({TagId:e[i].QuestionTagId});o&&n.push(o)}a.each(s,(function(e,s){var i=e.TextSectionId,o=a.filter(n,(function(e){return e.get("TextSectionId")===i}));o.length&&t.$el.append('<div class="sectionSummaryContainer" data-sectionid="'+i+'"><h4 class="sectionHeading noMarginLeft">'+e.Title+"</h4></div>"),t.tags.addModelsAndRender({models:o,element:t.$el.find("div.sectionSummaryContainer[data-sectionid="+i+"]")})}))}},destroy:function(){this.tags&&this.tags.destroy()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",showPrintButton&&(__p+='\n    <a class="btn-tab pull-right icon-print btnPrintView" title="Print these questions"></a>\n'),__p+='\n<div class="container">\n    ',"authoring"!==readerType&&"grading"!==readerType||(__p+="\n            ",standards.length&&(__p+='\n                <div style="float:left; margin-right: 10px;">\n                    <span class="info">Filter by standards</span><br/>\n                    <select class="ddlStandards" data-live-search="true">\n                        <option value="">All questions</option>\n                        ',_.each(standards,(function(e){__p+='\n                            <option value="'+(null==(__t=e.StandardId)?"":__t)+'">\n                                '+(null==(__t=cH.sanitize(e.StandardCode)+" - "+cH.sanitize(e.ShortText))?"":__t)+"\n                            </option>\n                        "})),__p+="\n                    </select>\n                </div>\n            "),__p+='\n            <div style="float:left;">\n                <span class="info">Filter by DoK Levels</span><br/>\n                <select class="ddlDok">\n                    <option value="">All questions</option>\n                    ',_.each(alcfg.tags.question.dok,(function(e){__p+='\n                        <option value="'+(null==(__t=e.id)?"":__t)+'">'+(null==(__t=e.text)?"":__t)+"</option>\n                    "})),__p+="\n                </select>\n            </div>\n    "),__p+='\n</div>\n<div class="clearBoth"></div>\n<div class="list"></div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(48);t.default=Backbone.View.extend({events:{"click .btnPrintView":"printSummaryView"},template:n(1789),initialize:function(){this.on("initialized",this.modalInitialized),this.on("cancel",this.destroy),this.on("learnMore",(function(){a.windowOpen(alcfg.helpArticleLink.viewVocab,"_blank")}))},render:function(){var e=sCH.userM.isPLAssignment();this.$el.html(this.template({showPrintButton:e||"student"!==sCH.readerConfig.type||a.isClassTeacherOnPersonalOrHigherPlan(sCH.learnEntityMetaM.get("ClassId")),data:sCH.readerConfig.keyVocabularyWords}))},printSummaryView:function(){sCH.userM.isOnFreePlan()&&"student"!==sCH.userM.get("Role")?s.showBuyTeacherPopup({title:"Printing"}):a.print(sCH.learnEntityMetaM.get("Title")+" - Key Vocabulary","printModal")},destroy:function(){}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",0===data.length?__p+="\n    <div>Key vocabulary analysis is not available for this text!</div>\n":(__p+="\n    ",showPrintButton&&(__p+='\n        <a class="btn-tab pull-right icon-print btnPrintView" title="Print"></a>\n    '),__p+='\n    <div class="container">\n        <div class="info vocabSummaryHelperText">\n            We\'ve analyzed this text and identified words to help students intelligently build their vocabulary and knowledge.\n        </div>\n    </div>\n    <div class="clearBoth"></div>\n    <div class="list">\n        ',_.each(data,(function(e){__p+="\n            ",data.length>1&&(__p+='\n                <h4 class="sectionHeading noMarginLeft">'+(null==(__t=e.TextSectionTitle)?"":__t)+"</h4>\n            "),__p+="\n            ",_.each(e.Words,(function(e){__p+='\n                <div class="word pull-left">'+(null==(__t=e)?"":__t)+"</div>\n            "})),__p+='\n            <div class="clearBoth"></div>\n        '})),__p+='\n    </div>\n    <div class="clearBoth"></div>\n'),__p+="";return __p}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),i=n(24),o=n(10),r=n(5),l=n(8),d=n(492);t.default=function(e){var t=e.title,n=e.okText,c=e.callback,u=e.layerId,p=e.cssClass,h=void 0===p?"":p,g=e.allowCancel,f=void 0===g||g,m=e.redirectUrl,v=s.useState({current:[],layerOwnerId:null,potential:[]}),b=v[0],C=v[1],y=s.useState(t),_=y[0],S=y[1],w=s.useState([]),T=w[0],I=w[1],x=s.useState(!1),k=x[0],E=x[1],N=b.layerOwnerId,A=l.sortBy(b.current,(function(e){return e.UserId!==b.layerOwnerId})),M=b.current.map((function(e){return e.UserId})),H=b.potential.filter((function(e){return-1===M.indexOf(e.UserId)}));function R(){m&&(window.location.hash=m)}return s.useEffect((function(){o.GetLayerAuthors({layerId:u},(function(e){C(e),E(!0)}))}),[]),s.useEffect((function(){if(k){var e=!0;if(b.potential.length>0){var t=b.potential[0].SchoolName;e=b.potential.every((function(e){return e.SchoolName===t}))}e&&S("Invite teachers in your school to co-author")}}),[k]),k&&s.createElement(d.default,{modalTitle:_,okText:n,disabledOkText:"Inviting...",allowCancel:f,cssClass:h,okCallback:function(e){T.length>0&&o.AddLayerAuthors({layerId:u,userIds:T},(function(t){if(t.length>0){var n=t.map((function(e){return b.potential.find((function(t){return t.UserId===e})).FullName})),a="Unable to add any co-author. Teachers who are not on Prime plan cannot be added as co-authors. The following "+r.plural(n,"teacher is","teachers are")+" not on the Prime plan: "+n.join(", ")+".";r.bootstrap.alert({message:a,alert:"danger"}),e.enableOkButton("Invite")}else{r.intercom("trackEvent","added-Coauthor"),r.bootstrap.alert({message:"New co-authors will be notified via email."});for(var s=T.map((function(e){return b.potential.find((function(t){return t.UserId===e})).FullName})),o=b.current.map((function(e){return e.FullName})).concat(s).join(", "),l=function(e){var t=H.find((function(t){return t.UserId===e}));sCH.readerConfig.layerCoauthorNameMap.push({FullName:t.FullName,UserId:e,LayerId:u,LayerAuthorUserId:N,CreateDate:moment.utc()})},d=0,p=T;d<p.length;d++){l(p[d])}c&&c({coauthorsUpdatedList:o}),Backbone.pubEv.trigger("cancelSelectMode"),i.hideModals(),R()}}))},cancelCallback:m?R:void 0,header:"Co-authoring allows multiple teachers to edit the same assignment.",signupEmailContent:b.potential.length>0&&r.getSignupEmailContent(),users:H,currentAuthors:A,removeCoauthor:function(e){var t=b.layerOwnerId===sCH.userM.get("UserId")?"this teacher":"yourself",n=$(e.currentTarget).data("userid");i.showModal(s.createElement(i.default,{title:"Remove co-author?",okText:"Remove Co-author",okCallback:function(){return function(e){o.RemoveCoauthor({coauthorUserId:e,layerId:u},(function(t){if(t){var n,s=!0;sCH.readerConfig.layerCoauthorNameMap.filter((function(e,t){var a=e.LayerId===u&&e.UserId!==sCH.userM.get("UserId");return a&&s&&(n=t,s=!1),a}))[0].UserId===e&&sCH.readerConfig.layerCoauthorNameMap.splice(n,1);var o=A.find((function(t){return t.UserId===e})).FullName;r.bootstrap.alert({message:o+" has been removed as a coauthor from this assignment."});var l=b.current.filter((function(t){return t.UserId!==e}));C(a(a({},b),{current:l}));var d=l.map((function(e){return e.FullName})).join(", ");c&&c({coauthorsUpdatedList:d}),b.layerOwnerId!==sCH.userM.get("UserId")&&$(".btnExitReader").click()}i.hideModals()}))}(n)}},"Are you sure you want to remove ",t," as a co-author?"))},selectedUserIds:T,noSelectionMsg:"Please select 1 or more colleagues to co-author this assignment with!",setSelectedUserIds:I,hasPermissionToRemoveCoAuthor:function(e){return b.layerOwnerId!==e.UserId&&(b.layerOwnerId===sCH.userM.get("UserId")||e.UserId===sCH.userM.get("UserId"))},noUserText:"Currently, no other teachers at your school are on the Prime plan. Get a coworker to create an account and then add them as a co-author here."})}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","gradeunanswered"===type?(__p+='\r\n    <div class="info" style="position:absolute;bottom:-48px;">Note: Actively Learn will need to reload.</div>\r\n    ',(sections.length>1||sCH.learnEntityMetaM.get("LayerTextSectionExcerptId"))&&(__p+="\r\n        ",sCH.learnEntityMetaM.get("LayerTextSectionExcerptId")||(__p+='\r\n            <div class="topNavMenu">\r\n                <a class="btn-box toggler" data-type="bysection">By Section</a>\r\n                <a class="btn-box toggler" data-type="byquestionrange">By Question Range</a>\r\n            </div>\r\n        '),__p+='\r\n        <div class="bysection bulktype">\r\n            <p>\r\n                Select sections to bulk grade below.\r\n                For unanswered questions: students will receive a "Zero", lose any drafts and no longer be able to respond.\r\n            </p>\r\n            <ul class="checklist">\r\n                ',_.each(sections,(function(e){__p+='\r\n                <li>\r\n                    <div class="checkbox">\r\n                        <input id="section'+(null==(__t=e.TextSectionId)?"":__t)+'" type="checkbox" class="regular-checkbox" />\r\n                        <label for="section'+(null==(__t=e.TextSectionId)?"":__t)+'"></label>\r\n                    </div>\r\n                    <div class="title">'+(null==(__t=""===e.Title?"Section":cH.sanitize(e.Title))?"":__t)+"</div>\r\n                </li>\r\n                "})),__p+="\r\n            </ul>\r\n        </div>\r\n    "),__p+="\r\n    ",sCH.learnEntityMetaM.get("LayerTextSectionExcerptId")||(__p+='\r\n        <div class="byquestionrange bulktype">\r\n            <p>\r\n                Enter a question range to bulk grade below.\r\n                For unanswered questions: students will receive a "Zero", lose any drafts and no longer be able to respond.\r\n            </p>\r\n            Question number <input id="txtBulkGradeQNumStart" class="smallInput" style="background: #FFF;border: solid 1px #b3b3b3;">\r\n            <span> through </span>\r\n            <input id="txtBulkGradeQNumEnd" class="smallInput" style="background: #FFF;border: solid 1px #b3b3b3;">\r\n            <span class="info" style="font-size: 14px;margin-left: 10px;">('+(null==(__t=sCH.questionsNumC.length)?"":__t)+" total questions in assignment)</span>\r\n        </div>\r\n    "),__p+="\r\n"):(__p+="\r\n    ","hidesections"===type?__p+='\r\n        <p>Please select the sections which you want to hide from this assignment. Your students will not see those sections in their reader.</p>\r\n        <p class="info">Note: You cannot select sections that already have student data. The reader will be reloaded after this action.</p>\r\n    ':__p+="\r\n        <p>Please select the sections for which you want to remove questions. If student responses exist for any of these questions, they will also be deleted.</p> \r\n    ",__p+='\r\n    <ul class="checklist">\r\n        ',_.each(sections,(function(e){__p+='\r\n        <li class="'+(null==(__t="hidesections"===type&&e.HasStudentData&&!e.IsDeleted?"disabled":"")?"":__t)+'">\r\n            <div class="checkbox">\r\n                <input id="section'+(null==(__t=e.TextSectionId)?"":__t)+'" type="checkbox" class="regular-checkbox" \r\n                    '+(null==(__t="hidesections"===type&&e.IsDeleted?'checked="checked"':"")?"":__t)+"\r\n                    "+(null==(__t="hidesections"===type&&e.HasStudentData&&!e.IsDeleted?"disabled":"")?"":__t)+' />\r\n                <label for="section'+(null==(__t=e.TextSectionId)?"":__t)+'"></label>\r\n            </div>\r\n            <div class="title">'+(null==(__t=""===e.Title?1===sections.length?"Entire Text":"Section":e.Title)?"":__t)+"</div>\r\n        </li>\r\n        "})),__p+="\r\n    </ul>\r\n"),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=n(5),i=n(8);void 0!==window.responsiveVoice&&(console.log("ResponsiveVoice already loaded"),console.log(window.responsiveVoice));t.default=new function(){var e=this,t=[{name:"English, US (Joanna)",pollyVoiceId:"Joanna",language:"en"},{name:"English, US (Joey)",pollyVoiceId:"Joey",language:"en"},{name:"English, British (Emma)",pollyVoiceId:"Emma",language:"en"},{name:"English, British (Brian)",pollyVoiceId:"Brian",language:"en"},{name:"French (Cline)",pollyVoiceId:"Celine",language:"fr"},{name:"French (Mathieu)",pollyVoiceId:"Mathieu",language:"fr"},{name:"Spanish (Penlope)",pollyVoiceId:"Penelope",language:"es"},{name:"Spanish (Miguel)",pollyVoiceId:"Miguel",language:"es"},{name:"German (Marlene)",pollyVoiceId:"Marlene",language:"de"},{name:"German (Hans)",pollyVoiceId:"Hans",language:"de"},{name:"Arabic (Zeina)",pollyVoiceId:"Zeina",language:"ar"},{name:"Danish (Naja)",pollyVoiceId:"Naja",language:"da"},{name:"Danish (Mads)",pollyVoiceId:"Mads",language:"da"},{name:"Dutch (Lotte)",pollyVoiceId:"Lotte",language:"nl"},{name:"Dutch (Ruben)",pollyVoiceId:"Ruben",language:"nl"},{name:"Hindi (Aditi)",pollyVoiceId:"Aditi",language:"hi"},{name:"Icelandic (Dora)",pollyVoiceId:"Dora",language:"is"},{name:"Icelandic (Karl)",pollyVoiceId:"Karl",language:"is"},{name:"Italian (Bianca)",pollyVoiceId:"Bianca",language:"it"},{name:"Italian (Giorgio)",pollyVoiceId:"Giorgio",language:"it"},{name:"Japanese (Mizuki)",pollyVoiceId:"Mizuki",language:"ja"},{name:"Japanese (Takumi)",pollyVoiceId:"Takumi",language:"ja"},{name:"Korean (Seoyeon)",pollyVoiceId:"Seoyeon",language:"ko"},{name:"Norwegian (Liv)",pollyVoiceId:"Liv",language:"no"},{name:"Polish (Ewa)",pollyVoiceId:"Ewa",language:"pl"},{name:"Polish (Jacek)",pollyVoiceId:"Jacek",language:"pl"},{name:"Portuguese (Ines)",pollyVoiceId:"Ines",language:"pt"},{name:"Portuguese (Cristiano)",pollyVoiceId:"Cristiano",language:"pt"},{name:"Romanian (Carmen)",pollyVoiceId:"Carmen",language:"ro"},{name:"Russian (Tatyana)",pollyVoiceId:"Tatyana",language:"ru"},{name:"Russian (Maxim)",pollyVoiceId:"Maxim",language:"ru"},{name:"Swedish (Astrid)",pollyVoiceId:"Astrid",language:"sv"},{name:"Turkish (Filiz)",pollyVoiceId:"Filiz",language:"tr"},{name:"Welsh (Gwyneth)",pollyVoiceId:"Gwyneth",language:"cy"}],n=!0,o=function(e){if(e.length>1400){var t=new RegExp("(.{1,1400}(s|$))s*","g");return e.match(t)}return[e]};e.fallback_playing=!1,e.fallback_parts=null,e.fallback_part_index=0,e.fallback_audio=null,e.fallback_speechmarks_parts=null,e.msgparameters=null,e.timeoutId=null,e.speechMarkAjax=null,e.isPopupOpen=!0,e.init=function(){n=!0},e.getVoices=function(e){if(!e)return t;var n=i.filter(t,{language:e});return n&&n.length>0?n:i.filter(t,{language:"en"})},e.getMultipartText=function(e){var t=[];if(e.length>1400){for(var n=e.match(/([^\.!\?]+[\.!\?]+)|([^\.!\?]+$)/g),a=n.shift(),s=0;s<n.length;s++)(a+n[s]).length>1400?(t=t.concat(o(a)),a=n[s]):a+=n[s];t=t.concat(o(a))}else t.push(e);return t},e.initFallbackPartsAudio=function(e,t,n,a){for(var i=[],o=s.getHostName(alcfg.node.reader.tts)+alcfg.node.reader.tts,r=0;r<e.length;r++){var l=o+"?text="+encodeURIComponent(e[r])+"&rate="+t.rate+"&voiceId="+n+"&startIndex="+t.startIndex+"&endIndex="+t.endIndex+"&voice="+t.voice+"&textSectionId="+t.textSectionId+"&assignmentId="+t.assignmentId+"&studentLayerId="+t.studentLayerId+"&readerType="+t.readerType+"&isPreview="+t.isPreview+"&partIndex="+r+"&isPlayEntireText="+t.isPlayEntireText,d=document.createElement("AUDIO");d.src=l,d.preload="auto",d.volume=1,d.addEventListener("error",(function(e){a()})),i.push(d)}return i},e.fetchSpeechmarkForMultipartsText=function(t,n,a){e.fallback_speechmark_parts=[],e.totalSpeechmarkChunksReceived=0,e.isPopupOpen=!0;for(var s=0;s<t.length;s++)e.getSpeechmark({text:t[s],rate:n.rate,voiceId:a,partIndex:s,onSuccess:function(n,a){e.isPopupOpen&&(e.fallback_parts=e.fallback_parts||[],e.totalSpeechmarkChunksReceived++,e.fallback_speechmark_parts[a]=e.parseSpeechmarkOutput(n),t.length===e.totalSpeechmarkChunksReceived&&(e.fallback_part_index=0,e.fallback_startPart()))},onError:function(){e.fallback_speechmark_parts=null,e.isPopupOpen=!1,e.fallback_part_index=0}})},e.speak=function(t,a,s,i){e.msgparameters=s||{},e.msgvoicename=a;var o=e.getMultipartText(t),r=e.getPollyVoiceIdByName(a);e.fallback_parts=e.initFallbackPartsAudio(o,s,r,i),e.fallback_speechmarks_parts=[],n&&(s.fetchSpeechmark&&!e.msgparameters.isDevice?e.fetchSpeechmarkForMultipartsText(o,s,r):(e.msgparameters.isDevice||(e.fallback_speechmark_parts=null),e.fallback_part_index=0,e.fallback_startPart()))},e.getPollyVoiceIdByName=function(e){return i.find(t,{name:e}).pollyVoiceId},e.getSpeechmark=function(t){var n=t.text,s=t.rate,i=t.voiceId,o=t.partIndex,r=t.onSuccess,l=t.onError;e.msgparameters.isDevice||a.GetSpeechmark({text:n,rate:s,voiceId:i,partIndex:o},r,l)},e.parseSpeechmarkOutput=function(e){var t=[],n=e.replaceAll("\n",",");return null!=n&&n.length&&","===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),t=t.concat(JSON.parse("["+n+"]"))},e.startTimeout=function(t,n){e.timeoutId=setTimeout(n,60/140*1e3*t.split(/\s+/).length)},e.checkAndCancelTimeout=function(){null!=e.timeoutId&&(clearTimeout(e.timeoutId),e.timeoutId=null)},e.speech_timedout=function(){e.cancel(),e.speech_onend()},e.speech_onend=function(){e.checkAndCancelTimeout(),!0!==e.cancelled?null!=e.msgparameters&&null!=e.msgparameters.onend&&1!=e.msgparameters.onendcalled&&(e.msgparameters.onendcalled=!0,e.msgparameters.onend()):e.cancelled=!1},e.speech_onstart=function(){e.msgparameters.onendcalled=!1,null!=e.msgparameters&&null!=e.msgparameters.onstart&&e.msgparameters.onstart()},e.playAudioFromBeginning=function(){this.fallback_part_index=0,this.fallback_parts[0].currentTime=0,this.fallback_startPart()},e.fallback_startPart=function(){0==e.fallback_part_index&&e.speech_onstart(),e.fallback_audio=e.fallback_parts[e.fallback_part_index],e.fallback_audio?(e.fallback_speechmark_parts&&e.fallback_speechmark_parts.length>0&&(e.fallback_audio.onplaying=function(){e.fallback_speechmark_parts&&e.fallback_speechmark_parts[e.fallback_part_index]&&e.msgparameters.highlightSpeechmark(e.fallback_speechmark_parts[e.fallback_part_index])}),e.msgparameters&&e.msgparameters.onChunkPlayed&&e.msgparameters.onChunkPlayed(e.fallback_audio),$(".texttospeech").is(":visible")&&e.fallback_audio.play(),e.fallback_audio.addEventListener("ended",e.fallback_finishPart)):console.log("RV: Fallback Audio is not available")},e.fallback_finishPart=function(t){e.checkAndCancelTimeout(),e.fallback_parts&&e.fallback_part_index<e.fallback_parts.length-1?(e.fallback_part_index++,e.fallback_startPart()):e.speech_onend()},e.cancel=function(){e.checkAndCancelTimeout(),e.isPopupOpen=!1,n&&null!=e.fallback_audio&&e.fallback_audio.pause()},"undefined"==typeof $?document.addEventListener("DOMContentLoaded",(function(){e.init()})):$(document).ready((function(){e.init()}))}},,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container" id=\'textToSpeechWrapper\'>\n    <div class="info">\n        <span class="word">Loading...</span>\n        <span class="btnPlayFromBeginning pull-left icon-previous-play displayNone"></span>\n        <span class="btnPlay pull-left icon-play displayNone"></span>\n        <span class="btnResume pull-left icon-resume displayNone"></span>\n        <span class="btnPause pull-left icon-pause displayNone"></span>\n        <a class="pull-right icon-cancel btnClose"></a>\n    </div>\n\n    <div class="clearBoth" style="height:20px;"></div>\n\n    <div class="settings">\n        <p>Voice</p>\n        <select class="ddlVoices">\n            ',_.each(voices,(function(e){__p+='\n            <option value="'+(null==(__t=e.name)?"":__t)+'">'+(null==(__t=e.name)?"":__t)+"</option>\n            "})),__p+='\n        </select>\n        <div class="clearBoth" style="height:40px;"></div>\n\n        <p>Reading Speed</p>\n        <input id="rateSlider" type="text" data-slider-min="0" data-slider-max="4" data-slider-step="1"\n            data-slider-value="'+(null==(__t=rate)?"":__t)+'" data-slider-tooltip="hide" />\n        <div class="clearBoth" style="height:20px;"></div>\n        ',showHighlightWordToggle&&(__p+='\n        <div class="switch '+(null==(__t=disableWordHighlighting?"disabled":"")?"":__t)+'">\n            <label>\n                <input id="chkHighlightWordWhenSpeaking" type="checkbox"\n                    '+(null==(__t=disableWordHighlighting?"disabled":"")?"":__t)+"\n                    "+(null==(__t=highlightWordBeingReadState?'checked="checked"':"")?"":__t)+' class="chkHighlightWordWhenSpeaking">\n                <span class="lever"></span>\n                <span class="title highlightWordWhenSpeaking">Highlight word being spoken</span>\n            </label>\n        </div>\n        '),__p+='\n    </div>\n\n    <div class="clearBoth" style="height:40px;"></div>\n    <p>Provided by Amazon</p>\n</div>';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(22),r=n(38),l=n(494),d=n(137),c=n(13),u=c.createMuiTheme,p=c.MuiThemeProvider,h=c.withStyles,g=u({typography:{useNextVariants:!0,fontFamily:"AvenirNextLTW02-Medium"},palette:{primary:{light:d.lightBlue[500],main:d.lightBlue[500],dark:d.lightBlue[800],contrastText:"#FFF"}}}),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!0},t.done=function(){sCH.readerConfig.editTextMode=!1,t.setState({open:!1}),Backbone.pubEv.trigger("popupAddTagHide");var e=$("div.editTextBarContainer");o.unmountReactComponent(e[0])},t}return s(t,e),t.prototype.render=function(){return i.createElement(p,{theme:g},i.createElement(l.default,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.open,ContentProps:{"aria-describedby":"message-id"},message:i.createElement("span",{id:"message-id"},'Highlight text and select "Replace highlighted text" to fix text errors.'),action:[i.createElement(r.default,{key:1,color:"primary",size:"small",onClick:this.done},"Cancel")],classes:{root:this.props.classes.banner}}))},t}(i.Component);t.default=h({banner:{fontSize:14,top:50,"& > div":{height:50},"& button":{fontFamily:"Avenir Next LT W02 Bold"}}})(f)},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="left">\r\n    ';var exitTooltip=isReadOnly?"Exit Preview":"Exit";if(__p+='\r\n    <a href="javascript:void(0)" class="btn-tab icon-chevron btnExitReader" title="'+(null==(__t=exitTooltip)?"":__t)+'"></a>\r\n    ',isAssessment||isPDF||bowser.mobile||(__p+='\r\n        <button class="btn-tab icon-fontsize btnReaderSettingsView" title="Text settings"></button>\r\n    '),__p+="\r\n    ","authoring"!==type&&"studentir"!==type&&"studentresearch"!==type&&notifications&&(__p+='\r\n        <a href="javascript:void(0)" class="btn-tab icon-notification btnNotifications inactive" title="Notifications">\r\n            <div class="notificationCount"></div>\r\n            <div class="container"></div>\r\n        </a>\r\n    '),__p+="\r\n\r\n    ","authoring"===type&&!1!==sCH.readerConfig.showAuthoringActions&&(__p+='\r\n        <div class="dropdown sharingDropdown">\r\n            <button class="btn-tab icon-people btnShareDropdown" title="Share options"\r\n                data-toggle="dropdown"\r\n                aria-haspopup="true"\r\n                aria-expanded="false"></button>\r\n            <ul class="dropdown-menu" aria-labelledby="btnShareDropdown">\r\n                <li><a href="javascript:void(0)" class="btnInviteCoauthors">\r\n                    Co-author <span class="primeFeature icon-premium-lock" /></a></li>\r\n                <li><a href="javascript:void(0)" class="btnShareLayer">Send a copy to colleagues</a></li>\r\n                ',sCH.userM.hasManageLibraryPermissions()&&!sCH.readerConfig.isInLibrary&&(__p+='\r\n                    <li><a href="javascript:void(0)" class="btnAddToLibrary">Add to '+(null==(__t=sCH.userM.getLibraryString())?"":__t)+"</a></li>\r\n                "),__p+="\r\n            </ul>\r\n        </div>\r\n        ",bowser.mobile||isReadOnly&&!sCH.userM.isAnonUser()||(__p+='\r\n            <div class="dropdown authoringDropdown">\r\n                <button class="btn-tab icon-authoring btnAuthoringDropdown" title="Authoring options"\\\r\n                    data-toggle="dropdown"\r\n                    aria-haspopup="true"\r\n                    aria-expanded="false"></button>\r\n                <ul class="dropdown-menu" aria-labelledby="btnAuthoringDropdown">\r\n                    ',isReadOnly||(__p+="\r\n                        ",isAssessment?(__p+='\r\n                            <li class="dropdown-submenu">\r\n                                <a href="javascript:void(0)">Randomize questions <span class="primeFeature icon-premium-lock" /></a>\r\n                                <ul class="dropdown-menu ddlRandomizeQuestion">\r\n                                    <li><a href="javascript:void(0)" data-option="yes" class="',print(randomizeQuestionOrder?"selected":""),__p+='">Yes</a></li>\r\n                                    <li><a href="javascript:void(0)" data-option="no" class="',print(randomizeQuestionOrder?"":"selected"),__p+='">No</a></li>\r\n                                </ul>\r\n                            </li>\r\n                        '):(__p+='\r\n                            <li class="dropdown-submenu">\r\n                                <a href="javascript:void(0)">Mark assignment as quiz</a>\r\n                                <ul class="dropdown-menu ddlMarkAsQuiz">\r\n                                    <li><a href="javascript:void(0)" data-option="yes" class="',print(isMarkedAsQuiz?"selected":""),__p+='">Yes</a></li>\r\n                                    <li><a href="javascript:void(0)" data-option="no" class="',print(isMarkedAsQuiz?"":"selected"),__p+='">No</a></li>\r\n                                </ul>\r\n                            </li>\r\n                            ',isGoogleSection||(__p+='\r\n                                <li><a href="javascript:void(0)" class="btnTextError">Report text error</a></li>\r\n                            '),__p+="\r\n                            ",canEditSectionText&&(__p+='\r\n                                <li>\r\n                                    <a href="javascript:void(0)" class="btnEditSection">Fix text errors <span class="primeFeature icon-premium-lock" /></a>\r\n                                </li>\r\n                            '),__p+="\r\n                        "),__p+='\r\n                        <li class="divider"></li>\r\n                        <li><a href="javascript:void(0)" class="btnDeleteSectionQuestions">Remove questions by section</a></li>\r\n                        ',isAssessment||(__p+='\r\n                            <li><a href="javascript:void(0)" class="btnClearLayer">Remove all questions and notes</a></li>\r\n                            ',sections.length>1&&!isPDF&&!sCH.learnEntityMetaM.get("RentalPrices")&&(__p+='\r\n                                <li><a href="javascript:void(0)" class="btnHideSections">Hide text sections <span class="primeFeature icon-premium-lock" /></a></li>\r\n                            '),__p+="\r\n                        "),__p+="\r\n                    "),__p+="\r\n                </ul>\r\n            </div>\r\n        "),__p+="\r\n    "),__p+="\r\n\r\n    ",!printButtonState.visible||bowser.mobile||isPDF||(__p+='\r\n        <button class="icon-print ',print(printButtonState.buttonClass),__p+='  btn-tab btnPrintView"\r\n            title="',print(printButtonState.buttonHint),__p+='">\r\n        </button>\r\n    '),__p+="\r\n\r\n    ",!bowser.mobile&&summaryViewsButtonOptions.length>0&&isPDF&&(__p+='\r\n        <div class="dropdown summaryViewsDropdown">\r\n            <button class="icon-notebook btnSummaryViewsDropdown btn-tab"\r\n                title="'+(null==(__t=summaryViewsButtonOptions.join(", "))?"":__t)+'"\r\n                data-toggle="dropdown"\r\n                aria-haspopup="true"\r\n                aria-expanded="false"></button>\r\n            <ul class="dropdown-menu" aria-labelledby="btnSummaryViewsDropdown">\r\n                ',summaryViewsButtonOptions.indexOf("Notes")>-1&&(__p+='\r\n                    <li><a href="javascript:void(0)" class="btnNoteSummaryView">View notes</a></li>\r\n                '),__p+="\r\n                ",summaryViewsButtonOptions.indexOf("Questions")>-1&&(__p+='\r\n                    <li><a href="javascript:void(0)" class="btnQuestionSummaryView">View questions</a></li>\r\n                '),__p+="\r\n                ",summaryViewsButtonOptions.indexOf("Vocab")>-1&&(__p+='\r\n                    <li><a href="javascript:void(0)" class="btnVocabSummaryView">View key vocabulary</a></li>\r\n                '),__p+="\r\n                ",printButtonState.visible&&(__p+='\r\n                    <li><a href="javascript:void(0)" class="btnPrintView">Print text'+(null==(__t="student"!==sCH.userM.get("Role")?'<span class="primeFeature icon-premium-lock" />':"")?"":__t)+"</a></li>\r\n                "),__p+="\r\n            </ul>\r\n        </div>\r\n    "),__p+="\r\n\r\n    ",isAssessment||bowser.mobile||(__p+='\r\n        <div class="dropdown searchDropdown">\r\n            <select class="ddlSearchResults" data-live-search="true"></select>\r\n        </div>\r\n    '),__p+="\r\n    ",sections.length>1&&(__p+='\r\n        <div class="dropdown sectionsDropdown">\r\n            <button class="btn-tab icon-openbook btnSectionsDropdown" title="Table of Contents"\r\n                data-toggle="dropdown"\r\n                aria-haspopup="true"\r\n                aria-expanded="false"></button>\r\n            <ul class="dropdown-menu" aria-labelledby="btnSectionsDropdown">\r\n                ',summaryViewsButtonOptions.length>0&&(__p+="\r\n                    ",summaryViewsButtonOptions.indexOf("Notes")>-1&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnNoteSummaryView">View notes</a></li>\r\n                    '),__p+="\r\n                    ",summaryViewsButtonOptions.indexOf("Questions")>-1&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnQuestionSummaryView">View questions</a></li>\r\n                    '),__p+="\r\n                    ",summaryViewsButtonOptions.indexOf("Vocab")>-1&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnVocabSummaryView">View key vocabulary</a></li>\r\n                    '),__p+='\r\n                    <li class="divider"></li>\r\n                '),__p+="\r\n                ",_.each(sections,(function(e){!0!==e.IsDeleted&&(__p+='\r\n                <li data-textsectionid="'+(null==(__t=e.TextSectionId)?"":__t)+'" data-order="'+(null==(__t=e.SectionNum)?"":__t)+'">\r\n                    <a href="javascript:void(0)" class="',print(-1===e.Truncated?"disabled":"enabled"),__p+="\r\n                        ",print(e.TextSectionId===currentSectionId?"selected":""),__p+='">'+(null==(__t=cH.sanitize(e.Title))?"":__t)+"</a>\r\n                </li>\r\n                    ")})),__p+="\r\n            </ul>\r\n        </div>\r\n    "),__p+="\r\n\r\n    ",isPDF&&(__p+='\r\n        <div class="pdfContainer"></div>\r\n    '),__p+="\r\n\r\n    ",bowser.mobile&&(__p+='\r\n        <div class="dropdown moreActionsDropdown">\r\n            <button class="btn-tab icon-moreoption btnMoreActions"\r\n                data-toggle="dropdown"\r\n                aria-haspopup="true"\r\n                aria-expanded="false"></button>\r\n            <ul class="dropdown-menu btnMoreActionsDropdown" aria-labelledby="btnMoreActions">\r\n                ',sCH.readerSettingsM.get("IsAssigned")&&"authoring"===sCH.readerConfig.type&&(__p+='\r\n                    <li class="dropdown-submenu">\r\n                        <a href="javascript:void(0)" class="moreOptionSubmenu">Grade</a>\r\n                        <ul class="dropdown-menu mobileSubMenu">\r\n                            ',assignedClasses.forEach((function(e){var t="#teacher/reader/grading/"+e.AssignmentId+(sCH.readerConfig.isAssessment||sCH.userM.isOnFreePlan()?"/grading":"/data"),n=sCH.classesC.find({ClassId:e.ClassId}).get("Name"),a=e.ExcerptTitle?" ("+e.ExcerptTitle+")":sCH.learnEntitySectionsMetaC.length>1?" (Entire text)":"";__p+='\r\n                            <li class="'+(null==(__t=currentClassId===e.ClassId?"selected disabled assignmentLink":"assignmentLink")?"":__t)+'">\r\n                                <a href="javascript:void(0)" onclick="cH.openReaderUrl(\''+(null==(__t=t)?"":__t)+"')\" >"+(null==(__t=n)?"":__t)+(null==(__t=a)?"":__t)+"</a>\r\n                            </li>\r\n                            "})),__p+='\r\n                        </ul>\r\n                    </li>\r\n                    <li class="divider"></li>\r\n                '),__p+="\r\n\r\n                ","grading"===type&&(sCH.learnEntityMetaM.get("LayerUserIds")||"").indexOf(sCH.userM.get("UserId"))>-1&&(__p+='\r\n                    <li class="btnGoToEditLayer" title="Edit questions and notes"><a href="javascript:void(0)">Edit</a></li>\r\n                    ',isAssessment||isPDF||(__p+='\r\n                        <li class="divider"></li>\r\n                    '),__p+="\r\n                "),__p+="\r\n\r\n                ",isAssessment||isPDF||(__p+='\r\n                    <li class="btnReaderSettingsView"><a href="javascript:void(0)">Text settings</a></li>\r\n                '),__p+="\r\n\r\n                ","authoring"!==type||!1===sCH.readerConfig.showAuthoringActions||isReadOnly&&!sCH.userM.isAnonUser()||(__p+="\r\n                    ",isReadOnly||(__p+='\r\n                        <li class="divider"></li>\r\n                        ',isAssessment?(__p+='\r\n                            <li class="dropdown-submenu">\r\n                                <a href="javascript:void(0)" class="moreOptionSubmenu">Randomize questions <span class="primeFeature icon-premium-lock" /></a>\r\n                                <ul class="dropdown-menu ddlRandomizeQuestion mobileSubMenu">\r\n                                    <li><a href="javascript:void(0)" data-option="yes" class="',print(randomizeQuestionOrder?"selected":""),__p+='">Yes</a></li>\r\n                                    <li><a href="javascript:void(0)" data-option="no" class="',print(randomizeQuestionOrder?"":"selected"),__p+='">No</a></li>\r\n                                </ul>\r\n                            </li>\r\n                        '):(__p+='\r\n                            <li class="dropdown-submenu">\r\n                                <a href="javascript:void(0)" class="moreOptionSubmenu">Mark assignment as quiz</a>\r\n                                <ul class="dropdown-menu ddlMarkAsQuiz mobileSubMenu">\r\n                                    <li><a href="javascript:void(0)" data-option="yes" class="',print(isMarkedAsQuiz?"selected":""),__p+='">Yes</a></li>\r\n                                    <li><a href="javascript:void(0)" data-option="no" class="',print(isMarkedAsQuiz?"":"selected"),__p+='">No</a></li>\r\n                                </ul>\r\n                            </li>\r\n                            ',isGoogleSection||(__p+='\r\n                                <li><a href="javascript:void(0)" class="btnTextError">Report text error</a></li>\r\n                            '),__p+="\r\n                        "),__p+='\r\n                        <li><a href="javascript:void(0)" class="btnDeleteSectionQuestions">Remove questions by section</a></li>\r\n                        ',isAssessment||(__p+='\r\n                            <li><a href="javascript:void(0)" class="btnClearLayer">Remove all questions and notes</a></li>\r\n                            ',sections.length>1&&!isPDF&&!sCH.learnEntityMetaM.get("RentalPrices")&&(__p+='\r\n                                <li><a href="javascript:void(0)" class="btnHideSections">Hide text sections <span class="primeFeature icon-premium-lock" /></a></li>\r\n                            '),__p+="\r\n                        "),__p+="\r\n                    "),__p+="\r\n                "),__p+="\r\n\r\n                ",!sCH.userM.isAnonUser()&&summaryViewsButtonOptions.length>0&&isPDF&&(__p+="\r\n                    ","student"===sCH.readerConfig.type&&(isAssessment||isPDF)||(__p+=' \r\n                        <li class="divider"></li>\r\n                    '),__p+="\r\n                    ",summaryViewsButtonOptions.indexOf("Notes")>-1&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnNoteSummaryView">View notes</a></li>\r\n                    '),__p+="\r\n                    ",summaryViewsButtonOptions.indexOf("Questions")>-1&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnQuestionSummaryView">View questions</a></li>\r\n                    '),__p+="\r\n                    ",summaryViewsButtonOptions.indexOf("Vocab")>-1&&"student"!==type&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnVocabSummaryView">View key vocabulary</a></li>\r\n                    '),__p+="\r\n                    ",printButtonState.visible&&(__p+='\r\n                        <li><a href="javascript:void(0)" class="btnPrintView">Print text'+(null==(__t="student"!==sCH.userM.get("Role")?'<span class="primeFeature icon-premium-lock" />':"")?"":__t)+"</a></li>\r\n                    "),__p+="\r\n                "),__p+="\r\n\r\n                ",!printButtonState.visible||printButtonState.notAllowedByPublisher||isPDF||(__p+='\r\n                    <li class="divider"></li>\r\n                    <li><a href="javascript:void(0)" class="btnPrintView">Print text'+(null==(__t="student"!==sCH.userM.get("Role")?'<span class="primeFeature icon-premium-lock" />':"")?"":__t)+"</a></li>\r\n                "),__p+="\r\n            </ul>\r\n        </div>\r\n        \r\n        ",showAssign&&(__p+='\r\n            <button class="btn-box btnAssignToClasses" title="Assign to classes">Assign</button>\r\n        '),__p+="\r\n    "),__p+='\r\n\r\n    <button class="titleContainer clickableContainer">\r\n        <div class="title">'+(null==(__t=cH.sanitize(title))?"":__t)+"</div>    \r\n    </button>\r\n\r\n    ","student"===type&&(isLocked||futureLockState)&&(__p+='\r\n        <span class="icon-lock '+(null==(__t=isLocked?"isLocked":"")?"":__t)+'" title="'+(null==(__t=futureLockState?"This assignment will "+futureLockState.lockType+" at "+futureLockState.lockOrUnlockChangeDate:"")?"":__t)+'"></span>\r\n    '),__p+="\r\n\r\n    ",isPDF&&(__p+='<a href="javascript:void(0)" class="pdfHint">PDF</a>'),__p+="\r\n\r\n    ",!bowser.mobile&&showAssign){var tooltip="grading"===sCH.readerConfig.type?"Assign to other classes":"";__p+="\r\n        ","grading"!==sCH.readerConfig.type&&"authoring"!==sCH.readerConfig.type||(__p+='\r\n            <div class="dropdown '+(null==(__t=sCH.readerSettingsM.get("IsAssigned")?"":"displayNone")?"":__t)+'">\r\n                <button class="btn-box btnAssignmentDropdown"\r\n                    data-toggle="dropdown"\r\n                    aria-haspopup="true"\r\n                    aria-expanded="false">\r\n                    Grade\r\n                    <span class="caret"></span>\r\n                </button>\r\n                <ul class="dropdown-menu assignmentDropdown" aria-labelledby="btnAssignmentDropdown">\r\n                    ',assignedClasses.forEach((function(e){var t="#teacher/reader/grading/"+e.AssignmentId+(sCH.readerConfig.isAssessment||sCH.userM.isOnFreePlan()?"/grading":"/data"),n=sCH.classesC.find({ClassId:e.ClassId}).get("Name"),a=e.ExcerptTitle?" ("+e.ExcerptTitle+")":sCH.learnEntitySectionsMetaC.length>1?" (Entire text)":"",s=currentClassId===e.ClassId&&layerTextSectionExcerptId===e.LayerTextSectionExcerptId;__p+='\r\n                        <li class="'+(null==(__t=s?"selected disabled assignmentLink":"assignmentLink")?"":__t)+'">\r\n                            <a href="javascript:void(0)" onclick="cH.openReaderUrl(\''+(null==(__t=t)?"":__t)+"')\" >"+(null==(__t=n)?"":__t)+(null==(__t=a)?"":__t)+"</a>\r\n                        </li>\r\n                    "})),__p+="\r\n                    \r\n                    ","grading"===sCH.readerConfig.type&&(__p+='\r\n                        <li class="divider"></li>\r\n                        <li><a href="javascript:void(0)" class="btn-box small callout btnAssignToClasses" style="margin: 0 11px 5px 11px;">Assign to other classes</a></li>\r\n                    '),__p+="\r\n                </ul>\r\n            </div>\r\n        "),__p+="\r\n        ","authoring"===sCH.readerConfig.type&&(__p+='\r\n            <button class="btn-box btnAssignToClasses" title="'+(null==(__t=tooltip)?"":__t)+'">Assign</button>\r\n        '),__p+="\r\n    "}__p+="\r\n\r\n    ";var userLayers=sCH.readerConfig.layers?sCH.readerConfig.layers.filter((function(e){return"UserLayer"===e.LayerType})):[];if(sCH.readerConfig.isReadOnly&&sCH.readerConfig.showAuthoringActions&&0===userLayers.length?(sCH.learnEntityMetaM.get("RentalPrices")&&(sCH.userM.isOnPrimeUnlimited()?__p+='\r\n                <button class="btn-box btnBuyLicenses">Assign</button>\r\n            ':__p+='\r\n                <button class="btn-box btnBuyLicenses" title="'+(null==(__t=isTextToBeMadeFreeDuringCovid?"Free access until July 31!":"Buy rental licenses to assign this text")?"":__t)+'">Buy rental licenses</button>\r\n            ',__p+="\r\n        "),__p+="\r\n    "):!bowser.mobile&&"grading"===type&&(sCH.learnEntityMetaM.get("LayerUserIds")||"").indexOf(sCH.userM.get("UserId"))>-1&&(__p+='\r\n        <button class="btn-box btnGoToEditLayer" title="Edit questions and notes">Edit</button>\r\n    '),__p+="\r\n\r\n    ",sCH.readerConfig.isInLibrary&&!sCH.readerConfig.isReadOnly){var downloadedBy=cH.plural(sCH.readerConfig.libraryLayerDownloadCount,"%count teacher","%count teachers");__p+='\r\n        <div class="icon shared"\r\n            title="This assignment has been shared to your '+(null==(__t=sCH.userM.getLibraryString())?"":__t)+" and has been assigned by "+(null==(__t=downloadedBy)?"":__t)+'">\r\n        </div>\r\n    '}if(__p+='\r\n</div>\r\n\r\n<div class="right">\r\n    ',sCH.readerConfig.isReadOnly&&sCH.readerConfig.showAuthoringActions&&0===userLayers.length&&!bowser.mobile)sCH.learnEntityMetaM.get("RentalPrices")?sCH.userM.isOnPrimeUnlimited()&&(__p+='\r\n                    <button class="btn-box small btnBuyLicenses" title="Add, edit, delete questions and notes">Customize</button>\r\n                '):__p+='\r\n                <button class="btn-box small btnCustomize" title="Add, edit, delete questions and notes">Customize</button>\r\n            ';else if("authoring"===type&&sCH.readerConfig.showAuthoringActions&&sCH.readerConfig.layers.length>0){var currentLayerTitle="Actively Learn instruction",currentLayer=sCH.readerConfig.layers.find((function(e){return e.LayerId===sCH.readerConfig.layerId}));if(currentLayer)var currentLayerTitle="UserLayer"===currentLayer.LayerType?cH.getUserLayerTitle(currentLayer.Labels):currentLayer.IsInLibrary?cH.getLibraryLayerTitle(currentLayer.Labels):"Actively Learn instruction";__p+='\r\n        <div class="dropdown layersDropdown pull-right">\r\n            <button class="btn-box btnLayers" title="Assignment versions"\r\n                data-toggle="dropdown"\r\n                aria-haspopup="true"\r\n                aria-expanded="false">\r\n                <span id="lblCurrentLayerTitle">'+(null==(__t=cH.truncate(currentLayerTitle,bowser.mobile?15:30))?"":__t)+'</span>\r\n                <span class="icon-dropdown-arrow"></span>\r\n            </button>\r\n            <ul class="dropdown-menu" style="max-height: 400px; overflow-y: auto;">\r\n                ',sCH.readerConfig.layers.length&&sCH.readerConfig.layers.forEach((function(e){var t="UserLayer"===e.LayerType?"#teacher/reader/authoring/"+e.LayerId+"/notes":"#teacher/reader/authoring/preview/"+e.LayerId+"/notes",n="UserLayer"===e.LayerType?cH.getUserLayerTitle(e.Labels):e.IsInLibrary?cH.getLibraryLayerTitle(e.Labels):"Actively Learn instruction";__p+='\r\n                        <li>\r\n                            <a href="'+(null==(__t=t)?"":__t)+'" class="'+(null==(__t=sCH.readerConfig.layerId===e.LayerId?"selected":"")?"":__t)+'">\r\n                                '+(null==(__t=cH.sanitize(n))?"":__t)+"\r\n                            </a>\r\n                            ","UserLayer"===e.LayerType&&(__p+='\r\n                                <button class="btnEditLayer icon-pencil" data-layerid="'+(null==(__t=e.LayerId)?"":__t)+'"></button>\r\n                            '),__p+='\r\n                            <button class="btnDuplicate icon-pages" data-layerid="'+(null==(__t=e.LayerId)?"":__t)+'"></button>\r\n                        </li>\r\n                    '})),__p+="\r\n            </ul>\r\n        </div>\r\n    "}__p+="\r\n\r\n    ",!bowser.mobile&&"student"===type&&sCH.readerConfig.isSmallGroupsEnabled&&(__p+='\r\n        <div class="smallGroupName" title="'+(null==(__t="Small group members: "+smallGroupPeers)?"":__t)+'">\r\n            '+(null==(__t=sCH.readerConfig.smallGroupName)?"":__t)+"\r\n        </div>\r\n    "),__p+="\r\n\r\n    ",showPlayEntireTextButton&&(__p+='\r\n        <button class="btn-box btnPlayEntireText headerBtn icon-play" title="Hear text from the beginning"></button>\r\n    '),__p+="\r\n\r\n    ",showKeyVocabOption&&(__p+='\r\n        <button class="btn-box icon-atoz headerBtn btnKeyVocabHighlight" title="Highlight key vocabulary words in this text"></button>\r\n    '),__p+='\r\n\r\n    <div class="textview">\r\n        ',isAssessment?(__p+="\r\n            ","grading"===type&&(__p+='\r\n                <a data-panel="grading" class="btn-tab icon-question-checked btnGradingView" title="Grading"></a>\r\n            '),__p+="\r\n        "):(__p+="\r\n            ","studentir"===type||"student"===type?__p+='\r\n                <button data-panel="notes" class="btn-tab icon-notes btnNotesView selected" title="Notes"></button>\r\n                <button data-panel="data" class="btn-tab icon-graph btnDataView" title="Assignment data"></button>\r\n            ':"studentresearch"===type?__p+='\r\n                <button data-panel="notes" class="btn-tab icon-notes btnNotesView selected" title="Notes"></button>\r\n            ':"grading"===type?(__p+='\r\n                <button data-panel="notes" class="btn-tab icon-notes btnNotesView selected" title="Notes"></button>\r\n                <button data-panel="grading" class="btn-tab icon-question-checked btnGradingView" title="Grading"><div class="notificationCount"></div></button>\r\n                ',(!window.isIOSApp||window.isIOSApp&&!sCH.userM.isOnFreePlan())&&(__p+='\r\n                <button data-panel="data" class="btn-tab icon-graph btnDataView" title="Assignment data"></button>\r\n                '),__p+="\r\n            "):"authoring"===type&&(__p+='\r\n                <button data-panel="notes" class="btn-tab icon-notes btnNotesView selected" title="Notes"></button>\r\n            '),__p+="\r\n        "),__p+='\r\n    </div>\r\n\r\n    <div class="connection"></div>\r\n\r\n    ',sCH.userM.isAnonUser()&&(__p+='\r\n        <div class="publicAssignmentBlurb">\r\n            ',bowser.mobile||(__p+='\r\n                <div class="logoWrapper">\r\n                    <a class="icon-logo"></a>\r\n                    <span class="extra">Actively Learn</span>\r\n                </div>\r\n            '),__p+='\r\n\r\n            <div class="heading">\r\n                ',bowser.mobile?__p+='\r\n                    <a class="btnSignUp btn-box large %>" data-destination="signup">Sign up!</a>\r\n                    <a class="btnSignIn" data-destination="signin">Assign to your students!</a>\r\n                ':__p+='\r\n                    <a class="btnSignUp btn-box large %>" data-destination="signup">Sign up, it\'s free!</a>\r\n                    Have an account?\r\n                    <a class="btnSignIn" data-destination="signin">Assign to your students!</a>\r\n                ',__p+="\r\n            </div>\r\n        </div>\r\n    "),__p+='\r\n\r\n    <div class="editTextBarContainer"></div>\r\n    <div class="editTextPopupContainer"></div>\r\n</div>'}return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<header>\n    <section class="baseContentDetail">\n        ',metadata.CoverArt&&(__p+='\n            <div class="cover">\n                <img src="'+(null==(__t=cH.sanitize(metadata.CoverArt))?"":__t)+'" width="180" onerror="this.style.display=\'none\'" />\n            </div>\n        '),__p+='\n        <div class="metadata">\n            <div class="texttitle">'+(null==(__t=cH.sanitize(metadata.Title))?"":__t)+'</div>\n            <div class="author">'+(null==(__t=cH.sanitize(metadata.Author))?"":__t)+"</div>\n            ",metadata.Publisher&&(__p+='<div class="publisher">'+(null==(__t=cH.sanitize(metadata.Publisher))?"":__t)+"</div>"),__p+="\n            ",metadata.Description&&(__p+='<div class="description">'+(null==(__t=cH.sanitize(metadata.Description))?"":__t)+"</div>"),__p+="\n\n            ","grading"===type&&(__p+='\n            <div class="studentLinkContainer">\n                Share this assignment with your students:<br />\n                <span class="studentUrl">'+(null==(__t=studentUrlLink)?"":__t)+'</span>\n                <button class="icon-copytoclipboard btnCopyLink" data-clipboard-text="'+(null==(__t=studentUrlLink)?"":__t)+'" title="Copy link to clipboard"></button>\n\n                ',sCH.userM.get("Accounts").native&&(__p+='\n                    <div class="gShare" title="Share to Google Classroom">\n                        <div class="g-sharetoclassroom" data-size="20" data-url="'+(null==(__t=studentUrlLink)?"":__t)+'" data-title="'+(null==(__t=cH.sanitize(metadata.Title))?"":__t)+'"></div>\n                    </div>\n                '),__p+="\n            </div>\n            "),__p+="\n            ",isResearch||(__p+='\n            <div class="tagsDetail">\n                <span class="icon-question"></span><span class="tagCount">'+(null==(__t=metadata.QuestionTagCount)?"":__t)+'</span>\n                <span class="icon-notes"></span><span class="tagCount">'+(null==(__t=metadata.NoteTagCount)?"":__t)+"</span>\n            </div>\n            "),__p+='\n        </div>\n    </section>\n</header>\n<div class="ccDetail" style="display: ',print(0===standards.length?"none":"block"),__p+='">\n    <div class="heading">Question breakdown by standard</div>\n    <div class="ccInfo">\n    ',_.each(standards,(function(e,t){__p+='\n        <div class="standard">\n            <span class="count">'+(null==(__t=e.count)?"":__t)+'</span>\n            <span class="text">'+(null==(__t=cH.sanitize(e.shortText))?"":__t)+'</span>\n            <span class="ccss">('+(null==(__t=cH.sanitize(e.code))?"":__t)+")</span>\n        </div>\n    "})),__p+="\n    </div>\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1799);t.default=Backbone.View.extend({initialize:function(e){this.reader=e.reader,this.subheader=new s.default(e),this.childViews=[this.subheader],Backbone.pubEv.on("updateMargin",this.startUpdateMargin,this),Backbone.pubEv.on("refreshNotesPanelHeight",this.updateNotesPanelHeight,this)},preRender:function(){this.subheader.currentStudentSelect()},startUpdateMargin:function(e){if(sCH.readerConfig&&!sCH.readerConfig.isPDF){var t=sCH.learnEntitySectionsMetaC.find({TextSectionId:sCH.readerConfig.currentSectionId});if((t?t.get("CharacterCount"):0)>2e4||sCH.allStudentTagsC.length>30){this.updateMarginTimer&&window.clearTimeout(this.updateMarginTimer);var n=this;this.updateMarginTimer=window.setTimeout((function(){n.updateMargin(e)}),150)}else this.updateMargin(e)}},updateMargin:function(e){var t=this;e&&e.media?window.setTimeout((function(){return t.executeUpdateMargin(e)}),500):this.executeUpdateMargin(e)},executeUpdateMargin:function(e){if($(".textSectionContainer").length>0&&$(".textGatingSizeSensor").length>0){var t=$(".reader .scroll .view.notesview"),n={},a=t.find(".noteTagContainer:not(.displayNone)"),s=$(".textSectionContainer").position().top-$(".textGatingSizeSensor").position().top;if(0!==a.length){a.detach(),$(".reader .scroll .view.textview .notesTag:not(.highlightOnly)").each((function(){var e,t=$(this),a=t[0],i=a.closest("table");if(i){var o=a.closest("tr");e=(o?o.offsetTop:0)+a.offsetTop+i.offsetTop+s}else e=a.offsetTop-a.parentNode.scrollTop+s;n[parseInt(a.getAttribute("data-tagid"))]={el:t,pos:e,nativeSelf:a}}));for(var i=0;i<a.length;i++){var o=$(a[i]),r=parseInt(o[0].getAttribute("data-tagid"));if(n[r]){var l=n[r].pos;o[0].style.top=28+(l<71?72:l)+"px"}}a=a.sort((function(e,t){var a=$(e)[0].getAttribute("data-tagid"),s=$(t)[0].getAttribute("data-tagid");return n[a]?n[s]?n[a].nativeSelf.getAttribute("data-startindex")-n[s].nativeSelf.getAttribute("data-startindex"):-1:1}));var d=0;for(i=0;i<a.length;i++)a[i].classList.contains("active")&&(d=i),t[0].appendChild(a[i]);this.organizeMargin(a,t.hasClass("collapse"),d)}e&&e.doResizeView&&$(window).resize();var c=$(".notesview.view").children(".noteTagContainer").last()[0]||$(".teachingIdeas")[0];if(c){var u=parseInt(c.style.top||"71"),p=t.hasClass("collapse")?27:c.offsetHeight+10,h=$(".noteTagContainer.active").length>0?70:0;$(".notesview").height(u+p+h)}else $(".notesview").height(0)}},organizeMargin:function(e,t,n){this.organizeTeachingIdeasMargin(e);for(var a=n+1;a<e.length;a++){var s=$(e[a]),i=parseInt(s[0].style.top),o=t?27:s[0].offsetHeight+10;if(a>0){var r=$(e[a-1]),l=parseInt(r[0].style.top),d=t?27:r[0].offsetHeight+10;l+d>=i&&(s[0].style.top=l+d+"px")}}if(n>0)for(a=n-1;a>=0;a--){s=$(e[a]),i=parseInt(s[0].style.top),o=t?27:s[0].offsetHeight+10;var c=$(e[a+1]),u=parseInt(c[0].style.top);i+o>=u&&(s[0].style.top=u-o+"px")}},organizeTeachingIdeasMargin:function(e){var t=$(".teachingIdeas");if(e.length>0&&t.length>0){var n=$(e[0])[0],a=($(".toggleWrapper").outerHeight()||0)+(t.outerHeight()||0)+10;a>=parseInt(n.style.top)&&(n.style.top=a+"px")}},updateNotesPanelHeight:function(){var e=this;if($(".noteTagContainer.active").length){var t=parseInt($(".noteTagContainer.active")[0].style.top)+$(".noteTagContainer.active").height()+5,n=$(".notesview").height();n<t&&(this.preChangeNotesViewHeight=n,setTimeout((function(){$(".notesview").height(t)}),100)),setTimeout((function(){e.updateActiveNoteHeight()}),250)}},updateActiveNoteHeight:function(){var e=$(".noteTagContainer.active"),t=$(".textGatingGate").height(),n=$(window).height()-$(".headerWrapper").height();if(e&&e.length){var s=e.position().top,i=e.height();s+i>t&&e.css({maxHeight:n,top:i>n?a.scrollElement().scrollTop():a.scrollElement().scrollTop()+n-i}).find(".popupNoteMenu").css({maxHeight:n,overflow:"auto"})}},destroy:function(){Backbone.pubEv.off("updateMargin"),Backbone.pubEv.off("refreshNotesPanelHeight")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(1800);t.default=Backbone.View.extend({el:"main.scroll .notesview",events:{"change .ddlStudents":"toggleTags","click .btnToggleSharedNotes":"toggleSharedNotes","click .btnCollapseExpandNotes":"toggleCollapseExpandNotes","click .btnNoteSummaryView":"openNoteSummaryView","click .btnAddTeachingIdeas":"addTeachingIdeas"},template:n(1802),initialize:function(e){this.reader=e.reader,"grading"===sCH.readerConfig.type&&this.render(),Backbone.pubEv.on("rerenderStudentNoteCounts",this.render,this),"student"===sCH.readerConfig.type&&sCH.allStudentTagsC.on("add remove",this.updateSharedNotesButton,this)},render:function(){if(this.$el.find(".toggleWrapper").remove(),"grading"===sCH.readerConfig.type){var e=-1==sCH.readerConfig.currentSectionId?sCH.readerSettingsM.get("LastReadTextSectionId"):sCH.readerConfig.currentSectionId,t=[];a.each(sCH.studentsC.models,(function(n){var a=sCH.studentNotesC.getNotesAndRepliesCountBySectionAndStudentId(e,n.get("UserId"))+sCH.teacherNotesC.getNotesAndRepliesCountBySectionAndStudentId(e,n.get("UserId"));t.push({UserId:n.get("UserId"),FirstName:n.get("FirstName"),LastName:n.get("LastName"),NoteCount:a})})),this.$el.prepend(this.template({students:t,readerType:"grading",sharedNotesCount:sCH.studentNotesC.getSharedNotesBySectionId(e).length})),this.$el.find("select.ddlStudents").selectpicker(),this.currentStudentSelect()}else"student"===sCH.readerConfig.type?(this.$el.prepend(this.template({readerType:"student"})),this.updateSharedNotesButton()):this.$el.prepend(this.template({readerType:sCH.readerConfig.type}));this.$el.find(".toggleWrapper").addClass("fix"),s.initTooltips(this.$el,{},":not(button, .noteTagContainer)")},currentStudentSelect:function(){this.$el.find("select.ddlStudents").selectpicker("val",sCH.readerConfig.selectedStudentUserId)},toggleTags:function(){var e=parseInt(this.$el.find("select.ddlStudents").val());sCH.readerConfig.selectedStudentUserId=e,"grading"===sCH.readerConfig.type&&Backbone.pubEv.trigger("toggleTags")},toggleCollapseExpandNotes:function(e){var t=!$(".right .notesview").hasClass("collapse");$(".right .notesview").toggleClass("collapse"),$(e.currentTarget).removeClass("icon-expand icon-collapse"),$(e.currentTarget).addClass(t?"icon-expand":"icon-collapse"),Backbone.pubEv.trigger("updateMargin")},toggleSharedNotes:function(e){"Show peer notes"===$(e.currentTarget).find(".state").text()?(sCH.allStudentTagsC.showHideAllTags(!0),$(e.currentTarget).find(".state").text("Hide peer notes"),Backbone.pubEv.trigger("rerenderNotes")):(sCH.allStudentTagsC.showHideAllTags(!1),$(e.currentTarget).find(".state").text("Show peer notes"),Backbone.pubEv.trigger("rerenderNotes"))},updateSharedNotesButton:function(){var e=sCH.readerConfig.Settings.AllowStudentSharedNotes?sCH.allStudentTagsC.filter({TextSectionId:sCH.readerConfig.currentSectionId}).length:sCH.allStudentTagsC.getNotesAndRepliesCountBySectionAndStudentId(sCH.readerConfig.currentSectionId,window.ActivelyRead.currentUserId);e>0?(this.$el.find(".numSharedNotes").text("("+e+")"),this.$el.find(".btnToggleSharedNotes").show().parent().removeClass("nopadding"),this.$el.find(".btnCollapseExpandNotes").show()):(this.$el.find(".btnToggleSharedNotes").hide().parent().addClass("nopadding"),this.$el.find(".btnCollapseExpandNotes").hide())},openNoteSummaryView:function(e){this.reader.header.noteSummaryView(e)},addTeachingIdeas:function(){new Backbone.BootstrapModal({title:"Save Teaching Ideas",content:new i.default({callback:function(){}}),cssClass:"modal-al-save-teaching-ideas",okText:"Save",allowCancel:!1,optionButtons:[{class:"pull-left btnDeleteTeachingIdeas",text:"Delete",event:"deleteTeachingIdeas"}]}).open()},destroy:function(){}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),s=n(5);t.default=Backbone.View.extend({template:n(1801),events:{"click .addRelatedLayer":"addRelatedLayer","click .btnRemoveRelatedLayer":"removeRelatedLayer"},initialize:function(e){self=this,this.on("ok",this.saveTeachingIdea),this.on("deleteTeachingIdeas",(function(){var e=this;a.DeleteTeachingIdeas({layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId},(function(){sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId]&&delete sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId],Backbone.pubEv.trigger("rerenderTags"),$(".btnAddTeachingIdeas").text("Add Teaching ideas"),s.bootstrap.alert({message:"Successfully deleted teaching ideas for this layer and section."}),e.destroyMediumEditors(),self.modal.close()}))})),this.on("initialized",this.modalInitialized),this.obj=e,this.existingTeachingIdeas=sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId]||{}},modalInitialized:function(e){this.modal=e},render:function(){return this.$el.html(this.template({teachingIdeasObj:this.existingTeachingIdeas})),this.medium=s.initMediumEditor(this.$el.find(".overallIdea[contenteditable]")),this.mediumHelperText=s.initMediumEditor(this.$el.find(".relatedLayerHelperText[contenteditable]")),this},addRelatedLayer:function(){var e=$('<li>\n      <input class="relatedLayerId" placeholder="LayerId"/>\n      <span class="icon-trash btnRemoveRelatedLayer" title="Remove related layer"></span>\n      <div class="relatedLayerHelperText" placeholder="Enter helper text for this layer"  contenteditable="true"/>\n    </li>');this.$el.find(".listRelatedLayer").append(e),this.mediumHelperText=s.initMediumEditor(this.$el.find(".relatedLayerHelperText[contenteditable]"))},destroyMediumEditors:function(){s.destroyMediumEditor(this.medium),s.destroyMediumEditor(this.mediumHelperText)},removeRelatedLayer:function(e){$(e.currentTarget).closest("li").remove()},saveTeachingIdea:function(e){var t=this,n=this;this.modal.preventClose(),this.$el.find(".flash").removeClass("flash");var i=[];if(s.checkRequiredInputFields(this.$el)+s.checkRequiredFields([this.$el.find(".overallIdea")],!0)+s.checkRequiredFields([this.$el.find(".relatedLayerHelperText")],!0))s.bootstrap.alert({message:"Please fill inputs marked in red.",alert:"danger"});else{for(var o=this.$el.find(".listRelatedLayer li"),r=0;r<o.length;r++){var l=$(o[r]).find(".relatedLayerHelperText").html();i.push({layerId:$(o[r]).find(".relatedLayerId").val(),helperText:l})}var d={layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId,overallIdea:this.$el.find(".overallIdea").html(),relatedLayers:i};this.modal.disableOk("Saving..."),a.SaveTeachingIdeas(d,(function(e){e?(delete d.layerId,sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId]=e,Backbone.pubEv.trigger("rerenderTags"),$(".btnAddTeachingIdeas").text("Edit Teaching Ideas"),s.bootstrap.alert({message:"Successfully saved teaching ideas for this layer."}),t.destroyMediumEditors(),n.modal.close()):s.bootstrap.alert({message:"There was some problem saving teaching ideas. Refresh and try again",alert:"danger"})}))}}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div>\n  <div class="overallIdea" placeholder="Overall teaching ideas" contenteditable="true">'+(null==(__t=teachingIdeasObj.overallIdea)?"":__t)+'</div>\n  <ul class="listRelatedLayer">\n    ',_.each(teachingIdeasObj.relatedLayers,(function(e){__p+='\n      <li>\n        <input class="relatedLayerId" placeholder="LayerId" value="'+(null==(__t=e.layerId)?"":__t)+'" /> \n        <span class="icon-trash btnRemoveRelatedLayer" title="Remove related layer"></span>\n        <div class="relatedLayerHelperText" placeholder="Enter layer helper text" contenteditable="true">'+(null==(__t=e.helperText)?"":__t)+"</div>\n      </li>\n    "})),__p+='\n  </ul>\n  <a class="btn-box addRelatedLayer">Add a related layer</a>\n</div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="toggleWrapper">\n    ',"grading"===readerType?(__p+='\n        <select class="ddlStudents" data-live-search="true">\n            <option value="-1" data-content="All shared notes ',sharedNotesCount&&(__p+="<span class='noteCount'>"+(null==(__t=sharedNotesCount)?"":__t)+"</span> "),__p+='"></option>\n            ',_.each(students,(function(e){__p+='\n                <option data-content="'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+" ",e.NoteCount&&(__p+="<span class='noteCount'>"+(null==(__t=e.NoteCount)?"":__t)+"</span>"),__p+='"\n                    value="'+(null==(__t=e.UserId)?"":__t)+'">\n                '+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"\n            </option>\n            "})),__p+='\n        </select>\n        <a class="btnCollapseExpandNotes icon-collapse" title="Collapse/Expand notes"></a>\n        <a class="btnNoteSummaryView icon-notebook hideOnLandscape" title="View notes"></a>   \n    '):"student"===readerType?__p+='\n        <a class="btn-box btnToggleSharedNotes"><span class="state">Hide peer notes</span><span class="numSharedNotes">(0)</span></a>\n        <a class="btnCollapseExpandNotes icon-collapse" title="Collapse/Expand notes"></a>\n    ':"studentir"===readerType?__p+='\n        <a class="btnCollapseExpandNotes icon-collapse" title="Collapse/Expand notes" data-placement="right"></a>\n    ':"authoring"===readerType&&alcfg.contentTeamUserIds.indexOf(sCH.userM.get("UserId"))>-1&&!sCH.readerConfig.isReadOnly&&(__p+=' \n        <a class="btn-box btnAddTeachingIdeas">'+(null==(__t=sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId]?"Edit":"Add")?"":__t)+" Teaching Ideas</a>\n    "),__p+="\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(686),i=n(1804),o=n(1808);t.default=Backbone.View.extend({initialize:function(e){this.reader=e.reader,Backbone.pubEv.on("gradingClickedQuestion",(function(e){if(this.selectedQuestionTagId=e.questionTagId,this.sortOrder=e.sortOrder,$(".btnGradingView:visible").hasClass("selected"))return this.preRender();$(".btnGradingView:visible").click()}),this)},preRender:function(){var e=this;this.questionsC=this.questionsC||new s.default,this.questionsC.fill_questions({assignmentId:sCH.readerConfig.assignmentId,readerType:sCH.readerConfig.type},(function(t,n){return sCH.questionResponseCounts={},sCH.questionResponseCountsByUser={},a.each(t,(function(e){sCH.questionResponseCounts[e.QuestionTagId]=sCH.questionResponseCounts[e.QuestionTagId]||[],sCH.questionResponseCountsByUser[e.UserId]=sCH.questionResponseCountsByUser[e.UserId]||[],sCH.questionResponseCounts[e.QuestionTagId].push(e.QuestionTagResponseId),sCH.questionResponseCountsByUser[e.UserId].push(e.QuestionTagResponseId)})),sCH.resetRequests=n,e.render()}))},render:function(){var e=this;if(this.close(!1),this.scroll=new o.default({reader:this.reader,studentsC:sCH.studentsC,questionsC:this.questionsC,assignmentId:sCH.readerConfig.assignmentId,sortOrder:this.sortOrder}),this.scroll.render(),this.subheader=new i.default({reader:this.reader,studentsC:sCH.studentsC,questionsC:this.questionsC}),"tagId"in sCH.readerConfig.skipToTag&&"question"===sCH.readerConfig.skipToTag.tagType)this.selectedQuestionTagId=sCH.readerConfig.skipToTag.tagId;else if(!this.selectedQuestionTagId&&-1===sCH.readerConfig.selectedStudentUserId){var t=null;a.each(Object.keys(sCH.readerConfig.ungradedResponseIds),(function(n){if(sCH.readerConfig.ungradedResponseIds[n].length>0){var a=e.questionsC.filter({TagId:parseInt(n)});a.length>0&&(a=a[0],(!t||a&&t>a.get("QuestionNum"))&&(t=a.get("QuestionNum"),e.selectedQuestionTagId=a.get("TagId")))}}))}return this.subheader.render(this.selectedQuestionTagId),this.selectedQuestionTagId=null,this.childViews=[this.subheader,this.scroll],!0},destroy:function(){}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(823),o=n(825),r=n(48),l=n(10),d=n(493),c=n(1805);t.default=Backbone.View.extend({el:".scroll .gradingview .panelHeader",events:{"change .ddlQuestions":"showByQuestion","change .ddlStudents":"showByStudent","click .btnRefresh":"refresh","click .sortDropdown ul a":"sortResults","click .btnRubric":"showRubric","click .btnAnonymize":"toggleAnonymize","click .btnGradeUnanswered":"showTextSectionList","click .btnBulkReset":"resetRequestedResponses","click .btnBulkRestoreGradedResponsesAwaitingRevision":"bulkRestoreGradedResponsesAwaitingRevision","click .btnPrintView":"printPanel","click .btnToggleShowMCAnswer":"toggleShowQuizMCAnswer","click .btnGradingSettings":"openGradingSettingsPopup","click .btnViewTaggedResponses":"openQuestionResponseGradingTagsPopup","click .btnToggleAutoGrading":"openToggleAutoGradingPopup"},template:n(1807),initialize:function(e){this.reader=e.reader,this.questionsC=e.questionsC,this.studentsC=e.studentsC,Backbone.pubEv.on("updateGradePanelDropdownCount",this.updateGradePanelDropdownCount,this),Backbone.pubEv.on("updateRefreshState",this.updateRefreshState,this),Backbone.pubEv.on("gradingPanelNeedsRefresh",this.gradingPanelNeedsRefresh,this),Backbone.pubEv.on("gradingSettingsUpdated",this.gradingSettingsUpdated,this)},removeDoNotGradeResponsesFromUserResponseArrays:function(){a.each(sCH.readerConfig.QuestionsDoNotGrade,(function(e){sCH.questionResponseCounts[e]&&a.each(Object.keys(sCH.questionResponseCountsByUser),(function(t){sCH.questionResponseCountsByUser[t]=a.difference(sCH.questionResponseCountsByUser[t],sCH.questionResponseCounts[e])}))}))},render:function(e){this.removeDoNotGradeResponsesFromUserResponseArrays();var t=(sCH.classesC.toJSON().find((function(e){return e.ClassId===sCH.learnEntityMetaM.get("ClassId")||0}))||{}).Settings,n=!!t&&-1!==t.indexOf('gradeLabelsOption":"5'),a="true"===(sCH.userM.get("Settings").find((function(e){return"EnableAutoGrading"===e.SettingKey}))||{}).Settings;if(this.$el.html(this.template({questions:this.questionsC.toJSON(),students:this.studentsC.toJSON(),isHigherEd:sCH.userM.get("IsHigherEd"),isAssessment:sCH.readerConfig.isAssessment,responseTotals:sCH.questionResponseCounts,userResponseTotals:sCH.questionResponseCountsByUser,responseUngraded:sCH.readerConfig.ungradedResponseIds,responseUngradedByUser:sCH.readerConfig.ungradedResponseIdsByUser,allowPrinting:"student"!==sCH.userM.get("Role")&&!sCH.learnEntityMetaM.get("IsPrintDisabled"),anonymize:sCH.readerConfig.anonymizeGrading,questionsNumC:sCH.questionsNumC,allowStudentsMCAnswer:sCH.readerConfig.Settings.AllowStudentsMCAnswer||!1,isQuiz:sCH.learnEntityMetaM.get("IsQuiz")||sCH.readerConfig.isAssessment,isUsingCustomGradingLabels:n,isAutoGradingTurnedOn:a})),this.$el.find(".ddlQuestions, .ddlStudents").selectpicker(),e)this.$el.find("select.ddlQuestions").selectpicker("val",e),this.showByQuestion(null,e);else if(sCH.readerConfig.selectedStudentUserId>0)this.$el.find("select.ddlStudents").selectpicker("val",sCH.readerConfig.selectedStudentUserId),this.showByStudent();else{var i=this.$el.find("select.ddlQuestions option:nth-child(2)").val();this.$el.find("select.ddlQuestions").selectpicker("val",i),this.showByQuestion()}s.initTooltips(this.$el,null,":not(.dropdown-toggle)")},showByQuestion:function(e,t){if(t=t||parseInt(this.$el.find("select.ddlQuestions").val()),this.$el.find(".ddlQuestions").addClass("active"),this.$el.find(".ddlStudents").removeClass("active"),this.closeOpenPopups(),this.tag||(this.reader.gradingView.scroll.sortOrder=!e&&this.reader.gradingView.scroll.sortOrder?this.reader.gradingView.scroll.sortOrder:"ungraded",this.$el.find(".sortOptions li a[data-sort='name']").show(),this.$el.find(".sortOptions li a[data-sort='chronological']").hide(),this.$el.find(".sortOptions li a").removeClass("selected"),this.$el.find(".sortOptions li a[data-sort='"+this.reader.gradingView.scroll.sortOrder+"']").addClass("selected")),-1!==t)this.$el.find(".actionOptions .btnAnonymize, .actionOptions .btnRubric").show(),this.$el.find("select.ddlStudents").selectpicker("val","-1"),this.reader.gradingView.scroll.showByQuestion(t),-1!==sCH.readerConfig.selectedStudentUserId&&(sCH.readerConfig.selectedStudentUserId=-1,Backbone.pubEv.trigger("toggleTags"));else{var n=this.$el.find("select.ddlStudents option:nth-child(2)").val();this.$el.find("select.ddlStudents").val(n).change()}this.tag=a.filter(this.questionsC.toJSON(),{TagId:parseInt(t)})[0],void 0!==this.tag&&(sCH.readerConfig.isMedia||Backbone.pubEv.trigger("skipToTag",{sectionId:this.tag.TextSectionId,tagId:t,tagType:"question"})),this.$el.find(".btnRefresh").removeClass("needsRefresh")},showByStudent:function(e){var t=parseInt(this.$el.find(".ddlStudents").val());if(this.$el.find(".ddlStudents").addClass("active"),this.$el.find(".ddlQuestions").removeClass("active"),this.closeOpenPopups(),this.tag&&(this.reader.gradingView.scroll.sortOrder=!e&&this.reader.gradingView.scroll.sortOrder?this.reader.gradingView.scroll.sortOrder:"chronological"),this.tag=null,-1!==t)this.$el.find(".sortOptions li a[data-sort='name']").hide(),this.$el.find(".sortOptions li a[data-sort='chronological']").show(),this.$el.find(".sortOptions li a").removeClass("selected"),this.$el.find(".sortOptions li a[data-sort='"+this.reader.gradingView.scroll.sortOrder+"']").addClass("selected"),this.$el.find(".actionOptions .btnAnonymize, .actionOptions .btnRubric").hide(),this.$el.find("select.ddlQuestions").selectpicker("val","-1"),this.reader.gradingView.scroll.showByStudent(t),sCH.readerConfig.selectedStudentUserId=t;else{var n=this.$el.find("select.ddlQuestions option:nth-child(2)").val();n&&this.$el.find("select.ddlQuestions").val(n).change(),sCH.readerConfig.selectedStudentUserId=-1}this.$el.find(".btnRefresh").removeClass("needsRefresh"),Backbone.pubEv.trigger("toggleTags")},refresh:function(){var e=parseInt(this.$el.find(".ddlQuestions").val());this.reader.gradingView.selectedQuestionTagId=-1===e?null:e,this.reader.gradingView.sortOrder=this.$el.find(".sortOptions a.selected").data("sort"),this.reader.gradingView.preRender(),this.$el.find(".btnRefresh").removeClass("needsRefresh")},updateRefreshState:function(e){("-1"!==this.$el.find("select.ddlQuestions").val()&&e.questionTagId===parseInt(this.$el.find("select.ddlQuestions").val())||"-1"!==this.$el.find("select.ddlStudents").val()&&(-1===e.userId||e.userId===parseInt(this.$el.find("select.ddlStudents").val())))&&(this.$el.find(".btnRefresh").addClass("needsRefresh"),e.forceRefresh?this.$el.find(".btnRefresh").click():$(".gradingview .results .grades[data-questiontagid="+e.questionTagId+"][data-userid="+e.userId+"]").addClass("needsRefresh"))},gradingPanelNeedsRefresh:function(){this.$el.find(".btnRefresh").addClass("needsRefresh")},updateGradePanelDropdownCount:function(e){if(sCH.readerConfig.ungradedResponseIds&&sCH.questionResponseCounts){var t=this.$el.find("select.ddlQuestions option[value="+e.questionTagId+"]"),n=sCH.readerConfig.ungradedResponseIds[e.questionTagId]?sCH.readerConfig.ungradedResponseIds[e.questionTagId].length:0,a=sCH.questionResponseCounts[e.questionTagId]?sCH.questionResponseCounts[e.questionTagId].length:0,i=a-n,o=i!==a?"callout":"";t.data("content","Question "+t.index()+'<span class="'+o+'">('+i+"/"+a+" graded)</span>"),this.$el.find("select.ddlQuestions").selectpicker("refresh");var r=this.$el.find("select.ddlStudents option[value="+e.userId+"]"),l=sCH.readerConfig.ungradedResponseIdsByUser[e.userId]?sCH.readerConfig.ungradedResponseIdsByUser[e.userId].length:0,d=sCH.questionResponseCountsByUser[e.userId]?sCH.questionResponseCountsByUser[e.userId].length:0,c=d-l,u=c!==d?"callout":"",p=sCH.studentsC.find({UserId:e.userId}),h=s.sanitize(p.get("LastName")),g=s.sanitize(p.get("FirstName"));r.data("content",h+", "+g+' <span class="'+u+'">('+c+"/"+d+" graded)</span>"),this.$el.find("select.ddlStudents").selectpicker("refresh")}},markQuestionDoNotGrade:function(e){var t=this.$el.find("select.ddlQuestions option[value="+e.questionTagId+"]");if(e.markDoNotGrade)t.addClass("doNotGrade").data("content","Question "+t.index()+'<span class="callout">(Not grading)</span>');else{var n=sCH.questionResponseCounts[e.questionTagId]?sCH.questionResponseCounts[e.questionTagId].length:0;t.removeClass("doNotGrade").data("content","Question "+t.index()+'<span class="callout">(0/'+n+" graded)</span>")}this.$el.find("select.ddlQuestions").selectpicker("refresh")},sortResults:function(e){this.$el.find(".sortDropdown ul a").removeClass("selected");var t=$(e.currentTarget);t.addClass("selected"),this.reader.gradingView.scroll.sortResults(t.data("sort"))},toggleAnonymize:function(){sCH.readerConfig.anonymizeGrading=!sCH.readerConfig.anonymizeGrading,sCH.readerConfig.anonymizeGrading?this.$el.find(".actionOptions .btnAnonymize").text("Show student names"):this.$el.find(".actionOptions .btnAnonymize").text("Anonymize student names"),this.reader.gradingView.scroll.anonymize()},showRubric:function(e){var t;Backbone.tracking.trackGAEvent("teacher","showRubric");var n=$(e.currentTarget).data("standardid");n?t={standardId:n}:this.tag&&(t={standardId:this.tag.StandardId}),(new i.default).render(t)},showTextSectionList:function(){this.closeOpenPopups(),new Backbone.BootstrapModal({title:"Bulk grade unanswered questions",content:new o.default({type:"gradeunanswered",assignmentId:sCH.readerConfig.assignmentId,textSections:sCH.learnEntitySectionsMetaC.getValidSectionsJson()}),allowCancel:!1,okText:"Bulk grade",cssClass:"modal-lg modal-delete modal-al-bulk-grade-unanswered"}).open()},printPanel:function(){if(sCH.userM.isOnFreePlan())r.showBuyTeacherPopup({title:"Printing"});else{var e=void 0;if("-1"!==this.$el.find("select.ddlQuestions").val())e="Question "+this.questionsC.filter({TagId:parseInt(this.$el.find("select.ddlQuestions").val())})[0].get("QuestionNum")+" responses";else{var t=this.studentsC.filter({UserId:parseInt(this.$el.find("select.ddlStudents").val())})[0];e=s.sanitize(t.get("FirstName")+" "+t.get("LastName"))+"'s responses"}s.print(sCH.learnEntityMetaM.get("Title")+" - "+e,"printPanel")}},toggleShowQuizMCAnswer:function(){var e={popupTitle:sCH.readerConfig.Settings.AllowStudentsMCAnswer?"Hide correct multiple choice answers?":"Show correct multiple choice answers?",popupContent:sCH.readerConfig.Settings.AllowStudentsMCAnswer?"":alcfg.confirmsText.showQuizMCAnswer,popupOkTest:sCH.readerConfig.Settings.AllowStudentsMCAnswer?"Hide":"Show"};new Backbone.BootstrapModal({title:e.popupTitle,content:e.popupContent,cssClass:"modal-al",allowCancel:!0,okText:e.popupOkTest}).open((function(){sCH.readerConfig.Settings.AllowStudentsMCAnswer=!sCH.readerConfig.Settings.AllowStudentsMCAnswer;var e=sCH.learnEntityMetaM.get("ClassId");sCH.classesC.getModelByClassId(e).editAssignmentSettings({classId:e,assignmentId:sCH.readerConfig.assignmentId,newSubSettings:JSON.stringify(sCH.readerConfig.Settings),subMenu:"reading",updateAllClasses:!1},(function(e){if(e){var t=sCH.readerConfig.Settings.AllowStudentsMCAnswer?"Hide correct multiple choice answers":"Show correct multiple choice answers",n="The setting has been successfully changed. Your students will "+(sCH.readerConfig.Settings.AllowStudentsMCAnswer?"":"not")+" be able to see correct answers for multiple choice questions.";$(".btnToggleShowMCAnswer").html(t),s.bootstrap.alert({message:n})}else s.bootstrap.alert({message:"There was an error. Please try again.",alert:"danger"})}))}))},resetRequestedResponses:function(){var e=this,t="",n=sCH.resetRequests&&sCH.resetRequests.length>0;if(n){var i="";a.each(sCH.resetRequests,(function(t){var n=e.studentsC.find({UserId:t.UserId});if(n){var a=s.sanitize(n.get("FirstName")+" "+n.get("LastName")),o=s.plural(t.ResetRequests.split(",").length,"%count response","%count responses");i+="<p>"+a+": "+o+"</p>"}})),t='\n        The following students want to revise one or more of their responses. \n        "Allow Revision" will reset all the below responses. \n        '+i+' \n        <div class="info" style="position:absolute;bottom:-64px;">Note: Actively Learn will need to reload.</div>'}else t="There are no revisions requested at this moment.";new Backbone.BootstrapModal({title:"Bulk allow revisions",content:t,cssClass:"modal-al-bulk-reset-requested-responses",allowCancel:!1,cancelText:!!n&&"Cancel",okText:n?"Allow revisions":"Close"}).open((function(){n&&l.reviseRequestedResponses({assignmentId:sCH.readerConfig.assignmentId},(function(e){s.bootstrap.alert({message:"All requested responses were reset."}),window.location.reload(!0)}))}))},bulkRestoreGradedResponsesAwaitingRevision:function(){new Backbone.BootstrapModal({content:'<p>This will restore responses that were graded and are awaiting revision.         <div class="info">Note: Actively Learn will need to reload.</div></p>',cssClass:"modal-al-bulk-reset-requested-responses",allowCancel:!1}).open((function(){l.RestoreGradedResponsesAwaitingRevision({assignmentId:sCH.readerConfig.assignmentId},(function(){s.bootstrap.alert({message:"Success!"}),window.location.reload(!0)}))}))},closeOpenPopups:function(){$(".gradingview .readerSidePopupContainer").length>0&&$(".gradingview .readerSidePopupContainer").is(":visible")&&$(".gradingview .readerSidePopupContainer .close").click()},openGradingSettingsPopup:function(){var e=sCH.classesC.getModelByClassId(sCH.learnEntityMetaM.get("ClassId"));new Backbone.BootstrapModal({title:"Grading settings",okText:"Save",cancelText:"Cancel",cssClass:"classSettings",allowCancel:!0,content:new d.default({classM:e,submenu:"gradebook",triggeredFromReader:!0})}).open()},openQuestionResponseGradingTagsPopup:function(e){new Backbone.BootstrapModal({title:"Tagged responses",content:new c.default({questionsC:this.questionsC}),okText:"Close",cancelText:!1,cssClass:"modal-al-grading-tags modal-lg"})},openToggleAutoGradingPopup:function(){var e=sCH.userM.get("Settings").find((function(e){return"EnableAutoGrading"===e.SettingKey})),t=e&&"true"===e.Settings,n=this;new Backbone.BootstrapModal({title:"Do you want to turn "+(t?"off":"on")+" suggested grades?",content:"<p>You can always turn it back "+(t?"on":"off")+' later\n        (<a href="'+alcfg.helpArticleLink.autoGrading+'" class="btnLearnMore">learn more</a>).</p>',okText:"Yes"}).on("ok",(function(){var a=t?"false":"true";e?e.Settings=a:sCH.userM.get("Settings").push({SettingKey:"EnableAutoGrading",Settings:a}),l.UpdateStandaloneSetting({settingKey:"EnableAutoGrading",settings:a}),"false"===a?($(".autograded").attr("title","").attr("data-original-title","").removeClass("autograded"),$(".autogradingInfo").remove(),$(".btnToggleAutoGrading").text("Turn suggested grades on")):($(".btnToggleAutoGrading").text("Turn suggested grades off"),n.refresh())})).open()},gradingSettingsUpdated:function(e){var t=sCH.readerConfig.Settings||{};sCH.readerConfig.Settings.grading=t.gradebook=e.gradebook,sCH.readerConfig.gradeNameMap=s.gradeNameMap(!1,t),this.refresh()},destroy:function(){Backbone.pubEv.off("updateGradePanelDropdownCount",this.updateGradePanelDropdownCount,this),Backbone.pubEv.off("updateRefreshState",this.updateRefreshState,this),Backbone.pubEv.off("gradingPanelNeedsRefresh")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(86),o=n(10);t.default=Backbone.View.extend({events:{"change .ddlStudents":"filter","change .ddlCategories":"filter"},template:n(1806),initialize:function(e){this.questionsC=e.questionsC,this.studentsWithTaggedResponses=[],this.on("initialized",this.modalInitialized)},modalInitialized:function(e){var t=this;this.modal=e,o.GetResponsesWithGradingTags({assignmentId:sCH.readerConfig.assignmentId},(function(n){t.responseArray=n,t.studentsWithTaggedResponses=[],a.each(n,(function(e){var n=sCH.studentsC.find({UserId:e.UserId});e.LastName=n.get("LastName"),e.FirstName=n.get("FirstName"),a.find(t.studentsWithTaggedResponses,{UserId:e.UserId})||t.studentsWithTaggedResponses.push({UserId:e.UserId,LastName:n.get("LastName"),FirstName:n.get("FirstName")})})),e.open()}))},groupResponsesByQuestionNumber:function(e,t){var n=this,s=a.filter(this.responseArray,(function(n){var a=!e||n.UserId===e,s=!t||-1!==n.GradingTags.indexOf(t);return a&&s})),i=a.groupBy(s,"QuestionTagId"),o={};return a.forIn(i,(function(e,t){var a=n.questionsC.find({TagId:parseInt(t)}).get("QuestionNum");o[a]=e})),o},render:function(){this.$el.html(this.template({responsesArray:this.responseArray,students:this.studentsWithTaggedResponses}));var e=this.groupResponsesByQuestionNumber(null,null);this.renderResponseList(e),this.$el.find("select").selectpicker()},filter:function(){var e=this.$el.find(".ddlStudents").val(),t=this.$el.find(".ddlCategories").val(),n=this.groupResponsesByQuestionNumber("null"===e?null:parseInt(e),"null"===t?null:t);this.renderResponseList(n)},renderResponseList:function(e){var t="";a.each(e,(function(e,n){t+='<h4 class="sectionHeading noMarginLeft">Question '+n+"</h4>",a.each(e,(function(e){t+='<div class="response">',t+='<div class="nameAndDate headerHighlight">',t+='<span class="name">'+s.sanitize((e.LastName?e.LastName+", ":"")+e.FirstName)+"</span>",t+='<span class="heading datetime">'+moment(e.CreateDate+"Z").format("MM/DD/YY h:mm a")+"</span>",t+="</div>",t+='<div class="text">'+e.Text+"</div>",e.MediaUrl&&(t+='<div class="studentResponseMediaContainer" data-url="'+s.sanitize(e.MediaUrl)+'"></div>'),t+='<div class="clearBoth"></div>',t+='<div class="tagList">',a.each(e.GradingTags.split(","),(function(e){t+='<span class="questionResponseGradingTag">'+e+"</span>"})),t+="</div>",t+='<div class="clearBoth"></div>',t+="</div>"}))})),this.$el.find(".gradingview").html(t),this.$el.find(".studentResponseMediaContainer").each((function(e,t){i.embedMediaFull({container:$(this),mediaUrl:$(this).data("url")})}))}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",0===responsesArray.length?__p+="\n  <p>No tagged responses!</p>\n":(__p+='\n  <p style="border-bottom:solid 1px #e8e8e8;padding:20px 30px;margin:0 -30px;margin-top:-10px;">\n    <select class="ddlStudents" data-live-search="true">\n        <option value="null">All students</option>\n        ',_.each(students,(function(e){var t=_.filter(responsesArray,{UserId:e.UserId}).length;__p+='\n          <option\n            data-content="'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+" \n              ",t&&(__p+="<span class='noteCount'>"+(null==(__t=t)?"":__t)+"</span>"),__p+='"\n            value="'+(null==(__t=e.UserId)?"":__t)+'">\n              '+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"\n          </option>\n        "})),__p+='\n    </select>\n\n    <select class="ddlCategories">\n        <option value="null">All categories</option>\n        ',_.each(alcfg.fixedGradingTags,(function(e){var t=_.filter(responsesArray,(function(t){return-1!==t.GradingTags.indexOf(e)})).length;__p+='\n            <option\n              data-content="'+(null==(__t=e)?"":__t)+" \n                ",t&&(__p+="<span class='noteCount'>"+(null==(__t=t)?"":__t)+"</span>"),__p+='"\n              value="'+(null==(__t=e)?"":__t)+'">\n                '+(null==(__t=e)?"":__t)+"\n            </option>\n        "})),__p+='\n    </select>\n  </p>\n  <div class="gradingview"></div>\n'),__p+="";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="gradingSubheaderWrapper">\r\n    <div class="gradingSubheaderLeft">\r\n        <select class="ddlQuestions">\r\n            <option value="-1">'+(null==(__t=bowser.mobile?"All Qs":"All Questions")?"":__t)+"</option>\r\n            ",isAssessment?_.each(questions,(function(e,t){__p+='\r\n            <option value="'+(null==(__t=e.TagId)?"":__t)+'">Question '+(null==(__t=t+1)?"":__t)+"</option>\r\n            "})):_.each(questions,(function(e,t){var n=questionsNumC.find({QuestionTagId:e.TagId}),a=responseTotals[e.TagId]?responseTotals[e.TagId].length:0,s=responseUngraded[e.TagId]&&a>0?a-responseUngraded[e.TagId].length:a,i=!!n&&n.get("IsDoNotGrade"),o=i?"(Not grading)":3===e.SubType?"(poll)":"("+s+"/"+a+" graded)",r=s!==a||i?"callout":"",l=(bowser.mobile?"Q ":"Question ")+(t+1)+"<span class='"+r+"'>"+o+"</span>";__p+='\r\n            <option value="'+(null==(__t=e.TagId)?"":__t)+'" data-content="'+(null==(__t=l)?"":__t)+'"\r\n                '+(null==(__t=i?'class="doNotGrade"':"")?"":__t)+">\r\n            </option>\r\n            "})),__p+='\r\n        </select>\r\n\r\n        <select class="ddlStudents" data-live-search="true">\r\n            <option value="-1">All Students</option>\r\n            ',isAssessment?_.each(students,(function(e){__p+='\r\n            <option value="'+(null==(__t=e.UserId)?"":__t)+'">'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"</option>\r\n            "})):_.each(students,(function(e){var t=userResponseTotals[e.UserId]&&userResponseTotals[e.UserId].length||0,n=responseUngradedByUser[e.UserId]&&t>0?t-responseUngradedByUser[e.UserId].length:t,a="("+n+"/"+t+" graded)",s=n!==t?"callout":"",i=cH.sanitize(e.LastName)+", "+cH.sanitize(e.FirstName)+"<span class='"+s+"'>"+a+"</span>";__p+='\r\n            <option value="'+(null==(__t=e.UserId)?"":__t)+'" data-content="'+(null==(__t=i)?"":__t)+'"></option>\r\n            '})),__p+='\r\n        </select>\r\n    </div>\r\n\r\n    <div class="gradingSubheaderRight">\r\n        <div class="dropdown sortDropdown">\r\n            <a class="btnSorting icon-sort" role="button" data-toggle="dropdown" aria-haspopup="true"\r\n                aria-expanded="false" title="Sort"></a>\r\n            <ul class="dropdown-menu sortOptions" aria-labelledby="btnSorting">\r\n                <li><a data-sort="chronological">Chronological</a></li>\r\n                <li><a data-sort="ungraded">Ungraded</a></li>\r\n                <li><a data-sort="name">Name</a></li>\r\n                <li><a data-sort="grade">Grade</a></li>\r\n                <li><a data-sort="likes">Likes</a></li>\r\n                <li><a data-sort="reset-requests">Revision requests</a></li>\r\n                <li><a data-sort="time-answered">Time answered</a></li>\r\n            </ul>\r\n        </div>\r\n\r\n        <a class=icon-refresh btnRefresh" title="Refresh"></a>\r\n\r\n        <div class="dropdown actionsDropdown">\r\n            <a class="btn-box btnActions" role="button" data-toggle="dropdown" aria-haspopup="true"\r\n                aria-expanded="false">\r\n                Actions\r\n            </a>\r\n            <ul class="dropdown-menu dropdown-menu-right actionOptions" aria-labelledby="btnActions">\r\n                ',isHigherEd||(__p+='<li><a class="btnRubric">Show grading rubric</a></li>'),__p+='\r\n                <li><a class="btnAnonymize">Anonymize student names</a></li>\r\n                <li><a class="btnGradeUnanswered">Bulk grade unanswered questions</a></li>\r\n                ',isQuiz&&(__p+='\r\n                <li>\r\n                    <a class="btnToggleShowMCAnswer">\r\n                        '+(null==(__t=allowStudentsMCAnswer?"Hide":"Show")?"":__t)+" correct multiple choice answers\r\n                    </a>\r\n                </li>\r\n                "),__p+='\r\n                <li><a class="btnBulkReset">Bulk allow revisions</a></li>\r\n                <li><a class="btnBulkRestoreGradedResponsesAwaitingRevision">Restore responses awaiting revision</a>\r\n                </li>\r\n                ',allowPrinting&&(__p+='<li><a class="btnPrintView">Print<span\r\n                            class="primeFeature icon-premium-lock" /></a></li>'),__p+='\r\n                <li><a class="btnGradingSettings">Edit grading settings</a></li>\r\n                ',sCH.readerConfig.Settings.grading&&sCH.readerConfig.Settings.grading.AllowGradingTagging&&(__p+='\r\n                <li><a class="btnViewTaggedResponses">View tagged responses</a></li>\r\n                '),__p+="\r\n                ",sCH.userM.isOnPrimePlan()&&!isUsingCustomGradingLabels&&(__p+='\r\n                <li><a class="btnToggleAutoGrading">Turn suggested grades\r\n                        ',print(isAutoGradingTurnedOn?"off":"on"),__p+="</a></li>\r\n                "),__p+="\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(86),o=n(687),r=n(10),l=n(1809),d=n(1810);t.default=Backbone.View.extend({el:"main.scroll .gradingview",events:{"click .grades li":"graded","click .btnResetResponse":"allowRevision","focus [contenteditable]":"preComment","blur [contenteditable]":"commented","click .comment span.addComment":"toggleCommentBox","click .btnRubric":"showRubric","click .showNext":"showNextQuestion","click .btnDoNotGrade":"toggleQuestionDoNotGrade","click .btnViewModelResponse":"showModelResponse","click .linkQuestionNum":"skipToQuestion","click .responseTagDropdown .dropdown-menu a":"addGradingTag","click .questionResponseGradingTag .close":"removeGradingTag"},template:n(1812),byQuestionTemplate:n(1813),byStudentTemplate:n(1814),initialize:function(e){this.reader=e.reader,this.assignmentId=e.assignmentId,this.studentsC=e.studentsC,this.questionsC=e.questionsC,this.sortOrder=e.sortOrder,this.studentUserId=null,Backbone.pubEv.on("gradingUpdateNoResponseId",this.updateNoResponseId,this),Backbone.pubEv.on("initializeCommentSuggestionsAutoComplete",this.initializeAutoComplete,this)},render:function(){this.$el.html(this.template()),this.delegateEvents(a.extend(this.events,{"click img":"handleImageClick"}))},showByQuestion:function(e){var t=this;t.ttrC=new o.default,t.ttrC.fillByQuestionTagId(e,t.assignmentId,(function(n){t.renderByQuestion(e,n)}))},showByStudent:function(e){if(isNaN(e)||this.questionsC.length<=0)return $(".results").html('<div class="ctaInfo">'+alcfg.confirmsText.noQuestionsToGrade+"</div>"),!1;var t=this;t.ttrC=new o.default,t.ttrC.fillByStudentUserIdAndAssignmentId(e,t.assignmentId,(function(n){t.renderByStudent(e,n)}))},isRubricPresent:function(e){return!!e&&(e&&e.RubricData?JSON.parse(e.RubricData):[]).find((function(e){return e.critique.map((function(e){return e.text})).join("").length>0}))},renderByQuestion:function(e,t){if(this.$el.removeClass("doNotGrade"),e>0){var n=this.studentsC.toJSON(),i=this.ttrC.toJSON(),o=[],r=[],l=this;if(a.each(n,(function(e){0==a.filter(i,{UserId:e.UserId,IsReset:!1}).length?r.push(e):o.push(e)})),"name"==this.sortOrder)n=(n=o.concat(r)).sort((function(e,t){return e.LastName.localeCompare(t.LastName)}));else if("likes"===this.sortOrder)n=(o=o.sort((function(e,t){var n=a.find(i,{UserId:e.UserId}),s=a.find(i,{UserId:t.UserId});return n.VoteData&&s.VoteData?s.VoteData.UpVotes-n.VoteData.UpVotes:n.VoteData?-1:1}))).concat(r);else if("grade"===this.sortOrder)n=(o=o.sort((function(e,t){var n=a.find(i,{UserId:e.UserId,IsReset:!1});return a.find(i,{UserId:t.UserId,IsReset:!1}).Grade-n.Grade}))).concat(r);else if("reset-requests"===this.sortOrder)n=(o=o.sort((function(e,t){var n=a.find(i,{UserId:e.UserId}),s=a.find(i,{UserId:t.UserId});return(!s.IsReset&&s.IsStudentRequestReset)^(!n.IsReset&&n.IsStudentRequestReset)?n.IsStudentRequestReset&&!n.IsReset?-1:1:0}))).concat(r);else if("time-answered"===this.sortOrder)n=(o=o.sort((function(e,t){var n=a.find(i,{UserId:e.UserId}),s=a.find(i,{UserId:t.UserId});return moment(s.AnswerDate)-moment(n.AnswerDate)}))).concat(r);else{this.sortOrder="ungraded",this.reader.gradingView.sortOrder="ungraded",o=o.sort((function(e,t){var n=a.find(i,{UserId:e.UserId,IsReset:!1}),s=a.find(i,{UserId:t.UserId,IsReset:!1});return l.compareResponses(n,s)}));var d=a.map(a.filter(i,{IsReset:!0}),"UserId"),c=a.remove(r,(function(e){return a.includes(d,e.UserId)}));n=o.concat(c).concat(r)}var u=this.questionsC.getModelByQuestionTagId(e).toJSON(),p=u.QuestionNum>=this.questionsC.length,h=s.getStandardById(u.StandardId),g=u.SecondStandardId?s.getStandardById(u.SecondStandardId):null;if(u.StandardCode=h.StandardCode,u.StandardShortText=h.ShortText,g&&(u.SecondStandardCode=g.StandardCode,u.SecondStandardShortText=g.ShortText),2===u.SubType){var f=a.map(a.filter(u.QuestionChoices,{IsCorrect:!0}),"Text");u.CorrectAnswerText=f.length>1?'<ul class="multiSelectResponse">'+a.reduce(f,(function(e,t){return e+"<li>"+t+"</li>"}),"")+"</ul>":f[0]}a.each(i,(function(e){e.Text=s.linkify(e.Text)}));var m=this.isRubricPresent(s.getStandardById(u.StandardId)),v=this.isRubricPresent(s.getStandardById(u.SecondStandardId));this.$el.find(".results").html(this.byQuestionTemplate({question:u,responses:i,isRubricPresentForStandard:m,isRubricPresentForSecondStandard:v,students:n,grades:sCH.readerConfig.gradeNameMap,isLastQues:p,fixedGradingTags:alcfg.fixedGradingTags,isOnFreePlan:sCH.userM.isOnFreePlan(),shouldShowAutoGradeStuff:t,getAutoGradingTooltip:this.getAutoGradingTooltip})).scrollTop(0),this.anonymize(),s.destroyMediumEditor(this.medium1),this.medium1=s.initMediumEditor(this.$el.find(".results [contenteditable]")),sCH.questionsNumC.find({QuestionTagId:e}).get("IsDoNotGrade")&&this.$el.addClass("doNotGrade"),sCH.readerConfig.TeacherCommentSuggestions.length>0&&this.initializeAutoComplete(),$(".reader .rubricContainer:visible").length>0&&this.$el.find(".btnRubric").click(),$(".reader .modelResponsePopup:visible").length>0&&$(".reader .modelResponsePopup .close").click(),this.renderMediaForResponses(),s.initTooltips(this.$el),"reset-requests"===this.sortOrder&&this.highightReviseRequestsInView(),Backbone.tracking.trackGAEvent("teacher","grading:showByQuestion")}},renderByStudent:function(e,t){var n=a.filter(this.studentsC.toJSON(),{UserId:e})[0],i=this.questionsC.toJSON(),o=this.ttrC.toJSON(),r=[],l=[],d=this;if(this.$el.removeClass("doNotGrade"),a.each(i,(function(e,t){e.Index=t;var n=s.getStandardById(e.StandardId);e.StandardCode=n.StandardCode,e.SecondStandardId&&(e.SecondStandardCode=s.getStandardById(e.SecondStandardId).StandardCode),0==a.filter(o,{QuestionTagId:e.TagId}).length?l.push(e):r.push(e)})),"ungraded"==this.sortOrder){r=r.sort((function(e,t){var n=a.filter(o,{QuestionTagId:e.TagId})[0],s=a.filter(o,{QuestionTagId:t.TagId})[0],i=d.compareResponses(n,s);return 0===i?e.Index>t.Index?1:-1:i}));var c=a.map(a.filter(o,{IsReset:!0}),"QuestionTagId"),u=a.remove(r,(function(e){return a.includes(c,e.TagId)}));i=r.concat(u).concat(l)}else"likes"===this.sortOrder?i=(r=r.sort((function(e,t){var n=a.filter(o,{QuestionTagId:e.TagId})[0],s=a.filter(o,{QuestionTagId:t.TagId})[0];return n.VoteData&&s.VoteData?s.VoteData.UpVotes-n.VoteData.UpVotes:n.VoteData?-1:1}))).concat(l):"grade"===this.sortOrder?i=(r=r.sort((function(e,t){var n=a.filter(o,{QuestionTagId:e.TagId})[0];return a.filter(o,{QuestionTagId:t.TagId})[0].Grade-n.Grade}))).concat(l):"reset-requests"===this.sortOrder?i=(r=r.sort((function(e,t){var n=a.filter(o,{QuestionTagId:e.TagId})[0],s=a.filter(o,{QuestionTagId:t.TagId})[0];return(!s.IsReset&&s.IsStudentRequestReset)^(!n.IsReset&&n.IsStudentRequestReset)?n.IsStudentRequestReset&&!n.IsReset?-1:1:0}))).concat(l):"time-answered"===this.sortOrder?i=(r=r.sort((function(e,t){var n=a.filter(o,{QuestionTagId:e.TagId})[0],s=a.filter(o,{QuestionTagId:t.TagId})[0];return moment(s.AnswerDate)-moment(n.AnswerDate)}))).concat(l):(this.reader.gradingView.sortOrder="chronological",this.sortOrder="chronological",i=(i=r.concat(l)).sort((function(e,t){return e.Index>t.Index?1:-1})));a.each(o,(function(e){e.Text=s.linkify(e.Text)})),a.each(i,(function(e){e.isRubricPresentForStandard=d.isRubricPresent(s.getStandardById(e.StandardId)),e.isRubricPresentForSecondStandard=d.isRubricPresent(s.getStandardById(e.SecondStandardId))})),this.$el.find(".results").html(this.byStudentTemplate({questions:i,responses:o,student:n,grades:sCH.readerConfig.gradeNameMap,questionsNumC:sCH.questionsNumC,fixedGradingTags:alcfg.fixedGradingTags,isOnFreePlan:sCH.userM.isOnFreePlan(),shouldShowAutoGradeStuff:t,getAutoGradingTooltip:this.getAutoGradingTooltip})).scrollTop(0),s.destroyMediumEditor(this.medium2),this.medium2=s.initMediumEditor(this.$el.find(".results [contenteditable]")),sCH.readerConfig.TeacherCommentSuggestions.length>0&&this.initializeAutoComplete(),this.renderMediaForResponses(),"reset-requests"===this.sortOrder&&this.highightReviseRequestsInView(),s.initTooltips(this.$el),Backbone.tracking.trackGAEvent("teacher","grading:showByStudent")},renderMediaForResponses:function(){this.$el.find(".studentResponseMediaContainer").each((function(e,t){i.embedMediaFull({container:$(this),mediaUrl:$(this).data("url")})}))},toggleQuestionDoNotGrade:function(e){var t=$(e.currentTarget).data("id"),n=this.$el.find(".grades li.selected").length>0,s=sCH.readerConfig.QuestionsDoNotGrade,i=this,o=this.$el.hasClass("doNotGrade");if(o){if(s){var l=$.inArray(t,s);s.splice(l,l>-1?1:0)}}else s?-1===$.inArray(t,s)&&s.push(t):s=[t];sCH.readerConfig.QuestionsDoNotGrade=s;var d=function(){r.MarkQuestionDoNotGrade({questionTagId:t,assignmentId:sCH.readerConfig.assignmentId,markDoNotGrade:!o},(function(e){if(e){sCH.questionsNumC.find({QuestionTagId:t}).set("IsDoNotGrade",!o),i.$el.toggleClass("doNotGrade");var n=$('.textSectionContainer .questionTagViewMode[data-tagid="'+t+'"]').closest(".teacherQuestion");if(i.reader.gradingView.subheader.markQuestionDoNotGrade({questionTagId:t,markDoNotGrade:!o}),!o){sCH.readerConfig.ungradedResponseIds[t];if(o){var s=a.filter(i.ttrC.models,(function(e){return!e.get("Grade")&&!e.get("IsReset")&&!e.get("IsDraft")&&e.get("Text")&&"No response"!==e.get("Text")}));s.length>0&&(sCH.readerConfig.ungradedResponseIds[t]=a.map(s,(function(e){return e.get("QuestionTagResponseId")})),a.each(s,(function(e){sCH.readerConfig.ungradedResponseIdsByUser[e.get("UserId")]=sCH.readerConfig.ungradedResponseIdsByUser[e.get("UserId")]||[],sCH.readerConfig.ungradedResponseIdsByUser[e.get("UserId")].push(e.get("QuestionTagResponseId"))})),Backbone.pubEv.trigger("updateGradePanelCount")),n.removeClass("doNotGrade")}else{sCH.readerConfig.ungradedResponseIds[t]&&(a.each(Object.keys(sCH.readerConfig.ungradedResponseIdsByUser),(function(e){sCH.readerConfig.ungradedResponseIdsByUser[e]=a.difference(sCH.readerConfig.ungradedResponseIdsByUser[e],sCH.readerConfig.ungradedResponseIds[t])})),delete sCH.readerConfig.ungradedResponseIds[t],Backbone.pubEv.trigger("updateGradePanelCount")),a.each(i.ttrC.models,(function(e){e.set("Grade",null)})),i.$el.find(".results .grades li.selected").removeClass("selected"),n.addClass("doNotGrade"),Backbone.notificationHelper.notifications=a.filter(Backbone.notificationHelper.notifications,(function(e){return e.TagId!==t})),Backbone.notificationHelper.updateNotificationButton()}}}}))};n&&!o?new Backbone.BootstrapModal({title:"Warning: grades for this question will be permanently removed",content:alcfg.confirmsText.questionDoNotGrade,cssClass:"modal-lg modal-delete modal-al-mark-do-not-grade",okText:"Continue"}).open((function(){d()})):d()},showNextQuestion:function(){var e=$(".reader .gradingview select.ddlQuestions"),t=parseInt(e.find("option:selected").next().val());e.val(t).change()},toggleCommentBox:function(e){$(e.currentTarget).children(".arrow").toggleClass("closed");var t=$(e.currentTarget).parent().find("[contenteditable]");t.is(":visible")?t.hide():(t.show(),t.focus())},sortResults:function(e){this.sortOrder=e,"-1"!==$(".gradingview .panelHeader .ddlStudents").val()?this.showByStudent(parseInt($(".gradingview .panelHeader .ddlStudents").val())):this.showByQuestion(parseInt($(".gradingview .panelHeader .ddlQuestions").val()))},compareResponses:function(e,t){return null===e.Grade&&null===t.Grade?0:null===e.Grade&&null!==t.Grade?-1:null!==e.Grade&&null===t.Grade?1:0},allowRevision:function(e){var t=this,n=$(e.currentTarget),a=parseInt(n.data("id")),i=parseInt(n.closest(".response").data("questiontagid")),o=parseInt(n.closest(".response").data("userid"));function l(){var n=t.ttrC.find({QuestionTagResponseId:a}),l=-1===a?{questionTagId:i,studentUserId:o,assignmentId:sCH.readerConfig.assignmentId}:{questionTagResponseId:a,studentUserId:o,assignmentId:sCH.readerConfig.assignmentId};r.AllowRevision(l,(function(r){if(r){if(-1===a){var l={QuestionTagResponseId:r.questionTagResponseId,QuestionTagId:i,AssignmentId:sCH.readerConfig.assignmentId,Text:"No response",IsReset:!0,AnswerDate:r.updateDate};t.ttrC.add(l),n=t.ttrC.find({QuestionTagResponseId:r.questionTagResponseId})}t.updateHtmlForRevisedResponse($(e.currentTarget),n),s.bootstrap.alert({message:"The student can now revise their response!"}),sCH.updateResetRequestList({userId:o,questionTagResponseId:a,action:"remove"}),$(e.currentTarget).data("id","-1").siblings(".grades").data("id","-1"),sCH.readerConfig.isAssessment||sCH.updateUngradedList({questionTagId:i,questionTagResponseId:r.questionTagResponseId,userId:o,action:"remove",updateTotals:!0})}}))}if(sCH.userM.showPopup("AllowRevisionConfirm"))var d=new Backbone.BootstrapModal({title:"Allow student to revise their response?",content:alcfg.confirmsText.resetResponse,cssClass:"modal-al-reset-response",okText:"Allow revision",okFocus:!1,doNotShowAgain:!0}).open((function(){s.isDoNotShowChecked(d)&&s.updateDoNotShowPopupSetting("AllowRevisionConfirm"),l()}));else l()},updateHtmlForRevisedResponse:function(e,t){var n=e.siblings(".responsesContainer"),a=e.siblings(".grades").find(".selected"),s=e.siblings(".comment").find("[contenteditable]"),i=n.find(">.studentResponseMediaContainer"),o=e.siblings(".tagList,.responseTagDropdown"),r=moment(t.get("AnswerDate")+"Z").format("MM/DD/YY h:mm a"),l=a.length?'<span class="grade">'+a.text()+"</span>":"",d=s.length&&s.html().length?'<div class="resetcomment">\n          <span class="heading opaque">My comment:</span>\n          <p>'+s.html()+"</p>\n        </div>":"",c=$('\n      <div class="text reset">\n        <div>\n          <span class="heading opaque">Previous response ('+r+'):</span>\n          <div class="responseText realtimeAddedAnswerText">'+t.get("Text")+"</div>\n          "+l+"\n        </div>\n        "+d+"\n      </div>");n.append(c),i.length&&(i.detach(),i.insertAfter(n.find(".realtimeAddedAnswerText"))),n.find(".text:not(.reset)").remove(),a.removeClass("selected"),this.removeAutoGradingFromButtons(e.siblings(".grades")),e.hide(),o.hide()},graded:function(e){var t=$(e.currentTarget).parent();if(t.hasClass("needsRefresh"))new Backbone.BootstrapModal({title:"Wait a sec!",content:"Your student has updated the response to this question. Please click the orange Refresh button at the top of the panel.",cssClass:"modal-al-question-needs-refresh",allowCancel:!1,cancelText:""}).open();else{var n={questionTagResponseId:parseInt(t.data("id")),grade:parseInt($(e.currentTarget).data("grade")),questionTagId:parseInt(t.data("questiontagid")),assignmentId:this.assignmentId,userId:parseInt(t.data("userid"))},a=$(e.currentTarget).closest(".response").find(".responsesContainer .text:last-child"),s=a.hasClass("disabled"),i=a.hasClass("reset");if(-1===n.questionTagResponseId&&t.nextAll(".comment").removeClass("noresponse"),$(e.currentTarget).hasClass("selected")){var o={questionTagResponseId:n.questionTagResponseId,assignmentId:this.assignmentId,userId:n.userId,questionTagId:n.questionTagId};this.ttrC.unGrade(o),$(e.currentTarget).removeClass("selected"),-1===o.questionTagResponseId||"No response"===a.text()?(sCH.updateGradingResponseTotals({questionTagId:n.questionTagId,questionTagResponseId:n.questionTagResponseId,userId:n.userId,action:"remove"}),a.text("Student has not responded").addClass("disabled"),t.siblings(".btnResetResponse.reset").hide(),t.siblings(".comment").addClass("noresponse").find("[contenteditable]").html(""),t.data("id",-1)):sCH.updateUngradedList({questionTagId:n.questionTagId,questionTagResponseId:n.questionTagResponseId,userId:n.userId,action:"add"})}else{if(t.children().removeClass("selected"),this.removeAutoGradingFromButtons(t),$(e.currentTarget).addClass("selected"),-1===n.questionTagResponseId||s)if(!i||s)a.text("No response").removeClass("disabled");else{var r=a.find(".responseText").html(),l=a.find(".studentResponseMediaContainer");$(e.currentTarget).closest(".response").find(".responsesContainer").append('<div class="text">'+r+"</div>").append(l),a.remove()}t.siblings(".btnResetResponse.reset").length>0?t.siblings(".btnResetResponse.reset").show():($('<div class="reset btnResetResponse" title="Allow student to revise their response"           data-id="'+n.questionTagResponseId+'">Allow Revision</div>').insertBefore(t),$(t).closest(".response").attr("data-userid",n.userId)),this.updatedResponse=n,sCH.updateUngradedList({questionTagId:n.questionTagId,questionTagResponseId:n.questionTagResponseId,userId:n.userId,action:"remove"}),this.update()}}},preComment:function(e){var t=parseInt($(e.currentTarget).data("id")),n=sCH.questionTagResponsesC.findWhere({QuestionTagResponseId:t});this.currentFocusedPreChangeTeacherComment=n?n.get("TeacherComment"):$(e.currentTarget).html()},commented:function(e){var t=this,n={questionTagResponseId:$(e.currentTarget).data("id"),teacherComment:$(e.currentTarget).html(),assignmentId:sCH.readerConfig.assignmentId,studentUserId:$(e.currentTarget).data("userid"),questionTagId:$(e.currentTarget).data("questiontagid")};t.currentFocusedPreChangeTeacherComment===n.teacherComment||""===t.currentFocusedPreChangeTeacherComment&&""===n.teacherComment.replace("<p>","").replace("</p>","").replace("<br>","")||($(e.currentTarget).text().trim()||(n.teacherComment="",$(e.currentTarget).html("")),t.commentTimeoutCompare=-1===sCH.readerConfig.selectedStudentUserId?n.userId:n.questionTagId,t.commentTimeout=window.setTimeout((function(){t.updatedResponse=n;t.update(!0),t.saveCommentAsTemplate(n.teacherComment)}),200))},update:function(e){try{if(this.updatedResponse){var t=this,n=function(e){if(e){t.hideAlert||(s.bootstrap.alert({message:"Autosaving... (all your changes are saved instantly)"}),t.hideAlert=!0);try{s.intercom("trackEvent","graded-assignment",{assignmentId:sCH.learnEntityMetaM.get("AssignmentId"),assignmentName:sCH.learnEntityMetaM.get("Title")})}catch(e){}Backbone.pubEv.trigger("gradeSubmitted",t.updatedResponse),delete t.updatedResponse}else s.bootstrap.alert({message:"Sorry! We couldn't save that grade. Refresh the page and try again.",alert:"danger",autoClose:"long"})};e?this.ttrC.submitComment(this.updatedResponse,n):this.ttrC.submitGrades(this.updatedResponse,n)}}catch(e){s.bootstrap.alert({message:"Sorry! We couldn't save that grade. Refresh the page and try again.",alert:"danger",autoClose:"long"})}},anonymize:function(){if(sCH.readerConfig.anonymizeGrading)this.$el.find(".response .name").text("Anonymous"),Backbone.tracking.trackGAEvent("teacher","grading:Anonymize");else{var e=this.$el.find(".response .name");a.each(e,(function(e){$(e).text($(e).data("name"))})),Backbone.tracking.trackGAEvent("teacher","grading:Unanonymize")}},closeSidePanelPopup:function(){$(".reader .readerSidePopupContainer:visible").length>0&&$(".reader .readerSidePopupContainer .close").click()},showRubric:function(e){this.closeSidePanelPopup(),this.reader.gradingView.subheader.showRubric(e)},showModelResponse:function(e){this.closeSidePanelPopup();var t=$(e.currentTarget).data("id"),n=this.questionsC.getModelByQuestionTagId(t),a=n.get("ModelResponse"),s=1===n.get("SubType");(new d.default).render({modelResponse:a,isShortAnswer:s})},updateNoResponseId:function(e){var t=this.$el.find(".response[data-userid="+e.userId+"][data-questiontagid="+e.questionTagId+"]");(t.find(".grades li.selected").length>0||t.find(".comment [contenteditable]").text().trim().length>0)&&t.find(".grades, .comment [contenteditable]").data("id",e.questionTagResponseId)},initializeAutoComplete:function(){var e=this,t=this.$el.find(".results [contenteditable]");t.attr("data-autocomplete-spy",""),l.default($),t.on("autocomplete:request",(function(e,t,n){if((t=s.sanitize(t)).length>=2){var i=[];a.each(sCH.readerConfig.TeacherCommentSuggestions,(function(e){var n=$("<div>").html(e).text().trim(),s=$("<div>").html(t).text().trim();n.length>s.length&&n.substring(0,s.length).toLowerCase()===s.toLowerCase()&&i.length<10&&-1===a.map(i,"text").indexOf(n)&&i.push({text:n,html:e})})),n(i)}})),t.on("autocomplete:select",(function(t,n){e.currentFocusedPreChangeTeacherComment=""}))},saveCommentAsTemplate:function(e){if(sCH.readerConfig){if(!e||0===e.length||$.inArray(e,sCH.readerConfig.TeacherCommentSuggestions)>-1)return;sCH.readerConfig.TeacherCommentSuggestions.unshift(e),1===sCH.readerConfig.TeacherCommentSuggestions.length&&this.initializeAutoComplete()}},skipToQuestion:function(e){var t=$(e.currentTarget).data("qnum"),n=sCH.questionsNumC.find({QuestionNum:t});sCH.readerConfig.isMedia?Backbone.pubEv.trigger("skipToVideoQuestion",{questionTagId:n.get("QuestionTagId")}):Backbone.pubEv.trigger("skipToTag",{sectionId:n.get("TextSectionId"),tagId:n.get("QuestionTagId"),tagType:"question"})},handleImageClick:function(e){return i.openMediaInPopup($(e.currentTarget).attr("src")),!1},addGradingTag:function(e){var t=$(e.currentTarget).data("tagname"),n=$(e.currentTarget).closest(".response");if(n.find('.questionResponseGradingTag[data-tagname="'+t+'"]').length>0)s.bootstrap.alert({message:'The tag "'+t+'" is already added to the response.',alert:"warning"});else{var a=n.find(".grades"),i=a.data("id");if(-1===i){var o=a.data("questiontagid"),l=a.data("userid"),d=this.ttrC.where({QuestionTagId:o,UserId:l}).slice(-1)[0];i=d.get("QuestionTagResponseId")}r.AddGradingTagToResponse({questionTagResponseId:i,tagName:t},(function(e){if(e){n.find(".tagList").append('\n              <div class="questionResponseGradingTag" data-tagname="'+t+'">\n                <span>'+t+'</span>\n                <span class="close"></span>\n              </div>');var a=sCH.questionTagResponsesC.find({QuestionTagResponseId:i});a.set("GradingTags",(a.get("GradingTags")?a.get("GradingTags")+",":"")+t)}}))}},removeGradingTag:function(e){var t=$(e.currentTarget).closest(".questionResponseGradingTag").data("tagname"),n=$(e.currentTarget).closest(".response"),s=n.find(".grades").data("id");r.RemoveGradingTagFromResponse({questionTagResponseId:s,tagName:t},(function(e){if(e){n.find('.questionResponseGradingTag[data-tagname="'+t+'"]').remove();var i=sCH.questionTagResponsesC.find({QuestionTagResponseId:s}),o=a.without((i.get("GradingTags")||"").split(","),t);i.set("GradingTags",o.length>0?o.join(","):null)}}))},getAutoGradingTooltip:function(e,t){if(e["Grade"+e.PrimaryAutoGrade+"Confidence"]+(e["Grade"+e.SecondaryAutoGrade+"Confidence"]||0)>=.7){var n=e.PrimaryAutoGrade===t||e.SecondaryAutoGrade===t,a=!e.Grade;if(n&&a)return"Suggested grade (beta)"}return null},removeAutoGradingFromButtons:function(e){e.find(".autograded").attr("title","").attr("data-original-title","").removeClass("autograded")},highightReviseRequestsInView:function(){window.setTimeout((function(){$(".btnResetResponse.studentRequest:eq(0)").addClass("flash"),window.setTimeout((function(){$(".btnResetResponse.studentRequest:eq(0)").removeClass("flash")}),2e3)}),500)},destroy:function(){window.clearInterval(this.interval),Backbone.pubEv.off("gradingUpdateNoResponseId"),Backbone.pubEv.off("initializeCommentSuggestionsAutoComplete"),s.destroyMediumEditor(this.medium1),s.destroyMediumEditor(this.medium2)}})},function(e,t,n){"use strict";function a(e){var t=function(t){var n,a,s,i,o,r,l,d={UP:38,DOWN:40,TAB:9,RETURN:13,ESC:27,COMMA:188};function c(){i=a.text(),l&&function(){var e=a.text();e&&a.val(e.replace(m,", "))}()}function u(){var e,t=a.text();if(!t.trim())return s.hide(),void(i=t);i!==t&&(i=t,e=l?function(){for(var e,t=T(a[0]),n=0,s=i.split(w),o=0;o<s.length;o++){if(e=s[o],n+e.length>=t)return i.substring(n,t).trim();n+=e.length+1}console.log("getCurrentQuery: Could not find query!")}():t,a.trigger("autocomplete:request",[e,b]))}function p(e){if(s.is(":visible")&&0!==s.find("div").length)switch(e.keyCode){case d.UP:return e.preventDefault(),void function(){var e=s.find(".highlight"),t=e.prev();if(!t.length)return;e.removeClass("highlight"),t.addClass("highlight")}();case d.DOWN:return e.preventDefault(),void function(){var e=s.find(".highlight"),t=e.next();if(!t.length)return;e.removeClass("highlight"),t.addClass("highlight")}();case l&&d.COMMA:case d.RETURN:case d.TAB:if(_(s.find(".highlight")),s.hide(),e.keyCode===d.TAB)return;return void e.preventDefault();case d.ESC:return void s.hide()}}function h(){s.hide(),l&&function(){var e=a.text();a.val(e.replace(m,""))}()}function g(t){t.preventDefault(),t.stopPropagation(),_(e(t.currentTarget)),s.hide()}var f=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,m=/[,\s]*$/,v=/\s*,\s*/;function b(e){var t="",n=i.replace(f,"\\$&"),a=new RegExp("("+n+")","i");o=i.trim().split(v),0!==(r=e.map(y).filter(C)).length?(r.forEach((function(e,n){var s=e.text,i=0===n?' class="highlight"':"";s&&(s=A(s),t+="<div"+i+">",t+=s.replace(a,"<strong>$1</strong>"),t+="</div>")})),s.html(t).show()):s.hide()}function C(e){if(e)return-1===o.indexOf(e.value)}function y(e){if(e)return"string"==typeof e?{label:e,value:e}:e}function _(e){var t=r[e.index()],n=t.text;l?function(e){for(var t,n,s,o=T(a[0]),r=0,l=i.split(w),d=0;d<l.length;d++){if(t=l[d],r+t.length>=o)return n=i.substring(0,r).trim(),s=i.substring(o),a.html(A(n+" "+e)+",&nbsp"+A(s)),void S((n+" "+e+", ").length);r+=t.length+1}console.log("replaceCurrentWordWith: Could not find word, returning last")}(n):(a.html(t.html).focus(),S(n.length)),a.trigger("autocomplete:select",[t])}function S(e){var t=document.createRange(),n=window.getSelection(),s=a[0].childNodes.length?a[0].childNodes[0]:a[0];e=Math.min(s.length,e),t.setStart(s,e),t.collapse(!0),n.removeAllRanges(),n.addRange(t)}var w=/,/;function T(e){var t,n,a=0,s=e.ownerDocument||e.document,i=s.defaultView||s.parentWindow;return void 0!==i.getSelection&&i.getSelection().rangeCount>0&&((n=(t=i.getSelection().getRangeAt(0)).cloneRange()).selectNodeContents(e),n.setEnd(t.endContainer,t.endOffset),a=n.toString().length),a}var I=/&/g,x=/'/g,k=/"/g,E=/</g,N=/>/g;function A(e){return e.replace(I,"&amp").replace(x,"&#39").replace(k,"&quot").replace(E,"&lt").replace(N,"&gt")}a=e(t),n=e("<"+t.nodeName+" data-autocomplete/>"),(s=e('<div class="suggestions">').appendTo(n)).append("<div>Suggestion 1</div><div>Suggestion 2</div><div>Suggestion 3</div>"),s.hide(),l=a.is("[data-autocomplete-multiple]"),a.on("focus",c),a.on("input",u),a.on("keydown",p),a.on("blur",h),s.on("mousedown touchstart","> div",g),setTimeout((function(){var e=T(a[0]);a.after(n).appendTo(n),a.focus(),S(e)}))};e.fn.contenteditableAutocomplete=function(){return this.each((function(){var n=e(this),a=n.data("bs.contenteditableAutocomplete");a||n.data("bs.contenteditableAutocomplete",a=new t(this))}))},e.fn.contenteditableAutocomplete.Constructor=t,e(document).on("focus.bs.contenteditableautocomplete.data-api","[data-autocomplete-spy]",(function(t){var n=e(t.currentTarget);t.preventDefault(),t.stopImmediatePropagation(),n.removeAttr("data-autocomplete-spy").contenteditableAutocomplete(),n.trigger(e.Event(t))}))}n.r(t),"undefined"!=typeof window&&window.jQuery&&a(window.jQuery),t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({el:"div.modelResponsePopup",events:{"click .close":"closeView","click .btnClose":"closeView"},template:n(1811),render:function(e){this.$el.html(this.template(e)).addClass("readerSidePopupContainer"),this.$el.show(),this.$el.css({right:a.getRightAlignmentToPlaceNextToRightPanel()}),a.initTooltips(this.$el)},closeView:function(){this.close(!1),this.$el.hide()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="popupHeader">\n  <h1>'+(null==(__t=isShortAnswer?"Model Response":"Explanation")?"":__t)+'</h1>\n  <a class="close"></a>\n</div>\n<div class="clearBoth"></div>\n\n<div class="modelResponse">'+(null==(__t=cH.sanitize(modelResponse))?"":__t)+'</div>\n\n<div class="clearBoth" style="height:20px;"></div>\n<a class="btn pull-right btnClose">Close</a>\n<div class="clearBoth" style="height:20px;"></div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="panelHeader">\n  <aside class="gradingview" aria-label="grading options"></aside>\n</div>\n<div class="results"></div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="question">\r\n    ',question.StandardId&&(__p+="\r\n        ",isRubricPresentForStandard?__p+='\r\n            <a class="heading opaque btnRubric" data-standardid="'+(null==(__t=question.StandardId)?"":__t)+'">\r\n                Standard '+(null==(__t=question.StandardCode)?"":__t)+" - "+(null==(__t=cH.sanitize(question.StandardShortText))?"":__t)+"\r\n            </a>\r\n        ":__p+='\r\n            <span class="heading opaque" data-standardid="'+(null==(__t=question.StandardId)?"":__t)+'">\r\n                Standard '+(null==(__t=question.StandardCode)?"":__t)+" - "+(null==(__t=cH.sanitize(question.StandardShortText))?"":__t)+"\r\n            </span>\r\n        ",__p+="\r\n    "),__p+="\r\n    ",question.SecondStandardId&&(__p+="\r\n        ",isRubricPresentForSecondStandard?__p+='\r\n            <a class="heading opaque btnRubric" data-standardid="'+(null==(__t=question.SecondStandardId)?"":__t)+'">\r\n                '+(null==(__t=question.SecondStandardCode)?"":__t)+" - "+(null==(__t=cH.sanitize(question.SecondStandardShortText))?"":__t)+"\r\n            </a>\r\n        ":__p+='\r\n            <span class="heading opaque" data-standardid="'+(null==(__t=question.SecondStandardId)?"":__t)+'">\r\n                '+(null==(__t=question.SecondStandardCode)?"":__t)+" - "+(null==(__t=cH.sanitize(question.SecondStandardShortText))?"":__t)+"\r\n            </span>\r\n        ",__p+="\r\n    "),__p+='\r\n    <div class="text">'+(null==(__t=cH.sanitize(question.Text))?"":__t)+"</div>\r\n    ",3!==question.SubType&&(__p+='\r\n        <div class="btnDoNotGrade btn-box pull-left small" data-id="'+(null==(__t=question.TagId)?"":__t)+"\">\r\n            <span>Mark question as 'not grading'</span>\r\n        </div>\r\n    "),__p+="\r\n    ",!isOnFreePlan&&question.ModelResponse&&question.ModelResponse.length&&(__p+='\r\n        <div class="btnViewModelResponse btn-box pull-left small" data-id="'+(null==(__t=question.TagId)?"":__t)+'">\r\n            <span>View '+(null==(__t=1===question.SubType?"model response":"explanation")?"":__t)+"</span>\r\n        </div>\r\n    "),__p+="\r\n    ",shouldShowAutoGradeStuff&&(__p+='\r\n        <div class="clearBoth"></div>\r\n        <div class="autogradingInfo">\r\n            Responses to this question may have suggested grades (beta)\r\n            <a href="'+(null==(__t=alcfg.helpArticleLink.autoGrading)?"":__t)+'" class="btnInstructionsHelpArticle icon-question-mark-inverse"></a>\r\n        </div>\r\n    '),__p+='\r\n    <div class="clearBoth"></div>\r\n</div>\r\n',_.each(students,(function(e){var t=_.filter(responses,{UserId:e.UserId}),n=(t=t.sort((function(e,t){return e.IsReset===t.IsReset?e.AnswerDate>t.AnswerDate?1:-1:e.IsReset?-1:1}))).length>0&&t.slice(-1)[0],a=n&&"No response"!==n.Text&&!n.IsReset?moment(n.AnswerDate+"Z").format("MM/DD/YY h:mm a"):null;if(__p+='\r\n    <div class="response" data-userid="'+(null==(__t=n.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=question.TagId)?"":__t)+'">\r\n        <div class="nameAndDate headerHighlight">\r\n            <div class="name pull-left" data-name="'+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+'">\r\n                '+(null==(__t=cH.sanitize(e.LastName))?"":__t)+", "+(null==(__t=cH.sanitize(e.FirstName))?"":__t)+"\r\n            </div>\r\n            ",a&&(__p+='\r\n                <div class="heading datetime pull-left">'+(null==(__t=a)?"":__t)+"</div>\r\n            "),__p+="\r\n\r\n                ",sCH.readerConfig.Settings.AllowLikingPeerResponses&&!question.HasChoices&&n.VoteData&&n.VoteData.UpVotes&&(__p+='\r\n                <div class="voting">\r\n                    <span class="thumbsup icon-thumbsup no-hover"></span>\r\n                    <span class="numup">'+(null==(__t=n.VoteData.UpVotes)?"":__t)+"</span>\r\n                </div>\r\n            "),__p+='\r\n        </div>\r\n        <div class="responsesContainer '+(null==(__t=a?"":"noResponse")?"":__t)+'">\r\n        ',0==t.length?__p+='\r\n            <div class="text disabled">Student has not responded.</div>\r\n        ':(_.each(t,(function(e){if(e.IsDraft)__p+='\r\n                <div class="text disabled">Student has not responded, but there is a saved draft (grading this question will delete the student\'s saved draft).</div>\r\n            ';else{if(question.HasChoices&&"No response"!==e.Text){var t=[];_.each(e.Text.split(","),(function(e){t.push(_.filter(question.QuestionChoices,{QuestionChoiceId:parseInt(e)})[0].Text)})),t.length>1?e.Text='<ul class="multiSelectResponse">'+_.reduce(t,(function(e,t){return e+"<li>"+cH.sanitize(t)+"</li>"}),"")+"</ul>":e.Text=cH.sanitize(t[0])}e.IsReset?(__p+='\r\n                        <div class="text reset">\r\n                            <div>\r\n                                <span class="heading opaque">Previous response ('+(null==(__t=moment(e.AnswerDate+"Z").format("MM/DD/YY h:mm a"))?"":__t)+'):</span>\r\n                                <div class="responseText">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(e.Text)))?"":__t)+"</div>\r\n                                ",e.MediaUrl&&(__p+='\r\n                                    <div class="studentResponseMediaContainer embedMediaFullContainer" data-url="'+(null==(__t=cH.sanitize(e.MediaUrl))?"":__t)+'"></div>\r\n                                '),__p+="\r\n                                ",null!=e.Grade&&(__p+='\r\n                                    <span class="grade '+(null==(__t=cH.sanitize(grades[e.Grade].label).toLowerCase())?"":__t)+'">\r\n                                        '+(null==(__t=question.HasChoices?0===e.Grade?"Incorrect":"Correct":cH.sanitize(grades[e.Grade].label))?"":__t)+"\r\n                                    </span>\r\n                                "),__p+="\r\n                            </div>\r\n                            ",e.TeacherComment&&(__p+='\r\n                            <div class="resetcomment">\r\n                                <span class="heading opaque">\r\n                                    '+(null==(__t=window.ActivelyRead.currentUserId===e.GradedByUserId?"My comment:":cH.sanitize(e.TeacherName)+"'s comment:")?"":__t)+"\r\n                                </span> "+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(e.TeacherComment)))?"":__t)+"\r\n                            </div>\r\n                            "),__p+="\r\n                        </div>\r\n                    "):(__p+='\r\n                        <div class="text">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(e.Text)))?"":__t)+"</div>\r\n                        ",e.MediaUrl&&(__p+='\r\n                            <div class="studentResponseMediaContainer embedMediaFullContainer" data-url="'+(null==(__t=cH.sanitize(e.MediaUrl))?"":__t)+'"></div>\r\n                        '),__p+="\r\n                    "),__p+="\r\n            "}})),__p+="\r\n        "),__p+="\r\n        </div>\r\n        ",!n||n.IsReset){if(1===question.SubType){__p+='\r\n                <ul class="grades" data-id="-1" data-userid="'+(null==(__t=e.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=question.TagId)?"":__t)+'">\r\n                    ';for(var s=0;s<5;s++)__p+='\r\n                        <li class="'+(null==(__t=grades[s].id)?"":__t)+'" data-grade="'+(null==(__t=s)?"":__t)+'">'+(null==(__t=cH.sanitize(grades[s].label))?"":__t)+"</li>\r\n                    ";__p+='\r\n                </ul>\r\n                <div class="comment'+(null==(__t=n?"":" noresponse")?"":__t)+'">\r\n                    <div contenteditable="true" placeholder="Click here to leave feedback for student..." data-id="-1" data-userid="'+(null==(__t=e.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=question.TagId)?"":__t)+'">'+(null==(__t=n&&n.TeacherComment?cH.sanitize(n.TeacherComment):"")?"":__t)+"</div>\r\n                </div>\r\n            "}}else if(1===question.SubType){__p+="\r\n                ",n.IsStudentRequestReset?__p+='\r\n                    <div class="reset btnResetResponse studentRequest"\r\n                        title="Allow student to revise their response"\r\n                        data-id="'+(null==(__t=n.QuestionTagResponseId)?"":__t)+'">Revision Requested</div>\r\n                ':__p+='\r\n                    <div class="reset btnResetResponse"\r\n                        title="Allow student to revise their response"\r\n                        data-id="'+(null==(__t=n.QuestionTagResponseId)?"":__t)+'">Allow Revision</div>\r\n                ',__p+='\r\n                <ul class="grades" data-userid="'+(null==(__t=n.UserId)?"":__t)+'" data-id="'+(null==(__t=n.QuestionTagResponseId)?"":__t)+'" data-questiontagid="'+(null==(__t=question.TagId)?"":__t)+'">\r\n                    ';for(s=0;s<5;s++){var i=shouldShowAutoGradeStuff?getAutoGradingTooltip(n,s):"";__p+='\r\n                        <li class="'+(null==(__t=grades[s].id)?"":__t)+" ",print(n.Grade===s?"selected":""),__p+=" ",print(i?"autograded":""),__p+='"\r\n                            data-grade="'+(null==(__t=s)?"":__t)+"\"\r\n                            data-container='body'\r\n                            title=\""+(null==(__t=i)?"":__t)+'"\r\n                        >\r\n                            '+(null==(__t=cH.sanitize(grades[s].label))?"":__t)+"\r\n                        </li>\r\n                    "}__p+="\r\n                </ul>\r\n                ",n.IsDraft||(__p+='\r\n                    <div class="comment">\r\n                        <div contenteditable="true" placeholder="Click here to leave feedback for student..." data-id="'+(null==(__t=n.QuestionTagResponseId)?"":__t)+'" data-userid="'+(null==(__t=e.UserId)?"":__t)+'">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(n.TeacherComment)))?"":__t)+"</div>\r\n                    </div>\r\n                ")}else 2===question.SubType&&(4===n.Grade?__p+='\r\n                    <span class="mcGradeContainer heading correct">Correct</span>\r\n                ':(__p+="\r\n                    ","No response"===n.Text?__p+='\r\n                        <span class="heading">Unanswered</span>\r\n                    ':__p+='\r\n                        <span class="mcGradeContainer heading incorrect">Incorrect</span>\r\n                    ',__p+='\r\n                    <div class="comment pull-right" style="margin-top:0;width:auto;">\r\n                        <div class="btnResetResponse" title="Allow student to revise their response" data-id="'+(null==(__t=n.QuestionTagResponseId)?"":__t)+'">Allow Revision</div>\r\n                    </div>\r\n                    <div class="text reset" style="padding:0;border:0;">\r\n                        Correct answer(s):<br />\r\n                        '+(null==(__t=cH.sanitize(question.CorrectAnswerText))?"":__t)+"\r\n                    </div>\r\n                "));__p+="\r\n        ",1===question.SubType&&n&&!n.IsDraft&&sCH.readerConfig.Settings.grading&&sCH.readerConfig.Settings.grading.AllowGradingTagging&&(__p+='\r\n            <div class="clearBoth" style="height: 0;"></div>\r\n            <div class="dropdown responseTagDropdown">\r\n                <a class="btn-tab btnAddGradingTag icon-tag"\r\n                    title="Add tag to response"\r\n                    role="button"\r\n                    data-toggle="dropdown"\r\n                    aria-haspopup="true"\r\n                    aria-expanded="false"\r\n                    data-placement="right"></a>\r\n                <ul class="dropdown-menu" aria-labelledby="btnAddGradingTag">\r\n                    ',_.each(fixedGradingTags,(function(e){__p+='\r\n                        <li><a data-tagname="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=cH.sanitize(e))?"":__t)+"</a></li>\r\n                    "})),__p+='\r\n                </ul>\r\n            </div>\r\n            <div class="tagList">\r\n                ',n.GradingTags&&_.each(n.GradingTags.split(","),(function(e){__p+='\r\n                        <div class="questionResponseGradingTag" data-tagname="'+(null==(__t=e)?"":__t)+'"><span>'+(null==(__t=cH.sanitize(e))?"":__t)+'</span><span class="close"></a></div>\r\n                    '})),__p+="\r\n            </div>\r\n        "),__p+='\r\n        <div class="clearBoth" style="height: 15px;"></div>\r\n    </div>\r\n'})),__p+="\r\n",isLastQues||(__p+='\r\n    <div class="btn-box showNext">Next question</div>\r\n'),__p+="";return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",_.each(questions,(function(e,t){__p+='\r\n    <div class="questionContainer '+(null==(__t=questionsNumC.find({QuestionTagId:e.TagId}).get("IsDoNotGrade")?"doNotGrade":"")?"":__t)+'">\r\n        <div class="question headerHighlight">\r\n            <span class="heading opaque">\r\n                <a class="linkQuestionNum infoLink" data-qnum="'+(null==(__t=e.Index+1)?"":__t)+'">question \r\n                    '+(null==(__t=e.Index+1)?"":__t)+"</a> ",print(3===e.SubType?'<span class="heading">(poll)</span>':""),__p+="\r\n            </span>\r\n            ",e.isRubricPresentForStandard?__p+='\r\n                <a class="heading btnRubric" data-standardid="'+(null==(__t=e.StandardId)?"":__t)+'">'+(null==(__t=e.StandardId?"Standard "+e.StandardCode:"")?"":__t)+"</a>\r\n            ":__p+='\r\n                <span class="heading" data-standardid="'+(null==(__t=e.StandardId)?"":__t)+'">'+(null==(__t=e.StandardId?"Standard "+e.StandardCode:"")?"":__t)+"</span>\r\n            ",__p+="\r\n            ",e.isRubricPresentForSecondStandard?__p+='\r\n                <a class="heading btnRubric" data-standardid="'+(null==(__t=e.SecondStandardId)?"":__t)+'">'+(null==(__t=e.SecondStandardId?e.SecondStandardCode:"")?"":__t)+"</a>\r\n            ":__p+='\r\n                <span class="heading" data-standardid="'+(null==(__t=e.SecondStandardId)?"":__t)+'">'+(null==(__t=e.SecondStandardId?e.SecondStandardCode:"")?"":__t)+"</span>\r\n            ",__p+="\r\n            ",!isOnFreePlan&&e.ModelResponse&&e.ModelResponse.length&&(__p+='\r\n                <a class="btnViewModelResponse heading infoLink" data-id="'+(null==(__t=e.TagId)?"":__t)+'">View '+(null==(__t=1===e.SubType?"model response":"explanation")?"":__t)+"</a>\r\n            "),__p+='    \r\n            <div class="text">\r\n                '+(null==(__t=cH.sanitize(e.Text))?"":__t)+'\r\n            </div>\r\n            <div class="clearBoth"></div>\r\n        </div>\r\n        ';var n=_.filter(responses,{QuestionTagId:e.TagId}),a=(n=n.sort((function(e,t){return e.IsReset===t.IsReset?e.AnswerDate>t.AnswerDate?1:-1:e.IsReset?-1:1}))).length>0&&n.slice(-1)[0],s=a&&"No response"!==a.Text&&!a.IsReset?moment(a.AnswerDate+"Z").format("MM/DD/YY h:mm a"):null;if(__p+='\r\n        <div class="response" data-userid="'+(null==(__t=a.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=e.TagId)?"":__t)+'">\r\n            <div class="nameAndDate" style="margin-bottom: -10px;">\r\n                ',s&&(__p+='\r\n                    <div class="heading datetime pull-left">\r\n                        '+(null==(__t=s)?"":__t)+"\r\n                    </div>\r\n                "),__p+="\r\n\r\n                ",sCH.readerConfig.Settings.AllowLikingPeerResponses&&!e.HasChoices&&a.VoteData&&a.VoteData.UpVotes&&(__p+='\r\n                    <div class="voting">\r\n                        <span class="thumbsup icon-thumbsup no-hover"></span>\r\n                        <span class="numup">'+(null==(__t=a.VoteData.UpVotes)?"":__t)+"</span>\r\n                    </div>\r\n                "),__p+='\r\n            </div>\r\n            <div class="responsesContainer '+(null==(__t=s?"":"noResponse")?"":__t)+'">\r\n                ',0===n.length?__p+='\r\n                    <div class="text disabled">Student has not responded.</div>\r\n                ':(_.each(n,(function(t){if(t.IsDraft)__p+='\r\n                            <div class="clearBoth"></div>\r\n                            <div class="text disabled">Student has not responded, but there is a saved draft (grading this question will delete\r\n                                the student\'s saved draft).</div>\r\n                        ';else{if(e.HasChoices&&"No response"!==t.Text){var n=[];_.each(t.Text.split(","),(function(t){n.push(_.filter(e.QuestionChoices,{QuestionChoiceId:parseInt(t)})[0].Text)})),n.length>1?t.Text='<ul class="multiSelectResponse">'+_.reduce(n,(function(e,t){return e+"<li>"+cH.sanitize(t)+"</li>"}),"")+"</ul>":t.Text=cH.sanitize(n[0])}t.IsReset?(__p+='\r\n                                <div class="text reset">\r\n                                    <div>\r\n                                        <span class="heading opaque">Previous response ('+(null==(__t=moment(t.AnswerDate+"Z").format("MM/DD/YY h:mm a"))?"":__t)+'): </span>\r\n                                        <div class="responseText">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(t.Text)))?"":__t)+"</div>\r\n                                            ",t.MediaUrl&&(__p+='\r\n                                                <div class="studentResponseMediaContainer embedMediaFullContainer" data-url="'+(null==(__t=cH.sanitize(t.MediaUrl))?"":__t)+'"></div>\r\n                                            '),__p+="\r\n                                            ",null!=t.Grade&&(__p+='\r\n                                                <span class="grade '+(null==(__t=cH.sanitize(grades[t.Grade].label).toLowerCase())?"":__t)+'">'+(null==(__t=e.HasChoices?0===t.Grade?"Incorrect":"Correct":cH.sanitize(grades[t.Grade].label))?"":__t)+"</span>\r\n                                            "),__p+="\r\n                                    </div>\r\n                                    ",t.TeacherComment&&(__p+='\r\n                                        <div class="resetcomment">\r\n                                            <span class="heading opaque">'+(null==(__t=window.ActivelyRead.currentUserId===t.GradedByUserId?"My comment:":cH.sanitize(t.TeacherName)+"'s comment:")?"":__t)+"</span>\r\n                                            "+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(t.TeacherComment)))?"":__t)+"\r\n                                        </div>\r\n                                    "),__p+="\r\n                                </div>\r\n                            "):(__p+="\r\n                                ",t.MediaUrl&&(__p+='\r\n                                    <div class="studentResponseMediaContainer embedMediaFullContainer" data-url="'+(null==(__t=cH.sanitize(t.MediaUrl))?"":__t)+'"></div>\r\n                                '),__p+='\r\n                                <div class="text">\r\n                                    '+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(t.Text)))?"":__t)+"\r\n                                </div>\r\n                            "),__p+="\r\n                        "}})),__p+="\r\n                "),__p+="\r\n            </div>\r\n            ",!a||a.IsReset){if(1===e.SubType){__p+='\r\n                    <ul class="grades" data-id="-1" data-userid="'+(null==(__t=student.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=e.TagId)?"":__t)+'">\r\n                        ';for(var i=0;i<5;i++)__p+='\r\n                            <li class="'+(null==(__t=grades[i].id)?"":__t)+'" data-grade="'+(null==(__t=i)?"":__t)+'">\r\n                                '+(null==(__t=cH.sanitize(grades[i].label))?"":__t)+"\r\n                            </li>\r\n                        ";__p+='\r\n                    </ul>\r\n                    <div class="comment'+(null==(__t=a?"":" noresponse")?"":__t)+'">\r\n                        <div contenteditable="true" placeholder="Click here to leave feedback for student..." data-id="-1" data-userid="'+(null==(__t=student.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=e.TagId)?"":__t)+'">'+(null==(__t=a&&a.TeacherComment?cH.sanitize(cH.wrapOldTextAreaContentInPTags(a.TeacherComment)):"")?"":__t)+"</div>\r\n                    </div>\r\n                "}}else if(1===e.SubType){__p+="\r\n                    ",a.IsDraft||(__p+="\r\n                        ",a.IsStudentRequestReset?__p+='\r\n                            <div class="reset btnResetResponse studentRequest"\r\n                                title="Allow student to revise their response"\r\n                                data-id="'+(null==(__t=a.QuestionTagResponseId)?"":__t)+'">Revision Requested</div>\r\n                        ':__p+='\r\n                            <div class="reset btnResetResponse"\r\n                                title="Allow student to revise their response"\r\n                                data-id="'+(null==(__t=a.QuestionTagResponseId)?"":__t)+'">Allow Revision</div>\r\n                        ',__p+="\r\n                    "),__p+='\r\n                    <ul class="grades" data-userid="'+(null==(__t=a.UserId)?"":__t)+'" data-id="'+(null==(__t=a.QuestionTagResponseId)?"":__t)+'" data-questiontagid="'+(null==(__t=e.TagId)?"":__t)+'">\r\n                        ';for(i=0;i<5;i++){var o=shouldShowAutoGradeStuff?getAutoGradingTooltip(a,i):"";__p+='\r\n                            <li class="'+(null==(__t=grades[i].id)?"":__t)+" ",print(a.Grade===i?"selected":""),__p+=" ",print(o?"autograded":""),__p+='"\r\n                                data-grade="'+(null==(__t=i)?"":__t)+'"\r\n                                title="'+(null==(__t=o)?"":__t)+'"\r\n                            >\r\n                                '+(null==(__t=cH.sanitize(grades[i].label))?"":__t)+"\r\n                            </li>\r\n                            "}__p+="\r\n                    </ul>\r\n                    ",a.IsDraft||(__p+='\r\n                        <div class="comment">\r\n                            <div contenteditable="true" placeholder="Click here to leave feedback for student..." data-id="'+(null==(__t=a.QuestionTagResponseId)?"":__t)+'" data-userid="'+(null==(__t=student.UserId)?"":__t)+'" data-questiontagid="'+(null==(__t=e.TagId)?"":__t)+'">'+(null==(__t=cH.sanitize(cH.wrapOldTextAreaContentInPTags(a.TeacherComment)))?"":__t)+"</div>\r\n                        </div>\r\n                    ")}else if(2===e.SubType)if(4===a.Grade)__p+='\r\n                        <span class="mcGradeContainer heading correct">Correct</span>\r\n                    ';else{var r=_.map(_.filter(e.QuestionChoices,{IsCorrect:!0}),"Text"),l=r.length>1?'<ul class="multiSelectResponse">'+_.reduce(r,(function(e,t){return e+"<li>"+cH.sanitize(t)+"</li>"}),"")+"</ul>":cH.sanitize(r[0]);__p+='\r\n                        <div class="comment">\r\n                            <div class="btnResetResponse" title="Allow student to revise their response" data-id="'+(null==(__t=a.QuestionTagResponseId)?"":__t)+'">Allow Revision</div>\r\n                        </div>\r\n                        ',"No response"===a.Text?__p+='\r\n                            <span class="heading">Unanswered</span>\r\n                        ':__p+='\r\n                            <span class="mcGradeContainer heading incorrect">Incorrect</span>\r\n                        ',__p+='\r\n                        <div class="text" style="font-size:15px;line-height:1.5;white-space:normal;color:rgba(0,0,0,0.54);width:368px;">\r\n                            Correct answer(s):<br />\r\n                            '+(null==(__t=l)?"":__t)+"\r\n                        </div>\r\n                    "}__p+="\r\n            ",1===e.SubType&&a&&!a.IsDraft&&sCH.readerConfig.Settings.grading&&sCH.readerConfig.Settings.grading.AllowGradingTagging&&(__p+='\r\n                <div class="clearBoth" style="height: 0;"></div>\r\n                <div class="dropdown responseTagDropdown">\r\n                    <a class="btn-tab btnAddGradingTag icon-tag"\r\n                        title="Add tag to response"\r\n                        role="button"\r\n                        data-toggle="dropdown"\r\n                        aria-haspopup="true"\r\n                        aria-expanded="false"\r\n                        data-placement="right"></a>\r\n                    <ul class="dropdown-menu" aria-labelledby="btnAddGradingTag">\r\n                        ',_.each(fixedGradingTags,(function(e){__p+='\r\n                            <li><a data-tagname="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=cH.sanitize(e))?"":__t)+"</a></li>\r\n                        "})),__p+='\r\n                    </ul>\r\n                </div>\r\n                <div class="tagList">\r\n                    ',a.GradingTags&&_.each(a.GradingTags.split(","),(function(e){__p+='\r\n                            <div class="questionResponseGradingTag" data-tagname="'+(null==(__t=e)?"":__t)+'"><span>'+(null==(__t=cH.sanitize(e))?"":__t)+'</span><span class="close"></a></div>\r\n                        '})),__p+="\r\n                </div>\r\n            "),__p+='\r\n            <div class="clearBoth" style="height: 15px;"></div>\r\n        </div>\r\n    </div>\r\n'})),__p+="";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(826),i=n(1816),o=n(69);t.default=Backbone.View.extend({initialize:function(e){this.reader=e.reader;var t=this;this.scroll=new i.default({reader:this.reader}),this.childViews=[this.scroll],this.dataM=new s.default,this.dataM.on("sync",(function(){t.preRender(!0)}),this),Backbone.pubEv.on("refreshAssignmentData",this.refreshReader,this),Backbone.pubEv.on("skipToSection",this.refreshReader,this)},preRender:function(e){e?this.render():sCH.userM.isOnFreePlan()?(this.scroll.$el.html(new o.default({text:"Monitor student progress, proficiency, and reading struggles in real time.",screenshotUrl:["/img/Assignments_AssignmentData.png"],showSampleBanner:!0,buttonOnNewLine:!0}).render().$el),a.intercom("trackEvent","paywall-dataview",{tab:"Reader - Assignment"})):this.dataM.fill(-1,sCH.readerConfig.assignmentId)},render:function(){this.scroll.subheader&&this.scroll.subheader.close(!1),$(".reader .subheader").removeClass("displayNone"),this.scroll.render({dataM:this.dataM})},refreshReader:function(){this.preRender(!1)},destroy:function(){Backbone.pubEv.off("refreshAssignmentData"),Backbone.pubEv.off("skipToSection",this.refreshReader,this)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(784),o=n(1817),r=n(54),l=n(827),d=n(821);t.default=Backbone.View.extend({el:"main.scroll .dataview",events:{"mouseenter .studentProgress":"enterStudentProgress","mouseleave .studentProgress":"leaveStudentProgress","click .questionRow":"skipToTag","click .discussionList":"skipToTag","click .showall":"showAll","click .btnViewAnswers":"switchToGradingView","click .viewNotes":"switchToNoteSummaryView","click .performance span":"openStudentQuestionView","click ul.banner.vocabList .dropdown-menu .label":"vocabClicked"},template:n(828),byAssignmentTemplate:n(1819),byStudentTemplate:n(1820),vocabLookupsTemplate:n(829),initialize:function(e){var t=this;this.reader=e.reader,Backbone.pubEv.on("exportAssignmentData",this.exportData,this),Backbone.pubEv.on("loadSection",(function(){"currentSection"===sCH.readerConfig.dataCurrentSectionMode&&t.toggleCurrentSection(sCH.readerConfig.dataCurrentSectionMode)}),this)},render:function(e){this.$el.html(this.template()),sCH.initAssignmentData(e.dataM.toJSON()),this.prepareData(),this.showByAssignment(),this.subheader=new l.default({reader:this.reader}),this.subheader.render()},switchToGradingView:function(e){$(".btnGradingView").click()},switchToNoteSummaryView:function(e){return new Backbone.BootstrapModal({title:"Notes summary",content:new d.default,cssClass:"modal-lg modal-al-note-summary",allowCancel:!0,showFooter:!1}),!1},showByStudent:function(e,t){var n=a.find(this.studentQuestionData,{studentId:e}),s=a.filter(this.studentReadingTimes,{studentId:e}),i=this.notesTakenData[e],o=this.discussionParticipationData[e],l=a.find(this.studentFlagData,{studentId:e}),d=a.find(this.studentResponsesLikedData,{studentId:e}),c=r.getWordLookupsByPosition(a.filter(this.vocabLookups,{StudentUserId:e})),u=this;if(i)if("currentSection"===sCH.readerConfig.dataCurrentSectionMode){var p=a.find(i.data,{textSectionId:sCH.readerConfig.currentSectionId});i=p?p.count:0}else i=a.reduce(i.data,(function(e,t){return e+t.count}),0);else i=0;if(o)if("currentSection"===sCH.readerConfig.dataCurrentSectionMode){p=a.find(o.data,{textSectionId:sCH.readerConfig.currentSectionId});o=p?p.count:0}else o=a.reduce(o.data,(function(e,t){return e+t.count}),0);else o=0;n&&("currentSection"===sCH.readerConfig.dataCurrentSectionMode?n=a.find(n.data,{textSectionId:sCH.readerConfig.currentSectionId}):(n.Responses=[],n.shortAnsCount=0,n.wordCountSum=0,a.each(n.data,(function(e){n.Responses=n.Responses.concat(e.Responses),n.shortAnsCount+=e.shortAnsCount,n.wordCountSum+=e.wordCountSum})))),l&&(l="currentSection"===sCH.readerConfig.dataCurrentSectionMode?a.filter(l.data,{textSectionId:sCH.readerConfig.currentSectionId}):l.data),s.length>0&&(s="currentSection"===sCH.readerConfig.dataCurrentSectionMode?a.filter(s,(function(e){return e.textSectionId===sCH.readerConfig.currentSectionId})):s,s=a.reduce(s,(function(e,t){return e+t.totalTime}),0)),d&&(d="currentSection"===sCH.readerConfig.dataCurrentSectionMode?a.filter(d.data,(function(e){return e.textSectionId===sCH.readerConfig.currentSectionId})):d.data,d=a.reduce(d,(function(e,t){return e+t.ResponseLiked}),0)),c.length>0&&"currentSection"===sCH.readerConfig.dataCurrentSectionMode&&(c=a.filter(c,(function(e){return e.TextSectionId===sCH.readerConfig.currentSectionId})));!function(){var t,r={UserId:e,Type:"note",IsAssociatedNote:!1},p="currentSection"===sCH.readerConfig.dataCurrentSectionMode?a.filter(sCH.teacherAssignmentData.questionResponseList,(function(e){return e.TextSectionId===sCH.readerConfig.currentSectionId})).length:u.totalQuestionCount;"currentSection"===sCH.readerConfig.dataCurrentSectionMode?(r.TextSectionId=sCH.readerConfig.currentSectionId,u.calculateClassAverages(sCH.readerConfig.currentSectionId,p),t=u.classAverages[sCH.readerConfig.currentSectionId]):t=u.classAverages[-1],i+=sCH.allStudentTagsC.filter(r).length;var h=c&&c.length?u.vocabLookupsTemplate({vocabLookups:c.sort((function(e,t){return t.lookupCount-e.lookupCount}))}):null;u.$el.find(".results").html(u.byStudentTemplate({studentQuestions:n,totalQuestionCount:p,readingTime:s,discussionParticipationCount:o,noteCount:i,flags:l,responsesLiked:d,classAverages:t,isPDF:sCH.readerConfig.isPDF,vocabLookupsTable:h}))}(),$(".btnExportOptions").hide()},showByAssignment:function(){var e,t,n,i,l,d,c,u=[],p=this,h=a.filter(this.assignmentQuestionData,{textSectionId:sCH.readerConfig.currentSectionId});i={shortAnswers:h.filter((function(e){return 1===e.subType})),mcqAnswers:h.filter((function(e){return 2===e.subType})),pollAnswers:h.filter((function(e){return 3===e.subType}))},n=a.filter(this.assignmentDiscussionData,{textSectionId:sCH.readerConfig.currentSectionId}),e=a.filter(this.studentReadingTimes,{textSectionId:sCH.readerConfig.currentSectionId}),l=r.getWordLookupsByPosition(a.filter(this.vocabLookups,{TextSectionId:sCH.readerConfig.currentSectionId})),t=a.filter(sCH.teacherAssignmentData.questionResponseList,(function(e){var t=sCH.questionsNumC.findWhere({QuestionTagId:e.QuestionTagId});return!!t&&(e.QuestionNum=t.get("QuestionNum"),e.TextSectionId===sCH.readerConfig.currentSectionId)})),d=a.find(this.studentTranslateData,{textSectionId:sCH.readerConfig.currentSectionId}),c=a.find(this.studentTTSData,{textSectionId:sCH.readerConfig.currentSectionId}),a.each(sCH.studentsC.models,(function(e){var t=p.studentQuestionData[e.get("UserId")],n="gray";if(t&&(t=t[sCH.readerConfig.currentSectionId]))if(0===t.Responses.length||a.every(t.Responses,(function(e){return null===e.grade})))n="gray";else{var s=t.Responses.filter((function(e){return 3!==e.subType}));if(s.length>0){var i=o.average(a.map(s,"grade"));n=i>=3?"green":i<=2?"red":"yellow"}}u.push({studentName:e.get("LastName")+", "+(e.get("FirstName")?e.get("FirstName")[0]:""),smallGroupName:e.get("SmallGroupName"),studentId:e.get("UserId"),questionsResponded:t?a.filter(t.Responses,{isNoResponse:!1}).length:0,performanceColor:n})})),u.sort((function(e,t){return e.studentName.localeCompare(t.studentName)})),n=this.sortDescending(n,"responseCount");var g=l&&l.length?this.vocabLookupsTemplate({vocabLookups:l.sort((function(e,t){return t.lookupCount-e.lookupCount}))}):null,f={studentData:this.prepareAssignmentDataObj({showBySectionId:sCH.readerConfig.currentSectionId,classProgress:u,studentReadingTimes:e,vocabLookups:this.vocabLookups,studentFlags:this.studentFlagData,notesTaken:this.notesTakenData,discussionParticipation:this.discussionParticipationData,translationLookups:d?d.data:null,ttsCalls:c?c.data:null}),studentQuestionData:this.studentQuestionData,totalQuestions:t,isPDF:sCH.readerConfig.isPDF,gradeNameMap:sCH.readerConfig.gradeNameMap,assignmentQuestions:i,assignmentDiscussions:n,flags:void 0,vocabLookupsTable:g,ttsCalls:c,textSectionId:sCH.readerConfig.currentSectionId,isMediaReader:sCH.readerConfig.isMedia};this.$el.find(".results").html(this.byAssignmentTemplate(f)),$(".btnExportOptions").show(),s.initTooltips($(".dataview"),null,":not(.dropdown-toggle)")},prepareAssignmentDataObj:function(e){var t=[],n={totalReadingTime:0,totalNotes:0,totalNoteReplies:0,totalVocabs:0,totalTranslations:0,totalTTS:0,totalQuestionsResponded:0};a.each(e.classProgress,(function(i){var o=a.filter(e.studentReadingTimes,{studentId:i.studentId}),r=0;a.each(o,(function(e){r+=e.totalTime}));var l=a.filter(e.vocabLookups,{StudentUserId:i.studentId}),d=0;if(l.length>0){var c=e.showBySectionId?a.filter(l,{TextSectionId:e.showBySectionId}):l;d=a.reduce(c,(function(e,t){return e+t.LookupCountForPosition}),0)}var u=e.notesTaken[i.studentId],p=0;if(u)if(e.showBySectionId){var h=a.find(u.data,{textSectionId:e.showBySectionId});h&&(p=h.count)}else p=a.reduce(u.data,(function(e,t){return e+t.count}),0);var g=0,f=a.find(e.translationLookups,{studentId:i.studentId});f&&(g+=f.lookupCount);var m=0,v=a.find(e.ttsCalls,{studentId:i.studentId});v&&(m+=v.lookupCount),t.push({studentName:s.sanitize(i.studentName),smallGroupName:i.smallGroupName,readingTimeStr:s.getFormattedTime(r,!0),vocabCount:d,notesCount:p,translateCount:g,ttsCount:m,performanceColor:i.performanceColor,studentId:i.studentId,questionsResponded:i.questionsResponded}),n.totalReadingTime+=r,n.totalNotes+=p,n.totalVocabs+=d,n.totalQuestionsResponded+=i.questionsResponded,n.totalTranslations+=g,n.totalTTS+=m}));var i=e.classProgress.length;return t.length>0&&t.unshift({studentName:"CLASS AVERAGE",readingTimeStr:s.getFormattedTime(Math.ceil(n.totalReadingTime/i),!0),vocabCount:Math.round(n.totalVocabs/i),notesCount:Math.round(n.totalNotes/i),translateCount:Math.round(n.totalTranslations/i),ttsCount:Math.round(n.totalTTS/i),performanceColor:"gray",questionsResponded:Math.round(n.totalQuestionsResponded/i)}),t},toggleCurrentSection:function(e){sCH.readerConfig.dataCurrentSectionMode=e,$(".dataview .ddlStudents").val()>0?this.showByStudent(parseInt($(".dataview .ddlStudents").val()),!0):this.showByAssignment()},openStudentQuestionView:function(e){var t=parseInt($(e.currentTarget).data("studentid"));t&&(sCH.readerConfig.selectedStudentUserId=t,$(".textview .btnGradingView").click())},exportData:function(e){var t=moment(),n=sCH.learnEntityMetaM.get("Title")+"_"+t.format("MM/DD/YY");if("questions"===e.reportType){var a=this.generateQuestionsDataCsv();i.exportCSV(a,n+" - Question grades","Question grades")}else i.exportTableToCSV(this.$el.find(".classProgressTable"),n+" - Student overview","Student overview")},generateQuestionsDataCsv:function(){var e=this,t=a.filter(sCH.teacherAssignmentData.questionResponseList,(function(e){return e.TextSectionId===sCH.readerConfig.currentSectionId})),n="",s="Name,";return a.each(t,(function(e){s+="Question "+e.QuestionNum+","})),n+=s+"Average\n",a.each(sCH.studentsC.models,(function(s){var i=e.studentQuestionData[s.get("UserId")],r=[];if(n+='"'+s.get("LastName")+", "+s.get("FirstName")+'"',i&&((i=i[sCH.readerConfig.currentSectionId])&&a.each(t,(function(e){var t=a.find(i.Responses,{questionTagId:e.QuestionTagId});n+=",",3===e.SubType?n+=t?"N/A":"":t&&(t.points||0===t.points)&&(n+=t.points.toFixed(1),r.push(t.points))})),r.length)){var l=o.average(r);n+=","+l.toFixed(1)}n+="\n"})),n+="\n\n\n\n"},sortDescending:function(e,t){return e.sort((function(e,n){return e[t]<n[t]?1:n[t]<e[t]?-1:0})),e},enterStudentProgress:function(e){var t=$(e.currentTarget),n=t.data("studentname"),a=t.data("percent");this.$el.find(".hoverLabel .name").html(n),this.$el.find(".hoverLabel .percentage").html(a+"%"),this.$el.find(".hoverLabel").show()},leaveStudentProgress:function(e){this.$el.find(".hoverLabel").hide()},skipToTag:function(e){var t=$(e.currentTarget),n={sectionId:t.data("textsectionid"),tagId:t.data("tagid"),tagType:t.data("type"),openTag:!0};s.onDevice()&&$(".header .textview .left.btnDataView").click(),void 0!==n.sectionId&&Backbone.pubEv.trigger("skipToTag",n)},vocabClicked:function(e){s.handleVocabClick(e)},showAll:function(e){$(e.currentTarget).parent().find(".paged").toggleClass("showing"),"Show all"===$(e.currentTarget).text()?$(e.currentTarget).text("Show less"):$(e.currentTarget).text("Show all")},prepareData:function(){this.assignmentQuestionData=[],this.assignmentDiscussionData=[],this.studentQuestionData=[],this.studentDiscussionData=[],this.studentResponseData=[],this.studentReadingTimes=[],this.studentFlagData=[],this.studentResponsesLikedData=[],this.studentTranslateData=[],this.studentTTSData=[],this.classProgress=[],this.totalQuestionCount=sCH.teacherAssignmentData.questionResponseList.length,this.flagData=[],this.classAverages={},this.vocabLookups=sCH.teacherAssignmentData.vocabLookups;var e=this;a.each(sCH.teacherAssignmentData.questionResponseList,(function(t,n){var s=sCH.questionsNumC.findWhere({QuestionTagId:t.QuestionTagId});if(s){var i={questionNum:s.get("QuestionNum"),questionTagId:t.QuestionTagId,subType:t.SubType,textSectionId:t.TextSectionId,isDotNotGrade:s.get("IsDoNotGrade"),standardId:t.StandardId,dok:t.DoK},o=0,r=0,l=0,d={0:0,1:0,2:0,3:0,4:0},c=0,u=0;a.each(t.Responses,(function(n){var a=e.studentQuestionData[n.UserId],s=n.Answertext?n.Answertext.replace(/\s+/g," ").replace(/(\r\n|\n|\r)/gm," ").split(" ").length:0;if(a){var i=a[t.TextSectionId];i||(i={Responses:[],wordCountSum:0,shortAnsCount:0,proficientAnswersCount:0},a[t.TextSectionId]=i),i.Responses.push({questionNum:t.QuestionNum,questionTagId:t.QuestionTagId,textSectionId:t.TextSectionId,subType:t.SubType,isNoResponse:n.IsNoResponse,grade:n.Grade,points:n.Points}),1!==t.SubType||n.IsNoResponse||(i.wordCountSum+=s,i.shortAnsCount++),n.Grade&&n.Grade>=2&&i.proficientAnswersCount++}else{var p={Responses:[{questionNum:t.QuestionNum,questionTagId:t.QuestionTagId,textSectionId:t.TextSectionId,subType:t.SubType,isNoResponse:n.IsNoResponse,grade:n.Grade,points:n.Points}]};(a={})[t.TextSectionId]=p,1===t.SubType?(p.wordCountSum=n.IsNoResponse?0:s,p.shortAnsCount=n.IsNoResponse?0:1):(p.wordCountSum=0,p.shortAnsCount=0),n.Grade&&n.Grade>=2?p.proficientAnswersCount=1:p.proficientAnswersCount=0,e.studentQuestionData[n.UserId]=a}null!=n.Grade&&(o+=n.Grade,r++,c+=n.Grade<=2?1:0,u+=n.Grade>=3?1:0,d[n.Grade]++),l++})),i.gradeAvg=o/r,i.gradeCount=r,i.responseCount=l,i.belowAverageCount=c,i.aboveAverageCount=u,i.gradeCountBreakdown=d;var p=a.max(i.gradeCountBreakdown)===a.min(i.gradeCountBreakdown);i.countToHighlight=p?null:a.max(i.gradeCountBreakdown),e.assignmentQuestionData.push(i)}})),e.discussionParticipationData={},e.notesTakenData={};var t=sCH.readerSettingsM.get("CurrentUserId");a.each(sCH.teacherAssignmentData.discussionData,(function(n,s){if(n.UserId!=t){var i=e.notesTakenData[n.UserId];if(i){var o=a.find(i.data,{textSectionId:n.TextSectionId});o?o.count++:i.data.push({textSectionId:n.TextSectionId,count:1})}else e.notesTakenData[n.UserId]={data:[{textSectionId:n.TextSectionId,count:1}]}}a.each(n.Responses,(function(s){if(s.UserId!=t)if(e.discussionParticipationData[s.UserId]){var i=a.find(e.discussionParticipationData[s.UserId].data,{textSectionId:n.TextSectionId});i?i.count++:e.discussionParticipationData[s.UserId].data.push({textSectionId:n.TextSectionId,count:1})}else e.discussionParticipationData[s.UserId]={data:[{textSectionId:n.TextSectionId,count:1}]}}));var r=n.CreatorName,l="teacher"===n.Role?"teacher":r?r.charAt(0).toLowerCase():"",d=[];a.each(n.Responses,(function(t,s){-1===a.indexOf(d,t.ResponderName)&&t.UserId!==n.UserId&&d.push(t.ResponderName);var i=a.find(e.studentDiscussionData,{studentId:t.UserId});i?i.Responses?i.Responses.count++:i.Responses={count:1}:(i={studentId:n.UserId,Discussions:[],Responses:{count:1}},e.studentDiscussionData.push(i));var o=a.filter(e.studentResponseData,{studentId:t.UserId});o.length?o[0].count++:(o={studentId:t.UserId,count:1},e.studentResponseData.push(o))}));var c=a.find(e.studentDiscussionData,{studentId:n.UserId}),u=sCH.learnEntitySectionsMetaC.find({TextSectionId:n.TextSectionId}),p=1===sCH.learnEntitySectionsMetaC.validSectionLength?"Entire text":u.get("Title")?u.get("Title"):(sCH.isPDF?"Page ":"Section ")+u.get("SectionNum");c?c.Discussions.push({sectionTitle:p,tagId:n.NoteTagId,role:n.Role,textSectionId:n.TextSectionId,createdBy:'<span class="colorName initial_'+l+'">'+r+"</span>",responderCount:d.length,responseCount:n.Responses.length}):(c={studentId:n.UserId,Discussions:[{sectionTitle:p,tagId:n.NoteTagId,role:n.Role,textSectionId:n.TextSectionId,createdBy:'<span class="colorName initial_'+l+'">'+r+"</span>",responseCount:n.Responses.length,responderCount:d.length}]},e.studentDiscussionData.push(c)),e.assignmentDiscussionData.push({sectionTitle:p,createdBy:'<span class="colorName initial_'+l+'">'+r+"</span>",tagId:n.NoteTagId,role:n.Role,textSectionId:n.TextSectionId,responseCount:n.Responses.length,responderCount:d.length})})),a.each(sCH.teacherAssignmentData.readingTimes,(function(t){e.studentReadingTimes.push({studentId:t.UserId,totalTime:t.TotalTime,textSectionId:t.TextSectionId})})),a.each(sCH.teacherAssignmentData.responseLikedList,(function(t){var n=a.find(e.studentResponsesLikedData,{studentId:t.UserId});if(n){var s=a.find(n.data,{textSectionId:t.TextSectionId});s?(s.ResponseLiked++,s.VoteCount+=t.VoteCount):n.data.push({textSectionId:t.TextSectionId,ResponseLiked:1,VoteCount:t.VoteCount})}else n={studentId:t.UserId,data:[{textSectionId:t.TextSectionId,ResponseLiked:1,VoteCount:t.VoteCount}]},e.studentResponsesLikedData.push(n)})),a.each(sCH.teacherAssignmentData.translationLookups,(function(t){var n=a.find(e.studentTranslateData,{textSectionId:t.TextSectionId});if(n){var s=a.find(n.data,{studentId:t.StudentUserId});s?s.lookupCount+=t.LookupCount:n.data.push({studentId:t.StudentUserId,lookupCount:t.LookupCount})}else n={textSectionId:t.TextSectionId,data:[{studentId:t.StudentUserId,lookupCount:t.LookupCount}]},e.studentTranslateData.push(n)})),a.each(sCH.teacherAssignmentData.textToSpeechCalls,(function(t){var n=a.find(e.studentTTSData,{textSectionId:t.TextSectionId});if(n){var s=a.find(n.data,{studentId:t.StudentUserId});s?s.lookupCount+=t.LookupCount:n.data.push({studentId:t.StudentUserId,lookupCount:t.LookupCount})}else n={textSectionId:t.TextSectionId,data:[{studentId:t.StudentUserId,lookupCount:t.LookupCount}]},e.studentTTSData.push(n)})),this.calculateClassAverages(-1,this.totalQuestionCount)},calculateClassAverages:function(e,t){var n=0,s=sCH.studentsC.length,i=0,r=0,l=0,d=0,c=0,u=0,p=0,h=[];if(e=e||-1,!this.classAverages[e]){for(var g in this.classAverages[e]={},this.studentQuestionData){var f;e>0&&(f=(f=this.studentQuestionData[e])?[f]:[]),a.each(f,(function(e){n+=a.filter(e.Responses,{isNoResponse:!1}).length,d+=e.wordCountSum,p+=e.shortAnsCount,h.push(100*e.proficientAnswersCount/e.Responses.length)}))}this.classAverages[e].questionsAnswered=Math.floor(n/s),this.classAverages[e].overallProgress=Math.floor(100*n/t/s),this.classAverages[e].avgWordResponses=Math.floor(d/p),this.classAverages[e].proficientAnswersAvg=Math.floor(o.average(h));var m=-1===e?this.studentReadingTimes:a.filter(this.studentReadingTimes,{textSectionId:e});a.each(m,(function(e){i+=e.totalTime})),this.classAverages[e].readingTime=Math.floor(i/s),a.each(this.notesTakenData,(function(t){a.each(t.data,(function(t){r+=-1===e||t.textSectionId===e?t.count:0}))})),this.classAverages[e].notesEntered=Math.floor(r/s),a.each(this.discussionParticipationData,(function(t){a.each(t.data,(function(t){l+=-1===e||t.textSectionId===e?t.count:0}))})),this.classAverages[e].discussionParticipation=Math.floor(l/s),a.each(this.studentFlagData,(function(t){a.each(t.data,(function(t){c+=-1===e||t.textSectionId===e?t.count:0}))})),this.classAverages[e].diffFlags=Math.floor(c/s),a.each(this.studentResponsesLikedData,(function(t){a.each(t.data,(function(t){u+=-1===e||t.textSectionId===e?t.ResponseLiked:0}))})),this.classAverages[e].responsesLiked=Math.floor(u/n)}},destroy:function(){Backbone.pubEv.off("exportAssignmentData"),this.subheader&&this.subheader.destroy()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8);t.calculateMeanAndStandardVariance=function(e){var t=0,n=0,s=0,i=0,o=0;a.each(e,(function(e){t++,i=o+(e-n)*(e-(s=n+(e-n)/t)),n=s,o=i}));var r=t>1?i/(t-1):0;return{mean:s,standardVariance:Math.sqrt(r)}},t.average=function(e){var t=0,n=0;return e=a.filter(e,(function(e){return null!==e})),a.each(e,(function(e){t+=e,n++})),0===n?0:t/n},t.distance=function(e,t,n,a){return Math.sqrt(Math.pow(e-t,2)+Math.pow(n-a,2))}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","student"!==userRole?(__p+="\r\n<h2>Assignment Data\r\n    ",sectionTitleForMultiSection&&(__p+='\r\n    <span title="'+(null==(__t=sectionTitleForMultiSection)?"":__t)+'">\r\n        (Section - '+(null==(__t=cH.truncate(sectionTitleForMultiSection,40))?"":__t)+")\r\n    </span>\r\n    "),__p+="\r\n</h2>\r\n"):__p+="\r\n<h2>My Data</h2>\r\n",__p+='\r\n<a class="icon-refresh btnRefresh" title="Refresh"></a>\r\n\r\n',"student"!==userRole&&(__p+='\r\n<div class="dropdown exportsDropdown">\r\n    <a class="icon-export btnExportOptions" title="Export to CSV" role="button" data-toggle="dropdown"\r\n        aria-haspopup="true" aria-expanded="false"></a>\r\n    <ul class="dropdown-menu dropdown-menu-right exportOptions" aria-labelledby="btnExportOptions">\r\n        ',sCH.readerConfig.isMedia||(__p+='\r\n        <li><a class="btnStudentOverviewExport" data-reporttype="overview">Student overview</a></li>\r\n        '),__p+='\r\n        <li><a class="btnQuestionGradeExport" data-reporttype="questions">Question grades</a></li>\r\n    </ul>\r\n</div>\r\n'),__p+='\r\n\r\n<form class="exportDataForm" method="POST"></form>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="section">\r\n    <div class="progressContainer">\r\n        <table class="classProgressTable" cellspacing="0">\r\n            <thead>\r\n                <tr>\r\n                    <th class="nameCol">Name</th>\r\n                    <th class="timeCol numberDataCol">\r\n                        <span title="Total reading time thus far">Time</span>\r\n                    </th>\r\n                    ',isMediaReader||(__p+='\r\n                    <th class="notesCol numberDataCol">\r\n                        <span title="Number of notes taken">Notes</span>\r\n                    </th>\r\n                    <th class="vocabCol numberDataCol">\r\n                        <span title="Number of vocab lookups">Vocab</span>\r\n                    </th>\r\n                    <th class="translateCol numberDataCol">\r\n                        <span title="Number of translations">Translate</span>\r\n                    </th>\r\n                    <th class="ttsCol numberDataCol">\r\n                        <span title="Number of text-to-speech">TTS</span>\r\n                    </th>\r\n                    '),__p+="\r\n                    ",0===totalQuestions.length?__p+="\r\n                    <th>No Questions</th>\r\n                    ":_.each(totalQuestions,(function(e){__p+='\r\n                    <th class="questionNumCol">\r\n                        <span title="'+(null==(__t=e.StandardId?cH.getStandardById(e.StandardId).StandardCode:"")?"":__t)+'">\r\n                            '+(null==(__t="Q"+e.QuestionNum)?"":__t)+"\r\n                        </span>\r\n                    </th>\r\n                    "})),__p+="\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                ",studentData.length>0?_.each(studentData,(function(e){if(__p+='\r\n                <tr class="'+(null==(__t=e.studentId?"":"classAverage")?"":__t)+'">\r\n                    <td class="performance left '+(null==(__t=e.performanceColor)?"":__t)+'">\r\n                        <span '+(null==(__t=e.studentId?'data-studentid="'+e.studentId+'"':"")?"":__t)+">\r\n                            "+(null==(__t=cH.sanitize(e.studentName))?"":__t)+"\r\n                        </span>\r\n                        ",e.smallGroupName&&(__p+='\r\n                        <span class="smallGroupName">('+(null==(__t=e.smallGroupName)?"":__t)+")</span>\r\n                        "),__p+='\r\n                    </td>\r\n                    <td class="readingTime">\r\n                        <span>\r\n                            '+(null==(__t=e.readingTimeStr)?"":__t)+"\r\n                        </span>\r\n                    </td>\r\n                    ",isMediaReader||(__p+='\r\n                    <td class="number">\r\n                        ',0===e.notesCount?__p+='\r\n                        <span class="empty"></span>\r\n                        ':__p+="\r\n                        <span>\r\n                            "+(null==(__t=e.notesCount)?"":__t)+"\r\n                        </span>\r\n                        ",__p+='\r\n                    </td>\r\n                    <td class="number">\r\n                        ',0===e.vocabCount?__p+='\r\n                        <span class="empty"></span>\r\n                        ':__p+="\r\n                        <span>\r\n                            "+(null==(__t=e.vocabCount)?"":__t)+"\r\n                        </span>\r\n                        ",__p+='\r\n                    </td>\r\n                    <td class="number">\r\n                        ',0===e.translateCount?__p+='\r\n                        <span class="empty"></span>\r\n                        ':__p+="\r\n                        <span>\r\n                            "+(null==(__t=e.translateCount)?"":__t)+"\r\n                        </span>\r\n                        ",__p+='\r\n                    </td>\r\n                    <td class="number">\r\n                        ',0===e.ttsCount?__p+='\r\n                        <span class="empty"></span>\r\n                        ':__p+="\r\n                        <span>\r\n                            "+(null==(__t=e.ttsCount)?"":__t)+"\r\n                        </span>\r\n                        ",__p+="\r\n                    </td>\r\n                    "),__p+="\r\n                    ",totalQuestions.length){var t=studentQuestionData[e.studentId],n=t?t[textSectionId]:null;_.each(totalQuestions,(function(e){var t=n?_.find(n.Responses,{questionTagId:e.QuestionTagId}):null,a=t?"grade-cell-"+t.grade:"empty",s="questionSubType"+e.SubType;__p+='\r\n                    <td class="questionNumCol gradeCell '+(null==(__t=a)?"":__t)+" "+(null==(__t=s)?"":__t)+'"\r\n                        '+(null==(__t=t?'data-formattedexporttext="'+(3===e.SubType?t?"N/A":"":t.grade)+'"':"")?"":__t)+">\r\n                    </td>\r\n                    "}))}else __p+="\r\n                    <td></td>\r\n                    ";__p+="\r\n                </tr>\r\n                "})):__p+='\r\n                <td class="classAverage" colspan="6">\r\n                    <ul class="banner">\r\n                        <li class="message">No students in the class!</li>\r\n                    </ul>\r\n                </td>\r\n                ',__p+='\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n    <div class="clearBoth" style="height:10px;"></div>\r\n</div>\r\n\r\n<div class="section shortAnswersTableSection">\r\n    ',assignmentQuestions.shortAnswers.length>0&&(__p+='\r\n    <table class="questionList sa">\r\n        <thead>\r\n            <tr>\r\n                <th class="gradeHeader '+(null==(__t=bowser.mobile?"":"questionTypeTitle")?"":__t)+'">\r\n                    '+(null==(__t=bowser.mobile?"Short A.":"Short answers")?"":__t)+'\r\n                </th>\r\n                <th class="gradeHeader zero">\r\n                    <span title="# of responses graded '+(null==(__t=cH.sanitize(gradeNameMap[0].label))?"":__t)+'">\r\n                        '+(null==(__t=cH.sanitize(gradeNameMap[0].label).substring(0,12)+(cH.sanitize(gradeNameMap[0].label).length>12?"..":""))?"":__t)+'\r\n                    </span>\r\n                </th>\r\n                <th class="gradeHeader incomplete">\r\n                    <span title="# of responses graded '+(null==(__t=cH.sanitize(gradeNameMap[1].label))?"":__t)+'">\r\n                        '+(null==(__t=cH.sanitize(gradeNameMap[1].label).substring(0,12)+(cH.sanitize(gradeNameMap[1].label).length>12?"..":""))?"":__t)+'\r\n                    </span>\r\n                </th>\r\n                <th class="gradeHeader basic">\r\n                    <span title="# of responses graded '+(null==(__t=cH.sanitize(gradeNameMap[2].label))?"":__t)+'">\r\n                        '+(null==(__t=cH.sanitize(gradeNameMap[2].label).substring(0,12)+(cH.sanitize(gradeNameMap[2].label).length>12?"..":""))?"":__t)+'\r\n                    </span>\r\n                </th>\r\n                <th class="gradeHeader proficient">\r\n                    <span title="# of responses graded '+(null==(__t=cH.sanitize(gradeNameMap[3].label))?"":__t)+'">\r\n                        '+(null==(__t=cH.sanitize(gradeNameMap[3].label).substring(0,12)+(cH.sanitize(gradeNameMap[3].label).length>12?"..":""))?"":__t)+'\r\n                    </span>\r\n                </th>\r\n                <th class="gradeHeader advanced">\r\n                    <span title="# of responses graded '+(null==(__t=cH.sanitize(gradeNameMap[4].label))?"":__t)+'">\r\n                        '+(null==(__t=cH.sanitize(gradeNameMap[4].label).substring(0,12)+(cH.sanitize(gradeNameMap[4].label).length>12?"..":""))?"":__t)+"\r\n                    </span>\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ",_.each(assignmentQuestions.shortAnswers,(function(e,t){var n=_.find(alcfg.tags.question.dok,{id:e.dok}),a=cH.getStandardById(e.standardId),s=n?"DoK: "+n.text:"";s+=(s?". ":"")+("N/A"!==a.StandardCode?a.StandardCode:""),__p+='\r\n            <tr class="questionRow" data-tagid="'+(null==(__t=e.questionTagId)?"":__t)+'" data-type="question"\r\n                data-textSectionId="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                ',e.isDotNotGrade?__p+='\r\n                <td class="label questionListColumn" data-tagid="'+(null==(__t=e.questionTagId)?"":__t)+'" data-type="question"\r\n                    data-textSectionId="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                    <div class="questionLabel" title="'+(null==(__t=cH.sanitize(s))?"":__t)+'" data-placement="right">\r\n                        #'+(null==(__t=e.questionNum)?"":__t)+"\r\n                        "+(null==(__t=bowser.mobile?"":'&nbsp;&nbsp;<span class="ungraded">(not grading)</span>')?"":__t)+'\r\n                    </div>\r\n                </td>\r\n                <td class="avgGrade boldRight mergedCenterAligned questionListColumn" colspan="5">\r\n                    <span class="na">not applicable</span>\r\n                </td>\r\n                ':__p+='\r\n                <td class="label questionListColumn" data-tagid="'+(null==(__t=e.questionTagId)?"":__t)+'" data-type="question"\r\n                    data-textSectionId="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                    <div class="questionLabel" title="'+(null==(__t=cH.sanitize(s))?"":__t)+'" data-placement="right">#\r\n                        '+(null==(__t=e.questionNum)?"":__t)+"\r\n                        "+(null==(__t=bowser.mobile?"":'&nbsp;&nbsp;<span class="ungraded">'+(e.responseCount-e.gradeCount)+" ungraded</span>")?"":__t)+'\r\n                    </div>\r\n                </td>\r\n                <td\r\n                    class="questionListColumn sa avgGrade boldRight right zero belowAvg '+(null==(__t=e.countToHighlight===e.gradeCountBreakdown[0]?"highlight":"")?"":__t)+'">\r\n                    '+(null==(__t=e.gradeCountBreakdown[0]||"")?"":__t)+'\r\n                </td>\r\n                <td\r\n                    class="questionListColumn sa avgGrade boldRight right incomplete belowAvg '+(null==(__t=e.countToHighlight===e.gradeCountBreakdown[1]?"highlight":"")?"":__t)+'">\r\n                    '+(null==(__t=e.gradeCountBreakdown[1]||"")?"":__t)+'\r\n                </td>\r\n                <td\r\n                    class="questionListColumn sa avgGrade boldRight right basic belowAvg '+(null==(__t=e.countToHighlight===e.gradeCountBreakdown[2]?"highlight":"")?"":__t)+'">\r\n                    '+(null==(__t=e.gradeCountBreakdown[2]||"")?"":__t)+'\r\n                </td>\r\n                <td\r\n                    class="questionListColumn sa avgGrade boldRight right proficient aboveAvg '+(null==(__t=e.countToHighlight===e.gradeCountBreakdown[3]?"highlight":"")?"":__t)+'">\r\n                    '+(null==(__t=e.gradeCountBreakdown[3]||"")?"":__t)+'\r\n                </td>\r\n                <td\r\n                    class="questionListColumn sa avgGrade boldRight right advanced aboveAvg '+(null==(__t=e.countToHighlight===e.gradeCountBreakdown[4]?"highlight":"")?"":__t)+'">\r\n                    '+(null==(__t=e.gradeCountBreakdown[4]||"")?"":__t)+"\r\n                </td>\r\n                ",__p+="\r\n            </tr>\r\n            "})),__p+="\r\n        </tbody>\r\n    </table>\r\n    "),__p+='\r\n</div>\r\n\r\n<div class="section">\r\n    ',assignmentQuestions.mcqAnswers.length>0&&(__p+='\r\n    <table class="questionList mcq">\r\n        <thead>\r\n            <tr>\r\n                <th class="gradeHeader '+(null==(__t=bowser.mobile?"":"questionTypeTitle")?"":__t)+'">\r\n                    '+(null==(__t=bowser.mobile?"Multiple Choice A.":"Multiple choice answers")?"":__t)+'\r\n                </th>\r\n                <th class="gradeHeader zero" title="% of correct responses">\r\n                    Correct\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ',_.each(assignmentQuestions.mcqAnswers,(function(e,t){var n=_.find(alcfg.tags.question.dok,{id:e.dok}),a=cH.getStandardById(e.standardId),s=n?"DoK: "+n.text:"";s+=(s?". ":"")+("N/A"!==a.StandardCode?a.StandardCode:""),__p+='\r\n            <tr class="questionRow" data-tagid="'+(null==(__t=e.questionTagId)?"":__t)+'" data-type="question"\r\n                data-textSectionId="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                <td class="label questionListColumn " data-tagid="'+(null==(__t=e.questionTagId)?"":__t)+'" data-type="question"\r\n                    data-textSectionId="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                    <div class="questionLabel" title="'+(null==(__t=cH.sanitize(s))?"":__t)+'" data-placement="right">\r\n                        ';const i=bowser.mobile?"":e.isDotNotGrade?"(not grading)":"(mcq)";if(__p+="\r\n                        #"+(null==(__t=e.questionNum)?"":__t)+'\r\n                        <span class="ungraded">'+(null==(__t=i)?"":__t)+'</span>\r\n                    </div>\r\n                </td>\r\n                <td class="questionListColumn mcq boldRight">\r\n                    ',e.isDotNotGrade)__p+='\r\n                    <span class="na">N/A</span>\r\n                    ';else{__p+="\r\n                    ";var o=e.gradeCountBreakdown[4]||0,r=o+(e.gradeCountBreakdown[0]||0);__p+="\r\n                    "+(null==(__t=e.isDotNotGrade?"N/A":o+"/"+r+(0===r?"":" ("+parseInt(o/r*100)+"%)"))?"":__t)+"\r\n                    "}__p+="\r\n                </td>\r\n            </tr>\r\n            "})),__p+="\r\n        </tbody>\r\n    </table>\r\n    "),__p+="\r\n</div>\r\n\r\n",!isMediaReader){__p+='\r\n<div class="section">\r\n    <ul class="sectionHeading">\r\n        <li class="label">\r\n            <h3>Vocabulary Lookups</h3>\r\n        </li>\r\n    </ul>\r\n    ',vocabLookupsTable?__p+='\r\n    <div class="vocabLookups">\r\n        '+(null==(__t=vocabLookupsTable)?"":__t)+"\r\n    </div>\r\n    ":__p+='\r\n    <div>\r\n        <ul class="banner">\r\n            <li class="message">No vocab lookups</li>\r\n        </ul>\r\n    </div>\r\n    ',__p+='\r\n</div>\r\n\r\n<div class="section">\r\n    ';var discussionsExist=!1;if(assignmentDiscussions.length&&_.each(assignmentDiscussions,(function(e){e.responseCount>0&&(discussionsExist=!0)})),__p+='\r\n    <ul class="sectionHeading">\r\n        <li class="label">\r\n            <h3>Discussions</h3>\r\n        </li>\r\n    </ul>\r\n    ',assignmentDiscussions.length){var counter=1;__p+='\r\n    <div class="discussions">\r\n        ',_.each(assignmentDiscussions,(function(e){e.responseCount>0&&(counter++,__p+='\r\n        <ul class="discussionList banner '+(null==(__t=counter>14?"paged":"")?"":__t)+'" data-tagid="'+(null==(__t=e.tagId)?"":__t)+'"\r\n            data-type="note" data-textsectionid="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n            <li class="studentList '+(null==(__t="Entire text"===e.sectionTitle?"alignLeft":"")?"":__t)+'">\r\n                <span>'+(null==(__t=e.createdBy)?"":__t)+'</span>\r\n                <span style="font-size: 23px;">'+(null==(__t=e.responderCount>0?"+"+e.responderCount:"")?"":__t)+"</span>\r\n            </li>\r\n        </ul>\r\n        ")})),__p+="\r\n        ",counter>14?__p+='\r\n        <a class="btn-box showall">Show all</a>\r\n        ':1===counter&&(__p+='\r\n        <ul class="banner">\r\n            <li class="message">No discussions</li>\r\n        </ul>\r\n        '),__p+="\r\n    </div>\r\n    "}else __p+='\r\n    <div>\r\n        <ul class="banner">\r\n            <li class="message">No discussions</li>\r\n        </ul>\r\n    </div>\r\n    ';__p+="\r\n</div>\r\n"}__p+=""}return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="section">\r\n    <ul class="sectionHeading"><li class="label"><h2>Student Progress</h2></li><li class="right">Class (avg)</li><li class="right">Student</li></ul>\r\n    <ul class="studentBanner"><li class="label">Overall question progress</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.overallProgress?classAverages.overallProgress+"%":0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=studentQuestions?cH.percent(_.filter(studentQuestions.Responses,{isNoResponse:!1}).length/totalQuestionCount):0)?"":__t)+'</li></ul>\r\n    <ul class="studentBanner"><li class="label">Reading time (h:mm)</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.readingTime?Math.floor(classAverages.readingTime/3660)+":"+("0"+parseInt(classAverages.readingTime/60%60)).slice(-2):0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=readingTime?Math.floor(readingTime/3660)+":"+("0"+parseInt(readingTime/60%60)).slice(-2):0)?"":__t)+'</li></ul>\r\n</div>\r\n\r\n<div class="section">\r\n    <ul class="sectionHeading">\r\n        <li class="label"><h2>Questions</h2></li>\r\n        <li class="moreInfo">\r\n            <a class="btnViewAnswers">View</a>\r\n        </li>\r\n    </ul>\r\n    <ul class="studentBanner"><li class="label">Questions answered</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.questionsAnswered?classAverages.questionsAnswered:0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=studentQuestions?_.filter(studentQuestions.Responses,{isNoResponse:!1}).length:0)?"":__t)+'</li></ul>\r\n    <ul class="studentBanner"><li class="label">Avg word count per response</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.avgWordResponses?classAverages.avgWordResponses:0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=studentQuestions&&studentQuestions.shortAnsCount?parseInt(studentQuestions.wordCountSum/studentQuestions.shortAnsCount):0)?"":__t)+'</li></ul>\r\n    <ul class="studentBanner"><li class="label">Responses liked by others</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.responsesLiked?classAverages.responsesLiked:0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=responsesLiked||0)?"":__t)+'</li></ul>\r\n</div>\r\n<div class="section">\r\n    <ul class="sectionHeading">\r\n        <li class="label"><h2>Notes</h2></li>\r\n        <li class="moreInfo">\r\n            <a class="viewNotes">View</a>\r\n        </li>\r\n    </ul>\r\n    <ul class="studentBanner"><li class="label">Notes entered</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.notesEntered?classAverages.notesEntered:0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=noteCount||0)?"":__t)+'</li></ul>\r\n    <ul class="studentBanner"><li class="label">Discussions</li><li class="classAvg boldRight right">'+(null==(__t=classAverages.discussionParticipation?classAverages.discussionParticipation:0)?"":__t)+'</li><li class="studentStat boldRight right">'+(null==(__t=discussionParticipationCount||0)?"":__t)+"</li></ul>\r\n</div>\r\n\r\n",isPDF||(__p+='\r\n    <div class="section">\r\n        <ul class="sectionHeading"><li class="label"><h2>"I Don\'t Understand" flags</h2></li>',flags&&(__p+='<li class="number boldRight right">Number</li>'),__p+="</ul>\r\n        ",flags&&flags.length>0?(__p+='\r\n            <div class="flags">\r\n                ',_.each(flags,(function(e,t){__p+='\r\n                    <ul class="banner '+(null==(__t=t>=10?"paged":"")?"":__t)+'" data-tagId="'+(null==(__t=e.markerTagId)?"":__t)+'" data-type="marker" data-textSectionId="'+(null==(__t=e.textSectionId)?"":__t)+'"><li class="label" title="'+(null==(__t=cH.sanitize(e.sectionTitle))?"":__t)+'">'+(null==(__t=e.sectionTitle.length>11?cH.sanitize(e.sectionTitle).substring(0,10)+"...":cH.sanitize(e.sectionTitle))?"":__t)+'</li><li class="quadrant">'+(null==(__t=1==e.quad?"1st Part (~0-25%)":2==e.quad?"2nd Part (~25-50%)":3==e.quad?"3rd Part (~50-75%)":4==e.quad?"4th Part (~75-100%)":"0-100%")?"":__t)+'</li><li class="count boldRight right">'+(null==(__t=e.count)?"":__t)+"</li></ul>\r\n                "})),__p+="\r\n                ",flags&&flags.length>10&&(__p+='\r\n                    <a class="btn-box showall">Show all</a>\r\n                '),__p+="\r\n            </div>\r\n        "):__p+='\r\n        <div><ul class="banner"><li class="message">This student has not flagged the text.</li></ul></div>\r\n    ',__p+="\r\n    </div>\r\n"),__p+='\r\n\r\n<div class="section">\r\n    <ul class="sectionHeading"><li class="label"><h2>Vocabulary Lookups</h2></li>',vocabLookupsTable&&(__p+='<li class="number boldRight right">Number</li>'),__p+="</ul>\r\n        ",vocabLookupsTable?__p+='\r\n            <div class="studentVocabLookups">\r\n                '+(null==(__t=vocabLookupsTable)?"":__t)+"\r\n            </div>\r\n        ":__p+='\r\n        <div><ul class="banner"><li class="message">No vocab lookups</li></ul></div>\r\n    ',__p+="\r\n</div>";return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(826),s=n(1822);t.default=Backbone.View.extend({initialize:function(e){this.reader=e.reader;var t=this;this.scroll=new s.default({reader:this.reader}),this.childViews=[this.scroll],this.dataM=new a.default,this.dataM.on("sync",(function(){t.preRender(!0)}),this),Backbone.pubEv.on("refreshAssignmentData",(function(){t.preRender(!1)}),this)},preRender:function(e){e?this.render():this.dataM.fill(-1,sCH.readerConfig.assignmentId)},render:function(){this.scroll.render({dataM:this.dataM})},destroy:function(){Backbone.pubEv.off("refreshAssignmentData")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(167),o=n(827),r=n(54);t.default=Backbone.View.extend({el:"main.scroll .dataview",events:{"click ul.banner":"skipToTag","click .showall":"showAll","click ul.banner.vocabList .dropdown-menu .label":"vocabClicked"},template:n(828),StudentTemplate:n(1823),vocabLookupsTemplate:n(829),initialize:function(e){this.reader=e.reader,this.studentUserId=null},render:function(e){var t=this;this.$el.html(this.template()),this.data=e.dataM.toJSON(),this.prepareData((function(){t.fillEl()})),this.subheader=new o.default({reader:this.reader}),this.childViews=[this.subheader],this.subheader.studentRender()},fillEl:function(){var e=0;a.each(this.flagData,(function(t){e+=t.count})),this.assignmentDiscussionData=this.sortDescending(this.assignmentDiscussionData,"responseCount");var t=this.vocabLookups&&this.vocabLookups.length?this.vocabLookupsTemplate({vocabLookups:this.vocabLookups}):null;this.$el.find(".results").html(this.StudentTemplate({studentQuestions:this.studentQuestionData,answeredQuestions:a.filter(this.studentQuestionData,(function(e){return 3!==e.subType&&!e.IsNoResponse})),totalQuestionCount:this.totalQuestionCount,studentDiscussions:this.studentDiscussionData,responses:this.studentResponseData,readingTime:this.studentReadingTimes.totalTime,flags:this.flagData,flagCount:e,responsesLiked:this.studentResponsesLikedData,assignmentDiscussions:this.assignmentDiscussionData,isPDF:sCH.readerConfig.isPDF,grades:sCH.readerConfig.gradeNameMap,vocabLookupsTable:t,isMediaReader:sCH.readerConfig.isMedia,isStudentIR:"studentir"===sCH.readerConfig.type})),s.initTooltips($(".dataview"))},sortDescending:function(e,t){return e.sort((function(e,n){return e[t]<n[t]?1:n[t]<e[t]?-1:0})),e},skipToTag:function(e){var t=$(e.currentTarget),n=!t.parent().hasClass("flags")&&!t.parent().hasClass("answers"),a={sectionId:t.data("textsectionid"),tagId:t.data("tagid"),tagType:t.data("type"),openTag:n};s.onDevice()&&t.parent().hasClass("answers")&&$(".header .textview .left.btnDataView").click(),void 0!==a.sectionId&&Backbone.pubEv.trigger("skipToTag",a)},showAll:function(e){$(e.currentTarget).parent().find(".paged").toggleClass("showing"),"Show all"===$(e.currentTarget).text()?$(e.currentTarget).text("Show less"):$(e.currentTarget).text("Show all")},prepareData:function(e){this.assignmentDiscussionData=[],this.studentQuestionData=[],this.studentResponseData={},this.studentReadingTimes={},this.studentResponsesLikedData={},this.studentDiscussionData={},this.totalQuestionCount=a.filter(this.data.questionResponseList,(function(e){return 3!==e.SubType})).length,this.flagData=[],this.vocabLookups=r.getWordLookupsByPosition(this.data.vocabLookups);var t=this;t.studentQuestionData.wordCountSum=0,t.studentQuestionData.shortAnsCount=0,a.each(this.data.questionResponseList,(function(e,n){if(e.Responses.length){var a=e.Responses[0],s=a.IsReset?"Response ready for revision":a.IsDraft?"Draft pending":"number"==typeof a.Grade?"":"Submitted",i=sCH.questionsNumC.find({QuestionTagId:e.QuestionTagId});t.studentQuestionData.push({questionNum:i?i.get("QuestionNum"):"?",questionTagId:e.QuestionTagId,textSectionId:e.TextSectionId,subType:e.SubType,grade:a.IsReset?null:a.Grade,hasTeacherComment:a.HasTeacherComment,IsNoResponse:a.IsNoResponse,status:s}),1!==e.SubType||a.IsNoResponse||(t.studentQuestionData.wordCountSum+=a.Answertext?a.Answertext.replace(/\s+/g," ").replace(/(\r\n|\n|\r)/gm," ").split(" ").length:0,t.studentQuestionData.shortAnsCount++)}})),t.studentDiscussionData.count=0,t.studentResponseData.count=0,a.each(this.data.discussionData,(function(e,n){var i=e.CreatorName,o='<span class="colorName initial_'+(i?i.charAt(0).toLowerCase():"")+'">'+s.sanitize(i)+"</span>",r=[],l=sCH.learnEntitySectionsMetaC.find({TextSectionId:e.TextSectionId}),d=1===sCH.learnEntitySectionsMetaC.validSectionLength?"Entire text":l.get("Title")?l.get("Title"):(sCH.isPDF?"Page ":"Section ")+l.get("SectionNum"),c=e.UserId==t.data.currentUserId;a.each(e.Responses,(function(n,s){-1===a.indexOf(r,n.ResponderName)&&r.push(n.ResponderName),n.UserId==t.data.currentUserId&&(t.studentResponseData.count++,c="teacher"===e.Role||e.IsPublic)}));for(var u=0;u<r.length;u++){if(4===u&&sCH.learnEntitySectionsMetaC.validSectionLength>1||6==u){o+=" ...";break}o+='<span class="colorName initial_'+(r[u]?r[u].charAt(0).toLowerCase():"")+'">'+s.sanitize(r[u])+"</span>"}e.UserId==t.data.currentUserId&&t.studentDiscussionData.count++,c&&(sCH.readerConfig.Settings.AllowStudentSharedNotes||!sCH.readerConfig.Settings.AllowStudentSharedNotes&&"teacher"===e.Role)&&t.assignmentDiscussionData.push({sectionTitle:d,createdBy:i,tagId:e.NoteTagId,role:e.Role,textSectionId:e.TextSectionId,studentList:o,responseCount:e.Responses.length})})),t.studentReadingTimes.totalTime=0,a.each(this.data.readingTimes,(function(e){e.UserId==t.data.currentUserId&&(t.studentReadingTimes.totalTime+=e.TotalTime)})),this.studentResponsesLikedData.ResponseLiked=0,sCH.readerConfig.Settings&&sCH.readerConfig.Settings.AllowLikingPeerResponses&&a.each(this.data.responseLikedList,(function(e){if(e.UserId==t.data.currentUserId){var n=a.find(t.studentQuestionData,{questionTagId:e.QuestionTagId});n&&(n.likeCount=e.VoteCount,t.studentResponsesLikedData.ResponseLiked++)}}));var n=[];a.each(this.data.flagList,(function(e){if(e.UserId==t.data.currentUserId){var s=a.filter(n,{textSectionId:e.TextSectionId}),i=sCH.learnEntitySectionsMetaC.find({TextSectionId:e.TextSectionId}),o=1===sCH.learnEntitySectionsMetaC.validSectionLength?"Entire text":i.get("Title")?i.get("Title"):(sCH.isPDF?"Page ":"Section ")+i.get("SectionNum");s.length?s[0].Flags.push(e):(s={textSectionId:e.TextSectionId,sectionTitle:o,Flags:[e]},n.push(s))}})),0===n.length?e():a.each(n,(function(o,r){var l=o.textSectionId;i.supported?i.db.textSections.get(l,(function(i){if(i){var d=s.getStyleTagContentLength(i.Content),c=s.charCountHtml(i.Content)-d;a.each(o.Flags,(function(e){var n=Math.ceil(4*(e.StartIndex-d)/c);0===n&&(n=1);var s=a.filter(t.flagData,{textSectionId:l,quad:n});s.length?s[0].count++:t.flagData.push({tagId:e.MarkerTagId,textSectionId:l,sectionTitle:o.sectionTitle,quad:n,count:1})}))}else t.flagData.push({textSectionId:l,sectionTitle:o.sectionTitle,quad:5,count:o.Flags.length});r===n.length-1&&e()})):(t.flagData.push({textSectionId:l,sectionTitle:o.sectionTitle,quad:5,count:o.Flags.length}),e())}))},vocabClicked:function(e){s.handleVocabClick(e)},destroy:function(){}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="section">\r\n    <ul class="sectionHeading">\r\n        <h2>Questions</h2>\r\n    </ul>\r\n    ',studentQuestions.length?(__p+='\r\n        <div class="answers">\r\n            ',_.each(studentQuestions,(function(e,t){var n=null==e.grade?"":{0:"red",1:"red",2:"red",3:"green",4:"green"}[e.grade];__p+='\r\n            <ul class="banner '+(null==(__t=t>=10?"paged":"")?"":__t)+'" data-tagid="'+(null==(__t=e.questionTagId)?"":__t)+'" data-type="question" data-textsectionid="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                ',3===e.subType?__p+='\r\n                    <li class="label"># '+(null==(__t=e.questionNum)?"":__t)+" (Poll)</li>\r\n                ":2===e.subType?(__p+='\r\n                    <li class="label"># '+(null==(__t=e.questionNum)?"":__t)+" (MC)</li>\r\n                    ",""!==e.status&&(__p+='<li class="gradeStat">'+(null==(__t=e.status)?"":__t)+"</li>"),__p+="\r\n                    ",sCH.readerConfig.Settings.AllowStudentsMCAnswer&&(__p+="\r\n                        ",void 0!==e.grade&&null!==e.grade&&(__p+='\r\n                            <li class="stat '+(null==(__t=n)?"":__t)+'">'+(null==(__t=0===e.grade?"Incorrect":"Correct")?"":__t)+"</li>\r\n                        "),__p+="\r\n                    "),__p+="\r\n                "):1===e.subType&&(__p+='\r\n                    <li class="label"># '+(null==(__t=e.questionNum)?"":__t)+" (SA)</li>\r\n                    ",""!==e.status&&(__p+='<li class="gradeStat">'+(null==(__t=e.status)?"":__t)+"</li>"),__p+="\r\n                    ",void 0!==e.grade&&null!==e.grade&&(__p+='\r\n                        <li class="stat '+(null==(__t=n)?"":__t)+'">'+(null==(__t=cH.sanitize(grades[e.grade].label))?"":__t)+"</li>\r\n                    "),__p+="\r\n                    ",e.likeCount&&(__p+='\r\n                        <li class="gradeStat right">\r\n                            <div class="icon-thumbsup no-hover">\r\n                                <span class="num">'+(null==(__t=e.likeCount)?"":__t)+"</span>\r\n                            </div>\r\n                        </li>\r\n                    "),__p+="\r\n                    ",e.hasTeacherComment&&(__p+='\r\n                        <li class="gradeStat right">\r\n                            <div class="icon-comment no-hover"></div>\r\n                        </li>\r\n                    '),__p+="\r\n                "),__p+="\r\n            </ul>\r\n            "})),__p+="\r\n            ",studentQuestions.length>10&&(__p+='\r\n                <a class="btn-box showall">Show all</a>\r\n            '),__p+="\r\n        </div>\r\n    "):__p+='\r\n        <div><ul class="banner"><li class="message">No questions answered</li></ul></div>\r\n    ',__p+="\r\n</div>\r\n\r\n",!isMediaReader){if(__p+="\r\n    ",!isStudentIR){if(__p+='\r\n        <div class="section">\r\n            <ul class="sectionHeading"><h2>Class Discussions</h2><li class="right">Responses</li></ul>\r\n            ',assignmentDiscussions.length){var counter=1;__p+='\r\n            <div class="discussions">\r\n                ',_.each(assignmentDiscussions,(function(e,t){e.responseCount>0&&(counter++,__p+='\r\n                <ul class="banner '+(null==(__t=counter>10?"paged":"")?"":__t)+'" data-tagid="'+(null==(__t=e.tagId)?"":__t)+'" data-type="note" data-textsectionid="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                    ',"Entire text"!==e.sectionTitle?__p+='\r\n                        <li class="label" title="'+(null==(__t=cH.sanitize(e.sectionTitle))?"":__t)+'">'+(null==(__t=e.sectionTitle.length>11?cH.sanitize(e.sectionTitle.substring(0,10))+"...":cH.sanitize(e.sectionTitle))?"":__t)+'</li>\r\n                        <li class="studentList">'+(null==(__t=e.studentList)?"":__t)+"</li>\r\n                    ":__p+='\r\n                        <li class="studentList alignLeft">'+(null==(__t=e.studentList)?"":__t)+"</li>\r\n                    ",__p+='\r\n                    <li class="responses boldRight right">'+(null==(__t=e.responseCount)?"":__t)+"</li>\r\n                </ul>\r\n                ")})),__p+="\r\n                ",counter>10?__p+='\r\n                    <a class="btn-box showall">Show all</a>\r\n                ':1===counter&&(__p+='\r\n                    <ul class="banner"><li class="message">No discussions</li></ul>\r\n                '),__p+="\r\n            </div>\r\n            "}else __p+='\r\n                <div><ul class="banner"><li class="message">No discussions</li></ul></div>\r\n            ';__p+="\r\n        </div>\r\n    "}__p+="\r\n    \x3c!-- ",isPDF||(__p+='\r\n        <div class="section">\r\n            <ul class="sectionHeading"><h2>"I Don\'t Understand" flags</h2><li class="right">Number</li></ul>\r\n            ',flags.length?(__p+='\r\n                <div class="flags">\r\n                    ',_.each(flags,(function(e,t){__p+='\r\n                        <ul class="banner '+(null==(__t=t>=10?"paged":"")?"":__t)+'" data-tagid="'+(null==(__t=e.tagId)?"":__t)+'" data-type="marker" data-textsectionid="'+(null==(__t=e.textSectionId)?"":__t)+'">\r\n                            ',"Entire text"!==e.sectionTitle&&(__p+='\r\n                                <li class="label" title="'+(null==(__t=cH.sanitize(e.sectionTitle))?"":__t)+'">'+(null==(__t=e.sectionTitle.length>11?cH.sanitize(e.sectionTitle.substring(0,10))+"...":cH.sanitize(e.sectionTitle))?"":__t)+"</li>\r\n                            "),__p+='\r\n                            <li class="quadrant ',print("Entire text"===e.sectionTitle?"alignLeft":""),__p+='">\r\n                                '+(null==(__t=1==e.quad?"1st Part (~0-25%)":2==e.quad?"2nd Part (~25-50%)":3==e.quad?"3rd Part (~50-75%)":4==e.quad?"4th Part (~75-100%)":"0-100%")?"":__t)+'\r\n                            </li>\r\n                            <li class="count boldRight right">'+(null==(__t=e.count)?"":__t)+"</li>\r\n                        </ul>\r\n                    "})),__p+="\r\n                    ",flags.length>10&&(__p+='\r\n                        <a class="btn-box showall">Show all</a>\r\n                    '),__p+="\r\n                </div>\r\n            "):__p+='\r\n            <div><ul class="banner"><li class="message">No "I Don\'t Understand" flags</li></ul></div>\r\n        ',__p+="\r\n        </div>\r\n    "),__p+=' --\x3e\r\n    <div class="section">\r\n        <ul class="sectionHeading"><li class="label"><h2>Vocabulary Lookups</h2></li>',vocabLookupsTable&&(__p+='<li class="number boldRight right">Number</li>'),__p+="</ul>\r\n        ",vocabLookupsTable?__p+="\r\n            "+(null==(__t=vocabLookupsTable)?"":__t)+"\r\n        ":__p+='\r\n            <div><ul class="banner"><li class="message">No vocab lookups</li></ul></div>\r\n        ',__p+="\r\n    </div>\r\n"}__p+='\r\n<div class="section">\r\n    <ul class="sectionHeading"><h2>Progress</h2></ul>\r\n    <ul class="studentBanner"><li class="label">Overall question progress</li><li class="boldRight right">'+(null==(__t=totalQuestionCount?answeredQuestions?cH.percent(answeredQuestions.length/totalQuestionCount):0:'<span class="na">n/a</span>')?"":__t)+'</li></ul>    \r\n    <ul class="studentBanner"><li class="label">Reading time (h:mm)</li><li class="boldRight right">'+(null==(__t=readingTime?Math.floor(readingTime/3660)+":"+("0"+parseInt(readingTime/60%60)).slice(-2):0)?"":__t)+'</li></ul>\r\n</div>\r\n<div class="section">\r\n    <ul class="sectionHeading"><h2>Activity</h2></ul>\r\n    <ul class="studentBanner"><li class="label">Questions answered</li><li class="boldRight right">'+(null==(__t=answeredQuestions.length?answeredQuestions.length:0)?"":__t)+'</li></ul>\r\n    <ul class="studentBanner"><li class="label">Avg word count per response</li><li class="boldRight right">'+(null==(__t=studentQuestions.shortAnsCount?parseInt(studentQuestions.wordCountSum/studentQuestions.shortAnsCount):0)?"":__t)+"</li></ul>\r\n    \r\n    ",isMediaReader||isStudentIR||(__p+='\r\n        <ul class="studentBanner"><li class="label">Responses liked by others</li><li class="boldRight right">'+(null==(__t=responsesLiked.ResponseLiked?responsesLiked.ResponseLiked:0)?"":__t)+'</li></ul> \r\n        <ul class="studentBanner"><li class="label">Notes entered</li><li class="boldRight right">'+(null==(__t=studentDiscussions.count?studentDiscussions.count:0)?"":__t)+'</li></ul>\r\n        <ul class="studentBanner"><li class="label">Responses to peers</li><li class="boldRight right">'+(null==(__t=responses.count?responses.count:0)?"":__t)+"</li></ul>\r\n    "),__p+='\r\n    \x3c!-- <ul class="studentBanner"><li class="label">"I Don\'t Understand" flags</li><li class="boldRight right">'+(null==(__t=flagCount)?"":__t)+"</li></ul> --\x3e\r\n</div>"}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(523),s=n(1894);t.default=a.default.extend({postInitialize:function(e){this.panel=e.panel,sCH.readerConfig.type="authoring",sCH.readerConfig.layerId=parseInt(e.layerId),e.hasOwnProperty("isReadOnly")&&(sCH.readerConfig.isReadOnly=!0,$(".reader").addClass("publicExpanded")),sCH.readerConfig.showAuthoringActions=!e.hasOwnProperty("showAuthoringActions")||"true"===e.showAuthoringActions,Backbone.pubEv.trigger("loadingShowHide",!0),this.loadReaderData()},render:function(){sCH.learnEntityMetaM.attributes.LearnEntityId&&sCH.learnEntitySectionsMetaC.validSectionLength&&(sCH.readerConfig.popUpsWrapperController=new s.default,this.scroll.render(),this.scroll.renderSection(),sCH.readerConfig.initialRender=!0),this.panel?this.reader.header.toggleView(this.panel,!0):this.reader.header.toggleView("notes",!1)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=n(1826),r=n(528),l=n(10),d=n(149),c=n(841),u=n(1883),p=n(264),h=n(1884),g=n(148),f=n(129),m=n(167),v=n(522),b=n(495),C=n(1888),y=n(43),_=n(14);t.default=Backbone.View.extend({el:"main.scroll .textview",template:n(1892),assessmentTemplate:n(1893),events:{"click .previous:not(.offline)":"loadPreviousSection","click .next:not(.last):not(.offline)":"loadNextSection","click .btnOpenMultipleAttributionBarsPopup":"openMultipleAttributionBarsPopup",gated:"finishRenderingSection","click .btnAddPreReadingQuestion":"addPreReadingQuestion",mousedown:"setTextSelectionType",touchstart:"setTextSelectionType"},initialize:function(e){this.header=e.header,Backbone.pubEv.on("updateMargin",this.updateFlagPositioning,this),Backbone.pubEv.on("playEntireTextTriggered",this.playEntireText,this)},render:function(){if(sCH.readerConfig.isAssessment&&"authoring"===sCH.readerConfig.type?this.$el.html(this.assessmentTemplate()):this.$el.html(this.template({readerType:sCH.readerConfig.type,isReadOnly:sCH.readerConfig.isReadOnly,isPDF:sCH.readerConfig.isPDF,CovidIRStatus:_.CovidIRStatus})),sCH.readerConfig.isAssessment&&$(".reader").addClass("assessmentView"),sCH.learnEntityMetaM.get("ContentUrl"))try{var e=document.createElement("a");e.href=sCH.learnEntityMetaM.get("ContentUrl");var t=e.hostname.split("."),n=t[t.length-2];this.$el.find(".textSection").addClass("sourcedomain-"+n.replace(/\W+/g,""))}catch(e){}if(sCH.readerConfig.isMedia&&(sCH.readerConfig.TextSettings=alcfg.defaultTextSettings),sCH.readerConfig.TextSettings&&($(".reader, .popUpsWrapper").addClass(sCH.readerConfig.TextSettings.fontSize),$(".reader, .popUpsWrapper").addClass(sCH.readerConfig.TextSettings.font+"Font"),sCH.readerConfig.isPDF||sCH.readerConfig.isAssessment||("grading"!==sCH.readerConfig.type&&($(".reader, .popUpsWrapper").addClass(sCH.readerConfig.TextSettings.theme),$(".reader, .popUpsWrapper").addClass(sCH.readerConfig.TextSettings.readerBackground),$(".reader, .popUpsWrapper").addClass(sCH.readerConfig.TextSettings.spacing+"Spacing")),$(".reader").addClass("on"===sCH.readerConfig.TextSettings.paraNum?"paraNum":""))),sCH.readerConfig.libraryLayerDownloadCount&&!sCH.readerConfig.isReadOnly){var a=sCH.readerConfig.libraryLayerDownloadCount+(sCH.readerConfig.libraryLayerDownloadCount>1?" teachers who have":" teacher who has");new Backbone.BootstrapModal({title:"This assignment is shared to your "+sCH.userM.getLibraryString(),content:alcfg.confirmsText.libraryCopyDownloadedEdit.format(a),cancelText:!1,okText:"Got it"}).open()}return s.initTooltips(this.$el),this.$el},handlePrevNextButtons:function(){if(this.$el.find(".attribution").hide(),this.$el.find(".textSummary").hide(),this.$el.find(".previous").show(),this.$el.find(".next").show(),this.$el.find(".next").removeClass("last"),this.instructionsView||(this.instructionsView=new r.default),this.instructionsView.renderCurrentSection(),this.$el.find(".preReadingQuestionContainer").show(),this.checkAndShowPreReadingButton(),sCH.readerConfig.currentSectionId===sCH.learnEntitySectionsMetaC.getFirstSectionId()){if(sCH.learnEntityMetaM.get("Status"))try{var e=sCH.learnEntityMetaM.get("ContentUrl");e&&0===e.indexOf("mergelayers")?this.$el.find(".attribution").html('<div class="btnOpenMultipleAttributionBarsPopup">This bundle contains content from multiple sources. Click here to see more.</div>'):sCH.learnEntityMetaM.get("Publisher")&&i.mountReactComponent(c.default,this.$el.find(".attribution")[0],{publisherName:sCH.learnEntityMetaM.get("Publisher"),author:sCH.learnEntityMetaM.get("Author"),contentUrl:sCH.learnEntityMetaM.get("ContentUrl"),source:sCH.learnEntityMetaM.get("Source")}),this.$el.find(".attribution").show()}catch(e){}this.$el.find(".previous").hide(),1===sCH.learnEntitySectionsMetaC.validSectionLength&&this.$el.find(".next").addClass("last")}else sCH.readerConfig.currentSectionId===sCH.learnEntitySectionsMetaC.getLastSectionId()&&this.$el.find(".next").addClass("last");this.renderTextSummary()},renderTextSummary:function(){!sCH.readerConfig.isMedia&&!sCH.readerConfig.isAssessment&&this.$el.find(".textSummary")&&sCH.readerConfig.textSummaries&&(i.unmountReactComponent(this.$el.find(".textSummary")[0]),("student"!==sCH.userM.get("Role")||sCH.readerConfig.isStudentStruggling&&s.isClassOnPrimePlan(sCH.learnEntityMetaM.get("ClassId")))&&(i.mountReactComponent(C.default,this.$el.find(".textSummary")[0],{isEditingAllowed:"authoring"===sCH.readerConfig.type&&sCH.userM.isOnPrimePlan()&&!sCH.readerConfig.isReadOnly}),this.$el.find(".textSummary").show()))},openMultipleAttributionBarsPopup:function(){new Backbone.BootstrapModal({title:"Sources",content:'<div id="multipleAttributionBarsContainer"></div>',cssClass:"modal-lg",okText:"Close",cancelText:!1}).on("shown",(function(){i.mountReactComponent(u.default,$("#multipleAttributionBarsContainer")[0],{mergedContentUrl:sCH.learnEntityMetaM.get("ContentUrl")})})).open()},checkAndShowPreReadingButton:function(){"authoring"!==sCH.readerConfig.type||sCH.readerConfig.isReadOnly||(a.find(sCH.questionsNumC.models,(function(e){return e.get("TextSectionId")===sCH.readerConfig.currentSectionId&&-1===e.get("StartIndex")&&-1===e.get("EndIndex")}))||this.$el.find(".preReadingQuestionContainer .btnAddPreReadingQuestion").show())},renderSection:function(){if(this.handlePrevNextButtons(),sCH.readerConfig.isPDF)this.renderPDFSection();else if(sCH.readerConfig.isMedia)this.renderMediaSection();else{var e=sCH.learnEntitySectionsC.getModelBySectionId(sCH.readerConfig.currentSectionId),t=this;this.$el.find(".textSectionContainer").attr("data-textsectionid",sCH.readerConfig.currentSectionId),this.textSectionContainerView&&(this.textSectionContainerView.close(!1),this.$el.find(".textSectionContainer").html('<div class="textSection"></div><div class="endSectionQuestions sameLocationQuestionsContainer"></div>'),"authoring"!==sCH.readerConfig.type||sCH.readerConfig.isReadOnly||this.$el.find(".textSectionContainer").append('<button class="btn-box large btnAddQuestion">Add question to end of section</button>')),this.textSectionContainerView=new o.default({model:e});var n=this.textSectionContainerView.render();window.setTimeout((function(){if(t.textSectionContainerView.renderTags(),-1==sCH.readerConfig.providedScrollTop||sCH.readerConfig.searchContext)t.clickedPrev?s.scrollElement().scrollTop($(".textSectionContainer").height()):t.clickedNext&&s.scrollElement().scrollTop(0),t.clickedPrev=!1,t.clickedNext=!1;else{var e=sCH.readerConfig.providedScrollTop,a=n.find(".questionTagHtml:visible").length>0||n.find("img").length>0;window.setTimeout((function(){s.scrollElement().scrollTop(e)}),a?500:0),sCH.readerConfig.providedScrollTop=-1}var i=0;if("authoring"===sCH.readerConfig.type&&$(".reader").hasClass("paid")&&sCH.readerConfig.isReadOnly){var o=sCH.learnEntitySectionsMetaC.getModelBySectionId(sCH.readerConfig.currentSectionId);if(o&&o.get("Truncated"))try{if(-1===o.get("Truncated"));else{var r=$("body").height()-$(".headerWrapper").height();$(".textSection").css({height:r,overflow:"hidden"}).append("<div class='fadeOut'></div>"),$(".fadeOut").css("top",r-270),$(".scroll .right").css("overflow","hidden");var d=sCH.userM.isOnPrimeUnlimited()?"You are on an Unlimited plan! Press Assign or Customize above to get your own copy of the text and keep reading on!":"To access the rest of this title, log in or sign up to purchase licenses for yourself and your students!";$(".endSectionQuestions").html("<p class='readmore'>"+d+"</p>"),$(".reader").addClass("truncated"),$(".next").hide()}}catch(e){}else $(".fadeOut").remove(),$(".reader").removeClass("truncated"),$(".scroll .right").css("overflow","visible")}s.isGoogleSection()&&(sCH.readerConfig.googleDocCSS=$(".textSection style").text(),s.overrideGoogleDocCSSWithTextSettings()),sCH.learnEntityMetaM.get("RentalPrices")&&sCH.learnEntitySectionsMetaC.getModelBySectionId(sCH.readerConfig.currentSectionId).get("Passed10Percent")&&l.Passed10Percent({learnEntityId:sCH.learnEntityMetaM.get("LearnEntityId")}),$(".textSection").find("p:not(.title):not(.subtitle), blockquote, br").each((function(e){try{""===$.trim($(this).text())||$(this).parent().is("p, blockquote")||$(this).parents(".teacherQuestion").length?$(this).parents(".teacherQuestion").length||$(this).css({padding:0}):"authoring"==sCH.readerConfig.type&&!0!==sCH.readerConfig.isReadOnly||!$(this).hasClass("whiteoutParagraph")?$(this).hasClass("whiteoutParagraphFirstLine")||$(this).prepend("<div class='pnum'><span data-count='"+ ++i+"'>"+i+"</span></div>"):$(this).hide()}catch(e){}}));try{if(!s.isGoogleSection())for(var c=new RegExp("^[^A-Za-z--------]*[---]"),u=void 0,p=document.createTreeWalker(n[0],NodeFilter.SHOW_TEXT,null,!1);u=p.nextNode();)c.test(u.nodeValue)&&u.parentNode.className.indexOf(" rtl")<0&&(u.parentNode.className+=" rtl")}catch(e){console.log(e)}var h=window.setTimeout((function(){Backbone.pubEv.trigger("updateMargin")}),s.onDevice()?500:1);$.timeouts.push(h),"student"===sCH.readerConfig.type&&$(".btnKeyVocabHighlight").hasClass("selected")&&Backbone.pubEv.trigger("highlightKeyVocabWords",{shouldAvoidAlert:!0})}),1);if(sCH.readerConfig.isAssessment)Backbone.pubEv.trigger("loadingShowHide",!1);else if("student"!==sCH.readerConfig.type){var a=window.setTimeout((function(){t.finishRenderingSection()}),"studentir"===sCH.readerConfig.type&&999999===sCH.readerConfig.providedScrollTop?2e3:500);$.timeouts.push(a)}try{sCH.learnEntityMetaM.get("LayerSource")&&("AddFromOnline"===sCH.learnEntityMetaM.get("LayerSource")?$(".textSection > ul li").css({listStyle:"initial",marginLeft:"28px"}):s.isGoogleSection()&&$(".textSectionContainer").addClass("google"))}catch(e){}$(window).on("orientationchange",(function(){var e=s.scrollElement().scrollTop(),n=t.textSectionHeight,a=t.$el.find(".textSection").height();e&&(s.scrollElement().scrollTop(e/n*a),t.textSectionHeight=a)})),sCH.readerConfig.popUpsWrapperController.popupAddTagV&&sCH.readerConfig.popUpsWrapperController.popupAddTagV.destroy(),sCH.readerConfig.popUpsWrapperController.popupAddTagV=new h.default,$(".reader .scroll .textview").append(sCH.readerConfig.popUpsWrapperController.popupAddTagV.render()),this.initSelection(),this.initGating()}},finishRenderingSection:function(){if(!1===sCH.readerConfig.finishedRendering&&"tour"===sCH.readerConfig.type)sCH.readerConfig.finishedRendering=!0,f.introPopup();else if(!1===sCH.readerConfig.finishedRendering&&"authoring"===sCH.readerConfig.type){if(sCH.readerConfig.finishedRendering=!0,!sCH.userM.get("IsMasquerading"))if(sCH.readerConfig.isReadOnly&&!sCH.userM.isAnonUser()){var e=[];sCH.learnEntitySectionsMetaC.length>1&&sCH.userM.showPopup("HowToNavMultiSection")&&(e.push({target:".btnSectionsDropdown",content:"Use the Table of Contents to navigate through the text.",placement:"bottom",disableBeacon:!0}),s.updateDoNotShowPopupSetting("HowToNavMultiSection")),!sCH.learnEntityMetaM.get("RentalPrices")&&sCH.userM.showPopup("HowToCustomize")&&(e.push({target:".btnCustomize",content:"Want to make changes to our instruction? Click this button to DIY!",placement:"bottom",disableBeacon:!0}),s.updateDoNotShowPopupSetting("HowToCustomize")),e.length>0&&i.mountReactComponent(b.default,$("#joyride")[0],{steps:e})}else if(!sCH.readerConfig.isReadOnly){var t=location.hash.split("?")[1],n=t?s.parseQueryString(t):{};!n.isRedirectAfterAssign&&sCH.userM.showPopup("HowToAuthor")?(i.mountReactComponent(b.default,$("#joyride")[0],{disableOverlay:!0,steps:[{target:".instructions.readerpanel",content:'Click on "Assignment Directions". Share the learning objective with students and provide instructions.',placement:"right",disableBeacon:!0},{target:".textSection p",content:"Highlight some text. Use notes to provide background knowledge or stimulate discussion.                   Use questions to chunk the text and check for understanding.",placement:"top",disableBeacon:!0}]}),s.updateDoNotShowPopupSetting("HowToAuthor")):n.isRedirectToAssignAfterBuying&&$(".header .btnAssignToClasses").click()}}else!1===sCH.readerConfig.finishedRendering&&"grading"===sCH.readerConfig.type&&(sCH.readerConfig.finishedRendering=!0,sCH.userM.showPopup("HowToGrade")?(i.mountReactComponent(b.default,$("#joyride")[0],{onComplete:this.showAutoGradeOptInPopup,steps:[{target:".header .btnDataView",content:"See all students' progress, time spent, vocab lookups, and more.",placement:"bottom",disableBeacon:!0},{target:".header .btnGradingView",content:"Grade and give feedback in realtime.",placement:"bottom",disableBeacon:!0},{target:".header .btnNotesView",content:"See all student notes and participate in class discussions.",placement:"bottom",disableBeacon:!0}]}),s.updateDoNotShowPopupSetting("HowToGrade")):this.showAutoGradeOptInPopup());if(y&&y.ipad&&y.osversion.indexOf("9.")>=0&&!$(".modal-al-ios91").length&&!sCH.readerConfig.isPDF&&sCH.userM.showPopup("HowToSelectTextIOS91")&&!window.ActivelyRead.ShownHowToSelectTextIOS91){window.ActivelyRead.ShownHowToSelectTextIOS91=!0;new Backbone.BootstrapModal({title:"Important information for iPad users on iOS 9",content:new p.default({videoId:"i7rwhchj75",introText:"iOS 9 has a bug which makes text selection difficult.<br />Please upgrade to iOS 10.<br />            If you are unable to upgrade, use the workaround in the video below."}),cancelText:!1,cssClass:"modal-lg danger modal-al-ios91",allowCancel:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){s.updateDoNotShowPopupSetting("HowToSelectTextIOS91")}))}var a=this;window.setTimeout((function(){a.skipToTag()}),1001),Backbone.pubEv.trigger("loadingShowHide",!1),$(".reader .scroll .textview").prop("scrollHeight")>$(".reader .scroll").height()&&y.ios&&0==s.scrollElement().scrollTop()&&!sCH.readerConfig.isPDF&&($(".reader .scroll").addClass("displayNone"),window.setTimeout((function(){$(".reader .scroll").removeClass("displayNone")}),1)),window.setTimeout((function(){a.textSectionHeight=a.$el.find(".textSection").height()}),5),this.initProgressBar()},renderPDFSection:function(){this.header.pdf.handlePdfNavigation(!1);var e=sCH.learnEntitySectionsC.getModelBySectionId(sCH.readerConfig.currentSectionId),t=this;if(this.textSectionContainerView&&this.textSectionContainerView.destroyPDF(),this.textSectionContainerView=new o.default({model:e}),this.$el.find(".textSectionContainer").attr("data-textsectionid",sCH.readerConfig.currentSectionId),this.textSectionContainerView.renderPDF(this.header.pdf.clickedPrev),window.setTimeout((function(){t.skipToTag()}),2),"student"===sCH.readerConfig.type&&!sCH.readerConfig.initialRender&&sCH.readerConfig.isPDF&&sCH.userM.showPopup("StudentPdfNavigation"))new Backbone.BootstrapModal({title:"PDFs work a little differently than other texts on Actively Learn. See below.",content:'<img class="howToGrade" src="/img/HowToNavigatePDF.gif" />',cssClass:"modal-al-how-to-navigate",allowCancel:!1,cancelText:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){s.updateDoNotShowPopupSetting("StudentPdfNavigation")}));sCH.readerConfig.popUpsWrapperController.popupAddTagV&&sCH.readerConfig.popUpsWrapperController.popupAddTagV.destroy(),sCH.readerConfig.popUpsWrapperController.popupAddTagV=new h.default,$(".reader .scroll .textview").append(sCH.readerConfig.popUpsWrapperController.popupAddTagV.render()),this.initSelection(),this.initGating()},renderMediaSection:function(){var e=sCH.learnEntitySectionsC.getModelBySectionId(sCH.readerConfig.currentSectionId);this.textSectionContainerView=new o.default({model:e,tagListMode:!0}),sCH.readerConfig.scrollTopPx=sCH.readerSettingsM.get("LastReadScrollTopPx")||0,this.textSectionContainerView.renderMedia(),Backbone.pubEv.trigger("loadingShowHide",!1)},initGating:function(){a.includes(["student","tour","studentir"],sCH.readerConfig.type)&&!sCH.readerConfig.isAssessment&&(Backbone.pubEv.trigger("questionsTagBlocker"),window.addResizeListener($(".textGatingSizeSensor").get(0),a.throttle((function(){Backbone.pubEv.trigger("questionsTagBlocker")}),1e3)))},skipToTag:function(){if(sCH.readerConfig&&void 0!==sCH.readerConfig.skipToTag.tagId)if(sCH.readerConfig.skipToTag.sectionId&&sCH.readerConfig.skipToTag.sectionId!==sCH.readerConfig.currentSectionId)Backbone.pubEv.trigger("skipToTag",sCH.readerConfig.skipToTag);else{var e,t=0;e=window.setInterval((function(){if(t>5||!sCH.readerConfig||!sCH.readerConfig.skipToTag.tagId)clearInterval(e);else{var n,a,i=$("div."+sCH.readerConfig.skipToTag.tagType+"[data-tagid='"+sCH.readerConfig.skipToTag.tagId+"']").eq(0);if(i.length){sCH.readerConfig.providedScrollTop=-1,i.hasClass("questionTagViewMode")&&(i.parent().removeClass("minimized"),sCH.readerConfig.isPDF&&s.scrollElement().scrollTop(0)),i.hasClass("noteTagContainer")?($(".notesTag.active[data-transparent='1'], .noteTagContainer.active[data-transparent='1']").addClass("transparent"),$(".notesTag.active, .noteTagContainer.active").removeClass("active"),n=$("span.notesTag[data-tagid='"+sCH.readerConfig.skipToTag.tagId+"']").addClass("active").offset().top):n=i.offset().top,a=n-$(".textGatingGate").offset().top;var o=!1,r=!1;if("student"===sCH.readerConfig.type&&"question"===sCH.readerConfig.skipToTag.tagType)if(o=!0,c=sCH.questionsNumC.getFirstNotAnsweredQuestion()){var l=sCH.questionsNumC.filter({QuestionTagId:c.QuestionTagId})[0];sCH.questionsNumC.filter({QuestionTagId:sCH.readerConfig.skipToTag.tagId})[0].get("QuestionNum")>l.get("QuestionNum")&&(r=!0)}"student"===sCH.readerConfig.type&&!sCH.readerConfig.isPDF&&(r&&o||!o&&n>s.scrollElement().find(".textSectionContainer").height())?new Backbone.BootstrapModal({title:"Oops!",cssClass:"modal-al-question-note-restricted",content:"question"===sCH.readerConfig.skipToTag.tagType?alcfg.confirmsText.questionRestricted:alcfg.confirmsText.noteRestricted,cancelText:!1}).open():(s.scrollElement().scrollTop(a-($(window).height()-51)/2),sCH.readerConfig.skipToTag.openTag?i.find(".inner").length>0?i.find(".inner").click():i.find(".imgFlag").length>0?i.find(".imgFlag").click():i.hasClass("questionTagViewMode")&&(i.click(),"openResponse"===sCH.readerConfig.skipToTag.openTag&&i.siblings(".questionTagGrading").click()):i.hasClass("noteTagContainer")&&i.click(),i.hasClass("questionTagViewMode")&&(i=i.parent()),sCH.readerConfig.isPDF&&i.hasClass("noteTagContainer")&&(i=$("span.notesTag[data-tagid='"+sCH.readerConfig.skipToTag.tagId+"']")),i.hasClass("noteTagContainer")||(i.addClass("flash"),window.setTimeout((function(){i.removeClass("flash")}),4e3))),sCH.readerConfig.skipToTag={},clearInterval(e)}else if("student"===sCH.readerConfig.type&&"Show peer notes"===$(".btnToggleSharedNotes .state").text()){var d=sCH.allStudentTagsC.find({TagId:sCH.readerConfig.skipToTag.tagId}),c=sCH.questionsNumC.getFirstNotAnsweredQuestion();d||(d=sCH.teacherNotesC.find({TagId:sCH.readerConfig.skipToTag.tagId})),d&&(c&&-1!==c.StartIndex&&d.get("TextSectionId")===c.TextSectionId&&d.get("EndIndex")>c.EndIndex?new Backbone.BootstrapModal({title:"Oops!",content:alcfg.confirmsText.noteRestricted,cssClass:"modal-al-note-restricted",cancelText:!1}).open():Backbone.pubEv.trigger("popupFullNoteShow",{model:d,scope:{tagListMode:!1}}),sCH.readerConfig.skipToTag={},clearInterval(e)),t++}else if("note"===sCH.readerConfig.skipToTag.tagType&&"grading"===sCH.readerConfig.type){var u=sCH.studentNotesC.find({TagId:sCH.readerConfig.skipToTag.tagId});u||(u=sCH.teacherNotesC.find({TagId:sCH.readerConfig.skipToTag.tagId})),u&&(Backbone.pubEv.trigger("popupFullNoteShow",{model:u,scope:{tagListMode:!1}}),sCH.readerConfig.skipToTag={},clearInterval(e)),t++}else t++}}),500)}sCH.readerConfig&&sCH.readerConfig.searchContext&&(sCH.readerConfig.searchContext.onlyShowTextSelectionHandles?(s.clearWrapOnElement("textSelectionHandles"),this.textSectionContainerView.renderSearchResult(sCH.readerConfig.searchOffset,sCH.readerConfig.searchContext),sCH.readerConfig.searchContext=null):sCH.readerConfig.searchContext.length>=3&&(s.clearSearchHighlights(),this.textSectionContainerView.renderSearchResult(sCH.readerConfig.searchOffset,sCH.readerConfig.searchContext),sCH.readerConfig.searchContext=null))},loadPreviousSection:function(){var e=this;Backbone.pubEv.trigger("loadingShowHide",!0),d.check((function(t){if(t)d.startReconnectCheck();else if(e.clickedNext=!1,e.clickedPrev=!0,sCH.learnEntitySectionsMetaC){var n=sCH.learnEntitySectionsMetaC.getPrevSectionId(sCH.readerConfig.currentSectionId);n&&Backbone.pubEv.trigger("skipToSection",n)}}))},loadNextSection:function(){var e=this;Backbone.pubEv.trigger("loadingShowHide",!0),d.check((function(t){if(t)d.startReconnectCheck();else if(e.clickedNext=!0,e.clickedPrev=!1,sCH.learnEntitySectionsMetaC){var n=sCH.learnEntitySectionsMetaC.getNextSectionId(sCH.readerConfig.currentSectionId);n&&Backbone.pubEv.trigger("skipToSection",n)}}))},updateFlagPositioning:function(){var e=this;this.flagUpdateInProgress||(this.flagUpdateInProgress=!0,window.setTimeout((function(){var t=$(".endSectionQuestions .flagTagContainer");a.each(t,(function(t){var n=$(t);n.css("top",e.$el.find('.flagTag[data-tagid="'+n.data("tagid")+'"]').position().top+9)})),e.flagUpdateInProgress=!1}),1e3))},initProgressBar:function(){var e=s.scrollElement(),t=$(".progress"),n="",i=$(".noteTagContainer:eq(0)"),o=parseInt(i.css("top"))<0;try{sCH.learnEntitySectionsMetaC.validSectionLength>1&&(n='<div class="detail">Section {0}/{1}</div>'.replace("{0}",sCH.learnEntitySectionsMetaC.filter({TextSectionId:sCH.readerConfig.currentSectionId})[0].get("SectionNum")).replace("{1}",sCH.learnEntitySectionsMetaC.validSectionLength))}catch(e){n=""}s.onDevice()||sCH.readerConfig.isAssessment||sCH.readerConfig.isPDF||$(".reader").hasClass("truncated")?(m.supported&&y.ios&&window.navigator.standalone||window.isIOSApp)&&(e.unbind("scroll"),e.scroll(a.debounce((function(){try{m.db.localSettings.put({Key:"readingPositions:"+sCH.readerConfig.assignmentId+":"+sCH.userM.get("UserId"),CreateDate:moment.utc().format("YYYY-MM-DDTHH:mm:ss.SSS"),SectionId:sCH.readerConfig.currentSectionId,ScrollTopPx:Math.floor(e.scrollTop())})}catch(e){console.log("error",e)}}),100))):(e.unbind("scroll"),e.scroll((function(){0===e.scrollTop()&&o&&i.click();var a=Math.max($(".textSection").prop("scrollHeight"),e.prop("scrollHeight")),s=Math.floor(e.scrollTop()/(a-(e.outerHeight()||0))*100);t.html(s+"%"+n).css({opacity:1}),clearTimeout($.data(this,"scrollTimer")),$.data(this,"scrollTimer",setTimeout((function(){t.css({opacity:0})}),1e3))})))},setTextSelectionType:function(e){sCH.readerConfig.textSelectionType="mousedown"===e.type?"mouse":"touch"},initSelection:function(){try{this.isTouchDevice=s.onDevice()||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;var e=this;if(this.isTouchDevice){var t=null;document.onselectionchange=function(n){Backbone.pubEv.trigger("popupAddTagHide"),t&&window.clearTimeout(t),t=window.setTimeout((function(){t=null,sCH.readerConfig&&e.textrange()}),200)},document.ontouchend=function(e){Backbone.pubEv.trigger("menuHyperlinkHide")}}else document.onmouseup=function(t){e.textrange(t)}}catch(e){rg4js("send",{error:new Error("Touch device selection"),customData:e})}},textrange:function(e){if(!(sCH.readerConfig.isAccessExpired||this.isTouchDevice&&e)){if(sCH.readerConfig.isReadOnly)return window.ActivelyRead.showLinkMenu||Backbone.pubEv.trigger("menuHyperlinkHide"),void delete window.ActivelyRead.showLinkMenu;var t=sCH.readerConfig.isPDF?$(".react-pdf__Page__textContent")[0]:this.$el.find(".textSectionContainer")[0],n=e&&$(e.target).hasClass("react-pdf__Page__canvas")||this.$el.find(".react-pdf__message--loading").is(":visible")?null:g.saveSelection(t,this);if(n&&n.start!==n.end&&n.text.trim().length>0){if(sCH.readerConfig.editTextMode&&this.isSelectionContainingMultipleHTMLTags(n,t))return void s.bootstrap.alert({message:"Try highlighting fewer words. Make sure your highlight does not overlap paragraphs, links or notes.",alert:"danger"});if(this.isTouchDevice){var a=rangy.getSelection().getBoundingDocumentRect();Backbone.pubEv.trigger("popupAddTagShow",{sel:n,scope:this.textSectionContainerView,mouseX:a.right,mouseY:a.bottom})}else Backbone.pubEv.trigger("popupAddTagShow",{sel:n,scope:this.textSectionContainerView,mouseX:e.pageX,mouseY:e.pageY})}else Backbone.pubEv.trigger("popupAddTagHide"),window.ActivelyRead.showLinkMenu||Backbone.pubEv.trigger("menuHyperlinkHide"),delete window.ActivelyRead.showLinkMenu,Backbone.pubEv.trigger("flagMenuShowHide",{show:!1})}},addPreReadingQuestion:function(){this.textSectionContainerView.addNewTag({sel:{start:-1,end:-1},Type:"question"}),Backbone.tracking.trackGAEvent("addtag","prereadingquestion")},playEntireText:function(){var e,t=0,n=999999,a=$(".textSection").clone();t+=s.getTagContentLengthByName(a,"style"),t+=s.getTagContentLengthByName(a,"title"),a.find("style,title,video").remove(),a.find(".pnum, .teacherQuestion").remove();var i=s.eStringToString(s.htmlToText(a[0],!1));if(a.find(".whiteout").remove(),0!==(e=s.eStringToString(s.htmlToText(a[0],!0).trim())).length){var o=("student"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type)&&sCH.readerConfig.Settings.QuestionGates&&sCH.questionsNumC.getFirstNotAnsweredQuestion();if(o&&o.TextSectionId===sCH.readerConfig.currentSectionId){if(o.StartIndex===o.EndIndex&&-1===o.EndIndex)return void s.bootstrap.alert({message:"Answer the question to reveal text to be able to hear it.",alert:"danger"});-1!==o.StartIndex&&(n=o.EndIndex,!0)}Backbone.pubEv.trigger("definition_destroy"),Backbone.pubEv.trigger("translate_destroy"),$(".popupNoteMenu").length>0&&$(".popupNoteMenu").css("z-index",0),new v.default({startIndex:t,endIndex:n,selectedText:e,isSelectionInPopup:!1,isPlayEntireText:!0,containerSelectedText:i,isTextGated:!0})}else s.bootstrap.alert({message:"There is no text in this assignment to read aloud!",alert:"danger"})},showAutoGradeOptInPopup:function(){sCH.userM.isOnPrimePlan()&&sCH.userM.showPopup("AutoGradeOptIn")&&"AddFromCatalog"===sCH.learnEntityMetaM.get("LayerSource")&&new Backbone.BootstrapModal({title:"Want to grade short answer responses faster? (beta)",content:"<p>Our A.I. can provide you with suggested grades for popular questions in our assignments.\n          And don't worry, you'll still have the final say on the student's grade.</p>\n          <div class=\"info\">You can always opt in or out later, in the Grading panel -> Actions menu.</div>",cssClass:"modal-al-auto-grade",allowCancel:!1,cancelText:"No thanks",okText:"Let's try this!"}).on("ok",(function(){s.updateDoNotShowPopupSetting("AutoGradeOptIn"),l.UpdateStandaloneSetting({settingKey:"EnableAutoGrading",settings:"true"}),sCH.userM.get("Settings").push({SettingKey:"EnableAutoGrading",Settings:"true"})})).on("cancel",(function(){s.updateDoNotShowPopupSetting("AutoGradeOptIn")})).open()},isSelectionContainingMultipleHTMLTags:function(e,t){return g.restoreSelection(t,e.start,e.end,s.getTextNodes(t)).length>1},destroy:function(){this.textSectionContainerView&&(sCH.readerConfig.isPDF?this.textSectionContainerView.destroyPDF():sCH.readerConfig.isMedia?this.textSectionContainerView.destroyVideo():this.textSectionContainerView.close(!0)),$(".attribution").length&&i.unmountReactComponent($(".attribution")[0]),i.unmountReactComponent($("#joyride")[0])}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(22),i=n(5),o=n(86),r=n(517),l=n(448),d=n(1827),c=n(1854),u=n(1881),p=n(840),h=n(820),g=n(263),f=n(148),m=n(43);t.default=Backbone.View.extend({events:{"click .btnAddAssessmentQuestion":"addAssessmentQuestion","mousedown a.embeddedLink":"handleEmbeddedLinkClick","touchend a.embeddedLink":"handleEmbeddedLinkClick","mousedown a.embeddedLocalLink":"handleEmbeddedLocalLinkClick","click .keyVocabHighlight":"keyVocabHighlightClicked","click .btnWhiteoutVideo":"whiteoutVideo","click .btnAddQuestionInText":"addQuestionInText"},initialize:function(e){var t=this;this.textSectionId=e.model.get("TextSectionId"),this.model=e.model,this.fillTags(),this.tags=new r.default({models:this.tagModels}),sCH.readerConfig.isAssessment&&(Backbone.pubEv.on("saveQuizQuestionComplete",this.saveQuizQuestionComplete,this),Backbone.pubEv.on("handleAssessmentArrows",this.handleAssessmentArrows,this)),"authoring"===sCH.readerConfig.type&&Backbone.pubEv.on("questionDeleted",this.questionDeleted,this),Backbone.pubEv.on("swapQuestionComplete",this.swapQuestionComplete,this),Backbone.pubEv.on("finishAddTag",this.finishAddTag,this),Backbone.pubEv.on("rerenderNotes",this.rerenderNotes,this),Backbone.pubEv.on("renderNewTempNote",this.renderNewTempNote,this),Backbone.pubEv.on("removeNewTempNote",this.removeNewTempNote,this),Backbone.pubEv.on("rerenderTags",this.rerenderTags,this),Backbone.pubEv.on("renderSearchResult",this.renderSearchResult,this),Backbone.pubEv.on("toggleTags",this.toggleTags,this),Backbone.pubEv.on("handleAssessmentArrows",this.handleAssessmentArrows,this),Backbone.pubEv.on("highlightKeyVocabWords",this.highlightKeyVocabWords,this),"student"!==sCH.readerConfig.type&&"studentir"!==sCH.readerConfig.type&&"studentresearch"!==sCH.readerConfig.type&&"authoring"!==sCH.readerConfig.type||this.delegateEvents(a.extend(this.events,{"click img":"handleImageClick"})),$(".btnAddQuestion").on("click",(function(){t.addQuestion()}))},render:function(){var e=this;this.setElement(".reader .textSectionContainer");var t=sCH.learnEntitySectionsC.getTextSectionHtml(sCH.readerConfig.currentSectionId),n=sCH.learnEntitySectionsMetaC.getModelBySectionId(sCH.readerConfig.currentSectionId);n.get("CssClasses")&&this.$el.find(".textSection").addClass(n.get("CssClasses")),this.$el.find(".textSection").html(t),a.each(this.$el.find("a[href]"),(function(e){if(i.isGoogleSection())if(0===$(e).attr("href").indexOf("#"))$(e).data("href",e.href).addClass("embeddedLocalLink");else{var t=e.href.split("?"),n=t.length>1?i.parseQueryString(t[1]).q:e.href;$(e).data("href",n||e.href).addClass("embeddedLink")}e.removeAttribute("href")}));try{$(".textSectionContainer").imagesLoaded((function(){var t=e.$el.find("img");t.length>0&&(i.resizeImages(t,e.$el.width()),"student"!==sCH.readerConfig.type&&"studentir"!==sCH.readerConfig.type&&"studentresearch"!==sCH.readerConfig.type&&"authoring"!==sCH.readerConfig.type||t.css({cursor:"pointer"})),i.onDevice()?setTimeout((function(){Backbone.pubEv.trigger("updateMargin")}),250):Backbone.pubEv.trigger("updateMargin")}),(function(){}))}catch(e){}if("authoring"===sCH.readerConfig.type&&!sCH.readerConfig.isReadOnly)try{a.each($(".textSectionContainer figure.video"),(function(e){$('<a class="btn-box btnWhiteoutVideo"></a>').insertAfter(e)})),a.each($(".textSectionContainer table"),(function(e){$(e).text()&&i.checkIfTextNodeExistsAfter(e)&&$('<a class="btn-box btnAddQuestionInText" data-placement="table"></a>').insertAfter(e)}))}catch(e){}return this.$el},renderPDF:function(e){var t=this;function n(){var n=0,s=window.setInterval((function(){n++;var o=$(".react-pdf__Page__textContent").html();(o&&o.length>0||8===n)&&(window.clearInterval(s),sCH.readerConfig&&(a.includes(["student","studentir","studentresearch","grading"],sCH.readerConfig.type)&&$("img").css({cursor:"pointer"}),t.renderTags(),-1!=sCH.readerConfig.providedScrollTop?(i.scrollElement().scrollTop(sCH.readerConfig.providedScrollTop),sCH.readerConfig.providedScrollTop=-1):e?i.scrollElement().scrollTop(999999):i.scrollElement().scrollTop(0),t.isTouchDevice||$(".pdfviewer").on("mousedown",(function(e){window.ActivelyRead.mousePos=e.pageX+e.pageY})),Backbone.pubEv.trigger("loadingShowHide",!1)))}),250);$.intervals.push(s)}if(this.setElement(".reader .textSectionContainer"),sCH.readerConfig.PDFLoaded)Backbone.pubEv.trigger("pdfPageChange",{pageNumber:this.model.get("SectionNum")}),n();else{if(this.$el.find(".textSection").html('<div class="pdfviewer"></div>'),i.getZoomState((function(e){s.mountReactComponent(d.default,$(".pdfviewer")[0],{fileName:t.model.get("BlobUrl"),pageNumber:t.model.get("SectionNum"),scale:e,onLoadSuccess:function(){sCH.readerConfig.PDFLoaded=!0,n()}})})),!sCH.readerConfig.isReadOnly&&"authoring"==sCH.readerConfig.type&&sCH.userM.showPopup("HowToAuthorPDF")){new Backbone.BootstrapModal({title:"How to customize this PDF assignment",content:"<p>In order to preserve the formatting of PDFs, you can only add questions to the end of each page.</p>          <p>For PDFs with digital text (i.e. not PDFs of scanned images), you can select text within the document to add notes, links and more!</p>",allowCancel:!1,cancelText:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){i.updateDoNotShowPopupSetting("HowToAuthorPDF")}))}if(m&&m.ipad){var o=document.querySelector('meta[name="viewport"]');o&&(sCH.readerConfig.originalViewport=o.content,o.content="width=device-width,minimum-scale=1.0,maximum-scale=2.15"),$(".reader").addClass("pinchtozooming")}}return this.$el},renderMedia:function(){$(".reader").addClass("videoreader"),this.setElement(".reader .textSectionContainer");var e=this.model.get("BlobUrl");"video"===this.model.get("Type")?s.mountReactComponent(c.default,this.$el.find(".textSection")[0],{url:e}):s.mountReactComponent(u.default,this.$el.find(".textSection")[0],{url:e,mediaType:"phet"})},rerenderAssessmentQuestions:function(){this.tags.destroy(),this.tags=new r.default({models:this.tagModels,questionsNumC:sCH.questionsNumC,tagListMode:sCH.readerConfig.isAssessment}),this.$el.html(""),this.renderTags()},rerenderTags:function(){this.tags.destroy(),this.fillTags(),this.tags=new r.default({models:this.tagModels}),this.renderTags()},renderTags:function(){if(!sCH.readerConfig.isAccessExpired){if(sCH.readerConfig.isAssessment&&"authoring"===sCH.readerConfig.type){if(this.tags.render(this.$el),!sCH.readerConfig.isReadOnly){var e=this.$el.find(".teacherQuestion");e.length>0?a.each(e,(function(e,t){$(e).after('<div class="btn-box large btnAddAssessmentQuestion" data-questionorder="'+(t+2)+'">Add Question</div>')})):this.$el.append('<div style="text-align:center;margin-top:20px;">Click \'Add question\' below to get started with your quiz!</div><div class="btn-box large btnAddAssessmentQuestion" data-questionorder="1">Add Question</div>')}this.handleAssessmentArrows()}else this.tags.render(this.$el.find(".textSection"));$(".teacherQuestion [contenteditable]").on("changeHeight",(function(){Backbone.pubEv.trigger("updateMargin")}))}},rerenderNotes:function(e){var t=this;a.filter(this.tagModels,(function(e){("note"===e.get("Type")||"marker"===e.get("Type")&&1===e.get("SubType"))&&t.tags.destroySingle({tagAttr:"TagId",tagId:e.get("TagId")})})),this.fillTags();var n=a.filter(this.tagModels,(function(e){return"note"===e.get("Type")||"marker"===e.get("Type")&&1===e.get("SubType")})),s=e&&!!$(document.activeElement).filter("[contenteditable]").length;this.tags.addModelsAndRender({models:n,element:this.$el},s),-1!==sCH.readerConfig.selectedStudentUserId&&Backbone.pubEv.trigger("toggleStudentTags",{studentUserId:-1,show:!1,sectionId:sCH.readerConfig.currentSectionId})},renderNewTempNote:function(e){this.tagModels.push(e),this.tags.addNewTempNoteAndRender({model:e,element:this.$el})},removeNewTempNote:function(){this.tagModels=this.tagModels.filter((function(e){return 0!==e.get("TagId")})),this.tags.removeNewTempNote()},fillTags:function(){var e=sCH.teacherQuestionsC.getModelsBySectionId(this.textSectionId).concat(sCH.teacherMarkersC.getModelsBySectionId(this.textSectionId));["authoring","grading"].indexOf(sCH.readerConfig.type)>-1&&(sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId]?(e.push(new g.default({Type:"teachingIdeas",TextSectionId:sCH.readerConfig.currentSectionId,StartIndex:0,EndIndex:0,UserId:sCH.userM.get("UserId"),LayerId:"authoring"===sCH.readerConfig.type?sCH.readerConfig.layerId:null,TeachingIdeas:sCH.readerConfig.teachingIdeas[sCH.readerConfig.currentSectionId]})),$(".btnAddTeachingIdeas").text("Edit Teaching Ideas")):$(".btnAddTeachingIdeas").text("Add Teaching Ideas")),e="grading"!==sCH.readerConfig.type||-1===sCH.readerConfig.selectedStudentUserId?e.concat(sCH.teacherNotesC.getModelsBySectionId(this.textSectionId)):e.concat(sCH.teacherNotesC.getModelsBySectionAndStudentId(this.textSectionId,sCH.readerConfig.selectedStudentUserId));var t=[],n=[];if(a.each(e,(function(e){"question"===e.get("Type")&&-1==e.get("StartIndex")&&e.get("EndIndex")>=0?t.push(e):n.push(e)})),e=n.sort((function(e,t){return"question"==e.get("Type")&&"question"==t.get("Type")?e.get("QuestionNum")-t.get("QuestionNum"):e.get("CreateDate")<t.get("CreateDate")?-1:1})).concat(t),"authoring"===sCH.readerConfig.type)this.tagModels=e;else{var s=[];if("grading"===sCH.readerConfig.type)-1===sCH.readerConfig.selectedStudentUserId?s=sCH.studentNotesC.getModelsBySectionId(this.textSectionId,!0).concat(sCH.studentFlagsC.getModelsBySectionId(this.textSectionId)):(s=sCH.studentNotesC.getModelsBySectionAndStudentId(this.textSectionId,sCH.readerConfig.selectedStudentUserId).concat(sCH.studentFlagsC.getModelsBySectionAndStudentId(this.textSectionId,sCH.readerConfig.selectedStudentUserId)),sCH.studentsC.length>0&&!sCH.studentsC.find({UserId:sCH.readerConfig.selectedStudentUserId}).get("IsStruggling")&&(e=e.filter((function(e){return!e.get("IsExtraHelp")}))));else if(-1!==["student","studentir","studentresearch","tour"].indexOf(sCH.readerConfig.type)){var i="student"===sCH.readerConfig.type&&sCH.readerConfig.Settings.AllowStudentSharedNotes||"studentresearch"===sCH.readerConfig.type||"studentir"===sCH.readerConfig.type,o=sCH.allStudentTagsC.getModelsBySectionAndStudentId(this.textSectionId,window.ActivelyRead.currentUserId,!0);(!sCH.readerConfig.Settings.AllowStudentSharedNotes&&0===o.length||sCH.learnEntityMetaM.get("IsQuiz"))&&($(".btnToggleSharedNotes").hide().parent().addClass("nopadding"),$(".btnCollapseExpandNotes").hide()),s=i?sCH.allStudentTagsC.getModelsBySectionId(this.textSectionId).concat(sCH.studentFlagsC.getModelsBySectionId(this.textSectionId)).concat(sCH.studentNotesC.getModelsBySectionId(this.textSectionId)):sCH.studentNotesC.getModelsBySectionId(this.textSectionId).concat(sCH.studentFlagsC.getModelsBySectionId(this.textSectionId)).concat(o)}s=a.sortBy(s,(function(e){try{return e.get("CreateDate").replace("Z","")}catch(t){return e.get("CreateDate")}})),this.tagModels=e.concat(s)}sCH.readerConfig.isAssessment&&(this.tagModels=this.tagModels.sort((function(e,t){return e.get("QuestionNum")-t.get("QuestionNum")})))},toggleTags:function(){-1===sCH.readerConfig.selectedStudentUserId?this.rerenderNotes():Backbone.pubEv.trigger("showStudentTags",{studentUserId:sCH.readerConfig.selectedStudentUserId,assignmentId:sCH.readerConfig.assignmentId})},handleAssessmentArrows:function(){var e=this.$el.find(".teacherQuestion");sCH.readerConfig.isReadOnly?e.find(".questionTagButtons").addClass("displayNone"):e.length>=2?($(e[0]).find(".questionTagButtons .btnQuestionOrderUp").addClass("displayNone"),$(e[e.length-1]).find(".questionTagButtons .btnQuestionOrderDown").addClass("displayNone")):$(e[0]).find(".questionTagOrder").addClass("displayNone")},addNewTag:function(e){var t={TextSectionId:this.textSectionId,StartIndex:e.StartIndex>=0?e.StartIndex:void 0,EndIndex:e.EndIndex,Type:e.Type,HTML:e.HTML,Text:e.Text,LayerId:e.LayerId,Active:!0,AssignmentId:sCH.readerConfig.assignmentId,StudentLayerId:sCH.readerConfig.studentLayerId,SubType:e.SubType,HighlightedText:e.HighlightedText};if("note"===e.Type&&(t.Color=e.Color,t.Category=e.Category,t.IsExtraHelp=e.IsExtraHelp,t.CreatedByCurrentUser=!0,t.WordCount=e.WordCount),"question"===e.Type)t.StartIndex=e.sel.start,t.EndIndex=e.sel.end,t.Type=e.Type,this.finishAddTag(sCH.teacherQuestionsC.addQuestion(t));else{if(null==t.StartIndex||!t.EndIndex||!t.Type)return;var n=void 0;"note"===e.Type?-1!==["tour","student","studentir","studentresearch"].indexOf(sCH.readerConfig.type)?(t.IsPublic=e.IsPublic,n=sCH.studentNotesC):n=sCH.teacherNotesC:n="student"===sCH.readerConfig.type||"tour"===sCH.readerConfig.type?sCH.studentFlagsC:sCH.teacherMarkersC,n.createNewTag(t,!0)}},addNote:function(e){var t;t=-1!==["tour","student","studentir","studentresearch"].indexOf(sCH.readerConfig.type)?sCH.studentNotesC:sCH.teacherNotesC,e.textSectionId=this.textSectionId,t.createNewTag(e,!0)},addQuestion:function(){this.addNewTag({sel:{start:-1,end:$(".endSectionQuestions .teacherQuestion").length},Type:"question"}),Backbone.tracking.trackGAEvent("addtag","endquestion")},addAssessmentQuestion:function(e){this.$el.find(".btnAddAssessmentQuestion").addClass("displayNone"),this.$el.find(".teacherQuestion").addClass("disabled");var t=$(e.currentTarget).data("questionorder");this.addNewTag({sel:{start:t,end:-1},Type:"question"});var n=this.$el.find(".teacherQuestion").last();$(e.currentTarget).before(n),$(e.currentTarget).remove()},addQuestionInText:function(e){if("table"===$(e.currentTarget).data("placement")){for(var t=$(".textSectionContainer")[0],n=$(e.currentTarget).prev().find("tr:last-child"),a=n.children().length-1,s=void 0;!s;){var o=n.children().eq(a);""!==o.text()?s=o[0]:--a<0&&(a=(n=n.prev()).children().length-1)}i.manuallySelectEl(s);var r=f.saveSelection(t,{isTouchDevice:!1,initSelection:function(){}});this.addNewTag({sel:{start:r.end,end:r.end},Type:"question"})}},updateStartIndexAndQuestionNumbers:function(e,t){t.get("StartIndex")<e.length&&(e=e.sort((function(e,t){return e.get("QuestionNum")-t.get("QuestionNum")})),a.each(e,(function(e,t){e.set("StartIndex",t+1),e.set("QuestionNum",t+1)})))},saveQuizQuestionComplete:function(e){this.updateStartIndexAndQuestionNumbers(sCH.questionsNumC.models,e),this.updateStartIndexAndQuestionNumbers(this.tagModels,e),this.rerenderAssessmentQuestions()},swapQuestionComplete:function(e){var t,n=sCH.questionsNumC.find({QuestionTagId:e.questionTagId}),a="up"===e.moveDirection?n.get("QuestionNum")-1:n.get("QuestionNum")+1,s=sCH.questionsNumC.find({QuestionNum:a});if(n&&s){sCH.questionsNumC.swapQuestionAttributes(n,s),t=s.get("QuestionTagId");var i=sCH.teacherQuestionsC.getModelByQuestionTagId(e.questionTagId),o=sCH.teacherQuestionsC.getModelByQuestionTagId(t);sCH.questionsNumC.swapQuestionAttributes(i,o),this.tagModels=this.tagModels.sort((function(e,t){return e.get("QuestionNum")-t.get("QuestionNum")})),sCH.readerConfig.isAssessment?this.rerenderAssessmentQuestions():this.swapIntextQuestion(e.questionTagId,t,e.moveDirection)}},swapIntextQuestion:function(e,t,n){var a=$(".teacherQuestion"),s=a.find("[data-tagid="+e+"]").parent(),i=a.find("[data-tagid="+t+"]").parent();"up"===n?$(i).before(s):$(i).after(s),Backbone.pubEv.trigger("questionNumUpdated",e),Backbone.pubEv.trigger("questionNumUpdated",t)},questionDeleted:function(e){e.questionTagId?this.tagModels=this.tagModels.filter((function(t){return t.get("TagId")!==e.questionTagId})):this.tagModels=this.tagModels.filter((function(e){return null!==e.get("TagId")})),sCH.readerConfig.isAssessment&&(a.each(this.tagModels,(function(e,t){e.set("StartIndex",t+1),e.set("QuestionNum",t+1)})),this.rerenderAssessmentQuestions())},finishAddTag:function(e){var t=void 0!==e.model,n=e.model||e;this.model.get("TextSectionId")===n.get("TextSectionId")&&("question"===n.get("Type")?(this.tags.addModelsAndRender({models:[n],element:this.$el}),Backbone.pubEv.trigger("editNewQuestion"),Backbone.pubEv.trigger("popupAddTagHide")):"note"!==n.get("Type")||t?(this.tags.addModelsAndRender({models:[n],element:this.$el.find(".textSection")}),this.tagModels=this.tagModels.concat(n)):this.rerenderNotes())},renderSearchResult:function(e,t){if(!e.isSelectionInPopup){var n=new l.default({StartIndex:e.startIndex,EndIndex:e.endIndex,Type:t&&t.onlyShowTextSelectionHandles?"textSelectionHandles":"searchResult"});if(new r.default({models:[n]}).render(this.$el.find(".textSection"),!0),!1!==e.scroll){var a=$((t&&t.onlyShowTextSelectionHandles?".textSelectionHandles":".inTextSearchResult")+":eq(0)");a&&("student"===sCH.readerConfig.type&&a.position().top>i.scrollElement().find(".textGatingGate").height()&&(t.gatedSrollMessage?i.bootstrap.alert({message:t.gatedSrollMessage,alert:"danger"}):t.ignoreGating&&(sCH.readerConfig.Settings.QuestionGates=!1,Backbone.pubEv.trigger("questionsTagUnblocker"))),i.viewportSkipToElement(a))}$(".inTextSearchResult").length>0&&(e.notereference?$(".inTextSearchResult").addClass("notereference"):$(".inTextSearchResult").addClass("inverse")),t&&t.onlyShowTextSelectionHandles&&t.invertColor&&$(".textSelectionHandles").addClass("inverse")}},highlightKeyVocabWords:function(e){var t=this;sCH.readerConfig.keyVocabWords.forEach((function(e){if(e.TextSectionId===sCH.readerConfig.currentSectionId){var n=[];h.searchWordsInText(e.Words).forEach((function(e){n.push(new l.default({StartIndex:e.searchOffset.startIndex,EndIndex:e.searchOffset.endIndex,Type:"keyVocab"}))})),new r.default({models:n}).render(t.$el.find(".textSection"))}})),e.shouldAvoidAlert||i.bootstrap.alert({message:"Key vocabulary words are activated!         Look for the pink highlighted words as you read and click to define them."})},handleImageClick:function(e){return a.includes(["student","studentir","studentresearch","grading"],sCH.readerConfig.type)?o.openMediaInPopup($(e.currentTarget).attr("src")):"authoring"!==sCH.readerConfig.type||sCH.readerConfig.isReadOnly||Backbone.pubEv.trigger("popupAddTagShow",{sel:{elementType:"media",el:e.currentTarget},scope:this,mouseX:e.pageX,mouseY:e.pageY}),!1},handleEmbeddedLocalLinkClick:function(e){var t=$(document.getElementById($(e.currentTarget).data("href").split("#")[1]));i.viewportSkipToElement(t)},handleEmbeddedLinkClick:function(e){var t=$(e.target).parents(".embeddedLink").length>0,n=$(e.target).parents(".teacherQuestion").length>0;if(e.currentTarget===e.target||t&&!n){window.ActivelyRead.showLinkMenu=!0;var a=new Backbone.Model;if(a.set("Text",$(e.currentTarget).data("href")),"touchend"===e.type){var s=e.currentTarget.getBoundingClientRect();Backbone.pubEv.trigger("menuHyperlinkShow",{model:a,isEmbeddedLink:!0,left:s.left+30,top:s.bottom-32})}else Backbone.pubEv.trigger("menuHyperlinkShow",{model:a,isEmbeddedLink:!0,top:e.pageY,left:e.pageX});if("touchend"===e.type)return!1}},keyVocabHighlightClicked:function(e){var t=$(e.currentTarget);Backbone.pubEv.trigger("definition_destroy"),Backbone.pubEv.trigger("translate_destroy"),Backbone.pubEv.trigger("texttospeech_destroy",{isFromPopupAddTag:!0}),new p.default({word:t.text(),inQuestionOrNote:!1,startIndex:t.data("startindex"),endIndex:t.data("endindex")}).render()},whiteoutVideo:function(e){var t=$(e.currentTarget).prev().find("iframe"),n=$('.textSectionContainer figure.video iframe[src="'+t.attr("src")+'"]').index(t),a={Type:"marker",IsPublic:!0,LayerId:sCH.readerConfig.layerId,Text:t.attr("src"),StartIndex:n,EndIndex:1,SubType:5};this.addNewTag(a),Backbone.tracking.trackGAEvent("addtag","videoWhiteout")},destroy:function(){sCH.readerConfig.isAssessment&&(Backbone.pubEv.off("handleAssessmentArrows"),Backbone.pubEv.off("saveQuizQuestionComplete")),this.handleTextSectionDestroy()},destroyVideo:function(){s.unmountReactComponent(this.$el.find(".textSection")[0]),this.handleTextSectionDestroy()},destroyPDF:function(){this.unbind(),this.undelegateEvents(),$(".endSectionQuestions").remove(),$(".btnAddQuestion").remove(),$(".resizer").after('<div class="endSectionQuestions sameLocationQuestionsContainer"></div>'),"authoring"!==sCH.readerConfig.type||sCH.readerConfig.isReadOnly||$(".endSectionQuestions").after('<button class="btn-box large btnAddQuestion">Add question(s) to end of page</button>'),this.handleTextSectionDestroy()},destroyOpenPopups:function(){Backbone.pubEv.trigger("definition_destroy"),Backbone.pubEv.trigger("translate_destroy"),Backbone.pubEv.trigger("texttospeech_destroy",{isFromPopupAddTag:!0})},handleTextSectionDestroy:function(){Backbone.pubEv.trigger("forceCloseNote"),Backbone.pubEv.trigger("popupAddNoteHide"),Backbone.pubEv.trigger("texttospeech_destroy"),Backbone.pubEv.trigger("layerTextSectionExcerptClosed"),Backbone.pubEv.off("finishAddTag"),Backbone.pubEv.off("rerenderNotes"),Backbone.pubEv.off("renderNewTempNote"),Backbone.pubEv.off("removeNewTempNote"),Backbone.pubEv.off("rerenderTags"),Backbone.pubEv.off("renderSearchResult"),Backbone.pubEv.off("questionDeleted"),Backbone.pubEv.off("toggleTags"),Backbone.pubEv.off("swapQuestionComplete"),Backbone.pubEv.off("highlightKeyVocabWords"),this.tags.destroy(),this.destroyOpenPopups(),document.onselectionchange=null,document.onmouseup=null}})},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5),r=n(1828),l=r.Document,d=r.Page,c=function(e){function t(t,n){var a=e.call(this,t)||this;return a.onPageChange=function(e){var t=e.pageNumber;a.setState({pageNumber:t})},a.onWidthChange=function(e){var t=e.width;a.setState({width:t})},a.onZoomChange=function(e){var t=e.scaleChange,n=a.state.scale+t;a.setState({scale:n}),o.storeZoomStateToLocalStorage(n),setTimeout((function(){Backbone.pubEv.trigger("rerenderTags")}),1e3)},a.state={scale:a.props.scale||1,pageNumber:a.props.pageNumber,width:a.props.width},Backbone.pubEv.on("pdfPageChange",a.onPageChange),Backbone.pubEv.on("pdfWidthChange",a.onWidthChange),Backbone.pubEv.on("pdfZoomChange",a.onZoomChange),a}return s(t,e),t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("pdfPageChange"),Backbone.pubEv.off("pdfWidthChange"),Backbone.pubEv.off("pdfZoomChange")},t.prototype.render=function(){var e=this.state,t=e.pageNumber,n=e.scale,a=e.width;return i.createElement("div",null,i.createElement(l,{file:this.props.fileName,onLoadSuccess:this.props.onLoadSuccess},i.createElement(d,{scale:n,pageNumber:t,width:a,renderAnnotations:!1})))},t}(i.Component);t.default=c},,,,,function(e,t){e.exports=pdfjsViewer},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(t,n,a,s){return new(a||(a=e))((function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,r)}l((s=s.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(5),d=n(86),c=n(1855),u=n(169),p=n(518),h=n(520),g=n(347),f=n(528),m=n(160),v=n(108),b=n(72),C=n(1880),y=n(8),_=function(e){function t(t,n){var a=e.call(this,t)||this;return a.questionSecondsArray=sCH.questionsNumC.models.map((function(e){return e.get("EndIndex")})),a.isIframeCCUnloaded=!1,a.MAX_MEDIA_WIDTH=1010,a.MIN_MEDIA_WIDTH=375,a.MEDIA_ASPECT_RATIO=1.777,a.fetchCaptions=function(){return i(a,void 0,void 0,(function(){var e,t,n;return o(this,(function(a){switch(a.label){case 0:if(e=this.props.url.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/),!(t=e?e[2]:null))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,u.default.get(alcfg.node.reader.get_video_captions+t+".json")];case 2:return(n=a.sent())&&this.setState({captions:n.data}),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},a.setDidVideoPlayInInterval=function(){sCH.readerConfig.didVideoPlayInInterval=a.state.playing},a.adjustVideoSize=function(){var e=$(".textSection").width()-50;$("#rightPanelContainer").length>0&&(a.MAX_MEDIA_WIDTH=725);var t=Math.max(a.MIN_MEDIA_WIDTH,Math.min(e,a.MAX_MEDIA_WIDTH));a.setState({width:t,height:t/a.MEDIA_ASPECT_RATIO})},a.ref=function(e){a.player=e},a.onReady=function(){window.clearTimeout(a.didVideoLoadTimer),a.adjustVideoSize()},a.onPlay=function(){if(!a.isIframeCCUnloaded)if(a.props.url.indexOf("youtube")>=0||a.props.url.indexOf("youtu.be")>=0){try{a.player.getInternalPlayer().getOptions("captions").length>0&&a.player.getInternalPlayer().unloadModule("captions")}catch(e){}a.isIframeCCUnloaded=!0}else a.isIframeCCUnloaded=!0;a.setState({playing:!0})},a.onStop=function(){a.setState({playing:!1})},a.onDuration=function(e){a.setState({duration:e-1})},a.onStartSeek=function(e){a.setState({seeking:!0})},a.onSeeking=function(e){if(a.state.seeking){var t=$(".progressBarContainer")[0].getBoundingClientRect(),n=window.pageXOffset,s=e.pageX-(t.left+n);s=Math.max(s,0);var i=(s=Math.min(s,t.width))/t.width*a.state.duration;a.checkIfCanSeek(i)?a.setState({playedSeconds:i,showBlocked:!1}):a.setState({showBlocked:!0})}},a.onEndSeek=function(e){a.state.seeking&&(a.player.seekTo(a.state.playedSeconds),a.setState({seeking:!1})),"student"===sCH.readerConfig.type&&a.state.showBlocked&&a.setState({showBlocked:!1})},a.onStartDirectSeek=function(e){if("student"===sCH.readerConfig.type){var t=e.nativeEvent.offsetX/$(".progressBar").width();a.checkIfCanSeek(t*a.state.duration)||a.setState({showBlocked:!0})}},a.onDirectSeek=function(e){if("progressedHandle"!==e.target.className){var t=e.nativeEvent.offsetX/$(".progressBar").width(),n=t*a.state.duration;a.checkIfCanSeek(n)&&(a.player.seekTo(t),a.setState({playedSeconds:n}))}},a.skipToQuestion=function(e){var t=e.currentTarget?parseInt(e.currentTarget.dataset.questiontagid):e.questionTagId,n=sCH.teacherQuestionsC.findWhere({TagId:t}),s=n.get("EndIndex"),i="authoring"===sCH.readerConfig.type||"student"===sCH.readerConfig.type&&(s<=sCH.readerConfig.scrollTopPx||!sCH.readerConfig.Settings.QuestionGates);if("grading"===sCH.readerConfig.type)a.player.seekTo(s),a.setState({playedSeconds:s,playing:!1}),e.currentTarget&&Backbone.pubEv.trigger("gradingClickedQuestion",{questionTagId:t});else if(i)if("student"===sCH.readerConfig.type&&a.state.showQuestion&&$(".questionTagAnswer div[contenteditable]:visible").length&&$(".questionTagAnswer div[contenteditable]:visible").text().length>0&&$(".btnSaveDraft:visible").click(),a.player.seekTo(s),a.state.loaded)a.showQuestion(s,n);else{var o=a;window.setTimeout((function(){o.showQuestion(s,n)}),999)}},a.onProgressNoGating=function(e){var t=Math.round(e.playedSeconds),n=a.questionSecondsArray.indexOf(t),s=n>-1;if("authoring"===sCH.readerConfig.type)if(sCH.readerConfig.isReadOnly&&s){var i=sCH.questionsNumC.models[n].get("QuestionTagId");if(i&&i!==a.state.activeQuestionTagId){var o=sCH.teacherQuestionsC.findWhere({TagId:i});a.showQuestion(t,o)}}else e.showAddQuestionButton=!a.state.showQuestion&&-1===n,a.setState(e);else if("student"===sCH.readerConfig.type&&s){var r=sCH.questionsNumC.findWhere({AnsweredByCurrentUser:0,StartIndex:t});if(r){o=sCH.teacherQuestionsC.findWhere({TagId:r.get("QuestionTagId")});a.showQuestion(t,o)}else a.setState(e)}else a.setState(e)},a.onProgressGating=function(e){if(!a.state.seeking){var t=sCH.questionsNumC.getFirstNotAnsweredQuestion(),n=t?t.EndIndex:99999;if(e.playedSeconds>=Math.min(sCH.readerConfig.scrollTopPx,n)&&(sCH.readerConfig.scrollTopPx=e.playedSeconds,e.playedSeconds>=n)){var s=sCH.teacherQuestionsC.findWhere({TagId:t.QuestionTagId});if(s.get("TagId")!==a.state.activeQuestionTagId)return void a.showQuestion(n,s);a.state.showQuestion&&a.setState({playing:!1,playedSeconds:n})}e.playedSeconds<n&&a.setState(e)}},a.onProgress=function(e){a.state.playing&&a.state.playedSeconds!==Math.round(e.playedSeconds)&&("student"===sCH.readerConfig.type&&sCH.readerConfig.Settings.QuestionGates?a.onProgressGating(e):a.onProgressNoGating(e))},a.showQuestion=function(e,t){var n=sCH.questionsNumC.findWhere({QuestionTagId:t.get("TagId")});a.setState({playing:!1,showQuestion:!0,activeQuestionTagId:t.get("TagId"),showContinueButton:"student"!==sCH.readerConfig.type||!sCH.readerConfig.Settings.QuestionGates||!n.get("IsGated"),showAddQuestionButton:!1,playedSeconds:e});var s="student"===sCH.readerConfig.type?new h.default({model:t,tagListMode:!0}).render():new p.default({model:t,tagListMode:!0}).render();$("#questionTagPlaceholder").html(s)},a.continue=function(){a.setState({playing:!0,showQuestion:!1,showContinueButton:!1,showAddQuestionButton:!0}),"authoring"===sCH.readerConfig.type&&$("#questionTagPlaceholder").empty(),l.scrollElement().scrollTop(0)},a.checkIfCanSeek=function(e){if("student"===sCH.readerConfig.type&&sCH.readerConfig.Settings.QuestionGates){if(0===sCH.questionsNumC.length)return e<=sCH.readerConfig.scrollTopPx;var t=sCH.questionsNumC.getLastAnsweredQuestionEndIndex();return e<=Math.max(sCH.readerConfig.scrollTopPx,null!==t?t:99999)}return!0},a.getQuestionGateTime=function(){if("student"===sCH.readerConfig.type&&sCH.readerConfig.Settings.QuestionGates){var e=sCH.questionsNumC.getFirstNotAnsweredQuestion();return e?e.EndIndex:99999}return 99999},a.responseSubmitted=function(){a.setState({showContinueButton:!0})},a.addQuestion=function(){var e=Math.round(a.state.playedSeconds),t=sCH.teacherQuestionsC.addQuestion({TextSectionId:sCH.readerConfig.currentSectionId,StartIndex:e,EndIndex:e,Type:"question",LayerId:sCH.readerConfig.layerId,Active:!0}),n=new p.default({model:t,tagListMode:!0}).render();$("#questionTagPlaceholder").html(n),Backbone.pubEv.trigger("editNewQuestion"),a.setState({playing:!1,showQuestion:!0,showAddQuestionButton:!1})},a.questionAdded=function(){a.questionSecondsArray=sCH.questionsNumC.models.map((function(e){return e.get("EndIndex")})),a.setState({showContinueButton:!0})},a.questionDeleted=function(){a.questionSecondsArray=sCH.questionsNumC.models.map((function(e){return e.get("EndIndex")})),a.setState({showQuestion:!1,showContinueButton:!1,showAddQuestionButton:!0})},a.onMediaLoadError=function(){d.processMediaURLNotFoundInReader({url:a.props.url,errorSource:"videoReader"})},a.toggleCC=function(){return a.setState({showCC:!a.state.showCC})},a.state={playing:!1,volume:1,muted:!1,loaded:0,duration:0,playbackRate:1,loop:!1,seeking:!1,showAddQuestionButton:!1,showCC:!0,captions:null,width:a.MIN_MEDIA_WIDTH,height:a.MIN_MEDIA_WIDTH/a.MEDIA_ASPECT_RATIO,playedSeconds:0},Backbone.pubEv.on("mediaResponseSubmitted",a.responseSubmitted),Backbone.pubEv.on("saveMediaQuestionComplete",a.questionAdded),Backbone.pubEv.on("questionDeleted",a.questionDeleted),Backbone.pubEv.on("addingQuestionCancelled",a.questionDeleted),Backbone.pubEv.on("skipToVideoQuestion",a.skipToQuestion),Backbone.pubEv.on("setDidVideoPlayInInterval",a.setDidVideoPlayInInterval),Backbone.pubEv.on("rightPanelToggled",a.adjustVideoSize),a.adjustVideoSize=y.debounce(a.adjustVideoSize,50),window.addEventListener("resize",a.adjustVideoSize),a}return s(t,e),t.prototype.componentDidMount=function(){if(this.didVideoLoadTimer=window.setTimeout((function(){v.event.emit(v.events.DIALOG_OPEN,{id:"videoLoadError",content:r.createElement("p",{style:{fontSize:16}},"Video did not load! Your connection may be slow, your school network may be blocking access or video url may be broken. We've been notified and are looking into what went wrong!"),okText:"Close",cancelText:!1})}),7e3),"grading"!==sCH.readerConfig.type){var e=new f.default;e.setElement("div#directionsPlaceholder"),e.renderCurrentSection()}this.adjustVideoSize(),this.fetchCaptions()},t.prototype.componentDidUpdate=function(){this.state.playing&&this.setDidVideoPlayInInterval()},t.prototype.componentWillUnmount=function(){this.setState({playing:!1}),window.clearTimeout(this.didVideoLoadTimer),Backbone.pubEv.off("mediaResponseSubmitted"),Backbone.pubEv.off("saveMediaQuestionComplete"),Backbone.pubEv.off("questionDeleted"),Backbone.pubEv.off("addingQuestionCancelled"),Backbone.pubEv.off("skipToVideoQuestion"),Backbone.pubEv.off("setDidVideoPlayInInterval"),Backbone.pubEv.off("rightPanelToggled",this.adjustVideoSize),window.removeEventListener("resize",this.adjustVideoSize)},t.prototype.render=function(){var e=this,t=this.state,n=t.playing,a=t.volume,s=t.muted,i=t.loop,o=t.playedSeconds,d=t.duration,u=t.playbackRate,p=t.showCC,h=t.captions,f=t.loaded,v=t.width,y=t.height,_=this.props.url,S=l.classNames({mediaContainer:!0,noselect:this.state.seeking}),w=l.classNames({reactPlayer:!0,disabled:this.state.showQuestion&&o>=this.getQuestionGateTime()}),T=l.classNames({"icon-play":!0,disabled:this.state.showQuestion&&o>=this.getQuestionGateTime()}),I="student"===sCH.readerConfig.type?o<1&&$("#directionsPlaceholder .container").length>0:o<1,x=this.state.playing?"Close":"Close and resume video",k="student"===sCH.readerConfig.type?l.classNames({open:this.state.showQuestion||I,hideOverflow:!0}):l.classNames({open:!0}),E=l.classNames({instructions:!0,displayNone:!I}),N=l.classNames({displayNone:I}),A=l.classNames({ccBtn:!0,enabled:p}),M=sCH.questionsNumC.toJSON().filter((function(e){return e.TextSectionId===sCH.readerConfig.currentSectionId}));return r.createElement(r.Fragment,null,r.createElement("div",{className:S,onMouseMove:this.onSeeking,onMouseUp:this.onEndSeek},r.createElement("div",{className:"playAndControls"},r.createElement("div",{className:"playerInnerContainer"},r.createElement(c.default,{ref:this.ref,config:{youtube:{playerVars:{disablekb:1,modestbranding:1,cc_load_policy:3}}},className:w,url:_,playing:n,loop:i,playbackRate:u,volume:a,muted:s,width:v,height:y,onReady:this.onReady,onPlay:this.onPlay,onPause:this.onStop,onEnded:this.onStop,onError:this.onMediaLoadError,onProgress:this.onProgress,onDuration:this.onDuration}),h&&p&&r.createElement(C.default,{captions:h,playedSeconds:o,isPlaying:n,loaded:f})),r.createElement("div",{className:"controls"},!this.state.playing&&r.createElement("div",{onClick:this.onPlay,className:T}),this.state.playing&&r.createElement("div",{onClick:this.onStop,className:"icon-pause"}),r.createElement("div",{className:"progressBarContainer"},r.createElement("div",{className:"progressBar",onMouseDown:this.onStartDirectSeek,onClick:this.onDirectSeek},r.createElement("div",{className:"progressed",style:{width:o/d*100+"%"}}),r.createElement("div",{className:"progressedHandle",style:{left:o/d*100+"%"},onMouseDown:this.onStartSeek}),this.state.showBlocked&&r.createElement("div",{className:"blocked",style:{left:sCH.readerConfig.scrollTopPx/d*100+"%",width:100-sCH.readerConfig.scrollTopPx/d*100+"%"}},r.createElement("span",{className:"icon-lock"}))),M.map((function(t,n){return r.createElement("div",{className:"marker",key:n,style:{left:t.EndIndex/d*100+"%"}},r.createElement("div",{className:"box","data-questiontagid":t.QuestionTagId,onClick:e.skipToQuestion},r.createElement("div",{className:"arrow"}),r.createElement("div",{className:"questionMark"},"?")))}))),r.createElement("div",{className:"time"},g.formatSecondsToTime(o)," / ",g.formatSecondsToTime(d)),h&&r.createElement(b.default,{onClick:this.toggleCC,"aria-label":p?"Disable captions":"Enable captions",buttonClass:A,buttonTitle:p?"Disable captions":"Enable captions"},"CC"))),"grading"!==sCH.readerConfig.type&&r.createElement("div",{id:"rightPanelContainer",className:k},r.createElement("div",{id:"directionsPlaceholder",className:E}),r.createElement("div",{id:"questionTagPlaceholder",className:N}),this.state.showContinueButton&&!I&&r.createElement("button",{id:"btnContinue",className:"btn-box large callout pull-right",onClick:this.continue},x),this.state.showAddQuestionButton&&o>=1&&"authoring"===sCH.readerConfig.type&&!sCH.readerConfig.isReadOnly&&r.createElement("button",{id:"btnAddQuestion",className:"btn-box large callout",onClick:this.addQuestion},"Add question")),r.createElement(m.default,{id:"videoLoadError"})))},t}(r.Component);t.default=_}).call(this,n(21))},,,,,,,,,,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="","authoring"===type&&"addedit"===mode?(__p+='\n    <div class="container addedit">\n        <div contenteditable="true" placeholder="Enter directions for your students. You should add your learning objectives here as well.">'+(null==(__t=directions.text?cH.sanitize(directions.text):"")?"":__t)+'</div>\n\n        <div class="breaker"></div>\n        <div class="questionTagEditMediaContainer displayNone">\n            <input class="txtMedia" placeholder="Input valid URL of an image or video" value="'+(null==(__t=directions.html?cH.sanitize(directions.html):"")?"":__t)+'" />\n            <div class="questionTagMediaContainer embedMediaFullContainer"></div>  \n        </div>\n\n        <div class="questionBtnsContainer">\n            <div class="leftSection">\n                ',!directions.html&&sCH.userM.isOnFreePlan()?__p+='\n                    <span class="btn-box large btnBlockAddMedia">Add Media <span class="icon-premium-lock" /></span>\n                ':__p+='\n                    <span class="btn-box large btnAddMedia">Add Media</span>\n                ',__p+='\n            </div>\n            <div class="rightSection">\n                <span class="btn-box large btnDelete">'+(null==(__t=directions.text?"Delete":"Cancel")?"":__t)+'</span>\n                <span class="btn-box large marginLeft btnDone">Save</span>\n            </div>\n        </div>\n    </div>\n'):"authoring"===type&&_.isEmpty(directions)?__p+='\n    <div class="buttonWithActionIconWrapper">\n        <button class="btn-box large btnAddInstructions">Add Directions For Students</button>\n        <a href="'+(null==(__t=alcfg.helpArticleLink.directions)?"":__t)+'" class="btnInstructionsHelpArticle icon-question-mark-inverse"></a>\n    </div>\n':"view"===mode&&(__p+='\n    <div class="container '+(null==(__t="authoring"!==type||sCH.readerConfig.isReadOnly?"":"editable")?"":__t)+'">\n        <span class="heading">Assignment Directions</span>\n        <div class="questionTagText">'+(null==(__t=directions.text?cH.sanitize(linkify(directions.text)):"")?"":__t)+"</div>\n        ",directions.html&&(__p+='\n            <div class="questionTagHtml embedMediaFullContainer"></div>\n        '),__p+="\n    </div>\n"),__p+="";return __p}},,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=50;t.default=function(e){var t=e.captions,n=e.playedSeconds,i=e.isPlaying,o=e.loaded,r=a.useState(null),l=r[0],d=r[1];return a.useEffect((function(){var e=1e3*n,a=setInterval((function(){if(i&&o&&n>0){for(var a=[],r=0,l=t;r<l.length;r++){var c=l[r];if(c.start<e&&c.end>e){for(var u=[],p=0,h=c.words;p<h.length;p++){var g=h[p];g.start<e&&u.push(g.text)}a.push(u.join(" "))}}d(a.length>0?a.join("<br />"):null),e+=s}}),s);return function(){return clearInterval(a)}}),[n,i]),l&&a.createElement("div",{className:"videoCaptionContainer"},a.createElement("span",{className:"caption",dangerouslySetInnerHTML:{__html:l}}))}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(5),l=n(39),d=n(96),c=n(518),u=n(520),p=n(528),h=n(13).withStyles,g=function(e){function t(t,n){var a=e.call(this,t)||this;return a.showQuestion=function(e){var t=sCH.questionsNumC.findWhere({QuestionNum:e});if(t){var n=("authoring"===sCH.readerConfig.type||!t.get("IsGated"))&&t.get("QuestionNum")<sCH.questionsNumC.length,s=1===e&&(sCH.readerConfig.directions.length>0||"authoring"===sCH.readerConfig.type)||e>1;a.setState({showQuestion:!0,currentQuestionNumber:e,showPreviousButton:s,showNextButton:n,showAddQuestionButton:!n,showDirections:!1});var i=sCH.teacherQuestionsC.findWhere({QuestionNum:e}),o="authoring"===sCH.readerConfig.type?new c.default({model:i,tagListMode:!0}).render():new u.default({model:i,tagListMode:!0}).render();$("#questionTagPlaceholder").html(o),sCH.readerConfig.scrollTopPx=e}else"authoring"!==sCH.readerConfig.type&&"student"!==sCH.readerConfig.type||a.setState({currentQuestionNumber:0,showDirections:!0,showPreviousButton:!1,showNextButton:sCH.questionsNumC.length>0,showAddQuestionButton:0===sCH.questionsNumC.length})},a.previousQuestion=function(){a.showQuestion(a.state.currentQuestionNumber-1)},a.nextQuestion=function(){a.showQuestion(a.state.currentQuestionNumber+1)},a.responseSubmitted=function(){var e=sCH.teacherQuestionsC.findWhere({QuestionNum:a.state.currentQuestionNumber});a.setState({showContinueButton:!0,showNextButton:a.state.currentQuestionNumber<sCH.questionsNumC.length&&!e.get("IsGated")})},a.addQuestion=function(){var e=sCH.teacherQuestionsC.findWhere({QuestionNum:sCH.questionsNumC.length}),t=e?e.get("StartIndex")+1:1,n=sCH.teacherQuestionsC.addQuestion({TextSectionId:sCH.readerConfig.currentSectionId,StartIndex:t,EndIndex:t,Type:"question",LayerId:sCH.readerConfig.layerId,Active:!0}),s=new c.default({model:n,tagListMode:!0}).render();$("#questionTagPlaceholder").html(s),Backbone.pubEv.trigger("editNewQuestion"),a.setState({currentQuestionNumber:sCH.questionsNumC.length+1,showQuestion:!0,showDirections:!1,showPreviousButton:!1,showNextButton:!1,showAddQuestionButton:!1})},a.questionAdded=function(){a.showQuestion(sCH.questionsNumC.length)},a.questionDeleted=function(){a.showQuestion(a.state.currentQuestionNumber-1)},a.questionToNavigateTo=function(e){a.showQuestion(e.target.value)},a.state={showAddQuestionButton:!1,showDirections:!1},Backbone.pubEv.on("mediaResponseSubmitted",a.responseSubmitted),Backbone.pubEv.on("saveMediaQuestionComplete",a.questionAdded),Backbone.pubEv.on("questionDeleted",a.questionDeleted),Backbone.pubEv.on("addingQuestionCancelled",a.questionDeleted),a}return s(t,e),t.prototype.componentDidMount=function(){if(sCH.readerConfig.directions.length>0||"authoring"===sCH.readerConfig.type){var e=new p.default;e.setElement("div#directionsPlaceholder"),e.renderCurrentSection()}this.onMediaLoad()},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("mediaResponseSubmitted"),Backbone.pubEv.off("saveMediaQuestionComplete"),Backbone.pubEv.off("questionDeleted"),Backbone.pubEv.off("addingQuestionCancelled")},t.prototype.onMediaLoad=function(){if("authoring"===sCH.readerConfig.type)this.showQuestion(sCH.readerConfig.scrollTopPx);else if("student"===sCH.readerConfig.type)if(-1===sCH.readerConfig.scrollTopPx)this.showQuestion(sCH.readerConfig.directions.length>0?0:1);else{var e=sCH.questionsNumC.getFirstNotAnsweredQuestion(),t=e&&e.QuestionNum<=sCH.readerConfig.scrollTopPx?e.QuestionNum:sCH.readerConfig.scrollTopPx;this.showQuestion(t)}},t.prototype.render=function(){var e=this.props,t=e.url,n=(e.width,e.height,e.classes),a=r.classNames({mediaContainer:!0}),s="student"===sCH.readerConfig.type?r.classNames({open:this.state.showQuestion||this.state.showDirections,hideOverflow:!0}):r.classNames({open:!0}),c=r.classNames({instructions:!0,displayNone:!this.state.showDirections,media:!0}),u=r.classNames({displayNone:this.state.showDirections}),p=sCH.questionsNumC.filter((function(e){return e.get("IsGated")})).map((function(e){return e.get("QuestionNum")}))[0];return o.createElement("div",{className:a},o.createElement("div",{className:"iframeWrapper"},"image"===this.props.mediaType?o.createElement("img",{src:t,width:"100%"}):o.createElement("iframe",{id:"mediaIframe",src:t,frameBorder:"0",className:"mediaIframe",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})),"grading"!==sCH.readerConfig.type&&o.createElement("div",{id:"rightPanelContainer",className:s},o.createElement("div",{id:"questionTagPlaceholder",className:u}),o.createElement("div",{id:"directionsPlaceholder",className:c}),o.createElement("div",{id:"questionControls",style:{display:"flex",justifyContent:"space-between"}},o.createElement(f,{show:this.state.showPreviousButton,onClick:this.previousQuestion,classes:n}),(this.state.showPreviousButton||this.state.showNextButton)&&o.createElement(d.default,{value:this.state.currentQuestionNumber||0,className:n.questionSelect,onChange:this.questionToNavigateTo,inputProps:{name:"ddlQuestions",id:"ddlQuestions"}},(sCH.readerConfig.directions.length>0||"authoring"===sCH.readerConfig.type)&&o.createElement(l.default,{className:n.filterItems,value:0},"Assignment directions"),sCH.questionsNumC.map((function(e,t){var a=e.get("QuestionNum");return o.createElement(l.default,{key:t,value:a,className:n.filterItems,disabled:!!e.get("IsGated")&&a!==p},"Question ",a)}))),o.createElement(m,i({},this.state,{onAddQuestionClick:this.addQuestion,onNextClick:this.nextQuestion,classes:n}))),this.state.currentQuestionNumber===sCH.questionsNumC.length&&"student"===sCH.readerConfig.type&&o.createElement("div",{className:n.endOfAssignment},"** End of assignment **")))},t}(o.Component),f=function(e){return e.show?o.createElement("div",{onClick:e.onClick,className:["icon-chevron",e.classes.navButton].join(" ")}):o.createElement("div",{style:{width:36}})},m=function(e){return e.showAddQuestionButton&&"authoring"===sCH.readerConfig.type&&!sCH.readerConfig.isReadOnly?o.createElement("div",{onClick:e.onAddQuestionClick,className:["icon-plus",e.classes.navButton].join(" ")}):e.showNextButton?o.createElement("div",{onClick:e.onNextClick,className:["icon-chevron",e.classes.navButton,e.classes.flipped].join(" ")}):o.createElement("div",{style:{width:36}})};t.default=h((function(){return{questionSelect:{fontFamily:"Avenir Next LT W02 Demi","&:before":{borderBottom:"none"}},filterItems:{fontFamily:"AvenirNextLTW02-Medium"},navButton:{padding:"0 5px",cursor:"pointer"},flipped:{transform:"rotate(-180deg)"},endOfAssignment:{fontSize:22,textAlign:"center",fontFamily:"AvenirNextLTW02-Medium",opacity:.18,marginTop:20}}}))(g)},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="container">\r\n    <div class="info">\r\n        <span class="word"></span>\r\n        ',ie||(__p+='\r\n        <span class="icon-speaker btnPlayDefinition"></span>\r\n        '),__p+='\r\n        <a class="pull-right icon-cancel btnClose"></a>\r\n    </div>\r\n\r\n\r\n    <span class="partofspeech"></span>\r\n\r\n    <div class="image"></div>\r\n\r\n    <ul class="definitions"></ul>\r\n\r\n    <div id="divSearchDefinitionContainer">\r\n        <input id="txtDefineNewWord" placeholder="Define a new word..." />\r\n        <span id="btnSearchDefinition" class="btn-box">Submit</span>\r\n    </div>\r\n\r\n    <div class="clearBoth" style="height:20px;"></div>\r\n\r\n    <p>Provided by Merriam-Webster Inc.</p>\r\n</div>';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(841),l=n(842),d=(0,n(13).withStyles)((function(){return{bar:{fontSize:12,marginBottom:40,paddingBottom:15,borderBottom:"solid 1px #CFD8DC"}}})),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={attributions:[]},t}return s(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.mergedContentUrl.replace("mergelayers:","").split(",").map((function(e){return parseInt(e)}));o.GetMultipleAttributionInfo({layerIds:t},(function(t){e.setState({attributions:t})}))},t.prototype.render=function(){var e=this;return i.createElement("ul",null,this.state.attributions.map((function(t,n){if(t.Publisher){var a=void 0;return a=l.attributionInfo.find((function(e){return t.Publisher.includes(e.publisherName)}))?i.createElement(r.default,{publisherName:t.Publisher,author:t.Author,contentUrl:t.ContentUrl,source:t.Source}):i.createElement("div",null,t.Author," - ",t.Publisher),i.createElement("li",{key:n,className:e.props.classes.bar},i.createElement("div",null,t.Title),a)}})))},t}(i.Component);t.default=d(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(22),i=n(86),o=n(522),r=n(840),l=n(1885),d=n(10),c=n(148),u=n(324),p=n(1887);t.default=Backbone.View.extend({template:n(531),sel:{},scope:{},events:{"mousedown .btninsertquestion":"addQuestion","touchend .btninsertquestion":"addQuestion","mousedown .btninsertnote":"addNote","touchend .btninsertnote":"addNote","mousedown .btnhighlightandtakenote":"addNote","touchend .btnhighlightandtakenote":"addNote","mousedown .btninsertlink":"addHyperlink","touchend .btninsertlink":"addHyperlink","mousedown .btnwhiteout":"hideTextOrMedia","touchend .btnwhiteout":"hideTextOrMedia","mousedown .btnidontunderstand":"flagAsDifficult","touchend .btnidontunderstand":"flagAsDifficult","mousedown .btnhearit":"speak","touchend .btnhearit":"speak","mousedown .btndefine:not(.disabled)":"showDefinition","touchend .btndefine:not(.disabled)":"showDefinition","mousedown .btntranslate":"translate","touchend .btntranslate":"translate","mousedown .btnmovestudentshere":"moveStudentsHere","touchend .btnmovestudentshere":"moveStudentsHere","mousedown .btnmovequestionhere":"moveQuestionHere","touchend .btnmovequestionhere":"moveQuestionHere","mousedown .btnreplacehighlightedtext":"replaceHighlightedText","touchend .btnreplacehighlightedtext":"replaceHighlightedText","mousedown .btncancel":"moveQuestionHereCancelled","touchend .btncancel":"moveQuestionHereCancelled","mousedown .btnenlarge":"enlargeImage","touchend .btnenlarge":"enlargeImage"},initialize:function(){this.si=null},render:function(){var e=a.when(sCH.readerConfig.type,{authoring:this.authoringOptions,grading:this.gradingOptions,default:this.studentOptions},this);return this.$el.addClass("popupMenu").html(this.template({options:e})),sCH.readerConfig.assignmentLocked&&"student"===sCH.readerConfig.type&&this.$el.addClass("locked"),sCH.readerConfig.isPDF&&this.$el.find(".arrow").remove(),this.$el},authoringOptions:function(){var e=["Insert question","Insert note","Insert link","Whiteout","Define","Move question here","Cancel","Enlarge","Replace highlighted text"];return sCH.readerConfig.isPDF&&e.shift(),e},studentOptions:function(){var e,t=[{key:"Highlight and take note"}],n="This option has been turned off by your teacher.";if(o.default.canPlay()){var a=void 0;sCH.learnEntityMetaM.get("IsTextToSpeechDisabled")?a="The publisher of this text does not allow text to speech.":sCH.readerConfig.Settings.AllowTextToSpeech||(a=n),e={key:"Hear it",disabled:!!a,disabledClickMsg:a},t.push(e)}e=sCH.readerConfig.Settings.AllowDictionary?{key:"Define"}:{key:"Define",disabled:!0,disabledClickMsg:n},t.push(e);var s=void 0;return sCH.learnEntityMetaM.get("IsTranslationDisabled")?s="The publisher of this text does not allow translating.":sCH.readerConfig.Settings.AllowTranslation||(s=n),e={key:"Translate",disabled:!!s,disabledClickMsg:s},t.push(e),t},gradingOptions:function(){return["Define","Translate","Move students here"]},isAddingNote:function(){return 1!==["authoring","student","tour"].indexOf(sCH.readerConfig.type)&&$(".popupNoteMenu.addNote").is(":visible")&&!$(".popupNoteMenu.addNote").data("tagid")},getBoundingClientRectForSelectionBottom:function(){var e=window.getSelection().getRangeAt(0),t=e.endOffset>0?e.endOffset-1:e.endOffset,n=e.cloneRange();return n.setStart(n.endContainer,t),n.setEnd(n.endContainer,t+1),n.getBoundingClientRect()},show:function(e){if(this.isAddingNote())return a.bootstrap.alert({message:"Your unsaved note needs to be posted or deleted before you can perform another action."}),!1;if(this.sel=e.sel,this.scope=e.scope,this.toggleMenuItemClasses(),0===this.$el.find("a:not(.displayNone)").length)return!1;var t,n,s=$(".headerWrapper").height(),i=$(".reader").hasClass("fixedView"),o=this.getBoundingClientRectForSelectionBottom(),r=i?$(".textview.view").scrollTop():window.pageYOffset,l=this.$el.find(".dropdown-menu"),d=i&&this.sel.isSelectionInFixedMenu,c=0,u=0;"media"===this.sel.elementType||d?(c=e.mouseY,u=e.mouseX,t="fixed"):(c=r+o.bottom-s,u=o.right>0?o.right:0,t="absolute",n=$(window).height()-o.bottom),this.$el.css({display:"block",visibility:"hidden"});var p=l.width(),h=l.outerHeight()||0,g=i?$(".textGatingGate").outerWidth():window.innerWidth,f=u+p>g?u+p-g:0;if(d||(u=f>0?u-20-f:u),"fixed"!==t&&n<h){var m=c-h-o.height;m>0&&(c=m)}this.$el.css({display:"none",visibility:"visible"}).css({top:c+"px",left:(u>0?u:0)+"px",position:t}).fadeIn("fast")},toggleMenuItemClasses:function(){if(this.sel.isSelectionInPopup?this.$el.addClass("questionNoteHighlight"):this.$el.removeClass("questionNoteHighlight"),"media"===this.sel.elementType)this.$el.find("a").addClass("displayNone"),this.$el.find("a.btnwhiteout").removeClass("displayNone"),this.$el.find("a.btnenlarge").removeClass("displayNone");else if("authoring"===sCH.readerConfig.type&&sCH.readerConfig.moveQuestionMode)this.$el.find("a:not(.btnmovequestionhere,.btncancel)").addClass("displayNone"),this.$el.find(".btnmovequestionhere,.btncancel").removeClass("displayNone");else if(sCH.readerConfig.editTextMode)this.$el.find("a:not(.btnreplacehighlightedtext)").addClass("displayNone"),this.$el.find(".btnreplacehighlightedtext").removeClass("displayNone");else{this.$el.find("a:not(.btnmovequestionhere,.btncancel)").removeClass("displayNone"),this.$el.find(".btnmovequestionhere,.btncancel,.btnreplacehighlightedtext").addClass("displayNone"),this.$el.find("a.btnenlarge").addClass("displayNone"),sCH.readerConfig.isPDF&&this.$el.find(".btnwhiteout").addClass("displayNone"),$.trim(this.sel.text).indexOf(" ")>0?this.$el.find(".btndefine").addClass("displayNone"):this.$el.find(".btndefine").removeClass("displayNone"),$.trim(this.sel.text).length>400?this.$el.find(".btntranslate").addClass("displayNone"):this.$el.find(".btntranslate").removeClass("displayNone");var e=this.sel.end-this.sel.start>$.trim(this.sel.text).length+1;if(this.sel.isSelectionInPopup||void 0!==this.sel&&0!==this.sel.end&&!e)this.$el.find("a").removeClass("disabled"),$(".texttospeech .btnPause:visible").length>0||"Loading..."===$(".texttospeech .word").html()?this.$el.find(".btnhearit").addClass("disabled"):this.$el.find(".btnhearit").removeClass("disabled");else a.bootstrap.alert({message:"Make sure the beginning and end of your highlight is a text character, not a space.",alert:"danger"}),this.$el.find("a").addClass("disabled");this.$el.find(".btnhearit").removeClass("displayNone"),""===$.trim(this.sel.text)?this.$el.find(".btndefine").addClass("disabled"):this.$el.find(".btndefine").removeClass("disabled"),$("<div>"+this.sel.range.toHtml()+"</div>").find(".teacherQuestion").length>0&&this.$el.find(".btnwhiteout").addClass("disabled")}},hide:function(){this.scope.isTouchDevice?this.$el.hide():this.$el.fadeOut("fast")},addQuestion:function(e){if($(this.sel.range.startContainer.parentNode).parents("table").length&&new Backbone.BootstrapModal({title:"Placing a question in a table",content:'<p>You placed this question inside a table. The table will automatically reformat to accomodate the question, but this could squish your question or change the column widths of the table.</p><p>If you aren\'t satisfied with the result, try inserting the question below the table using the "Add question here" button below the table.',cancelText:!1}).open(),$(e.currentTarget).hasClass("disabled")||($(".teacherQuestion.pinned").length>0&&$(".teacherQuestion.pinned .btnPin").click(),this.scope.addNewTag({sel:this.sel,Type:"question"}),this.hide(),Backbone.tracking.trackGAEvent("addtag","question")),"touchend"===e.type)return!1},addNote:function(e){if(sCH.readerConfig.assignmentLocked?a.bootstrap.alert({message:"This assignment is locked. No changes may be made.",alert:"danger"}):sCH.readerConfig.activeAddNote&&!1===sCH.readerConfig.activeAddNote.closePopup()||a.promptUnSavedNoteReply()||$(e.currentTarget).hasClass("disabled")||(this.destroyOpenPopups(),a.clearSearchHighlights(),this.newNote=new u.default({sel:this.sel,edit:!1,scope:this.scope}).render(),Backbone.pubEv.trigger("renderSearchResult",{startIndex:this.sel.start,endIndex:this.sel.end,scroll:!1,notereference:!0}),Backbone.tracking.trackGAEvent("addtag","note")),"touchend"===e.type)return!1},replaceHighlightedText:function(){var e=sCH.learnEntitySectionsC.getTextSectionHtml(sCH.readerConfig.currentSectionId),t=$('<div class="tempTextSection"></div>').html(e),n=c.restoreSelection(t[0],this.sel.start,this.sel.end,a.getTextNodes(t[0])),i=$(".editTextPopupContainer");i.length>0&&s.unmountReactComponent(i[0]),i.removeClass("displayNone"),s.mountReactComponent(p.default,i[0],{element:t,range:n,startIndex:this.sel.start,endIndex:this.sel.end,highlightedText:n[0].toString()})},addHyperlink:function(e){if($(e.currentTarget).hasClass("disabled")||(Backbone.pubEv.trigger("popupAddLinkShow",{sel:this.sel,type:"link",edit:!1,scope:this.scope}),Backbone.tracking.trackGAEvent("addtag","link")),"touchend"===e.type)return!1},hideTextOrMedia:function(e){if($(e.currentTarget).hasClass("disabled"))a.bootstrap.alert({message:"You cannot whiteout a question. To whiteout the text around a question, whiteout the text before it and then separately whiteout the text after it.",alert:"danger"});else{var t={Type:"marker",IsPublic:!0};t.LayerId=sCH.readerConfig.layerId,"media"!==this.sel.elementType?(t.StartIndex=this.sel.start,t.EndIndex=this.sel.end,t.SubType=2,Backbone.tracking.trackGAEvent("addtag","whiteout")):(t.Text=this.sel.el.src,t.StartIndex=$('.textSectionContainer img[src="'+this.sel.el.src+'"]').index($(this.sel.el)),t.EndIndex=1,t.SubType=4,Backbone.tracking.trackGAEvent("addtag","mediaWhiteout")),this.scope.addNewTag(t),this.hide()}if("touchend"===e.type)return!1},flagAsDifficult:function(e){if(sCH.readerConfig.assignmentLocked)a.bootstrap.alert({message:"This assignment is locked. No changes may be made.",alert:"danger"});else if(!$(e.currentTarget).hasClass("disabled")){this.destroyOpenPopups();var t=$('<span class="tempFlagPos"></span>');this.range=c.restoreSelection(this.scope.$el[0],this.sel.start,this.sel.end,a.getTextNodes(this.scope.$el[0])),this.range[0].surroundContents(t[0]);var n=t.position().top+9,s=$(".flagTagContainer[data-top='"+n+"']");t.contents().unwrap(),s.length>0?a.bootstrap.alert({message:"You have already flagged this line as difficult. Please edit your existing flag or select a new line.",alert:"danger"}):(a.clearSearchHighlights(),Backbone.pubEv.trigger("popupAddNoteHide"),Backbone.pubEv.trigger("popupAddNoteShow",{sel:this.sel,type:"marker",edit:!1,scope:this.scope}),Backbone.pubEv.trigger("renderSearchResult",{startIndex:this.sel.start,endIndex:this.sel.end,scroll:!1,notereference:!0}),Backbone.tracking.trackGAEvent("addtag","flag")),this.hide()}if("touchend"===e.type)return!1},speak:function(e){if(!this.isItemDisabled(e)){this.isSelectionFromDefineTranslatePopup()||this.destroyOpenPopups(),a.clearSearchHighlights(),Backbone.pubEv.trigger("renderSearchResult",{startIndex:this.sel.start,endIndex:this.sel.end,scroll:!1,isSelectionInPopup:this.sel.isSelectionInPopup}),this.hide();var t="";return t=sCH.readerConfig.isPDF||this.sel.isSelectionInPopup?this.sel.text:a.removeWhiteoutText(".inTextSearchResult.inverse:not(.notereference)"),new o.default({startIndex:this.sel.start,endIndex:this.sel.end,selectedText:this.sel.isSelectionInPopup?t:a.eStringToString(t),isSelectionInPopup:this.sel.isSelectionInPopup,isSelectionInTranslatePopup:!!this.sel.isSelectionInPopup&&this.sel.validNotInTextSelection.hasClass("translation")}),"touchend"!==e.type&&void 0}},showDefinition:function(e){if(!this.isItemDisabled(e))return this.isSelectionFromDefineTranslatePopup()||this.destroyOpenPopups(),a.clearSearchHighlights(),Backbone.pubEv.trigger("renderSearchResult",{startIndex:this.sel.start,endIndex:this.sel.end,scroll:!1,isSelectionInPopup:this.sel.isSelectionInPopup}),new r.default({word:this.sel.text,inQuestionOrNote:this.sel.isSelectionInPopup,startIndex:this.sel.start,endIndex:this.sel.end}).render(),this.hide(),"touchend"!==e.type&&void 0},translate:function(e){if(!this.isItemDisabled(e)){this.isSelectionFromDefineTranslatePopup()||this.destroyOpenPopups(),a.clearSearchHighlights(),Backbone.pubEv.trigger("renderSearchResult",{startIndex:this.sel.start,endIndex:this.sel.end,scroll:!1,isSelectionInPopup:this.sel.isSelectionInPopup});var t="";return t=sCH.readerConfig.isPDF||this.sel.isSelectionInPopup?this.sel.text:a.removeWhiteoutText(".textview .inTextSearchResult.inverse:not(.notereference)"),new l.default({phrase:t,startIndex:this.sel.start,endIndex:this.sel.end,inQuestionOrNote:this.sel.isSelectionInPopup}).render(),this.hide(),"touchend"!==e.type&&void 0}},moveStudentsHere:function(e){if(d.MoveStudentsHere({startIndex:this.sel.start,endIndex:this.sel.end,textSectionId:sCH.readerConfig.currentSectionId,assignmentId:sCH.readerConfig.assignmentId}),this.hide(),a.bootstrap.alert({message:"Your students are being redirected to this part of the text."}),a.intercom("trackEvent","move-students-here"),"touchend"===e.type)return!1},moveQuestionHere:function(e){if(Backbone.pubEv.trigger("moveQuestionHere",{sel:this.sel}),"touchend"===e.type)return!1},moveQuestionHereCancelled:function(e){if(Backbone.pubEv.trigger("moveQuestionHereCancelled"),this.hide(),"touchend"===e.type)return!1},enlargeImage:function(){i.openMediaInPopup(this.sel.el.src)},isItemDisabled:function(e){var t=$(e.currentTarget);if(t.hasClass("optionDisabled")){var n=t.data("disabledclickmsg");return n&&a.bootstrap.alert({message:n,alert:"danger"}),!0}},isSelectionFromDefineTranslatePopup:function(){return this.sel.isSelectionInPopup&&(this.sel.validNotInTextSelection.hasClass("definitions")||this.sel.validNotInTextSelection.hasClass("translation"))},destroyOpenPopups:function(){Backbone.pubEv.trigger("definition_destroy"),Backbone.pubEv.trigger("translate_destroy"),Backbone.pubEv.trigger("texttospeech_destroy",{isFromPopupAddTag:!0})},destroy:function(){this.$el.removeData().unbind(),this.undelegateEvents(),this.unbind()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(10),i=n(129);t.default=Backbone.View.extend({events:{"click .btnClose":"destroy","change .ddlTargetLanguages":"targetLanguageChanged"},template:n(1886),languageMap:{es:"Spanish",fr:"French",de:"German",en:"English",af:"Afrikaans",sq:"Albanian",am:"Amharic",ar:"Arabic",hy:"Armenian",my:"Burmese",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",bg:"Bulgarian",ca:"Catalan",ceb:"Cebuano","zh-CN":"Chinese (Simplified)","zh-TW":"Chinese (Traditional)",co:"Corsican",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",tl:"Filipino",eo:"Esperanto",et:"Estonian",fi:"Finnish",fy:"Frisian",gl:"Galician",ka:"Georgian",el:"Greek",gu:"Gujarati",ht:"Haitian Creole",ha:"Hausa",haw:"Hawaiian",iw:"Hebrew",hi:"Hindi",hmn:"Hmong",hu:"Hungarian",is:"Icelandic",ig:"Igbo",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",jw:"Javanese",kn:"Kannada",kk:"Kazakh",km:"Khmer",ko:"Korean",ku:"Kurdish",ky:"Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mn:"Mongolian",ne:"Nepali",no:"Norwegian",ny:"Nyanja (Chichewa)",ps:"Pashto",fa:"Persian",pl:"Polish",pt:"Portuguese",pa:"Punjabi",ro:"Romanian",ru:"Russian",sm:"Samoan",gd:"Scots Gaelic",sr:"Serbian",st:"Sesotho",sn:"Shona",sd:"Sindhi",si:"Sinhala (Sinhalese)",sk:"Slovak",sl:"Slovenian",so:"Somali",su:"Sundanese",sw:"Swahili",sv:"Swedish",tg:"Tajik",ta:"Tamil",te:"Telugu",th:"Thai",tr:"Turkish",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",vi:"Vietnamese",cy:"Welsh",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",zu:"Zulu"},initialize:function(e){this.phrase=e.phrase,this.selectionIndexes={start:e.startIndex,end:e.endIndex},this.inQuestionOrNote=e.inQuestionOrNote,this.data={},Backbone.pubEv.on("translate_destroy",this.destroy,this)},render:function(){if(this.$el.addClass("translate").html(this.template({languages:this.languageMap})),a.addMediumZIndex(this.$el),this.phrase&&0!==this.phrase.length){var e=a.getCookie("defaultTranslationLanguage")?a.getCookie("defaultTranslationLanguage"):"";e?this.executeTranslateAndFillEl(e):this.show()}else a.bootstrap.alert({message:"The phrase you selected is invalid. Please try again.",alert:"danger"})},targetLanguageChanged:function(e){var t=this.$el.find(".ddlTargetLanguages").val();"-1"!==t&&this.data.TargetLanguage!==t&&this.data.SourceLanguage!==t&&this.executeTranslateAndFillEl(t)},executeTranslateAndFillEl:function(e){var t=this,n={phrase:this.phrase,targetLanguage:e,textSectionId:sCH.readerConfig.currentSectionId,startIndex:this.selectionIndexes.start,endIndex:this.selectionIndexes.end,inQuestionOrNote:this.inQuestionOrNote};"studentir"===sCH.readerConfig.type||"studentresearch"===sCH.readerConfig.type?n.studentLayerId=sCH.readerConfig.studentLayerId:n.assignmentId=sCH.readerConfig.assignmentId,s.Translate(n,(function(n){try{n&&n.Translation?(t.data=n,t.$el.find(".language.source").html((t.languageMap[n.SourceLanguage]||"")+" to "),t.$el.find(".translation").html('<li lang="'+n.TargetLanguage+'">'+n.Translation+"</li>"),t.$el.find(".conjunction").toggle(!!t.languageMap[n.SourceLanguage]),a.setCookie("defaultTranslationLanguage",e)):t.fillElOnError(t.phrase,e,429===n.status),t.show()}catch(e){t.fillElOnError(t.phrase),t.show()}}))},show:function(){var e=a.getCookie("defaultTranslationLanguage");if($("main.scroll .textview.view").append(this.$el),0===$(".scroll .lrContainer > div.right").width()?(this.$el.addClass("bottom"),$(".readerpanel.next").addClass("bottomPopupOpened"),sCH.readerConfig.isPDF||this.$el.css({left:$(".scroll .textSectionContainer").offset().left}),e&&this.$el.find("#translateLanguageSelect").val(e)):(this.$el.find(".ddlTargetLanguages").selectpicker({liveSearch:!0}),e&&(this.$el.find("#translateLanguageSelect").selectpicker("val",e),this.$el.find("#translateLanguageSelect").selectpicker("refresh")),this.$el.removeClass("bottom")),this.$el.show(),"tour"===sCH.readerConfig.type){if(!i.isActionCurrentStep("student reading aid1")&&!i.isActionCurrentStep("student reading aid2"))return void i.blinkStepNumber();i.advance()}},fillElOnError:function(e,t,n){var s=n?"To view more translations, please try on Google Translate: ":"No translation found. Try Google Translate: ",i=a.getCookie("defaultTranslationLanguage"),o='<a target="_blank" href="https://translate.google.com/#auto/'+t+"/"+encodeURIComponent(e)+'"><em>'+e+"</em></a>";this.$el.find(".translation").append("<li>"+s+o+"</li>"),this.$el.find(".ddlTargetLanguages").hide(),this.$el.find(".language.target").html(this.languageMap[i])},destroy:function(){this.$el.unbind(),a.clearSearchHighlights(),Backbone.pubEv.off("translate_destroy",this.destroy,this),$(".translate.bottom").length>0&&$(".readerpanel.next").removeClass("bottomPopupOpened"),this.$el.remove()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){for(var key in __p+='<div class="container" id=\'translateWrapper\'>\n    <div class="panelHeading">\n        <h2>Translate</h2>\n        <a class="icon-cancel btnClose"></a>\n    </div>\n\n    <div class="languages">\n        <span class="language source"></span>\n        <span class="language target"></span>\n        <select id="translateLanguageSelect" class="ddlTargetLanguages">\n            <option value="-1" selected="selected">Select language</option>\n            ',languages)__p+='\n                <option value="'+(null==(__t=key)?"":__t)+'">'+(null==(__t=languages[key])?"":__t)+"</option>\n            ";__p+="\n        </select>\n    \n    </div>\n\n    <ul class=\"translation\"></ul>\n\n    <p class='citation'>Provided by Google</p>\n</div>"}return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(5),l=n(101),d=n(102),c=n(103),u=n(116),p=n(152),h=n(13).withStyles,g=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.onChange=function(e){a.setState({editedHTML:e.target.value})},a.onClose=function(){a.setState({open:!1})},a.getTextSectionNewHtml=function(){var e=$('<span class="textToEdit"></span>');return a.props.range[0].surroundContents(e[0]),a.props.element.find(".textToEdit").html(a.state.editedHTML).contents().unwrap(),a.props.element.html()},a.getIndexAfterRemovingUneditedWordsAtEnds=function(e,t){var n,s,i=a.props.highlightedText.split(" "),o=a.state.editedHTML.split(" "),r=0,l=0;do{i[r]&&o[r]&&i[r]===o[r]?(e+=i[r].length+1,r++,n=!1):n=!0}while(!n);do{i[i.length-l-1]&&o[o.length-l-1]&&i[i.length-l-1]===o[o.length-l-1]?(t-=i[i.length-l-1].length+1,l++,s=!1):s=!0}while(!s);return{startIndex:e,endIndex:t}},a.onSubmit=function(e){e.currentTarget.disabled=!0;var t=a.getTextSectionNewHtml(),n=r.htmlToText($("<div></div>").html(t)[0]),s=r.charCountHtml(a.state.editedHTML)-(a.props.endIndex-a.props.startIndex),i=a.getIndexAfterRemovingUneditedWordsAtEnds(a.props.startIndex,a.props.endIndex),l=i.startIndex,d=i.endIndex;o.EditTextSection({layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId,learnEntityId:sCH.learnEntityMetaM.get("LearnEntityId"),updatedTextSectionText:n,updatedTextSectionHtml:t,highlightedTextOriginalIndex:{start:l,end:d},numCharsToShift:s},(function(){a.setState({open:!1}),window.location.reload()}))},a.state={open:!0,editedHTML:a.props.highlightedText},a}return s(t,e),t.prototype.render=function(){var e,t=this.props.classes,n=r.classNames({"icon-highlighter":!0,"no-hover":!0,highlightIcon:t.highlightIcon}),a=r.classNames(((e={})[t.button]=!0,e["btn-tab"]=!0,e));return i.createElement("div",null,i.createElement(l.default,{open:this.state.open,maxWidth:"md",classes:{container:t.dialogBox}},i.createElement(u.default,{classes:{root:t.dialogTitle}},"Fix errors in highlighted text"),i.createElement(c.default,{classes:{root:t.dialogContent}},i.createElement("div",{className:t.highlightedTextContainer},i.createElement("div",{className:n}),i.createElement("div",{className:t.quotedText},this.props.highlightedText)),i.createElement(p.default,{name:"editedText",autoComplete:"off",onChange:this.onChange,defaultValue:this.props.highlightedText,className:t.inputBox,multiline:!0,fullWidth:!0,autoFocus:!0,rowsMax:10,InputProps:{classes:{root:t.inputBoxRoot,input:t.inputBoxInput},disableUnderline:!0,autoFocus:!0}})),i.createElement(d.default,null,i.createElement("button",{onClick:this.onClose,className:a,color:"primary"},"Cancel"),i.createElement("button",{onClick:this.onSubmit,className:a,color:"primary"},"Done"))))},t}(i.Component);t.default=h({dialogBox:{maxWidth:900,alignItems:"flex-start",margin:"0 auto",marginTop:100},dialogTitle:{padding:15,"& h2":{color:"#000",fontSize:22,fontWeight:400,fontFamily:"Avenir Next LT W02 Demi"}},dialogContent:{paddingTop:0},button:{fontFamily:"Avenir Next LT W02 Demi",fontSize:18,border:"none",color:"#03A9F4",padding:"0 10px"},highlightedTextContainer:{paddingBottom:20,minWidth:450,"& div":{display:"inline","&.icon-highlighter:before":{fontSize:17,color:"#000",lineHeight:1}}},quotedText:{color:"#000",opacity:.7,fontSize:16,marginLeft:10,lineHeight:1.6},inputBox:{background:"#ECEFF1",textAlign:"initial",padding:10,width:"calc(100% - 20px)"},inputBoxInput:{color:"#000",fontFamily:"AvenirNextLTW02-Medium !important",fontSize:16},inputBoxRoot:{"&:before":{border:"none !important"}}})(g)},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=n(5),l=n(48),d=n(1889),c=n(192),u=(0,n(13).withStyles)((function(e){return{wrapper:{display:"flex",alignItems:"center",justifyContent:"left",flexWrap:"wrap",fontFamily:"AvenirNextLTW02-Medium"},contenteditable:{background:"#ECEFF1",color:"#000",textAlign:"initial",minHeight:"50px",padding:"10px","&:after":{fontFamily:"AvenirNextLTW02-Medium",color:"#000",opacity:.38,fontSize:"16px"},"& p":{lineHeight:1.6,fontFamily:"AvenirNextLTW02-Medium",fontSize:"20px"}},container:{width:"100%",border:"2px solid #37474F",padding:"20px 30px",boxSizing:"border-box",fontSize:"18px",marginBottom:"40px"},breaker:{marginTop:"20px",marginBottom:"20px !important",clear:"both",borderTop:"1px solid rgba(0, 0, 0, 0.12)"},textSummaryText:{fontSize:"18px",lineHeight:1.6,"& p":{marginTop:0,marginBottom:0,padding:0}},textSummaryHeading:{textTransform:"uppercase",color:"#000",fontFamily:"Avenir Next LT W02 Bold",fontSize:"12px",marginRight:"10px",opacity:"0.54",letterSpacing:"0.5px",lineHeight:"22px"},lockIcon:{fontSize:"14px !important"},pdf:{width:"100%",textAlign:"center","& .icon-person":{cursor:"pointer",display:"inline-block",margin:"1rem 1rem 1rem 0.5rem",padding:"0.5rem"}},addBtnContainer:{marginBottom:"40px","& .icon-person":{marginLeft:"10px"}},extraHelpIcon:{"&:before":{fontSize:"16px",lineHeight:"16px",verticalAlign:"middle"}}}})),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={summaryText:sCH.readerConfig.textSummaries[sCH.readerConfig.currentSectionId],isEditing:!1},t.updateExternalStuff=function(){r.initTooltips($(t.refs.textSummaryWrapper)),r.initHelpPopover($(t.refs.textSummaryWrapper)),Backbone.pubEv.trigger("updateMargin",{doResizeView:!0})},t.saveTextSummary=function(){var e=t.state.summaryText,n=$("<div>"+e+"</div>").text();n.trim()?n.length>alcfg.TEXT_SUMMARY_CHARACTER_LIMIT?r.bootstrap.alert({alert:"danger",message:"Text cannot be longer than "+alcfg.TEXT_SUMMARY_CHARACTER_LIMIT+" characters."}):o.SaveTextSectionSummary({summaryText:e,layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId},(function(){t.setState({isEditing:!1}),sCH.readerConfig.textSummaries[sCH.readerConfig.currentSectionId]=e})):r.bootstrap.alert({message:"Please enter some text.",alert:"danger"})},t.deleteTextSummary=function(){t.state.summaryText?o.DeleteTextSectionSummary({layerId:sCH.readerConfig.layerId,textSectionId:sCH.readerConfig.currentSectionId},(function(){t.setState({summaryText:null,isEditing:!1}),delete sCH.readerConfig.textSummaries[sCH.readerConfig.currentSectionId]})):t.setState({isEditing:!1})},t.editTextSummary=function(){t.props.isEditingAllowed?t.setState({isEditing:!0}):"authoring"!==sCH.readerConfig.type||sCH.readerConfig.isReadOnly||l.showBuyTeacherPopup({title:"Text Summary"})},t.handleChange=function(e){t.setState({summaryText:e})},t}return s(t,e),t.prototype.componentDidMount=function(){"authoring"!==sCH.readerConfig.type||sCH.userM.isOnPrimePlan()||l.hidePrimeFeatureText($(this.refs.textSummaryText)),this.updateExternalStuff()},t.prototype.componentDidUpdate=function(){this.updateExternalStuff()},t.prototype.render=function(){var e=this.props.classes,t=!this.state.isEditing&&!this.state.summaryText&&!sCH.readerConfig.isReadOnly&&"authoring"===sCH.readerConfig.type;return i.createElement("div",{className:[e.wrapper,"wrapper"].join(" "),ref:"textSummaryWrapper"},this.state.isEditing&&this.props.isEditingAllowed&&i.createElement("div",{className:[e.container,"container"].join(" ")},i.createElement(d.default,{tag:"div",ref:"contenteditable",className:e.contenteditable,text:r.sanitize(this.state.summaryText),onChange:this.handleChange,options:r.getMediumEditorCustomOptions(null,"Enter summary")}),i.createElement("div",{className:e.breaker}),i.createElement("span",{className:"btn-box pull-right large marginLeft btnDone",onClick:this.saveTextSummary},"Save"),i.createElement("span",{className:"btn-box pull-right large btnDelete",onClick:this.deleteTextSummary},this.state.summaryText?"Delete":"Cancel")),!this.state.isEditing&&this.state.summaryText&&i.createElement("div",{className:[e.container,"container"].join(" "),onClick:this.editTextSummary},i.createElement("span",{className:[e.textSummaryHeading,"heading"].join(" ")},("student"===sCH.readerConfig.type?"":"Extra Help ")+"Text Summary"),i.createElement(g,{classes:e}),"authoring"===sCH.readerConfig.type&&!sCH.userM.isOnPrimePlan()&&i.createElement("span",{className:"icon-premium-lock "+e.lockIcon,title:alcfg.freeTeacherTooltipText.textSummary}),i.createElement("div",{className:[e.textSummaryText,"text"].join(" "),ref:"textSummaryText",dangerouslySetInnerHTML:{__html:r.sanitize(this.state.summaryText)}})),t&&i.createElement(h,{classes:e,onClick:this.editTextSummary}))},t}(i.Component),h=function(e){var t=e.classes,n=e.onClick;return i.createElement("div",{className:sCH.readerConfig.isPDF?t.pdf:t.addBtnContainer},i.createElement("button",{className:"btn-box large btnAddTextSummary",onClick:n},"Add extra help summary",!sCH.userM.isOnPrimePlan()&&i.createElement("span",{className:"icon-premium-lock "+t.lockIcon,"data-placement":"left",title:alcfg.freeTeacherTooltipText.textSummary})),i.createElement(g,{classes:t}))},g=function(e){var t=e.classes;return"student"!==sCH.readerConfig.type&&sCH.userM.isOnPrimePlan()&&i.createElement("span",{className:"icon-person "+t.extraHelpIcon,title:alcfg.infoText.generic.extraHelp,onClick:function(e){c.renderManageExtraHelpStudentsPopup(),e.stopPropagation()}})};t.default=u(p)},,,,function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="textGatingGate">\r\n    <div class="textGatingSizeSensor">\r\n        <div class="attribution readerpanel"></div>\r\n        <div class="previous icon-arrowup readerpanel"></div>\r\n\r\n        ',"studentir"===readerType&&!CovidIRStatus||"studentresearch"===readerType||(__p+='\r\n            <div class="instructions readerpanel"></div>\r\n        '),__p+='\r\n\r\n        <div class="textSummary readerpanel"></div>\r\n\r\n        ',isPDF?(__p+='    \r\n            <div class="resizer">\r\n                <div class="textSectionContainer">\r\n                    <div class="textSection"></div>\r\n                </div>\r\n            </div>\r\n            <div class="endSectionQuestions sameLocationQuestionsContainer"></div>\r\n            ',"authoring"!==readerType||isReadOnly||(__p+='\r\n                <button class="btn-box large btnAddQuestion">Add question(s) to end of page</button>\r\n            '),__p+="\r\n        "):(__p+='\r\n            <div class="preReadingQuestionContainer readerpanel">\r\n                ',"authoring"!==readerType||isReadOnly||(__p+='\r\n                    <div class="btn-box large btnAddPreReadingQuestion">Add pre-reading question</div>\r\n                '),__p+='\r\n                <div class="preReadingQuestion"></div>\r\n            </div>\r\n            <div class="textSectionContainer">\r\n                <div class="textSection"></div>\r\n                <div class="endSectionQuestions sameLocationQuestionsContainer"></div>\r\n                ',"authoring"!==readerType||isReadOnly||(__p+='\r\n                    <button class="btn-box large btnAddQuestion">Add question to end of section</button>\r\n                '),__p+="\r\n            </div>\r\n        "),__p+='\r\n\r\n        <div class="next icon-arrowdown readerpanel"></div>\r\n    </div>\r\n</div>';return __p}},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="instructions readerpanel"></div>\r\n\r\n<div class="textSectionContainer"></div>\r\n<div class="next last readerpanel"></div>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(532);t.default=a.default.extend({renderChildEl:function(){this.$el.append(this.modalBackgroundV.render(),this.menuHyperlinkV.renderAuthoring())}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({initialize:function(){this.$mainBody=$("body")},events:{click:"backgroundClicked"},render:function(){return this.$el.addClass("modalBackground"),this.$el},show:function(){this.$el.show(),a.onDevice()&&this.$el.bind("touchmove",!1)},hide:function(){this.$el.hide(),a.onDevice()&&this.$el.unbind("touchmove")},backgroundClicked:function(){a.onDevice()||Backbone.pubEv.trigger("closePopup")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(168);t.default=Backbone.View.extend({template:n(1897),initialize:function(e){this.on("ok",this.saveLink),this.on("initialized",this.modalInitialized),this.obj=e},modalInitialized:function(e){this.modal=e,a.bindTouchMove(this.$el,$("#content")),this.modal.$el.on("hidden.bs.modal",(function(e){a.unbindTouchMove($("#content")),Backbone.pubEv.trigger("popupAddLinkHide")})),Backbone.pubEv.once("closePopup",this.modal.close,this.modal)},render:function(){return this.$el.addClass("popupAddHyperlink").html(this.template()),this.obj.edit?this.$el.find('input[name="hyperlink"]').val(this.obj.model.get("Text")):this.$el.find('input[name="hyperlink"]').val(""),this},saveLink:function(e){this.modal.preventClose();var t={},n=this.$el.find('input[name="hyperlink"]').val(),a=/(ftp|http|https):\/\//;a.test(n)||(n=n.replace(/^(h?t|f)t?p(s)?:?(\/?\/?)?/g,"http$2://"),a.test(n)||(n="http://"+n)),s.checkUrl(n)?(this.modal.disableOk("Saving..."),t.Text=n,t.LayerId=sCH.readerConfig.layerId,t.Type="marker",t.SubType=3,this.obj.edit?this.obj.model.saveData({Text:t.Text}):(t.StartIndex=this.obj.sel.start,t.EndIndex=this.obj.sel.end,this.obj.scope.addNewTag(t)),this.modal.close()):this.$el.find('input[name="hyperlink"]').addClass("flash")}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<input name="hyperlink"  type="text" />';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(168);t.default=Backbone.View.extend({template:n(531),model:{},initialize:function(){},render:function(){return this.$el.addClass("popupMenu").html(this.template({options:["Go to link"]})),this.$el},renderAuthoring:function(){var e=["Go to link"];return sCH.readerConfig.isReadOnly||(e.push("Edit link"),e.push("Delete link")),this.$el.addClass("popupMenu").html(this.template({options:e})),this.$el},show:function(e){e.isEmbeddedLink?this.$el.find(".btneditlink, .btndeletelink").hide():this.$el.find(".btneditlink, .btndeletelink").show(),this.$el.css({top:e.top+35+"px",left:e.left-35+"px"}).fadeIn("fast"),this.model=e.model},hide:function(){this.$el.fadeOut("fast")},events:{"click .btngotolink":"goToLink","click .btneditlink":"editLink","click .btndeletelink":"deleteLink"},goToLink:function(){var e=this.model.get("Text");s.checkUrl(e)&&a.windowOpen(e),this.hide()},editLink:function(){Backbone.pubEv.trigger("popupAddLinkShow",{edit:!0,model:this.model}),this.hide()},deleteLink:function(){var e=this;new Backbone.BootstrapModal({title:alcfg.confirmsText.linkDelete,content:"",cssClass:"modal-al-delete-link",okText:"Delete"}).open((function(){e.model.id=e.model.get("TagId"),e.model.deleteData()})),this.hide()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.View.extend({template:n(531),gradingFlagTemplate:n(1900),initialize:function(){},studentRender:function(){return this.$el.addClass("popupMenu").html(this.template({options:["Delete flag"]})),this.$el},gradingRender:function(e){return this.$el.addClass("popupMenu"),this.$el},show:function(e){this.obj=e,"grading"===sCH.readerConfig.type&&this.gradingShow(e);var t=$(".flagTagContainer[data-top='"+e.top+"']").offset(),n=t.top,a=t.left+3;this.scope=e.scope,this.$el.css({top:n+38+"px",left:a+"px"}).fadeIn("fast")},gradingShow:function(e){var t=$(".flagTagContainer[data-top='"+e.top+"']").find(".names").html();this.$el.html(this.gradingFlagTemplate({names:t}))},hide:function(){this.$el.fadeOut("fast")},events:{"click .btndeleteflag":"deleteFlag","click .btnGotoFlagNote":"gotoFlagNote"},deleteFlag:function(){this.scope.model.deleteData(),Backbone.pubEv.trigger("updateMargin"),this.hide()},gotoFlagNote:function(e){var t=$(e.currentTarget).children().data("tagid"),n=sCH.studentFlagsC.filter({TagId:t})[0].get("AssociatedNoteTagId"),a=sCH.studentNotesC.filter({TagId:n});a.length>0&&Backbone.pubEv.trigger("popupFullNoteShow",{model:a[0],scope:{tagListMode:!1,tagContainer:$(".flagTagContainer[data-top='"+this.obj.top+"']")}})}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="dropdown flagDropdown">\n    <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="btnHelp">\n        <li data-action="helpCenter"><a>Help center</a></li>\n    </ul>\n</div>\n';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(523),s=n(1902);t.default=a.default.extend({postInitialize:function(e){this.panel=e.panel,sCH.readerConfig.type="grading",sCH.readerConfig.assignmentId=e.assignmentId,sCH.readerConfig.selectedStudentUserId=parseInt(e.studentUserId)||-1,Backbone.pubEv.trigger("loadingShowHide",!0),Backbone.pubEv.on("showStudentTags",(function(e){Backbone.pubEv.trigger("rerenderNotes")}),this),this.loadReaderData()},render:function(){sCH.learnEntityMetaM.attributes.LearnEntityId&&sCH.learnEntitySectionsMetaC.validSectionLength&&(sCH.readerConfig.popUpsWrapperController=new s.default,this.scroll.render(),this.scroll.renderSection(),sCH.readerConfig.initialRender=!0),this.panel?this.reader.header.toggleView(this.panel,!0):this.reader.header.toggleView("notes",!1),sCH.readerConfig.isAccessExpired&&$(".reader").addClass("accessExpired grading")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(532);t.default=a.default.extend({renderChildEl:function(){this.$el.append(this.modalBackgroundV.render(),this.menuHyperlinkV.render(),this.popupFlagMenuView.gradingRender())}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(523),o=n(1904),r=n(149);t.default=i.default.extend({postInitialize:function(e){this.panel=e.panel,sCH.readerConfig.type=e.type,"studentresearch"===sCH.readerConfig.type&&$(".reader").addClass("research"),"student"===e.type||"tour"===e.type?sCH.readerConfig.assignmentId=e.assignmentId:sCH.readerConfig.studentLayerId=e.studentLayerId,sCH.readerConfig.selectedStudentUserId=-1,e.hasOwnProperty("isReadOnly")&&(sCH.readerConfig.isReadOnly=!0),Backbone.pubEv.trigger("loadingShowHide",!0),a.includes(["student","tour","studentir"],sCH.readerConfig.type)&&(Backbone.pubEv.on("questionsTagBlocker",this.questionsTagBlocker,this),Backbone.pubEv.on("questionsTagUnblocker",this.questionsTagUnblocker,this)),Backbone.pubEv.on("configureAssignmentLock",this.configureAssignmentLock,this);$(["/img/CheckmarkBlack.png","/img/TextSettings_SizeS_Gray.png","/img/TextSettings_SizeS_White.png","/img/TextSettings_SizeM_Gray.png","/img/TextSettings_SizeM_White.png","/img/TextSettings_SizeL_Gray.png","/img/TextSettings_SizeL_White.png","/img/TextSettings_ThemeLight_White.png","/img/TextSettings_ThemeLight_Gray.png","/img/TextSettings_ThemeDark_White.png","/img/TextSettings_ThemeDark_Gray.png"]).each((function(){$("<img />").attr("src",this)})),r.sendAndClearRequestsFromLocalStorage(),this.loadReaderData()},render:function(){sCH.readerConfig.isAssessment&&(Backbone.pubEv.off("questionsTagBlocker"),Backbone.pubEv.off("questionsTagUnblocker")),sCH.learnEntityMetaM.attributes.LearnEntityId&&sCH.learnEntitySectionsMetaC.validSectionLength&&(sCH.readerConfig.popUpsWrapperController=new o.default,this.scroll.render(),this.scroll.renderSection(),sCH.readerConfig.initialRender=!0),this.panel?this.reader.header.toggleView(this.panel,!0):this.reader.header.toggleView("notes",!1),sCH.readerConfig.isAccessExpired&&$(".reader").addClass("accessExpired")},configureAssignmentLock:function(e){var t=moment.utc(sCH.learnEntityMetaM.get("CurrentDate")),n=s.getAssignmentLockState({lockStartDate:sCH.learnEntityMetaM.get("LockStartDate"),lockEndDate:sCH.learnEntityMetaM.get("LockEndDate"),unlockStartDate:sCH.learnEntityMetaM.get("UnlockStartDate"),unlockEndDate:sCH.learnEntityMetaM.get("UnlockEndDate"),currentUtc:t});if(n.noLockSet||n.isLockExpired)sCH.readerConfig.assignmentLocked?this.setLockUnlockTimer(1,!1):this.lockAssignmentTimer&&window.clearTimeout(this.lockAssignmentTimer),sCH.readerConfig.assignmentLocked=!1;else{if(n.isLocked){if(!(sCH.readerConfig.assignmentLocked||e&&e.assignmentInit))return void this.setLockUnlockTimer(1,!0);if(sCH.learnEntityMetaM.get("IsQuiz")||sCH.readerConfig.isAssessment)return s.bootstrap.alert({message:alcfg.alertsText.lockedQuiz,alert:"danger"}),void window.setTimeout((function(){window.location.hash=s.getReaderExitUrl()}),2e3);if(sCH.readerConfig.assignmentLocked||(sCH.readerConfig.assignmentLocked=!0,s.bootstrap.alert({message:"This assignment is currently locked. You may no longer answer questions or take notes."})),n.lockEndDate&&n.lockEndDate.isAfter(t)||n.unlockStartDate&&n.unlockStartDate.isAfter(t)){var a=n.lockEndDate?n.lockEndDate.diff(t):n.unlockStartDate.diff(t);this.setLockUnlockTimer(a,!1)}}else if(sCH.readerConfig.assignmentLocked)this.setLockUnlockTimer(1,!1);else{var i=n.lockStartDate?"lock":n.unlockEndDate?"unlock":null,o="lock"===i&&n.lockStartDate.isAfter(t)?n.lockStartDate:"unlock"===i&&n.unlockEndDate.isAfter(t)?n.unlockEndDate:null,r=o?o.diff(t):null;r&&(sCH.readerConfig.futureLockState={lockType:"lock",lockOrUnlockChangeDate:moment(moment.utc(o).toDate()).format("MM/DD/YY h:mm a")},this.setLockUnlockTimer(r,!0))}}},setLockUnlockTimer:function(e,t){this.lockAssignmentTimer&&window.clearTimeout(this.lockAssignmentTimer),e&&e<2147483647&&(this.lockAssignmentTimer=window.setTimeout((function(){new Backbone.BootstrapModal({title:"Actively Learn needs to reload",content:t?alcfg.alertsText.lockAssignmentMessage:alcfg.alertsText.unlockAssignmentMessage,cssClass:"modal-al-reload-lock",allowCancel:!1,cancelText:!1}).open((function(){window.location.reload(!0)}))}),e))},questionsTagBlocker:function(){if(sCH.readerConfig.assignmentLocked)$("main.scroll .textview").trigger("gated");else if(sCH.teacherQuestionsC&&$(".scroll .lrContainer > .left .textview").is(":visible")){var e=this,t=sCH.questionsNumC.getFirstNotAnsweredQuestion();if(t){if(t.TextSectionId===sCH.readerConfig.currentSectionId)if(sCH.readerConfig.isPDF){if(sCH.readerConfig.Settings.QuestionGates){var n=this.scroll.$el.find('.questionTagViewMode[data-tagid="'+t.QuestionTagId+'"]').parent();n.show().prevAll().show(),n.nextAll().hide(),this.scroll.$el.find(".next").hide()}}else Backbone.pubEv.trigger("getGateTag",{QuestionTagId:t.QuestionTagId,callback:function(t){e.resizeTextContainer(t)}});else this.questionsTagUnblocker(),$("main.scroll .textview").trigger("gated");this.disableTocSections(t.TextSectionId)}else e.questionsTagUnblocker(),$("main.scroll .textview").trigger("gated"),e.disableTocSections(-1)}},questionsTagUnblocker:function(){if($(".reader").removeClass("questionblock"),$(".scroll .lrContainer > .left .textview, .scroll .lrContainer > .left .textview .textGatingGate").css("height","auto"),sCH.readerConfig)if(sCH.readerConfig.isPDF)this.scroll.$el.find(".teacherQuestion").show(),this.scroll.$el.find(".next").show();else{var e=$(".scroll .lrContainer > .left .textview").height();$(".scroll .lrContainer > .right").css("height",e)}},resizeTextContainer:function(e){if(sCH.readerConfig.Settings.QuestionGates&&!sCH.readerConfig.isPDF){var t=e.parent(".preReadingQuestion").length>0,n=$(".scroll .lrContainer > .left .textview .textSectionContainer")[0].offsetTop,a=n,s=e[0].closest("table");if(s){var i=e[0].closest("tr"),o=(i?i.offsetTop:0)+e[0].offsetTop;a+=Math.ceil(o+s.offsetTop+e.outerHeight(!0))}else t||(a+=Math.ceil(e.position().top+e.outerHeight(!0)));!t&&e.position().top<=0&&(a="auto",n=0),$(".reader").addClass("questionblock"),$(".scroll .lrContainer .textview .textGatingGate").css("height",a),$(".scroll .lrContainer > .right").css("height",a),$("main.scroll .textview").trigger("gated")}else $("main.scroll .textview").trigger("gated")},disableTocSections:function(e){if(sCH.readerConfig&&sCH.readerConfig.Settings&&sCH.readerConfig.Settings.QuestionGates){if(-1===e)return void $(".sectionsDropdown li a").removeClass("disabled");var t=sCH.learnEntitySectionsMetaC.filter({TextSectionId:e})[0].get("SectionNum");a.each($(".sectionsDropdown li"),(function(e,n){$(e).data("order")>t?$(e).find("a").removeClass("enabled").addClass("disabled"):$(e).find("a").removeClass("disabled").addClass("enabled")}))}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(532);t.default=a.default.extend({renderChildEl:function(){this.$el.append(this.modalBackgroundV.render(),this.menuHyperlinkV.render(),this.popupFlagMenuView.studentRender())}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrContainer on">\r\n    <div class="left">\r\n        <div class="textview view"></div>\r\n    </div>\r\n    <div class="right">\r\n        <div class="notesview view" id="notesView"></div>\r\n        <div class="gradingview view"></div>\r\n        <div class="dataview view"></div>\r\n    </div>\r\n</div>';return __p}},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={visible:!1},t.showHide=function(e,n){void 0!==t.showTimer&&window.clearTimeout(t.showTimer),e?t.show(n):t.hide()},t.show=function(e){var n=void 0!==e?e:12e3;t.setState({visible:!0});var a=t;t.showTimer=window.setTimeout((function(){a.hide()}),n)},t.hide=function(){return t.setState({visible:!1})},t}return s(t,e),t.prototype.componentDidMount=function(){Backbone.pubEv.on("loadingShowHide",this.showHide,this)},t.prototype.componentWillUnmount=function(){Backbone.pubEv.off("loadingShowHide",this.showHide,this)},t.prototype.render=function(){return i.createElement("div",{className:"loading",style:{display:this.state.visible?"block":"none"}},i.createElement("div",{className:"modalBackground",style:{display:this.state.visible?"block":"none"}}),i.createElement("div",{className:"spinner"}))},t}(i.Component);t.default=o},function(e,t,n){"use strict";var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(10),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={shouldShowProductBanner:!0,productUpdate:null},t.hideBanner=function(e){document.body.classList.remove("productUpdatesBannerShown"),t.setState({shouldShowProductBanner:!1});var n=$(e.currentTarget).data("productupdatemessageid");o.MarkProductUpdateMessageSeen({productUpdateMessageId:n},(function(){sCH.userM.unset("UserProductUpdateMessage")}))},t}return s(t,e),t.prototype.componentDidMount=function(){this.setState({productUpdate:sCH.userM.get("UserProductUpdateMessage")})},t.prototype.render=function(){var e=this.state,t=e.shouldShowProductBanner,n=e.productUpdate;return t&&n&&i.createElement("div",{id:"productUpdatesBanner"},i.createElement("div",{className:"message"},n.Message),n.LearnMoreLink&&i.createElement("a",{className:"btn-box btnLearnMore",href:n.LearnMoreLink,target:"_blank","aria-label":n.Message+", Learn more"},"Learn more"),i.createElement("button",{className:"btnClose icon-cancel","data-productupdatemessageid":n.ProductUpdateMessageId,onClick:this.hideBanner,"aria-label":"Cancel"}))},t}(i.Component);t.default=r},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1910),s=n(5),i=n(129),o=n(85),r=n(8);t.default=Backbone.Router.extend({routes:{"":"redirect",account:"account",account2:"account2",account3:"account3","account?*queryString":"account","teacher/profile/:tab":"profile","teacher/classes(/:classId)(/:tab)(/:subtab)(/?*queryParams)":"teacherClasses","teacher/workspace(/:folderId)(/?:queryParams)":"teacherWorkspace","teacher/catalog(/:topicSlug)(/:topicBucketSlug)(/?:queryParams)":"teacherCatalog","teacher/schoollibrary(/:folderId)":"teacherWorkspace","teacher/data(/:tab)(/:studentId)":"teacherData","teacher/switchrole":"teacherSwitchRole","teacher/ir/catalog(/:learnEntityId)(/?*queryParams)":"teacherIRCatalog","teacher/reader/tour/:assignmentId(/:panel)":"teacherReaderTour","teacher/reader/preview/:layerId(/:panel)":"teacherReaderPreview","teacher/reader/authoring/preview/:layerId(/:panel)":"teacherReaderPreview","teacher/reader/authoring/preview/:layerId(/:panel)/(?*queryParams)":"teacherReaderPreview","teacher/reader/authoring/:layerId(/:panel)(/?:queryParams)":"teacherReaderAuthoring","teacher/reader/learning/:assignmentId(/:panel)":"teacherReaderLearning","teacher/reader/research/preview/:studentlayerId(/:panel)":"teacherResearchPreview","teacher/reader/grading/:assignmentId(/:panel)(/?*queryParams)":"teacherReaderGradingSkipToTag","teacher/mathreader(?:queryParams)":"mathReader","teacher/school(/:subview)(/:tab)(/:subtab)(/?*queryParams)":"adminSchool","teacher/teachers(/:subview)":"adminTeachers","teacher/standards":"adminStandards","teacher/manage(/:subview)":"manage","teacher/professionallearning(/:tab)(/:practice)(/:activity)":"professionalLearning","student/profile/:tab":"profile","student/classes(/:classId)(/:tab)(/:subtab)":"studentClasses","student/reader/ir/:studentLayerId(/:panel)":"studentReaderIr","student/reader/research/:studentLayerId(/:panel)":"studentReaderResearch","student/reader/:assignmentId(/:panel)":"studentReader","student/mathreader(?:queryParams)":"mathReader","student/data":"studentData","student/bookshelf(/:learnEntityId)":"studentBookshelf","student/research":"studentResearch","student/catalog(/:learnEntityId)(/?*queryParams)":"studentCatalog","student/readinglog":"studentReadingLog","student/switchrole":"studentSwitchRole","teacher/assessments/authoring/:layerId":"redirectLegacyAssessmentUrl","teacher/assessments/grading/:assignmentId(/:panel)":"redirectLegacyAssessmentUrl","student/assessments/:assignmentId":"redirectLegacyAssessmentUrl",404:"pageNotFound","*notFound":"notFound"},execute:function(e,t,n){o.anonAndRoleChecks(n)&&e&&e.apply(this,t)},initialize:function(){this.app=new a.default,this.on("all",this.storeRoute),this.route(/admin(.*)/,"redirectAdmin",this.redirectAdmin),this.route(/districtadmin(.*)/,"redirectAdmin",this.redirectAdmin)},redirectAdmin:function(){s.redirectUserByHash(window.location.hash.replace("districtadmin","teacher").replace("admin","teacher"))},storeRoute:function(){this.previousFragment=Backbone.history.fragment},redirect:function(){s.redirectUserByUrl(sCH.userM.get("Url")||"/account.html")},hashChange:function(e){if($.xhrPool.abortAll(),$.timeouts.abortAll(),$.intervals.abortAll(),Backbone.pubEv.trigger("loadingShowHide",!1),window.gaTrackPageview(),$(".alert").remove(),i.isTourRunning&&-1===window.location.hash.indexOf("tour/"+alcfg.tourAssignmentId))return e.preventDefault(),void i.confirmRouteChange(Backbone.history.fragment);if((location.hash.substr(1)!==Backbone.history.fragment&&void 0!==Backbone.Bootstrap&&void 0!==Backbone.Bootstrap.modals&&r.each(Backbone.Bootstrap.modals,(function(e,t){e.close(),delete Backbone.Bootstrap.modals[t]})),Backbone.history.fragment.indexOf("reader")>=0&&window.location.hash.indexOf("reader")<0&&Backbone.router.app.readerPage)&&!Backbone.router.app.readerPage.textView.hashChange())return s.redirectUserByHash(Backbone.history.fragment),void e.stopImmediatePropagation();s.intercom("update"),s.adjustHeaderSpacing()},redirectLegacyAssessmentUrl:function(){var e=window.location.hash;e=(e=e.replace("assessments/preview","reader/authoring/preview")).replace("assessments","reader"),s.redirectUserByHash(e)},account:function(e){s.redirectUserByUrl("/account.html"+(e?"?"+e:""))},account2:function(e){s.redirectUserByUrl("/account.html"+(e?"?"+e:""))},account3:function(e){s.redirectUserByUrl("/account.html"+(e?"?"+e:""))},profile:function(e){this.app.profile(e)},teacherClasses:function(e,t,n,a){var i=s.parseQueryString(a).studentuserid;this.app.teacherClasses(parseInt(e),t,n,parseInt(i))},teacherWorkspace:function(e,t){s.redirectUserByHash("teacher/catalog")},teacherCatalog:function(e,t,n){"news-and-popular-articles"===e&&(e="news-and-articles"),this.app.teacherCatalog(e,t,n)},teacherData:function(e,t){s.redirectUserByHash("teacher/classes")},teacherSwitchRole:function(){this.app.switchRole({switchTo:"student"})},teacherReaderAuthoring:function(e,t){if(isNaN(e)){if("preview"===e&&!isNaN(t))return this.teacherReaderPreview(t,e);s.redirectUserByHash("")}this.app.reader({layerId:e,type:"authoring",panel:t})},teacherReaderPreview:function(e,t,n){var a=s.parseQueryString(n);sCH.userM.isAnonUser()?this.app.reader({layerId:e,type:"authoring",isReadOnly:!0,panel:t}):this.app.reader(r.extend({layerId:e,type:"authoring",isReadOnly:!0,panel:t},a))},teacherResearchPreview:function(e,t){this.app.reader({studentLayerId:e,type:"studentresearch",isReadOnly:!0,panel:t})},teacherReaderTour:function(e,t){this.app.reader({assignmentId:e,type:"tour",panel:t})},teacherReaderLearning:function(e,t){this.app.reader({assignmentId:e,type:"student",panel:t})},teacherReaderGrading:function(e,t){this.app.reader({assignmentId:e,type:"grading",panel:t})},teacherReaderGradingSkipToTag:function(e,t,n){var a=s.parseQueryString(n),i={assignmentId:e,type:"grading",panel:t};a&&a.question&&(i.questionTagId=a.question),a&&a.student&&(i.studentUserId=a.student),this.app.reader(i)},teacherReaderAuthoringPreviewSkipToTag:function(e,t){this.app.reader({layerId:e,type:"authoring",panel:"notes",questionTagId:t,isReadOnly:!0,showAuthoringActions:!1})},teacherIRCatalog:function(e){this.app.studentCatalog(e)},studentClasses:function(e,t,n){this.app.studentClasses(parseInt(e),t,n)},studentGrades:function(){this.app.studentGrades()},studentVocabulary:function(){this.app.studentVocabulary()},studentReader:function(e,t){this.app.reader({assignmentId:e,type:"student",panel:t})},mathReader:function(e){this.app.reader({queryString:e,isMath:!0})},studentData:function(){sCH.userM.isOnPrimePlan()?this.app.studentData():this.redirect()},studentBookshelf:function(e){this.app.studentBookshelf(e)},studentResearch:function(){this.app.studentResearch()},studentCatalog:function(e){this.app.studentCatalog(e)},studentReadingLog:function(){this.app.studentReadingLog()},studentSwitchRole:function(){this.app.switchRole({switchTo:"teacher"})},studentReaderIr:function(e,t){this.app.reader({studentLayerId:e,type:"studentir",panel:t})},studentReaderResearch:function(e,t){this.app.reader({studentLayerId:e,type:"studentresearch",panel:t})},adminStandards:function(){this.app.adminStandards()},adminSchool:function(e,t,n){this.app.adminSchool(e,t,n)},adminTeachers:function(e){this.app.adminTeachers(e)},manage:function(e){this.app.manage(e)},professionalLearning:function(e,t,n){this.app.professionalLearning({tab:e,practice:t,activity:n})},notFound:function(){rg4js("send",{error:new Error("Diagnose Check"),customData:{hash:Backbone.history.getFragment()}}),Backbone.router.navigate("404",{trigger:!0})},pageNotFound:function(){this.app.pageNotFound()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(1911),i=n(43),o=n(133),r=n(20);t.default=Backbone.View.extend({initialize:function(){a.startUpdateTimer(),r.default.isMath&&o.init()},initializeView:function(e,t,n,a){this.setupBodyClasses(a?"noSubheader":""),Backbone.pubEv.trigger("setSubSectionObj",null),Backbone.pubEv.trigger("setViewProps",{viewName:e,viewProps:t,mainMenuTabName:n})},setupBodyClasses:function(e){var t,n=[],s=Backbone.history.getFragment().split("?")[0].split("/");-1!==s.indexOf("reader")&&s.forEach((function(e,t){var a="page-"+s.slice(0,t+1).join("-");n.push(a)})),e=a.classNames(((t={"no-touch":!("ontouchstart"in document),ios:i.ios,enablePrint:!sCH.userM.isOnFreePlan(),paidUser:!sCH.userM.isOnFreePlan(),anonPreviewing:sCH.userM.isAnonUser(),v2reader:sCH.userM.isV2ContentUser(),isMath:r.default.isMath,productUpdatesBannerShown:!sCH.userM.isAnonUser()&&!sCH.userM.get("IsMasquerading")&&"student"!==sCH.userM.get("Role")&&sCH.userM.get("UserProductUpdateMessage")&&!sCH.userM.showPopup("HowToUseCatalogV2")})[n.join(" ")]=!0,t))+" "+e||"",$("body").attr("class",e)},pageNotFound:function(){this.initializeView("pageNotFound",{},"",!0)},profile:function(e){this.initializeView("profile",{render:e},"profile")},teacherClasses:function(e,t,n,a){this.initializeView("teacherClasses",{classId:e,render:t,subtab:n,studentUserId:a},"viewclasses")},teacherCatalog:function(e,t,n){this.initializeView("teacherCatalog",{render:"Catalog",topicSlug:e,topicBucketSlug:t,queryParams:n},sCH.userM.isAnonUser()?"anonCatalog":"catalog")},studentClasses:function(e,t,n){this.initializeView("studentClasses",{classId:e,render:t,subtab:n},"viewclasses")},studentData:function(){this.initializeView("studentData",{},"data")},studentBookshelf:function(e){this.initializeView("independentReading",{render:"Bookshelf",learnEntityId:e},"independentReading")},studentCatalog:function(e){this.initializeView("independentReading",{render:"Library",learnEntityId:e},"independentReading")},studentReadingLog:function(){this.initializeView("independentReading",{render:"ReadingLog"},"independentReading")},studentResearch:function(){var e=0,t="Classes";sCH.classesC.each((function(n){n.get("IsOnPrimePlan")&&(n.get("ClassId")<e||0===e)&&(e=n.get("ClassId"),t=n.get("Name"))}));new Backbone.BootstrapModal({title:"Research has moved!",content:"If you had any Research projects, they can now be found in <b>"+t+" -> Research.</b> There, you will be able to move your Research between your classes.",cancelText:!1,okText:"Got it!",doNotShowAgain:!0}).open((function(){a.updateDoNotShowPopupSetting("StudentMyResearch"),$(".mainMenu .research").remove(),window.location.href=0===e?"#student/classes":"#student/classes/"+e+"/research"}))},reader:function(e){this.initializeView("reader",e)},adminStandards:function(){this.initializeView("adminStandards",{},"standards")},adminSchool:function(e,t,n){this.initializeView("adminSchool",{subview:e,tab:t,subtab:n},"school")},adminTeachers:function(e){this.initializeView("adminTeachers",{subview:e},"teachers")},manage:function(e){this.initializeView("manage",{subview:e},"manage")},professionalLearning:function(e){this.initializeView("professionalLearning",e,"professionalLearning")},switchRole:function(e){this.initializeView("switchRole",e,"",!0)},databaseDown:function(e){this.initializeView("databaseDown"),this.databaseDownPage=new s.default(e),this.onTopView=this.databaseDownPage}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1912);t.default=Backbone.View.extend({el:"div.databaseDown",initialize:function(e){this.scroll=new a.default,this.childViews=[this.scroll],this.render(e),this.$el.find(".header, .subheader").hide(),this.$el.css({top:"0px","z-index":"999999"})},render:function(e){this.scroll.render()}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Backbone.View.extend({el:".databaseDown .scroll",template:n(1913),initialize:function(){},render:function(){this.$el.html(this.template()),this.$el.show()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<!DOCTYPE html>\r\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\r\n<head>\r\n    <title>Actively Learn</title>\r\n\r\n    <link type="text/css" rel="stylesheet" href="https://fast.fonts.com/cssapi/3aa9ca6e-6ff9-4a9c-b45d-f37014a530c1.css" />\r\n\r\n    <style type="text/css">\r\n        body {\r\n            background-color: #009fc7;\r\n            font-family: "avenir next w10 regular";\r\n        }\r\n\r\n        #page {\r\n            max-width: 960px;\r\n            margin: 0px auto;\r\n        }\r\n\r\n        #logo {\r\n            margin: 20px auto;\r\n            width: 300px;\r\n            text-align: center;\r\n        }\r\n\r\n            #logo img {\r\n                max-width: 100%;\r\n            }\r\n\r\n        #maintenance {\r\n            text-align: center;\r\n            color: #fff;\r\n            font-size: 20px;\r\n        }\r\n\r\n            #maintenance a:hover,\r\n            #maintenance a:active,\r\n            #maintenance a:focus,\r\n            #maintenance a {\r\n                font-family: "avenir next w10 medium";\r\n                color: white;\r\n            }\r\n\r\n        p {\r\n            margin-bottom: 50px;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div id="page">\r\n        <div id="logo"><img src="/img/Logo_White.png" /></div>\r\n\r\n        <div id="maintenance">\r\n            <p>\r\n                Actively Learn is currently down for unplanned maintenance. We expect to be back shortly. Sorry for the inconvenience.\r\n            </p>\r\n            <p>\r\n                If you need to reach us immediately:<br />\r\n                <a href="mailto:help@activelylearn.com">help@activelylearn.com</a>\r\n            </p>\r\n            <p>\r\n                See our <a target="_blank" href="http://status.activelylearn.com">status page</a> for details.\r\n            </p>\r\n        </div>\r\n    </div>\r\n</body>\r\n</html>';return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(10),o=n(1915);t.notifications=[],t.unreadCount=[],t.view=null,t.started=!1,t.interval=null,t.get=function(){var e=this,t=sCH.readerConfig.assignmentId;s.ajax({type:"GET",url:alcfg.node.reader.get_notifications,data:{assignmentId:t,readerType:sCH.readerConfig.type},showLoading:!1,vital:!1,onSuccess:function(t){e.notifications=t,null!==e.notifications&&e.updateNotificationButton()},onError:function(){}})},t.show=function(){Backbone.tracking.trackGAEvent("teacher","showNotifications"),this.view=new o.default,this.notifications=a.sortBy(this.notifications,(function(e){return-Date.parse(e.CreateDate)})),this.groupNotificationsFunc(this.notifications),this.view.render(this.groupedNotifications),$(".btnNotifications").addClass("selected")},t.hide=function(){Backbone.tracking.trackGAEvent("teacher","hideNotifications"),this.view.destroy(),$(".btnNotifications").removeClass("selected")},t.groupNotificationsFunc=function(e){var t=this;for(var n in this.gN={},this.groupedNotifications=[],a.each(e,(function(e,n){var i=t.group(e,"TagId");switch(i.Activity){case"FlagResponse":1===i.Quantity&&(i.notificationText='replied to "I don\'t understand" flag: {0}',i.AdditionalText=s.sanitize(i.AdditionalInfo));break;case"TeacherNoteResponse":case"StudentNoteResponse":1===i.Quantity?(i.notificationText="responded to{0}.",i.AdditionalText=i.AdditionalInfo?': "'+s.sanitize(i.AdditionalInfo)+'"':" your note"):i.CreatedByCurrentUser&&(i.SendersFullName=[i.Quantity]);break;case"UserTaggedInNote":1===i.Quantity&&(i.notificationText="mentioned you in a note"+(i.TagResponseId?" reply.":"."),i.AdditionalText=s.sanitize(i.AdditionalInfo));break;case"Comprehension":1===i.Quantity&&(i.notificationText='marked "I don\'t understand" and left a comment. {0}',i.AdditionalText="");break;case"GradedResponse":if(1===i.Quantity)if(d=sCH.questionsNumC.find({QuestionTagId:i.TagId})){var o=i.AdditionalInfo?s.sanitize(i.AdditionalInfo).split(";"):["",""],r=""!==o[0]?a.find(sCH.readerConfig.gradeNameMap,{id:o[0].toLowerCase()}).label:"",l=o[1];i.notificationText=r?"graded Question {0}":"commented on Question {0}",i.AdditionalText=d.get("QuestionNum")+".",r&&(i.AdditionalText+=" Grade: "+r,i.AdditionalText+=s.sanitize(l)?",":""),l&&(i.AdditionalText+=" Comment: "+s.substringAtWord($("<div>"+s.sanitize(l)+"</div>").text(),25))}break;case"DeletedQuestionResponse":if(1===i.Quantity)(d=sCH.questionsNumC.find({QuestionTagId:i.TagId}))&&(i.SendersFullName=[],i.notificationText="You can now revise your response to Question {0}.",i.AdditionalText=d.get("QuestionNum"));break;case"QuestionResponseResetRequest":1===i.Quantity?(i.notificationText="wants to revise their response to {0}.",i.AdditionalText=s.sanitize(i.AdditionalInfo)):(i.SendersFullName=[i.Quantity],i.notificationText="students want to revise their response to {0}.");break;case"ResponseLiked":var d;if(1===i.Quantity)(d=sCH.questionsNumC.find({QuestionTagId:i.TagId}))&&(i.notificationText="liked your response to Question {0}.",i.AdditionalText=d.get("QuestionNum"));else i.SendersFullName=[i.Quantity],i.notificationText="people liked your response to Question {0}.";break;default:1===i.Quantity&&(i.notificationText="{0}.",i.AdditionalText=s.sanitize(i.AdditionalInfo))}})),this.gN)this.gN.hasOwnProperty(n)&&this.groupedNotifications.push(this.gN[n]);return this.groupedNotifications},t.group=function(e,t){var n=e.Activity+e[t];return void 0===this.gN[n]?(this.gN[n]=e,this.gN[n].GroupOn=t,this.gN[n].GroupOnId=e[t],this.gN[n].SendersFullName=new Array(e.SenderUserFullName),this.gN[n].Quantity=1):(this.gN[n].Quantity++,this.gN[n].SendersFullName.push(e.SenderUserFullName),this.gN[n].SenderUserImageUrl!==e.SenderUserImageUrl&&(this.gN[n].SenderUserImageUrl=null),this.gN[n].IsClicked&&!e.IsClicked&&(this.gN[n].IsClicked=!1)),this.gN[n]},t.markRead=function(e,t,n,s){var o=this;if(!this.groupedNotifications[e].IsClicked){i.MarkReadNotification({activity:t,groupOnId:n,groupOn:s});var r=this.groupedNotifications.splice(e,1)[0],l=sCH.classesC.getModelByClassId(sCH.learnEntityMetaM.get("ClassId"));a.each(this.notifications,(function(e){r.Activity===e.Activity&&r.GroupOnId===e.GroupOnId&&(e.IsClicked=!0,o.updateClassNotificationCountsByActivity(l,e.Activity,!1,{assignmentId:e.AssignmentId,tagId:e.TagId}))})),this.updateNotificationButton()}},t.markAllRead=function(){var e=this;if(0!=this.unreadCount.length){i.MarkAllReadNotifications();var t=a.find(sCH.classesC.models,(function(e){return e.get("ClassId")===sCH.learnEntityMetaM.get("ClassId")}));a.each(this.notifications,(function(n){n.IsClicked=!0,e.updateClassNotificationCountsByActivity(t,n.Activity,!1,{assignmentId:n.AssignmentId,tagId:n.TagId})})),this.updateNotificationButton()}},t.deleteNotification=function(e,t,n,s){i.DeleteNotification({activity:t,groupOnId:n,groupOn:s});var o=this,r=this.groupedNotifications.splice(e,1)[0],l=[],d=sCH.classesC.getModelByClassId(sCH.learnEntityMetaM.get("ClassId"));a.each(this.notifications,(function(e){r.Activity===e.Activity&&r.GroupOnId===e.GroupOnId?o.updateClassNotificationCountsByActivity(d,e.Activity,!1,{assignmentId:e.AssignmentId,tagId:e.TagId}):l.push(e)})),this.notifications=l,this.updateNotificationButton()},t.updateNotificationButton=function(){var e=this;this.unreadCount=[],this.groupNotificationsFunc(this.notifications),a.each(this.groupedNotifications,(function(t){t.IsClicked||e.unreadCount.push(t.NotificationId)}));var t=this.unreadCount.length,n=$(".btnNotifications .notificationCount");n.text(t),0===t?n.hide():n.show()},t.updateClassNotificationCountsByActivity=function(e,t,n,s){if(e){var i=$.extend(!0,{},e.get("NotificationsByAssignment"));i[s.assignmentId]=i[s.assignmentId]||{};var o=i[s.assignmentId][t]?i[s.assignmentId][t].split(","):[],r=a.indexOf(o,s.tagId.toString());-1===r&&n?o.push(s.tagId.toString()):r>=0&&!n&&o.splice(r,1),i[s.assignmentId][t]=o.join(","),this.updateNotificationAndRerenderClassAssignmentTiles(e,i)}},t.updateClassNotificationCountsByAssignment=function(e,t,n){var s=$.extend(!0,{},e.get("NotificationsByAssignment"));for(var i in t)for(var o in s[i]=s[i]||{},t[i])if(t[i][o]){var r=s[i][o]&&s[i][o].length?s[i][o].split(","):[],l=t[i][o].split(",");s[i][o]=n?a.uniq(r.concat(l)).join(","):a.difference(r,l).join(",")}this.updateNotificationAndRerenderClassAssignmentTiles(e,s)},t.deleteClassNotificationByAssignment=function(e,t){var n=$.extend(!0,{},e.get("NotificationsByAssignment"));a.each(t,(function(e){n[e]={}})),this.updateNotificationAndRerenderClassAssignmentTiles(e,n)},t.updateNotificationAndRerenderClassAssignmentTiles=function(e,t){e.set({NotificationsByAssignment:t}),$(".menuListWrapper .classList a.selected").data("classid")===e.get("ClassId")&&Backbone.pubEv.trigger("RerenderClassAssignmentTiles")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5);t.default=Backbone.View.extend({el:".btnNotifications .container",events:{"click li.TeacherNoteResponse, li.StudentNoteResponse, li.FlagResponse, li.UserTaggedInNote":"noteResponse","click li.Comprehension":"comprehension","click li.ResponseLiked":"responseLiked","click li.DeletedQuestionResponse":"deletedQuestionResponse","click li.GradedResponse":"gradedResponse","click li.QuestionResponseResetRequest":"questionResponseResetRequest","click li":"blurNotificationsButton","click li .clearNotification":"clearNotification","click li.markAllRead":"markAllRead"},template:n(1916),initialize:function(){},blurNotificationsButton:function(){$(".btnNotifications").trigger("blur")},clearNotification:function(e){e.stopPropagation();var t=$(e.currentTarget).closest("li").data("notificationindex"),n=(this.notifications[t].NotificationId,this.notifications[t].Activity),a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn;Backbone.notificationHelper.deleteNotification(t,n,a,s),0==Backbone.notificationHelper.groupedNotifications.length&&$(".btnNotifications").tooltip("hide"),this.destroy(),Backbone.notificationHelper.show(),Backbone.notificationHelper.updateNotificationButton()},render:function(e){"authoring"!==sCH.readerConfig.type&&(this.notifications=e,this.$el.html(this.template({notifications:this.notifications,questionsNumC:sCH.questionsNumC,grades:sCH.readerConfig.gradeNameMap})).show(),this.$el.find(".info .timeago").timeago(),this.$el.find(".flyout").show(),a.initTooltips(this.$el.find(".clearNotification"),{placement:"left"}))},noteResponse:function(e){var t=$(e.currentTarget).data("notificationindex"),n=this.notifications[t].Activity,a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn,i=this.notifications[t].TagId,o=this.notifications[t].TextSectionId,r=(this.notifications[t].Role,!1);try{var l=sCH.studentNotesC.filter({TagId:this.notifications[t].TagId});if(l.length>0&&(r=!0===l[0].get("IsAssociatedNote"))){var d=sCH.studentFlagsC.filter({AssociatedNoteTagId:this.notifications[t].TagId});d.length>0&&(i=d[0].get("TagId"))}}catch(e){}Backbone.pubEv.trigger("skipToTag",{sectionId:o,tagId:i,tagType:r?"marker":"note",openTag:!0}),Backbone.notificationHelper.markRead(t,n,a,s)},comprehension:function(e){var t=$(e.currentTarget).data("notificationindex"),n=this.notifications[t].Activity,a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn,i=this.notifications[t].TagId,o=this.notifications[t].TextSectionId;this.notifications[t].Role;Backbone.pubEv.trigger("skipToTag",{sectionId:o,tagId:i,tagType:"marker",openTag:!0}),Backbone.notificationHelper.markRead(t,n,a,s)},deletedQuestionResponse:function(e){var t=$(e.currentTarget).data("notificationindex"),n=this.notifications[t].Activity,a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn,i=(this.notifications[t].Role,this.notifications[t].TagId),o=this.notifications[t].TextSectionId;sCH.readerConfig.isMedia?Backbone.pubEv.trigger("skipToVideoQuestion",{questionTagId:i}):Backbone.pubEv.trigger("skipToTag",{sectionId:o,tagId:i,tagType:"question",openTag:!0}),Backbone.notificationHelper.markRead(t,n,a,s)},responseLiked:function(e){var t=$(e.currentTarget).data("notificationindex"),n=this.notifications[t].Activity,a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn,i=this.notifications[t].TagId,o=sCH.questionsNumC.find({QuestionTagId:i}).get("TextSectionId");sCH.readerConfig.isMedia?Backbone.pubEv.trigger("skipToVideoQuestion",{questionTagId:i}):Backbone.pubEv.trigger("skipToTag",{sectionId:o,tagId:i,tagType:"question",openTag:"openResponse"}),Backbone.notificationHelper.markRead(t,n,a,s)},gradedResponse:function(e){var t=$(e.currentTarget).data("notificationindex"),n=this.notifications[t].Activity,a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn,i=this.notifications[t].TagId,o=this.notifications[t].TextSectionId;this.notifications[t].Role;sCH.readerConfig.isMedia?Backbone.pubEv.trigger("skipToVideoQuestion",{questionTagId:i}):Backbone.pubEv.trigger("skipToTag",{sectionId:o,tagId:i,tagType:"question",openTag:!1}),Backbone.notificationHelper.markRead(t,n,a,s)},questionResponseResetRequest:function(e){var t=$(e.currentTarget).data("notificationindex"),n=this.notifications[t].Activity,a=this.notifications[t].GroupOnId,s=this.notifications[t].GroupOn,i=this.notifications[t].TagId,o=this.notifications[t].TextSectionId;this.notifications[t].Role;sCH.readerConfig.isMedia?(Backbone.pubEv.trigger("skipToVideoQuestion",{questionTagId:i}),Backbone.pubEv.trigger("gradingClickedQuestion",{questionTagId:i,sortOrder:"reset-requests"})):Backbone.pubEv.trigger("skipToTag",{sectionId:o,tagId:i,tagType:"question",openTag:!0,originalEvent:"resetRequest"}),Backbone.notificationHelper.markRead(t,n,a,s)},markAllRead:function(){Backbone.notificationHelper.markAllRead()},destroy:function(){a.unbindTouchMove($(".reader")),this.$el.html("").hide(),this.$el.unbind()}})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<ul class="flyout notifications">\r\n    ',0==notifications.length)__p+='\r\n        <li><div class="info" style="float:none;">No notifications!</div></li>\r\n    ';else{var getSendersUserName=function(e){var t=_.uniqBy(e,(function(e){return e})),n=t.slice(0,3).join(", ");if(t.length>3){var a=t.length-3;n+=" & "+a+(a>1?" others":" other")}return cH.sanitize(n)};_.each(notifications,(function(e,t){e.notificationText&&(__p+='\r\n            <li data-notificationindex="'+(null==(__t=t)?"":__t)+'" class="'+(null==(__t=cH.sanitize(e.Activity))?"":__t)+" "+(null==(__t=e.IsClicked?"clicked":"")?"":__t)+'">\r\n                <div class="clearNotification" title="Clear">&times;</div>\r\n                ',e.SenderUserImageUrl?__p+="\r\n                    "+(null==(__t=cH.generateAvatarHtml(e.SenderUserImageUrl))?"":__t)+"\r\n                ":__p+='\r\n                    <span class="icon-people"></span>\r\n                ',__p+='\r\n                <div class="info">\r\n                    <span class="bold">\r\n                        '+(null==(__t=getSendersUserName(e.SendersFullName))?"":__t)+"\r\n                    </span>\r\n                    "+(null==(__t=e.notificationText.format(e.AdditionalText))?"":__t)+'\r\n                    <br />\r\n                    <abbr title="'+(null==(__t=cH.getUTCDateString(e.CreateDate))?"":__t)+'" class="timeago heading"></abbr>\r\n                </div>\r\n                <div class="clearBoth"></div>\r\n            </li>\r\n            '),__p+="\r\n        "}))}__p+="\r\n    ",notifications.length>0&&(__p+='\r\n        <li class="markAllRead">\r\n            <div class="btn">Mark all as read</div>\r\n        </li>\r\n    '),__p+="\r\n</ul>\r\n"}return __p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(8);t.trackGAEvent=function(e,t,n){try{ga("send","event",{eventCategory:e,eventAction:t,eventLabel:n})}catch(e){}},t.logReaderEvent=function(e,t){t=s.extend({event:e,referrer:window.location.href},t),a.ajax({type:"POST",url:alcfg.node.events.reader_event,data:t,timeout:16e3,showLoading:!1,vital:!1,silentError:!0,async:!0,onSuccess:function(e){},onError:function(){}})},t.saveReaderState=function(e,t,n,i){var o="end"===e;n=s.extend({type:e,event:t,referrer:window.location.href,readingDate:moment().format("YYYY-MM-DD")},n);var r={type:"POST",url:alcfg.node.events.save_reader_state,data:n,timeout:16e3,showLoading:!1,vital:!1,silentError:!0,async:!o,onSuccess:function(e){i&&i(e)},onError:function(){i&&i({error:"random"})}};"student"===sCH.userM.get("Role")&&(r.onUnauthenticatedError=function(){i&&i({error:"unauthenticated"})}),a.ajax(r)},t.logNSFEvent=function(e){setTimeout((function(){var t=e.assignmentId||(sCH.learnEntityMetaM?sCH.learnEntityMetaM.get("AssignmentId"):null);if("student"===sCH.userM.get("Role")&&t>0){e=s.extend({assignmentId:t},e);var n={type:"POST",url:alcfg.node.events.nsf_event,data:e,timeout:16e3,showLoading:!1,vital:!1,silentError:!0,async:!0,onSuccess:function(e){},onError:function(){}};s.includes(["reader enter","reader exit"],e.event)&&(n.onUnauthenticatedError=function(){}),a.ajax(n)}}))},t.logAnonEvent=function(e,t){t=s.extend({type:e,referrer:window.location.href},t),a.ajax({type:"POST",url:alcfg.node.events.anon_event,data:t,timeout:16e3,showLoading:!1,vital:!1,silentError:!0,async:!0,onSuccess:function(e){},onError:function(){}})}},function(e,t){
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under the MIT license
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(e){"use strict";var t=jQuery.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||t[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(e){"use strict";e.fn.emulateTransitionEnd=function(t){var n=!1,a=this;e(this).one("bsTransitionEnd",(function(){n=!0}));return setTimeout((function(){n||e(a).trigger(e.support.transition.end)}),t),this},e((function(){e.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})}))}(jQuery),function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.prototype.close=function(t){var a=e(this),s=a.attr("data-target");s||(s=(s=a.attr("href"))&&s.replace(/.*(?=#[^\s]*$)/,""));var i=e("#"===s?[]:s);function o(){i.detach().trigger("closed.bs.alert").remove()}t&&t.preventDefault(),i.length||(i=a.closest(".alert")),i.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o())};var a=e.fn.alert;e.fn.alert=function(t){return this.each((function(){var a=e(this),s=a.data("bs.alert");s||a.data("bs.alert",s=new n(this)),"string"==typeof t&&s[t].call(a)}))},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=a,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}(jQuery),function(e){"use strict";var t=function(n,a){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,a),this.isLoading=!1};function n(n){return this.each((function(){var a=e(this),s=a.data("bs.button"),i="object"==typeof n&&n;s||a.data("bs.button",s=new t(this,i)),"toggle"==n?s.toggle():n&&s.setState(n)}))}t.VERSION="3.3.7",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var n="disabled",a=this.$element,s=a.is("input")?"val":"html",i=a.data();t+="Text",null==i.resetText&&a.data("resetText",a[s]()),setTimeout(e.proxy((function(){a[s](null==i[t]?this.options[t]:i[t]),"loadingText"==t?(this.isLoading=!0,a.addClass(n).attr(n,n).prop(n,!0)):this.isLoading&&(this.isLoading=!1,a.removeClass(n).removeAttr(n).prop(n,!1))}),this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(e=!1),t.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),e&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var a=e.fn.button;e.fn.button=n,e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=a,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',(function(t){var a=e(t.target).closest(".btn");n.call(a,"toggle"),e(t.target).is('input[type="radio"], input[type="checkbox"]')||(t.preventDefault(),a.is("input,button")?a.trigger("focus"):a.find("input:visible,button:visible").first().trigger("focus"))})).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',(function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))}))}(jQuery),function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};function n(n){return this.each((function(){var a=e(this),s=a.data("bs.carousel"),i=e.extend({},t.DEFAULTS,a.data(),"object"==typeof n&&n),o="string"==typeof n?n:i.slide;s||a.data("bs.carousel",s=new t(this,i)),"number"==typeof n?s.to(n):o?s[o]():i.interval&&s.pause().cycle()}))}t.VERSION="3.3.7",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},t.prototype.getItemForDirection=function(e,t){var n=this.getItemIndex(t);if(("prev"==e&&0===n||"next"==e&&n==this.$items.length-1)&&!this.options.wrap)return t;var a=(n+("prev"==e?-1:1))%this.$items.length;return this.$items.eq(a)},t.prototype.to=function(e){var t=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",(function(){t.to(e)})):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",this.$items.eq(e))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(!this.sliding)return this.slide("next")},t.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},t.prototype.slide=function(n,a){var s=this.$element.find(".item.active"),i=a||this.getItemForDirection(n,s),o=this.interval,r="next"==n?"left":"right",l=this;if(i.hasClass("active"))return this.sliding=!1;var d=i[0],c=e.Event("slide.bs.carousel",{relatedTarget:d,direction:r});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=e(this.$indicators.children()[this.getItemIndex(i)]);u&&u.addClass("active")}var p=e.Event("slid.bs.carousel",{relatedTarget:d,direction:r});return e.support.transition&&this.$element.hasClass("slide")?(i.addClass(n),i[0].offsetWidth,s.addClass(r),i.addClass(r),s.one("bsTransitionEnd",(function(){i.removeClass([n,r].join(" ")).addClass("active"),s.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout((function(){l.$element.trigger(p)}),0)})).emulateTransitionEnd(t.TRANSITION_DURATION)):(s.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger(p)),o&&this.cycle(),this}};var a=e.fn.carousel;e.fn.carousel=n,e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=a,this};var s=function(t){var a,s=e(this),i=e(s.attr("data-target")||(a=s.attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,""));if(i.hasClass("carousel")){var o=e.extend({},i.data(),s.data()),r=s.attr("data-slide-to");r&&(o.interval=!1),n.call(i,o),r&&i.data("bs.carousel").to(r),t.preventDefault()}};e(document).on("click.bs.carousel.data-api","[data-slide]",s).on("click.bs.carousel.data-api","[data-slide-to]",s),e(window).on("load",(function(){e('[data-ride="carousel"]').each((function(){var t=e(this);n.call(t,t.data())}))}))}(jQuery),function(e){"use strict";var t=function(n,a){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,a),this.$trigger=e('[data-toggle="collapse"][href="#'+n.id+'"],[data-toggle="collapse"][data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function n(t){var n,a=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(a)}function a(n){return this.each((function(){var a=e(this),s=a.data("bs.collapse"),i=e.extend({},t.DEFAULTS,a.data(),"object"==typeof n&&n);!s&&i.toggle&&/show|hide/.test(n)&&(i.toggle=!1),s||a.data("bs.collapse",s=new t(this,i)),"string"==typeof n&&s[n]()}))}t.VERSION="3.3.7",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var n,s=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(s&&s.length&&(n=s.data("bs.collapse"))&&n.transitioning)){var i=e.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){s&&s.length&&(a.call(s,"hide"),n||s.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return r.call(this);var l=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(r,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[o](this.$element[0][l])}}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var n=e.Event("hide.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var a=this.dimension();this.$element[a](this.$element[a]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return s.call(this);this.$element[a](0).one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(t.TRANSITION_DURATION)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy((function(t,a){var s=e(a);this.addAriaAndCollapsedClass(n(s),s)}),this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var s=e.fn.collapse;e.fn.collapse=a,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=s,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',(function(t){var s=e(this);s.attr("data-target")||t.preventDefault();var i=n(s),o=i.data("bs.collapse")?"toggle":s.data();a.call(i,o)}))}(jQuery),function(e){"use strict";var t=".dropdown-backdrop",n='[data-toggle="dropdown"]',a=function(t){e(t).on("click.bs.dropdown",this.toggle)};function s(t){var n=t.attr("data-target");n||(n=(n=t.attr("href"))&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var a=n&&e(n);return a&&a.length?a:t.parent()}function i(a){a&&3===a.which||(e(t).remove(),e(n).each((function(){var t=e(this),n=s(t),i={relatedTarget:this};n.hasClass("open")&&(a&&"click"==a.type&&/input|textarea/i.test(a.target.tagName)&&e.contains(n[0],a.target)||(n.trigger(a=e.Event("hide.bs.dropdown",i)),a.isDefaultPrevented()||(t.attr("aria-expanded","false"),n.removeClass("open").trigger(e.Event("hidden.bs.dropdown",i)))))})))}a.VERSION="3.3.7",a.prototype.toggle=function(t){var n=e(this);if(!n.is(".disabled, :disabled")){var a=s(n),o=a.hasClass("open");if(i(),!o){"ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",i);var r={relatedTarget:this};if(a.trigger(t=e.Event("show.bs.dropdown",r)),t.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),a.toggleClass("open").trigger(e.Event("shown.bs.dropdown",r))}return!1}},a.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var a=e(this);if(t.preventDefault(),t.stopPropagation(),!a.is(".disabled, :disabled")){var i=s(a),o=i.hasClass("open");if(!o&&27!=t.which||o&&27==t.which)return 27==t.which&&i.find(n).trigger("focus"),a.trigger("click");var r=i.find(".dropdown-menu li:not(.disabled):visible a");if(r.length){var l=r.index(t.target);38==t.which&&l>0&&l--,40==t.which&&l<r.length-1&&l++,~l||(l=0),r.eq(l).trigger("focus")}}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each((function(){var n=e(this),s=n.data("bs.dropdown");s||n.data("bs.dropdown",s=new a(this)),"string"==typeof t&&s[t].call(n)}))},e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",(function(e){e.stopPropagation()})).on("click.bs.dropdown.data-api",n,a.prototype.toggle).on("keydown.bs.dropdown.data-api",n,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),function(e){"use strict";var t=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy((function(){this.$element.trigger("loaded.bs.modal")}),this))};function n(n,a){return this.each((function(){var s=e(this),i=s.data("bs.modal"),o=e.extend({},t.DEFAULTS,s.data(),"object"==typeof n&&n);i||s.data("bs.modal",i=new t(this,o)),"string"==typeof n?i[n](a):o.show&&i.show(a)}))}t.VERSION="3.3.7",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(n){var a=this,s=e.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",(function(){a.$element.one("mouseup.dismiss.bs.modal",(function(t){e(t.target).is(a.$element)&&(a.ignoreBackdropClick=!0)}))})),this.backdrop((function(){var s=e.support.transition&&a.$element.hasClass("fade");a.$element.parent().length||a.$element.appendTo(a.$body),a.$element.show().scrollTop(0),a.adjustDialog(),s&&a.$element[0].offsetWidth,a.$element.addClass("in"),a.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:n});s?a.$dialog.one("bsTransitionEnd",(function(){a.$element.trigger("focus").trigger(i)})).emulateTransitionEnd(t.TRANSITION_DURATION):a.$element.trigger("focus").trigger(i)})))},t.prototype.hide=function(n){n&&n.preventDefault(),n=e.Event("hide.bs.modal"),this.$element.trigger(n),this.isShown&&!n.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy((function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")}),this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy((function(e){27==e.which&&this.hide()}),this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop((function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")}))},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(n){var a=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&s;if(this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+s).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy((function(e){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())}),this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!n)return;i?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):n()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){a.removeBackdrop(),n&&n()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):o()}else n&&n()},t.prototype.handleUpdate=function(){this.adjustDialog()},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var a=e.fn.modal;e.fn.modal=n,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=a,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(t){var a=e(this),s=a.attr("href"),i=e(a.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),o=i.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(s)&&s},i.data(),a.data());a.is("a")&&t.preventDefault(),i.one("show.bs.modal",(function(e){e.isDefaultPrevented()||i.one("hidden.bs.modal",(function(){a.is(":visible")&&a.trigger("focus")}))})),n.call(i,o,this)}))}(jQuery),function(e){"use strict";var t=function(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)};t.VERSION="3.3.7",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,n,a){if(this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(a),this.$viewport=this.options.viewport&&e(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var s=this.options.trigger.split(" "),i=s.length;i--;){var o=s[i];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var r="hover"==o?"mouseenter":"focusin",l="hover"==o?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,(function(e,a){n[e]!=a&&(t[e]=a)})),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),t instanceof e.Event&&(n.inState["focusin"==t.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState)n.hoverState="in";else{if(clearTimeout(n.timeout),n.hoverState="in",!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout((function(){"in"==n.hoverState&&n.show()}),n.options.delay.show)}},t.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),t instanceof e.Event&&(n.inState["focusout"==t.type?"focus":"hover"]=!1),!n.isInStateTrue()){if(clearTimeout(n.timeout),n.hoverState="out",!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout((function(){"out"==n.hoverState&&n.hide()}),n.options.delay.hide)}},t.prototype.show=function(){var n=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(n);var a=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(n.isDefaultPrevented()||!a)return;var s=this,i=this.tip(),o=this.getUID(this.type);this.setContent(),i.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&i.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,d=l.test(r);d&&(r=r.replace(l,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),u=i[0].offsetWidth,p=i[0].offsetHeight;if(d){var h=r,g=this.getPosition(this.$viewport);r="bottom"==r&&c.bottom+p>g.bottom?"top":"top"==r&&c.top-p<g.top?"bottom":"right"==r&&c.right+u>g.width?"left":"left"==r&&c.left-u<g.left?"right":r,i.removeClass(h).addClass(r)}var f=this.getCalculatedOffset(r,c,u,p);this.applyPlacement(f,r);var m=function(){var e=s.hoverState;s.$element.trigger("shown.bs."+s.type),s.hoverState=null,"out"==e&&s.leave(s)};e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",m).emulateTransitionEnd(t.TRANSITION_DURATION):m()}},t.prototype.applyPlacement=function(t,n){var a=this.tip(),s=a[0].offsetWidth,i=a[0].offsetHeight,o=parseInt(a.css("margin-top"),10),r=parseInt(a.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(r)&&(r=0),t.top+=o,t.left+=r,e.offset.setOffset(a[0],e.extend({using:function(e){a.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),a.addClass("in");var l=a[0].offsetWidth,d=a[0].offsetHeight;"top"==n&&d!=i&&(t.top=t.top+i-d);var c=this.getViewportAdjustedDelta(n,t,l,d);c.left?t.left+=c.left:t.top+=c.top;var u=/top|bottom/.test(n),p=u?2*c.left-s+l:2*c.top-i+d,h=u?"offsetWidth":"offsetHeight";a.offset(t),this.replaceArrow(p,a[0][h],u)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(n){var a=this,s=e(this.$tip),i=e.Event("hide.bs."+this.type);function o(){"in"!=a.hoverState&&s.detach(),a.$element&&a.$element.removeAttr("aria-describedby").trigger("hidden.bs."+a.type),n&&n()}if(this.$element.trigger(i),!i.isDefaultPrevented())return s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){var n=(t=t||this.$element)[0],a="BODY"==n.tagName,s=n.getBoundingClientRect();null==s.width&&(s=e.extend({},s,{width:s.right-s.left,height:s.bottom-s.top}));var i=window.SVGElement&&n instanceof window.SVGElement,o=a?{top:0,left:0}:i?null:t.offset(),r={scroll:a?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},l=a?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},s,r,l,o)},t.prototype.getCalculatedOffset=function(e,t,n,a){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-a,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-a/2,left:t.left-n}:{top:t.top+t.height/2-a/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,n,a){var s={top:0,left:0};if(!this.$viewport)return s;var i=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var r=t.top-i-o.scroll,l=t.top+i-o.scroll+a;r<o.top?s.top=o.top-r:l>o.top+o.height&&(s.top=o.top+o.height-l)}else{var d=t.left-i,c=t.left+i+n;d<o.left?s.left=o.left-d:c>o.right&&(s.left=o.left+o.width-c)}return s},t.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},t.prototype.tip=function(){if(!this.$tip&&(this.$tip=e(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=this;t&&((n=e(t.currentTarget).data("bs."+this.type))||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),t?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide((function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null,e.$element=null}))};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each((function(){var a=e(this),s=a.data("bs.tooltip"),i="object"==typeof n&&n;!s&&/destroy|hide/.test(n)||(s||a.data("bs.tooltip",s=new t(this,i)),"string"==typeof n&&s[n]())}))},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.7",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=e.fn.popover;e.fn.popover=function(n){return this.each((function(){var a=e(this),s=a.data("bs.popover"),i="object"==typeof n&&n;!s&&/destroy|hide/.test(n)||(s||a.data("bs.popover",s=new t(this,i)),"string"==typeof n&&s[n]())}))},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),function(e){"use strict";function t(n,a){this.$body=e(document.body),this.$scrollElement=e(n).is(document.body)?e(window):e(n),this.options=e.extend({},t.DEFAULTS,a),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each((function(){var a=e(this),s=a.data("bs.scrollspy"),i="object"==typeof n&&n;s||a.data("bs.scrollspy",s=new t(this,i)),"string"==typeof n&&s[n]()}))}t.VERSION="3.3.7",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t=this,n="offset",a=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),e.isWindow(this.$scrollElement[0])||(n="position",a=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map((function(){var t=e(this),s=t.data("target")||t.attr("href"),i=/^#./.test(s)&&e(s);return i&&i.length&&i.is(":visible")&&[[i[n]().top+a,s]]||null})).sort((function(e,t){return e[0]-t[0]})).each((function(){t.offsets.push(this[0]),t.targets.push(this[1])}))},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),a=this.options.offset+n-this.$scrollElement.height(),s=this.offsets,i=this.targets,o=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),t>=a)return o!=(e=i[i.length-1])&&this.activate(e);if(o&&t<s[0])return this.activeTarget=null,this.clear();for(e=s.length;e--;)o!=i[e]&&t>=s[e]&&(void 0===s[e+1]||t<s[e+1])&&this.activate(i[e])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',a=e(n).parents("li").addClass("active");a.parent(".dropdown-menu").length&&(a=a.closest("li.dropdown").addClass("active")),a.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var a=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=a,this},e(window).on("load.bs.scrollspy.data-api",(function(){e('[data-spy="scroll"]').each((function(){var t=e(this);n.call(t,t.data())}))}))}(jQuery),function(e){"use strict";var t=function(t){this.element=e(t)};function n(n){return this.each((function(){var a=e(this),s=a.data("bs.tab");s||a.data("bs.tab",s=new t(this)),"string"==typeof n&&s[n]()}))}t.VERSION="3.3.7",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),a=t.data("target");if(a||(a=(a=t.attr("href"))&&a.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var s=n.find(".active:last a"),i=e.Event("hide.bs.tab",{relatedTarget:t[0]}),o=e.Event("show.bs.tab",{relatedTarget:s[0]});if(s.trigger(i),t.trigger(o),!o.isDefaultPrevented()&&!i.isDefaultPrevented()){var r=e(a);this.activate(t.closest("li"),n),this.activate(r,r.parent(),(function(){s.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:s[0]})}))}}},t.prototype.activate=function(n,a,s){var i=a.find("> .active"),o=s&&e.support.transition&&(i.length&&i.hasClass("fade")||!!a.find("> .fade").length);function r(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu").length&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),s&&s()}i.length&&o?i.one("bsTransitionEnd",r).emulateTransitionEnd(t.TRANSITION_DURATION):r(),i.removeClass("in")};var a=e.fn.tab;e.fn.tab=n,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=a,this};var s=function(t){t.preventDefault(),n.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',s).on("click.bs.tab.data-api",'[data-toggle="pill"]',s)}(jQuery),function(e){"use strict";var t=function(n,a){this.options=e.extend({},t.DEFAULTS,a),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function n(n){return this.each((function(){var a=e(this),s=a.data("bs.affix"),i="object"==typeof n&&n;s||a.data("bs.affix",s=new t(this,i)),"string"==typeof n&&s[n]()}))}t.VERSION="3.3.7",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(e,t,n,a){var s=this.$target.scrollTop(),i=this.$element.offset(),o=this.$target.height();if(null!=n&&"top"==this.affixed)return s<n&&"top";if("bottom"==this.affixed)return null!=n?!(s+this.unpin<=i.top)&&"bottom":!(s+o<=e-a)&&"bottom";var r=null==this.affixed,l=r?s:i.top;return null!=n&&s<=n?"top":null!=a&&l+(r?o:t)>=e-a&&"bottom"},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$target.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=this.$element.height(),a=this.options.offset,s=a.top,i=a.bottom,o=Math.max(e(document).height(),e(document.body).height());"object"!=typeof a&&(i=s=a),"function"==typeof s&&(s=a.top(this.$element)),"function"==typeof i&&(i=a.bottom(this.$element));var r=this.getState(o,n,s,i);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");var l="affix"+(r?"-"+r:""),d=e.Event(l+".bs.affix");if(this.$element.trigger(d),d.isDefaultPrevented())return;this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:o-n-i})}};var a=e.fn.affix;e.fn.affix=n,e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=a,this},e(window).on("load",(function(){e('[data-spy="affix"]').each((function(){var t=e(this),a=t.data();a.offset=a.offset||{},null!=a.offsetBottom&&(a.offset.bottom=a.offsetBottom),null!=a.offsetTop&&(a.offset.top=a.offsetTop),n.call(t,a)}))}))}(jQuery)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),s=n(5),i=n(22),o=a.template('\n<div class="modal-dialog <%= cssClass %> <% print(showFooter ? \'hasFooter\' : \'\'); %> <% print(title ? \'hasHeader\' : \'\'); %>"><div class="modal-content" role="dialog" aria-modal="true">\n<% if (title !== null) { %>\n<div class="modal-header">\n    <% if (allowCancel) { %>\n    <a class="close">&times;</a>\n    <% } %>\n    <h4 class="modal-title"><%= title %></h4>\n</div>\n<% } %>\n<div class="modal-body"><%= content %></div>\n<% if (showFooter) { %>\n<div class="modal-footer">\n    <% if (cancelText) { %>\n    <a href="#" class="btn cancel"><%= cancelText %></a>\n    <% } %>\n    <% if (optionButtons.length > 0) { %>\n    <% optionButtons.forEach(function(optionButton) { %>\n        <a class="btn optionButton <%= optionButton.class %>" data-event="<%= optionButton.event %>"><%= optionButton.text %></a>\n    <% }); %>\n    <% } %>\n    <a href="#" class="btn ok btn-primary"><%= okText %></a>\n</div>\n<% } %>\n</div></div>\n'),r=Backbone.View.extend({className:"modal",events:{click:"handleAppClick","click .optionButton":function(e){e.preventDefault();var t=$(e.target).data("event");this.options.content&&this.options.content.trigger&&this.options.content.trigger(t,this),this.trigger(t)},"click .close":function(e){e.preventDefault(),this.options.content&&this.options.content.trigger&&this.options.content.trigger("cancel",this),this.trigger("cancel",e)},"click .cancel":function(e){e.preventDefault(),this.options.content&&this.options.content.trigger&&this.options.content.trigger("cancel",this),this.trigger("cancel",e),this.options.triggerBackboneEventOnCancel&&Backbone.pubEv.trigger(this.options.triggerBackboneEventOnCancel)},"click .ok":function(e){e.preventDefault(),this.trigger("ok"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("ok",this),this.options.okCloses&&this.close()},keypress:function(e){this.options.enterTriggersOk&&13==e.which&&(e.preventDefault(),this.trigger("ok"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("ok",this),this.options.okCloses&&this.close())}},initialize:function(e){this.options=a.extend({title:null,okText:"OK",focusOk:!1,okCloses:!0,cancelText:"Cancel",showFooter:!0,optionButtons:[],allowCancel:!0,escape:!0,animate:!0,template:o,enterTriggersOk:!1,cssClass:null,doNotShowAgain:!1,handleAppClick:!1},e),this.options.content&&this.options.content.trigger&&this.options.content.trigger("initialized",this),this.trigger("initialized"),Backbone.Bootstrap=Backbone.Bootstrap||{},Backbone.Bootstrap.modals=Backbone.Bootstrap.modals||{},Backbone.Bootstrap.modals[this.cid]=this},handleAppClick:function(e){this.options.handleAppClick&&s.handleAppClick($(e.target))},render:function(){var e=this.$el,t=this.options,n=t.content;e.html(t.template(t));this.$content=e.find(".modal-body");return n&&n.$el?(n.render(),e.find(".modal-body").html(n.$el)):n&&n instanceof jQuery?e.find(".modal-body").html(n):n&&"string"==typeof n&&e.find(".modal-body").html("<p>"+n+"</p>"),t.doNotShowAgain&&"Got it!"!==t.okText&&e.find(".modal-body").append('<div class="checkbox">            <input id="chkDontShow" type="checkbox" class="regular-checkbox">            <label for="chkDontShow"></label>            <span class="dontShow">Do not show this message again</span>        </div>'),t.animate&&e.addClass("fade"),this.isRendered=!0,this},open:function(e,t){this.isRendered||this.render();var n=this,i=this.$el;i.modal(a.extend({keyboard:this.options.allowCancel,backdrop:!!this.options.allowCancel||"static"},this.options.modalOptions)),i.one("shown.bs.modal",(function(){n.options.focusOk?i.find(".btn.ok").focus():s.onDevice()||setTimeout((function(){var e=i.find(".modal-content");e.attr("tabindex","0"),e.focus(),n.options.noInputFocus||i.find("input:first, textarea:not(.noteReplyText):first").focus()}),100),n.options.content&&n.options.content.trigger&&n.options.content.trigger("shown",n),n.trigger("shown")}));var o=$(".modal").length,l=$(".modal-backdrop:eq("+o+")"),d=parseInt(l.css("z-index"),10),c=parseInt(l.css("z-index"),10);return l.css("z-index",d+o),this.$el.css("z-index",c+o),this.options.allowCancel&&(this.$el.on("click",(function(e){e.currentTarget==e.target&&(n.options.content&&n.options.content.trigger&&n.options.content.trigger("cancel",n),n.trigger("cancel"))})),$(document).one("keyup.dismiss.modal",(function(e){27==e.which&&n.trigger("cancel"),n.options.content&&n.options.content.trigger&&27==e.which&&n.options.content.trigger("shown",n)}))),this.on("cancel",(function(){t&&t(),n.close()})),r.count++,e&&n.on("ok",e),$("#content").find("input,textarea,a,button,select,body").attr("tabindex",-1),$(document).on("keydown",this.disableBackspace),this},disableBackspace:function(e){8!==e.which||$(e.target).is("input, textarea, select, [contenteditable]")||e.preventDefault()},close:function(){var e=this,t=this.$el;this._preventClose?this._preventClose=!1:(i.unmountAllChildReactComponentsUnderParent(t),t.one("hidden.bs.modal",(function n(a){if(a.target!==a.currentTarget)return t.one("hidden",n);$(document).off("keydown",this.disableBackspace),e.remove(),e.options.content&&e.options.content.trigger&&e.options.content.trigger("hidden",e),e.trigger("hidden"),r.count--,delete Backbone.Bootstrap.modals[this.cid],0==$(".modal").length&&$("#content").find("input,textarea,a,button,select,body").removeAttr("tabindex"),$(".modal").hasClass("in")&&$("body").addClass("modal-open")})),t.modal("hide"))},preventClose:function(){this._preventClose=!0},disableOk:function(e){e=e||this.options.okText,this.$el.find(".btn.ok").text(e).addClass("disabled").prop("disabled",!0)},enableOk:function(e){e=e||this.options.okText,this.$el.find(".btn.ok").text(e).removeClass("disabled").prop("disabled",!1)}},{count:0});t&&(e.exports=r),t.default=r}]);
//# sourceMappingURL=main-built.js.map